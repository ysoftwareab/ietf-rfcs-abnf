<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Deploying Publicly Trusted TLS Servers on IoT Devices Using SNI-based End-to-End TLS Forwarding (SNIF)</title>
<meta content="Jim Zubov" name="author">
<meta content="
       
   This document proposes a solution, referred as SNIF, that provides
   the means for any Internet connected device to: 
       
         allocate a globally unique anonymous hostname; 
         obtain and maintain a publicly trusted X.509 certificate
     issued for the allocated hostname; 
         accept incoming TLS connections on specific TCP ports of the
     allocated hostname from any TLS clients that are capable of sending
     Server Name Indication. 
       
       
   The private key associated with the X.509 certificate is securely
   stored on the TLS terminating device, and is never exposed to any
   other party at any step of the process. 
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="draft-zubov-snif-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-zubov-snif-01-kf96_rrh.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SNIF</td>
<td class="right">February 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Zubov</td>
<td class="center">Expires 6 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-zubov-snif-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-02-02" class="published">2 February 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-06">6 August 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Zubov</div>
<div class="org">VESvault Corp</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Deploying Publicly Trusted TLS Servers on IoT Devices Using SNI-based End-to-End TLS Forwarding (SNIF)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
   This document proposes a solution, referred as SNIF, that provides
   the means for any Internet connected device to:<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-abstract-2.1">allocate a globally unique anonymous hostname;<a href="#section-abstract-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-abstract-2.2">obtain and maintain a publicly trusted X.509 certificate
     issued for the allocated hostname;<a href="#section-abstract-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-abstract-2.3">accept incoming TLS connections on specific TCP ports of the
     allocated hostname from any TLS clients that are capable of sending
     Server Name Indication.<a href="#section-abstract-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-abstract-3">
   The private key associated with the X.509 certificate is securely
   stored on the TLS terminating device, and is never exposed to any
   other party at any step of the process.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">
   This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
   Status information for this document may be found at
   <span><a href="https://datatracker.ietf.org/doc/draft-zubov-snif">https://datatracker.ietf.org/doc/draft-zubov-snif</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
   Information can be found at <span><a href="https://snif.host">https://snif.host</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">
   Source for this draft and an issue tracker can be found at
   <span><a href="https://github.com/vesvault/snif-i-d">https://github.com/vesvault/snif-i-d</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-notational-conventions" class="xref">Notational Conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-overview" class="xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-snif-ca-proxy-protocol" class="xref">SNIF CA Proxy Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-protocol-summary" class="xref">Protocol Summary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-protocol-flow" class="xref">Protocol Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-cn-allocation-request" class="xref">CN Allocation Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-csr-submission-request" class="xref">CSR Submission Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-certificate-download-reques" class="xref">Certificate Download Request</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-snif-relay-protocol-suite" class="xref">SNIF Relay Protocol Suite</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-snif-messages" class="xref">SNIF Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-snif-control-connection-pro" class="xref">SNIF Control Connection Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-snif-service-connection-pro" class="xref">SNIF Service Connection Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-snif-client-connection-prot" class="xref">SNIF Client Connection Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-snif-ipc-fifo-protocol" class="xref">SNIF IPC FIFO Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-abuse-management" class="xref">Abuse Management</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-1">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
   A typical Internet-of-Things (IoT) device connects to the Internet
   using a dynamic IP address, and is usually unable to accept incoming
   connections to TCP ports. A dedicated trusted relay is needed to
   facilitate the communications between the IoT device and its intended
   users. While all communications are recommended to be TLS encrypted,
   the trusted relay will terminate each TLS connection and therefore
   have access to unencrypted traffic between IoT devices and user
   clients, which may pose undesirable security risk.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
   Designing a dedicated relay that works in end-to-end encrypted mode,
   where the TLS tunnel is established between the IoT device and the
   client, and is passed by the relay in an encrypted form, raises
   additional challenges. Clients expect to be able to verify the
   authenticity of the TLS certificate presented by the IoT device they
   are connecting to. Public certificate authorities requite to validate
   the ownership of the hostname the certificate is being requested for,
   using certain challenge mechanisms. Therefore, the IoT device needs
   to allocate a unique hostname, and to be able to complete the CA
   challenge in order to acquire a trusted certificate.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
   Alternatively, the client may decide to use a different certificate
   trust scheme, not based on publicly trusted root CAs. In this case,
   the client is limited to specifically built software with custom
   trust rules, or the system trust root on the client device needs to
   be customized.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
   This document proposes a solution, referred as SNIF, that allows any
   common TLS client with standard root CAs, such as a web browser, to
   establish a trusted end-to-end TLS connection with an IoT device
   using the unique hostname permanently allocated to the device, via a
   dedicated relay.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
   While this document focuses on IoT devices, SNIF is applicable to any
   physical or virtual device or software that can benefit from
   accepting trusted TLS connections to an anonymous hostname.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="sect-1.1">
<section id="section-1.1">
        <h3 id="name-notational-conventions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-1.1-1">
   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all
   capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-2">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">
   <em>SNIF CA Proxy</em> is a combination of web-based services and background
   processes that run on a publicly accessible server, normally on the
   same physical server as SNIF Relay. SNIF CA Proxy allocates hostnames
   for SNIF Connectors and facilitates issuing and renewing X.509
   certificates <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> without having access to the Connectors' private keys.
   The functions of SNIF CA Proxy are described in <a href="#sect-3" class="xref">Section 3</a>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
   <em>SNIF Relay</em> is a process that runs on a publicly accessible server,
   normally on the same physical server as SNIF CA Proxy. SNIF Relay
   facilitates end-to-end TLS connections, <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> or older versions, between SNIF Clients and SNIF
   Connectors. The functions of SNIF Relay are described in <a href="#sect-4" class="xref">Section 4</a>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">
   <em>SNIF Connector</em> is a software process that runs on an IoT device, or
   on other type of device that intends to provide TLS-based services
   that can be accessed by general purpose TLS clients using SNIF Relay.
   SNIF Connector can be implemented as a standalone process that
   communicates with the TLS server processes over local filesystem and
   sockets, or as an integral part of a TLS server process.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">
   <em>SNIF Client</em> is any common TLS-compatible client with SNI capability <span>[<a href="#RFC6066" class="xref">RFC6066</a>]</span>,
   such as a web browser or an email client, that connects to a SNIF
   hostname provided by a specific SNIF Connector. SNIF Client does not
   need any awareness of SNIF, or of any protocols described in this
   document.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">
   <em>Certificate Authority (CA)</em> is a service that issues public trusted
   TLS Certificates to specific hostnames when requested by the hostname
   owner, upon validating the ownership of the hostname. CA does not
   need any awareness of SNIF, except for a working relationship with
   the SNIF CA Proxy that requests certificates using protocols
   supported by the CA.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">
   <em>SNIF Peripheral Process</em> is any kind of additional service that
   extends or supplements functions of SNIF, in a way not defined within
   the scope of this document.<a href="#section-2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3">
<section id="section-3">
      <h2 id="name-snif-ca-proxy-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-snif-ca-proxy-protocol" class="section-name selfRef">SNIF CA Proxy Protocol</a>
      </h2>
<p id="section-3-1">
   SNIF CA Proxy Protocol is designed for securely acquiring and
   maintaining a publicly trusted TLS/SSL X.509 certificate issued by a
   Certificate Authority to a uniquely allocated hostname, by an agent
   that has no direct control over that hostname, or over a server the
   hostname is pointing to.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="sect-3.1">
<section id="section-3.1">
        <h3 id="name-protocol-summary">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-protocol-summary" class="section-name selfRef">Protocol Summary</a>
        </h3>
<p id="section-3.1-1">
   SNIF CA Proxy accepts requests from SNIF Connectors via HTTP / HTTPS.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
   SNIF CA Proxy interacts with the CA using protocols supported by the
   CA, such as ACME <span>[<a href="#RFC8555" class="xref">RFC8555</a>]</span>, not covered by this document.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">
   Each SNIF Connector is configured with a specific initiation URL
   ({initUrl}), which is specific to the SNIF CA Proxy server the
   Connector intends to work with. Depending on the CA Proxy rules,
   {initUrl} might be unique for each Connector, or common for multiple
   Connectors.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.2">
<section id="section-3.2">
        <h3 id="name-protocol-flow">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol Flow</a>
        </h3>
<p id="section-3.2-1">
   Upon the initial start or after a hard reset, the Connector SHALL
   generate a Private Key, which needs to be securely permanently stored
   by the Connector. Any key algorithm acceptable by the CA can be used,
   generally RSA-4096 is recommended.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
   The Connector SHALL send a CN Allocation Request using the
   {initUrl}.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">
   Having the canonical name {cn}, the Connector SHALL generate
   a CSR <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> using
   the Private Key, the subject containing the {cn}. The CSR subject may
   or may not have other fields besides {cn}, according to the specific
   requirements of the CA.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">
   The Connector SHALL issue a CSR Submission Request to send the CSR
   to the CA Proxy.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">
   Once the CSR is submitted, the Connector MUST permanently store the
   {cn} by some means - to minimize the storage compartments it might be
   practical to generate and store a dummy self-signed certificate with
   the {cn} in the subject until it gets replaced with a trusted
   certificate issued by the CA.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">
   A this point, the Connector will normally know the SNIF hostname it
   will be using with the SNIF Relay - it matches the {cn} in case of a
   single host CN, or is a one sub-level down from a wildcard {cn}, the
   name being derived by the Connector in a way that is not
   deterministically derivable from the {cn} and the public key, e.g. a
   hash of the Private Key. The Connector SHOULD communicate the
   hostname by some means to the SNIF Clients that will be accessing the
   Connector. The means of such communication is not covered by this
   document.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">
   The Connector can now send a Certificate Download Request, and
   SHOULD verify the returned Certificate. If the Certificate is valid -
   the Connector MUST permanently store it.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">
   If the Certificate Download Request fails - the Connector SHOULD
   repeat the request after certain delay. In case if the response was
   401 and the {authUrl} is returned in a header, and the Connector has
   the means of communicating with the device user - the Connector also
   SHOULD alert the user and bring {authUrl} to their attention by some
   means, so the user can complete the required authorization steps. If
   the Connector has no means of alerting the user, which is often the
   case with IoT devices - the user MUST be provided with some
   external means of authorizing with the CA Proxy, not covered by this
   domcument.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">
   Once the Certificate is stored, the Connector is capable of
   terminating SNIF connections, and may proceed launching a SNIF
   Control Connection (<a href="#sect-4.2" class="xref">Section 4.2</a>).<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<p id="section-3.2-10">
   The Connector SHOULD watch for the expiration of the stored
   Certificate. If the Certificate is about to expire in 7 days or less,
   or has already expired - the Connector SHOULD send a Certificate
   Download Requests, and repeat with appropriate delays until the
   renewed Certificate is successfully downloaded and verified.<a href="#section-3.2-10" class="pilcrow">¶</a></p>
<p id="section-3.2-11">
   At any stage of the flow, if the Connector receives unexpected volume
   of rejections or inconsistent responses from the CA Proxy, the
   Connector MAY decide to hard reset the storage and start the flow
   over from the beginning. In such case, the Connector will have to
   re-send its new SNIF hostname to any concerned SNIF Clients, the
   means of such communication is not covered by this document.<a href="#section-3.2-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.3">
<section id="section-3.3">
        <h3 id="name-cn-allocation-request">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-cn-allocation-request" class="section-name selfRef">CN Allocation Request</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-3.3-1">
          <dt id="section-3.3-1.1">Connection from:</dt>
          <dd style="margin-left: 9.0em" id="section-3.3-1.2">SNIF Connector<a href="#section-3.3-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.3">Connection to:</dt>
          <dd style="margin-left: 9.0em" id="section-3.3-1.4">SNIF CA Proxy<a href="#section-3.3-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.5">Protocol:</dt>
          <dd style="margin-left: 9.0em" id="section-3.3-1.6">https or http<a href="#section-3.3-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-3.3-2">
<pre>
   GET {initUrl}
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.3-3">
   Response 200: Canonical Name (CN) is successfully allocated. The response headers MUST
   include X-SNIF-CN: with the value of the allocated {cn}, either a
   wildcard starting with "*.", or a single hostname, depending on the
   CA Proxy rules. The response content type SHOULD be "text/plain", the
   response body SHOULD include the copy of the allocated {cn},
   optionally padded with newlines or spaces on the right. The Relay
   MUST NOT ever return a CN that's been previously returned by
   another CN Allocation Request.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">
   Any other response: Error, try again later.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.4">
<section id="section-3.4">
        <h3 id="name-csr-submission-request">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-csr-submission-request" class="section-name selfRef">CSR Submission Request</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-3.4-1">
          <dt id="section-3.4-1.1">Connection from:</dt>
          <dd style="margin-left: 9.0em" id="section-3.4-1.2">SNIF Connector<a href="#section-3.4-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-1.3">Connection to:</dt>
          <dd style="margin-left: 9.0em" id="section-3.4-1.4">SNIF CA Proxy<a href="#section-3.4-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-1.5">Protocol:</dt>
          <dd style="margin-left: 9.0em" id="section-3.4-1.6">http<a href="#section-3.4-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-3.4-2">
<pre>
   PUT http://{cn_host}/snif-cert/{cn_host}.csr
   Content-Type: application/pkcs10
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4-3">
   {cn_host} is a hostname derived from the {cn} - it is identical to
   {cn} in case of a single-host CN, or is the {cn} with truncated
   initial "*." in case of a wildcard CN.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">
   The request body MUST contain a PEM encoded PKCS#10 CSR <span>[<a href="#RFC5967" class="xref">RFC5967</a>]</span>,
   the newlines are either &lt;CR&gt;&lt;LF&gt; or &lt;LF&gt;, the length of the body
   SHOULD NOT exceed 16384 bytes.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">
   Note that a CSR for the specific allocated CN can be submitted to the
   CA Proxy once in a lifetime. In case of an incorrect submission the
   Connector SHOULD hard reset the storage and restart the flow from the
   beginning, including allocating a new CN.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4-6">
   Response 201: the CSR is successfully submitted. The response headers
   MAY include X-SNIF-AuthUrl: with the value of an {authUrl}, that
   SHOULD, if possible, be communicated to the user to authorize the
   certificate issuance.<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<p id="section-3.4-7">
   Response 403: the CSR for this CN has already been submitted, or is
   denied by the CA Proxy rules. If the Connector receives 403, is
   SHOULD hard reset the storage and restart the CA Proxy flow from the
   beginning.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">
   Response 404: the CN was not allocated.<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<p id="section-3.4-9">
   Any other response: Error, try again later.<a href="#section-3.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.5">
<section id="section-3.5">
        <h3 id="name-certificate-download-reques">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-certificate-download-reques" class="section-name selfRef">Certificate Download Request</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-3.5-1">
          <dt id="section-3.5-1.1">Connection from:</dt>
          <dd style="margin-left: 9.0em" id="section-3.5-1.2">SNIF Connector<a href="#section-3.5-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-1.3">Connection to:</dt>
          <dd style="margin-left: 9.0em" id="section-3.5-1.4">SNIF CA Proxy<a href="#section-3.5-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-1.5">Protocol:</dt>
          <dd style="margin-left: 9.0em" id="section-3.5-1.6">http<a href="#section-3.5-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-3.5-2">
<pre>
   GET http://{cn_host}/snif-cert/{cn_host}.crt
</pre><a href="#section-3.5-2" class="pilcrow">¶</a>
</div>
<p id="section-3.5-3">
   {cn_host} is a hostname derived from the {cn} - it is identical to
   {cn} in case of a single-host CN, or is the {cn} with truncated
   initial "*." in case of a wildcard CN.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">
   The CA Proxy SHOULD check for a cached previously generated
   Certificate chain for the {cn}. If the cached Certificate chain is
   found and if it expires in more that 10 days in the future - the
   cached Certificate chain SHOULD be returned with status 200.
   Otherwise, if the {cn} has a valid CSR and a proper authorization to
   issue a certificate - the CA Proxy SHOULD return status 503 and
   SHOULD launch a background process that communicates with the CA to
   issue or renew the certificate, and caches the issued Certificate
   chain for subsequent Certificate Download Requests.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<p id="section-3.5-5">
   Response 200: the Certificate chain is returned. The Content-Type of
   such response SHOULD be "application/x-x509-ca-cert". The response
   body MUST be a PEM encoded X.509 certificate chain, the issued
   certificate being the first member, the newlines are either &lt;CR&gt;&lt;LF&gt;
   or &lt;LF&gt;, the length of the body SHOULD NOT exceed 65535 bytes.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<p id="section-3.5-6">
   Response 503: the Certificate is being issued, try later.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
<p id="section-3.5-7">
   Response 401: Certificate issuance authorization is required. The
   response headers MAY include X-SNIF-AuthUrl: with the value of an
   {authUrl}, that SHOULD, if possible, be communicated to the user to
   authorize the certificate issuance. If the CA Proxy expects to work
   with Connectors that cannot communicate with the user, it MUST
   include external means of the authorization, not covered by this
   document.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">
   Response 404: the CN was not allocated, or the CSR was not submitted.<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<p id="section-3.5-9">
   Any other response: Error, try again later.<a href="#section-3.5-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-4">
<section id="section-4">
      <h2 id="name-snif-relay-protocol-suite">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-snif-relay-protocol-suite" class="section-name selfRef">SNIF Relay Protocol Suite</a>
      </h2>
<p id="section-4-1">
   Except for SNIF Client Connection, all protocols mentioned below
   involve sending and receiving asynchronous SNIF Messages over a
   specific type of stream connection.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
   <em>SNIF Control Connection Protocol</em> defines communications between SNIF
   Relay and SNIF Connector that runs on an IoT device, or other type of
   device that provides TLS-based services through SNIF.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
   <em>SNIF Service Connection Protocol</em> defines secondary communications
   between SNIF Relay and SNIF Connector that include end-to-end TLS
   traffic forwarded by the Relay.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
   <em>SNIF Client Connection Protocol</em> defines TLS communications between
   SNIF Relay and a Client, where the Relay acts as a transparent
   end-to-end forwarder.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
   <em>SNIF IPC FIFO Protocol</em> defines communications between nodes of a
   SNIF Relay cluster, and/or between SNIF Relay and SNIF Peripheral
   Processes.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="sect-4.1">
<section id="section-4.1">
        <h3 id="name-snif-messages">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-snif-messages" class="section-name selfRef">SNIF Messages</a>
        </h3>
<p id="section-4.1-1">
   A SNIF Message consists of a 1 or more ASCII characters excluding
   special characters, terminated by &lt;CR&gt;&lt;LF&gt;.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
   The total length of a SNIF Message, including the terminal &lt;CR&gt;&lt;LF&gt;,
   SHOULD NOT exceed 4096 bytes.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">
   8-bit characters are discouraged. If 8-bit characters are used, they
   SHOULD comply to UTF-8 <span>[<a href="#RFC3629" class="xref">RFC3629</a>]</span>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
   The receiving party SHOULD silently ignore any invalid or malformed
   SNIF message.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.2">
<section id="section-4.2">
        <h3 id="name-snif-control-connection-pro">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-snif-control-connection-pro" class="section-name selfRef">SNIF Control Connection Protocol</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-4.2-1">
          <dt id="section-4.2-1.1">Protocol name:</dt>
          <dd style="margin-left: 9.0em" id="section-4.2-1.2">snif<a href="#section-4.2-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-1.3">Connection from:</dt>
          <dd style="margin-left: 9.0em" id="section-4.2-1.4">SNIF Connector<a href="#section-4.2-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-1.5">Connection to:</dt>
          <dd style="margin-left: 9.0em" id="section-4.2-1.6">SNIF Relay<a href="#section-4.2-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-2">
   To be able to open a SNIF Control Connection, the SNIF Connector MUST
   have a valid trusted TLS/SSL certificate, the CN hostname DNS
   pointing to the SNIF Relay or a wildcard CN having a sub-host DNS
   pointing to the SNIF Relay, and a Private Key that matches the
   Certificate. Normally, the SNIF Connector will generate the Private
   Key and use SNIF CA Proxy Protocol (<a href="#sect-3" class="xref">Section 3</a>) to obtain and maintain
   the Certificate, although other means can be used.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">
   To initiate the Control Connection, the SNIF Connector opens a TCP
   connection to the hostname matching the Certificate's CN, that points
   to the Relay.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">
   Upon accepting the incoming TCP connection, the SNIF Relay MUST
   initiate a reversed TLS session as a client peer.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">
   The SNIF Connector MUST initiate the TLS as a server peer, using the
   Certificate and the Private Key.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">
   Upon successful TLS negotiation, the SNIF Relay MUST validate the
   SNIF Connector's certificate. If the certificate is not trusted, the
   SNIF Relay MUST shut down the TLS session and the TCP socket
   immediately.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">
   If the certificate is accepted, both SNIF Relay and SNIF Connector
   are ready to accept SNIF Messages from each other over the TLS
   connection, as following.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-8">
<pre>
   SNIF LISTEN {hostname}
</pre><a href="#section-4.2-8" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-9">
          <dt id="section-4.2-9.1">Sent by:</dt>
          <dd style="margin-left: 9.0em" id="section-4.2-9.2">SNIF Connector<a href="#section-4.2-9.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-10">
   The SNIF LISTEN message informs the Relay that the Connector is ready
   to accept incoming TLS connections to {hostname} through the Relay.<a href="#section-4.2-10" class="pilcrow">¶</a></p>
<p id="section-4.2-11">
   {hostname} MUST specify a single host (no wildcards), and MUST match
   the CN of the Connector's TLS certificate - either match a wildcard
   CN, or exactly match a single host CN.<a href="#section-4.2-11" class="pilcrow">¶</a></p>
<p id="section-4.2-12">
   The SNIF LISTEN message SHOULD be sent only once per the Control
   Connection. The Relay SHOULD ignore any invalid or subsequent SNIF
   LISTEN messages.<a href="#section-4.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-13">
<pre>
   SNIF CONNECT {conn_id} {dst_host}:{dst_port} {fwd_host}:{fwd_port} {cln_addr}:{cln_port}
</pre><a href="#section-4.2-13" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-14">
          <dt id="section-4.2-14.1">Sent by:</dt>
          <dd style="margin-left: 9.0em" id="section-4.2-14.2">SNIF Relay<a href="#section-4.2-14.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-15">
   The SNIF CONNECT message informs the Connector of an incoming TLS
   connection from a Client to the Connector's {dst_host}, TCP port
   {dst_port}.<a href="#section-4.2-15" class="pilcrow">¶</a></p>
<p id="section-4.2-16">
   {conn_id} is a unique alphanumeric connection identifier assigned by
   the Relay, {cln_addr}:{cln_port} are the Client's remote IPv4/IPv6
   address and TCP port, {cln_addr} is supplied in "[" brackets "]".<a href="#section-4.2-16" class="pilcrow">¶</a></p>
<p id="section-4.2-17">
   The Relay sends the SNIF CONNECT message to Connectors with
   {dst_host} matching the {hostname} the Connector is listening to. The
   Connector doesn't need to verify {dst_host}.<a href="#section-4.2-17" class="pilcrow">¶</a></p>
<p id="section-4.2-18">
   If the Connector decides to accept the connection - it MUST launch a
   SNIF Service Connection to {fwd_host}:{fwd_port}. It also SHOULD
   send any SNIF message back to the Relay over the Control Connection
   to update the keep-alive timer, a copy of the SNIF ACCEPT message
   that is sent over the Service Connection can be used.<a href="#section-4.2-18" class="pilcrow">¶</a></p>
<p id="section-4.2-19">
   In case of a rejection - the Connector SHOULD send SNIF CLOSE with
   matching {conn_id}.<a href="#section-4.2-19" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-20">
<pre>
   SNIF CLOSE {conn_id}
</pre><a href="#section-4.2-20" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-21">
          <dt id="section-4.2-21.1">Sent by:</dt>
          <dd style="margin-left: 9.0em" id="section-4.2-21.2">SNIF Connector<a href="#section-4.2-21.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-22">
   The SNIF CLOSE message instructs the Relay to terminate the Client
   connection with matching {conn_id}.<a href="#section-4.2-22" class="pilcrow">¶</a></p>
<p id="section-4.2-23">
   For SNIF CLOSE received from a Connector, the Relay MUST validate
   that the connection was targeted at the Connector's {hostname},
   otherwise ignore the message.<a href="#section-4.2-23" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-24">
<pre>
   SNIF ABUSE {conn_id} {abuse_score}
</pre><a href="#section-4.2-24" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-25">
          <dt id="section-4.2-25.1">Sent by:</dt>
          <dd style="margin-left: 9.0em" id="section-4.2-25.2">SNIF Connector<a href="#section-4.2-25.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-26">
   The SNIF ABUSE message instructs the Relay to increase the DoS
   protection abuse counter for the Client that initiated the connection
   {conn_id} by {abuse score}.<a href="#section-4.2-26" class="pilcrow">¶</a></p>
<p id="section-4.2-27">
   {abuse score} SHOULD be an integer from 1 to 255, 1 is the score for
   a normal non-abusive connection.<a href="#section-4.2-27" class="pilcrow">¶</a></p>
<p id="section-4.2-28">
   For SNIF ABUSE received from a Connector, the Relay MUST validate
   that the connection was targeted at the Connector's {hostname},
   otherwise ignore the message.<a href="#section-4.2-28" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-29">
<pre>
   SNIF MSG {hostname} {content}
</pre><a href="#section-4.2-29" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-30">
          <dt id="section-4.2-30.1">Sent by:</dt>
          <dd style="margin-left: 9.0em" id="section-4.2-30.2">SNIF Connector or SNIF Relay<a href="#section-4.2-30.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-31">
   The SNIF MSG message is relayed between the Connector and the SNIF
   Peripheral Processes attached to the Relay.<a href="#section-4.2-31" class="pilcrow">¶</a></p>
<p id="section-4.2-32">
   {content} SHOULD NOT contain whitespaces or special characters. Its
   semantics is specific to the targeted Peripheral Process, and is not
   covered by this document.<a href="#section-4.2-32" class="pilcrow">¶</a></p>
<p id="section-4.2-33">
   For SNIF MSG received by the Relay from a Connector, the Relay MUST
   verify that the {hostname} matches the one associated with the
   Connector, forward the message to all IPC FIFOs if matched, ignore
   otherwise.<a href="#section-4.2-33" class="pilcrow">¶</a></p>
<p id="section-4.2-34">
   For SNIF MSG received by the Relay from an IPC FIFO, the Relay SHOULD
   forward the message to the Connector(s) with the matching {hostname},
   ignore the message if none are found.<a href="#section-4.2-34" class="pilcrow">¶</a></p>
<p id="section-4.2-35">
   Note that in certain uncommon circumstances a SNIF MSG send by a
   Connector might come back to the Connector through a different
   Control Connection. The Connector SHOULD be aware of this fact to
   avoid a potential message storm.<a href="#section-4.2-35" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-36">
<pre>
   NOOP
</pre><a href="#section-4.2-36" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-37">
          <dt id="section-4.2-37.1">Sent by:</dt>
          <dd style="margin-left: 9.0em" id="section-4.2-37.2">SNIF Connector or SNIF Relay<a href="#section-4.2-37.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-38">
   The NOOP message is not associated with any explicit action, except
   that the Relay receiving NOOP from the connector SHOULD promply send
   NOOP or any other message back to the Connector. Therefore, the
   Connector may use NOOP as a keep-alive ping.<a href="#section-4.2-38" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.3">
<section id="section-4.3">
        <h3 id="name-snif-service-connection-pro">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-snif-service-connection-pro" class="section-name selfRef">SNIF Service Connection Protocol</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-4.3-1">
          <dt id="section-4.3-1.1">Protocol name:</dt>
          <dd style="margin-left: 9.0em" id="section-4.3-1.2">snif-srv<a href="#section-4.3-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-1.3">Connection from:</dt>
          <dd style="margin-left: 9.0em" id="section-4.3-1.4">SNIF Connector<a href="#section-4.3-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-1.5">Connection to:</dt>
          <dd style="margin-left: 9.0em" id="section-4.3-1.6">SNIF Relay<a href="#section-4.3-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-2">
   The SNIF Connector opens a TCP connection to the
   {fwd_host}:{fwd_port} in response to a SNIF CONNECT message received
   from the Relay over the Control Connection.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">
   The Connector MUST immediately send a SNIF ACCEPT message over the
   Service Connection as a plain TCP:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-4">
<pre>
   SNIF ACCEPT {conn_id}
</pre><a href="#section-4.3-4" class="pilcrow">¶</a>
</div>
<p id="section-4.3-5">
   The {conn_id} is the one that was received in the SNIF CONNECT
   message over the Control Connection.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">
   Upon sending the SNIF ACCEPT message, the Connector MUST immediately
   assign further control and bi-directional traffic of the SNIF Service
   Connection to the matching TLS server process.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">
   If the Relay decides to reject the connection, either because of
   invalid message or {conn_id}, or because of reaching the abuse
   threshold - the Relay SHOULD terminate the TCP connection
   immediately.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">
   Otherwise, the Relay SHOULD link the Service Connection to the
   matched Client Connection, forward to the Service Connection all
   buffered TLS data previously received from the Client, and start
   bi-directional forwarding between the Client Connection and the
   Service Connection.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">
   When either Client or Service Connection is shut down, or an
   inactivity timeout is reached, the Relay SHOULD shut down both the
   Client Connection and the Service Connection.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<p id="section-4.3-10">
   Once the Relay has linked the Client Connection matching the
   {conn_id} to the Service Connection, any further SNIF ACCEPT messages
   with the same {conn_id} on other Service Connections MUST be
   rejected.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.4">
<section id="section-4.4">
        <h3 id="name-snif-client-connection-prot">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-snif-client-connection-prot" class="section-name selfRef">SNIF Client Connection Protocol</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-4.4-1">
          <dt id="section-4.4-1.1">Protocol name:</dt>
          <dd style="margin-left: 9.0em" id="section-4.4-1.2">snif-cln<a href="#section-4.4-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-1.3">Connection from:</dt>
          <dd style="margin-left: 9.0em" id="section-4.4-1.4">Any TLS enabled software, such as a web browser or an email client<a href="#section-4.4-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-1.5">Connection to:</dt>
          <dd style="margin-left: 9.0em" id="section-4.4-1.6">SNIF Relay<a href="#section-4.4-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.4-2">
   From the Client's perspective, a SNIF Client Connection functions as
   a direct TLS connection to the IoT Device.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">
   The ports the Relay is listening to, can be any well-known ports for
   services with persistent TLS, such as https or imaps, or can be any
   custom ports agreed among the Relay, the Connectors and the Clients.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">
   The Relay accepts an incoming TCP connection, receives and buffers
   the incoming initial data from the client, and attempts to interpret
   the received data as a TLS handshake.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">
   If the received data is not recognized as a TLS handshake, does not
   contain an SNI record in a supported format, or the SNI hostname does
   not meet rules defined for the Relay - the Relay SHOULD immediately
   reject the TLS session with an appropriate error status, and shut
   down the Client Connection.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<p id="section-4.4-6">
   If the SNI hostname is found acceptable - the Relay allocates a
   unique {conn_id}, checks if there are current Control Connections
   that match the SNI hostname, and sends a SNIF CONNECT message over
   those connections.<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<p id="section-4.4-7">
   If there are no active applicable Control Connections, or if the
   Relay doesn't receive a response from a SNIF Connector within a
   specified timeframe - the Relay SHOULD forward the same SNIF CONNECT
   message over IPC FIFOs (if any are open) to alert cluster peer Relays
   and Peripheral processes of the incoming Client Connection.<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<p id="section-4.4-8">
   A Service Connection with a matching SNIF ACCEPT establishes an
   end-to-end TLS circuit with the Client Connection. Once established,
   the Relay bi-directionally forwards all traffic between the Client
   and the Service Connection until either of the connections is closed
   or is timed out due to inactivity.<a href="#section-4.4-8" class="pilcrow">¶</a></p>
<p id="section-4.4-9">
   Upon receiving a matching SNIF CLOSE - the Relay MUST terminate the
   Client Connection. If a Service Connection has already been linked it
   MUST be terminated too, otherwise the Relay SHOULD attempt to
   gracefully reject TLS on the Client Connection with an appropriate
   status prior to shutting down TCP.<a href="#section-4.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.5">
<section id="section-4.5">
        <h3 id="name-snif-ipc-fifo-protocol">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-snif-ipc-fifo-protocol" class="section-name selfRef">SNIF IPC FIFO Protocol</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-4.5-1">
          <dt id="section-4.5-1.1">Protocol name:</dt>
          <dd style="margin-left: 9.0em" id="section-4.5-1.2">snif-fifo<a href="#section-4.5-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.5-1.3">Connection from:</dt>
          <dd style="margin-left: 9.0em" id="section-4.5-1.4">SNIF Relay or SNIF Peripheral Service<a href="#section-4.5-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.5-1.5">Connection to:</dt>
          <dd style="margin-left: 9.0em" id="section-4.5-1.6">SNIF Relay or SNIF Peripheral Service<a href="#section-4.5-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-2">
   SNIF IPC FIFO is a permanent trusted connection between the SNIF
   Relay and a SNIF Peripheral Process, or between a pair of nodes in a
   SNIF Relay cluster. An IPC FIFO is usually unidirectional, but a
   bidirectional connection can serve as a pair of FIFOs. An IPC FIFO
   can be implemented as a Unix FIFO pipe, a TCP socket, an SSH tunnel
   or by other means. The mechanism of establishing and maintaining IPC
   FIFOs is implementation specific and is not covered by this document.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">
   The following SNIF Messages are defined over an IPC FIFO from the
   perspective of a SNIF Relay:<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-4">
<pre>
   SNIF CONNECT {conn_id} {dst_host}:{dst_port} {fwd_host}:{fwd_port} {cln_addr}:{cln_port}
</pre><a href="#section-4.5-4" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-5">
          <dt id="section-4.5-5.1">Direction:</dt>
          <dd style="margin-left: 9.0em" id="section-4.5-5.2">Send or Receive<a href="#section-4.5-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-6">
   (see SNIF Control Connection, Section 4.2).<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<p id="section-4.5-7">
   The SNIF CONNECT message is sent by a Relay over an IPC FIFO in case
   if the Relay failed to reach the respective Connector through Control
   Connections. SNIF CONNECT sent by a Relay MUST be followed up
   by one of SNIF CLEAR or SNIF CLOSE to inform the Peripheral Processes
   of the further outcome.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<p id="section-4.5-8">
   When a SNIF CONNECT message is received by a Relay, the Relay SHOULD
   forward it to any matching open Control Connections, or ignore it
   otherwise.<a href="#section-4.5-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-9">
<pre>
   SNIF CLEAR {conn_id}
</pre><a href="#section-4.5-9" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-10">
          <dt id="section-4.5-10.1">Direction:</dt>
          <dd style="margin-left: 9.0em" id="section-4.5-10.2">Send<a href="#section-4.5-10.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-11">
   The SNIF CLEAR message SHOULD be sent by a Relay only as a followup
   to SNIF CONNECT with a matching {conn_id}, in case if the Client
   Connection that triggered SNIF CONNECT was accepted by a Service
   Connection.<a href="#section-4.5-11" class="pilcrow">¶</a></p>
<p id="section-4.5-12">
   The purpose of SNIF CLEAR is to advice Peripheral Processes to cease
   further attempts of reaching the Connector by external means, not
   specified within this document.<a href="#section-4.5-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-13">
<pre>
   SNIF CLOSE {conn_id}
</pre><a href="#section-4.5-13" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-14">
          <dt id="section-4.5-14.1">Direction:</dt>
          <dd style="margin-left: 9.0em" id="section-4.5-14.2">Send or Receive<a href="#section-4.5-14.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-15">
   (see SNIF Control Connection, Section 4.2).<a href="#section-4.5-15" class="pilcrow">¶</a></p>
<p id="section-4.5-16">
   The SNIF CLOSE message SHOULD be sent by a Relay only as a followup
   to SNIF CONNECT with a matching {conn_id}, in case if the Client
   Connection that triggered SNIF CONNECT was closed without being
   accepted.<a href="#section-4.5-16" class="pilcrow">¶</a></p>
<p id="section-4.5-17">
   When the SNIF CLOSE is received by a Relay, the Relay SHOULD
   immediately close the matching Client and/or Service Connection if
   any found, ignore the message otherwise.<a href="#section-4.5-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-18">
<pre>
   SNIF ABUSE {conn_id} {abuse_score}
</pre><a href="#section-4.5-18" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-19">
          <dt id="section-4.5-19.1">Direction:</dt>
          <dd style="margin-left: 9.0em" id="section-4.5-19.2">Receive<a href="#section-4.5-19.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-20">
   (see SNIF Control Connection, Section 4.2).<a href="#section-4.5-20" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-21">
<pre>
   SNIF MSG {hostname} {content}
</pre><a href="#section-4.5-21" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-22">
          <dt id="section-4.5-22.1">Direction:</dt>
          <dd style="margin-left: 9.0em" id="section-4.5-22.2">Send or Receive<a href="#section-4.5-22.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-23">
   (see SNIF Control Connection, Section 4.2).<a href="#section-4.5-23" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-24">
<pre>
   SNIF CTL {ctl_fd} {hostname} {remote_addr}:{remote_port}
   SNIF CTL {ctl_fd}
</pre><a href="#section-4.5-24" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-25">
          <dt id="section-4.5-25.1">Direction:</dt>
          <dd style="margin-left: 9.0em" id="section-4.5-25.2">Send<a href="#section-4.5-25.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-26">
   The SNIF CTL message is sent by a Relay to inform Peripheral
   Processes about Control Connections. The first version is sent for
   each opening Control Connection, and is followed up by the second
   version with the matching {ctl_fd} when the Control Connection is
   closed. {ctl_fd} is a numeric descriptor which is unique for open
   connections, but can be reused after a connection is closed.<a href="#section-4.5-26" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.6">
<section id="section-4.6">
        <h3 id="name-abuse-management">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-abuse-management" class="section-name selfRef">Abuse Management</a>
        </h3>
<p id="section-4.6-1">
   SNIF Relay SHOULD implement basic protection from denial of service.
   A separate abuse count SHOULD be assigned to each remote address,
   incremented by 1 on every incoming connection from the address,
   incremented by a specified score on every received SNIF ABUSE
   message, and periodically decremented or reset at regular time
   intervals.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">
   If the abuse counter for a certain remote address reaches a
   specific threshold, the Relay SHOULD drop any further TCP connections
   from that address until the abuse counter goes below the threshold.
   The Relay MAY allow some grace above the threshold to incoming
   SNIF Service Connections, to minimize stalled Client Connections.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">
   SNIF Connector MAY implement basic protection from denial of service
   by limiting the number of accepted connections per period of time
   and/or the total number of open connections, and reject connections
   over the limit.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">
   All information communicated to/from SNIF CA Proxy over plain
   unencrypted HTTP is safe to be exposed to third parties or to
   intruders without compromising any private information.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
   SNIF Control Connection Protocol communicates all sensitive
   information over a TLS connection with a trusted certificate.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">
   SNIF Service Connection Protocol communicates a randomly generated
   {conn_id} over an unsecure TCP connection. Except if used over a
   trusted SNIF IPC FIFO, the {conn_id} can be used only once to accept
   the Client's TLS connection, which in turn can only be successfully
   negotiated by the targeted SNIF Connector. All further communications
   are comprised of end-to-end encrypted TLS traffic. The security of
   the TLS encrypted content between the Client and the Connector is
   specific to the protocols involved. The underlying protocol SHOULD
   require proper authentication specific to the protocol before
   communicating any sensitive information. Negotiation of the
   credentials for such authentication is not covered by this
   document.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">
   SNIF Client Connection is a TLS session with a trusted certificate.
   The security of the TLS encrypted content between the Client and the
   Connector is specific to the protocols involved.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">
   SNIF IPC FIFO connections SHOULD only be established between mutually
   trusted parties, and need to be secured by external means specific to
   the implementation, such as filesystem permissions, TLS or SSH
   tunnels etc. The security of such external means cannot be assessed
   within the scope of this document.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">
   A compromised SNIF CA Proxy can potentially issue certificates to any
   hostnames allocated by the Relay, including a catch-all wildcard,
   using an alternative private key, and thus allow a man-in-the-middle
   attack on any SNIF Connectors associated with the Relay. This
   vulnerability can be mitigated by constant monitoring of public TLS
   Transparency logs, such as <span>[<a href="#RFC6962" class="xref">RFC6962</a>]</span>. At least one independent party
   SHOULD continuously monitor TLS Transparency logs for each deployed
   SNIF CA Proxy and Relay. Once any duplicate or overlapping
   certificates are detected - the corresponding SNIF Relay MUST be
   permanently deemed compromised.<a href="#section-5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">
   Protocols "snif", "snif-srv", "snif-cln" and "snif-fifo" are
   registered with IANA.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
   TCP port 7123 is registered with IANA for protocol "snif".<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5967">[RFC5967]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"The application/pkcs10 Media Type"</span>, <span class="seriesInfo">RFC 5967</span>, <span class="seriesInfo">DOI 10.17487/RFC5967</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5967">https://www.rfc-editor.org/info/rfc5967</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6962">[RFC6962]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Kasper</span>, <span class="refTitle">"Certificate Transparency"</span>, <span class="seriesInfo">RFC 6962</span>, <span class="seriesInfo">DOI 10.17487/RFC6962</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6962">https://www.rfc-editor.org/info/rfc6962</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
      <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8555">https://www.rfc-editor.org/info/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jim Zubov</span></div>
<div dir="auto" class="left"><span class="org">VESvault Corp</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jz@vesvault.com" class="email">jz@vesvault.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://snif.host" class="url">https://snif.host</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
