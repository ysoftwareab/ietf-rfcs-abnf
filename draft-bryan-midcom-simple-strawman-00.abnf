response="" 
         
stale="true", nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093" 
         
nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",  
response="8402e591c2a0b8e4a988a67c579cee45" 
         
alloc = "ALLOC" SP req-id SP address SP protocol SP numports  
                SP expires 
    
open = "OPEN" SP req-id SP hole-id SP 10 tuple SP expires 
    
close = "CLOSE" SP req-id SP hole-id 
    
dealloc = "DEALLOC" SP req-id SP hole-id 
         
refresh = "REFRESH" SP req-id SP hole-id SP expiration 
         
list = "LIST" SP req-id 
         
attrib = "ATTRIB" SP req-id SP hole-id SP parameter SP value 
         
auth = "AUTH" SP basic | digest-response 
basic = "Basic" SP base64 <defined in RFC2617> 
         
result-params = success-params | auth-params 
auth-params = basic-realm | digest-challenge 
basic-realm = "Basic" SP "realm=" realm 
         
         
response="" 
         
stale="true", nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093" 
         
nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",  
response="8402e591c2a0b8e4a988a67c579cee45" 
         
response = hex( MD5( "eggplant:" + MD5( A1 ) + nonce + ":" ) ) 
 
request-line = request CRLF 
    
request   = alloc  | open | close | dealloc | refresh | list | 
               attrib | auth 
    
alloc   = "ALLOC"   SP req-id SP outside SP protocol SP numports 
open    = "OPEN"    SP req-id SP hole-id SP 10tuple SP expires 
close   = "CLOSE"   SP req-id SP hole-id 
dealloc = "DEALLOC" SP req-id SP hole-id 
refresh = "REFRESH" SP req-id SP hole-id SP expires 
list    = "LIST"    SP req-id 
attrib  = "ATTRIB"  SP req-id SP hole-id SP param SP value 
auth    = "AUTH"    SP req-id SP method 
    
response-line = req-id SP result-code [ SP result-params] CRLF 
    
result-params = success-params | auth-params 
    
success-params = open-result | alloc-result | refresh-result | 
                    list-result  
    
open-result    = hole-id SP 10tuple  SP expires 
alloc-result   = outside SP numports SP expires SP hole-list 
refresh-result = hole-id SP expires  
list-result    = list-item *[ SP list-item ] 
    
list-item = hole-id SP 10tuple  SP expires 
hole-list = hole-id *[ SP hole-id ] 
    
auth-params = basic-realm | digest-challenge 
basic-realm = "Basic" SP "realm=" realm 
    
    
source = address  
input = address 
output = address 
destination = address 
direction = "uni" | "bi" 
expires = int32 "secs" 
    
param = token 
value = token | quoted-string 
realm = quoted-string 
    
address =  "[" IPv6-addr "]" ":" port 
    
req-id = int16 
hole-id = int32 
numports = int8 
    
SP = %0d32 
 
    
address = IPv6-addr ["/" mask ] ":" port 
    
AUTH-string = method SP auth-params 
method = ( basic | digest ) 
digest = "Digest" 
basic = "Basic" 
    
