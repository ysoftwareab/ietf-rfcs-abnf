<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DomainKeys Identified Mail (DKIM)
         Development, Deployment and Operations</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DomainKeys Identified Mail (DKIM)
         Development, Deployment and Operations">
<meta name="keywords" content="Email, Electronic Mail, Internet Mail, Message Verification">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DomainKeys Identified Mail</td><td class="header">T. Hansen</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">AT&amp;T Laboratories</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">P. Hallam-Baker</td></tr>
<tr><td class="header">Expires: August 28, 2008</td><td class="header">VeriSign Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">D. Crocker</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Brandenburg InternetWorking</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 25, 2008</td></tr>
</table></td></tr></table>
<h1><br />DomainKeys Identified Mail (DKIM)
         Development, Deployment and Operations<br />draft-ietf-dkim-deployment-01</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 28, 2008.</p>

<h3>Abstract</h3>

<p> DomainKeys Identified Mail (DKIM) associates a "responsible"
            identity with a message and provides a means of verifying that the
            association is legitimate. <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>
            DKIM defines a domain-level authentication framework for email
            using public-key cryptography and key server technology.
	    This
            permits verifying the source or intermediary for a message, as
            well as the contents of messages. The ultimate goal of this
            framework is to permit a signing domain to assert responsibility
            for sending a message, thus proving and protecting the identity associated
            with the message and the integrity of the messages itself, while
            retaining the functionality of Internet email as it is known
            today. Such protection of email identity may assist in the global
            control of "spam" and "phishing". This document provides implementation,
	    deployment, operational and migration considerations for DKIM. 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Development<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
DKIM Signing Software<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
General Coding Criteria for Cryptographic Applications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Mailing List Manager Software<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.4.</a>&nbsp;
Email Infrastructure Agents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.5.</a>&nbsp;
Filtering Software<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.6.</a>&nbsp;
DNS Server Software<br />
<a href="#anchor9">3.</a>&nbsp;
Deployment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.1.</a>&nbsp;
Signing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.2.</a>&nbsp;
Verifying<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">3.3.</a>&nbsp;
Key Management Deployment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">3.4.</a>&nbsp;
Mailing Lists<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">3.5.</a>&nbsp;
Mail User Agent<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">3.6.</a>&nbsp;
Transition Strategy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">3.7.</a>&nbsp;
Migrating from DomainKeys<br />
<a href="#anchor31">4.</a>&nbsp;
On-going Operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">4.1.</a>&nbsp;
DNS Signature Record Installation Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">4.2.</a>&nbsp;
Private Key Management<br />
<a href="#anchor38">5.</a>&nbsp;
Example Uses<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">5.1.</a>&nbsp;
Protection of Internal Mail<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">5.2.</a>&nbsp;
Recipient-based Assessments<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">5.3.</a>&nbsp;
DKIM Support in the Client<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">5.4.</a>&nbsp;
Per user signatures<br />
<a href="#anchor44">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor45">7.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor46">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
               There are many areas to be considered when deploying
               DomainKeys Identified Mail (DKIM).
               This document provides practical tips for: those who are developing DKIM software, mailing list managers,
	       filtering strategies based on the output from DKIM verification, and DNS servers;
	       those who are deploying DKIM software, keys, mailing list software, and migrating from DomainKeys;
	       and those who are responsible for the on-going operations of an email infrastructure that has deployed DKIM.
            
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Development</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
DKIM Signing Software</h3>

<p>Signer implementations SHOULD provide a convenient means of
                  generating DNS key records corresponding to the signer
                  configuration. Support for automatic insertion of key
                  records into the DNS is also highly desirable. If supported
                  however, such mechanism(s) MUST be properly authenticated.
</p>
<p>A means of verifying that the signer configuration is
                  compatible with the signature policy is also highly
                  desirable.
</p>
<p>Disclosure of a private signature key component to a third
                  party allows that third party to impersonate the sender.
                  The protection of private signature key data is therefore a
                  critical concern. Signers SHOULD support use of
                  cryptographic hardware providing key management features. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
General Coding Criteria for Cryptographic Applications</h3>

<p> NOTE: This section could possibly be changed into a reference to something else, such as another rfc.
	       
</p>
<p>Correct implementation of a cryptographic algorithm is a
                  necessary but not a sufficient condition for the coding of
                  cryptographic applications. Coding of cryptographic
                  libraries requires close attention to security
                  considerations that are unique to cryptographic
                  applications.
	       
</p>
<p>In addition to the usual security coding considerations,
                  such as avoiding buffer or integer overflow and underflow,
                  implementers should pay close attention to management of
                  cryptographic private keys and session keys, ensuring that
                  these are correctly initialized and disposed of.
	       
</p>
<p>Operating system mechanisms that permit the confidentiality
                  of private keys to be protected against other processes
                  SHOULD be used when available. In particular, great care
                  MUST be taken when releasing memory pages to the operating
                  system to ensure that private key information is not
                  disclosed to other processes.
	       
</p>
<p>Certain implementations of public key algorithms such as RSA may be
                  vulnerable to a timing analysis attack.
               
</p>
<p>Support for cryptographic hardware providing key management
                  capabilities is strongly encouraged. In addition to offering
                  performance benefits, many cryptographic hardware devices
                  provide robust and verifiable management of private keys.
               
</p>
<p>Fortunately appropriately designed and coded cryptographic
                  libraries are available for most operating system platforms
                  under license terms compatible with commercial, open source
                  and free software license terms. Use of standard
                  cryptographic libraries is strongly encouraged. These have
                  been extensively tested, reduce development time and support
                  a wide range of cryptographic hardware.
               
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Mailing List Manager Software</h3>

<p> A mailing list often provides facilities to its
                  administrator to manipulate parts of the mail messages that
                  flow through the list. The desired goal is that messages
                  flowing through the mailing list will be verifiable by the
                  recipient as being from the list, or failing that, as being
                  from the individual list members. 
               
</p>
<p> In most cases, the list and/or its mail host SHOULD add its
                  own DKIM signature to list mail. This could be done in the
                  list management software, in an outgoing MSA or MTA, or
                  both. List management software often makes modifications to
                  messages that will break incoming signatures, such as adding
                  subject tags, adding message headers or footers, and adding,
                  deleting, or reordering MIME parts. By adding its own
                  signature after these modifications, the list provides a
                  verifiable, recognizable signature for list recipients. 
               
</p>
<p> In some cases, the modifications made by the mailing list
                  software are simple enough that
                  signatures on incoming messages will still be verifiable
                  after being remailed by the list. It is still preferable
                  that the list sign its mail so that recipients can
                  distinguish between mail sent through the list and mail sent
                  directly to a list member. In the absence of a list
                  signature, a recipient may still be able to recognize and use the
                  original signatures of the list members. 
               
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Email Infrastructure Agents</h3>

<p>It is expected that the most common venue for a DKIM
                  implementation will be within the infrastructure of an
                  organization's email service, such as a department or a
                  boundary MTA.</p>
<blockquote class="text">
<p>
                        </p>
<blockquote class="text"><dl>
<dt>Outbound:  </dt>
<dd> An MSA or Outbound MTA
                              should allow for the automatic verification of the MTA
                              configuration such that the MTA can generate an
                              operator alert if it determines that it is (1) an
                              edge MTA, and (2) configured to send email messages
                              that do not comply with the published DKIM sending
                              policy.
</dd>
<dt></dt>
<dd>An outbound MTA should be aware that users may
                              employ MUAs that add their own signatures and be
                              prepared to take steps necessary to ensure that the
                              message sent is in compliance with the advertised
                              email sending policy.
</dd>
<dt>Inbound:  </dt>
<dd> An inbound MTA or an MDA
                              that does not support DKIM should avoid modifying
                              messages in ways that prevent verification by other
                              MTAs, or MUAs to which the message may be
                              forwarded.
</dd>
<dt></dt>
<dd>An inbound MTA or an MDA may incorporate an indication
                              of the verification
                              results into the message, such as using an
                              Authentication-Results header. <a class='info' href='#I-D.kucherawy-sender-auth-header'>[I&#8209;D.kucherawy&#8209;sender&#8209;auth&#8209;header]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; January&nbsp;2009.</span><span>)</span></a>
</dd>
<dt>Intermediaries:  </dt>
<dd> An email intermediary
                              is both an inbound and outbound MTA. Each of the
                              requirements outlined in the sections relating to
                              MTAs apply. If the intermediary modifies a message
                              in a way that breaks the signature, the
                              intermediary 
<ul class="text">
<li> SHOULD deploy abuse filtering measures on
                                    the inbound mail, and 
</li>
<li> MAY remove all signatures that will be
                                    broken
</li>
</ul>
</dd>
<dt></dt>
<dd>In addition the intermediary MAY: 
<ul class="text">
<li>Verify the message signature prior to modification.
</li>
<li>Incorporate an indication of the verification
                                 results into the message, such as using an
                                 Authentication-Results header. <a class='info' href='#I-D.kucherawy-sender-auth-header'>[I&#8209;D.kucherawy&#8209;sender&#8209;auth&#8209;header]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; January&nbsp;2009.</span><span>)</span></a>
</li>
<li>Sign the modified message including the
                                 verification results (e.g., the
                                 Authentication-Results header).
</li>
</ul>
                            
</dd>
</dl></blockquote>
                     

</blockquote>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Filtering Software</h3>

<p>Developers of filtering schemes designed to accept DKIM
                  authentication results as input should be aware that their
                  implementations will be subject to counter-attack by email
                  abusers.
		  The efficacy of a filtering scheme cannot therefore be
                  determined by reference to static test vectors alone;
                  resistance to counter attack must also be considered.
</p>
<p>Naive learning algorithms that only consider the presence or
                  absence of a verified DKIM signature, without considering
                  more information about the message,
                  are vulnerable to an
                  attack in which a spammer or other malefactor signs all their
                  mail, thus creating a large negative value for presence of a
                  DKIM signature in the hope of discouraging widespread use.
</p>
<p>If heuristic algorithms are employed, they should be trained on
                  feature sets that sufficiently reveal the internal structure of
                  the DKIM responses. In particular the algorithm should consider
                  the domains purporting to claim responsibility for the
                  signature, rather than the existence of a signature or not.
</p>
<p>Unless a scheme can correlate the DKIM signature with
                  accreditation or reputation data, the presence of a DKIM
                  signature SHOULD be ignored.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6"></a><h3>2.6.&nbsp;
DNS Server Software</h3>

<p> At a minimum, a DNS server that handles queries for DKIM key
                  records must allow the server administrators to add free-form TXT
                  records.
                  It would be better if the the DKIM records could be entered
                  using a structured form, supporting the DKIM-specific fields.
               
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Deployment</h3>

<p>This section describes the basic steps for introducing DKIM
               into an organization's email service operation. The
               considerations are divided between the generating DKIM
               signatures (Signing) and the processing of messages that
               contain a DKIM signature (Verifying).
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Signing</h3>

<p>Creating messages that have DKIM signatures requires
                  a modification to only two portions of the email service:
                     </p>
<ul class="text">
<li>Addition of relevant DNS information.
</li>
<li>Addition of the signature by a trusted module within
                        the organization's email handling service.
</li>
</ul><p>
               
</p>
<p>The signing module uses the appropriate private key to
                  create a signature. The means by which the signing module
                  obtains the private key is not specified by DKIM. Given that DKIM
                  is intended for use during email transit, rather than for
                  long-term storage, it is expected that keys will be changed
                  regularly. Clearly this means that key information should
                  not be hard-coded into software. 
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
DNS Records</h3>

<p>A receiver attempting to verify a DKIM signature must
                     obtain the public key that is associated with the
                     signature for that message. The DKIM-Signature header in
                     the message will specify the basic domain name doing the
                     signing and the selector to be used for the specific
                     public key. Hence, the relevant
                     &lt;selector&gt;._domainkey.&lt;domain-name&gt;
                     DNS record needs to contain a DKIM-related resource
                     record (RR) that provides the public key information. 
</p>
<p>The administrator of the zone containing the relevant
                     domain name adds this information. Initial DKIM DNS
                     information is contained within TXT RRs. DNS
                     administrative software varies considerably in its
                     abilities to add new types of DNS records. 
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Signing Module</h3>

<p>The module doing signing can be placed anywhere within an
                     organization's trusted Administrative Management Domain
                     (ADMD); common choices are expected to be
                     department-level posting and delivering agents, as well
                     as boundary MTAs to the open Internet. (Note that it is
                     entirely acceptable for MUAs to perform signing and
                     verification.) Hence the choice among the modules depends
                     upon software development and administrative overhead
                     tradeoffs. One perspective that helps resolve this choice
                     is the difference between the flexibility of use by
                     systems at (or close to) the MUA, versus the centralized
                     control that is more easily obtained by implementing the
                     mechanism "deeper" into the organization's email
                     infrastructure, such as at its boundary MTA.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
Signing Policies and Practices</h3>

<p>Every organization (ADMD) will have its own policies and
                     practices for deciding when to sign messages and with
                     what domain name and key (selector). Examples include
                     signing all mail, signing mail from particular email
                     addresses, or signing mail from particular sub-domains.
                     Given this variability, and the likelihood that signing
                     practices will change over time, it will be useful to
                     have these decisions represented in some sort of
                     configuration information, rather than being more deeply
                     coded into the signing software.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Verifying</h3>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Verifier</h3>

<p>Verifiers SHOULD treat the result of the verification
                     step as an input to the message evaluation process rather
                     than as providing a final decision. The knowledge that a
                     message is authentically sent by a domain does not say
                     much about the legitimacy of the message, unless the
                     characteristics of the domain claiming responsibility are
                     known.
</p>
<p>In particular, verifiers SHOULD NOT automatically assume
                     that an email message that does not contain a signature,
                     or that contains a signature that does not verify, is
                     forged. Verifiers should treat a signature that fails to
                     verify the same as if no signature were present.
                     NOTE: THE ABOVE MAY BE MODIFIED BY SSP/ASP
                     
</p>
<p>Verification is performed within an ADMD that wishes to make
                  assessments based upon the DKIM signature's domain name. Any
                  component within the ADMD that handles messages, whether in
                  transit or being delivered, can do the verifying and
                  subsequent assessments. Verification and assessment might
                  occur within the same software mechanism, such as a Boundary
                  MTA, or an MDA. Or they may be separated, such as having
                  verification performed by the Boundary MTA and assessment
                  performed by the MDA.
</p>
<p>As with the signing process, choice of service venues for
                  verification and assessment -- such as filtering or
                  presentation to the recipient user -- depend on trade-offs
                  for flexibility, control, and operational ease. An added
                  concern is that the linkage between verification and
                  assessment entails essential trust: the assessment module
                  MUST have a strong basis for believing that the verification
                  information is correct.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
DNS Client</h3>

<p>The primary means of publishing DKIM key information,
                     initially, is initially through DNS TXT records. Some DNS
                     client software might have problems obtaining these
                     records; as DNS client software improves this will not be
                     a concern.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.3"></a><h3>3.2.3.&nbsp;
Boundary Enforcement</h3>

<p>In order for an assessment module to trust the
                     information it receives about verification (e.g.,
                     Authentication-Results headers), it MUST eliminate
                     verification information originating from outside the
                     ADMD in which the assessment mechanism operates. As a
                     matter of friendly practice, it is equally important to
                     make sure that verification information generated within
                     the ADMD not escape outside of it.
</p>
<p>In most environments, the easiest way to enforce this is
                     to place modules in the receiving and sending Boundary
                     MTA(s) that strip any existing verification
                  information.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Key Management Deployment</h3>

<p>
                  More to be added
               
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
First Party Key Management</h3>

<p>
                     </p>
<blockquote class="text"><dl>
<dt>Selectors</dt>
<dd> Selectors are assigned according
                           to the administrative needs of the signing domain,
                           such as for rolling over to a new key or for
                           delegating of the right to authenticate a portion of
                           the namespace to a trusted third party.
                        
</dd>
<dt>Examples include:  </dt>
<dd>
                           jun2005.eng._domainkey.example.com 
</dd>
<dt></dt>
<dd>widget.promotion._domainkey.example.com
</dd>
<dt>NOTE:  </dt>
<dd>It is intended that
                                    assessments of DKIM identities be based on
                                    the domain name, and not include the
                                    selector. This permits the selector to be
                                    used only for key administration, rather
                                    than having an effect on reputation
                                    assessment.
</dd>
</dl></blockquote><p>
                  
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
Third Party Key Management</h3>

<p>
                  ????????????????
                     3rd party generates the public / private key pair and sends the public key to be published in the DNS.
                  
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3"></a><h3>3.3.3.&nbsp;
Signer Actions</h3>

<p>
                     All Signers SHOULD:
                     </p>
<ul class="text">
<li>
                           Include any existing Sender header field in the signed header
                           field list, if the Sender header field exists.
                        
</li>
</ul><p>
                  
</p>
<p>
                     Signers wishing to avoid the use of Third-Party Signatures SHOULD do
                     everything listed above, and also:
                     </p>
<ul class="text">
<li>
                           Include the Sender header field name in the header field list
                           ("h=" tag) under all circumstances, even if the Sender header
                           field does not exist in the header block.  This prevents another
                           entity from adding a Sender header field.
                        
</li>
<li>
                           Publish Signing Practices that do not sanction the use of
                           Third-Party Signatures.
                        
</li>
</ul><p>
                  
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Mailing Lists</h3>

<p>
                  There are several forms of mailing lists, which interact with signing
                  in different ways.
                  </p>
<ul class="text">
<li>"Verbatim" mailing lists send messages without modification
                        whatsoever.  They are often implemented as MTA-based aliases.
                        Since they do not modify the message, signatures are unaffected
                        and will continue to verify.  It is not necessary for the
                        forwarder to re-sign the message; however, some may choose to do
                        so in order to certify that the message was sent through the list.
                     
</li>
<li>"Digesting" mailing lists collect together one or more postings
                        and then retransmit them, often on a nightly basis, to the
                        subscription list.  These are essentially entirely new messages
                        which must be independently authored (that is, they will have a
                        "From" header field referring to the list, not the submitters) and
                        signed by the Mailing List Manager itself, if they are signed at
                        all.
                     
</li>
<li>"Resending" mailing lists receive a message, modify it (often to
                        add "unsubscribe" information or advertising), and immediately
                        resend that message to the subscription list.  They are
                        problematic because they usually do not change the "From" header
                        field of the message, but they do invalidate the signature in the
                        process of modifying the message.
                     
</li>
</ul><p>
               
</p>
<p>
                  The first two cases act in obvious ways and do not require further
                  discussion.  The remainder of this session applies only to the third
                  case.
               
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Mailing List Manager Actions</h3>

<p>
                     Mailing List Managers should make every effort to ensure that
                     messages that they relay and which have Valid Signatures upon receipt
                     also have Valid Signatures upon retransmission.  In particular,
                     Mailing List Managers that modify the message in ways that break
                     existing signatures SHOULD:

                     </p>
<ul class="text">
<li>
                           Verify any existing DKIM Signatures.  A DKIM-aware Mailing List
                           Manager MUST NOT re-sign an improperly signed message in such a
                           way that would imply that the existing signature is acceptable.
                        
</li>
<li>
                           Apply regular anti-spam policies.  A Mailing List Manager SHOULD
                           apply message content security policy just as they would messages
                           destined for an individual user's mailbox.  In fact, a Mailing
                           List Manager might apply a higher standard to messages destined to
                           a mailing list than would normally be applied to individual
                           messages.
                           <br />

                           NON-NORMATIVE RATIONALE:  Since reputation will accrue to
                           signers, Mailing List Managers should verify the source and
                           content of messages before they are willing to sign lest their
                           reputation be sullied by nefarious parties.
                        
</li>
<li>
                           Add a Sender header field using a valid address pointing back to
                           the Mailing List Administrator or an appropriate agent (such as an
                           "owner-" or a "-request" address).
                        
</li>
<li>
                           Sign the resulting message with a signature that is valid for the
                           Sender header field address.  The Mailing List Manager SHOULD NOT
                           sign messages for which they are unwilling to accept
                           responsibility.
                        
</li>
</ul><p>
                  
</p>
<p>
                     Mailing List Managers MAY:
                        </p>
<ul class="text">
<li>
                              Reject messages with signatures that do not verify or are
                              otherwise Suspicious.
                           
</li>
</ul><p>
                  
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Mail User Agent</h3>

<p>DKIM is designed to support deployment and use in email
                  components other than an MUA. However an MUA MAY also
                  implement DKIM features directly.</p>
<blockquote class="text">
<p>
                        </p>
<blockquote class="text"><dl>
<dt>Outbound:  </dt>
<dd> If an MUA is configured
                              to send email directly, rather than relayed
                              through an outbound MSA, the MUA SHOULD be
                              considered as if it were an outbound MTA for the
                              purposes of DKIM. An MUA MAY support signing
                              even if mail is to be relayed through an
                              outbound MSA. In this case the signature applied
                              by the MUA may be in addition to any MSA
                              signature.
</dd>
<dt>Inbound:  </dt>
<dd> An MUA MAY rely on a
                              report of a DKIM signature verification that
                              took place at some point in the inbound MTA path
                              (e.g., an Authentication-Results header), or an
                              MUA MAY perform DKIM signature verification
                              directly. A verifying MUA SHOULD allow for the
                              case where mail is modified in the inbound MTA
                              path.
</dd>
</dl></blockquote>
                     

</blockquote>

<p>
                  It is common for components of an ADMD's email
                  infrastructure to do violence to a message, such as to render a
                  DKIM signature invalid. Hence, users of MUAs that support
                  DKIM signing and/or verifying need a basis for knowing that
                  their associated email infrastructure will not break a
                  signature. 
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Transition Strategy</h3>

<p> Deployment of a new signature algorithm without a 'flag
                  day' requires a transition strategy such that signers and
                  verifiers can phase in support for the new algorithm
                  independently, and (if necessary) phase out support for the
                  old algorithm independently. 
</p>
<p>[Note: this section assumes that a security policy mechanism
                  exists. It is subject to change.] 
</p>
<p> DKIM achieves these requirements through two features:
                  First a signed message may contain multiple signatures
                  created by the same signer. Secondly the security policy
                  layer allows the signing algorithms in use to be advertised,
                  thus preventing a downgrade attack. 
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.1"></a><h3>3.6.1.&nbsp;
Signer transition strategy</h3>

<p> Let the old signing algorithm be A, the new signing
                     algorithm be B. The sequence of events by which a Signer
                     may introduce the new signing algorithm B, without
                     disruption of service to legacy verifiers, is as follows:
                        </p>
<ol class="text">
<li>Signer signs with algorithm A 
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>Signer advertises that it signs with
                                 algorithm A
</dd>
</dl></blockquote>
                        
</li>
<li>Signer signs messages twice, with both algorithm A
                           and algorithm B
                           
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>The signer tests new signing configuration
</dd>
<dt>B.</dt>
<dd>Signer advertises that it signs with either
                                 algorithm A or algorithm B
</dd>
</dl></blockquote>
                        
</li>
<li>Signer determines that support for Algorithm A is
                           no longer necessary
</li>
<li>Signer determines that support for algorithm A is
                           to be withdrawn 
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>Signer removes advertisement for Algorithm A
</dd>
<dt>B.</dt>
<dd>Signer waits for cached copies of earlier
                                 signature policy to expire
</dd>
<dt>C.</dt>
<dd>Signer stops signing with Algorithm A
</dd>
</dl></blockquote>
                        
</li>
</ol>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.2"></a><h3>3.6.2.&nbsp;
Verifier transition strategy</h3>

<p> The actions of the verifier are independent of the
                     signer's actions and do not need to be performed in a
                     particular sequence. The verifier may make a decision to
                     cease accepting algorithm A without first deploying
                     support for algorithm B. Similarly a verifier may be
                     upgraded to support algorithm B without requiring
                     algorithm A to be withdrawn. The decisions of the
                     verifier must make are therefore: </p>
<ul class="text">
<li>The verifier MAY change the degree of confidence
                           associated with any signature at any time,
                           including determining that a given signature
                           algorithm provides a limited assurance of
                           authenticity at a given key strength. 
<ul class="text">
<li>A verifier MAY evaluate signature records in
                                 any order it chooses, including using the
                                 signature algorithm to choose the order.
</li>
</ul>
                        
</li>
<li>The verifier MAY make a determination that
                           Algorithm A does not offer a useful level of
                           security, or that the cost of verifying the
                           signature is less than the value of doing so. 
<ul class="text">
<li>In this case the verifier would ignore
                                 signatures created using algorithm A and
                                 references to algorithm A in policy records
                                 would be treated as if the algorithm were not
                                 implemented.
</li>
</ul>
                        
</li>
<li>The verifier MAY decide to add support for
                           additional signature algorithms at any time. 
<ul class="text">
<li>The verifier MAY add support for algorithm B
                                 at any time.
</li>
</ul>
                        
</li>
</ul><p>
                  
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Migrating from DomainKeys</h3>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7.1"></a><h3>3.7.1.&nbsp;
Signing</h3>

<p>
                     </p>
<blockquote class="text">
<p>
                           </p>
<blockquote class="text"><dl>
<dt>DNS Records:  </dt>
<dd> DKIM is upwardly
                                 compatible with existing DomainKeys (DK)
                                    <a class='info' href='#RFC4870'>[RFC4870]<span> (</span><span class='info'>Delany, M., &ldquo;Domain-Based Email Authentication Using Public Keys Advertised in the DNS (DomainKeys),&rdquo; May&nbsp;2007.</span><span>)</span></a>
                                 DNS records, so that a DKIM module does
                                 not automatically require additional DNS
                                 administration! However DKIM has enhanced the
                                 DomainKeys DNS key record format by adding
                                 several additional optional parameters. 
</dd>
<dt>Boundary MTA:  </dt>
<dd> The principle use
                                 of DomainKeys is at Boundary MTAs. Because no
                                 operational transition is ever instantaneous,
                                 it is not adviseable for existing DomainKeys
                                 signers to switch to DKIM without continuing
                                 to perform DomainKeys signing. A signer
                                 should add a DKIM signature to a message that
                                 also has a DomainKeys signature, until such
                                 time as DomainKeys receive-side support is
                                 sufficiently reduced. With respect to signing
                                 policies, a reasonable, initial approach is
                                 to use DKIM signatures in the same way as
                                 DomainKeys signatures are already being used.
                              
</dd>
</dl></blockquote>
                        

</blockquote><p>
                  
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7.2"></a><h3>3.7.2.&nbsp;
Verifying</h3>

<p>
                     </p>
<blockquote class="text">
<p>
                           </p>
<blockquote class="text"><dl>
<dt>DNS Client:  </dt>
<dd>DNS queries for the
                                 DKIM key record, use the same Domain Name
                                 naming conventions as were used for DomainKeys, and the
                                 same basic record format. No changes to the
                                 DNS client should be required. 
</dd>
<dt>Verifying module:  </dt>
<dd> See the section on Signing
                                 above.
</dd>
</dl></blockquote>
                        

</blockquote><p>
                  
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
On-going Operations</h3>

<p>This section describes the basic steps for operation of email
               systems that use DKIM, after the capability has initially been
               deployed. The primary considerations are: </p>
<ul class="text">
<li> the upkeep of the selector files, and 
</li>
<li>the security of the private keys. 
</li>
</ul>

<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
DNS Signature Record Installation Considerations</h3>

<p> Even with use of the DNS, one challenge is that DNS record management is
                  usually operated by an administrative staff that is different from
                  those who operate an organization's email service. In order
                  to ensure that DKIM DNS records are accurate, this imposes a
                  requirement for careful coordination between the two
                  operations groups. 
</p>
<p> The key point to remember is that the DNS DKIM selectors
                  WILL and SHOULD be changed over time. Some reasons for
                  changing DKIM selectors are well understood, while others are
                  still theoretical. There are several schemes that may be
                  used to determine the policies for changing DKIM selectors:
                     </p>
<ul class="text">
<li>time based
</li>
<li>associations with clusters of servers
</li>
<li>the use of third party signers
</li>
<li>security considerations
</li>
</ul><p>
               
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Time Basis and Security Considerations</h3>

<p> The reason for changing the selector periodically is
                     usually related to the security exposure of a system.
                     When the potential exposure of the private keys
                     associated with the DKIM selector have reached sufficient
                     levels, the selector should be changed. (It is unclear
                     currently what kinds of metrics can be used to aid in
                     deciding when the exposure has reached sufficient levels
                     to warrant changing the selector.) 
</p>
<p> For example, </p>
<ul class="text">
<li> Selectors should be changed more frequently on
                           systems that are widely exposed, than on systems
                           that are less widely exposed. For example, a
                           gateway system that has numerous
                           externally-accessible services running on it, is
                           more widely exposed than one that ONLY runs a mail
                           server. 
</li>
<li> Selectors should be changed more frequently on
                           operating systems that are under wide attack. 
</li>
<li> While the use of DKIM information is transient,
                           keys with sufficient exposure do become stale and
                           should be changed. 
</li>
<li>Whenever you make a substantial system change, such
                           as bringing up a new server, or making a major
                           operating system change, you should consider
                           changing the selector. 
</li>
<li> Whenever there is either suspicion or evidence of
                           the compromise of the system or the private keys,
                           you should change the selector. 
</li>
</ul><p>
                  
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Deploying New Selectors</h3>

<p> A primary consideration in changing the selector is
                     remembering to change it. It needs to be a standard part
                     of the operational staff Methods and Procedures for your
                     systems. If they are separate, both the mail team and the
                     DNS team will be involved in deploying new selectors. 
</p>
<p> When deploying a new selector, it needs to be phased in:
                        </p>
<ol class="text">
<li>Generate the new public / private key pair and
                           create a new selector record with the public key in it.
</li>
<li>Add the new selector record to your DNS.
</li>
<li>Verify that the new selector record can be used to
                           verify signatures.
</li>
<li>Turn on signing with the new private key.
</li>
<li>Remove the old private key from your servers.
</li>
<li>After a period of time, remove the old selector
                           from your DNS.
</li>
</ol><p> The time an unused selector should be kept in the
                     DNS system is dependent on the reason it's being changed.
                     If the private key has definitely been exposed, the
                     corresponding selector should be removed immediately.
                     Otherwise, longer periods are allowable. 
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
Subdomain Considerations</h3>

<p> A Domain Name is the basis for making differential
                     quality assessments about a DKIM-signed message. It is
                     reasonable for a single organization to have a variety of
                     very different activities, which warrant a variety of
                     very different assessments. A convenient way to
                     distinguish among such activities is to sign with
                     different domain names. That is, the organization should
                     sign with sub-domain names that are used for different
                     organizational activities. 
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.4"></a><h3>4.1.4.&nbsp;
Delegating Signing Authority to a Third party</h3>

<p>Allowing third parties to sign email from your domain
                     opens your system security to include the security of the
                     third party's systems. At a minimum, you should not allow
                     the third parties to use the same selector and private
                     key as your main mail system. It is recommended that each
                     third party be given their own private key and selector.
                     This limits the exposure for any given private key, and
                     minimizes the impact if any given private key were
                     exposed. 
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Private Key Management</h3>

<p> The permissions of private key files must be carefully
                  managed. If key management hardware support is available, it
                  should be used. Auditing software should be used to
                  periodically verify that the permissions on the private key
                  files remain secure. 
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Example Uses</h3>

<p> A DKIM signature tells the signature verifier that the owner
               of a particular domain name accepts responsibility for the
               message. Combining this information with information that
               allows the history of the domain name owner to be assessed may
               allow processing the message, based on the probability that the
               message is likely to be trustworthy, or not, without the need
               for heuristic content analysis. 
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Protection of Internal Mail</h3>

<p>One identity is particularly amenable to easy and accurate
                  assessment: The organization's own identity. Members of an
                  organization tend to trust messages that purport to be from
                  within that organization. However Internet Mail does not
                  provide a straightforward means of determining whether such
                  mail is, in fact, from within the organization. DKIM can be
                  used to remedy this exposure. If the organization signs all
                  of its mail, then its boundary MTAs can look for mail
                  purporting to be from the organization but does not
                  contain a verifiable signature. Such mail can be presumed to
                  be spurious.
</p>
<p>
                  WHAT ABOUT MAIL TO A MAILING LIST THAT COMES BACK WITH A BROKEN SIGNATURE????
                  
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Recipient-based Assessments</h3>

<p> Recipients of large volumes of email can internally generate
                  reputation data for email senders. Recipients of
                  smaller volumes of messages are likely to need to acquire
                  reputation data from a third party. In either case the use
                  of reputation data is intrinsically limited to email senders
                  that have established a prior history of sending messages. 
</p>
<p> In fact, an email receiving service may be in a position to
                  establish bilateral agreements with particular senders, such
                  as business partners or trusted bulk sending services.
                  Although it is not practical for each recipient to accredit
                  every sender, the definition of core networks of explicit trust
                  can be quite useful. 
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Third-party Reputation and Accreditation Services</h3>

<p>For scaling efficiency, it is appealing to use Trusted
                     Third Party reputation and accreditation services, to allow an email sender
                     to obtain a single assessment that is then recognized by
                     every email recipient that recognizes the Trusted Third
                     Party.
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
DKIM Support in the Client</h3>

<p> The DKIM specification is expected to be used primarily
                  between Boundary MTAs, or other infrastructure components of
                  the originating and receiving ADMDs. However there is
                  nothing in DKIM that is specific to those venues. In
                  particular, it should be possible to support signing and
                  verifying in MUAs.
</p>
<p> DKIM requires that all verifiers treat messages with
                  signatures that do not verify as if they are unsigned. If
                  verification in the client is to be acceptable to users, it
                  is also essential that successful verification of a
                  signature not result in a less than satisfactory user
                  experience compared to leaving the message unsigned. 
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Per user signatures</h3>

<p> Although DKIM's use of domain names is optimized for a
                  scope of organization-level signing, it is possible to administer
                  sub-domains and/or selectors in a way that
                  supports per-user signing. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>As stated earlier, it is important
                        to distinguish between the use of selectors for
                        differential administration of keys, versus the use of
                        sub-domains for differential reputations.
</dd>
</dl></blockquote><p> As a constraint on an authorized DKIM signing agent,
                  their associated key record can specify restrictions on the
                  email addresses permitted to be signed with that domain and
                  key. A typical intent of this feature is to allow a company
                  to delegate the signing authority for bulk marketing
                  communications without the risk of effectively delegating
                  the authority to sign messages purporting to come from the
                  domain-owning organization's CEO. 
</p>
<p>
                  </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd> Any scheme that involves
                        maintenance of a significant number of public keys is
                        likely to require infrastructure enhancements, to
                        support that management. For example, a system in
                        which the end user is required to generate a public
                        key pair and transmit it to the DNS administrator out
                        of band is not likely to meet acceptance criteria for
                        either usability or security. 
</dd>
</dl></blockquote><p>
               
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p> TBD 
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p> TBD 
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p> TBD 
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-openpgp-rfc2440bis">[I-D.ietf-openpgp-rfc2440bis]</a></td>
<td class="author-text">Callas, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-openpgp-rfc2440bis-22.txt">OpenPGP Message Format</a>,&rdquo; draft-ietf-openpgp-rfc2440bis-22 (work in progress), April&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-openpgp-rfc2440bis-22.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.kucherawy-sender-auth-header">[I-D.kucherawy-sender-auth-header]</a></td>
<td class="author-text">Kucherawy, M., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-kucherawy-sender-auth-header-20.txt">Message Header Field for Indicating Message Authentication Status</a>,&rdquo; draft-kucherawy-sender-auth-header-20 (work in progress), January&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-kucherawy-sender-auth-header-20.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0989">[RFC0989]</a></td>
<td class="author-text">Linn, J. and IAB Privacy Task Force, &ldquo;<a href="http://tools.ietf.org/html/rfc989">Privacy enhancement for Internet electronic mail: Part I: Message encipherment and authentication procedures</a>,&rdquo; RFC&nbsp;989, February&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc989.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names -
                  concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1848">[RFC1848]</a></td>
<td class="author-text"><a href="mailto:crocker@cybercash.com">Crocker, S.</a>, <a href="mailto:galvin@tis.com">Galvin, J.</a>, <a href="mailto:murphy@tis.com">Murphy, S.</a>, and <a href="mailto:ned@innosoft.com">N. Freed</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1848">MIME Object Security Services</a>,&rdquo; RFC&nbsp;1848, October&nbsp;1995 (<a href="http://www.rfc-editor.org/rfc/rfc1848.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1991">[RFC1991]</a></td>
<td class="author-text"><a href="mailto:warlord@MIT.EDU">Atkins, D.</a>, <a href="mailto:stallings@ACM.org">Stallings, W.</a>, and <a href="mailto:prz@acm.org">P. Zimmermann</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1991">PGP Message Exchange Formats</a>,&rdquo; RFC&nbsp;1991, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1991.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2440">[RFC2440]</a></td>
<td class="author-text"><a href="mailto:jon@pgp.com">Callas, J.</a>, <a href="mailto:lutz@iks-jena.de">Donnerhacke, L.</a>, <a href="mailto:hal@pgp.com">Finney, H.</a>, and <a href="mailto:rodney@unitran.com">R. Thayer</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2440">OpenPGP Message Format</a>,&rdquo; RFC&nbsp;2440, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2440.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2440.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2440.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2821">[RFC2821]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc2821">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;2821, April&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2821.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2822">[RFC2822]</a></td>
<td class="author-text">Resnick, P., &ldquo;<a href="http://tools.ietf.org/html/rfc2822">Internet Message Format</a>,&rdquo; RFC&nbsp;2822, April&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2822.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3156">[RFC3156]</a></td>
<td class="author-text">Elkins, M., Del Torto, D., Levien, R., and T. Roessler, &ldquo;<a href="http://tools.ietf.org/html/rfc3156">MIME Security with OpenPGP</a>,&rdquo; RFC&nbsp;3156, August&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3156.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3164">[RFC3164]</a></td>
<td class="author-text">Lonvick, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3164">The BSD Syslog Protocol</a>,&rdquo; RFC&nbsp;3164, August&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3164.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3851">[RFC3851]</a></td>
<td class="author-text">Ramsdell, B., &ldquo;<a href="http://tools.ietf.org/html/rfc3851">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification</a>,&rdquo; RFC&nbsp;3851, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4686">[RFC4686]</a></td>
<td class="author-text">Fenton, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified Mail (DKIM)</a>,&rdquo; RFC&nbsp;4686, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4686.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4870">[RFC4870]</a></td>
<td class="author-text">Delany, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4870">Domain-Based Email Authentication Using Public Keys Advertised in the DNS (DomainKeys)</a>,&rdquo; RFC&nbsp;4870, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4870.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tony Hansen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AT&amp;T Laboratories</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">200 Laurel Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Middletown, NJ  07748</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tony+dkimov@maillennium.att.com">tony+dkimov@maillennium.att.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Phillip Hallam-Baker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">VeriSign Inc.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:pbaker@verisign.com">pbaker@verisign.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dave Crocker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brandenburg InternetWorking</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">675 Spruce Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94086</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">dcrocker@bbiw.net</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
