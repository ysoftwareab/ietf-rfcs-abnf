SKEYID_d = prf(SKEYID, g^ir | CKY-I | CKY-R | 0)

SKEYID_a = prf(SKEYID, SKEYID_d | g^ir | CKY-I | CKY-R | 1)

SKEYID_e = prf(SKEYID, SKEYID_a | g^ir | CKY-I | CKY-R | 2)

I-digest = prf(SKEYID, g^i | g^r | CKY-I | CKY-R | SAi_b | ID_i1_b)

R-digest = prf(SKEYID, g^r | g^i | CKY-R | CKY-I | SAi_b | ID_r1_b)

digest = prf(key, msg)

digest = hash(key | msg)

I-digest = SHA(SKEYID | g^i | g^r | CKY-I | CKY-R | SAi_b |
                     ID_i1_b)

R-digest = SHA(SKEYID | g^r | g^i | CKY-R | CKY-I | SAi_b |
                     ID_r1_b)

A = g^k mod p
B = y^k * M mod p

Ne_i = prf(Ni_b, CKY-I)
Ne_r = prf(Nr_b, CKY-R)

K = K1 | K2 | K3 and
K1 = prf(Ne_i, 0)
K2 = prf(Ne_i, K1)
K3 = prf(Ne_i, K2)

KEYMAT = prf(SKEYID_d, protocol | SPI | Ni_b | Nr_b )

KEYMAT = prf(SKEYID_d, g(qm)^xy | protocol | SPI | Ni_b | Nr_b )

KEYMAT = K1 | K2 | K3 | ...
K1 = prf(SKEYID_d, [ g(qm)^xy | ] protocol | SPI | Ni_b | Nr_b )
K2 = prf(SKEYID_d, K1 | [ g(qm)^xy | ] protocol | SPI | Ni_b |
               Nr_b )
K3 = prf(SKEYID_d, K2 | [ g(qm)^xy | ] protocol | SPI | Ni_b |
               Nr_b )
HASH = prf(SKEYID_a, M-ID | N/D)

BLOCK1-8 = prf(pre-shared-key, Ni_b | Nr_b)
BLOCK9-16 = prf(pre-shared-key, BLOCK1-8 | Ni_b | Nr_b)
BLOCK17-24 = prf(pre-shared-key, BLOCK9-16 | Ni_b | Nr_b)
       and
SKEYID = BLOCK1-8 | BLOCK9-16 | BLOCK17-24

BLOCK1-8 = prf(SKEYID, g^ir | CKY-I | CKY-R | 0) BLOCK9-16 =
SKEYID_d = BLOCK1-8 | BLOCK9-16 | BLOCK17-24

Ka = K1 | K2 | K3

K1 = prf(SKEYID_e, 0)
K2 = prf(SKEYID_e, K1)
K3 = prf(SKEYID_e, K2)

