<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>An EAP Authentication Method Based on the EKE Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="An EAP Authentication Method Based on the EKE Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">Y. Sheffer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Check Point</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">G. Zorn</td></tr>
<tr><td class="header">Expires: August 2, 2009</td><td class="header">Network Zen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 29, 2009</td></tr>
</table></td></tr></table>
<h1><br />An EAP Authentication Method Based on the EKE Protocol<br />draft-sheffer-emu-eap-eke-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 2, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The Extensible Authentication Protocol (EAP) describes a framework that allows the use of
        multiple authentication mechanisms. This document defines an authentication mechanism for
        EAP called EAP-EKE, based on the Encrypted Key Exchange (EKE) protocol. This method provides
        mutual authentication through the use of a short, easy to remember password.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#protocol">3.</a>&nbsp;
Protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.</a>&nbsp;
Protocol Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.2.</a>&nbsp;
Message Flows<br />
<a href="#anchor5">4.</a>&nbsp;
Packet Formats<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.</a>&nbsp;
EAP-EKE Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.</a>&nbsp;
EAP-EKE Payloads<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.3.</a>&nbsp;
EAP-EKE-ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.4.</a>&nbsp;
EAP-EKE-Commit<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.5.</a>&nbsp;
EAP-EKE-Confirm<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#eap-eke-failure">4.6.</a>&nbsp;
EAP-EKE-Failure and EAP-EKE-Protected-Failure<br />
<a href="#crypto">5.</a>&nbsp;
Cryptographic Operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.1.</a>&nbsp;
Generating Keying Material<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#commit-request">5.2.</a>&nbsp;
EAP-EKE-Commit/Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#commit-response">5.3.</a>&nbsp;
EAP-EKE-Commit/Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#confirm-request">5.4.</a>&nbsp;
EAP-EKE-Confirm/Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#confirm-response">5.5.</a>&nbsp;
EAP-EKE-Confirm/Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.6.</a>&nbsp;
MSK and EMSK<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.7.</a>&nbsp;
Mandatory Algorithms<br />
<a href="#iana">6.</a>&nbsp;
IANA Considerations<br />
<a href="#security">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor15">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#anchor18">Appendix&nbsp;A.</a>&nbsp;
Change Log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">A.1.</a>&nbsp;
-00<br />
<a href="#anchor20">Appendix&nbsp;B.</a>&nbsp;
Design Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">B.1.</a>&nbsp;
Number of Round Trips<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">B.2.</a>&nbsp;
Fragmentation<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The predominant access method for the Internet today is that of a human using a username
        and password to authenticate to a computer enforcing access control. Proof of knowledge of
        the password authenticates the human to the computer.
</p>
<p>Typically, these passwords are not stored on a user's computer for security reasons and
        must be entered each time the human desires network access. Therefore, the passwords must be
        ones that can be repeatedly entered by a human with a low probability of error. They will
        likely not possess high entropy and it may be assumed that an adversary with access to a
        dictionary will have the ability to guess a user's password. It is therefore desirable to
        have a robust authentication method that is secure even when used with a weak password in
        the presence of a strong adversary.
</p>
<p>EAP-EKE is an EAP method <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> that addresses the problem of
        password-based authenticated key exchange, using a possibly weak password for authentication
        and to derive an authenticated and cryptographically strong shared secret. This problem was
        first described by Bellovin and Merritt in <a class='info' href='#BM92'>[BM92]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; May&nbsp;1992.</span><span>)</span></a> and <a class='info' href='#BM93'>[BM93]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Augmented Encrypted Key Exchange: A Password-Based Protocol Secure against             Dictionary Attacks and Password File Compromise,&rdquo; 1993.</span><span>)</span></a>.
        Subsequently, a number of other solution approaches have been proposed, for example <a class='info' href='#JAB96'>[JAB96]<span> (</span><span class='info'>Jablon, D., &ldquo;Strong Password-Only Authenticated Key Exchange,&rdquo; October&nbsp;1996.</span><span>)</span></a>, <a class='info' href='#LUC97'>[LUC97]<span> (</span><span class='info'>Lucks, S., &ldquo;Open Key Exchange: How to Defeat Dictionary Attacks Without Encrypting Public Keys,&rdquo; 1997.</span><span>)</span></a>, <a class='info' href='#BMP00'>[BMP00]<span> (</span><span class='info'>Boyko, V., MacKenzie, P., and S. Patel, &ldquo;Provably Secure Password Authenticated Key Exchange Using Diffie-Hellman,&rdquo; 2000.</span><span>)</span></a>, and others.
</p>
<p> This proposal is based on the original Encrypted Key Exchange (EKE) proposal, as described
        in <a class='info' href='#BM92'>[BM92]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; May&nbsp;1992.</span><span>)</span></a>. None of the subsequent improvements have been incorporated.
        However, we have used only the subset of <a class='info' href='#BM92'>[BM92]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; May&nbsp;1992.</span><span>)</span></a> (namely the variant described
        in Section 3.1) which has withstood the test of time and is believed secure as of this
        writing.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="protocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protocol</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Protocol Overview</h3>

<p> EAP is a two-party protocol spoken between an EAP peer and an EAP server
        (also known as "authenticator"). An EAP method
          defines the specific authentication protocol being used by EAP. This memo defines a
          particular method and therefore defines the messages sent between the EAP server
          and the EAP peer for the purpose of authentication and key derivation. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Message Flows</h3>

<p>EAP-EKE defines three message exchanges: an Identity exchange, a Commit exchange and a
          Confirm exchange. A successful authentication is shown in <a class='info' href='#message-flows'>Figure&nbsp;1<span> (</span><span class='info'>A Successful EAP-EKE Exchange</span><span>)</span></a>.
</p>
<p>The peer and server use the EAP-EKE Identity exchange to learn each other's identities
          and to agree upon a ciphersuite to use in the subsequent exchanges. In the Commit exchange
          the peer and server exchange information to generate a shared key and also to bind each
          other to a particular guess of the password. In the Confirm exchange the peer and server
          prove liveness and knowledge of the password by generating and verifying verification
          data.
</p>
<p>
          <br /><hr class="insert" />
<a name="message-flows"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

           +--------+                                     +--------+
           |        |                  EAP-EKE-ID/Request |        |
           |  EAP   |&lt;------------------------------------|  EAP   |
           |  peer  |                                     | server |
           |  (P)   | EAP-EKE-ID/Response                 |   (S)  |
           |        |------------------------------------&gt;|        |
           |        |                                     |        |
           |        |              EAP-EKE-Commit/Request |        |
           |        |&lt;------------------------------------|        |
           |        |                                     |        |
           |        | EAP-EKE-Commit/Response             |        |
           |        |------------------------------------&gt;|        |
           |        |                                     |        |
           |        |             EAP-EKE-Confirm/Request |        |
           |        |&lt;------------------------------------|        |
           |        |                                     |        |
           |        | EAP-EKE-Confirm/Response            |        |
           |        |------------------------------------&gt;|        |
           |        |                                     |        |
           |        |          EAP-Success                |        |
           |        |&lt;------------------------------------|        |
           +--------+                                     +--------+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: A Successful EAP-EKE Exchange&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p> Schematically, the original exchange as described in <a class='info' href='#BM92'>[BM92]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; May&nbsp;1992.</span><span>)</span></a> (and with the
          roles reversed) is: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

Server                              Peer
------                              ----
E(Password, Y_S)) -&gt;
                      &lt;- E(Password, Y_P), E(SharedSecret, Nonce_P)
E(SharedSecret, Nonce_S | Nonce_P) -&gt;
                      &lt;- E(SharedSecret, Nonce_S)

</pre></div><p>
 The current protocol extends the basic cryptographic protocol, and the regular
          successful exchange becomes: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

EAP-EKE-ID/Request: S -&gt; P

   ID_S, CryptoProposals

EAP-EKE-ID/Response: S &lt;- P

   ID_P, CryptoSelection

EAP-EKE-Commit/Request: S -&gt; P

   E(Password, Y_S))

EAP-EKE-Commit/Response: S &lt;- P

   E(Password, Y_P), E(SharedSecret, Nonce_P)

EAP-EKE-Confirm/Request: S -&gt; P

   E(SharedSecret, Nonce_S | Nonce_P), Auth_S

EAP-EKE-Confirm/Response: S &lt;- P

   E(SharedSecret, Nonce_S), Auth_P

</pre></div><p>
 As shown in the exchange above, the following information elements are added to
          the original protocol: identity values for both protocol parties, negotiation of
          cryptographic protocols, and signature fields to protect the integrity of the negotiated
          parameters. 
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Packet Formats</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
EAP-EKE Header</h3>

<p>The EAP-EKE header consists of the standard EAP header (see Section 4 of <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>), followed an EAP-EKE exchange type. The header has the following
          structure:
</p>
<p>
          <br /><hr class="insert" />
<a name="eap-eke-header"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Code      |  Identifier   |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |   EKE-Exch    |              Data            ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: EAP-EKE Header&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p> The Code, Identifier, Length, and Type fields are all part of the EAP header, and
          defined in <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>. The Type field in the EAP header MUST be the value
          allocated by IANA for EAP-EKE version 1. 
</p>
<p> The EKE-Exch field identifies the type of EAP-EKE payload encapsulated in the Data
          field. This document defines the following values for the EKE-Exch field: </p>
<ul class="text">
<li>0x00: Reserved
</li>
<li>0x01: EAP-EKE-ID exchange
</li>
<li>0x02: EAP-EKE-Commit exchange
</li>
<li>0x03: EAP-EKE-Confirm exchange
</li>
<li>0x04: EAP-EKE-Failure exchange
</li>
<li>0x05: EAP-EKE-Protected-Failure exchange
</li>
</ul>

<p>Further values of this EKE-Exch field are available via IANA registration. 
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
EAP-EKE Payloads</h3>

<p>EAP-EKE payloads all contain the EAP-EKE header and encoded information, which differs
          for the different exchanges.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
EAP-EKE-ID</h3>

<p>
          <br /><hr class="insert" />
<a name="eap-eke-id-payload"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | ProposalNr    |   Reserved    |           Proposal           ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...    Proposal                  |    IDType     |  Identity    ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: EAP-EKE-ID Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>The EAP-EKE-ID payload contains the following fields:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>ProposalsNr:</dt>
<dd>
              <br />
The ProposalNr field contains the number of proposals
              subsequently contained in the Proposal field. In the EAP-EKE-ID/Request the ProposalNr
              field MUST NOT be set to zero (0) and in the EAP-EKE-ID/Response message the ProposalNr
              field MUST be set to one (1). The offered proposals in the Request are listed
              contiguously in priority order, most preferable first. The selected proposal in the
              Response MUST be fully identical with one of the offered proposals.<br />
<br />

</dd>
<dt>Proposal:</dt>
<dd><br />
Each proposal consists of four one-octet
              fields, in this order: <br />
<br />

              
<blockquote class="text"><dl>
<dt>Group Description:</dt>
<dd><br />
This field's value is taken
                  from the IANA registry for Diffie-Hellman groups defined in <a class='info' href='#iana-group'>Section&nbsp;6.4<span> (</span><span class='info'>Diffie-Hellman Group Registry</span><span>)</span></a>.<br />
<br />

</dd>
<dt>Encryption:</dt>
<dd><br />
This field's value is taken from
                  the IANA registry for encryption algorithms defined in <a class='info' href='#iana-enc'>Section&nbsp;6.1<span> (</span><span class='info'>Encryption Algorithm Registry</span><span>)</span></a>.<br />
<br />

</dd>
<dt>PRF:</dt>
<dd><br />
This field's value is taken from the IANA
                  registry for pseudo random functions defined in <a class='info' href='#iana-prf'>Section&nbsp;6.2<span> (</span><span class='info'>Pseudo Random Function Registry</span><span>)</span></a>.<br />
<br />

</dd>
<dt>MAC:</dt>
<dd><br />
This field's value is taken from the IANA
                  registry for keyed message digest algorithms defined in <a class='info' href='#iana-mac'>Section&nbsp;6.3<span> (</span><span class='info'>Keyed Message Digest Registry</span><span>)</span></a>
                  used to provide integrity protection.<br />
<br />

</dd>
</dl></blockquote>
</dd>
<dt>IDType</dt>
<dd><br />
Denotes the Identity type. This is taken
              from the IANA registry defined in <a class='info' href='#iana'>Section&nbsp;6<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>. The server and the peer MAY
              use different identity types.
</dd>
</dl></blockquote><p>
        
</p>
<p>The Identity field is always printable, and its meaning depends on the values of the Code
          and IDType fields.
</p>
<p>
          </p>
<ul class="text">
<li>EAP-EKE-ID/Request: server ID
</li>
<li>EAP-EKE-ID/Response: peer ID
</li>
</ul><p>
        
</p>
<p>The server SHOULD assert its own identity (e.g. its host name), or it MAY use the peer's
          identity if it knows it before the protocol starts.
</p>
<p>The length of the Identity is computed from the Length field in the EAP header.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
EAP-EKE-Commit</h3>

<p>In this exchange both parties send their encrypted ephemeral public key, and the peer
          also includes a Challenge.
</p>
<p>
          <br /><hr class="insert" />
<a name="eap-eke-commit-payload"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         DHComponent                                           ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Commit_P                                            ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: EAP-EKE-Commit Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>DHComponent:</dt>
<dd>
              <br />
This field contains the password-encrypted Diffie-Hellman
              public key, see <a class='info' href='#commit-request'>Section&nbsp;5.2<span> (</span><span class='info'>EAP-EKE-Commit/Request</span><span>)</span></a>.<br />
<br />

</dd>
<dt>Commit_P:</dt>
<dd>
              <br />
This field only appears in the response, and contains the
              encrypted challenge value sent by the peer. See <a class='info' href='#commit-response'>Section&nbsp;5.3<span> (</span><span class='info'>EAP-EKE-Commit/Response</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
EAP-EKE-Confirm</h3>

<p>In this exchange both parties complete the authentication by generating a shared
          temporary key, authenticating the entire protocol, and generating key material for the EAP
          consumer protocol.
</p>
<p>
          <br /><hr class="insert" />
<a name="eap-eke-confirm-payload"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Confirm_?                                            ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Auth_?                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: EAP-EKE-Confirm Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Confirm_?:</dt>
<dd>
              <br />
This field contains the encrypted response to the other peer's
              challenge, see <a class='info' href='#confirm-request'>Section&nbsp;5.4<span> (</span><span class='info'>EAP-EKE-Confirm/Request</span><span>)</span></a> and <a class='info' href='#confirm-response'>Section&nbsp;5.5<span> (</span><span class='info'>EAP-EKE-Confirm/Response</span><span>)</span></a>.<br />
<br />

</dd>
<dt>Auth_?</dt>
<dd>
              <br />
This field signs the Identity and the negotiated fields, to
              prevent downgrade attacks. See <a class='info' href='#confirm-request'>Section&nbsp;5.4<span> (</span><span class='info'>EAP-EKE-Confirm/Request</span><span>)</span></a> and <a class='info' href='#confirm-response'>Section&nbsp;5.5<span> (</span><span class='info'>EAP-EKE-Confirm/Response</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
        
</p>
<a name="eap-eke-failure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
EAP-EKE-Failure and EAP-EKE-Protected-Failure</h3>

<p> The EAP-EKE-Failure message format is defined as follows: <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Failure-Code                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;EAP-EKE-Failure Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p> The EAP-EKE-Protected-Failure payload format is defined as follows: <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Failure-Code                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
...                       MAC                                  ...
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;EAP-EKE-Protected-Failure Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>The MAC field contains the keyed message digest computed with the MAC algorithm selected
          during the initial exchange computed over the Failure-Code using the MAC key (see <a class='info' href='#crypto'>Section&nbsp;5<span> (</span><span class='info'>Cryptographic Operations</span><span>)</span></a> on how this key is derived). A protected failure response can only be
          returned once the MAC key has been derived.
</p>
<p>Currently the following Failure-Code values are defined: </p>
<ul class="text">
<li>0x00000000: Reserved
</li>
<li>0x00000001: No Error
</li>
<li>0x00000002: Protocol Error
</li>
<li>0x00000003: Password Not Found
</li>
<li>0x00000004: Authentication Failure
</li>
<li>0x00000005: Authorization Failure
</li>
<li>0x00000006: No Proposal Chosen
</li>
</ul><p>
        
</p>
<p>Additional values of this field are available via IANA registration. 
</p>
<p>"No Error" is used for failure acknowledgement, see below.
        "Protocol Error" indicates a failure to parse or understand a protocol message or one
        of its payloads.
        "Password Not Found" indicates a password for a particular user could not be located, making
          authentication impossible.
          "Authentication Failure" indicates failure in the cryptographic
          computation most likely caused by an incorrect password, or an inappropriate identity type.
          "Authorization Failure" indicates that
          while the password being used is correct, the user is not authorized to connect.
          "No Proposal Chosen" indicates that the peer is unwilling to select any of the
          cryptographic proposals offered by the server.
          
</p>
<p>
          When the peer encounters an error situation, it MUST respond with either EAP-EKE-Failure or
          EAP-EKE-Protected-Failure, depending on whether it believes a common MAC key has been
          agreed upon. The server MUST send an EAP-Failure message to end the exchange.
          
</p>
<p>
          When the server encounters an error situation, it MUST respond with either EAP-EKE-Failure or
          EAP-EKE-Protected-Failure, depending on whether it believes a common MAC key has been
          agreed upon. The peer MUST send back either EAP-EKE-Failure or
          EAP-EKE-Protected-Failure (corresponding to the server's selection), containing a "No Error"
          failure code. Then the server MUST send an EAP-Failure message to end the exchange.
          
</p>
<a name="crypto"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Cryptographic Operations</h3>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Generating Keying Material</h3>

<p>Keying material will always be derived as the output of the negotiated prf algorithm.
          Since the amount of keying material needed may be greater than the size of the output of
          the prf algorithm, we will use the prf iteratively. We will use the terminology prf+ to
          describe the function that outputs a pseudo-random stream based on the inputs to a prf as
          follows: (where | indicates concatenation)
</p>
<p>
          </p>
<blockquote class="text">
<p>prf+ (K,S) = T1 | T2 | T3 | T4 | ...
</p>
</blockquote><p>
        
</p>
<p> where: </p>
<blockquote class="text">
<p>T1 = prf (K, S | 0x01)
</p>
<p>T2 = prf (K, T1 | S | 0x02)
</p>
<p>T3 = prf (K, T2 | S | 0x03)
</p>
<p>T4 = prf (K, T3 | S | 0x04)
</p>
</blockquote><p>
        
</p>
<p> continuing as needed to compute all required keys. The keys are taken from the output
          string without regard to boundaries (e.g., if the required keys are a 256-bit Advanced
          Encryption Standard (AES) key and a 160-bit HMAC key, and the prf function generates 160
          bits, the AES key will come from T1 and the beginning of T2, while the HMAC key will come
          from the rest of T2 and the beginning of T3). 
</p>
<p> The constant concatenated to the end of each string feeding the prf is a single octet.
          prf+ in this document is not defined beyond 255 times the size of the prf output. 
</p>
<a name="commit-request"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
EAP-EKE-Commit/Request</h3>

<p>The server computes 
</p>
<p>
          </p>
<blockquote class="text">
<p>DHValue_S = g^x mod N,
</p>
</blockquote><p>
        
</p>
<p>where 'x' is a randomly chosen number in the range 2 .. N-1. The randomly chosen number
          is the private key, and the calculated field is the corresponding public key. The
          calculated value MUST NOT be zero modulo N. If the peer receives a bad value for this
          field, it MUST take action to disconnect or disable the link. Each of the peers MUST use a
          fresh, random value for this field on each run of the protocol.
</p>
<p>The server transmits
</p>
<p>
          </p>
<blockquote class="text">
<p>DHComponent_S = E(prf+(password, "EAP-EKE Password"), DHValue_S),
</p>
</blockquote><p>
        
</p>
<p>encrypted using the algorithm negotiated during the previous exchange. If required by the
          encryption algorithm/mode, the encrypted field is preceded by an Initialization Vector
          (IV), whose length depends on the algorithm.
</p>
<p>In many cases (e.g. CBC mode) it may be necessary to pad DHValue_S on the right, to fit
          the encryption algorithm's block size. In such cases, random padding MUST be used, and
          this randomness is critical to the security of the protocol. Randomness recommendations
          can be found in <a class='info' href='#RFC4086'>[RFC4086]<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Requirements for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a>. When decrypting this field, the real length of
          DHValue_S is determined according to the negotiated Diffie Hellman group.
</p>
<p>If the password needs to be stored on the server, it is RECOMMENDED to store the
          randomized password value, i.e. prf+(password, ...), as a password-equivalent, rather than
          the cleartext password.
</p>
<a name="commit-response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
EAP-EKE-Commit/Response</h3>

<p>The peer computes
</p>
<p>
          </p>
<blockquote class="text">
<p>DHValue_P = g^y mod N
</p>
</blockquote><p>
        
</p>
<p>and sends
</p>
<p>
          </p>
<blockquote class="text">
<p>DHComponent_P = E(prf+(password, "EAP-EKE Password"), DHValue_P)
</p>
</blockquote><p>
        
</p>
<p>If the password is non-ASCII, it SHOULD be normalized by the peer before the EAP-EKE
          message is constructed. The normalization method is SASLprep, <a class='info' href='#RFC4013'>[RFC4013]<span> (</span><span class='info'>Zeilenga, K., &ldquo;SASLprep: Stringprep Profile for User Names and Passwords,&rdquo; February&nbsp;2005.</span><span>)</span></a>.
          Note that the password is not null-terminated.
</p>
<p>Both sides calculate 
</p>
<p>
          </p>
<blockquote class="text">
<p>DHShared = g^(x*y) mod N
</p>
</blockquote><p>
        
</p>
<p>The encryption key is computed: 
</p>
<p>
          </p>
<blockquote class="text">
<p>Ke = prf+(DHShared, "EAP-EKE Ke" | ID_S | ID_P)
</p>
</blockquote><p>
        
</p>
<p>The MAC key is computed:
</p>
<p>
          </p>
<blockquote class="text">
<p>MAC = prf+(DHShared, "EAP-EKE MAC" | ID_S | ID_P)
</p>
</blockquote><p>
        
</p>
<p>And the peer generates 
</p>
<p>
          </p>
<blockquote class="text">
<p>Challenge_P = E(Ke, Nonce_P),
</p>
</blockquote><p>
        
</p>
<p>where Nonce_P is a randomly generated binary string. Nonce_P has length equal to the
          block size of E for block ciphers, or 32 octets if E is a stream cipher.
</p>
<a name="confirm-request"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
EAP-EKE-Confirm/Request</h3>

<p>The server sends:
</p>
<p>
          </p>
<blockquote class="text">
<p>Commit_S = E(Ke, Nonce_P | Nonce_S),
</p>
</blockquote><p>
        
</p>
<p>where Nonce_S is a randomly generated string, similar to Nonce_P.
</p>
<p>It computes: 
</p>
<p>
          </p>
<blockquote class="text">
<p>Ka = prf+(DHShared, "EAP-EKE Ka" | ID_S | ID_P | Nonce_P | Nonce_S)
</p>
</blockquote><p>
        
</p>
<p>And sends:
</p>
<p>
          </p>
<blockquote class="text">
<p>Auth_S = prf(Ka, "EAP-EKE server" | EAP-EKE-ID/Request | EAP-EKE-ID/Response |
              EAP-EKE-Commit_S | EAP-EKE-Commit_P),
</p>
</blockquote><p>
        
</p>
<p>where the literal string is encoded using ASCII with no zero terminator. The messages are
          included in full, starting with the EAP header, and including any possible future
          extensions.
</p>
<a name="confirm-response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
EAP-EKE-Confirm/Response</h3>

<p>The peer computes Ka, and sends:
</p>
<p>
          </p>
<blockquote class="text">
<p>Commit_P = E(Ke, Nonce_S)
</p>
<p>Auth_P = prf(Ka, "EAP-EKE peer" | EAP-EKE-ID/Request | EAP-EKE-ID/Response |
              EAP-EKE-Commit_S | EAP-EKE-Commit_P)
</p>
</blockquote><p>
        
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
MSK and EMSK</h3>

<p>Following the last message of the protocol, both sides compute and export the shared
          keys, each 512 bits in length:
</p>
<p>
          </p>
<blockquote class="text">
<p>MSK = prf+(DHShared, "EAP-EKE MSK" | ID_S | ID_P | Nonce_P | Nonce_S)
</p>
<p>EMSK = prf+(DHShared, "EAP-EKE EMSK" | ID_S | ID_P | Nonce_P | Nonce_S)
</p>
</blockquote><p>
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
Mandatory Algorithms</h3>

<p>To facilitate interoperability, the following algorithms are mandatory to implement:
</p>
<p>
          </p>
<ul class="text">
<li>ENCR_AES128_CBC (encryption algorithm)
</li>
<li>PRF_HMAC_SHA1 (pseudo random function and keyed message digest)
</li>
<li>DHGROUP_14 (DH-group)
</li>
</ul><p>
        
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document allocates an EAP method type, for "EAP-EKE Version 1".
</p>
<p>This document requires IANA to create the registries described in the subsequent sections.
        Values can be added or modified in these registries per
        Specification Required <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>. 
</p>
<a name="iana-enc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Encryption Algorithm Registry</h3>

<p>This section defines an IANA registry for encryption algorithms: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

+-----------------+---------+----------------------------------+
| Name            | Value   | Definition                       |
+-----------------+---------+----------------------------------+
| Reserved        | 0       |                                  |
| ENCR_AES128_CBC | 1       | AES with a 128-bit key, CBC mode |
|                 | 2-127   | Available for allocation via IANA|
|                 | 128-255 | Reserved for private use         |
+-----------------+---------+----------------------------------+

</pre></div><p>

        
</p>
<a name="iana-prf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Pseudo Random Function Registry</h3>

<p>This section defines an IANA registry for pseudo random function algorithms: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

+---------------+---------+-------------------------------------+
| Name          | Value   | Definition                          |
+---------------+---------+-------------------------------------+
| Reserved      | 0       |                                     |
| PRF_HMAC_SHA1 | 1       | HMAC SHA-1, as defined in [RFC2104] |
|               | 2-127   | Available for allocation via IANA   |
|               | 128-255 | Reserved for private use            |
+---------------+---------+-------------------------------------+

</pre></div><p>

        
</p>
<a name="iana-mac"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Keyed Message Digest Registry</h3>

<p>This section defines an IANA registry for keyed message digest algorithms: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

+---------------+---------+-------------------------------------+
| Name          | Value   | Definition                          |
+---------------+---------+-------------------------------------+
| Reserved      | 0       |                                     |
| PRF_HMAC_SHA1 | 1       | HMAC SHA-1, as defined in [RFC2104] |
|               | 2-127   | Available for allocation via IANA   |
|               | 128-255 | Reserved for private use            |
+---------------+---------+-------------------------------------+

</pre></div><p>

        
</p>
<a name="iana-group"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Diffie-Hellman Group Registry</h3>

<p>This section defines an IANA registry for Diffie-Hellman groups: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

+------------+---------+--------------------------------------------+
| Name       | Value   | Definition                                 |
+------------+---------+--------------------------------------------+
| Reserved   | 0       |                                            |
| DHGROUP_14 | 1       | 2048-bit MODP Group (#14), as defined in   |
|            |         | [RFC3526]                                  |
|            | 2-127   | Available for allocation via IANA          |
|            | 128-255 | Reserved for private use                   |
+------------+---------+--------------------------------------------+

</pre></div><p>

        
</p>
<a name="iana-identity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Identity Type Registry</h3>

<p>In addition, an identity type registry is defined: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   +-----------+---------+---------------------------------------------+
   | Name      | Value   | Definition                                  |
   +-----------+---------+---------------------------------------------+
   | Reserved  | 0       |                                             |
   | ID_OPAQUE | 1       | A printable string whose format is          |
   |           |         | undefined                                   |
   | ID_NAI    | 2       | A Network Access Identifier, as defined in  |
   |           |         | [RFC4282] (mandatory to implement)          |
   | ID_IPv4   | 3       | An IPv4 address, in binary format           |
   | ID_IPv6   | 4       | An IPv6 address, in binary format           |
   | ID_FQDN   | 5       | A fully qualified domain name (mandatory to |
   |           |         | implement)                                  |
   |           | 6-127   | Available for allocation via IANA           |
   |           | 128-255 | Reserved for private use                    |
   +-----------+---------+---------------------------------------------+

</pre></div><p>

        
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
Failure-Code Registry</h3>

<p>This section defines an IANA registry for the Failure-Code registry, a 32-bit long code.
        Initial values are defined in <a class='info' href='#eap-eke-failure'>Section&nbsp;4.6<span> (</span><span class='info'>EAP-EKE-Failure and EAP-EKE-Protected-Failure</span><span>)</span></a>. All values up to 0xff000000 are
        available for allocation via IANA. The remaining values
        up to 0xffffffff are available for private use.
        
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>Any protocol that claims to solve the problem of password-authenticated key exchange must
        be resistant to active, passive and dictionary attack and have the quality of forward
        secrecy. These characteristics are discussed further in the following paragraphs.
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>Resistance to Passive Attack</dt>
<dd> A passive attacker is one that merely relays
            messages back and forth between the peer and server, faithfully, and without
            modification. The contents of the messages are available for inspection, but that is
            all. To achieve resistance to passive attack, such an attacker must not be able to
            obtain any information about the password or anything about the resulting shared secret
            from watching repeated runs of the protocol. Even if a passive attacker is able to learn
            the password, she will not be able to determine any information about the resulting
            secret shared by the peer and server.
</dd>
<dt>Resistance to Active Attack</dt>
<dd> An active attacker is able to modify, add,
            delete, and replay messages sent between protocol participants. For this protocol to be
            resistant to active attack, the attacker must not be able to obtain any information
            about the password or the shared secret by using any of its capabilities. In addition,
            the attacker must not be able to fool a protocol participant into thinking that the
            protocol completed successfully. It is always possible for an active attacker to deny
            delivery of a message critical in completing the exchange. This is no different than
            dropping all messages and is not an attack against the protocol.
</dd>
<dt>Resistance to Dictionary Attack</dt>
<dd> For this protocol to be resistant to
            dictionary attack any advantage an adversary can gain must be directly related to the
            number of interactions she makes with an honest protocol participant and not through
            computation. The adversary will not be able to obtain any information about the password
            except whether a single guess from a single protocol run is correct or incorrect.
</dd>
<dt>Forward Secrecy</dt>
<dd> Compromise of the password must not provide any information
            about the secrets generated by earlier runs of the protocol.
</dd>
</dl></blockquote><p>
      
</p>
<p>
        <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> requires that documents describing new EAP methods clearly
        articulate the security properties of the method. In addition, for use with wireless LANs,
          <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a> mandates and recommends several of these. The claims are: </p>
<ol class="text">
<li>Mechanism: password.
</li>
<li>Claims: 
<ul class="text">
<li>Mutual authentication: the peer and server both authenticate each other by proving
                possession of a shared password. This is REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Forward secrecy: compromise of the password does not reveal the secret keys (MSK
                and EMSK) from earlier runs of the protocol.
</li>
<li>Replay protection: an attacker is unable to replay messages from a previous
                exchange either to learn the password or a key derived by the exchange. Similarly
                the attacker is unable to induce either the peer or server to believe the exchange
                has successfully completed when it hasn't.
</li>
<li>Key derivation: a shared secret is derived by performing a group operation in a
                finite cyclic group (e.g. exponentiation) using secret data contributed by both the
                peer and server. An MSK and EMSK are derived from that shared secret. This is
                REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Dictionary attack resistance: an attacker can only make one password guess per
                active attack. The advantage she can gain is through interaction not through
                computation. This is REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Session independence: this protocol is resistant to active and passive attacks and
                does not enable compromise of subsequent or prior MSKs or EMSKs from either passive
                or active attacks.
</li>
<li>Denial of Service resistance: it is possible for an attacker to cause a server to
                allocate state and consume CPU. Such an attack is gated, though, by the requirement
                that the attacker first obtain connectivity through a lower-layer protocol (e.g.
                802.11 authentication followed by 802.11 association, or 802.3 "link-up") and
                respond to two EAP messages--the EAP-ID/ Request and the EAP-EKE-ID/Request.
</li>
<li>Man-in-the-Middle Attack resistance: this exchange is resistant to active attack,
                which is a requirement for launching a man-in-the-middle attack. This is REQUIRED by
                  <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Shared state equivalence: upon completion of EAP-EKE the peer and server both agree
                on MSK, EMSK. The peer has authenticated the server based on the Server_ID and the
                server has authenticated the peer based on the Peer_ID. This is due to the fact that
                Peer_ID, Server_ID, and the generated shared secret are all combined to make the
                authentication element which must be shared between the peer and server for the
                exchange to complete. This is REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Fragmentation: this protocol does not define a technique for fragmentation and
                reassembly.
</li>
<li>Resistance to "Denning-Sacco" attack: learning keys distributed from an earlier run
                of the protocol, such as the MSK or EMSK, will not help an adversary learn the
                password.
</li>
</ul>
</li>
<li>Key strength: the strength of the resulting key depends on the finite cyclic group
            chosen. For example, <a class='info' href='#RFC5114'>[RFC5114]<span> (</span><span class='info'>Lepinski, M. and S. Kent, &ldquo;Additional Diffie-Hellman Groups for Use with IETF Standards,&rdquo; January&nbsp;2008.</span><span>)</span></a> defines new groups available for use with
            this protocol. Using groups from <a class='info' href='#RFC5114'>[RFC5114]<span> (</span><span class='info'>Lepinski, M. and S. Kent, &ldquo;Additional Diffie-Hellman Groups for Use with IETF Standards,&rdquo; January&nbsp;2008.</span><span>)</span></a> the strength can vary from 80
            bits (for the 1024-bit MODP with 160-bit Prime Subgroup) to 256 bits (for the 521-bit
            Random ECP Group). Other groups can be defined and the strength of those groups depends
            on their definition. This is REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Key hierarchy: MSKs and EMSKs are derived from the secret values generated during the
            protocol run, using a negotiated pseudo-random function.
</li>
<li>Vulnerabilities (note that none of these are REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>):
              
<ul class="text">
<li>Protected ciphersuite negotiation: the ciphersuite proposal made by the server is
                not protected from tampering by an active attacker. However if a proposal was
                modified by an active attacker it would result in a failure to confirm the message
                sent by the other party, since the proposal is bound by each side into its Confirm
                message, and the protocol would fail as a result.
</li>
<li>Confidentiality: none of the messages sent in this protocol are encrypted.
</li>
<li>Integrity protection: all messages in this protocol are integrity protected.
</li>
<li>Channel binding: this protocol does not enable the exchange of integrity-protected
                channel information that can be compared with values communicated via out-of-band
                mechanisms.
</li>
<li>Fast reconnect: this protocol does not provide a fast reconnect capability.
</li>
<li>Cryptographic binding: this protocol is not a tunneled EAP method and therefore has
                no cryptographic information to bind.
</li>
<li>Identity protection: the EAP-EKE-ID exchange is not protected. An attacker will see
                the server's identity in the EAP-EKE-ID/Request and see the peer's identity in
                EAP-EKE-ID/ Response.
</li>
</ul>
</li>
</ol>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>Much of this document was unashamedly picked from <a class='info' href='#I-D.harkins-emu-eap-pwd'>[I&#8209;D.harkins&#8209;emu&#8209;eap&#8209;pwd]<span> (</span><span class='info'>Harkins, D. and G. Zorn, &ldquo;EAP Authentication Using Only A Password,&rdquo; April&nbsp;2010.</span><span>)</span></a>
        and <a class='info' href='#I-D.ietf-pppext-eap-srp-03'>[I&#8209;D.ietf&#8209;pppext&#8209;eap&#8209;srp&#8209;03]<span> (</span><span class='info'>Carlson, J., Aboba, B., and H. Haverinen, &ldquo;EAP SRP-SHA1 Authentication Protocol,&rdquo; July&nbsp;2001.</span><span>)</span></a>, and we would like to acknowledge the
        authors of these documents: Dan Harkins, Glen Zorn, James Carlson, Bernard Aboba and Henry
        Haverinen.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2284">[RFC2284]</a></td>
<td class="author-text"><a href="mailto:ljb@merit.edu">Blunk, L.</a> and <a href="mailto:jrv@merit.edu">J. Vollbrecht</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2284">PPP Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;2284, March&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2284.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2284.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2284.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3526">[RFC3526]</a></td>
<td class="author-text">Kivinen, T. and M. Kojo, &ldquo;<a href="http://tools.ietf.org/html/rfc3526">More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)</a>,&rdquo; RFC&nbsp;3526, May&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3526.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4013">[RFC4013]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4013">SASLprep: Stringprep Profile for User Names and Passwords</a>,&rdquo; RFC&nbsp;4013, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4013.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4282">[RFC4282]</a></td>
<td class="author-text">Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc4282">The Network Access Identifier</a>,&rdquo; RFC&nbsp;4282, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4282.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="BM92">[BM92]</a></td>
<td class="author-text">Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; Proc. IEEE Symp. on Research in Security and Privacy&nbsp;, May&nbsp;1992.</td></tr>
<tr><td class="author-text" valign="top"><a name="BM93">[BM93]</a></td>
<td class="author-text">Bellovin, S. and M. Merritt, &ldquo;Augmented Encrypted Key Exchange: A Password-Based Protocol Secure against
            Dictionary Attacks and Password File Compromise,&rdquo; Proc. 1st ACM Conference on Computer and Communication Security&nbsp;, 1993.</td></tr>
<tr><td class="author-text" valign="top"><a name="BMP00">[BMP00]</a></td>
<td class="author-text">Boyko, V., MacKenzie, P., and S. Patel, &ldquo;Provably Secure Password Authenticated Key Exchange Using Diffie-Hellman,&rdquo; Advances in Cryptology &#226;&#8364;&#8221; EUROCRYPT 2000&nbsp;, 2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.harkins-emu-eap-pwd">[I-D.harkins-emu-eap-pwd]</a></td>
<td class="author-text">Harkins, D. and G. Zorn, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-harkins-emu-eap-pwd-14.txt">EAP Authentication Using Only A Password</a>,&rdquo; draft-harkins-emu-eap-pwd-14 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-harkins-emu-eap-pwd-14.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-pppext-eap-srp-03">[I-D.ietf-pppext-eap-srp-03]</a></td>
<td class="author-text">Carlson, J., Aboba, B., and H. Haverinen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pppext-eap-srp-03.txt">EAP SRP-SHA1 Authentication Protocol</a>,&rdquo; draft-ietf-pppext-eap-srp-03 (work in progress), July&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="JAB96">[JAB96]</a></td>
<td class="author-text">Jablon, D., &ldquo;Strong Password-Only Authenticated Key Exchange,&rdquo; ACM Computer Communications Review&nbsp;Volume 1, Issue 5, October&nbsp;1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="LUC97">[LUC97]</a></td>
<td class="author-text">Lucks, S., &ldquo;Open Key Exchange: How to Defeat Dictionary Attacks Without Encrypting Public Keys,&rdquo; Proc. of the Security Protocols Workshop&nbsp;LNCS 1361, 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4017">[RFC4017]</a></td>
<td class="author-text">Stanley, D., Walker, J., and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc4017">Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs</a>,&rdquo; RFC&nbsp;4017, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4017.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4086">[RFC4086]</a></td>
<td class="author-text">Eastlake, D., Schiller, J., and S. Crocker, &ldquo;<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>,&rdquo; BCP&nbsp;106, RFC&nbsp;4086, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4086.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5114">[RFC5114]</a></td>
<td class="author-text">Lepinski, M. and S. Kent, &ldquo;<a href="http://tools.ietf.org/html/rfc5114">Additional Diffie-Hellman Groups for Use with IETF Standards</a>,&rdquo; RFC&nbsp;5114, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5114.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
</table>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change Log</h3>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
-00</h3>

<p>Initial version.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Design Options</h3>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
Number of Round Trips</h3>

<p>We have looked at three options: 2 round trips, 3 round trips, and a normal run of 2
          round trips with an optional third. Some of the decision factors include:
</p>
<p>
          </p>
<ul class="text">
<li>Performance (latency).
</li>
<li>Crypto-agility, the ability to negotiate cryptographic algorithms. Ideally this
              applies to both the symmetric and asymmetric algorithms.
</li>
<li>Complexity of the protocol state machine, when some messages are optional.
</li>
<li>Dependence on a higher-level protocol sending the peer's identity before EAP-EKE
              starts, so that the correct password can be used.
</li>
</ul><p>
        
</p>
<p>The initial version of this protocol has 3 round trips, primarily for simplicity.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
Fragmentation</h3>

<p>While similar documents ( <a class='info' href='#I-D.harkins-emu-eap-pwd'>[I&#8209;D.harkins&#8209;emu&#8209;eap&#8209;pwd]<span> (</span><span class='info'>Harkins, D. and G. Zorn, &ldquo;EAP Authentication Using Only A Password,&rdquo; April&nbsp;2010.</span><span>)</span></a>) provide fragmentation
          support at the level of the EAP method, we have decided that such support is unnecessary
          given the expected size of messages in EAP-EKE.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yaron Sheffer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Check Point Software Technologies Ltd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5 Hasolelim St.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tel Aviv  67897</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yaronf@checkpoint.com">yaronf@checkpoint.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Glen Zorn</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Zen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1310 East Thomas Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">#306</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, Washington  98102</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 (206) 377-9035</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gwz@net-zen.net">gwz@net-zen.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
</table>
</body></html>
