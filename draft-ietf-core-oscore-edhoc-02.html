<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Profiling EDHOC for CoAP and OSCORE</title>
<meta content="Francesca Palombini" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="Rikard Hoeglund" name="author">
<meta content="Stefan Hristozov" name="author">
<meta content="Goeran Selander" name="author">
<meta content="
       The lightweight authenticated key exchange protocol EDHOC can be run over CoAP and used by two peers to establish an OSCORE Security Context. This document further profiles this use of the EDHOC protocol, by specifying a number of additional and optional mechanisms. These especially include an optimization approach for combining the execution of EDHOC with the first subsequent OSCORE transaction. This combination reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-core-oscore-edhoc-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-core-oscore-edhoc-02-lcb79sjs.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Profiling EDHOC for CoAP and OSCORE</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Palombini, et al.</td>
<td class="center">Expires 28 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CoRE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-core-oscore-edhoc-02</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-25" class="published">25 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-28">28 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">R. Hoeglund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">S. Hristozov</div>
<div class="org">Fraunhofer AISEC</div>
</div>
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Profiling EDHOC for CoAP and OSCORE</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The lightweight authenticated key exchange protocol EDHOC can be run over CoAP and used by two peers to establish an OSCORE Security Context. This document further profiles this use of the EDHOC protocol, by specifying a number of additional and optional mechanisms. These especially include an optimization approach for combining the execution of EDHOC with the first subsequent OSCORE transaction. This combination reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Constrained RESTful Environments Working Group mailing list (core@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/core-wg/oscore-edhoc">https://github.com/core-wg/oscore-edhoc</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-edhoc-overview" class="xref">EDHOC Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-edhoc-combined-with-oscore" class="xref">EDHOC Combined with OSCORE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-edhoc-option" class="xref">EDHOC Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-client-processing" class="xref">Client Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-server-processing" class="xref">Server Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-example-of-edhoc-oscore-req" class="xref">Example of EDHOC + OSCORE Request</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-conversion-from-oscore-to-e" class="xref">Conversion from OSCORE to EDHOC Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-conversion-method" class="xref">Conversion Method</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-additional-processing-of-ed" class="xref">Additional Processing of EDHOC Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-initiator-processing-of-mes" class="xref">Initiator Processing of Message 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-responder-processing-of-mes" class="xref">Responder Processing of Message 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-responder-processing-of-mess" class="xref">Responder Processing of Message 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="xref">4.2.4</a>.  <a href="#name-initiator-processing-of-mess" class="xref">Initiator Processing of Message 2</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-extension-and-consistency-o" class="xref">Extension and Consistency of Applicability Statement</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-web-linking" class="xref">Web Linking</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-coap-option-numbers-registr" class="xref">CoAP Option Numbers Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-checking-cbor-encoding-of-n" class="xref">Checking CBOR Encoding of Numeric Values</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-document-updates" class="xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-version-01-to-02" class="xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-version-00-to-01" class="xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Ephemeral Diffie-Hellman Over COSE (EDHOC) <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> is a lightweight authenticated key exchange protocol, especially intended for use in constrained scenarios. In particular, EDHOC messages can be transported over the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> and used for establishing a Security Context for Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document profiles this use of the EDHOC protocol, and specifies a number of additional and optional mechanisms. These especially include an optimization approach, that combines the EDHOC execution with the first subsequent OSCORE transaction (see <a href="#edhoc-in-oscore" class="xref">Section 3</a>). This allows for a minimum number of round trips necessary to setup the OSCORE Security Context and complete an OSCORE transaction, e.g., when an IoT device gets configured in a network for the first time.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This optimization is desirable, since the number of protocol round trips impacts on the minimum number of flights, which in turn can have a substantial impact on the latency of conveying the first OSCORE request, when using certain radio technologies.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Without this optimization, it is not possible, not even in theory, to achieve the minimum number of flights. This optimization makes it possible also in practice, since the last message of the EDHOC protocol can be made relatively small (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-1.3" class="relref">Section 1.3</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>), thus allowing additional OSCORE protected CoAP data within target MTU sizes.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Furthermore, this document defines:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">A method for deterministically converting an OSCORE Sender/Recipient ID to a corresponding EDHOC connection identifier (see <a href="#conversion" class="xref">Section 4</a>). While this method is required to be used when using the optimization above, it is recommended in general, since it ensures that an OSCORE Sender/Recipient ID is always converted to the EDHOC identifier with the smallest size.<a href="#section-1-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-6.2">A number of parameters corresponding to different information elements of an EDHOC applicability statement (see <a href="#web-linking" class="xref">Section 6</a>). These can be specified as target attributes in the link to an EDHOC resource associated to that applicability statement, thus enabling an enhanced discovery of such resource for CoAP clients.<a href="#section-1-6.2" class="pilcrow">¶</a>
</li>
      </ul>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The reader is expected to be familiar with terms and concepts defined in CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, CBOR <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span>, CBOR sequences <span>[<a href="#RFC8742" class="xref">RFC8742</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and EDHOC <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-edhoc-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-edhoc-overview" class="section-name selfRef">EDHOC Overview</a>
      </h2>
<p id="section-2-1">The EDHOC protocol allows two peers to agree on a cryptographic secret, in a mutually-authenticated way and by using Diffie-Hellman ephemeral keys to achieve perfect forward secrecy. The two peers are denoted as Initiator and Responder, as the one sending or receiving the initial EDHOC message_1, respectively.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">After successful processing of EDHOC message_3, both peers agree on a cryptographic secret that can be used to derive further security material, and especially to establish an OSCORE Security Context <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>. The Responder can also send an optional EDHOC message_4 to achieve key confirmation, e.g., in deployments where no protected application message is sent from the Responder to the Initiator.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3"><span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#appendix-A.3" class="relref">Appendix A.3</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> specifies how to transfer EDHOC over CoAP. That is, the EDHOC data (referred to as "EDHOC messages") are transported in the payload of CoAP requests and responses. The default message flow consists in the CoAP Client acting as Initiator and the CoAP Server acting as Responder. Alternatively, the two roles can be reversed. In the rest of this document, EDHOC messages are considered to be transferred over CoAP.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4"><a href="#fig-non-combined" class="xref">Figure 1</a> shows a CoAP Client and Server running EDHOC as Initiator and Responder, respectively. That is, the Client sends a POST request to a reserved EDHOC resource at the Server, by default at the Uri-Path "/.well-known/edhoc". The request payload consists of the CBOR simple value "true" (0xf5) concatenated with EDHOC message_1, which also includes the EDHOC connection identifier C_I of the Client.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">This triggers the EDHOC exchange at the Server, which replies with a 2.04 (Changed) response. The response payload consists of EDHOC message_2, which also includes the EDHOC connection identifier C_R of the Server. The Content-Format of the response may be set to "application/edhoc".<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">Finally, the Client sends a POST request to the same EDHOC resource used earlier to send EDHOC message_1. The request payload consists of the EDHOC connection identifier C_R, concatenated with EDHOC message_3.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">After this exchange takes place, and after successful verifications as specified in the EDHOC protocol, the Client and Server can derive an OSCORE Security Context, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>. After that, they can use OSCORE to protect their communications as per <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">The Client and Server are required to agree in advance on certain information and parameters describing how they should use EDHOC. These are specified in an applicability statement see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-3.9" class="relref">Section 3.9</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>, associated to the used EDHOC resource.<a href="#section-2-8" class="pilcrow">¶</a></p>
<span id="name-edhoc-and-oscore-run-sequen"></span><div id="fig-non-combined">
<figure id="figure-1">
        <div class="alignCenter art-text artwork" id="section-2-9.1">
<pre>
   CoAP Client                                       CoAP Server
(EDHOC Initiator)                                 (EDHOC Responder)
        |                                                  |
        |                                                  |
        | ----------------- EDHOC Request ---------------&gt; |
        |   Header: 0.02 (POST)                            |
        |   Uri-Path: "/.well-known/edhoc"                 |
        |   Payload: true, EDHOC message_1                 |
        |                                                  |
        | &lt;---------------- EDHOC Response---------------- |
        |              Header: 2.04 (Changed)              |
        |              Content-Format: application/edhoc   |
        |              Payload: EDHOC message_2            |
        |                                                  |
EDHOC verification                                         |
        |                                                  |
        | ----------------- EDHOC Request ---------------&gt; |
        |   Header: 0.02 (POST)                            |
        |   Uri-Path: "/.well-known/edhoc"                 |
        |   Payload: C_R, EDHOC message_3                  |
        |                                                  |
        |                                         EDHOC verification
        |                                                  +
OSCORE Sec Ctx                                      OSCORE Sec Ctx
  Derivation                                          Derivation
        |                                                  |
        | ---------------- OSCORE Request ---------------&gt; |
        |   Header: 0.02 (POST)                            |
        |                                                  |
        | &lt;--------------- OSCORE Response --------------- |
        |                         Header: 2.04 (Changed)   |
        |                                                  |
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-edhoc-and-oscore-run-sequen" class="selfRef">EDHOC and OSCORE run sequentially</a>
        </figcaption></figure>
</div>
<p id="section-2-10">As shown in <a href="#fig-non-combined" class="xref">Figure 1</a>, this purely-sequential flow where EDHOC is run first and then OSCORE is used takes three round trips to complete.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11"><a href="#edhoc-in-oscore" class="xref">Section 3</a> defines an optimization for combining EDHOC with the first subsequent OSCORE transaction. This reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context.<a href="#section-2-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edhoc-in-oscore">
<section id="section-3">
      <h2 id="name-edhoc-combined-with-oscore">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-edhoc-combined-with-oscore" class="section-name selfRef">EDHOC Combined with OSCORE</a>
      </h2>
<p id="section-3-1">This section defines an optimization for combining the EDHOC exchange with the first subsequent OSCORE transaction, thus minimizing the number of round trips between the two peers.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">This approach can be used only if the default EDHOC message flow is used, i.e., when the Client acts as Initiator and the Server acts as Responder, while it cannot be used in the case with reversed roles.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">When running the purely-sequential flow of <a href="#overview" class="xref">Section 2</a>, the Client has all the information to derive the OSCORE Security Context already after receiving EDHOC message_2 and before sending EDHOC message_3.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Hence, the Client can potentially send both EDHOC message_3 and the subsequent OSCORE Request at the same time. On a semantic level, this requires sending two REST requests at once, as in <a href="#fig-combined" class="xref">Figure 2</a>.<a href="#section-3-4" class="pilcrow">¶</a></p>
<span id="name-edhoc-and-oscore-combined"></span><div id="fig-combined">
<figure id="figure-2">
        <div class="alignCenter art-text artwork" id="section-3-5.1">
<pre>
   CoAP Client                                       CoAP Server
(EDHOC Initiator)                                 (EDHOC Responder)
        |                                                  |
        | ----------------- EDHOC Request ---------------&gt; |
        |   Header: 0.02 (POST)                            |
        |   Uri-Path: "/.well-known/edhoc"                 |
        |   Payload: true, EDHOC message_1                 |
        |                                                  |
        | &lt;---------------- EDHOC Response---------------- |
        |              Header: Changed (2.04)              |
        |              Content-Format: application/edhoc   |
        |              Payload: EDHOC message_2            |
        |                                                  |
EDHOC verification                                         |
        +                                                  |
  OSCORE Sec Ctx                                           |
    Derivation                                             |
        |                                                  |
        | ------------ EDHOC + OSCORE Request -----------&gt; |
        |   Header: 0.02 (POST)                            |
        |                                                  |
        |                                         EDHOC verification
        |                                                  +
        |                                          OSCORE Sec Ctx
        |                                             Derivation
        |                                                  |
        | &lt;-------------- OSCORE Response ---------------- |
        |                         Header: 2.04 (Changed)   |
        |                                                  |
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-edhoc-and-oscore-combined" class="selfRef">EDHOC and OSCORE combined</a>
        </figcaption></figure>
</div>
<p id="section-3-6">To this end, the specific approach defined in this section consists of sending a single EDHOC + OSCORE request, which conveys the pair (C_R, EDHOC message_3) within an OSCORE protected CoAP message.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">That is, the EDHOC + OSCORE request is in practice the OSCORE Request from <a href="#fig-non-combined" class="xref">Figure 1</a>, as still sent to a protected resource and with the correct CoAP method and options intended for accessing that resource. At the same time, the EDHOC + OSCORE request also transports the pair (C_R, EDHOC message_3) required for completing the EDHOC exchange.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">As EDHOC message_3 may be too large to be included in a CoAP Option, e.g., if containing a large public key certificate chain, it has to be transported in the CoAP payload of the EDHOC + OSCORE request.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">The rest of this section specifies how to transport the data in the EDHOC + OSCORE request and their processing order. In particular, the use of this approach is explicitly signalled by including an EDHOC Option (see <a href="#edhoc-option" class="xref">Section 3.1</a>) in the EDHOC + OSCORE request. The processing of the EDHOC + OSCORE request is specified in <a href="#client-processing" class="xref">Section 3.2</a> for the Client side and in <a href="#server-processing" class="xref">Section 3.3</a> for the Server side.<a href="#section-3-9" class="pilcrow">¶</a></p>
<div id="edhoc-option">
<section id="section-3.1">
        <h3 id="name-edhoc-option">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-edhoc-option" class="section-name selfRef">EDHOC Option</a>
        </h3>
<p id="section-3.1-1">This section defines the EDHOC Option. The option is used in a CoAP request, to signal that the request payload conveys both an EDHOC message_3 and OSCORE protected data, combined together.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The EDHOC Option has the properties summarized in <a href="#fig-edhoc-option" class="xref">Figure 3</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>. The option is Critical, Safe-to-Forward, and part of the Cache-Key. The option MUST occur at most once and is always empty. If any value is sent, the value is simply ignored. The option is intended only for CoAP requests and is of Class U for OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<span id="name-the-edhoc-option"></span><div id="fig-edhoc-option">
<figure id="figure-3">
          <div class="alignCenter art-text artwork" id="section-3.1-3.1">
<pre>
+-------+---+---+---+---+-------+--------+--------+---------+
| No.   | C | U | N | R | Name  | Format | Length | Default |
+-------+---+---+---+---+-------+--------+--------+---------+
| TBD21 | x |   |   |   | EDHOC | Empty  |   0    | (none)  |
+-------+---+---+---+---+-------+--------+--------+---------+
       C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-the-edhoc-option" class="selfRef">The EDHOC Option.</a>
          </figcaption></figure>
</div>
<p id="section-3.1-4">The presence of this option means that the message payload contains also EDHOC data, that must be extracted and processed as defined in <a href="#server-processing" class="xref">Section 3.3</a>, before the rest of the message can be processed.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5"><a href="#fig-edhoc-opt" class="xref">Figure 4</a> shows the format of a CoAP message containing both the EDHOC data and the OSCORE ciphertext, using the newly defined EDHOC option for signalling.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<span id="name-coap-message-for-edhoc-and-"></span><div id="fig-edhoc-opt">
<figure id="figure-4">
          <div class="alignCenter art-text artwork" id="section-3.1-6.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Ver| T |  TKL  |      Code     |          Message ID           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Token (if any, TKL bytes) ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  OSCORE option  |   EDHOC option  | Other options (if any) ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1 1 1 1 1 1 1 1|    Payload
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-coap-message-for-edhoc-and-" class="selfRef">CoAP message for EDHOC and OSCORE combined - signalled with the EDHOC Option</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="client-processing">
<section id="section-3.2">
        <h3 id="name-client-processing">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-client-processing" class="section-name selfRef">Client Processing</a>
        </h3>
<p id="section-3.2-1">The Client prepares an EDHOC + OSCORE request as follows.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-2">
<li id="section-3.2-2.1">Compose EDHOC message_3 as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-5.4.2" class="relref">Section 5.4.2</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">Encrypt the original CoAP request as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>, using the new OSCORE Security Context established after receiving EDHOC message_2.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2-2.2.2">
Note that the OSCORE ciphertext is not computed over EDHOC message_3, which is not protected by OSCORE. That is, the result of this step is the OSCORE Request as in <a href="#fig-non-combined" class="xref">Figure 1</a>.<a href="#section-3.2-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">Build a CBOR sequence <span>[<a href="#RFC8742" class="xref">RFC8742</a>]</span> composed of two CBOR byte strings in the following order.<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.3.2.1">The first CBOR byte string is the EDHOC message_3 resulting from step 1.<a href="#section-3.2-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-2.3.2.2">The second CBOR byte string has as value the OSCORE ciphertext of the OSCORE protected CoAP request resulting from step 2.<a href="#section-3.2-2.3.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">Compose the EDHOC + OSCORE request, as the OSCORE protected CoAP request resulting from step 2, where the payload is replaced with the CBOR sequence built at step 3.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
<p id="section-3.2-2.4.2">
Note that the new payload includes EDHOC message_3, but it does not include the EDHOC connection identifier C_R. As the Client is the EDHOC Initiator, C_R encodes the OSCORE Sender ID of the Client, which is already specified as 'kid' in the OSCORE Option of the request from step 2, hence of the EDHOC + OSCORE request.<a href="#section-3.2-2.4.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.5">Signal the usage of this approach, by including the new EDHOC Option defined in <a href="#edhoc-option" class="xref">Section 3.1</a> into the EDHOC + OSCORE request.<a href="#section-3.2-2.5" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="server-processing">
<section id="section-3.3">
        <h3 id="name-server-processing">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-server-processing" class="section-name selfRef">Server Processing</a>
        </h3>
<p id="section-3.3-1">When receiving a request containing the EDHOC option, i.e., an EDHOC + OSCORE request, the Server MUST perform the following steps.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-2">
<li id="section-3.3-2.1">Check that the payload of the EDHOC + OSCORE request is a CBOR sequence composed of two CBOR byte strings. If this is not the case, the Server MUST stop processing the request and MUST reply with a 4.00 (Bad Request) error response.<a href="#section-3.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.2">Extract EDHOC message_3 from the payload of the EDHOC + OSCORE request, as the first CBOR byte string in the CBOR sequence.<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.3">Take the value of 'kid' from the OSCORE option of the EDHOC + OSCORE request (i.e., the OSCORE Sender ID of the Client), and use it to rebuild the EDHOC connection identifier C_R, as per <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a>.<a href="#section-3.3-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.4">
            <p id="section-3.3-2.4.1">Retrieve the correct EDHOC session by using the connection identifier C_R rebuilt at step 3.<a href="#section-3.3-2.4.1" class="pilcrow">¶</a></p>
<p id="section-3.3-2.4.2">
If the applicability statement used in the EDHOC session specifies that EDHOC message_4 shall be sent, the Server MUST stop the EDHOC processing and consider it failed, as due to a client error.<a href="#section-3.3-2.4.2" class="pilcrow">¶</a></p>
<p id="section-3.3-2.4.3">
Otherwise, perform the EDHOC processing on the EDHOC message_3 extracted at step 2 as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-5.4.3" class="relref">Section 5.4.3</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>, based on the protocol state of the retrieved EDHOC session.<a href="#section-3.3-2.4.3" class="pilcrow">¶</a></p>
<p id="section-3.3-2.4.4">
The applicability statement used in the EDHOC session is the same one associated to the EDHOC resource where the server received the request conveying EDHOC message_1 that started the session. This is relevant in case the server provides multiple EDHOC resources, which may generally refer to different applicability statements.<a href="#section-3.3-2.4.4" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-2.5">Establish a new OSCORE Security Context associated to the client as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>, using the EDHOC output from step 4.<a href="#section-3.3-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.6">Extract the OSCORE ciphertext from the payload of the EDHOC + OSCORE request, as the value of the second CBOR byte string in the CBOR sequence.<a href="#section-3.3-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.7">Rebuild the OSCORE protected CoAP request as the EDHOC + OSCORE request, where the payload is replaced with the OSCORE ciphertext extracted at step 6.<a href="#section-3.3-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.8">Decrypt and verify the OSCORE protected CoAP request rebuilt at step 7, as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>, by using the OSCORE Security Context established at step 5.<a href="#section-3.3-2.8" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.9">Deliver the CoAP request resulting from step 8 to the application.<a href="#section-3.3-2.9" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-3">If steps 4 (EDHOC processing) and 8 (OSCORE processing) are both successfully completed, the Server MUST reply with an OSCORE protected response, in order for the Client to achieve key confirmation (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-5.4.2" class="relref">Section 5.4.2</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>). The usage of EDHOC message_4 as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-5.5" class="relref">Section 5.5</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> is not applicable to the approach defined in this document.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">If step 4 (EDHOC processing) fails, the server discontinues the protocol as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-5.4.3" class="relref">Section 5.4.3</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> and responds with an EDHOC error message with error code 1, formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-6.2" class="relref">Section 6.2</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>. In particular, the CoAP response conveying the EDHOC error message MUST have Content-Format set to application/edhoc defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-9.12" class="relref">Section 9.12</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">If step 4 (EDHOC processing) is successfully completed but step 8 (OSCORE processing) fails, the same OSCORE error handling as defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span> applies.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example">
<section id="section-3.4">
        <h3 id="name-example-of-edhoc-oscore-req">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-example-of-edhoc-oscore-req" class="section-name selfRef">Example of EDHOC + OSCORE Request</a>
        </h3>
<p id="section-3.4-1"><a href="#fig-edhoc-opt-2" class="xref">Figure 5</a> shows an example of EDHOC + OSCORE Request. In particular, the example assumes that:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">The used OSCORE Partial IV is 0, consistently with the first request protected with the new OSCORE Security Context.<a href="#section-3.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">The OSCORE Sender ID of the Client is 0x01.<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.2">
As per <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a>, this corresponds to the numeric EDHOC connection identifier C_R with value 1. When using the purely-sequential flow shown in <a href="#fig-non-combined" class="xref">Figure 1</a>, this would be prepended to EDHOC message_3 as the CBOR integer 1 (0x01 in CBOR encoding), in the payload of the second EDHOC request.<a href="#section-3.4-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.3">The EDHOC option is registered with CoAP option number 21.<a href="#section-3.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-example-of-coap-message-wit"></span><div id="fig-edhoc-opt-2">
<figure id="figure-5">
          <div class="alignCenter art-text artwork" id="section-3.4-3.1">
<pre>
o  OSCORE option value: 0x090001 (3 bytes)

o  EDHOC option value: - (0 bytes)

o  EDHOC message_3: 0x52d5535f3147e85f1cfacd9e78abf9e0a81bbf (19 bytes)

o  OSCORE ciphertext: 0x612f1092f1776f1c1668b3825e (13 bytes)

From there:

o  Protected CoAP request (OSCORE message):

   0x44025d1f               ; CoAP 4-byte header
     00003974               ; Token
     39 6c6f63616c686f7374  ; Uri-Host Option: "localhost"
     63 090001              ; OSCORE Option
     c0                     ; EDHOC Option
     ff 52d5535f3147e85f1cfacd9e78abf9e0a81bbf
        4d612f1092f1776f1c1668b3825e
   (57 bytes)
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-coap-message-wit" class="selfRef">Example of CoAP message with EDHOC and OSCORE combined</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="conversion">
<section id="section-4">
      <h2 id="name-conversion-from-oscore-to-e">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-conversion-from-oscore-to-e" class="section-name selfRef">Conversion from OSCORE to EDHOC Identifiers</a>
      </h2>
<p id="section-4-1"><span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> defines how an EDHOC connection identifier is converted to an OSCORE Sender/Recipient ID.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">In the following, <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a> defines a method for converting from OSCORE Sender/Recipient ID to EDHOC connection identifier.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">When running EDHOC through a certain EDHOC resource, the Client and Server MUST both use the conversion method defined in <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a> and MUST perform the additional message processing specified in <a href="#oscore-edhoc-message-processing" class="xref">Section 4.2</a>, if at least one of the following conditions hold.<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">The applicability statement associated to the EDHOC resource indicates that the server supports the EDHOC + OSCORE request defined in <a href="#edhoc-in-oscore" class="xref">Section 3</a>.<a href="#section-4-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.2">The applicability statement associated to the EDHOC resource indicates that the conversion method defined in <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a> is the one to use.<a href="#section-4-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-5">Instead, if none of the above conditions hold, the Client and the Server can independently use any consistent conversion method, such as the one defined in <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a> or different ones defined in separate specifications. In particular, the Client and Server are not required to use the same conversion method. In fact, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>, it is sufficient that the two connection identifiers C_I and C_R exchanged during an EDHOC execution are different and not "equivalent", hence not convertible to the same OSCORE Sender/Recipient ID.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">Even in case none of the above conditions hold, it is RECOMMENDED for the Client and Server to use the conversion method defined in <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a>, since it ensures that an OSCORE Sender/Recipient ID is always converted to the EDHOC identifier with the smallest size among the two equivalent ones.<a href="#section-4-6" class="pilcrow">¶</a></p>
<div id="oscore-to-edhoc-id">
<section id="section-4.1">
        <h3 id="name-conversion-method">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-conversion-method" class="section-name selfRef">Conversion Method</a>
        </h3>
<p id="section-4.1-1">The process defined in this section ensures that every OSCORE Sender/Recipient ID is converted to only one of the two corresponding, equivalent EDHOC connection identifiers, see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">An OSCORE Sender/Recipient ID, OSCORE_ID, is converted to an EDHOC connection identifier, EDHOC_ID, as follows.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">If OSCORE_ID is 0 bytes in size, it is converted to the empty byte string EDHOC_ID (0x40 in CBOR encoding).<a href="#section-4.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-3.2">
            <p id="section-4.1-3.2.1">If OSCORE_ID has a size in bytes different than 0, 1, 2, 3, 5 or 9, it is converted to a byte-valued EDHOC_ID, i.e., a CBOR byte string with value OSCORE_ID.<a href="#section-4.1-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.2">
For example, the OSCORE_ID 0x001122334455 is converted to the byte-valued EDHOC_ID 0x001122334455 (0x46001122334455 in CBOR encoding).<a href="#section-4.1-3.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.3">
            <p id="section-4.1-3.3.1">If OSCORE_ID has a size in bytes equal to 1, 2, 3, 5 or 9 the following applies.<a href="#section-4.1-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.3.2.1">
                <p id="section-4.1-3.3.2.1.1">If OSCORE_ID is a valid CBOR encoding for an integer value (i.e., it can be correctly decoded as a CBOR integer), then it is converted to a numeric EDHOC_ID having OSCORE_ID as its CBOR encoded form.<a href="#section-4.1-3.3.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.3.2.1.2">
For example, the OSCORE_ID 0x01 is converted to the numeric EDHOC_ID 1 (0x01 in CBOR encoding), while the OSCORE_ID 0x2B is converted to the numeric EDHOC_ID -12 (0x2B in CBOR encoding).<a href="#section-4.1-3.3.2.1.2" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-3.3.2.2">
                <p id="section-4.1-3.3.2.2.1">If OSCORE_ID is <em>not</em> a valid CBOR encoding for an integer value (i.e., it <em>cannot</em> be correctly decoded as a CBOR integer), then it is converted to a byte-valued EDHOC_ID having OSCORE_ID as its value.<a href="#section-4.1-3.3.2.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.3.2.2.2">
For example, the OSCORE_ID 0xFF is converted to the byte-valued EDHOC_ID 0xFF (0x41FF in CBOR encoding).<a href="#section-4.1-3.3.2.2.2" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.1-3.3.3">
Implementations can easily determine which case holds for a given OSCORE_ID with no need to try to actually CBOR-decode it, e.g., by using the approach in <a href="#sec-cbor-numeric-check" class="xref">Appendix A</a>.<a href="#section-4.1-3.3.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-4">When performing the conversions above, the two peers MUST always refer to Deterministically Encoded CBOR as specified in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC8949" class="xref">RFC8949</a>]</span>, consistently with what is required by the EDHOC protocol <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oscore-edhoc-message-processing">
<section id="section-4.2">
        <h3 id="name-additional-processing-of-ed">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-additional-processing-of-ed" class="section-name selfRef">Additional Processing of EDHOC Messages</a>
        </h3>
<p id="section-4.2-1">This section specifies additional EDHOC message processing compared to what is specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="initiator-processing-of-message-1">
<section id="section-4.2.1">
          <h4 id="name-initiator-processing-of-mes">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-initiator-processing-of-mes" class="section-name selfRef">Initiator Processing of Message 1</a>
          </h4>
<p id="section-4.2.1-1">The Initiator selects C_I as follows.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.1-2">
<li id="section-4.2.1-2.1">The Initiator initializes a set ID_SET as the empty set.<a href="#section-4.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.1-2.2">The Initiator selects an available OSCORE Recipient ID, ID*, which is not included in ID_SET.<a href="#section-4.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.1-2.3">The Initiator converts ID* to the EDHOC connection identifier C_I, as per <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a>.<a href="#section-4.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.1-2.4">If the resulting C_I is already used, the Initiator adds ID* to ID_SET and moves back to step 2. Otherwise, it uses C_I as its EDHOC connection identifier.<a href="#section-4.2.1-2.4" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="responder-processing-of-message-1">
<section id="section-4.2.2">
          <h4 id="name-responder-processing-of-mes">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-responder-processing-of-mes" class="section-name selfRef">Responder Processing of Message 1</a>
          </h4>
<p id="section-4.2.2-1">The Responder MUST discontinue the protocol and reply with an EDHOC error message with error code 1, formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-6.2" class="relref">Section 6.2</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>, if C_I is a CBOR byte string and it has as value a valid CBOR encoding of an integer value (e.g., C_I is CBOR encoded as 0x4100).<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">In fact, this would mean that the Initiator has not followed the conversion rule in <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a> when converting its (to be) OSCORE Recipient ID to C_I.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="responder-processing-of-message-2">
<section id="section-4.2.3">
          <h4 id="name-responder-processing-of-mess">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-responder-processing-of-mess" class="section-name selfRef">Responder Processing of Message 2</a>
          </h4>
<p id="section-4.2.3-1">The Responder selects C_R as follows.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.3-2">
<li id="section-4.2.3-2.1">The Responder initializes a set ID_SET as the empty set.<a href="#section-4.2.3-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.3-2.2">The Responder selects an available OSCORE Recipient ID, ID*, which is not included in ID_SET.<a href="#section-4.2.3-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.3-2.3">The Responder converts ID* to the EDHOC connection identifier C_R, as per <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a>.<a href="#section-4.2.3-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.3-2.4">If the resulting C_R is already used or it is equal byte-by-byte to the C_I specified in EDHOC message_1, the Initiator adds ID* to ID_SET and moves back to step 2. Otherwise, it uses C_R as its EDHOC connection identifier.<a href="#section-4.2.3-2.4" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="initiator-processing-of-message-2">
<section id="section-4.2.4">
          <h4 id="name-initiator-processing-of-mess">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-initiator-processing-of-mess" class="section-name selfRef">Initiator Processing of Message 2</a>
          </h4>
<p id="section-4.2.4-1">If any of the following conditions holds, the Initiator MUST discontinue the protocol and reply with an EDHOC error message with error code 1, formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-6.2" class="relref">Section 6.2</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.4-2.1">C_R is equal byte-by-byte to the C_I that was specified in EDHOC message_1.<a href="#section-4.2.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.4-2.2">
              <p id="section-4.2.4-2.2.1">C_R is a CBOR byte string and it has as value a valid CBOR encoding of an integer value (e.g., C_R is CBOR encoded as 0x4100).<a href="#section-4.2.4-2.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2.4-2.2.2">
In fact, this would mean that the Responder has not followed the conversion rule in <a href="#oscore-to-edhoc-id" class="xref">Section 4.1</a> when converting its (to be) OSCORE Recipient ID to C_R.<a href="#section-4.2.4-2.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="app-statements">
<section id="section-5">
      <h2 id="name-extension-and-consistency-o">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-extension-and-consistency-o" class="section-name selfRef">Extension and Consistency of Applicability Statement</a>
      </h2>
<p id="section-5-1">The applicability statement referred by the Client and Server can include the information elements introduced below, in accordance with the specified consistency rules.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If the Server supports the EDHOC + OSCORE request within an EDHOC execution started at a certain EDHOC resource, then the applicability statement associated to that resource:<a href="#section-5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1">MUST NOT specify that EDHOC message_4 shall be sent.<a href="#section-5-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.2">SHOULD explicitly specify support for the EDHOC + OSCORE request.<a href="#section-5-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.3">
          <p id="section-5-3.3.1">SHOULD explicitly specify that the method to convert from EDHOC to OSCORE identifiers is the one defined in <a href="#conversion" class="xref">Section 4</a> and MUST NOT specify any other method than that.<a href="#section-5-3.3.1" class="pilcrow">¶</a></p>
<p id="section-5-3.3.2">
If the support for the EDHOC + OSCORE request is explicitly specified and the method defined in <a href="#conversion" class="xref">Section 4</a> is not explicitly specified, then the Client and Server MUST use it as conversion method.<a href="#section-5-3.3.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-4">If the Server does not support the EDHOC + OSCORE request within an EDHOC execution started at a certain EDHOC resource, then the applicability statement associated to that resource MAY specify a method to convert from EDHOC to OSCORE identifiers. In such a case, the Client and Server MUST use the specified conversion method, which MAY be the one defined in <a href="#conversion" class="xref">Section 4</a>.<a href="#section-5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="web-linking">
<section id="section-6">
      <h2 id="name-web-linking">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-web-linking" class="section-name selfRef">Web Linking</a>
      </h2>
<p id="section-6-1"><span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-9.13" class="relref">Section 9.13</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> registers the resource type "core.edhoc", which can be used as target attribute in a web link <span>[<a href="#RFC8288" class="xref">RFC8288</a>]</span> to an EDHOC resource, e.g., using a link-format document <span>[<a href="#RFC6690" class="xref">RFC6690</a>]</span>. This enables Clients to discover the presence of EDHOC resources at a Server, possibly using the resource type as filter criterion.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">At the same time, the applicability statement associated to an EDHOC resource provides a number of information describing how the EDHOC protocol can be used through that resource. While a Client may become aware of the applicability statement through several means, it would be convenient to obtain its information elements upon discovering the EDHOC resources at the Server. This might aim at discovering especially the EDHOC resources whose associated applicability statement denotes a way of using EDHOC which is most suitable to the Client, e.g., with EDHOC cipher suites or authentication methods that the Client also supports or prefers.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">That is, it would be convenient that a Client discovering an EDHOC resource contextually obtains relevant pieces of information from the applicability statement associated to that resource. The resource discovery can occur by means of a direct interaction with the Server, or instead by means of the CoRE Resource Directory <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>, where the Server may have registered the links to its resources.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">In order to enable the above, this section defines a number of parameters, each of which can be optionally specified as a target attribute with the same name in the link to the respective EDHOC resource, or as filter criteria in a discovery request from the Client. When specifying these parameters in a link to an EDHOC resource, the target attribute rt="core.edhoc" MUST be included, and the same consistency rules defined in <a href="#app-statements" class="xref">Section 5</a> for the corresponding information elements of an applicability statement MUST be followed.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">The following parameters are defined.<a href="#section-6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-6.1">'method', specifying an authentication method supported by the Server. This parameter MUST specify a single value, which is taken from the 'Value' column of the "EDHOC Method Type" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-9.3" class="relref">Section 9.3</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>. This parameter MAY occur multiple times, with each occurrence specifying a different authentication method.<a href="#section-6-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.2">'csuite', specifying an EDHOC ciphersuite supported by the Server. This parameter MUST specify a single value, which is taken from the 'Value' column of the "EDHOC Cipher Suites" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-9.2" class="relref">Section 9.2</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>. This parameter MAY occur multiple times, with each occurrence specifying a different authentication method.<a href="#section-6-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.3">'cred_t', specifying type of authentication credentials supported by the Server. This parameter MAY occur multiple times, with each occurrence specifying a different authentication credential type. Possible values are: "x509", for X.509 certificate <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>; "c509", for C509 certificate <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>; "cwt" for CWT <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>; "ccs" for CWT Claims Set (CCS) <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>.<a href="#section-6-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.4">
          <p id="section-6-6.4.1">'idcred_t', specifying the type of identifiers supported by the Server for identifying authentication credentials. This parameter MUST specify a single value, which is taken from the 'Label' column of the "COSE Headers Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="xref">COSE.Header.Parameters</a>]</span>. This parameter MAY occur multiple times, with each occurrence specifying a different type of identifier for authentication credentials.<a href="#section-6-6.4.1" class="pilcrow">¶</a></p>
<p id="section-6-6.4.2">
Note that the values in the 'Label' column of the "COSE Headers Parameters" registry are strongly typed. On the contrary, Link Format is weakly typed and thus does not distinguish between, for instance, the string value "-10" and the integer value -10. Thus, if responses in Link Format are returned, string values which look like an integer are not supported. Therefore, such values MUST NOT be used in the 'idcred_t' parameter.<a href="#section-6-6.4.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.5">
          <p id="section-6-6.5.1">'ead_1', 'ead_2', 'ead_3' and 'ead_4', specifying if the Server supports the use of external authorization data EAD_1, EAD_2, EAD_3 and EAD_4, respectively (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-3.8" class="relref">Section 3.8</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>). For each of these parameters, the following applies.<a href="#section-6-6.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-6.5.2.1">It MUST occur at most once, with its presence denoting support from the server for the respective external authorization data.<a href="#section-6-6.5.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6-6.5.2.2">It MUST specify a single value, which is taken from the 'Label' column of the "EDHOC External Authorization Data" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-12#section-9.5" class="relref">Section 9.5</a> of [<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-6-6.5.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-6-6.6">'comb_req', specifying whether the server supports the EDHOC + OSCORE request defined in <a href="#edhoc-in-oscore" class="xref">Section 3</a>, with its presence denoting support from the server. A value MUST NOT be given to this parameter and any present value MUST be ignored by parsers.<a href="#section-6-6.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.7">'conv_osc_id', specifying the method used to convert from OSCORE to EDHOC identifiers. If such a method is the one defined in <a href="#conversion" class="xref">Section 4</a>, this parameter MUST take value 0.<a href="#section-6-6.7" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-7">The example in <a href="#fig-web-link-example" class="xref">Figure 6</a> shows how a Client discovers one EDHOC resource at a Server, obtaining information elements from the applicability statement. The Link Format notation from <span><a href="https://rfc-editor.org/rfc/rfc6690#section-5" class="relref">Section 5</a> of [<a href="#RFC6690" class="xref">RFC6690</a>]</span> is used.<a href="#section-6-7" class="pilcrow">¶</a></p>
<span id="name-the-web-link"></span><div id="fig-web-link-example">
<figure id="figure-6">
        <div class="alignCenter art-text artwork" id="section-6-8.1">
<pre>
REQ: GET /.well-known/core

RES: 2.05 Content
    &lt;/sensors/temp&gt;;osc,
    &lt;/sensors/light&gt;;if="sensor",
    &lt;/.well-known/edhoc&gt;;rt="core.edhoc";csuite="0";csuite="2";
    method="0";cred_t="c509";cred_t="ccs";idcred_t="4";comb_req
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-the-web-link" class="selfRef">The Web Link</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">The same security considerations from OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and EDHOC <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> hold for this document.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">TODO: more considerations<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">RFC Editor: Please replace "[[this document]]" with the RFC number of this document and delete this paragraph.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">This document has the following actions for IANA.<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="iana-coap-options">
<section id="section-8.1">
        <h3 id="name-coap-option-numbers-registr">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-coap-option-numbers-registr" class="section-name selfRef">CoAP Option Numbers Registry</a>
        </h3>
<p id="section-8.1-1">IANA is asked to enter the following option number to the "CoAP Option Numbers" registry within the "CoRE Parameters" registry group.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">[<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">The CoAP option numbers 13 and 21 are both consistent with the properties of the EDHOC Option defined in <a href="#edhoc-option" class="xref">Section 3.1</a>, and they both allow the EDHOC Option to always result in an overall size of 1 byte. This is because:<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-4.1">The EDHOC option is always empty, i.e., with zero-length value; and<a href="#section-8.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-4.2">Since the OSCORE option with option number 9 is always present in the CoAP request, the EDHOC option would be encoded with a maximum delta of 4 or 12, depending on its option number being 13 or 21.<a href="#section-8.1-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.1-5">At the time of writing, the CoAP option numbers 13 and 21 are both unassigned in the "CoAP Option Numbers" registry, as first available and consistent option numbers for the EDHOC option.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<p id="section-8.1-6">This document suggests 21 (TBD21) as option number to be assigned to the new EDHOC option, since both 13 and 21 are consistent for the use case in question, but different use cases or protocols may make better use of the option number 13.<a href="#section-8.1-6" class="pilcrow">¶</a></p>
<p id="section-8.1-7">]<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<div class="alignCenter art-text artwork" id="section-8.1-8">
<pre>
+--------+-------+-------------------+
| Number | Name  | Reference         |
+--------+-------+-------------------+
| TBD21  | EDHOC | [[this document]] |
+--------+-------+-------------------+
</pre><a href="#section-8.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-resource-directory">[I-D.ietf-core-resource-directory]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. V. D. Stok</span>, <span class="refTitle">"CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-resource-directory-28</span>, <time datetime="2021-03-07" class="refDate">7 March 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-resource-directory-28.txt">https://www.ietf.org/archive/id/draft-ietf-core-resource-directory-28.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lake-edhoc">[I-D.ietf-lake-edhoc]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lake-edhoc-12</span>, <time datetime="2021-10-20" class="refDate">20 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-lake-edhoc-12.txt">https://www.ietf.org/archive/id/draft-ietf-lake-edhoc-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6690">https://www.rfc-editor.org/info/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8288">[RFC8288]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Web Linking"</span>, <span class="seriesInfo">RFC 8288</span>, <span class="seriesInfo">DOI 10.17487/RFC8288</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8288">https://www.rfc-editor.org/info/rfc8288</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8742">https://www.rfc-editor.org/info/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-02</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-02.txt">https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="sec-cbor-numeric-check">
<section id="appendix-A">
      <h2 id="name-checking-cbor-encoding-of-n">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-checking-cbor-encoding-of-n" class="section-name selfRef">Checking CBOR Encoding of Numeric Values</a>
      </h2>
<p id="appendix-A-1">A binary string of N bytes in size is a valid CBOR encoding of an integer value if and only if both the following conditions hold, with reference to the table below.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">The size N is one of the values specified in the "Size" column.<a href="#appendix-A-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">The first byte of the binary string is equal to one of the byte values specified in the "First byte" column, exactly for the row having N as value of the "Size" column.<a href="#appendix-A-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<div class="alignCenter art-text artwork" id="appendix-A-3">
<pre>
+------+-----------------------+
| Size | First byte            |
+------+-----------------------+
| 1    | 0x00-0x17 , 0x20-0x37 |
+------+-----------------------+
| 2    | 0x18 , 0x38           |
+------+-----------------------+
| 3    | 0x19 , 0x39           |
+------+-----------------------+
| 5    | 0x1A , 0x3A           |
+------+-----------------------+
| 9    | 0x1B , 0x3B           |
+------+-----------------------+
</pre><a href="#appendix-A-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-B">
      <h2 id="name-document-updates">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-B-1">RFC Editor: Please remove this section.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="sec-01-02">
<section id="appendix-B.1">
        <h3 id="name-version-01-to-02">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.1-1.1">New title, abstract and introduction.<a href="#appendix-B.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-1.2">Restructured table of content.<a href="#appendix-B.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-1.3">Alignment with latest format of EDHOC messages.<a href="#appendix-B.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-1.4">Guideline on ID conversions based on applicability statement.<a href="#appendix-B.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-1.5">Clarifications, extension and consistency on applicability statement.<a href="#appendix-B.1-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-1.6">Section on web-linking.<a href="#appendix-B.1-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-1.7">RFC8126 terminology in IANA considerations.<a href="#appendix-B.1-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-1.8">Revised Appendix "Checking CBOR Encoding of Numeric Values".<a href="#appendix-B.1-1.8" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-B.2">
        <h3 id="name-version-00-to-01">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.2-1.1">Improved background overview of EDHOC.<a href="#appendix-B.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-1.2">Added explicit rules for converting OSCORE Sender/Recipient IDs to EDHOC connection identifiers following the removal of bstr_identifier from EDHOC.<a href="#appendix-B.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-1.3">Revised section organization.<a href="#appendix-B.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-1.4">Recommended number for EDHOC option changed to 21.<a href="#appendix-B.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-1.5">Editorial improvements.<a href="#appendix-B.2-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The authors sincerely thank Christian Amsuess, Klaus Hartke, Jim Schaad and Malisa Vucinic for their feedback and comments.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-C-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Hoeglund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stefan Hristozov</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer AISEC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stefan.hristozov@aisec.fraunhofer.de" class="email">stefan.hristozov@aisec.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Goeran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
