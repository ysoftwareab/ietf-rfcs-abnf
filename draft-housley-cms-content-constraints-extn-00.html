<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Cryptographic Message Syntax (CMS) Content Constraints X.509 Certificate Extension</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Cryptographic Message Syntax (CMS) Content Constraints X.509 Certificate Extension">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">R. Housley</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Vigil Security, LLC</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">R. Reddy</td></tr>
<tr><td class="header">Expires: April 6, 2008</td><td class="header">National Security Agency</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Wallace</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cygnacom Solutions</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 04, 2007</td></tr>
</table></td></tr></table>
<h1><br />Cryptographic Message Syntax (CMS) Content Constraints X.509 Certificate Extension<br />draft-housley-cms-content-constraints-extn-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 6, 2008.</p>

<h3>Abstract</h3>

<p>
        This document specifies the syntax and semantics for the
        Cryptographic Message Syntax (CMS) content constraints X.509
        certificate extension.  This extension is used to determine whether
        the public key in an X.509 public key certificate is appropriate to
        use in the processing of a protected content.  In particular, the CMS
        content constraints certificate extension is one part of the
        authorization decision; it is used when validating a digital
        signature on a CMS SignedData content or validating a message
        authentication code (MAC) on a CMS AuthenticatedData content or CMS
        AuthEnvelopedData content.  The signed or authenticated content type
        is identified by an ASN.1 object identifier, and this certificate
        extension indicates the content types that the certified public key
        is authorized to validate.  If the authorization check is successful,
        the CMS content constraints certificate extension also provides
        default values for absent attributes.
      
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
CMS Data Structures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
CMS Content Constraints Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Abstract Syntax Notation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">1.4.</a>&nbsp;
Terminology<br />
<a href="#anchor6">2.</a>&nbsp;
CMS Content Constraints X.509 Certificate Extension<br />
<a href="#anchor7">3.</a>&nbsp;
Certification Path Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.1.</a>&nbsp;
Inputs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.2.</a>&nbsp;
Initialization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.3.</a>&nbsp;
Basic Certificate Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.4.</a>&nbsp;
Preparation for Certificate i+1<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.5.</a>&nbsp;
Wrap-up procedure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.6.</a>&nbsp;
Outputs<br />
<a href="#anchor14">4.</a>&nbsp;
CMS Content Constraints Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.1.</a>&nbsp;
Collection of signer or originator information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.1.1.</a>&nbsp;
Signature or MAC Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.2.</a>&nbsp;
Collection of Attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.3.</a>&nbsp;
Leaf node classification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.4.</a>&nbsp;
Content Type and Constraint Checking<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.4.1.</a>&nbsp;
Inputs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.4.2.</a>&nbsp;
Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.4.3.</a>&nbsp;
Outputs<br />
<a href="#anchor23">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor24">6.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#anchor27">Appendix&nbsp;A.</a>&nbsp;
ASN.1 Modules<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">A.1.</a>&nbsp;
ASN.1 Module Using 1993 Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">A.2.</a>&nbsp;
ASN.1 Module Using 1988 Syntax<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        The CMS SignedData <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a> construct is used to sign many things,
        including cryptographic module firmware packages <a class='info' href='#RFC4108'>[RFC4108]<span> (</span><span class='info'>Housley, R., &ldquo;Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages,&rdquo; August&nbsp;2005.</span><span>)</span></a> and certificate
        management messages <a class='info' href='#RFC2797'>[RFC2797]<span> (</span><span class='info'>Myers, M., Liu, X., Schaad, J., and J. Weinstein, &ldquo;Certificate Management Messages over CMS,&rdquo; April&nbsp;2000.</span><span>)</span></a>.  Similarly, the CMS AuthenticatedData and
        CMS AuthEnvelopedData constructs provide authentication, which can be
        affiliated with an originator's X.509 certificate.
      
</p>
<p>
        This document assumes a particular authorization model, where each
        originator is associated with one or more authorized content types.
        A CMS SignedData, AuthenticatedData, or AuthEnvelopedData will be
        considered valid only if the signature or message authentication code
        (MAC) verification process is successful and the originator is
        authorized for the encapsulated content type.  For example, one
        originator might be acceptable for verifying signatures on firmware
        packages, but that same originator may be unacceptable for verifying
        signatures on certificate management messages.
      
</p>
<p>
        An originator's constraints are derived from the certification path
        used to validate the originator's certificate.  Constraints are
        associated with trust anchors and constraints are optionally included
        in public key certificates.  The trust anchor structure lists the
        content types for which it may be used, and the trust anchor may also
        include constraints associated with each of the content types.
        Certificates may include a CMS Content Constraints certificate extension that refines the privileges
        of the trust anchor for a particular certificate subject.
      
</p>
<p>
        The entity that operates a trust anchor holds the corresponding
        private signature key, and that entity may delegate authority to
        another entity.  Delegation is accomplished by issuing an X.509
        certificate to that other entity.  If the trust anchor issues a
        certification authority (CA) certificate, then that entity may
        perform further delegation.  If the trust anchor issues an end entity
        certificate, then that entity is unable to perform further
        delegation.
      
</p>
<p>
        The CMS Content Constraints certificate extension provides a
        mechanism to constrain the authorizations that are delegated when a
        certificate is issued by a trust anchor or a CA.  The certificate
        containing the CMS Content Constraints certificate extension is
        limited to a subset of the content types associated with the
        certificate issuer, whether the issuer is a trust anchor or a CA.
        Also, the certificate issuer may add constraints to a content type
        that is not constrained for the certificate issuer.  However, no
        amplification of authorization is possible through use of this
        certificate extension.  When a content signature or MAC is validated,
        checks must be performed to ensure that the encapsulated content type
        is within the permitted set and that the constraints associated with
        the specific content type, if any, are satisfied.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
CMS Data Structures</h3>

<p>
          CMS encapsulation can be used to compose structures of arbitrary
          breadth and depth.  Four documents define the primary CMS content
          types:
        
</p>
<p>
          RFC 3852 <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a>: Cryptographic Message Syntax (CMS)
        
</p>
<p>
          </p>
<blockquote class="text">
<p>- SignedData
</p>
<p>- EnvelopedData
</p>
<p>- EncryptedData
</p>
<p>- DigestedData
</p>
<p>- AuthenticatedData
</p>
</blockquote><p>
        
</p>
<p>
          RFC XXXX <a class='info' href='#AuthEnv'>[AuthEnv]<span> (</span><span class='info'>Housley, R., &ldquo;The Cryptographic Message Syntax (CMS) AuthEnvelopedData Content Type,&rdquo; in progress.</span><span>)</span></a>: The Cryptographic Message Syntax (CMS)
          AuthEnvelopedData Content Type
        
</p>
<p>
          </p>
<blockquote class="text">
<p>
              - AuthEnvelopedData
            
</p>
</blockquote><p>
        
</p>
<p>
          RFC 4073 <a class='info' href='#RFC4073'>[RFC4073]<span> (</span><span class='info'>Housley, R., &ldquo;Protecting Multiple Contents with the Cryptographic Message Syntax (CMS),&rdquo; May&nbsp;2005.</span><span>)</span></a>: Protecting Multiple Contents with the
          Cryptographic Message Syntax (CMS)
        
</p>
<p>
          </p>
<blockquote class="text">
<p>
              - ContentCollection
            
</p>
<p>- ContentWithAttributes
</p>
</blockquote><p>
        
</p>
<p>
          RFC 3274 <a class='info' href='#RFC3274'>[RFC3274]<span> (</span><span class='info'>Gutmann, P., &ldquo;Compressed Data Content Type for Cryptographic Message Syntax (CMS),&rdquo; June&nbsp;2002.</span><span>)</span></a>: Compressed Data Content Type for
          Cryptographic Message Syntax (CMS)
        
</p>
<p>
          </p>
<blockquote class="text">
<p>
              - CompressedData
            
</p>
</blockquote><p>
        
</p>
<p>
          When using the CMS, the outermost structure is always ContentInfo.
          ContentInfo consists of an object identifier and an associated
          content.  The object identifier describes the structure of the
          content.  Object identifiers are used throughout the CMS family of
          specifications to identify structures.
        
</p>
<p>
          Using the content types listed above, ignoring for the moment
          ContentCollection, encapsulation can be used to create structures of
          arbitrary depth.  Two examples based on <a class='info' href='#RFC4108'>[RFC4108]<span> (</span><span class='info'>Housley, R., &ldquo;Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages,&rdquo; August&nbsp;2005.</span><span>)</span></a> are shown in Figure 1
          and Figure 2.
        
</p>
<p>
          When ContentCollection is used in conjunction with the other content
          types, tree-like structures can be defined, as shown in Figure 3.
        
</p>
<p>
          The examples in Figures 1, 2, and 3 can each be represented as a
          tree: the root node is the outermost ContentInfo, and the leaf nodes
          are the encapsulated contents.  The trees are shown in Figure 4.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

      +---------------------------------------------------------+
      | ContentInfo                                             |
      |                                                         |
      | +-----------------------------------------------------+ |
      | | SignedData                                          | |
      | |                                                     | |
      | | +-------------------------------------------------+ | |
      | | | FirmwarePackage                                 | | |
      | | |                                                 | | |
      | | |                                                 | | |
      | | +-------------------------------------------------+ | |
      | +-----------------------------------------------------+ |
      +---------------------------------------------------------+

             Figure 1.  Example of a Signed Firmware Package.



      +---------------------------------------------------------+
      | ContentInfo                                             |
      |                                                         |
      | +-----------------------------------------------------+ |
      | | SignedData                                          | |
      | |                                                     | |
      | | +-------------------------------------------------+ | |
      | | | EncryptedData                                   | | |
      | | |                                                 | | |
      | | | +---------------------------------------------+ | | |
      | | | | FirmwarePackage                             | | | |
      | | | |                                             | | | |
      | | | |                                             | | | |
      | | | +---------------------------------------------+ | | |
      | | +-------------------------------------------------+ | |
      | +-----------------------------------------------------+ |
      +---------------------------------------------------------+

      Figure 2.  Example of a Signed and Encrypted Firmware Package.

</pre></div>
<p>
          These examples do not illustrate all of the details of the CMS
          structures; most CMS protecting content types, and some content
          types, contain attributes.  These attributes can influence processing
          and handling of the CMS protecting content type or the encapsulated
          content type.  Throughout this document, paths through the tree
          structure from a root node to a leaf node in a CMS-protected message
          are referred to as CMS paths.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

      +---------------------------------------------------------+
      | ContentInfo                                             |
      |                                                         |
      | +-----------------------------------------------------+ |
      | | SignedData                                          | |
      | |                                                     | |
      | | +-------------------------------------------------+ | |
      | | | ContentCollection                               | | |
      | | |                                                 | | |
      | | | +----------------------+ +--------------------+ | | |
      | | | | SignedData           | | SignedData         | | | |
      | | | |                      | |                    | | | |
      | | | | +------------------+ | | +----------------+ | | | |
      | | | | | EncryptedData    | | | | Firmware       | | | | |
      | | | | |                  | | | | Package        | | | | |
      | | | | | +--------------+ | | | |                | | | | |
      | | | | | | Firmware     | | | | +----------------+ | | | |
      | | | | | | Package      | | | +--------------------+ | | |
      | | | | | |              | | |                        | | |
      | | | | | +--------------+ | |                        | | |
      | | | | +------------------+ |                        | | |
      | | | +----------------------+                        | | |
      | | +-------------------------------------------------+ | |
      | +-----------------------------------------------------+ |
      +---------------------------------------------------------+

      Figure 3.  Example of Two Firmware Packages in a Collection.

</pre></div>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
CMS Content Constraints Model</h3>

<p>
          The CMS content constraints certificate extension is used to restrict
          the types of content for which a particular public key can be used to
          verify a signature or MAC.  Trust in a public key is established by
          building and validating a certification path from a trust anchor to
          the subject public key.  Section 6 of <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> describes the
          algorithm for certification path validation, and the basic path
          validation algorithm is augmented, as described in Section 3 of
          this document, to include processing required to determine the CMS
          content constraints that have been delegated to the subject public
          key.  If the subject public key is explicitly trusted (the public key
          belongs to a trust anchor), then any CMS content constraints
          associated with the trust anchor are used directly.  If the subject
          public key is not explicitly trusted, then the CMS content
          constraints are determined by calculating the intersection of the CMS
          content constraints included in each certificate in a valid
          certification path from the trust anchor to the subject public key.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

      +---------------------------------------------------------+
      |                                                         |
      |     CMS PATH RESULTING            CMS PATH RESULTING    |
      |       FROM FIGURE 1.                FROM FIGURE 2.      |
      |                                                         |
      |       ContentInfo                   ContentInfo         |
      |           |                             |               |
      |           V                             V               |
      |       SignedData                    SignedData          |
      |           |                             |               |
      |           V                             V               |
      |       FirmwarePackage               EncryptedData       |
      |                                         |               |
      |                                         V               |
      |                                     FirmwarePackage     |
      |                                                         |
      |                                                         |
      |            CMS PATHS RESULTING FROM FIGURE 3.           |
      |                                                         |
      |                       ContentInfo                       |
      |                           |                             |
      |                           V                             |
      |                       SignedData                        |
      |                           |                             |
      |                           V                             |
      |                       ContentCollection                 |
      |                           |                             |
      |                +----------+--------------+              |
      |                |                         |              |
      |                V                         V              |
      |            SignedData                SignedData         |
      |                |                         |              |
      |                V                         V              |
      |            EncryptedData             FirmwarePackage    |
      |                |                                        |
      |                V                                        |
      |            FirmwarePackage                              |
      |                                                         |
      +---------------------------------------------------------+

                  Figure 4.  Example CMS Path Structures.

</pre></div>
<p>
          The CMS enables the use of multiple nested signatures or MACs.  Each
          signature or MAC can protect and associate attributes with an
          encapsulated data object.  The CMS content constraints certificate
          extension is associated with a public key, and that public key is
          used to verify a signature or a MAC.
        
</p>
<p>
          The CMS content constraints mechanism can be used to permit the use of the subject public key to verify signatures on or authenticate one or more specific content
              types.  Also, within a permitted content type, a permitted set
              of values can be expressed for one or more specific attribute
              types.
            
</p>
<p>
          When multiple parties collaborate to produce a signed or
          authenticated CMS-protected content, each party must be authorized
          for the content types and attribute values appearing in the result.  In all cases, the signer or originator closest to a leaf node must be authorized to serve as a source for the leaf node contents; outer signers or originators need not be authorized to serve as a source.
        
</p>
<p>A signer or originator may be constrained to use a specific set of attribute values for some attribute types when producing a particular content type.  If a signer or originator is constrained for a particular attribute that does not appear in a protected content of the type for which the constraint is defined, the constraint serves as a default attribute, i.e., the payload should be processed as if an attribute equal to the constraint appeared in the protected content.  However, in some cases, the processing rules for a particular content type may disallow the usage of default values for some attribute types and require a signer to explicitly assert the attribute to satisfy the constraint.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Abstract Syntax Notation</h3>

<p>
          All X.509 certificate <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> extensions are defined using ASN.1
          <a class='info' href='#X.680'>[X.680]<span> (</span><span class='info'>, &ldquo;ITU-T Recommendation X.680: Information Technology - Abstract Syntax Notation One,&rdquo; 1997.</span><span>)</span></a><a class='info' href='#X.690'>[X.690]<span> (</span><span class='info'>, &ldquo;ITU-T Recommendation X.690 Information Technology -             ASN.1 encoding rules: Specification of Basic Encoding             Rules (BER), Canonical Encoding Rules (CER) and             Distinguished Encoding Rules (DER),&rdquo; 1997.</span><span>)</span></a>.
        
</p>
<p>
          CMS content types <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a> are also defined using ASN.1.
        
</p>
<p>
          CMS uses the Attribute type.  The syntax of Attribute is compatible
          with X.501 [X.501].
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Terminology</h3>

<p>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
          "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
          document are to be interpreted as described in RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
CMS Content Constraints X.509 Certificate Extension</h3>

<p>
        The CMS content constraints certificate extension MUST be critical,
        and it MUST appear at most one time in a certificate.  The CMS
        content constraints certificate extension is identified by the
        id-pe-cmsContentConstraints object identifier:
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

      id-pe-cmsContentConstraints OBJECT IDENTIFIER ::=
          { iso(1) identified-organization(3) dod(6) internet(1)
            security(5) mechanisms(5) pkix(7) pe(1) 18 }

</pre></div>
<p>
        The CMS content constraints certificate extension provides a
        mechanism to constrain authorization during delegation.  If the CMS
        content constraints certificate extension is not present, then the
        subject of the certificate has the same set of authorizations as the
        issuer of the certificate.  A certificate containing the CMS content
        constraints certificate extension is limited to a subset of the
        content types for which the certificate issuer is authorized.  Also,
        the certificate issuer may add constraints to a previously
        unconstrained content type, or add additional constraints to a
        previously constrained content type.
      
</p>
<p>The syntax for the CMS content constraints certificate extension is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  CMSContentConstraints ::= ContentTypeConstraintList

  ContentTypeConstraintList ::= SEQUENCE SIZE (1..MAX) OF
    ContentTypeConstraint

  ContentTypeConstraint ::= SEQUENCE {
    contentType           ContentType,
    canSource             BOOLEAN DEFAULT TRUE,
    attrConstraints       AttrConstraintList OPTIONAL }

  AttrConstraintList ::= SEQUENCE SIZE (1..MAX) OF AttrConstraint

  AttrConstraint ::= SEQUENCE {
    attrType               AttributeType,
    attrValues             SET SIZE (1..MAX) OF AttributeValue }

  ContentType ::= OBJECT IDENTIFIER

  anyContentType OBJECT IDENTIFIER ::= { TBD }

</pre></div>
<p>
        The CMSContentConstraints is a list of permitted
        content types and associated constraints.  A particular content type MUST NOT appear more than once in a ContentTypeConstraintList.
        When the extension is present, the certificate
        subject is being authorized by the certificate issuer to sign or
        authenticate the content types listed in the permitted list as long
        as the provided constraints, if any, are met.  The certificate issuer MUST be authorized to delegate the privileges.  When the extension is absent, the certificate issuer is authorizing the subject to sign or authenticate all of the content types for which the issuer is authorized.
      
</p>
<p>The special anyContentType value indicates the certificate subject is being authorized for any content type without any constraints.  The anyContentType object identifier can be used in trust anchor certificates when the trust anchor is unconstrained.
</p>
<p>
        The fields of the ContentTypeConstraint type have the following
        meanings:
      
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>contentType</dt>
<dd>
            contentType is an object identifier that specifies a
            permitted content type.  When the extension appears in an end
            entity certificate, it indicates that a content of this type
            can be verified using the public key in the certificate.  When
            the extension appears in a CA certificate, it indicates that a
            content of this type can be verified using the public key in
            the CA certificate or the public key in an appropriately authorized subordinate
            certificate.  For example, this field contains id-ct-firmwarePackage when the certified public key can be used to
            verify digital signatures on firmware packages defined in
            <a class='info' href='#RFC4108'>[RFC4108]<span> (</span><span class='info'>Housley, R., &ldquo;Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
          
</dd>
<dt>canSource</dt>
<dd>
            canSource is a Boolean flag, and it applies to direct
            signatures or direct authentication for the specified content
            type.  If the canSource flag is FALSE, then the subject cannot
            directly sign or authenticate the specified content type.
            Regardless of the flag value, a subject can sign or
            authenticate a content that is already authenticated (when
            SignedData, AuthenticatedData, or AuthEnvelopedData is already
            present).
          
</dd>
<dt>attrConstraints</dt>
<dd>
            attrConstraints is an optional field that contains constraints
            that are specific to the content type.  If the attrConstraints
            field is absent, the certified public key can be used to verify
            the specified content type without further checking.  If the
            attrConstraints field is present, then the certified public key
            can only be used to verify the specified content type if all of
            the constraints are satisfied.  A particular constraint type
            MUST NOT appear more than once in the attrConstraints.
            Constraints are checked by matching the values in the
            constraint against the corresponding attribute value in the content.
            Constraints processing fails if the attribute is present and the value is
            not one of the values provided in the constraint.  Constraint
            checking is described fully in section 4.
          
</dd>
<dt></dt>
<dd>The fields of the AttrConstraint type have the following meanings:
        
<blockquote class="text"><dl>
<dt>attrType</dt>
<dd>
            attrType is an AttributeType, which is an object identifier
            that names an attribute.  For a content encapsulated in a CMS
            SignedData, AuthenticatedData, or AuthEnvelopedData to satisfy
            the constraint, if the attributes that are covered by the
            signature or MAC include an attribute of the same type, then the
            attribute value must be equal to one of the values supplied in the
            attrValues field.
          
</dd>
<dt>attrValues</dt>
<dd>
            attrValues is a set of AttributeValue.  The structure of each
            of the values in attrValues is determined by attrType.
            Constraint checking is described fully in section 4.
          
</dd>
</dl></blockquote>
		  
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Certification Path Processing</h3>

<p>
        When CMS content constraints are used for authorization, the
        processing described in this section MUST be included in the
        certification path validation.  The processing is presented as
        additions to the certification path validation algorithm described in
        section 6 of <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>.  Alternative implementations are possible but
        MUST yield the same results as described below.
      
</p>
<p>
        Certification path processing validates the binding between the
        subject and subject public key.  If a valid certification path cannot
        be found, then the corresponding CMS path MUST be rejected.
      
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Inputs</h3>

<p>
          If the trust anchor that terminates the path is authorized using CMS Content Constraints, then the trust anchor information includes a CMS Content Constraints structure.  The trust anchor may be constrained or unconstrained, and if unconstrained it will include a CMS Content Constraints structure with a single permitted content type equal to the special anyContentType value.  In some cases, a particular CMS Content Constraints definition may be implied by the trust anchor information or application context.  Otherwise, if the trust anchor does not contain a CMS Content Constraints structure, the CMS content constraints processing fails due to invalid input.
        
</p>
<p>The content type of the protected content being verified is provided as input along with the set of attributes collected from the CMS path.  Alternatively, the anyContentType value can be provided as the content type input, along with an empty set of attributes, to determine the full set of constraints associated with a public key in the end entity certificate terminating the certification path being validated.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Initialization</h3>

<p>Create a constant input variable named cms_content_type and set it equal to the content type provided as input.
</p>
<p>Create a constant input variable named cms_effective_attributes and set it equal to the set of attributes provided as input.  
</p>
<p>
          Create a state variable named working_permitted_content_types.  The initial value of
          working_permitted_content_types is the permitted content type list
          from the trust anchor, including any associated constraints.
        
</p>
<p>Create an state variable of type SEQUENCE OF AttrConstaint named subject_default_attributes and initialize it to empty.
</p>
<p>Create an state variable of type SEQUENCE OF ContentTypeConstraint named subject_constraints and initialize it to empty.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Basic Certificate Processing</h3>

<p>
          If the CMS content constraints certificate extension is not present
          in the certificate or if the certificate is present and includes an entry containing the special anyContentType value, no action is taken and working_permitted_content_types is unchanged.
        
</p>
<p>
          If the CMS content constraints certificate extension is present in
          the certificate, the extension contains a list of permitted content
          types, and working_permitted_content_types contains the
          anyContentType special value, assign
          working_permitted_content_types the value of the CMS content
          constraints certificate extension.
        
</p>
<p>
          If the CMS content constraints certificate extension is present in
          the certificate, the extension contains a list of permitted content
          types, and working_permitted_content_types does not contain the
          anyContentType special value, then the processing actions to be
          performed for each entry in the permitted content type list sequence
          in the CMS content constraints certificate extension are as follows:
        
</p>
<p>
          </p>
<blockquote class="text">
<p>
              - If the CMS content constraints certificate extension includes
              a content type that is not present in
              working_permitted_content_types, no action is taken based on
              this entry.  working_permitted_content_types is unchanged.
              
</p>
<p>
              - If the CMS content constraints certificate extension includes
              a content type that is already present in
              working_permitted_content_types, then the constraints in the
              CMS content constraints certificate extension can further
              reduce the authorization by adding constraints to previously
              unconstrained attributes or by removing attribute values from
              the attrValues set of a constrained attribute.  Similarly, the
              canSource flag can be further constrained by setting the value
              to FALSE.  The processing actions to be performed for each
              entry in the AttrConstraintList follow:
            
</p>
<p>
              </p>
<blockquote class="text">
<p>
                  -- If the CMS content constraints certificate extension
                  includes an attribute type that is not present in
                  working_permitted_content_types for this content type,
                  add the attribute type and the associated set of
                  attribute values to working_permitted_content_types entry
                  for the content type.
                
</p>
<p>
                  -- If the CMS content constraints certificate extension
                  includes an attribute type that is already present in
                  working_permitted_content_types for this content type,
                  then compute the intersection of the set of attribute
                  values from the working_permitted_content_types and the
                  set of attribute values from the CMS content constraints
                  certificate extension.  If the intersection contains at
                  least one attribute value, then the set of attribute
                  values in working_permitted_content_types entry for this
                  content type is assigned the intersection.  If the
                  intersection is empty, then the entry associated with the
                  content type is removed from
                  working_permitted_content_types.
                
</p>
</blockquote>
            

</blockquote><p>
        
</p>
<p>
          Remove each entry in working_permitted_content_types that includes a content type that
          is not present in the CMS content constraints certificate extension.
        
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Preparation for Certificate i+1</h3>

<p>
          No additional action associated with the CMS content constraints
          certificate extension is taken during this phase of certification
          path validation as described in section 6 of <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>.
        
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Wrap-up procedure</h3>

<p>If cms_content_type equals the special value anyContentType, the CCC processing portion of path validation succeeds.  Set subject_constraints equal to working_permitted_content_types.  If subject_constraints is empty, then the public key in the end entity certificate of the certification path is not authorized for any content type (though alternative certification paths may exist that yield different results).  If cms_content_type is not equal to the special value anyContentType, perform the following steps:
</p>
<p>
          </p>
<blockquote class="text">
<p>
              - If cms_content_type does not equal the content type of an entry in
              working_permitted_content_types, constraints processing fails and
              path validation fails.
            
</p>
<p>
              - If cms_content_type equals the content type of an entry in
              working_permitted_content_types, add the entry from working_permitted_content_types to subject_constraints.
            
</p>
<p>- If the attrConstraints field of the corresponding entry in working_permitted_content_types is absent; the CCC processing portion of path validation succeeds.
            
</p>
<p>
              - If the attrConstraints field of the corresponding entry in working_permitted_content_types is present, then constraints must be checked.  For each attrType in the
              attrConstraints, the constraint is satisfied if either the
              attribute type is absent from cms_effective_attributes or each
              attribute value in the attrsValues field of the corresponding entry in cms_effective_attributes is equal to one of the
              values for this attribute type in the attrConstraints field.
              If cms_effective_attributes does not contain an attribute of
              that type, then the entry from attrConstraints is added to the
              subject_default_attributes for use in processing the payload.  
            
</p>
</blockquote><p>
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Outputs</h3>

<p>
          If certification path validation processing succeeds, return the
          value of the subject_constraints and subject_default_attributes variables.
        
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
CMS Content Constraints Processing</h3>

<p>
        CMS content constraints processing consists of four primary 
        activities:
      
</p>
<p>
        </p>
<blockquote class="text">
<p>- Collection of Signer or Originator Keys
</p>
<p>- Collection of Attributes
</p>
<p>- Leaf node classification
</p>
<p>- Content Type and Constraint Checking
</p>
</blockquote><p>
      
</p>
<p>
        Processing is performed for each CMS path from the root node of a
        CMS-protected content to a leaf node, proceeding from the root node
        to the leaf node.  Each path is processed independently of the other
        paths.  Thus, it is possible that some leaf nodes in a content
        collection may be acceptable while other nodes are not acceptable.
        The processing described in this section applies to CMS paths that
        contain at least one SignedData, AuthEnvelopedData, or
        AuthenticatedData node.
      
</p>
<p>
        Signer or originator public keys are collected when verifying signatures or message
        authentication codes (MACs).  These keys will be used to determine the constraints of each signer or originator by building and validating a certification path to the public key.  Public key values, public key certificates or public key identifiers are accumulated in a state variable named cms_public_keys, which is either initialized to empty or to an application provided set of keys when processing begins.  The variable will be updated each time a SignedData, AuthEnvelopedData, or AuthenticatedData node is encountered in the CMS path.
      
</p>
<p>
        Attributes are collected from each node after the first SignedData,
        AuthEnvelopedData, or AuthenticatedData in a CMS path, including the
        attributes protected by the first SignedData, AuthEnvelopedData, or
        AuthenticatedData.  During processing, attributes collected from the
        nodes in the CMS path are maintained in a state variable named
        cms_effective_attributes and default attributes derived from message
        originator authorizations are collected in a state variable named
        cms_default_attributes.  A default attribute value comes from a
        constraint that does not correspond to an attribute contained in the
        CMS path.  When processing begins,
        cms_effective_attributes and cms_default_attributes are initialized
        to empty.  Alternatively, cms_effective_attributes may be initialized
        to an application-provided sequence of attributes.  The
        cms_effective_attributes value will be updated each time an attribute
        set is encountered in a SignedData, AuthEnvelopedData, or
        AuthenticatedData node while processing a CMS path.
      
</p>
<p>
        The output of content type and constraint checking always includes a set of
        attributes collected from the various nodes in a CMS path.  When processing terminates at an encrypted node, the set of signer or originator public keys is also returned.  When processing terminates at a payload node, a set of default attribute values is also returned along with a set of constraints that apply to the
        CMS-protected content.
      
</p>
<p>When processing terminates at an encrypted node, the attributes and public keys are returned and may be used as inputs for CMS content constraints processing of the decrypted payload contents.  An application may elect to discard some attributes before processing an encrypted payload.  For example, attributes related to routing the encrypted content may be discarded or the MessageDigest and ContentType related to an outer signature layer may be discarded.
      
</p>
<p>
        This section describes the processing of a CMS path.  The output from CMS Content Constraints processing will depend on the type of the leaf node that terminates the CMS path.  Four different output variables are possible.  The conditions under which each is returned is described in the following sections.  The variables are:
        </p>
<blockquote class="text"><dl>
<dt>cms_public_keys</dt>
<dd>cms_public_keys is a list of public key values, public key certificates or public key identifiers.  Information maintained in cms_public_keys will be used to performed the certification path operations required to determine if a particular signer or originator is authorized to produce a specific object.
</dd>
<dt>cms_effective_attributes</dt>
<dd>
            cms_effective_attributes contains the attributes collected from the nodes in a CMS path.  cms_effective_attributes is a SEQUENCE OF Attribute, which is the
            same as the AttrConstraintList structure except that it may have zero
            entries in the sequence.
          
</dd>
<dt>cms_default_attributes</dt>
<dd>
            cms_default_attributes contains default attributes derived from message signer or
            originator authorizations.  A default attribute value is taken from a constraint that does not correspond to an attribute contained in the CMS path.  cms_default_attributes is a SEQUENCE OF Attribute, which is the same as the AttrConstraintList structure except that it may have zero
            entries in the sequence.
          
</dd>
<dt>cms_constraints</dt>
<dd>
            cms_constraints contains the constraints associated with the message signer or
            originator for the content type of the protected content terminating a CMS path.  cms_constraints is a SEQUENCE OF Attribute, which is the same as the AttrConstraintList structure except that it may have zero
            entries in the sequence.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Collection of signer or originator information</h3>

<p>
          Signer or originator constraints are identified using the public keys to verify each SignedData, AuthEnvelopedData, or AuthenticatedData layer encountered in a CMS path.  The public key value, public key certificate or public key identifier of each signer or originator are collected in a state variable named cms_public_keys.  Constraints are determined by building and validating a certification path for each public key after the content type and attributes of the CMS-protected object have been identified.
        
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Signature or MAC Verification</h3>

<p>
            The signature or MAC generated by the originator MUST be verified.
            If signature or MAC verification fails, then the CMS path containing
            the signature or MAC MUST be rejected.  Signature and MAC
            verification procedures are defined in <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a><a class='info' href='#AuthEnv'>[AuthEnv]<span> (</span><span class='info'>Housley, R., &ldquo;The Cryptographic Message Syntax (CMS) AuthEnvelopedData Content Type,&rdquo; in progress.</span><span>)</span></a>.  The public key or public key certificate used to verify each signature or MAC in a CMS path is added to the cms_public_keys state variable for use in content type and constraint checking.
          
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Collection of Attributes</h3>

<p>
          Attributes are collected from all authenticated nodes in a CMS path.  That is, attributes are not
          collected from content types that occur before the first SignedData,
          AuthEnvelopedData, or AuthenticatedData instance.  Additionally, an
          application may specify a set of attributes that it has
          authenticated, perhaps from processing one or more content types that
          encapsulate a CMS-protected content.  If the content is not a leaf
          node in a CMS path, and it contains attributes, then add the
          attributes to cms_effective_attributes.  Leaf node attributes may be
          checked independent of the CMS content constraints certificate
          extension processing, but such processing is not addressed in this
          document.
        
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Leaf node classification</h3>

<p>
          The type of leaf node that terminates a CMS path determines the types of information that is returned and the type of processing that is performed.  There are two types of leaf nodes: encrypted leaf nodes and payload leaf nodes.  
        
</p>
<p>
          A node in a CMS path is a leaf node if the content type of the node is not one of the following content types:
        
</p>
<p>
          </p>
<blockquote class="text">
<p>id-signedData (SignedData),
</p>
<p>id-digestedData (DigestedData),
</p>
<p>id-ct-authData (AuthenticatedData),
</p>
<p>id-ct-compressedData (CompressedData),
</p>
<p>id-ct-contentCollection (ContentCollection), and
</p>
<p>id-ct-contentWithAttrs (ContentWithAttributes).
</p>
</blockquote><p>
        
</p>
<p>
          A leaf node is an encrypted leaf node if the content type of the node is one of the following content types:
        
</p>
<p>
          </p>
<blockquote class="text">
<p>id-encryptedData (EncryptedData),
</p>
<p>id-envelopedData (EnvelopedData), and
</p>
<p>id-ct-authEnvelopedData (AuthEnvelopedData).
</p>
</blockquote><p>
        
</p>
<p>All other leaf nodes are payload leaf nodes, since no further CMS encapsulation can occur beyond that node.  However, specifications may define content types that provide protection similar to the CMS content types, may augment the lists of possible leaf nodes and encrypted leaf nodes or may define some encrypted types as payload leaf nodes.
</p>
<p>
          When an encrypted leaf node is encountered, processing terminates and returns information that may be used as input when procesing the decrypted contents.  Content type and constraints checking are only performed for payload leaf nodes.  When an encrypted leaf node terminates a CMS path, the attributes collected in cms_effective_attributes are returned along with the public key information collected in cms_public_keys.  When a payload leaf node terminates a CMS path, content type and constraint checking must be performed, as described in the next section.
        
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Content Type and Constraint Checking</h3>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.1"></a><h3>4.4.1.&nbsp;
Inputs</h3>

<p>
            The inputs to content type and constraint checking are the values collected in cms_public_keys and cms_effective_attributes from a CMS path along with the payload leaf node that terminates the CMS path.
          
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.2"></a><h3>4.4.2.&nbsp;
Processing</h3>

<p>
        When a payload leaf node is encountered in a CMS path and a signed or
        authenticated content type is present in the CMS path, content type
        and constraint checking MUST be performed.  Content type and
        constraint checking need not be performed for CMS paths that do not
        contain at least one SignedData, AuthEnvelopedData, or
        AuthenticatedData content type.  The cms_effective_attributes and cms_public_keys variables are used to perform constraint checking.  Two additional state variables are used during the processing: cms_constraints and cms_default_attributes, both of which are initialized to empty.  The steps required to perform content type and constraint checking are below.
      
</p>
<p>For each public key in cms_public_keys, build and validate a certification path from a trust anchor to the public key, providing the content type of the payload leaf node and cms_effective_attributes as input.
</p>
<p>
            </p>
<blockquote class="text">
<p>
                If path validation is successful, add the contents of subject_default_attributes to cms_default_attributes.  The subject_constraints variable returned from certification path validation will contain a single entry.  For each entry in the attrConstraints field of the entry in subject_constraints,
                </p>
<blockquote class="text">
<p>If there is an entry in cms_constraints with the same attrType value, add the value from the attrContraints entry to the entry in cms_constraints if that value does not already appear.
</p>
<p>
                    If there is no entry in cms_constraints with the same attrType value, add a new entry to cms_constraints equal to the entry from the attrConstraints field.
                  
</p>
</blockquote>
              

<p>If the value of canSource field of the entry in the subject_constraints variable for the public key used to verify the signature or MAC closest to the payload leaf node is set to FALSE, constraints checking fails and the CMS path MUST be rejected.
</p>
</blockquote><p>
            
</p>
<p>If no valid certification path can be found, constraints checking fails and the CMS path MUST be rejected.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.3"></a><h3>4.4.3.&nbsp;
Outputs</h3>

<p>
          When a payload leaf node is encountered and content type and constraint
          checking succeeds, return cms_constraints, cms_default_attributes and
          cms_effective_attributes for use in leaf node payload processing.
        
</p>
<p>
          When an encrypted leaf node is encountered and constraint checking is not performed, return cms_public_keys and cms_effective_attributes for use in continued processing (as described in section 4.3.1).
        
</p>
<p>
          The cms_effective_attributes list may contain multiple instances of
          the same attribute type or attributes with multiple values.  Payload
          processing, which might take advantage of these effective attributes,
          needs to describe the proper handling of this situation.  Payload
          processing is described in other documents, and it is expected to be
          specific to a particular content type.
        
</p>
<p>
          The cms_default_attributes list may contain attributes with multiple
          values.  Payload processing, which might take advantage of these
          default attributes, needs to describe the proper handling of this
          situation.  Payload processing is described in other documents, and
          it is expected to be specific to a particular content type.
        
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
        The authorization model described in section 1 allows trust anchors
        with different privileges.  Delegation is accomplished by issuing an
        X.509 certificate.  If the trust anchor issues a certification
        authority (CA) certificate, then further delegation is permitted.  If
        the trust anchor issues an end entity certificate, then further
        delegation is prohibited.
      
</p>
<p>
        For any given certificate, multiple certification paths may exist,
        and each one can yield different results for CMS content constraints
        processing.  To avoid creating unintended results, the impact of CMS
        content constraints included (or omitted) from cross-certificates
        must be evaluated.
      
</p>
<p>CMS content constraints are not used with countersignatures.
</p>
<p>
        Though not explicitly discussed in this document, CMS content
        constraints can be applied to CMS-protected contents featuring
        multiple parallel signers, for example where there is more than one
        SignerInfo, each carrying a signature from a different party, within
        a single SignedData content.  In such cases, each SignerInfo must be
        processed as if it were the only SignerInfo, and the CMS content
        constraints must be met in order for that signature to be considered
        valid.  Unlike signers represented in distinct SignedData contents,
        signers represented by multiple SignerInfos are not considered to be
        collaborating with regard to a particular content.  Each parallel
        signer is evaluated independently; no relationship to the other
        signers in the set of SignerInfos implied.  A content is considered
        valid only if there is at least one valid CMS path employing one
        SignerInfo within each SignedData content, even when more than one
        SignerInfo is present.
      
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>
        There are no IANA considerations.  Please delete this section prior to RFC publication.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AuthEnv">[AuthEnv]</a></td>
<td class="author-text">Housley, R., &ldquo;The Cryptographic Message Syntax (CMS) AuthEnvelopedData Content Type,&rdquo; in progress.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2459">[RFC2459]</a></td>
<td class="author-text"><a href="mailto:housley@spyrus.com">Housley, R.</a>, <a href="mailto:wford@verisign.com">Ford, W.</a>, <a href="mailto:wpolk@nist.gov">Polk, T.</a>, and <a href="mailto:david.solo@citicorp.com">D. Solo</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2459">Internet X.509 Public Key Infrastructure Certificate and CRL Profile</a>,&rdquo; RFC&nbsp;2459, January&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2459.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3274">[RFC3274]</a></td>
<td class="author-text">Gutmann, P., &ldquo;<a href="http://tools.ietf.org/html/rfc3274">Compressed Data Content Type for Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;3274, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3274.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3852">[RFC3852]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3852">Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;3852, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3852.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4073">[RFC4073]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4073">Protecting Multiple Contents with the Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;4073, May&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4073.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X.680">[X.680]</a></td>
<td class="author-text">&ldquo;ITU-T Recommendation X.680: Information Technology - Abstract Syntax Notation One,&rdquo; 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="X.690">[X.690]</a></td>
<td class="author-text">&ldquo;ITU-T Recommendation X.690 Information Technology -
            ASN.1 encoding rules: Specification of Basic Encoding
            Rules (BER), Canonical Encoding Rules (CER) and
            Distinguished Encoding Rules (DER),&rdquo; 1997.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2797">[RFC2797]</a></td>
<td class="author-text"><a href="mailto:mmyers@verisign.com">Myers, M.</a>, <a href="mailto:xliu@cisco.com">Liu, X.</a>, <a href="mailto:jimsch@nwlink.com">Schaad, J.</a>, and <a href="mailto:jsw@meer.net">J. Weinstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2797">Certificate Management Messages over CMS</a>,&rdquo; RFC&nbsp;2797, April&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2797.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4108">[RFC4108]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4108">Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages</a>,&rdquo; RFC&nbsp;4108, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4108.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X.208">[X.208]</a></td>
<td class="author-text">&ldquo;ITU-T Recommendation X.208 -
            Specification of Abstract Syntax Notation One (ASN.1),&rdquo; 1988.</td></tr>
</table>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
ASN.1 Modules</h3>

<p>Appendix A.1 provides the normative ASN.1 definitions for the structures described in this specification using ASN.1 as defined in <a class='info' href='#X.680'>[X.680]<span> (</span><span class='info'>, &ldquo;ITU-T Recommendation X.680: Information Technology - Abstract Syntax Notation One,&rdquo; 1997.</span><span>)</span></a>.  Appendix A.2 provides a module using ASN.1 as defined in <a class='info' href='#X.208'>[X.208]<span> (</span><span class='info'>, &ldquo;ITU-T Recommendation X.208 -             Specification of Abstract Syntax Notation One (ASN.1),&rdquo; 1988.</span><span>)</span></a>.  The module in A.2 removes usage of newer ASN.1 features that provide support for limiting the types of elements that may appear in certain SEQUENCE and SET constructions.  Otherwise, the modules are compatible in terms of encoded representation, i.e., the modules are bits-on-the-wire compatible aside from the limitations on SEQUENCE and SET constituents.  A.2 is included as a courtesy to developers using ASN.1 compilers that do not support current ASN.1.  A.1 references an ASN.1 module from <a class='info' href='#RFC2459'>[RFC2459]<span> (</span><span class='info'>Housley, R., Ford, W., Polk, T., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and CRL Profile,&rdquo; January&nbsp;1999.</span><span>)</span></a>.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
ASN.1 Module Using 1993 Syntax</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   CMSContentConstraintsCertExtn-93
     { iso(1) identified-organization(3) dod(6) internet(1) security(5)
       mechanisms(5) pkix(7) id-mod(0) cmsContentConstr-93(42) }

   DEFINITIONS IMPLICIT TAGS ::= BEGIN

   IMPORTS
       ContentType
         FROM CryptographicMessageSyntax2004 -- from [RFC3852]
           { iso(1) member-body(2) us(840) rsadsi(113549)
             pkcs(1) pkcs-9(9) smime(16) modules(0) cms-2004(24) }
       AttributeType, AttributeValue
         FROM PKIX1Explicit88 -- from [RFC3280]
           { iso(1) identified-organization(3) dod(6) internet(1)
             security(5) mechanisms(5) pkix(7) id-mod(0)
             id-pkix1-explicit(18) }
       EXTENSION
         FROM PKIX1Explicit93 -- from [RFC2459]
           { iso(1) identified-organization(3) dod(6) internet(1)
             security(5) mechanisms(5) pkix(7) id-mod(0)
             id-pkix1-explicit-93(3) } ;

   cmsContentConstraints EXTENSION ::= {
       SYNTAX         CMSContentConstraints
       IDENTIFIED BY  id-pe-cmsContentConstraints }

   id-pe-cmsContentConstraints OBJECT IDENTIFIER ::=
       { iso(1) identified-organization(3) dod(6) internet(1)
         security(5) mechanisms(5) pkix(7) pe(1) 18 }

   CMSContentConstraints ::= ContentTypeConstraintList

   ContentTypeConstraintList ::= SEQUENCE SIZE (1..MAX) OF
                             ContentTypeConstraint

   ContentTypeConstraint ::= SEQUENCE {
       contentType           ContentType,
       canSource             BOOLEAN DEFAULT TRUE,
       attrConstraints       AttrConstraintList OPTIONAL }

   AttrConstraintList ::= SEQUENCE SIZE (1..MAX) OF AttrConstraint

   AttrConstraint ::= SEQUENCE {
       attrType               AttributeType,
       attrValues             SET SIZE (1..MAX) OF AttributeValue }

   END

</pre></div>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
ASN.1 Module Using 1988 Syntax</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   CMSContentConstraintsCertExtn-88
     { iso(1) identified-organization(3) dod(6) internet(1) security(5)
       mechanisms(5) pkix(7) id-mod(0) cmsContentConstr-88(41) }

   DEFINITIONS IMPLICIT TAGS ::=
   BEGIN

   IMPORTS
       ContentType
         FROM CryptographicMessageSyntax2004 -- from [RFC3852]
           { iso(1) member-body(2) us(840) rsadsi(113549)
             pkcs(1) pkcs-9(9) smime(16) modules(0) cms-2004(24) }
       AttributeType, AttributeValue
         FROM PKIX1Explicit88 -- from [RFC3280]
           { iso(1) identified-organization(3) dod(6) internet(1)
             security(5) mechanisms(5) pkix(7) id-mod(0)
             id-pkix1-explicit(18) } ;

   -- Extension object identifier

   id-pe-cmsContentConstraints OBJECT IDENTIFIER ::=
       { iso(1) identified-organization(3) dod(6) internet(1)
         security(5) mechanisms(5) pkix(7) pe(1) 18 }

   -- CMS Content Constraints Certificate Extension

   CMSContentConstraints ::= ContentTypeConstraintList

   ContentTypeConstraintList ::= SEQUENCE SIZE (1..MAX) OF
                             ContentTypeConstraint

   ContentTypeConstraint ::= SEQUENCE {
       contentType           ContentType,
       canSource             BOOLEAN DEFAULT TRUE,
       attrConstraints       AttrConstraintList OPTIONAL }

   AttrConstraintList ::= SEQUENCE SIZE (1..MAX) OF AttrConstraint

   AttrConstraint ::= SEQUENCE {
       attrType               AttributeType,
       attrValues             SET SIZE (1..MAX) OF AttributeValue }

   END

</pre></div>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Russ Housley</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vigil Security, LLC</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">918 Spring Knoll Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Herndon, VA  20170</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:housley@vigilsec.com">housley@vigilsec.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Raksha Reddy</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">National Security Agency</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 6751</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">9800 Savage Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fort Meade, MD  20755</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:r.reddy@radium.ncsc.mil">r.reddy@radium.ncsc.mil</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Carl Wallace</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cygnacom Solutions</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 5200</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">7925 Jones Branch Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">McLean, VA  22102</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cwallace@cygnacom.com">cwallace@cygnacom.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
