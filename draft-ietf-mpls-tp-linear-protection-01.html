<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>MPLS-TP Linear Protection</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="MPLS-TP Linear Protection">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">S. Bryant, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">N. Sprecher, Ed.</td></tr>
<tr><td class="header">Expires: September 8, 2010</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. van Helvoort, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Huawei</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Fulignoli, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Ericsson</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Y. Weingarten</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 07, 2010</td></tr>
</table></td></tr></table>
<h1><br />MPLS-TP Linear Protection<br />draft-ietf-mpls-tp-linear-protection-01.txt</h1>

<h3>Abstract</h3>

<p>The MPLS Transport Profile (MPLS-TP) being specified jointly by IETF
      and ITU-T includes requirements documents and framework documents. The
      framework documents define the basic architecture that is needed in
      order to support various aspects of the required behavior. This document
      addresses the functionality described in the MPLS-TP Survivability
      Framework document and defines a protocol that may be used to fulfill
      the function of the Protection State Coordination for linear protection,
      as described in that document.
</p>
<p>This document is a product of a joint Internet Engineering Task Force
      (IETF) / International Telecommunications Union Telecommunications
      Standardization Sector (ITU-T) effort to include an MPLS Transport
      Profile within the IETF MPLS and PWE3 architectures to support the
      capabilities and functionalities of a packet transport network as
      defined by the ITU-T. 
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 8, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Contributing authors<br />
<a href="#anchor3">2.</a>&nbsp;
Conventions used in this document<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.1.</a>&nbsp;
Acronyms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.2.</a>&nbsp;
Definitions and Terminology<br />
<a href="#anchor6">3.</a>&nbsp;
Protection switching logic<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.</a>&nbsp;
Protection switching trigger mechanisms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.</a>&nbsp;
Protection switching control logical architecture<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.2.1.</a>&nbsp;
PSC Status Module<br />
<a href="#anchor10">4.</a>&nbsp;
Protection state coordination (PSC) protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.1.</a>&nbsp;
Transmission and acceptance of PSC control packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.2.</a>&nbsp;
Protocol format<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.2.1.</a>&nbsp;
PSC Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.2.2.</a>&nbsp;
Protection Type (PT)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.3.</a>&nbsp;
Path fault identifier (FPath)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.2.4.</a>&nbsp;
Active path indicator (Path)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.3.</a>&nbsp;
Principles of Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.3.1.</a>&nbsp;
PSC States<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.3.2.</a>&nbsp;
Failure or Degraded condition (Working path)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.3.3.</a>&nbsp;
Lockout of Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">4.3.4.</a>&nbsp;
Failure or Degraded condition (Recovery path)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">4.3.5.</a>&nbsp;
Operator Controlled Switching<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">4.3.6.</a>&nbsp;
Recovery from switching<br />
<a href="#IANA">5.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>As noted in the architecture for Multi-Protocol Label Switching
      Transport Profile (MPLS-TP) <a class='info' href='#TPFwk'>[TPFwk]<span> (</span><span class='info'>Bocci, M., Bryant, S., and L. Levrau, &ldquo;A Framework for MPLS in Transport Networks,&rdquo; July&nbsp;2009.</span><span>)</span></a>, the overall
      architecture framework for MPLS-TP is based on a profile of the MPLS and
      Pseudowire (PW) procedures as specified for the MPLS and (MS-)PW
      architectures defined in <a class='info' href='#RFC3031'>[RFC3031]<span> (</span><span class='info'>Rosen, E., Viswanathan, A., and R. Callon, &ldquo;Multiprotocol Label Switching           Architecture,&rdquo; Jan&nbsp;2001.</span><span>)</span></a>, <a class='info' href='#RFC3985'>[RFC3985]<span> (</span><span class='info'>Bryant, S. and P. Pate, &ldquo;Pseudowire Emulation Edge-to-Edge (PWE3) Architecture,&rdquo; March&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#RFC5085'>[RFC5085]<span> (</span><span class='info'>Nadeau, T. and C. Pignataro, &ldquo;Pseudowire Virtual Circuit Connectivity Verification (VCCV):           A Control Channel for Pseudowires,&rdquo; December&nbsp;2007.</span><span>)</span></a>. One of the
      basic survivability functions, pointed out by the Survivability
      Framework document <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>, is that of simple
      and rapid protection switching mechanisms for Label Switched Paths (LSP)
      and Pseudo-wires (PW).
</p>
<p>Protection switching is a fully allocated survivability mechanism. It
      is fully allocated in the sense that the route and bandwidth of the
      recovery path is reserved for a selected working path or set of working
      paths. It provides a fast and simple survivability mechanism, that
      allows the network operator to easily grasp the active state of the
      network, compared to other survivability mechanisms.
</p>
<p>As specified in the Survivability Framework document <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>, protection switching is applied to a
      protected domain. For the purposes of this document, we define the
      protected domain of a P2P LSP as consisting of two Label Switching
      Routers (LSR) and the transport paths that connect them. For a P2MP LSP
      the protection domain includes the root (or source) LSR, the destination
      (or sink) LSRs, and the transport paths that connect them.
</p>
<p>In 1+1 unidirectional architecture as presented in <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>, a recovery transport path is dedicated to
      each working transport path. Normal traffic is bridged (as defined in
      <a class='info' href='#RFC4427'>[RFC4427]<span> (</span><span class='info'>Mannie, E. and D. Papadimitriou, &ldquo;Recovery Terminology for Generalized Multi-Protocol Label           Switching,&rdquo; Mar&nbsp;2006.</span><span>)</span></a>)and fed to both the working and the
      recovery transport entities by a permanent bridge at the source of the
      protection domain. The sink of the protection domain selects which of
      the working or recovery entities to receive the traffic from, based on a
      predetermined criteria, e.g. server defect indication. When used for
      bidirectional switching the 1+1 protection architecture must also
      support a Protection State Coordination (PSC) protocol. This protocol is
      used to help synchronize the decisions of both ends of the protection
      domain in selecting the proper traffic flow.
</p>
<p>In the 1:1 architecture, a recovery transport path is dedicated to
      the working transport path of a single service. However, the normal
      traffic is transmitted only once, on either the working or the recovery
      path, by using a selector bridge at the source of the protection domain.
      A selector at the sink of the protection domain then selects the path
      that carries the normal traffic. Since the source and sink need to be
      coordinated to ensure that the selector bridge at both ends select the
      same path, this architecture must support a PSC protocol.
</p>
<p>The 1:n protection architecture extends this last architecture by
      sharing the recovery path amongst n services. Again, the recovery path
      is fully allocated and disjoint from any of the n working transport
      paths that it is being used to protect. The normal data traffic for each
      service is transmitted only once, either on the normal working path for
      that service or, in cases that trigger protection switching (as defined
      in <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>), may be sent on the recovery path.
      It should be noted that in cases where multiple working path services
      have triggered protection switching that some services, dependent upon
      their Service Level Agreement (SLA), may not be transmitted as a result
      of limited resources on the recovery path. In this architecture there is
      a need for coordination of the protection switching, and in addition
      there is need for resource allocation negotiation. Due to the added
      complexity of this architecture, the procedures for this will be delayed
      to a different document and further study.
</p>
<p>As was pointed out in the Survivability Framework <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a> and highlighted above, there is a need for
      coordination between the end-points of the protection domain when
      employing bidirectional protection schemes. This is especially true when
      there is a need to maintain traffic over a co-routed bidirectional LSP.
      This document presents a protocol and a set of procedures for activating
      this coordination within the protection domain.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Contributing authors</h3>

<p>Hao Long (Huawei)
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate           Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Acronyms</h3>

<p style='text-align: left'>This draft uses the following acronyms:
</p><table class="none" align="left" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr>
<td align="left">DNR</td>
<td align="left">Do not revert</td>
</tr>
<tr>
<td align="left">FS</td>
<td align="left">Forced Switch</td>
</tr>
<tr>
<td align="left">GACH</td>
<td align="left">Generic Associated Channel Header</td>
</tr>
<tr>
<td align="left">LSR</td>
<td align="left">Label Switching Router</td>
</tr>
<tr>
<td align="left">MPLS-TP</td>
<td align="left">Transport Profile for MPLS</td>
</tr>
<tr>
<td align="left">MS</td>
<td align="left">Manual Switch</td>
</tr>
<tr>
<td align="left">P2P</td>
<td align="left">Point-to-point</td>
</tr>
<tr>
<td align="left">P2MP</td>
<td align="left">Point-to-multipoint</td>
</tr>
<tr>
<td align="left">PDU</td>
<td align="left">Packet Data Unit</td>
</tr>
<tr>
<td align="left">PSC</td>
<td align="left">Protection State Coordination Protocol</td>
</tr>
<tr>
<td align="left">PST</td>
<td align="left">Path Segment Tunnel</td>
</tr>
<tr>
<td align="left">SD</td>
<td align="left">Signal Degrade</td>
</tr>
<tr>
<td align="left">SF</td>
<td align="left">Signal Fail</td>
</tr>
<tr>
<td align="left">SLA</td>
<td align="left">Service Level Agreement</td>
</tr>
<tr>
<td align="left">WTR</td>
<td align="left">Wait-to-Restore</td>
</tr>
</table>
<br clear="all" />

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Definitions and Terminology</h3>

<p>The terminology used in this document is based on the terminology
        defined in <a class='info' href='#RFC4427'>[RFC4427]<span> (</span><span class='info'>Mannie, E. and D. Papadimitriou, &ldquo;Recovery Terminology for Generalized Multi-Protocol Label           Switching,&rdquo; Mar&nbsp;2006.</span><span>)</span></a> and further adapted for
        MPLS-TP in <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>. In addition, we use the
        term LSR to refer to a MPLS-TP Network Element, whether it is a LSR,
        LER, T-PE, or S-PE.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protection switching logic</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Protection switching trigger mechanisms</h3>

<p>The protection switching should be initiated in reaction to any of
        the following triggers:
</p>
<p></p>
<ul class="text">
<li>Server layer indication &ndash; if the MPLS-TP server layer
            detects a failure within its own layer, or due to a failure of its
            server layer (e.g. the physical layer) notifies the MPLS-TP layer
            that a failure has been detected.  It should be noted that this 
			trigger will be controlled by a holdoff-timer that should be 
			configured to allow the server layer to apply any protection 
			procedures that may be relevant.
</li>
<li>OAM signalling &ndash; if, for example, OAM continuity and
            connectivity verification tools detect that there is a loss of
            continuity or mis-connectivity or performance monitoring indicates
            a degradation of the utility of the working path for the current
            transport path. In cases of signal degradation, switching to the
            recovery path SHOULD only be activated if the recovery path can
            guarantee better conditions than the degraded working path.
</li>
<li>Control plane &ndash; if there is a control plane active in the
            network (either signaling or routing), it MAY trigger protection
            switching based on conditions detected by the control plane. If
            the control-plane is based on GMPLS <a class='info' href='#RFC3945'>[RFC3945]<span> (</span><span class='info'>Mannie, E., &ldquo;Generalized Multi-Protocol Label Switching (GMPLS)           Architecture,&rdquo; Oct&nbsp;2004.</span><span>)</span></a>
            then the recovery process should comply with the process described
            in <a class='info' href='#RFC4872'>[RFC4872]<span> (</span><span class='info'>Lang, J., Papadimitriou, D., and Y. Rekhter, &ldquo;RSVP-TE Extensions in Support of End-to-End Generalized           Multi-Protocol Label Switching (GMPLS) Recovery,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
<li>Operator command &ndash; the network operator may issue
            commands that trigger protection switching. The commands that are
            supported include &ndash; Forced Switch, Manual Switch, Clear,
            Lockout of Protection, (see definitions in <a class='info' href='#RFC4427'>[RFC4427]<span> (</span><span class='info'>Mannie, E. and D. Papadimitriou, &ldquo;Recovery Terminology for Generalized Multi-Protocol Label           Switching,&rdquo; Mar&nbsp;2006.</span><span>)</span></a>).
</li>
</ul>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Protection switching control logical architecture</h3>

<p>Protection switching processes the triggers described above
        together with the inputs received from the far-end LSR. These inputs
        cause the LSR to take certain actions, e.g. switching the Selector
        Bridge to select the working or recovery path, and to transmit
        different protocol messages.
</p><br /><hr class="insert" />
<a name="figure1"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-------------+ Operator Command       Local PSC      +-----------+
|  External   |-----------------+   +-----------------| PSC Status|
|  Interface  |                 |   |   request   +---|   Module  |
+-------------+                 |   |             |   +-----------+
                                V   V             V Prot. Stat. ^
+----------+ Local OAM  +---------------+Highest +------------+ |
|   OAM    |-----------&gt;| Local Request |-------&gt;|  PSC Mess. | |
|  Module  |  request   |    logic      |local R.| Generator  | |
+----------+   +-------&gt;+---------------+        +------------+ |
+----------+   |                      |                 |       |
| Svr/CP   |---+         Highest local|request          |       |
+----------+                          V                 V       |
+-------------+             +-----------------+    PSC Message  |
| Remote Req. | Remote PSC  |  global Request |                 |
|  Receiver   |------------&gt;|      logic      |                 |
+-------------+   Request   +-----------------+                 |
       ^                             |                          |
       |       Highest global request|                          |
       |                             V                          |
       |                    +-----------------+   PSC status    |
Remote PSC message          |    PSC Process  |-----------------+
                            |       logic     |--------&gt; Action
                            |                 |
                            +-----------------+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Protection switching control logic&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p><a class='info' href='#figure1'>Figure&nbsp;1<span> (</span><span class='info'>Protection switching control logic</span><span>)</span></a> describes the logical architecture
        of the protection switching control. The Local Request logic unit
        accepts the triggers from the OAM, external operator commands, and
        from the local control plane (when present) and determines the highest
        priority request. This high-priority request is passed to both the PSC
        Message generator, that will generate the appropriate protocol message
        to be sent to the far-end LSR, and the Global Request logic, that will
        cross-check this local request with the information received from the
        far-LSR. The Global Request logic then processes these two PSC
        requests that determines the highest priority request that is passed
        to the PSC Process logic. The PSC Process logic uses this input to
        determine what actions need to be taken, e.g. switching the Selector
        Bridge, and the current status of the protection domain.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
PSC Status Module</h3>

<p>The PSC Control Logic must retain the status of the protection
          domain. The possible different states indicate the current status of
          the protection environment, and can be in one of three states:
</p>
<p></p>
<ul class="text">
<li>Normal (Idle) state &ndash; When both the recovery and the
              working paths are fully allocated and active, data traffic is
              being transmitted over the working path, and there are no
              trigger events reported within the domain.
</li>
<li>Protecting state &ndash; When either the working path has
              reported a signal failure (SF) or degradation of signal (SD), or
              the operator has issued an operator command and the data traffic
              has been redirected to the recovery path.
</li>
<li>Unavailable state &ndash; When the recovery path is
              unavailable, either as a result of reporting a SF or SD
              condition, or as a result of an administrative Lockout
              command.
</li>
</ul>

<p>This state may affect the actions taken by the control logic, and
          therefore, the PSC Status Module transfers the current status to the
          Local Request Logic.
</p>
<p>See section 4.3.1 for details on what actions are affected by the
          PSC state.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protection state coordination (PSC) protocol</h3>

<p>Bidirectional protection switching, as well as unidirectional 1:1
      protection, requires coordination between the two end-points in
      determining which of the two possible paths, the working or recovery
      path, is transmitting the data traffic in any given situation. When
      protection switching is triggered as described in section 3.1, the
      end-points must inform each other of the switch-over from one path to
      the other in a coordinated fashion.
</p>
<p>There are different possibilities for the type of coordinating
      protocol. One possibility is a two-phased coordination in which the MEP
      that is initiating the protection switching sends a protocol message
      indicating the switch but the actual switch-over is performed only after
      receiving an 'Ack' from the far-end MEP. The other possibility is a
      single-phased coordination, in which the initiating MEP switches over to
      the alternate path and informs the far-end MEP of the switch, and the
      far-end MEP must complete the switch-over.
</p>
<p>In the following sub-sections we describe the protocol messages that
      should be used between the two end-points of the protection domain.
</p>
<p>For the sake of simplicity of the protocol, this protocol is based on
      the single-phase approach described above.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Transmission and acceptance of PSC control packets</h3>

<p>The PSC control packets should be transmitted over the recovery
        path only. This allows the transmission of the messages without
        affecting the normal traffic in the most prevalent case, i.e. the idle
        state. In addition, limiting the transmission to a single path avoids
        possible conflicts and race conditions that could develop if the PSC
        messages were sent on both paths.
</p>
<p>Any new PSC control packet must be transmitted immediately when a
        change in the transmitted status occurs.
</p>
<p>When the PSC information is changed, three PSC packets should be
        transmitted as quickly as possible, so that fast protection switching
        would be possible. Transmission of three rapid packets allows for fast
        protection switching even if one or two PSC packets are lost or
        corrupted. The frequency of the first three packets and the separate
        frequency of the continual transmission is configurable by the
        operator. For protection switching within 50ms, the default interval
        of the first three PSC signals should be no larger than 3.3ms. PSC
        packets after the first three should be transmitted with an interval
        of 5 seconds.
</p>
<p>If no valid PSC specific information is received, the last valid
        received information remains applicable. In the event a signal fail
        condition is detected on the recovery path, the received PSC specific
        information should be evaluated.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Protocol format</h3>

<p>The protocol messages SHALL be sent over the GACH as described in
        <a class='info' href='#RFC5586'>[RFC5586]<span> (</span><span class='info'>Vigoureux,, M., Bocci, M., Swallow, G., Aggarwal, R., and D. Ward, &ldquo;MPLS Generic Associated Channel,&rdquo; May&nbsp;2009.</span><span>)</span></a>. There is a single channel type for the
        set of PSC messages, each message will be identified by the first
        field of the ACH payload as described below. PSC messages SHOULD
        support addressing by use of the method described in <a class='info' href='#RFC5586'>[RFC5586]<span> (</span><span class='info'>Vigoureux,, M., Bocci, M., Swallow, G., Aggarwal, R., and D. Ward, &ldquo;MPLS Generic Associated Channel,&rdquo; May&nbsp;2009.</span><span>)</span></a>. The following figure shows the format for
        the full PSC message.
</p><br /><hr class="insert" />
<a name="figure 2"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0 0 0 1|0 0 0 0|0 0 0 0 0 0 0 0|   MPLS-TP PSC Channel Code    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    ACH TLV Header                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                    Addressing TLV                             +
   :                              ...                              :
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                    PSC Control Packet                         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Format of PSC packet with a GACH header&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Where: </p>
<ul class="text">
<li>MPLS-TP PSC Channel Code is the GACH channel number assigned to
            the PSC = TBD
</li>
<li>The ACH TLV Header is described in <a class='info' href='#RFC5586'>[RFC5586]<span> (</span><span class='info'>Vigoureux,, M., Bocci, M., Swallow, G., Aggarwal, R., and D. Ward, &ldquo;MPLS Generic Associated Channel,&rdquo; May&nbsp;2009.</span><span>)</span></a>
</li>
<li>The use of an Addressing TLV is for further study
</li>
<li>Figure 3 shows the format of the PSC Control message that is 
			the payload for the PSC packet.
</li>
</ul>

<p>Editor's note: There is a suggestion that this format should be
        aligned with the format used by G.8031/G.8131/Y.1731 in ITU. The
        argument being that this would make it easier to pass review from ITU
        and allow easier transfer of technology.
</p>
<p>The counter-argument is that the ITU format is based upon an
        attempt to find a common format for different functionality and
        therefore involves different fields that are not necessary for the
        protection switching. Defining a new dedicated format would make for a
        simpler and more intuitive protocol. End of editor's note.
</p><br /><hr class="insert" />
<a name="figure 3"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Ver|Request| PT|   FPath       |     Path      |    Reserved   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Format of the PSC control packet&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Where: </p>
<ul class="text">
<li>Ver: is the version of the protocol, for this version the value
            SHOULD be 0.
</li>
<li>Request: this field indicates the specific PSC request that is
            being transmitted, the details are described in section 4.2.1
</li>
<li>PT: indicates the type of protection scheme currently
            supported, more details are given in section 4.2.2
</li>
<li>FPath: used to indicate the path that is reporting a failure
            condition, the possible values are described in section 4.2.3
</li>
<li>Path: used to indicate the currently active path, possible
            values are described in section 4.2.4
</li>
<li>Reserved: field is reserved for possible future use. These bits
            MUST be set to zero on transmission, and ignored upon
            reception.
</li>
</ul>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
PSC Requests</h3>

<p>The Protection State Coordination (PSC) protocol SHALL support
          the following request types, in order of priority from highest to
          lowest:
</p>
<p></p>
<ul class="text">
<li>(1111) Clear
</li>
<li>(1110) Lockout protection
</li>
<li>(1101) Forced switch
</li>
<li>(0110) Signal fault
</li>
<li>(0101) Signal degrade
</li>
<li>(0100) Manual switch
</li>
<li>(0011) Wait to restore
</li>
<li>(0010) Do not revert (DNR)
</li>
<li>(0000) No request
</li>
</ul>

<p>See section 4.3 for a description of the operation of the
          different requests.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Protection Type (PT)</h3>

<p>The PT field indicates the currently configured protection
          architecture type, this should be validated to be consistent for
          both ends of the protected domain. If an inconsistency is detected
          then an alarm should be raised. The following are the possible
          values:
</p>
<p></p>
<ul class="text">
<li>11: 1+1 bidirectional switching
</li>
<li>10: 1:1 bidirectional switching
</li>
<li>01: 1+1 unidirectional switching
</li>
<li>00: 1:1 unidirectional switching
</li>
</ul>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Path fault identifier (FPath)</h3>

<p>The Fpath field of the PSC control SHALL be used only in a Signal
          fault (0110) or Signal degrade (0101) control packet. Its value
          indicates on which path the signal anomaly was detected. The
          following are the possible values:
</p>
<p></p>
<ul class="text">
<li>0: indicates that the fault condition is on the Recovery
              path
</li>
<li>1: indicates that the fault condition is on the Working
              path
</li>
<li>2-255: for future extensions
</li>
</ul>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
Active path indicator (Path)</h3>

<p>The Path field of the PSC control SHALL be used to indicate which
          path the source MEP is currently using for data transmission. The
          MEP should compare the value of this bit with the path that is
          locally selected for data transmission to verify that there is no
          inconsistency between the two end-points of the protected domain. If
          an inconsistency is detected then an alarm should be raised. The
          following are the possible values:
</p>
<p></p>
<ul class="text">
<li>0: indicates that normal traffic is being transmitted on the
              Working path.
</li>
<li>1: indicates the Recovery path is being used to transmit the
              normal traffic from the Working path.
</li>
<li>2-255: for future extensions
</li>
</ul>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Principles of Operation</h3>

<p>In all of the following sub-sections, assume a protected domain
        between LSR-A and LSR-Z, using paths W (working) and R (recovery) as
        shown in figure 4.
</p><br /><hr class="insert" />
<a name="figure 4"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
              +-----+ //=======================\\ +-----+
              |LSR-A|//     Working Path        \\|LSR-Z|
              |    /|                             |\    |
              |  ?&lt; |                             | &gt;?  |
              |    \|\\     Recovery Path       //|/    |
              +-----+ \\=======================// +-----+

                  |--------Protected Domain---------|

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Protected domain&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
PSC States</h3>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1.1"></a><h3>4.3.1.1.&nbsp;
Normal State</h3>

<p>When the protected domain has no special condition in effect,
            the ingress LSR SHOULD forward the user data along the working
            path, and, in the case of 1+1 protection, the Permanent Bridge
            will bridge the data to the recovery path as well. The receiving
            LSR SHOULD read the data from the working path.
</p>
<p>The ingress LSR MAY transmit a No Request PSC packet with the
            Path field set to 0 indicating that the normal data traffic should
            be read from the working path.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1.2"></a><h3>4.3.1.2.&nbsp;
Protecting State</h3>

<p>When the protection mechanism has been triggered and the
            protected domain has performed a protection switch, the domain is
            in the protecting state. In this state the normal data traffic is
            transmitted and received on the recovery path.
</p>
<p>If the protection domain is currently in a protecting state,
            then the LSRs SHOULD NOT accept a Manual Switch request.
</p>
<p>If the protection domain is currently in a protecting state,
            and a Forced Switch is requested then the normal traffic SHALL
            continue to be transmitted on the recovery path even if the
            original protection trigger is cleared, and the Forced Switch
            condition will be signalled by the PSC messages.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1.3"></a><h3>4.3.1.3.&nbsp;
Unavailable State</h3>

<p>When the recovery path is unavailable &ndash; either as a
            result of a Lockout operator command (see section 4.3.3), or as a
            result of a SF or SD detected on the recovery path (see section
            4.3.4) &ndash; then the protection domain is in the unavailable
            state. In this state, the normal traffic is transmitted and
            received on the working path.
</p>
<p>While in unavailable state any event that would trigger a
            protection switching SHOULD be ignored with the following
            exception &ndash; If a Signal Degrade request is received, then
            protection switching will be activated only if the recovery path
            can guarantee a better signal than the working path.
</p>
<p>The protection domain will exit the unavailable state and
            revert to the normal state when, either the operator clears the
            Lockout command or the recovery path recovers from the signal
            fault or degraded situation. Both ends will resume sending the PCS
            packets over the recovery path, as a result of this recovery.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Failure or Degraded condition (Working path)</h3>

<p>If one of the LSRs (for example, LSR-A) detects a failure
          condition or a serious degradation condition on the working path
          that warrants invoking protection switching, then it SHOULD take the
          following actions:
</p>
<p></p>
<ul class="text">
<li>(For 1:1 protection) Switch all traffic for LSR-Z to the
              recovery path only.
</li>
<li>Transmit a PCS control packet, using GACH, with the
              appropriate Request code (either Signal fault or Signal
              degrade), the Fpath set to 1, to indicate that the fault/degrade
              was detected on the working path, and the Path set to 1,
              indicating that normal traffic is now being transmitted on the
              recovery path.
</li>
<li>Verify that LSR-Z replies with a PCS control packet
              indicating that it has switched to the recovery path. If this is
              not received after 2 PSC cycles then send an alarm to the
              management system.
</li>
</ul>

<p>When the far-end LSR (in this example LSR-Z) receives the PCS
          packet informing it that other LSR (LSR-A) has switched, it SHOULD
          perform the following actions:
</p>
<p></p>
<ul class="text">
<li>Check priority of the request
</li>
<li>Switch all traffic addressed to LSR-A to the recovery path
              only (for 1:1 protection).
</li>
<li>Begin transmission of a PCS control packet, using GACH, with
              the appropriate Request code (either Signal fault or Signal
              degrade), the Fpath set to 1, to indicate that the fault/degrade
              was detected on the working path, and the Path set to 1,
              indicating that traffic is now being transmitted on the recovery
              path.
</li>
</ul>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Lockout of Protection</h3>

<p>If one of the LSRs (for example, LSR-A) receives a management
          command indicating that the protection is disabled, then it SHOULD
          indicate this to the far-end LSR (LSR-Z in this example) that it is
          not possible to use the recovery path. The following actions MUST be
          taken:
</p>
<p></p>
<ul class="text">
<li>Transmit a PCS control packet, using GACH, with the Request
              code set to Lockout of protection (1110), the Fpath may be set to 0,
              and the Path set to 0.
</li>
<li>All normal traffic packets should be transmitted on the
              working path only.
</li>
<li>Verify that the far-end LSR (for example LSR-Z) is forwarding
              the data packets on the working path. Raise alarm in case of
              mismatch.
</li>
<li>The PSC control logic should go into Unavailable state.
</li>
</ul>

<p>When the far-end LSR (in this example LSR-Z) receives the PCS
          packet informing it that other LSR (LSR-A) has switched, it SHOULD
          perform the following actions:
</p>
<p></p>
<ul class="text">
<li>Check priority of request
</li>
<li>Switch all normal traffic addressed to LSR-A to the working
              path only.
</li>
<li>The PSC control logic should go into Unavailable status.
</li>
<li>Begin transmission of a PCS control packet, using GACH, with
              the appropriate Request code (Lockout of protection), the Fpath
              set to 0, and the Path set to 0, indicating that traffic is now
              being transmitted on the working path only.
</li>
</ul>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.4"></a><h3>4.3.4.&nbsp;
Failure or Degraded condition (Recovery path)</h3>

<p>If one of the LSRs (for example, LSR-A) detects a failure
          condition or a serious degradation condition on the recovery path,
          then it SHOULD take the following actions:
</p>
<p></p>
<ul class="text">
<li>Begin transmission of a PCS control packet with the
              appropriate Request code (either Signal fault or Signal
              degrade), the Fpath set to 0, to indicate that the fault/degrade
              was detected on the recovery path, and the Path set to 0,
              indicating that traffic is now being forwarded on the working
              path. Note that this will actually reach the far-end if this is
              a unidirectional fault or recovery path is possibly in a
              degraded situation.
</li>
<li>The PSC control logic should go into Unavailable state.
</li>
<li>All traffic MUST be transmitted on the working path for the
              duration of the SF/SD condition.
</li>
</ul>

<p>When the far-end LSR (in this example LSR-Z) receives the PCS
          packet informing it that other LSR (LSR-A) has become Unavailable,
          it SHOULD perform the following actions:
</p>
<p></p>
<ul class="text">
<li>Transmit all traffic on the working path for the duration of
              the SF/SD condition
</li>
<li>The PSC Control logic should go into Unavailable state.
</li>
</ul>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.5"></a><h3>4.3.5.&nbsp;
Operator Controlled Switching</h3>

<p>If the management system indicated to one of the LSRs (for
          example LSR-A) that a switch is necessary, e.g. either a Forced
          Switch or a Manual Switch, then the LSR SHOULD switch the traffic to
          the recovery path and perform the following actions:
</p>
<p></p>
<ul class="text">
<li>Switch all data traffic to the recovery path only.
</li>
<li>Transmit a PCS control packet, using GACH, with the
              appropriate Request code (either Manual switch or Forced
              switch), the Fpath may be set to 1, to indicate that there 
              is an event that affects the working path, and the Path set to 1,
              indicating that traffic is now being forwarded on the recovery
              path.
</li>
<li>Verify that LSR-Z replies with a PCS control packet
              indicating that it has switched to the recovery path. If this is
              not received after 2 PSC cycles then send an alarm to the
              management system.
</li>
</ul>

<p>When the far-end LSR (in this example LSR-Z) receives the PCS
          packet informing it that other LSR (LSR-A) has switched, it SHOULD
          perform the following actions:
</p>
<p></p>
<ul class="text">
<li>Check priority of the request
</li>
<li>Switch all normal traffic addressed to LSR-A to the recovery
              path only.
</li>
<li>Begin transmission of a PCS control packet, using GACH, with
              the appropriate Request code (either Manual switch of Forced
              switch), the Fpath may be set to 1, to indicate that there 
              is an event that affects the working path, and the Path set to 1,
              indicating that traffic is now being forwarded on the recovery
              path.
</li>
</ul>

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.5.1"></a><h3>4.3.5.1.&nbsp;
Clearing operator commands</h3>

<p>The operator may clear the switching condition by issuing a
            Clear request. This command will cause immediate recovery from the
            switch that was initiated by any of the previous operator
            commands, i.e. Forced Switch or Manual Switch. In addition, a
            Clear command after a Lockout Protection command should clear the
            Unavailable state and return the protection domain to the normal
            state.
</p>
<p>If the Clear request is issued in the absence of a Manual
            Switch, Forced Switch, or Lockout protection, then it SHALL be
            ignored. In the presence of any of these commands, the Clear
            request SHALL clear the state affected by the operator
            command.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.6"></a><h3>4.3.6.&nbsp;
Recovery from switching</h3>

<p>When the condition that triggered the protection switching
          clears, e.g. the cause of the failure condition has been corrected,
          or the operator clears a Manual Switch, then the protection domain
          SHOULD follow the following procedures:
</p>
<p></p>
<ul class="text">
<li>If the network is configured for non-revertive behaviour,
              then the two LSRs SHOULD transmit DNR (Request code 0010)
              messages.
</li>
<li>If the network is recovering from an operator switching
              command (in revertive mode), then both LSRs SHOULD return to
              using the working transport path and transmit No request
              (Request code 0000) messages.
</li>
<li>If the network is recovering from a failure or degraded
              condition (in revertive mode), then the LSR that detects this
              recovery SHALL activate a local Wait-to-restore (WTR) timer (see
              section 4.3.6.1) to verify that there is not an intermittent
              failure. After the WTR expires, the LSR SHOULD return to using
              the working transport path and transmit No request (Request code
              0000) messages.
</li>
</ul>

<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.6.1"></a><h3>4.3.6.1.&nbsp;
Wait-to-restore timer</h3>

<p>In revertive mode, in order to prevent frequent activation of
            protection switching due to an intermittent defect, the working
            transport path must become stable and fault-free before reverting
            to the normal condition. In order to verify that this is the case
            a fixed period of time must elapse before the normal traffic uses
            the working transport path. This period, called the
            Wait-to-restore (WTR) period, should be configurable by the
            operator in 1-minute intervals within the range 1-12 minutes. The
            default value is 5 minutes.
</p>
<p>During this period, if a failure condition is detected on the
            working transport path, then the WTR timer is cleared and the
            normal traffic SHALL continue to be transported over the recovery
            transport path. If the WTR timer expires without being pre-empted
            by a failure, then the traffic SHOULD be returned to use the
            working transport path (as above).
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>To be added in future version.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>To be added in future version.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thank all members of the teams (the Joint
      Working Team, the MPLS Interoperability Design Team in IETF and the
      T-MPLS Ad Hoc Group in ITU-T) involved in the definition and
      specification of MPLS Transport Profile.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate
          Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3031">[RFC3031]</a></td>
<td class="author-text">Rosen, E., Viswanathan, A., and R. Callon, &ldquo;<a href="http://tools.ietf.org/html/rfc3031">Multiprotocol Label Switching
          Architecture</a>,&rdquo; RFC&nbsp;3031, Jan&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3985">[RFC3985]</a></td>
<td class="author-text">Bryant, S. and P. Pate, &ldquo;<a href="http://tools.ietf.org/html/rfc3985">Pseudowire Emulation Edge-to-Edge (PWE3) Architecture</a>,&rdquo; RFC&nbsp;3985, March&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc3985.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5085">[RFC5085]</a></td>
<td class="author-text">Nadeau, T. and C. Pignataro, &ldquo;<a href="http://tools.ietf.org/html/rfc5085">Pseudowire Virtual Circuit Connectivity Verification (VCCV):
          A Control Channel for Pseudowires</a>,&rdquo; RFC&nbsp;5085, December&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5085.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TPFwk">[TPFwk]</a></td>
<td class="author-text">Bocci, M., Bryant, S., and L. Levrau, &ldquo;A Framework for MPLS in Transport Networks,&rdquo; ID&nbsp;draft-ietf-mpls-tp-framework-06.txt, July&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5586">[RFC5586]</a></td>
<td class="author-text">Vigoureux,, M., Bocci, M., Swallow, G., Aggarwal, R., and D. Ward, &ldquo;<a href="http://tools.ietf.org/html/rfc5586">MPLS Generic Associated Channel</a>,&rdquo; RFC&nbsp;5586, May&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4427">[RFC4427]</a></td>
<td class="author-text">Mannie, E. and D. Papadimitriou, &ldquo;<a href="http://tools.ietf.org/html/rfc4427">Recovery Terminology for Generalized Multi-Protocol Label
          Switching</a>,&rdquo; RFC&nbsp;4427, Mar&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="SurvivFwk">[SurvivFwk]</a></td>
<td class="author-text">Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile
          Survivability Framework,&rdquo; ID&nbsp;draft-ietf-mpls-tp-survive-fwk-02.txt, Feb&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4872">[RFC4872]</a></td>
<td class="author-text">Lang, J., Papadimitriou, D., and Y. Rekhter, &ldquo;<a href="http://tools.ietf.org/html/rfc4872">RSVP-TE Extensions in Support of End-to-End Generalized
          Multi-Protocol Label Switching (GMPLS) Recovery</a>,&rdquo; RFC&nbsp;4872, May&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3945">[RFC3945]</a></td>
<td class="author-text">Mannie, E., &ldquo;<a href="http://tools.ietf.org/html/rfc3945">Generalized Multi-Protocol Label Switching (GMPLS)
          Architecture</a>,&rdquo; RFC&nbsp;3945, Oct&nbsp;2004.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stewart Bryant (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">United Kingdom</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:stbryant@cisco.com">stbryant@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nurit Sprecher (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3 Hanagar St. Neve Ne'eman B</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hod Hasharon,   45241</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:nurit.sprecher@nsn.com">nurit.sprecher@nsn.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huub van Helvoort (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kolkgriend 38, 1356 BC Almere</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Netherlands</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+31 36 5316076</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hhelvoort@huawei.com">hhelvoort@huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Annamaria Fulignoli (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ericsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Italy</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:annamaria.fulignoli@ericsson.com">annamaria.fulignoli@ericsson.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yaacov Weingarten</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3 Hanagar St. Neve Ne'eman B</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hod Hasharon,   45241</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+972-9-775 1827</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yaacov.weingarten@nsn.com">yaacov.weingarten@nsn.com</a></td></tr>
</table>
</body></html>
