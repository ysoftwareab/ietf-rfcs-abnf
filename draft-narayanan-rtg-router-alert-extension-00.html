<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IP Router Alert Option
    Extension</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IP Router Alert Option
    Extension">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">A. Narayanan</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">F. Le Faucheur</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">D. Ward</td></tr>
<tr><td class="header">Expires: September 6, 2009</td><td class="header">R. Rahman</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 05, 2009</td></tr>
</table></td></tr></table>
<h1><br />IP Router Alert Option
    Extension<br />draft-narayanan-rtg-router-alert-extension-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 6, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The IP Router Alert Option is an IP option that alerts transit
      routers to more closely examine the contents of an IP packet. RSVP, PGM
      and IGMP are some of the protocols which make use of the IP Router Alert
      option. The current specification for the IP Router Alert Option does
      not define mechanisms to facilitate discriminating across different
      users of Router Alert. As a result, networks using router Alert may have
      more secuity exposure than necessary and/or may unnecessarily block some
      transit Router Alert packets. This document describes new rules for the
      IP Router-Alert Option that aid routers to process these packets more
      selectively.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Conventions Used in This Document<br />
<a href="#anchor3">2.</a>&nbsp;
Introduction<br />
<a href="#enhancement">3.</a>&nbsp;
IP Router Alert Option Enhancement<br />
<a href="#security">4.</a>&nbsp;
Security Considerations<br />
<a href="#anchor4">5.</a>&nbsp;
IANA Considerations<br />
<a href="#Acknowledgements">6.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Terminology</h3>

<p>For readability, this document uses the following loosely defined
      terms:</p>
<ul class="text">
<li>Slow path : Software processing path for packets
</li>
<li>Fast path : ASIC/Hardware processing path for packets
</li>
</ul>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions Used in This Document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p><a class='info' href='#RFC2113'>[RFC2113]<span> (</span><span class='info'>Katz, D., &ldquo;IP Router Alert Option,&rdquo; February&nbsp;1997.</span><span>)</span></a> and <a class='info' href='#RFC2711'>[RFC2711]<span> (</span><span class='info'>Partridge, C. and A. Jackson, &ldquo;IPv6 Router Alert Option,&rdquo; October&nbsp;1999.</span><span>)</span></a>
      respectively define the IPv4 and IPv6 Router Alert Option. In this
      document, we collectively refer to those as the IP Router Alert. RSVP
      (<a class='info' href='#RFC2205'>[RFC2205]<span> (</span><span class='info'>Braden, B., Zhang, L., Berson, S., Herzog, S., and S. Jamin, &ldquo;Resource ReSerVation Protocol (RSVP) -- Version 1 Functional Specification,&rdquo; September&nbsp;1997.</span><span>)</span></a>, <a class='info' href='#RFC3209'>[RFC3209]<span> (</span><span class='info'>Awduche, D., Berger, L., Gan, D., Li, T., Srinivasan, V., and G. Swallow, &ldquo;RSVP-TE: Extensions to RSVP for LSP Tunnels,&rdquo; December&nbsp;2001.</span><span>)</span></a>), PGM
      (<a class='info' href='#RFC3208'>[RFC3208]<span> (</span><span class='info'>Speakman, T., Crowcroft, J., Gemmell, J., Farinacci, D., Lin, S., Leshchiner, D., Luby, M., Montgomery, T., Rizzo, L., Tweedly, A., Bhaskar, N., Edmonstone, R., Sumanasekera, R., and L. Vicisano, &ldquo;PGM Reliable Transport Protocol Specification,&rdquo; December&nbsp;2001.</span><span>)</span></a>) and IGMP (<a class='info' href='#RFC3376'>[RFC3376]<span> (</span><span class='info'>Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;Internet Group Management Protocol, Version 3,&rdquo; October&nbsp;2002.</span><span>)</span></a>) are but some of the protocols which make use
      of the IP Router Alert. Those protocols are used to support critical
      elements of the Internet infrastructure (e.g. RSVP-TE for traffic
      engineering within a service provider network) and as such they need to
      be protected.
</p>
<p>IP datagrams carrying the IP Router Alert are usually examined in a
      router&rsquo;s "slow path" and an excess of such datagrams can cause
      performance degradation or packet drops in a router&rsquo;s "slow path".
      (Note that a router&rsquo;s "slow path&rdquo; can potentially also be
      attacked with IP packets destined to one of the router&rsquo;s local IP
      addresses and requires corresponding security protection.)
</p>
<p><a class='info' href='#RFC4081'>[RFC4081]<span> (</span><span class='info'>Tschofenig, H. and D. Kroeselberg, &ldquo;Security Threats for Next Steps in Signaling (NSIS),&rdquo; June&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#RFC2711'>[RFC2711]<span> (</span><span class='info'>Partridge, C. and A. Jackson, &ldquo;IPv6 Router Alert Option,&rdquo; October&nbsp;1999.</span><span>)</span></a>
      mention the security risks associated with the use of the IP Router
      Alert: flooding a router with bogus IP datagrams which contain the IP
      Router Alert would cause a performance degradation of the router&rsquo;s
      "slow path" and can also lead to packet drops in the "slow path".
</p>
<p><a class='info' href='#RFC2113'>[RFC2113]<span> (</span><span class='info'>Katz, D., &ldquo;IP Router Alert Option,&rdquo; February&nbsp;1997.</span><span>)</span></a> specifies no mechanism for identifying
      different users of IP Router Alert. As a result, many fast switching
      implementations of IP Router Alert punt most/all packets marked with IP
      Router Alert into the slow path. To protect against overloading routers
      which receive a large number of IP Router Alert packets that they do not
      need to process, many router implementations limit the rate of packets
      punted into the slow path, but once again the lack of discrimination of
      different protocols may hamper the smooth functioning of protocols that
      depend on IP Router Alert. Further, some network operators actively
      protect routers from IP Router Alert packets by discarding these packets
      at the edge, which is undesirable for end-to-end operation of protocols
      carrying this option. Details on these issues and some recommendations
      on best practices are described in <a class='info' href='#I-D.rahman-rtg-router-alert-considerations'>[I&#8209;D.rahman&#8209;rtg&#8209;router&#8209;alert&#8209;considerations]<span> (</span><span class='info'>Faucheur, F., &ldquo;IP Router Alert Considerations and Usage,&rdquo; October&nbsp;2009.</span><span>)</span></a>. The
      specification of an efficient, general-purpose, protocol-independent
      mechanism for discriminating between different applications would aid
      router implementations to more efficiently select the protocol messages
      they need to punt and locally process, while ignoring and forwarding in
      the fast path the messages that they do not need to see.
</p>
<p>This document enhances the current specification of Router Alert to
      ensure that risks associated with unintentional interception of packets
      that are not of real interest to a given router are minimized (if not
      eliminated) by facilitating identification in the fast path of the
      subset of packets with router alert that are of interest to the router.
      A key aspect of the proposal is to facilitate finer grain identification
      of router alert packets of interest versus unwanted router alert packets
      while only requiring inspection of the router alert header. In
      particular:
</p>
<p></p>
<ul class="text">
<li>the enhancement allows the router to identify the application of
          packets marked with IP Router-Alert by simply examining the IP
          header, independent of any application packet format.
</li>
<li>the enhancement allows router alert packets from different
          application protocols to be easily distinguished even if they share
          the same transport protocol (i.e. the have the same IP PID).
</li>
<li>the enhancement allows router alert packets for the same
          application protocol but associated with different contexts (e.g.
          end to end RSVP vs internal RSVP-TE) to be easily distinguished.
</li>
</ul><p>Note that this mechanism does not prevent attacks of the form
      of bogus protocol messages which may be of interest to the router. More
      details on this are presented in <a class='info' href='#security'>Section&nbsp;4<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>.
</p>
<a name="enhancement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
IP Router Alert Option Enhancement</h3>

<p>We propose an extension to the specification and processing behaviour
      of the IP RAO header. <a class='info' href='#RFC2113'>[RFC2113]<span> (</span><span class='info'>Katz, D., &ldquo;IP Router Alert Option,&rdquo; February&nbsp;1997.</span><span>)</span></a> specifies a 2-octet
      value in the IP RAO option field. <a class='info' href='#RFC5350'>[RFC5350]<span> (</span><span class='info'>Manner, J. and A. McDonald, &ldquo;IANA Considerations for the IPv4 and IPv6 Router Alert Options,&rdquo; September&nbsp;2008.</span><span>)</span></a>
      specifies creation of an IANA registry for managing this 2-octet value,
      and proposes IPv4 RAO usage as follows:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Value</th><th align="left">Description</th><th align="left">Reference</th></tr>
<tr>
<td align="left">0</td>
<td align="left">Router Shall Examine Packet</td>
<td align="left">RFC2113</td>
</tr>
<tr>
<td align="left">1-32</td>
<td align="left">Aggregated Reservation Nesting Level</td>
<td align="left">RFC3175</td>
</tr>
<tr>
<td align="left">33-65502</td>
<td align="left">Available for assignment by the IANA</td>
<td align="left">RFC5350</td>
</tr>
<tr>
<td align="left">65503-65534</td>
<td align="left">Available for experimental use</td>
<td align="left">RFC5350</td>
</tr>
<tr>
<td align="left">65535</td>
<td align="left">Reserved</td>
<td align="left">RFC5350</td>
</tr>
</table>
<br clear="all" />

<p>An IANA-maintained IPv6 RAO registry is specified in <a class='info' href='#RFC2711'>[RFC2711]<span> (</span><span class='info'>Partridge, C. and A. Jackson, &ldquo;IPv6 Router Alert Option,&rdquo; October&nbsp;1999.</span><span>)</span></a> and clarified in <a class='info' href='#RFC5350'>[RFC5350]<span> (</span><span class='info'>Manner, J. and A. McDonald, &ldquo;IANA Considerations for the IPv4 and IPv6 Router Alert Options,&rdquo; September&nbsp;2008.</span><span>)</span></a>. The current IPv6 RAO usage is:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Value</th><th align="left">Description</th><th align="left">Reference</th></tr>
<tr>
<td align="left">0</td>
<td align="left">Multicast Listener Discovery</td>
<td align="left">RFC2711</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">RSVP</td>
<td align="left">RFC2711</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">Active Networks</td>
<td align="left">RFC2711</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">Reserved</td>
<td align="left">RFC5350</td>
</tr>
<tr>
<td align="left">4-35</td>
<td align="left">RSVP Aggregation</td>
<td align="left">RFC3175</td>
</tr>
<tr>
<td align="left">36-65535</td>
<td align="left">Available for assignment by the IANA</td>
<td align="left">RFC2711</td>
</tr>
</table>
<br clear="all" />

<p>
</p>
<p>We propose to extend the definition of IP Router-Alert Option values.
      The 2-octet Option Value field will now be used to identify the protocol
      and context from an IP RAO perspective. For IANA assignment purposes,
      this value will be split into two fields as follows:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">service selector (10 bits)</th><th align="left">context selector (6 bits)</th></tr>

<p>The service selector will be assigned to different applications by
      IANA and the context selector will be specific to the application
      protocol. Service selector 0 is reserved for backward compatibility and
      service selector 1023 is reserved for experimental use. Depending on
      requirements, a single protocol or application may be assigned multiple
      service selectors. All currently assigned option values of IPv4 and IPv6
      RAO have service selector 0. The experimental use range is extended to
      be 65472-65534.
</p>
<p>All new protocols using IP RAO MUST request allocations of new
      service and context selector values, and MUST follow this format for the
      Option Value in the IP header. Additionally, new service and context
      selector values will be allocated for legacy protocols using IP RAO.
      Existing implementations of these legacy protocols SHOULD be updated to
      use the new selector values. The use of new option values for legacy
      protocols SHOULD be configurable by the user, and SHOULD be on by
      default. However, extensions to legacy protocols that require new option
      values MUST follow the new option format. For the purposes of this
      requirement, "legacy protocols" are defined as those already
      standardized in the IETF as using IP Router-Alert - specifically:
</p>
<p></p>
<ul class="text">
<li>RSVP - IPv4: 0-32, IPv6: 1, 4-35 (<a class='info' href='#RFC2205'>[RFC2205]<span> (</span><span class='info'>Braden, B., Zhang, L., Berson, S., Herzog, S., and S. Jamin, &ldquo;Resource ReSerVation Protocol (RSVP) -- Version 1 Functional Specification,&rdquo; September&nbsp;1997.</span><span>)</span></a>,<a class='info' href='#RFC3175'>[RFC3175]<span> (</span><span class='info'>Baker, F., Iturralde, C., Le Faucheur, F., and B. Davie, &ldquo;Aggregation of RSVP for IPv4 and IPv6 Reservations,&rdquo; September&nbsp;2001.</span><span>)</span></a>)
</li>
<li>RSVP/TE - IPv4: 0, IPv6: 1 (<a class='info' href='#RFC3209'>[RFC3209]<span> (</span><span class='info'>Awduche, D., Berger, L., Gan, D., Li, T., Srinivasan, V., and G. Swallow, &ldquo;RSVP-TE: Extensions to RSVP for LSP Tunnels,&rdquo; December&nbsp;2001.</span><span>)</span></a>)
</li>
<li>IGMPv2 - IPv4: 0 (<a class='info' href='#RFC2236'>[RFC2236]<span> (</span><span class='info'>Fenner, W., &ldquo;Internet Group Management Protocol, Version 2,&rdquo; November&nbsp;1997.</span><span>)</span></a>)
</li>
<li>IGMPv3 - IPv4: 0 (<a class='info' href='#RFC3376'>[RFC3376]<span> (</span><span class='info'>Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;Internet Group Management Protocol, Version 3,&rdquo; October&nbsp;2002.</span><span>)</span></a>)
</li>
<li>MLDv1 - IPv6: 0 (<a class='info' href='#RFC2710'>[RFC2710]<span> (</span><span class='info'>Deering, S., Fenner, W., and B. Haberman, &ldquo;Multicast Listener Discovery (MLD) for IPv6,&rdquo; October&nbsp;1999.</span><span>)</span></a>)
</li>
<li>MLDv2 - IPv6: 0 (<a class='info' href='#RFC3810'>[RFC3810]<span> (</span><span class='info'>Vida, R. and L. Costa, &ldquo;Multicast Listener Discovery Version 2 (MLDv2) for IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>)
</li>
<li>Multicast Router Discovery - IPv4: 0, IPv6: unspecified (<a class='info' href='#RFC4286'>[RFC4286]<span> (</span><span class='info'>Haberman, B. and J. Martin, &ldquo;Multicast Router Discovery,&rdquo; December&nbsp;2005.</span><span>)</span></a>)
</li>
<li>PGM - IPv4: 0 (<a class='info' href='#RFC3208'>[RFC3208]<span> (</span><span class='info'>Speakman, T., Crowcroft, J., Gemmell, J., Farinacci, D., Lin, S., Leshchiner, D., Luby, M., Montgomery, T., Rizzo, L., Tweedly, A., Bhaskar, N., Edmonstone, R., Sumanasekera, R., and L. Vicisano, &ldquo;PGM Reliable Transport Protocol Specification,&rdquo; December&nbsp;2001.</span><span>)</span></a>)
</li>
<li>Active Network - IPv6: 2 (cited in <a class='info' href='#RFC2711'>[RFC2711]<span> (</span><span class='info'>Partridge, C. and A. Jackson, &ldquo;IPv6 Router Alert Option,&rdquo; October&nbsp;1999.</span><span>)</span></a>)
</li>
</ul><p>Correspondingly, "new protocols" are those for which the use of
      IP Router-Alert has not yet been standardized.
</p>
<p>For service selector 1-1022, the value of the service and context
      selector fields MUST be assigned in a manner such that the content of
      the IP RAO option is sufficient to determine whether a packet is of
      interest to a node, with a reasonable level of granularity. For example,
      having the <a class='info' href='#RFC3175'>[RFC3175]<span> (</span><span class='info'>Baker, F., Iturralde, C., Le Faucheur, F., and B. Davie, &ldquo;Aggregation of RSVP for IPv4 and IPv6 Reservations,&rdquo; September&nbsp;2001.</span><span>)</span></a> aggregate reservation nesting
      level in the context selector allows P routers to quickly separate out
      RSVP messages for aggregate vs. end-to-end flows. Or, a separate context
      (or service) selector for RSVP-IPv4 vs. RSVP-TE sessions allows nodes to
      efficiently ignore one session type while processing another. Also,
      service and context selectors SHOULD be assigned the same for IPv4 and
      IPv6 versions of the same application.
</p>
<p>Fast path switching implementations SHOULD first look at the service
      selector and context selector fields to determine whether they wish to
      select a packet with IP RAO for local processing. A table of in-use
      service and context selector values can be looked up during packet
      switching to determine whether the packet is to be locally processed.
      Thus, for packets marked with service selectors 1-1022, the value of the
      IP RAO value field is sufficient to rapidly determine whether the packet
      may be forwarded unmodified or whether it should be examined further for
      local processing. If the protocol/context selector of the packet does
      not match those that are of interest to currently running protocols, the
      router SHOULD forward these packets unmodified in the fast path. By
      extension, if no applications that use IP Router-Alert are currently
      running on the router, the router SHOULD forward all packets with IP
      Router-Alert Option in the fast path, unmodified.
</p>
<p>The service selector 0 is reserved for backwards compatibility. For
      packets marked with service selector 0, the packet MUST be examined
      further to determine whether it is of local interest, in compliance with
      current protocol requirements. The context selector may be ignored for
      these packets.
</p>
<p>All the practices described in <a class='info' href='#I-D.rahman-rtg-router-alert-considerations'>[I&#8209;D.rahman&#8209;rtg&#8209;router&#8209;alert&#8209;considerations]<span> (</span><span class='info'>Faucheur, F., &ldquo;IP Router Alert Considerations and Usage,&rdquo; October&nbsp;2009.</span><span>)</span></a> regarding
      protecting router control plane resources from attacks based on IP RAO,
      and protecting different protocols using IP RAO from each other,
      continue to apply in this context.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>This document describes an efficient mechanism for router
      implementations to identify packets marked with the IP Router-Alert
      Option but which are not of interest to this router, and forward them
      unprocessed.
</p>
<p>It is important to note that the use of this extension does not
      change in any way the security properties of the IP Router-Alert Option.
      Specifically, no claim is made of enhancing the security of IP
      Router-Alert Option usage. An attacker can always consume excess
      resources on a router's control plane and/or slow path by sending it
      bogus packets with IP RAO protocol/context selector values that are of
      interest to the router. However, the network operator now has the option
      to selectively suppress incoming IP RAO packets at the edge for
      protocols they are using in their network, while still permitting other
      applications with IP RAO to transit efficiently across their network.
      For example, a network operator could choose to suppress incoming IP RAO
      packets at the edge corresponding to RSVP/TE if they are using RSVP/TE
      in their network, but still transit end-to-end IPv4 RSVP sessions
      efficiently.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>This document requires an extension to the IP RAO IANA registry
      established in <a class='info' href='#RFC5350'>[RFC5350]<span> (</span><span class='info'>Manner, J. and A. McDonald, &ldquo;IANA Considerations for the IPv4 and IPv6 Router Alert Options,&rdquo; September&nbsp;2008.</span><span>)</span></a>. IP Router-Alert Option
      values will be assigned as described in <a class='info' href='#enhancement'>Section&nbsp;3<span> (</span><span class='info'>IP Router Alert Option Enhancement</span><span>)</span></a>.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgments</h3>

<p>We would like to thank Dave Oran, Magnus Westerlund, John Scudder,
      Ron Bonica, Ross Callon, and Alfred Hines for their comments.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0791">[RFC0791]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;791, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc791.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2113">[RFC2113]</a></td>
<td class="author-text"><a href="mailto:dkatz@cisco.com">Katz, D.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2113">IP Router Alert Option</a>,&rdquo; RFC&nbsp;2113, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2113.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2113.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2113.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2711">[RFC2711]</a></td>
<td class="author-text"><a href="mailto:craig@bbn.com">Partridge, C.</a> and <a href="mailto:awjacks@bbn.com">A. Jackson</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2711">IPv6 Router Alert Option</a>,&rdquo; RFC&nbsp;2711, October&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2711.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.dasmith-mpls-ip-options">[I-D.dasmith-mpls-ip-options]</a></td>
<td class="author-text">Jaeger, W., Mullooly, J., Scholl, T., and D. Smith, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-dasmith-mpls-ip-options-01.txt">Requirements for Label Edge Router Forwarding of IPv4 Option Packets</a>,&rdquo; draft-dasmith-mpls-ip-options-01 (work in progress), October&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-dasmith-mpls-ip-options-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.rahman-rtg-router-alert-considerations">[I-D.rahman-rtg-router-alert-considerations]</a></td>
<td class="author-text">Faucheur, F., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-rahman-rtg-router-alert-considerations-03.txt">IP Router Alert Considerations and Usage</a>,&rdquo; draft-rahman-rtg-router-alert-considerations-03 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-rahman-rtg-router-alert-considerations-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2205">[RFC2205]</a></td>
<td class="author-text"><a href="mailto:Braden@ISI.EDU">Braden, B.</a>, <a href="mailto:lixia@cs.ucla.edu">Zhang, L.</a>, <a href="mailto:Berson@ISI.EDU">Berson, S.</a>, <a href="mailto:Herzog@WATSON.IBM.COM">Herzog, S.</a>, and <a href="mailto:jamin@EECS.UMICH.EDU">S. Jamin</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2205">Resource ReSerVation Protocol (RSVP) -- Version 1 Functional Specification</a>,&rdquo; RFC&nbsp;2205, September&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2205.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2205.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2205.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2236">[RFC2236]</a></td>
<td class="author-text"><a href="mailto:fenner@parc.xerox.com">Fenner, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2236">Internet Group Management Protocol, Version 2</a>,&rdquo; RFC&nbsp;2236, November&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2236.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2236.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2236.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2710">[RFC2710]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a>, <a href="mailto:fenner@research.att.com">Fenner, W.</a>, and <a href="mailto:haberman@raleigh.ibm.com">B. Haberman</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2710">Multicast Listener Discovery (MLD) for IPv6</a>,&rdquo; RFC&nbsp;2710, October&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2710.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3175">[RFC3175]</a></td>
<td class="author-text">Baker, F., Iturralde, C., Le Faucheur, F., and B. Davie, &ldquo;<a href="http://tools.ietf.org/html/rfc3175">Aggregation of RSVP for IPv4 and IPv6 Reservations</a>,&rdquo; RFC&nbsp;3175, September&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3175.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3208">[RFC3208]</a></td>
<td class="author-text">Speakman, T., Crowcroft, J., Gemmell, J., Farinacci, D., Lin, S., Leshchiner, D., Luby, M., Montgomery, T., Rizzo, L., Tweedly, A., Bhaskar, N., Edmonstone, R., Sumanasekera, R., and L. Vicisano, &ldquo;<a href="http://tools.ietf.org/html/rfc3208">PGM Reliable Transport Protocol Specification</a>,&rdquo; RFC&nbsp;3208, December&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3208.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3209">[RFC3209]</a></td>
<td class="author-text">Awduche, D., Berger, L., Gan, D., Li, T., Srinivasan, V., and G. Swallow, &ldquo;<a href="http://tools.ietf.org/html/rfc3209">RSVP-TE: Extensions to RSVP for LSP Tunnels</a>,&rdquo; RFC&nbsp;3209, December&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3209.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3376">[RFC3376]</a></td>
<td class="author-text">Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;<a href="http://tools.ietf.org/html/rfc3376">Internet Group Management Protocol, Version 3</a>,&rdquo; RFC&nbsp;3376, October&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3376.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3810">[RFC3810]</a></td>
<td class="author-text">Vida, R. and L. Costa, &ldquo;<a href="http://tools.ietf.org/html/rfc3810">Multicast Listener Discovery Version 2 (MLDv2) for IPv6</a>,&rdquo; RFC&nbsp;3810, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3810.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4081">[RFC4081]</a></td>
<td class="author-text">Tschofenig, H. and D. Kroeselberg, &ldquo;<a href="http://tools.ietf.org/html/rfc4081">Security Threats for Next Steps in Signaling (NSIS)</a>,&rdquo; RFC&nbsp;4081, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4081.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4286">[RFC4286]</a></td>
<td class="author-text">Haberman, B. and J. Martin, &ldquo;<a href="http://tools.ietf.org/html/rfc4286">Multicast Router Discovery</a>,&rdquo; RFC&nbsp;4286, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4286.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4782">[RFC4782]</a></td>
<td class="author-text">Floyd, S., Allman, M., Jain, A., and P. Sarolahti, &ldquo;<a href="http://tools.ietf.org/html/rfc4782">Quick-Start for TCP and IP</a>,&rdquo; RFC&nbsp;4782, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5350">[RFC5350]</a></td>
<td class="author-text">Manner, J. and A. McDonald, &ldquo;<a href="http://tools.ietf.org/html/rfc5350">IANA Considerations for the IPv4 and IPv6 Router Alert Options</a>,&rdquo; RFC&nbsp;5350, September&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5350.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ashok Narayanan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1414 Mass Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Boxborough, MA  01719</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ashokn@cisco.com">ashokn@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Francois Le Faucheur</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Greenside, 400 Avenue de Roumanille</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sophia Antipolis,   06410</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:flefauch@cisco.com">flefauch@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David Ward</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dward@cisco.com">dward@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Reshad Rahman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2000 Innovation Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kanata, Ontario  K2K 3E8</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rrahman@cisco.com">rrahman@cisco.com</a></td></tr>
</table>
</body></html>
