<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Report from the IETF workshop on P2P Infrastructure, May 28, 2008</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Report from the IETF workshop on P2P Infrastructure, May 28, 2008">
<meta name="keywords" content="P2PI">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">J. Peterson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NeuStar</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">A. Cooper</td></tr>
<tr><td class="header">Expires: August 27, 2009</td><td class="header">Center for Democracy & Technology</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 23, 2009</td></tr>
</table></td></tr></table>
<h1><br />Report from the IETF workshop on P2P Infrastructure, May 28, 2008<br />draft-p2pi-cooper-workshop-report-01</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 27, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document reports the outcome of a workshop organized by the Real-time Applications and Infrastructure Area Directors of the IETF to discuss network delay and congestion issues resulting from increased P2P traffic volumes. The workshop was held on May 28, 2008 at MIT in Cambridge, MA, USA. The goals of the workshop were twofold: to understand the technical problems ISPs and end users are experiencing as a result of high volumes of P2P traffic, and to begin to understand how the IETF may be helpful in addressing these problems. Gaining an understanding of where in the IETF this work might be pursued and how to extract out feasible work items were highlighted as important tasks in pursuit of the latter goal. The workshop was very well attended and produced several work items that have since been taken up by members of the IETF community.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<br />
<a href="#anchor2">2.</a>&nbsp;
Scoping of the Problem and Solution Spaces<br />
<br />
<a href="#anchor3">3.</a>&nbsp;
Service Provider Perspective<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
DOCSIS Architecture and Upstream Contention<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
TCP Flow Fairness and Service Flows<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#service-provider-responses">3.3.</a>&nbsp;
Service Provider Responses<br />
<br />
<a href="#anchor6">4.</a>&nbsp;
Application Provider Perspective<br />
<br />
<a href="#potential-solution-areas">5.</a>&nbsp;
Potential Solution Areas<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#improving-peer-selection">5.1.</a>&nbsp;
Improving Peer Selection: Information Sharing, Localization, and Caches<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.1.1.</a>&nbsp;
Leveraging AS Numbers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.1.2.</a>&nbsp;
P4P: Provider Portal for P2P Applications<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.1.3.</a>&nbsp;
Multi-Layer Tracker-Based Architecture<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.1.4.</a>&nbsp;
ISP-Aided Neighbor Selection<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.1.5.</a>&nbsp;
Caches<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.1.6.</a>&nbsp;
Potential IETF Work<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.2.</a>&nbsp;
New Approaches to Congestion Control<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#end-to-end-congestion-control">5.2.1.</a>&nbsp;
End-to-End Congestion Control<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.2.2.</a>&nbsp;
Weighted Congestion Control<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.3.</a>&nbsp;
Quality of Service<br />
<br />
<a href="#applications-opening-multiple-tcp-connections">6.</a>&nbsp;
Applications Opening Multiple TCP Connections<br />
<br />
<a href="#anchor21">7.</a>&nbsp;
Costs and Congestion<br />
<br />
<a href="#anchor22">8.</a>&nbsp;
Next Steps<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">8.1.</a>&nbsp;
Transport Issues<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">8.2.</a>&nbsp;
Improved Peer Selection<br />
<br />
<a href="#anchor25">9.</a>&nbsp;
Security Considerations<br />
<br />
<a href="#anchor26">10.</a>&nbsp;
Acknowledgements<br />
<br />
<a href="#rfc.references1">11.</a>&nbsp;
Informative References<br />
<br />
<a href="#program-committee">Appendix&nbsp;A.</a>&nbsp;
Program Committee<br />
<br />
<a href="#workshop-participants">Appendix&nbsp;B.</a>&nbsp;
Workshop Participants<br />
<br />
<a href="#workshop-agenda">Appendix&nbsp;C.</a>&nbsp;
Workshop Agenda<br />
<br />
<a href="#slides-papers">Appendix&nbsp;D.</a>&nbsp;
Slides and Position Papers<br />
<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Increasingly, large ISPs are encountering issues with P2P traffic. The transfer of static, delay-tolerant data between nodes on the Internet is a well-understood problem, but traditional management of fairness at the transport level is under strain from applications designed to achieve the best end-user transfer rates. At peak times this results in networks running near absolute capacity, causing all traffic to incur delays; the applications that bear the brunt of this additional latency are real-time applications like VoIP and Internet gaming. To explore how IETF standards work could be useful in addressing these issues, the Real-time Applications and Infrastructure Area Directors organized a “P2P Infrastructure” workshop and invited contributions from subject matter experts in the problem and solution spaces.
</p>
<p>The goals of the workshop were twofold: to understand the technical problems ISPs and end users are experiencing as a result of high volumes of P2P traffic, and to begin to understand how the IETF may be helpful in addressing these problems. Gaining an understanding of where in the IETF this work might be pursued and how to extract out feasible work items were highlighted as important tasks in pursuit of the latter goal. The workshop's focus was on engineering solutions that promise some imminent benefit to the Internet as a whole, as opposed to longer-term research or closed properietary solutions. While public policy must inform work in this space, crafting or debating public policy was outside the scope of the workshop.
</p>
<p>Position papers were solicited in the weeks prior to the workshop, and a limited number of speakers were invited to present their views at the workshop based on these submissions. This report is a summary of all participants' contributions. The program committee and participant list are attached in <a class='info' href='#program-committee'>Appendix&nbsp;A<span> (</span><span class='info'>Program Committee</span><span>)</span></a> and <a class='info' href='#workshop-participants'>Appendix&nbsp;B<span> (</span><span class='info'>Workshop Participants</span><span>)</span></a>, respectively. The agenda of the workshop can be found in <a class='info' href='#workshop-agenda'>Appendix&nbsp;C<span> (</span><span class='info'>Workshop Agenda</span><span>)</span></a>.  A link to the presentations given at the workshop and the position papers submitted prior to the workshop is in <a class='info' href='#slides-papers'>Appendix&nbsp;D<span> (</span><span class='info'>Slides and Position Papers</span><span>)</span></a>.
</p>
<p>The workshop showcased the IETF community's recognition of the impact of P2P and other high-volume applications on the Internet as a whole. Participants welcomed the opportunity to discuss potential standardization work that network operators, applications providers, and end users would all find mutually beneficial. Two transport-related work items gained significant traction: designing a protocol for very deferential end-to-end congestion control for delay-tolerant applications, and producing an informational document about the reasoning behind and effects of applications opening multiple transport connections at once. A seperate area of interest that emerged at the workshop focused on improving peer selection by having networks make more information available to applications. Finally, presenters also covered traditional approaches
to multiple service-tier queuing such a diffserv.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Scoping of the Problem and Solution Spaces</h3>

<p>The genesis for the P2PI workshop grew in large part out of specific pain points that ISPs are experiencing as a result of high volumes of P2P traffic. However, several workshop participants felt that the IETF should approach a more general space of problems, of which P2P-related congestion may be merely one instance.
</p>
<p>For example, high-volume applications besides P2P, whether they already exist or have yet to be developed, could cause congestion issues similar to those caused by P2P. And while much attention has been paid to congestion on access links, increased traffic volumes could impact other parts of the network. Although the workshop focused primarily on the specific causes and effects of current P2P traffic volumes, it may be useful in the future for the IETF to consider how to pursue solutions to these larger problems.
</p>
<p>Obtaining more data about Internet congestion may also be a helpful step before the IETF pursues solutions. This data collection could focus on where in the network congestion is occurring, its duration and frequency, its effects, and its root causes. Although individual service providers expressed interest in sharing congestion data, strategies for reliably and regularly obtaining and disseminating such data on a broad scale remain elusive.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Service Provider Perspective</h3>

<p>To help participants gain a fuller understanding of one specific network operator view of P2P-induced congestion, Jason Livingood and Rich Woundy provided an overview of Comcast's network and approach to management of P2P traffic.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
DOCSIS Architecture and Upstream Contention</h3>

<p>In the Data Over Cable Service Interface Specification (DOCSIS) architecture <a class='info' href='#DOCSIS'>[DOCSIS]<span> (</span><span class='info'>CableLabs, &ldquo;DOCSIS Specifications - DOCSIS 2.0 Interface,&rdquo; 2008.</span><span>)</span></a> used for many cable systems, there may be a single Cable Modem Termination System (CMTS) serving hundreds or thousands of residential cable customers. Each CMTS has multiple DOCSIS domains, each of which typically has a single downstream link and a number of upstream links. Each CMTS is connected through a hybrid fiber-coaxial (HFC) network to subscribers' cable modems.
</p>
<p>The limiting resource in this architecture is usually bandwidth, so bandwidth is typically the measure used for capacity planning. As with all networks, congestion manifests itself when instantaneous load exceeds available capacity.
</p>
<p>In the upstream direction, any cable modem connected to a CMTS can make a request to the CMTS to transmit, and requests are randomized to minimize collisions. With many cable modems issuing requests at once, the requests may collide, resulting in delays. DOCSIS does not specify a size for cable modem buffers, but buffer delays of one to four seconds have been observed with various cable modems from different vendors.
</p>
<p>Once the CMTS has granted a cable modem the ability to transmit its data PDU, the modem can piggyback its next request on top of that data PDU. In situations with a lot of upstream traffic, piggybacking happens more often, which sends heavy upstream users to the front of the CMTS queue, ahead of interactive but less-upstream-intensive applications. For example, if the CMTS is granting requests approximately every one to three milliseconds, then a cable modem transmitting data for a service like VoIP with a packetization delay of 20-30 milliseconds may get into contention with another modem on the same CMTS that is constantly transmitting upstream and piggybacking each new request. This may explain how heavy upstream users ultimately dominate the pipe over more interactive applications. Consequentially, it is imperative that assessments of the problem space, and potential solutions, are mindful of the influence that specific layer-2 networks may exert on the behavior of Internet traffic, especially when considering the alleviation of congestion in an access network.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
TCP Flow Fairness and Service Flows</h3>

<p>How TCP flow fairness applies to upstream requests to the CMTS is an open question. A CMTS sees many service flows, each of which could be a single TCP flow or many TCP flows (or UDP). The CMTS is not aware of the source or destination IP address of a packet until it has already been transmitted upstream, so those cannot be used to impose flow fairness.
</p>
<p>A particular cable modem can have multiple service flows defined. For example, a modem that is also a VoIP endpoint can provision a service flow for VoIP that would allow VoIP traffic to avoid the upstream request process to the CMTS (and thereby avoid contention with other modems). The service flow would have upstream capacity provisioned for it. The modem would have a separate service flow for best efforts traffic. Some ISPs provision such a flow for their own VoIP offerings; others allow subscribers to pay extra to have particular traffic assigned to a provisioned service flow.
</p>
<p>It may also be possible for an ISP to provision such a flow on the fly when it recognizes the need for it. DiffServ <a class='info' href='#RFC2475'>[RFC2475]<span> (</span><span class='info'>Carlson, M., Weiss, W., Blake, S., Wang, Z., Black, D., and E. Davies, &ldquo;An Architecture for Differentiated Services,&rdquo; December&nbsp;1998.</span><span>)</span></a> bits set by the customer premises equipment could be used to classify flows, for example.
</p>
<a name="service-provider-responses"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Service Provider Responses</h3>

<p>Starting in 2005, ISP customers were increasingly complaining about the performance of delay-sensitive traffic (VoIP and gaming), due in part to the issues arising out of the DOCSIS architecture as described above. At the same time, ISPs were seeing heavy growth in P2P traffic, and an increasing correlation between high levels of P2P activity and packet loss.
</p>
<p>In responding to this situation, cable ISPs have several avenues to pursue. The newest generation of the DOCSIS specification, DOCSIS 3.0, enables faster transfer rates than most cable systems currently support. While the rollout of DOCSIS 3.0 will provide additional capacity, it will likely not obviate the need for congestion management in an environment where client software is designed to maximize bandwidth consumption regardless of available capacity.
</p>
<p>Congestion management can take many forms; Jason and Rich explained the new protocol-agnostic approach that Comcast is currently trialing. Prior to these trials, all traffic was marked as "best efforts." During the trials, all traffic is re-classified as "priority." When a CMTS is approaching peak congestion on a particular upstream or downstream port (the "Near Congestion State"), some subscribers will have traffic re-classified as "best efforts." The threshold for determining when a CMTS port is in Near Congestion State and the number of minutes it remains in this state are both parameters being explored during the trials. To re-classify upstream traffic, a new default DOCSIS service flow is used that has the same provisioned bandwidth as the "priority" stream, but is treated with lower priority.
</p>
<p>The subscribers whose traffic is re-marked will be selected by determining whether they have temporarily entered a "Long Duration Bulk Consumption State." This state is achieved by consuming a certain amount of bandwidth over a certain period of minutes (both tweakable parameters being explored during the trials). These thresholds will depend on the subscriber's service tier -- subscribers who pay for more bandwidth will have higher thresholds. The re-marking will not distinguish between multiple users of the same subscriber connection, so one family member's P2P usage could cause another family member's Web browsing traffic to be lowered in priority. There is no current mechanism for users to determine that their traffic has been re-marked.
</p>
<p>By temporarily reducing the traffic priority of subscribers who have been consuming bandwidth in bulk for lengthy periods, this congestion management technique aims to preserve a good user experience for subscribers with burstier traffic patterns, including those using real-time applications. As compared to an approach that reduces particular subscribers' bandwidth during periods of congestion, this technique eliminates the ability for applications to set their own priority levels, but it also avoids the negative connotations that some users may associate with bandwidth reductions.
</p>
<p>This approach involves many tweakable parameters. A large part of the trial process is aimed at determining the best settings for these parameters, but there may also be opportunities to work with the research community to identify the best way to adjust the thresholds necessary to optimize the performance of the management technique.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Application Provider Perspective</h3>

<p>Stanislav Shalunov provided an overview of BitTorrent's view of the impact of increased P2P traffic volumes and potential mitigations. The impact is described here; his proposed solutions (comprising the bulk of his talk) are addressed in the appropriate subsections of <a class='info' href='#potential-solution-areas'>Section&nbsp;5<span> (</span><span class='info'>Potential Solution Areas</span><span>)</span></a>.
</p>
<p>As uptake in P2P usage has grown, so has end-user latency. For example, a user whose uplink capacity is 250-500 Kbps and whose modem buffer has a capacity of 32-64 Kbps may easily fill the buffer (unless the modem uses AQM, which is uncommon). This can result in delay on the order of seconds, with disastrous effects on application performance. On a cable system with shared capacity between neighbors, one neighbor could saturate the buffer and affect the latency of another neighbor's traffic.
</p>
<a name="potential-solution-areas"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Potential Solution Areas</h3>

<p>The submissions received in advance of the workshop covered a broad array of work addressing specific aspects of P2P traffic volume and other related issues. Solution suggestions generally fell into one or more of three topic areas: improving peer selection, new approaches to congestion control, and quality of service mechanisms. The workshop discussions and outcomes in each area are described below.
</p>
<a name="improving-peer-selection"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Improving Peer Selection: Information Sharing, Localization, and Caches</h3>

<p>Peer selection is an integral factor in determining the efficiency of P2P networks from both the ISP and the P2P client point of view. How peers are selected will determine both network load and client performance.
</p>
<p>The way that P2P clients select peers today varies from protocol to protocol and client to client, but as a general matter peers are largely oblivious to routing-level and network topology information. This results in P2P topologies that are agnostic of underlay topologies and constraints.
</p>
<p>Approaches to closing this gap generally involve an entity that has knowledge of network topology, costs, or constraints (e.g., an ISP) making some of this information available to P2P clients or trackers. This information may be used to localize traffic based on some metric of locality, or otherwise alter peer selection decisions based on the provided network information (hereafter referred to simply as "localization"). One special case of this kind of approach would help peers find caches containing the content they seek.
</p>
<p>Any alteration to current peer selection algorithms will have engineering trade-offs. BitTorrent, for example, used randomized peer selection by design. Choosing peers randomly out of a large selection helps to average out problems among peers, and it allows for connections to good peers that may be far away. Randomized peer selection also supports "rarest first" piece selection, which allows swarms to continue even when the original seed disappears and distributes pieces so that more peers are likely to have pieces of interest to other peers. Any move away from randomized selection would have to take these factors into account.
</p>
<p>Although localization has the potential to improve peer selection, the incentives for both parties to the information exchange are complex. ISPs may want to move traffic off of their own networks, which could motivate them to provide information to peers that has the opposite effect of what the peers would expect. Likewise, peers will want the use of the information they receive to result in performance improvements; otherwise, they have no incentive to consult with the network before selecting peers. Even when both parties find the information sharing to be beneficial, user experiences will not necessarily be uniform depending on the scope of the information provided and the peer's location. Localization information could form one component of a peer selection decision, but it will likely need to be balanced against other factors.
</p>
<p>Workshop participants discussed both current research efforts in this area and how IETF standards work may be useful in furthering the general concept of improved peer selection. Those discussions are summarized below.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Leveraging AS Numbers</h3>

<p>One simple way to potentially make peer selection more efficient would be for a peer to prefer peers within its own AS. Transfers between peers within the same AS may be faster on some networks, although more data is needed to determine the extent of the potential improvement. On mobile networks, for example, the utility of AS numbers is limited since they do not correlate to geographic location. Peers may also see improvements by connecting to other peers within a specific set of ASes or IP prefixes provided by their ISPs. Some ISPs may have an incentive to expose this granularity of information because it will potentially reduce their transit costs.
</p>
<p>A case study was conducted with the four most popular BitTorrent torrents to determine what the effect of localizing to an AS might be. The swarm sizes for the torrents were 9984, 3944, 2561, and 2023, with the size distributions appearing to be polynomial. With more than 20 peers in a single AS, peers within an AS could trade only with each other, avoiding interdomain traffic. More than half (57%) of peers in the four swarms were in ASes like this. Thus, in these cases connecting to peers within an AS could reduce transit traffic by at least 57%.  If the ASes have asymmetric upload and download links, however, the resulting user experience may deteriorate since each peer's download speed would be limited by slower upload speeds.
</p>
<p>With the largest swarm size at 9984, the probability of two peers being in the same neighborhood is too low to make localization to the neighborhood level worthwhile. Attempting a simple localization scheme, such as the AS localization described above, and determining its effectiveness likely makes more sense as a first step.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
P4P: Provider Portal for P2P Applications</h3>

<p>The P4P project <a class='info' href='#P4P'>[P4P]<span> (</span><span class='info'>Xie, H., Yang, Y., Krishnamurthy, A., and A. Silberschatz, &ldquo;P4P: Provider Portal for Applications,&rdquo; August&nbsp;2008.</span><span>)</span></a> aims to design a framework to enable cooperation between "providers" and applications (including P2P), where providers may be ISPs, content distribution networks, or caching services. In this architecture, each provider can communicate information to P2P clients through a portal known as an iTracker. An iTracker could be identified through a DNS SRV record (perhaps with its own new record type), a whois look-up, or through a trusted third party.
</p>
<p>An iTracker has different interfaces for different types of information that the provider may want to share. The core interface allows the provider to express the "virtual cost" of its intradomain or interdomain links. Virtual cost may reflect any kind of provider preferences, and may be based on the provider's choice of metrics, including utilization, transit costs, or geography. It is up to the provider to decide how dynamic it wants to be in updating its virtual cost determinations.
</p>
<p>In tests of this framework, two parallel swarms were created with approximately the same number of clients and similar geographical and network distributions, both sharing the same file. One of the swarms used the P4P framework, with the ISP's network topology map as input to its iTracker, and the other swarm used traditional peer selection. The swarm without P4P saw 98% of traffic to and from peers external to the ISP, whereas with P4P that number was 50%. Download completion times for the P4P-enabled swarm improved approximately 20% on average.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Multi-Layer Tracker-Based Architecture</h3>

<p>The multi-layer tracker-based P2P scheme described at the workshop is a generic example of an architecture that demonstrates how localization may be useful in principle.
</p>
<p>In a traditional tracker-based P2P system, trackers provide clients with information about seeds and peers where clients can find the content they seek. A multi-layered tracker architecture incorporates additional "local" trackers that provide the same information, but only for content located within their own local network scope. Client queries are re-directed from the global tracker to the appropriate local trackers. Local trackers may also exist on multiple levels, in which case queries would be further re-directed. This sort of architecture could also serve hybrid P2P/content delivery networks, where the global tracker functions as both a tracker and a content server, and local trackers track locally provisioned caches in addition to seeds and peers.
</p>
<p>One challenge in this architecture is determining what "local" means for trackers, seeds and peers. Locality could be dependent on traffic conditions, load balancing, static topology, policy or some other metric. These same considerations would also be crucial for determining appropriate cache placement in a hybrid network.
</p>
<p>This architecture presents in the abstract the problem of re-directing from a global entity to a local entity. Client queries need to find their way to the appropriate local tracker. This can be accomplished through an off-path, explicit mechanism where local trackers register with the global tracker in advance, or through an on-path approach where the network proxies P2P requests. The off-path tracker format approach is preferable for performance and reliability reasons.
</p>
<p>Inasmuch as the multi-layer scheme might require ISPs to aid peers in finding the optimal paths to unauthorized copies of copyrighted content, ISPs may be concerned about the legal liability of participating.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.4"></a><h3>5.1.4.&nbsp;
ISP-Aided Neighbor Selection</h3>

<p>ISPs have a lot of knowledge about their networks: everything from the bandwidth, geography, and service class of particular nodes to overarching routing policies, OSPF and BGP metrics, and distances to peering points. The ISP-aided neighbor selection service described below seeks to leverage this knowledge without requiring ISPs to reveal any information that could not already be discerned through reverse-engineering by client applications.
</p>
<p>The service consists of an "oracle" hosted by an ISP. The oracle receives a list of IP addresses from a network node, sorts the list according to its own confidential criteria, and returns the sorted list to the node. The peer ranking provided by the oracle could be viewed as a special case of the virtual cost interface described in the previous section.
</p>
<p>This service could be used by P2P clients or trackers, or any other application that would benefit from learning its ISP's connection preferences. The oracle could be run as a web server or UDP service at a known location (perhaps similar to BIND).
</p>
<p>For interdomain ranking, an ISP could rank its own peers first, or it could base its ranking on the AS number of the IPs in the provided list. Another option would be for multiple ISPs to work together to have their oracles exchange lists with each other.
</p>
<p>The main challenge in implementing the oracle service is scalability. If
peers need to communicate to the oracle the IP address of every peer they know, the size of oracle requests may be inordinately large. Additionally, today's largest swarms approach 10000 peers, and with every peer requesting a sorted list, oracle request volume will swell. With the growth of business models dependent upon P2P for distribution of content, swarms in the future may be far larger, further exacerbating the problem. Potential mitigations include having trackers instead of peers issue oracle requests, and using other peers' sorted lists as input rather than always using an unsorted list.
</p>
<p>On the other hand, this approach is advantageous from a legal liability perspective, because it does not require ISPs to have any knowledge of where particular content might be located, or any role in directing peers to particular content.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.5"></a><h3>5.1.5.&nbsp;
Caches</h3>

<p>Deploying caches as peers in P2P networks was suggested as a component of multiple different proposals put forth at the workshop. Caches may help to ease network load by reducing the need for peers to upload to each other and by localizing traffic.
</p>
<p>The two main concerns about P2P caches relate to network capacity and legal liability. For caches to be useful, they will likely need to be large (one suggestion was that a 1 TB cache could service 30% of requests within a single AS, and a 100 TB cache could service 80% of requests). Large caches will require sizable bandwidth in order to avoid contention among peers. Caches would not be usefully placed within an HFC network on a cable system, for example.
</p>
<p>The legal liability attached to hosting a P2P cache likely reduces the incentives to do so. Even under legal regimes where liability for caching may be unclear, ISPs and others may view hosting a cache as too great of a legal risk to be worthwhile.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.6"></a><h3>5.1.6.&nbsp;
Potential IETF Work</h3>

<p>Much of the localization work discussed at the workshop is still in its initial stages, and many questions remain about the value that localization provides for varying network and overlay architectures. More data is needed to evaluate the effects on both traffic load and client performance. Understanding swarm distributions is  important; swarms with long tails may not particularly benefit from localization.
</p>
<p>Against this backdrop, the key task for the IETF as identified at the workshop is to pinpoint incrementally beneficial work items in the the spaces discussed above. In the future it may be possible to standardize entire P2P mechanisms, but as a starting point it makes more sense to single out core manageable components for standardization. The focus should be on items that are not so specific to one ISP or P2P network that standardization is rendered useless. Ideally, any mechanisms resulting from this work might apply to future applications that exhibit the same bandwidth-intensive properties as today's P2P file-sharing.
</p>
<p>In considering any of these items, it will be necessary to ensure that the information exchanged by networks and applications does not harm any of the parties involved. Not every piece of information exchanged with be beneficial or verifiable, and this fact must be recognized and accounted for. Solutions that leave applications or networks worse off than they already are today will not gain any traction.
</p>
<p>It should also not be assumed that a particular party will be best suited to provide a particular kind of information. For example, an ISP may not know what the connection costs are in other ISPs' networks, whereas an overlay network that receives cost information from several ISPs may have a better handle on this kind of data. Standardization of information sharing should not assume the identity of particular parties doing the sharing.
</p>
<p>The list of potential work items discussed at the workshop is provided below. Workshop participants showed particular interest in pursuing the first three items further.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.6.1"></a><h3>5.1.6.1.&nbsp;
AS Numbers</h3>

<p>P2P clients are currently reliant on IP-to-AS mapping tables when they want to determine AS numbers. Providing a standard, easier way for clients to obtain this information may help to make peer selection more efficient on certain networks.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.6.2"></a><h3>5.1.6.2.&nbsp;
Querying for Preferred Peers</h3>

<p>In situations where a peer or tracker can make requests in real time to a service that expresses its ISP's peering preferences, standardizing a format for requests and responses may be useful. The focus would be on the communication of the information, not on the criteria used to decide preferences. The information provided to peers would have to be crafted to ensure that it protects the privacy of other peers and safeguards proprietary network information.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.6.3"></a><h3>5.1.6.3.&nbsp;
Local Tracker, iTracker, Oracle, or Cache Discovery</h3>

<p>With the deployment of trackers, iTrackers, oracles or other mechanisms that provide some information specific to a node's locality, nodes will need a way to find these resources. One task for the IETF could be to explore a way to do discovery, potentially by leveraging an existing discovery protocol (DNS, DHCP, anycast, etc.). Depending on the resource to be discovered, discovery may require only a simple look-up, or it may require a more complex determination of which resource is "closest" to the node issuing the request.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.6.4"></a><h3>5.1.6.4.&nbsp;
ISP Account Usage Information</h3>

<p>Where ISP subscribers are bound by network usage policies or volume-based quotas, it may be useful to have a standard way of communicating the subscriber's current usage status. This would be similar to information about how many minutes of cell phone airtime are left in a subscriber's billing cycle. Applications could use this information to make decisions about when and how to transfer data. One challenge in implementing such a standard would be support for potentially limitless different ISP business models. The level of granularity that an ISP is able to provide may also be constrained depending on the pricing model and how dynamic the information is expected to be.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.6.5"></a><h3>5.1.6.5.&nbsp;
Tracker Formats</h3>

<p>A multi-layered tracker approach could potentially be aided by a standard tracker format for re-directing from a global tracker to a local tracker. While the extent to which existing trackers will be willing to consult with other trackers is unclear, the re-direction format may have an analog in another context -- many HTTP servers build their own indexes of mirror information for a similar purpose, though these are not standardized. If the two problem spaces prove to be similar enough, there may be room to standardize a format across both.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
New Approaches to Congestion Control</h3>

<p>One recent informal survey presented at the workshop found that ISPs perceive traffic volumes from heavy users to be a problem, but no single congestion management tool has been put to wide use. Within developer and research communities, congestion issues raised by increased P2P traffic volumes have spurred new thinking about congestion control mechanisms at both the transport layer and the application layer. The subsections below explore some of these new ideas and highlight areas where IETF work may be appropriate.
</p>
<a name="end-to-end-congestion-control"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
End-to-End Congestion Control</h3>

<p>As noted previously, uptake in P2P usage can result in perceptible end-user latency on the order of seconds for interactive applications. One approach to resolving this "RTT in seconds" problem would be for P2P clients to implement better congestion control that keeps the bottleneck full while yielding to keep the delay of competing traffic low. Such an algorithm has been implemented in BitTorrent's client by continuously sampling one-way delay (separating propagation from queuing delay) and targeting a small queuing delay value. This essentially approximates a scavenger service class in an end-to-end congestion control mechanism by by forcing bulk, elastic traffic to yield to competitors under congestion.
</p>
<p>In a similar vein, the P4P framework supports a component that allows applications to mark traffic as "bulk data" (not time sensitive). Applications adjust their behavior according to the feedback they receive from such markings.
</p>
<p>Experimenting with the standardization of these kinds of techniques or any congestion control framework with design goals that differ from those of TCP may be helpful work for the IETF to pursue.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Weighted Congestion Control</h3>

<p>Congestion control has typically been implemented at a protocol level, as a optional, cooperative effort between endpoints experiencing congestion, but in looking for a long-term approach to congestion control, we may need a more rigorous way for available bandwidth to be allocated by and between the hosts using a network. The idea behind weighted congestion control is to allow hosts to give more weight to interactive applications during times of congestion.
</p>
<p>Comparing such an approach with DiffServ showcases its strengths and weaknesses. Unlike DiffServ, weighted congestion control could be implemented on hosts with a simple extension to socket APIs (although consensus among OSes would be necessary for portability). Control resides with the host, whereas even when DiffServ APIs are available, it is difficult for a host to know that the network is complying with its classifications. With weighted congestion control, hosts need some disincentive to setting their weights at maximum levels, whereas DiffServ was not designed for individual users to employ. Both approaches must rely on traffic senders to set policies, meaning that the congestion issues stemming from P2P use on the receiver side are not aided by either mechanism. With DiffServ, a light user may waste his or her priority connecting to a heavy user on another network, which is not a problem with host-controlled weighting.
</p>
<p>Weighted congestion control is just one example of a generalized set of features that characterize useful approaches to congestion control. These characteristics include full user control of priorities within a user's own scope, and no possibility of interpreting ISP behavior as discriminatory. The former means that ISPs should not override user decisions arbitrarily (though this does not preclude an ISP from offering prioritization as an option). The latter means that the metric for decision-making needs to obviate suspicion of ISP motivations.
</p>
<p>One metric that meets these criteria is a harm (cost) metric, where cost is equal to the amount of data that was not served to its destination. Using this metric, cost is greatest when traffic peaks are greatest. It allows for a policy of not sending too much data during times of congestion, without specifying exactly how much is too much. The cost metric could be used either for a DiffServ approach or for weighted congestion control.
</p>
<p>One important limitation on ISPs from a congestion control perspective is that they do not have a window into congestion on other ISPs' networks. Solving this problem requires a separate mechanism to express congestion across domains.
</p>
<p>One potential avenue for the IETF or IRTF to pursue would be to establish a long-term design team to assess congestion problems in general and the long-term effects of any proposed quick fixes. These issues are not necessarily confined to P2P and should be viewed in the broader context of massive increases in bandwidth use.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Quality of Service</h3>

<p>Although ISPs have implemented a wide variety of short-term approaches to dealing with congestion, several of these may not be viable in the long term. For example, some ISPs have found that using deep packet inspection to change the delivery characteristics of certain traffic at times of congestion is more cost effective than adding additional bandwidth. Over time, this approach could lead to a cat-and-mouse game where applications providers continually adapt to avoid being correctly classified by DPI equipment. Similarly, ISPs implementing traffic analysis to identify P2P traffic may find that in the long run the overhead required of an effective classification scheme will be excessive.
</p>
<p>Quality of service (QoS) arrangements may be more suitable in the long term. One approach that distinguishes certain classes of traffic during times of congestion was described in <a class='info' href='#service-provider-responses'>Section&nbsp;3.3<span> (</span><span class='info'>Service Provider Responses</span><span>)</span></a>. A standardized mechanism that may be useful for implementing QoS is DiffServ Code Points (DSCP) <a class='info' href='#RFC2474'>[RFC2474]<span> (</span><span class='info'>Nichols, K., Blake, S., Baker, F., and D. Black, &ldquo;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers,&rdquo; December&nbsp;1998.</span><span>)</span></a>.
</p>
<p>With DSCP, devices at the edge of the network mark packets with the service level they should receive. Nodes within the network do not need to remember anything about service flows, and applications do not need to request a particular service level. Users effectively avoid self-interference through service classification.
</p>
<p>Although DSCP may have many uses, perhaps the most relevant to the P2P congestion issue is its ability to facilitate usage-based charging. User pricing agreements that charge a premium for real-time traffic and best effort traffic could potentially shape user behavior, resulting in reduced congestion (although ISPs would need a mechanism to mitigate the risk of charging subscribers for things like unintentional malware downloads or DoS attacks). DSCP could also be used to limit a user's supply of high-priority bandwidth, resulting in a similar effect.
</p>
<p>Equipment to support DSCP is already available. Although there has been some concern about a perceived lack of DSCP deployment, it is widely used by enterprise customers, and growth has been strong due to uptake in VoIP at the enterprise level.
</p>
<p>However, DSCP still faces deployment hurdles on many networks. Perhaps the largest barrier of all to wide deployment is the lack of uniform code points to be used across networks. For example, the latest Windows Vista API marks voice traffic as CS7, above the priority reserve for router traffic. To properly take advantage of this change, every switch will need to re-mark all traffic. In addition, disparate ISPs are currently without a means of verifying each others' markings, and thus may be unwilling to trust the markings they receive.
</p>
<a name="applications-opening-multiple-tcp-connections"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Applications Opening Multiple TCP Connections</h3>

<p>The workshop discussions about P2P congestion spurred a related discussion about applications (P2P or otherwise) that open multiple TCP connections. With multiple users sharing one link, TCP flow fairness gives users with multiple open connections a larger proportion of bandwidth. Since some P2P protocols use multiple open connections for a single file transfer, and users often pursue multiple transfers at once, this can cause a P2P user to have many more open connections at once than other users on the same link. The same is true for users of other applications that open multiple connections. A single user with multiple open connections is not necessarily a problem on its face, but the fact that fairness is determined per flow rather than per user leaves that impression. Workshop participants thought it may be useful for the IETF to provide some information about such situations.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Costs and Congestion</h3>

<p>Workshop participants expressed diverging opinions about how much the cost of transferring data -- as experienced by ISPs, and by extension, by their subscribers -- should factor into IETF thinking on P2P traffic issues.
</p>
<p>On one hand, bandwidth costs may be significant, even when viewed in isolation from congestion issues. Some estimates put the total cost of shipping 1 GB between $0.10 and $2. The cost of transit bandwidth in markets where subscribers are charged flat rates appears to have leveled off and may no longer be getting cheaper. Thus, it may be reasonable to expect more service providers to move to volume-based pricing (where they have not already done so) as a means to control congestion and increase revenues. This is only feasible if bandwidth consumption is visible to end users, which argues for some mechanism of exposing quotas and usage to applications. However, expressing cost information may be outside of the technical purview of the IETF.
</p>
<p>On the other hand, congestion can be viewed merely as a manifestation of cost. An ISP that invests in capacity could be considered to be paying to relieve congestion. Or, if subscribers are charged for congesting the network, then cost and congestion could be viewed as one and the same. The distinction between them may thus be artificial.
</p>
<p>Workshop participants felt that the issues highlighted here may be useful fodder for IRTF work.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Next Steps</h3>

<p>The IETF community recognizes the significance of both growing P2P traffic volumes and increased network load at large. The importance of addressing the impact of high-volume, delay-tolerant data transfer on end user experiences was highly apparent at the workshop.
</p>
<p>At the conclusion of the workshop and in the days following, it became clear that the largest areas of interest fell into two categories: transport-related issues and improved peer selection.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Transport Issues</h3>

<p>Two main transport-related work items evolved out of the workshop. The first was the creation of a standardized delay-based end-to-end congestion control mechanism that applications such as P2P clients could use to reduce their own impact on interactive applications in use on shared links (as described in <a class='info' href='#end-to-end-congestion-control'>Section&nbsp;5.2.1<span> (</span><span class='info'>End-to-End Congestion Control</span><span>)</span></a>). The second was an informational document that describes the current practice of P2P applications opening multiple transport connections and makes recommendations about the best practices for doing so (as discussed in <a class='info' href='#applications-opening-multiple-tcp-connections'>Section&nbsp;6<span> (</span><span class='info'>Applications Opening Multiple TCP Connections</span><span>)</span></a>).
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Improved Peer Selection</h3>

<p>Participants expressed strong interest in further pursuing the range of concepts described in <a class='info' href='#improving-peer-selection'>Section&nbsp;5.1<span> (</span><span class='info'>Improving Peer Selection: Information Sharing, Localization, and Caches</span><span>)</span></a> that support mechanisms for information sharing between networks and applications to help improve peer selection. Adding to the appeal of this topic is its potential utility for applications other than P2P that may also benefit from information about the network. Because the scope of potential solutions discussed at the workshop was broad, extracting out the most feasible pieces to pursue is the necessary first step.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>The workshop discussions covered a range of potential engineering activities, each with its own security considerations. For example, if networks are to provide preference or topology information to applications, the applications may desire some means of verifying the authenticity of the information. As the IETF community begins to pursue specific avenues arising out of this workshop, addressing relevant security requirements will be crucial.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>The IETF would like to thank MIT, which hosted the workshop, and all those people at MIT and elsewhere who assisted with the organization and logistics of the workshop.
</p>
<p>The IETF is grateful to the program committee (listed in <a class='info' href='#program-committee'>Appendix&nbsp;A<span> (</span><span class='info'>Program Committee</span><span>)</span></a>) for their time and energy in organizing the workshop, reviewing the position papers, and crafting an event of value for all participants. The IETF would also like to thank the scribes, Spencer Dawkins and Alissa Cooper, who diligently recorded the proceedings during the workshop.
</p>
<p>A special thanks to all the participants in the workshop (listed in <a class='info' href='#workshop-participants'>Appendix&nbsp;B<span> (</span><span class='info'>Workshop Participants</span><span>)</span></a>), who took the time, came to the workshop to participate in the discussions, and who put in the effort to make this workshop a success.  The IETF especially appreciates the effort of those that prepared and made presentations at the workshop.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DOCSIS">[DOCSIS]</a></td>
<td class="author-text">CableLabs, &ldquo;<a href="http://www.cablemodem.com/specifications/specifications20.html">DOCSIS Specifications - DOCSIS 2.0 Interface</a>,&rdquo; 2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="P4P">[P4P]</a></td>
<td class="author-text">Xie, H., Yang, Y., Krishnamurthy, A., and A. Silberschatz, &ldquo;<a href="http://uwnews.org/relatedcontent/2008/August/rc_parentID43281_thisID43282.pdf">P4P: Provider Portal for Applications</a>,&rdquo; August&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2475">[RFC2475]</a></td>
<td class="author-text">Carlson, M., Weiss, W., Blake, S., Wang, Z., Black, D., and E. Davies, &ldquo;<a href="http://tools.ietf.org/html/rfc2475">An Architecture for Differentiated Services</a>,&rdquo; RFC&nbsp;2475, December&nbsp;1998.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2474">[RFC2474]</a></td>
<td class="author-text">Nichols, K., Blake, S., Baker, F., and D. Black, &ldquo;<a href="http://tools.ietf.org/html/rfc2475">Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers</a>,&rdquo; RFC&nbsp;2475, December&nbsp;1998.</td></tr>
</table>

<a name="program-committee"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Program Committee</h3>

<p>
				</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>Dave Clark, MIT
</dd>
<dt></dt>
<dd>Lars Eggert, TSV AD
</dd>
<dt></dt>
<dd>Cullen Jennings, RAI AD
</dd>
<dt></dt>
<dd>John Morris, Center for Democracy and Technology
</dd>
<dt></dt>
<dd>Jon Peterson, RAI AD
</dd>
<dt></dt>
<dd>Danny Weitzner, MIT
</dd>
</dl></blockquote><p>
			
</p>
<a name="workshop-participants"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Workshop Participants</h3>

<p>
			</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>Vinay Aggarwal, Deutsche Telekom Labs, TU Berlin
</dd>
<dt></dt>
<dd>Marvin Ammori, Free Press
</dd>
<dt></dt>
<dd>Loa Andersson, Acreo AB
</dd>
<dt></dt>
<dd>Jari Arkko, Ericsson
</dd>
<dt></dt>
<dd>Alan Arolovitch, PeerApp
</dd>
<dt></dt>
<dd>Timothy Balcer
</dd>
<dt></dt>
<dd>Mary Barnes,	Nortel
</dd>
<dt></dt>
<dd>Colby Barth, Cisco Systems
</dd>
<dt></dt>
<dd>John Barlett, NetForecast
</dd>
<dt></dt>
<dd>Salman Baset, Columbia University
</dd>
<dt></dt>
<dd>Chris Bastian, Comcast
</dd>
<dt></dt>
<dd>Matthew Bell, Charter Communications
</dd>
<dt></dt>
<dd>Donald Bowman, Sandvine Inc.
</dd>
<dt></dt>
<dd>Scott Bradner, Harvard University
</dd>
<dt></dt>
<dd>Bob Briscoe, British Telecom
</dd>
<dt></dt>
<dd>David Bryan, SIPeerior Technologies
</dd>
<dt></dt>
<dd>Rex Bullinger, National Cable & Telecommunications Association
</dd>
<dt></dt>
<dd>Gonzalo Camarillo, Ericsson
</dd>
<dt></dt>
<dd>Mary-Luc Champel, Thomson
</dd>
<dt></dt>
<dd>William Check, NCTA
</dd>
<dt></dt>
<dd>Alissa Cooper, Center for Democracy and Technology
</dd>
<dt></dt>
<dd>Patrick Crowley, Washington University
</dd>
<dt></dt>
<dd>Leslie Daigle, Internet Society
</dd>
<dt></dt>
<dd>Spencer Dawkins
</dd>
<dt></dt>
<dd>John Dickinson, Bright House Networks
</dd>
<dt></dt>
<dd>Lisa Dusseault, CommerceNet
</dd>
<dt></dt>
<dd>Lars Eggert,	Nokia Research Center
</dd>
<dt></dt>
<dd>Joe Godas, Cablevision
</dd>
<dt></dt>
<dd>Vernon Groves, Microsoft
</dd>
<dt></dt>
<dd>Daniel Grunberg, Immedia Semiconductor
</dd>
<dt></dt>
<dd>Carmen Guerrero, University Carlos III Madrid
</dd>
<dt></dt>
<dd>Vijay Gurbani, Bell Laboratories/Alcatel-Lucent
</dd>
<dt></dt>
<dd>William Hawkins III, ITT
</dd>
<dt></dt>
<dd>Volker Hilt, Bell Labs, Alcatel-Lucent
</dd>
<dt></dt>
<dd>Russell Housley, Vigil Security, LLC
</dd>
<dt></dt>
<dd>Robert Jackson, Camiant
</dd>
<dt></dt>
<dd>Cullen Jennings, Cisco Systems
</dd>
<dt></dt>
<dd>Paul Jessop,	RIAA
</dd>
<dt></dt>
<dd>XingFeng Jiang, Huawei
</dd>
<dt></dt>
<dd>Michael Kelsen, Time Warner Cable
</dd>
<dt></dt>
<dd>Tom Klieber,	Comcast
</dd>
<dt></dt>
<dd>Eric Klinker, BitTorrent Inc.
</dd>
<dt></dt>
<dd>Umesh Krishnaswamy
</dd>
<dt></dt>
<dd>Gregory Lebovitz, Juniper
</dd>
<dt></dt>
<dd>Erran Li, Bell-Labs
</dd>
<dt></dt>
<dd>Jason Livingood, Comcast
</dd>
<dt></dt>
<dd>Andrew Malis, Verizon
</dd>
<dt></dt>
<dd>Enrico Marocco, Telecom Italia Lab
</dd>
<dt></dt>
<dd>Marcin Matuszewski, Nokia
</dd>
<dt></dt>
<dd>Danny McPherson, Arbor Networks, Inc.
</dd>
<dt></dt>
<dd>Michael Merritt, AT&T
</dd>
<dt></dt>
<dd>Lyle Moore, Bell Canada
</dd>
<dt></dt>
<dd>John Morris, Center for Democracy and Technology
</dd>
<dt></dt>
<dd>Jean-Francois Mule, Cablelabs
</dd>
<dt></dt>
<dd>David Oran, Cisco Systems
</dd>
<dt></dt>
<dd>Reinaldo Penno, Juniper Networks
</dd>
<dt></dt>
<dd>Jon Peterson, NeuStar
</dd>
<dt></dt>
<dd>Howard Pfeffer, Time Warner Cable
</dd>
<dt></dt>
<dd>Laird Popkin, Pando Networks
</dd>
<dt></dt>
<dd>Stefano Previdi, Cisco systems
</dd>
<dt></dt>
<dd>Satish Putta
</dd>
<dt></dt>
<dd>Eric Pescorla
</dd>
<dt></dt>
<dd>Benny Rodrig, Avaya
</dd>
<dt></dt>
<dd>Damien Saucez, UCLouvain (UCL)
</dd>
<dt></dt>
<dd>Henning Schulzrinne, Columbia University
</dd>
<dt></dt>
<dd>Michael Sheehan, Juniper Networks
</dd>
<dt></dt>
<dd>Don Shulzrinne, Immedia Semiconductor
</dd>
<dt></dt>
<dd>David Sohn, Center for Democracy and Technology
</dd>
<dt></dt>
<dd>Martin Stiemerling, NEC
</dd>
<dt></dt>
<dd>Clint Summers, Cox Communications
</dd>
<dt></dt>
<dd>Robert Topolski
</dd>
<dt></dt>
<dd>Mark Townsley, Cisco Systems
</dd>
<dt></dt>
<dd>Yushun Wang, Microsoft
</dd>
<dt></dt>
<dd>Hao Wang, Yale University
</dd>
<dt></dt>
<dd>Ye Wang, Yale University
</dd>
<dt></dt>
<dd>David Ward, Cisco
</dd>
<dt></dt>
<dd>Nicholas Weaver, ICSI
</dd>
<dt></dt>
<dd>Daniel Weitzner, MIT
</dd>
<dt></dt>
<dd>Magnus Westerlund, Ericsson
</dd>
<dt></dt>
<dd>Thomas Woo, Bell Labs
</dd>
<dt></dt>
<dd>Steve Worona, EDUCAUSE
</dd>
<dt></dt>
<dd>Richard Woundy, Comcast
</dd>
<dt></dt>
<dd>Haiyong Xie
</dd>
<dt></dt>
<dd>Richard Yang, Yale University
</dd>
</dl></blockquote><p>	
			
</p>
<a name="workshop-agenda"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Workshop Agenda</h3>

<p>
			</p>
<ol class="text">
<li>Welcome/Note Well/Intro Slides
</li>
<li>Service Provider Perspective (Comcast)
</li>
<li>Application Designer Perspective (BitTorrent)
</li>
<li>Lightning Talks & General Discussion
</li>
<li>Localization and Caches
</li>
<li>New Approaches to Congestion
</li>
<li>Quality of Service
</li>
<li>Conclusions & Wrap-Up
</li>
</ol><p>
			
</p>
<a name="slides-papers"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Slides and Position Papers</h3>

<p>Slides and position papers are available at: 
				<a href='http://trac.tools.ietf.org/area/rai/trac/wiki/PeerToPeerInfrastructure'>http://trac.tools.ietf.org/area/rai/trac/wiki/PeerToPeerInfrastructure</a>
			
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jon Peterson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NeuStar</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jon.peterson@neustar.biz">jon.peterson@neustar.biz</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alissa Cooper</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Center for Democracy & Technology</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1634 Eye St. NW, Suite 1100</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Washington, DC  20006</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:acooper@cdt.org">acooper@cdt.org</a></td></tr>
</table>
</body></html>
