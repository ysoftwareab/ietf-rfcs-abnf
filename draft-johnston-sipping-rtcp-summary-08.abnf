VoiceQualityReportEvent  =  AlertReport / SessionReport / IntervalReport


SessionReport = "VQSessionReport" CLRF
                       LocalMetrics [CLRF RemoteMetrics]
                       [DialogID]

IntervalReport = "VQIntervalReport" CLRF
                       LocalMetrics [CLRF RemoteMetrics]
                       [DialogID]

LocalMetrics  = "LocalMetrics" COLON Metrics
RemoteMetrics = "RemoteMetrics" COLON Metrics

AlertReport   = "VQAlertReport" COLON
                            MetricType WSP Severity WSP Direction CLRF
                              "Metrics:" CLRF
                               Metrics
                               [CLRF "OtherDir Metrics:" CLRF Metrics]


Metrics = TimeStamps CLRF
               SessionDescription CLRF
               CallID CLRF
               LocalAddr CRLF
               RemoteAddr CRLF
               [JitterBuffer CRLF]
               [PacketLoss CRLF]
               [BurstGapLoss CLRF]
               [Delay CLRF]
               [Signal CLRF]
               [QualityScores CLRF]
               *[Extension CLRF]

TimeStamps = "Timestamps" COLON StartTime WSP StopTime
StartTime  = "START" EQUAL word
StopTime   = "STOP" EQUAL word


SessionDescription  = "SessionDesc" COLON
                             [PayloadType WSP]
                             [PayloadDesc WSP]
                             [SampleRate WSP]
                             [FrameDuration WSP]
                             [FrameOctets WSP]
                             [FramesPerPacket WSP]
                             [FmtpOptions WSP]
                             [PacketLossConcealment WSP]
                             [SilenceSuppressionState]
                             *[WSP Extension]


PayloadType  = "PT" EQUAL (1*3DIGIT)

PayloadDesc  = "PD" EQUAL word
SampleRate = "SR" EQUAL (1*5DIGIT)

FrameDuration = "FD" EQUAL (1*3DIGIT)

FrameOctets  = "FO" EQUAL (1*4DIGIT)

FramesPerPacket = "FPP" EQUAL (1*2DIGIT)

FmtpOptions = "FMTP" EQUAL "word-plus"

PacketLossConcealment  = "PLC" EQUAL ("0" / "1" / "2" / "3")

SilenceSuppressionState  = "SSUP" EQUAL ("on" / "off")

CallID  =  "CID" EQUAL word [ "@" word ]

LocalAddr   = "LocalAddr" COLON IPAddress WSP Port WSP Ssrc

RemoteAddr  = "RemoteAddr" COLON IPAddress WSP Port WSP Ssrc

IPAddress   = "IP" EQUAL IPv6address / IPv4address
Port        = "PORT" EQUAL 1*DIGIT
Ssrc        = "SSRC" EQUAL text / notAvail

JitterBuffer = "JitterBuffer" COLON
                       [JitterBufferAdaptive WSP]
                       [JitterBufferRate WSP]
                       [JitterBufferNominal WSP]
                       [JitterBufferMax WSP]
                       [JitterBufferAbsMax]
                       *[WSP Extension]

JitterBufferAdaptive  = "JBA" EQUAL ("0" / "1" / "2" / "3")

JitterBufferRate      = "JBR" EQUAL (1*2DIGIT) ;0-15
JitterBufferNominal   = "JBN" EQUAL (1*5DIGIT) ;0-65535
JitterBufferMax       = "JBM" EQUAL (1*5DIGIT) ;0-65535
JitterBufferAbsMax    = "JBA" EQUAL (1*5DIGIT) ;0-65535

PacketLoss = "PacketLoss" COLON
                     [NetworkPacketLossRate WSP]
                     [JitterBufferDiscardRate]
                     *[WSP Extension]

BurstGapLoss = "BurstGapLoss" COLON
                          [BurstLossDensity WSP]
                          [BurstDuration WSP]
                          [GapLossDensity WSP]
                          [GapDuration WSP]
                          [MinimumGapThreshold]
                          *[WSP Extension]
Delay = "Delay" COLON
                 [RoundTripDelay WSP]
                 [EndSystemDelay WSP]
                 [OneWayDelay WSP]
                 [InterarrivalJitter WSP]
                 [MeanAbsoluteJitter]
                 *[WSP Extension]


RoundTripDelay     = "RTD" EQUAL (1*5DIGIT) ;0-65535

EndSystemDelay     = "ESD" EQUAL (1*5DIGIT) ;0-65535

OneWayDelay        = "OWD" EQUAL (1*5DIGIT) ;0-65535

InterarrivalJitter = "IAJ" EQUAL (1*5DIGIT) ;0-65535

MeanAbsoluteJitter = "MAJ" EQUAL (1*5DIGIT)

Signal = "Signal" COLON
                  [SignalLevel WSP]
                  [NoiseLevel WSP]
                  [ResidualEchoReturnLoss]
                  *[WSP Extension]
SignalLevel = "SL" EQUAL (["-"] 1*2DIGIT)
NoiseLevel  = "NL" EQUAL (["-"] 1*2DIGIT)
ResidualEchoReturnLoss = "RERL" EQUAL (1*3DIGIT)


QualityEstimates  = "QualityEst" COLON
                          [ListeningQualityR WSP]
                          [RLQEstAlg WSP]
                          [ConversationalQualityR WSP]
                          [RCQEstAlg WSP]
                          [ExternalR-In WSP]
                          [ExtRInEstAlg WSP]
                          [ExternalR-Out WSP]
                          [ExtROutEstAlg WSP]
                          [MOS-LQ WSP]
                          [MOSLQEstAlg WSP]
                          [MOS-CQ WSP]
                          [MOSCQEstAlg WSP]
                          [QoEEstAlg]
                          *[WSP Extension]

ListeningQualityR = "RLQ" EQUAL (1*3DIGIT) ; 0 - 120
RLQEstAlg = "RLQEstAlg" EQUAL word ; "PESQ", "G.107", or other

ConversationalQualityR = "RCQ" EQUAL *1*3DIGIT) ; 0 - 120
RCQEstAlg = "RCQEstAlg" EQUAL word ; "PESQ", "G.107", or other

ExternalR-In = "EXTRI" EQUAL (1*3DIGIT) ; 0 - 120
ExtRInEstAlg = "ExtRIEstAlg" EQUAL word ; "PESQ", "G.107", or other

ExternalR-Out = "EXTRO" EQUAL (1*3DIGIT) ; 0 - 120
ExtRInEstAlg = "ExtROEstAlg" EQUAL word ; "PESQ", "G.107", or other

MOS-LQ = "MOSLQ" EQUAL (DIGIT ["." 1*2DIGIT]) ; 0.0 - 4.9
MOSLQEstAlg = "MOSLQEstAlg" EQUAL word ; "PESQ", "G.107", or other

MOS-CQ = "MOSCQ" EQUAL (DIGIT ["." 1*2DIGIT]  ; 0.0 - 4.9
MOSCQEstAlg = "MOSCQEstAlg" EQUAL word ; "PESQ", "G.107", or other

QoEEstAlg = "QoEEstAlg'

DialogID  = "DialogID" COLON callid *(SEMI did-parm)
did-parm  = to-tag / from-tag / generic-param
callid    = *(token)
to-tag    = "to-tag" EQUAL token
from-tag  = "from-tag" EQUAL token

MetricType = "Type" EQUAL "RLQ" / "RCQ" / "EXTR" /
                               "MOSLQ" / "MOSCQ" /
                               "BD" / "NLR" / "JDR" /
                               "RTD" / "ESD" / "IAD" /
                               "RERL" / Extension

Direction = "Dir" EQUAL "local" / "remote"

Severity  = "Severity" EQUAL "Warning" / "Critical" /
                                          "Clear"

Extension = word

word-plus =  1*(alphanum /  "-"  /  "."  /  "!"  / "%" / "*" /
                        "_"  /  "+"  /  "`"  /  "'"  /  "~"  /
                        "("  /  ")"  /  "<"  /  ">"  /  ":"  /
                        "\"  /  "/"  /  "["  /  "]"  /  "?"  /
                        "{"  /  "}"  /  "="  /  " ")



