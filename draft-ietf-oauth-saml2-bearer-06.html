<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Notational Conventions">
<link href="#rfc.section.2" rel="Chapter" title="2 HTTP Parameter Bindings for Transporting Assertions">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Using SAML Assertions as Authorization Grants">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Using SAML Assertions for Client Authentication">
<link href="#rfc.section.3" rel="Chapter" title="3 Assertion Format and Processing Requirements">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Authorization Grant Processing">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Client Authentication Processing">
<link href="#rfc.section.4" rel="Chapter" title="4 Authorization Grant Example (non-normative)">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Sub-Namespace Registration of urn:ietf:params:oauth:grant-type:saml2-bearer">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Sub-Namespace Registration of urn:ietf:params:oauth:client-assertion-type:saml2-bearer">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This specification defines the use of a SAML 2.0 Bearer Assertion as means for requesting an OAuth 2.0 access token as well as for use as a means of client authentication.  " />
  <meta name="description" content="This specification defines the use of a SAML 2.0 Bearer Assertion as means for requesting an OAuth 2.0 access token as well as for use as a means of client authentication.  " />
  <meta name="keywords" content="OAuth, SAML, Assertion" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">B. Campbell, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Ping Identity Corp.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">C. Mortimore</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Salesforce.com</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Aug 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0<br />
  <span class="filename">draft-ietf-oauth-saml2-bearer-06</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This specification defines the use of a SAML 2.0 Bearer Assertion as means for requesting an OAuth 2.0 access token as well as for use as a means of client authentication.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Notational Conventions</a>
</li>
<li>2.   <a href="#rfc.section.2">HTTP Parameter Bindings for Transporting Assertions</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Using SAML Assertions as Authorization Grants</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Using SAML Assertions for Client Authentication</a>
</li>
<li>3.   <a href="#rfc.section.3">Assertion Format and Processing Requirements</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Authorization Grant Processing</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Client Authentication Processing</a>
</li>
<li>4.   <a href="#rfc.section.4">Authorization Grant Example (non-normative)</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Sub-Namespace Registration of urn:ietf:params:oauth:grant-type:saml2-bearer</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Sub-Namespace Registration of urn:ietf:params:oauth:client-assertion-type:saml2-bearer</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The <a href="#OASIS.saml-core-2.0-os">Security Assertion Markup Language (SAML) 2.0</a> <cite title="NONE">[OASIS.saml-core-2.0-os]</cite> is an XML-based framework that allows identity and security information to be shared across security domains.  The SAML specification, while primarily targeted at providing cross domain Web browser single sign-on, was also designed to be modular and extensible to facilitate use in other contexts.  </p>
<p id="rfc.section.1.p.2">The Assertion, an XML security token, is a fundamental construct of SAML that is often adopted for use in other protocols and specifications.  An Assertion is generally issued by an identity provider and consumed by a service provider who relies on its content to identify the Assertion's subject for security related purposes.  </p>
<p><a href="#I-D.ietf.oauth-v2">The OAuth 2.0 Authorization Protocol</a> <cite title="NONE">[I-D.ietf.oauth-v2]</cite> provides a method for making authenticated HTTP requests to a resource using an access token.  Access tokens are issued to third-party clients by an authorization server (AS) with the (sometimes implicit) approval of the resource owner.  In OAuth, an authorization grant is an abstract term used to describe intermediate credentials that represent the resource owner authorization.  An authorization grant is used by the client to obtain an access token.  Several authorization grant types are defined to support a wide range of client types and user experiences.  OAuth also allows for the definition of new extension grant types to support additional clients or to provide a bridge between OAuth and other trust frameworks.  Finally, OAuth allows the definition of additional authentication mechanisms to be used by clients when interacting with the authorization server.  </p>
<p id="rfc.section.1.p.4">The <a href="#I-D.ietf.oauth-assertions">OAuth 2.0 Assertion Profile</a> <cite title="NONE">[I-D.ietf.oauth-assertions]</cite> is an abstract extension to OAuth 2.0 that provides a general framework for the use of assertions as client credentials and/or authorization grants with OAuth 2.0.  This specification profiles the <a href="#I-D.ietf.oauth-assertions">OAuth 2.0 Assertion Profile</a> <cite title="NONE">[I-D.ietf.oauth-assertions]</cite> to define an extension grant type that usues a SAML 2.0 Bearer Assertion to request an OAuth 2.0 access token as well as for use as client credentials.  The format and processing rules for the SAML Assertion defined in this specification are intentionally similar, though not identical, to those in the Web Browser SSO Profile defined in <a href="#OASIS.saml-profiles-2.0-os">SAML Profiles</a> <cite title="NONE">[OASIS.saml-profiles-2.0-os]</cite>.  This specification is reusing, to the extent reasonable, concepts and patterns from that well-established Profile.  </p>
<p id="rfc.section.1.p.5">This document defines how a SAML Assertion can be used to request an access token when a client wishes to utilize an existing trust relationship, expressed through the semantics of (and digital signature calculated over) the SAML Assertion, without a direct user approval step at the authorization server.  It also defines how a SAML Assertion can be used as a client authentication mechanism.  The use of an Assertion for client authentication is orthogonal and separable from using an Assertion as an authorization grant and can be used either in combination or in isolation.  </p>
<p id="rfc.section.1.p.6">The process by which the client obtains the SAML Assertion, prior to exchanging it with the authorization server or using it for client authentication, is out of scope.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Notational Conventions</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<p id="rfc.section.1.1.p.2">Unless otherwise noted, all the protocol parameter names and values are case sensitive.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> HTTP Parameter Bindings for Transporting Assertions</h1>
<p id="rfc.section.2.p.1">The <a href="#I-D.ietf.oauth-assertions">OAuth 2.0 Assertion Profile</a> <cite title="NONE">[I-D.ietf.oauth-assertions]</cite> defines generic HTTP parameters for transporting assertions during interactions with a token endpoint.  This section defines the values of those parameters for use with SAML 2.0 Bearer Assertions.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Using SAML Assertions as Authorization Grants</h1>
<p id="rfc.section.2.1.p.1">To use a SAML Bearer Assertion as an authorization grant, use the following paramter values and encodings.</p>
<p id="rfc.section.2.1.p.2">The value of "grant_type" parameter MUST be "urn:ietf:params:oauth:grant-type:saml2-bearer"</p>
<p id="rfc.section.2.1.p.3">The value of the "assertion" parameter MUST contain a single SAML 2.0 Assertion. The SAML Assertion XML data MUST be encoded using base64url, where the encoding adheres to the definition in Section 5 of <a href="#RFC4648">RFC4648</a> <cite title="NONE">[RFC4648]</cite> and where the padding bits are set to zero.  To avoid the need for subsequent encoding steps (by <a href="#W3C.REC-html401-19991224">"application/x-www-form-urlencoded"</a> <cite title="NONE">[W3C.REC-html401-19991224]</cite>, for example), the base64url encoded data SHOULD NOT be line wrapped and pad characters ("=") SHOULD NOT be included.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Using SAML Assertions for Client Authentication</h1>
<p id="rfc.section.2.2.p.1">To use a SAML Bearer Assertion for client authentication grant, use the following paramter values and encodings.</p>
<p id="rfc.section.2.2.p.2">The value of "client_assertion_type" parameter MUST be "urn:ietf:params:oauth:client-assertion-type:saml2-bearer"</p>
<p id="rfc.section.2.2.p.3">The value of the "client_assertion" parameter MUST contain a single SAML 2.0 Assertion. The SAML Assertion XML data MUST be encoded using base64url, where the encoding adheres to the definition in Section 5 of <a href="#RFC4648">RFC4648</a> <cite title="NONE">[RFC4648]</cite> and where the padding bits are set to zero.  To avoid the need for subsequent encoding steps (by <a href="#W3C.REC-html401-19991224">"application/x-www-form-urlencoded"</a> <cite title="NONE">[W3C.REC-html401-19991224]</cite>, for example), the base64url encoded data SHOULD NOT be line wrapped and pad characters ("=") SHOULD NOT be included.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#assertion_reqs" id="assertion_reqs">Assertion Format and Processing Requirements</a>
</h1>
<p id="rfc.section.3.p.1">In order to issue an access token response as described in <a href="#I-D.ietf.oauth-v2">The OAuth 2.0 Authorization Protocol</a> <cite title="NONE">[I-D.ietf.oauth-v2]</cite> or to rely on an assertion for client authentication, the authorization server MUST validate the Assertion according to the criteria below.  Application of additional restrictions and policy are at the discretion of the authorization server.  </p>
<p></p>

<ul>
<li>The Assertion's &lt;Issuer&gt; element MUST contain a unique identifier for the entity that issued the Assertion.  </li>
<li>The Assertion MUST contain an &lt;AudienceRestriction&gt; element with an &lt;Audience&gt; element containing a URI reference that identifies the authorization server, or the service provider SAML entity of its controlling domain, as an intended audience. The token endpoint URL of the authorization server MAY be used as an acceptable value for an &lt;Audience&gt; element.  The authorization server MUST verify that it is an intended audience for the Assertion.  </li>
<li>The Assertion MUST contain a &lt;Subject&gt; element. The subject MAY identify the resource owner for whom the access token is being requested.  For client authentication, the Subject MUST be the client_id of the OAuth client.  When using assertions as an authorization grant, the Subject SHOULD identify an authorized accessor for whom the access token is being requested (typically the resource owner, or an authorized delegate).  Additional information identifying the subject/principal of the transaction MAY be included in an &lt;AttributeStatement&gt;.  </li>
<li>The Assertion MUST have an expiry that limits the time window during which the it can be used.  The expiry can be expressed either as the NotOnOrAfter attribute of the &lt;Conditions&gt; element or as the NotOnOrAfter attribute of a suitable &lt;SubjectConfirmationData&gt; element.  <br><br> If the Assertion has a NotOnOrAfter attribute on the &lt;Conditions&gt; element, the authorization server MUST verify that the NotOnOrAfter instant has not passed, subject to allowable clock skew between systems.  The authorization server SHOULD reject assertions with an expiry instant that is unreasonably far in the future.  <br><br> If the Assertion does not have a NotOnOrAfter attribute on the &lt;Conditions&gt; element, then the Assertion's &lt;Subject&gt; element MUST contain at least one &lt;SubjectConfirmation&gt; element that allows the authorization server to confirm it as a Bearer Assertion.  Conditions for bearer subject confirmation are described below.  <ul>
<li>The &lt;SubjectConfirmation&lt; MUST have a Method attribute with a value of "urn:oasis:names:tc:SAML:2.0:cm:bearer" and MUST contain a &lt;SubjectConfirmationData&gt; element.  </li>
<li>The &lt;SubjectConfirmationData&gt; element MUST have a Recipient attribute with a value indicating the token endpoint URL of the authorization server. The authorization server MUST verify that the value of the Recipient attribute matches the token endpoint URL (or an acceptable alias) to which the Assertion was delivered.  </li>
<li>The &lt;SubjectConfirmationData&gt; element MUST have a NotOnOrAfter attribute that limits the window during which the Assertion can be confirmed. The authorization server MUST verify that the NotOnOrAfter instant has not passed, subject to allowable clock skew between systems.  The authorization server MAY ensure that Bearer Assertions are not replayed, by maintaining the set of used ID values for the length of time for which the Assertion would be considered valid based on the NotOnOrAfter attribute in the &lt;SubjectConfirmationData&gt;.  The authorization server MAY reject assertions with a NotOnOrAfter instant that is unreasonably far in the future.  </li>
<li>The &lt;SubjectConfirmationData&gt; element MAY also contain an Address attribute limiting the client address from which the Assertion can be delivered.  Verification of the Address is at the discretion of the authorization server.  </li>
</ul>
<p> </p>
</li>
<li>If the Assertion issuer authenticated the subject, the Assertion SHOULD contain a single &lt;AuthnStatement&gt; representing that authentication event.  </li>
<li>If the Assertion was issued with the intention that the presenter act autonomously on behalf of the subject, an &lt;AuthnStatement&gt; SHOULD NOT be included.  The presenter SHOULD be identified in the &lt;NameID&gt; or similar element, the &lt;SubjectConfirmation&gt; element, or by other available means like <a href="#OASIS.saml-deleg-cs">[OASIS.saml-deleg-cs]</a>.  </li>
<li>Other statements, in particular &lt;AttributeStatement&gt; elements, MAY be included in the Assertion.  </li>
<li>The Assertion MUST be digitally signed by the issuer and the authorization server MUST verify the signature.  </li>
<li>Encrypted elements MAY appear in place of their plain text counterparts as defined in <a href="#OASIS.saml-core-2.0-os">[OASIS.saml-core-2.0-os]</a>.  </li>
<li>The authorization server MUST verify that the Assertion is valid in all other respects per <a href="#OASIS.saml-core-2.0-os">[OASIS.saml-core-2.0-os]</a>, such as (but not limited to) evaluating all content within the Conditions element including the NotOnOrAfter and NotBefore attributes, rejecting unknown condition types, etc.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Authorization Grant Processing</h1>
<p id="rfc.section.3.1.p.1">If present, the authorization server MUST also validate the client credentials.</p>
<p id="rfc.section.3.1.p.2">Authorization servers SHOULD issue access tokens with a limited lifetime and require clients to refresh them by requesting a new access token using the same assertion, if it is still valid, or with a new assertion.  The authorization server SHOULD NOT issue a refresh token.</p>
<div id="#rfc.figure.1"></div>
<p id="rfc.section.3.1.p.3">If the Assertion is not valid, or its subject confirmation requirements cannot be met, the authorization server MUST construct an error response as defined in <a href="#I-D.ietf.oauth-v2">[I-D.ietf.oauth-v2]</a>.  The value of the error parameter MUST be the "invalid_grant" error code. The authorization server MAY include additional information regarding the reasons the Assertion was considered invalid using the error_description or error_uri parameters.  </p>

<p>For example:</p>
<pre>
            
HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error":"invalid_grant",
  "error_description":"Audience validation failed"
}

                              </pre>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Client Authentication Processing</h1>
<p id="rfc.section.3.2.p.1">If the client Assertion is not valid, or its subject confirmation requirements cannot be met, the authorization server MUST construct an error response as defined in <a href="#I-D.ietf.oauth-v2">[I-D.ietf.oauth-v2]</a>.  The value of the error parameter MUST be the "invalid_client" error code. The authorization server MAY include additional information regarding the reasons the Assertion was considered invalid using the error_description or error_uri parameters.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#example" id="example">Authorization Grant Example (non-normative)</a>
</h1>
<p id="rfc.section.4.p.1">Though non-normative, the following examples illustrate what a conforming Assertion and access token request would look like.  </p>
<div id="#rfc.figure.2"></div>
<div id="#assertion"></div>
<p>Below is an example SAML 2.0 Assertion (whitespace formatting is for display purposes only): </p>
<pre>

&lt;Assertion IssueInstant="2010-10-01T20:07:34.619Z"
  ID="ef1xsbZxPV2oqjd7HTLRLIBlBb7"
  Version="2.0"
  xmlns="urn:oasis:names:tc:SAML:2.0:assertion"&gt;
 &lt;Issuer&gt;https://saml-idp.example.com&lt;/Issuer&gt;
 &lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
  [...omitted for brevity...]
 &lt;/ds:Signature&gt;
 &lt;Subject&gt;
  &lt;NameID
    Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"&gt;
   brian@example.com
  &lt;/NameID&gt;
  &lt;SubjectConfirmation
    Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"&gt;
   &lt;SubjectConfirmationData
     NotOnOrAfter="2010-10-01T20:12:34.619Z"
     Recipient="https://authz.example.net/token.oauth2"/&gt;
   &lt;/SubjectConfirmation&gt;
  &lt;/Subject&gt;
  &lt;Conditions&gt;
    &lt;AudienceRestriction&gt;
      &lt;Audience&gt;https://saml-sp.example.net&lt;/Audience&gt;
    &lt;/AudienceRestriction&gt;
  &lt;/Conditions&gt;
  &lt;AuthnStatement AuthnInstant="2010-10-01T20:07:34.371Z"&gt;
    &lt;AuthnContext&gt;
      &lt;AuthnContextClassRef&gt;
        urn:oasis:names:tc:SAML:2.0:ac:classes:X509
      &lt;/AuthnContextClassRef&gt;
    &lt;/AuthnContext&gt;
  &lt;/AuthnStatement&gt;
&lt;/Assertion&gt;
                </pre>
<div id="#rfc.figure.3"></div>
<div id="#http"></div>
<p>To present the Assertion shown in the previous example as part of an access token request, for example, the client might make the following HTTPS request (line breaks are for display purposes only): </p>
<pre>
              
POST /token.oauth2 HTTP/1.1
Host: authz.example.net
Content-Type: application/x-www-form-urlencoded

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Asaml2-
bearer&amp;assertion=PEFzc2VydGlvbiBJc3N1ZUluc3RhbnQ9IjIwMTEtMDU
[...omitted for brevity...]aG5TdGF0ZW1lbnQ-PC9Bc3NlcnRpb24-
            </pre>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">No additional considerations beyond those described within the <a href="#I-D.ietf.oauth-v2">OAuth 2.0 Protocol Framework</a> <cite title="NONE">[I-D.ietf.oauth-v2]</cite> and in the <a href="#OASIS.saml-sec-consider-2.0-os">Security and Privacy Considerations for the OASIS Security Assertion Markup Language (SAML) V2.0</a> <cite title="NONE">[OASIS.saml-sec-consider-2.0-os]</cite>.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> IANA Considerations</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Sub-Namespace Registration of urn:ietf:params:oauth:grant-type:saml2-bearer</h1>
<p id="rfc.section.6.1.p.1">This is a request to IANA to please register the value grant-type:saml2-bearer in the registry urn:ietf:params:oauth established in <a href="#I-D.ietf.oauth-urn-sub-ns">[I-D.ietf.oauth-urn-sub-ns]</a> </p>

<ul>
<li>URN: urn:ietf:params:oauth:grant-type:saml2-bearer</li>
<li>Common Name: SAML 2.0 Bearer Assertion Grant Type Profile for OAuth 2.0</li>
<li>Change controller: IETF</li>
<li>Description: [[this document]]</li>
</ul>

<p> </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Sub-Namespace Registration of urn:ietf:params:oauth:client-assertion-type:saml2-bearer</h1>
<p id="rfc.section.6.2.p.1">This is a request to IANA to please register the value client-assertion-type:saml2-bearer in the registry urn:ietf:params:oauth established in <a href="#I-D.ietf.oauth-urn-sub-ns">[I-D.ietf.oauth-urn-sub-ns]</a> </p>

<ul>
<li>URN: urn:ietf:params:oauth:client-assertion-type:saml2-bearer</li>
<li>Common Name: SAML 2.0 Bearer Assertion Profile for OAuth 2.0 Client Authentication </li>
<li>Change controller: IETF</li>
<li>Description: [[this document]]</li>
</ul>

<p> </p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="OASIS.saml-core-2.0-os">[OASIS.saml-core-2.0-os]</b></td>
<td class="top">
<a href="mailto:cantor.2@osu.edu" title="Internet2">Cantor, S.</a>, <a href="mailto:John.Kemp@nokia.com" title="Nokia">Kemp, J.</a>, <a href="mailto:rphilpott@rsasecurity.com" title="RSA Security">Philpott, R.</a> and <a href="mailto:eve.maler@sun.com" title="Sun Microsystems">E. Maler</a>, "<a>Assertions and Protocol for the OASIS Security Assertion Markup Language (SAML) V2.0</a>", OASIS Standard saml-core-2.0-os, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf.oauth-assertions">[I-D.ietf.oauth-assertions]</b></td>
<td class="top">
<a>Mortimore, C.</a>, <a>Campbell, B.</a>, <a>Jones, M.</a> and <a>Y. Goland</a>, "<a>OAuth 2.0 Assertion Profile</a>", ID draft-ietf-oauth-assertions-00 (work in progress), July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf.oauth-urn-sub-ns">[I-D.ietf.oauth-urn-sub-ns]</b></td>
<td class="top">
<a>Campbell, B.</a> and <a>H. Tschofenig</a>, "<a>An IETF URN Sub-Namespace for OAuth</a>", ID draft-campbell-oauth-urn-sub-ns-01 (work in progress), Aug 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf.oauth-v2">[I-D.ietf.oauth-v2]</b></td>
<td class="top">
<a>Hammer-Lahav, E.</a>, <a>Recordon, D.</a> and <a>D. Hardt</a>, "<a>The OAuth 2.0 Authorization Protocol</a>", ID draft-ietf-oauth-v2-16 (work in progress), May 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="OASIS.saml-sec-consider-2.0-os">[OASIS.saml-sec-consider-2.0-os]</b></td>
<td class="top">
<a href="mailto:Frederick.Hirsch@nokia.com" title="Nokia">Hirsch, F.</a>, <a href="mailto:rphilpott@rsasecurity.com" title="RSA Security">Philpott, R.</a> and <a href="mailto:eve.maler@sun.com" title="Sun Microsystems">E. Maler</a>, "<a>Security and Privacy Considerations for the OASIS Security Markup Language (SAML) V2.0</a>", OASIS Standard saml-sec-consider-2.0-os, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="W3C.REC-html401-19991224">[W3C.REC-html401-19991224]</b></td>
<td class="top">
<a>Raggett, D.</a>, <a>Hors, A.</a> and <a>I. Jacobs</a>, "<a>HTML 4.01 Specification</a>", World Wide Web Consortium Recommendation REC-html401-19991224, December 1999.</td>
</tr>
<tr>
<td class="reference"><b id="OASIS.saml-profiles-2.0-os">[OASIS.saml-profiles-2.0-os]</b></td>
<td class="top">
<a title="Altos Origin">Hughes, J.</a>, <a href="mailto:cantor.2@osu.edu" title="Internet2">Cantor, S.</a>, <a href="mailto:Jeff.Hodges@neustar.biz" title="NeuStar">Hodges, J.</a>, <a href="mailto:Frederick.Hirsch@nokia.com" title="Nokia">Hirsch, F.</a>, <a href="mailto:pmishra@principalidentity.com" title="Principal Identity">Mishra, P.</a>, <a href="mailto:rphilpott@rsasecurity.com" title="RSA Security">Philpott, R.</a> and <a href="mailto:eve.maler@sun.com" title="Sun Microsystems">E. Maler</a>, "<a>Profiles for the OASIS Security Assertion Markup Language (SAML) V2.0</a>", OASIS Standard OASIS.saml-profiles-2.0-os, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="OASIS.saml-deleg-cs">[OASIS.saml-deleg-cs]</b></td>
<td class="top">
<a>Cantor, S.</a>, "<a>SAML V2.0 Condition for Delegation Restriction</a>", Nov 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Brian Campbell</span> editor
	  <span class="n hidden">
		<span class="family-name">Campbell</span>
	  </span>
	</span>
	<span class="org vcardline">Ping Identity Corp.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:brian.d.campbell@gmail.com">brian.d.campbell@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Chuck Mortimore</span> 
	  <span class="n hidden">
		<span class="family-name">Mortimore</span>
	  </span>
	</span>
	<span class="org vcardline">Salesforce.com</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:cmortimore@salesforce.com">cmortimore@salesforce.com</a></span>

  </address>
</div>

</body>
</html>