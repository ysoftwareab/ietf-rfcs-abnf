<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>A New BGP Well-Known Community, LAST_RESORT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="A New BGP Well-Known Community, LAST_RESORT">
<meta name="keywords" content="IPv6">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">idr</td><td class="header">B. Dickson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Afilias Canada, Inc</td></tr>
<tr><td class="header">Expires: December 14, 2008</td><td class="header">June 12, 2008</td></tr>
</table></td></tr></table>
<h1><br />A New BGP Well-Known Community, LAST_RESORT<br />draft-dickson-idr-last-resort-01</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 14, 2008.</p>

<h3>Abstract</h3>

<p>
This Internet Draft describes a new well-known BGP community, LAST_RESORT.
<br />
<br />

This community provides a simple and easily deployable solution to BGP "wedgies".
<br />
<br />

Initial deployment is expected to be achieved by voluntary use in the network operator community-at-large.
<br />
<br />

Long-term adoption via software enforcement of the well-known aspect of the community, will improve global behavior, and simplify router configurations.

</p>
<h3>Author's Note</h3>

<p>This Internet Draft is intended to result in this draft or a related draft(s) being placed on the Standards Track for idr.
      <br />
<br />

      The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in
      <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      <br />
<br />

      Intended Status: Proposed Standard.

</p>
<a name="anchor1"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Background</h3>

<p>
Even when all the best current practises are observed, operational problems may be experienced when running a BGP network.
<br />
<br />

One particularly thorny problem is <a class='info' href='#RFC4264'>BGP "wedgies"<span> (</span><span class='info'>Griffin, T. and G. Huston, &ldquo;BGP Wedgies,&rdquo; November&nbsp;2005.</span><span>)</span></a> [RFC4264].
<br />
<br />

While not often articulated, the common problem is use of local policy setting within AS boundaries, which often overrides the original intent of "backup" BGP announcements.
<br />
<br />

It is somewhat ironic that such local policies are often achieved by use of BGP Communities, and that the lack of a common choice, i.e. "well known", community, is one source of the problem.

</p>
<a name="anchor2"></a><br /><hr />
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
The Local Policy Problem</h3>

<p>
The BGP "wedgie" problem occurs as a result of "intended policy" information not being available. Specifically, this is the lack of an explicit global mechanism for expressing de-prefering announcements via "back-up" providers. In essence, local policy could be described as "not well informed".

</p>
<a name="anchor3"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
Proposed Change: A New BGP Well-Known Community</h3>

<p>
To solve the problem, a new BGP well-known Community, LAST_RESORT, is proposed.
This is a new value to be assigned by IANA.

</p>
<a name="anchor4"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
Changes to BGP Path Selection Rules</h3>

<p>
The path selection rules for BGP (section 9.1.2.2 of <a class='info' href='#RFC4271'>BGP4<span> (</span><span class='info'>Rekhter, Y., Li, T., and S. Hares, &ldquo;A Border Gateway Protocol 4 (BGP-4),&rdquo; January&nbsp;2006.</span><span>)</span></a> [RFC4271]) are changed as follows:

</p>
<ul class="text">
<li>The following rule is placed before step (a):

If paths with and without LAST_RESORT are both available, those with LAST_RESORT are eliminated.

</li>
<li>The remainder of the usual BGP path selection rules are applied as normal

</li>
</ul><p>
Note Well: This MAY be implemented by applying suitable LOCAL_PREFERENCE. Assignment of lowest-possible preference order of LOCAL_PREFERENCE should achieve the same behavior, and may be simpler to implement.

</p>
<a name="anchor5"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
LAST_RESORT - Basic Method</h3>

<p>
The main reason for establishing the LAST_RESORT Community is to permit the global implementation of actual "backup only" announcements.
It is not to facilitate change of policies, or to circumvent local policies, instead it is to make possible the implementation of policies where those have been negotiated by two or more parties.
<br />
<br />

Currently, there are several documented scenarios in <a class='info' href='#RFC4264'>the "Wedgies" RFC<span> (</span><span class='info'>Griffin, T. and G. Huston, &ldquo;BGP Wedgies,&rdquo; November&nbsp;2005.</span><span>)</span></a> [RFC4264] where the mutually desired policy is either unable to be implemented, or does not deterministically reach the desired state.
<br />
<br />

Application of the LAST_RESORT Communty on announcements sent to a backup provider, permits these problems to be resolved.
<br />
<br />

The same prefix is announced to both the primary and backup provider.
When announced to the primary provider, the LAST_RESORT Community is NOT set.
When announced to the backup provider, the LAST_RESORT Community IS set.
<br />
<br />

The propogation of the LAST_RESORT instance will be limited by the availability of paths, and inhibited by the existence of paths which do not have LAST_RESORT applied to them.
<br />
<br />

In <a class='info' href='#c1'>Figure&nbsp;1</a> (of <a class='info' href='#appendixc'>Appendix&nbsp;A<span> (</span><span class='info'>BGP Wedgie Examples</span><span>)</span></a>), the LAST_RESORT instance will be seen by the backup provider, and be passed with LAST_RESORT to the backup provider's transit provider.
The latter will prefer any other instace without LAST_RESORT, even if it has applied a LOCAL_PREFERENCE to the received prefix instance.
Should the other instance be withdrawn, the LAST_RESORT will be selected and subsequently propogated.

</p>
<a name="anchor6"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
No additional security considerations beyond those already present in BGP are introduced.

</p>
<a name="anchor7"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>
IANA will need to assign a new code points for BGP Well-Known Communities for LAST_RESORT.

</p>
<a name="anchor8"></a><br /><hr />
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>
The author wishes to acknowledge the helpful guidance of Joe Abley, Tony Li, and Yakov Rekhter.

The author also wishes to acknowledge the assistance and suggestions of Joel M. Halpern in simplifying the original "Backup-only" concept to that of a BGP community.

</p>
<a name="rfc.references"></a><br /><hr />
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4264">[RFC4264]</a></td>
<td class="author-text">Griffin, T. and G. Huston, &ldquo;<a href="http://tools.ietf.org/html/rfc4264">BGP Wedgies</a>,&rdquo; RFC&nbsp;4264, November&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4264.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4271">[RFC4271]</a></td>
<td class="author-text">Rekhter, Y., Li, T., and S. Hares, &ldquo;<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>,&rdquo; RFC&nbsp;4271, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4271.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1997">[RFC1997]</a></td>
<td class="author-text"><a href="mailto:rchandra@cisco.com">Chandrasekeran, R.</a>, <a href="mailto:pst@cisco.com">Traina, P.</a>, and <a href="mailto:tli@skat.usc.edu">T. Li</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1997">BGP Communities Attribute</a>,&rdquo; RFC&nbsp;1997, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1997.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="appendixc"></a><br /><hr />
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
BGP Wedgie Examples</h3>

<p>
The following examples from <a class='info' href='#RFC4264'>RFC 4264<span> (</span><span class='info'>Griffin, T. and G. Huston, &ldquo;BGP Wedgies,&rdquo; November&nbsp;2005.</span><span>)</span></a> [RFC4264] show the effects of the proposed changes, in resolving "wedgie" issues.
    
<br /><hr class="insert" />
<a name="c1"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----+                +----+
|AS 3|----------------|AS 4|
+----+ peer      peer +----+
  |provider             |provider
  |                     |
  |customer             |
+----+                  |
|AS 2|                  |
+----+                  |
  |provider             |
  |                     |
  |customer             |customer
  +-------+  +----------+
    backup|  |primary
         +----+
         |AS 1|
         +----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

In <a class='info' href='#c1'>Figure&nbsp;1</a> above, the announcement via the backup link is sent with LAST_RESORT.
</p>
<ul class="text">
<li>AS 4 sends AS_PATH "4 1" to AS 3.
</li>
<li>AS 2 receives the LAST_RESORT path from AS 1, and sends AS_PATH "2 1" to AS 3, also with LAST_RESORT.
</li>
<li>AS 3 and AS 4 exchange their respective "best" paths.
</li>
<li>AS 3 prefers the path "4 1" over "2 1" because "2 1" is LAST_RESORT.
</li>
<li>AS 3 sends a withdrawal of the LAST_RESORT path to AS 4.
</li>
<li>AS 3 sends its "best", AS_PATH "3 4 1" to AS 2.
</li>
</ul><p>
This state will be reached regardless of sequence of disconnects and reconnects.
     
<br /><hr class="insert" />
<a name="c2"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----+                +----+
|AS 3|----------------|AS 4|
+----+ peer      peer +----+
  |provider             |provider
  |                     |
  |customer             |customer
+----+                +----+
|AS 2|                |AS 5|
+----+                +----+
  |provider             |provider
  |                     |
  |customer             |customer
  +-------+  +----------+
    backup|  |primary for 192.9.200.0/25
   primary|  |backup  for 192.9.200.128/25
         +----+
         |AS 1|
         +----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


In <a class='info' href='#c2'>Figure&nbsp;2</a> above, the announcements via the backup links will work the same as in Example 1.
<br /><hr class="insert" />
<a name="c3"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----+                +----+
|AS 3|----------------|AS 4|
+----+ peer      peer +----+
 ||provider             |providerS
 |+-----------+         |
 |customer    |customer |
+----+       +----+     |
|AS 2|-------|AS 5|     |
+----+ peer  +----+     |
  |provider   |provider |
  |           |         |
  |customer +-+customer |customer
  +-------+ |+----------+
    backup| ||primary
         +----+
         |AS 1|
         +----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


In <a class='info' href='#c3'>Figure&nbsp;3</a> above, the announcements via both backup links will result in:
</p>
<ul class="text">
<li>AS 2 selecting its best path via "3 4 1" (the only path it hears from AS 3)

</li>
<li>AS 2 hearing one of two paths from AS 5:

<ul class="text">
<li>"5 3 4 1"

</li>
<li>LAST_RESORT with path "5 1"

</li>
</ul>

</li>
<li>AS 2 hearing a LAST_RESORT directly from AS 1

</li>
</ul><p>
Any announcement that AS 3 hears from AS 2 will always be marked LAST_RESORT. (The same will be true of AS 5.)
Thus, any combination of break/restore on any links in any order, will always result in the desired state being reached.
    
</p>
<a name="rfc.authors"></a><br /><hr />
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Dickson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Afilias Canada, Inc</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">4141 Yonge St,</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 204</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">North York, ON  M2P 2A8</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:brian.peter.dickson@gmail.com">brian.peter.dickson@gmail.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.afilias.info">www.afilias.info</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
