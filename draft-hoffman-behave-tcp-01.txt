



Network Working Group                                         P. Hoffman
Internet-Draft                                 Cybersecurity Association
Expires: January 15, 2006                                        S. Guha
                                                                 Cornell
                                                           July 14, 2005


              NAT Behavioral Requirements for Unicast TCP
                    draft-hoffman-behave-tcp-01.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on January 15, 2006.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   This document defines a set of requirements for NATs that handle
   unicast TCP that would allow many applications, such as multimedia
   communications or on-line gaming, to work consistently.  Developing
   NATs that meet this set of requirements will greatly increase the
   likelihood that these applications will function properly.





Hoffman & Guha          Expires January 15, 2006                [Page 1]

Internet-Draft        NAT TCP Unicast Requirements             July 2005


1.  Introduction

   [BEHAVE-UDP] defines many terms relating to NATs, lays out general
   requirements for all NATs, and sets requirements for NATs that handle
   unicast UDP traffic.  This document is an adjunct to [BEHAVE-UDP]
   that sets requirements for NATs that handle unicast TCP traffic (that
   is, almost every NAT).  All definitions and requirements in [BEHAVE-
   UDP] are inherited here.

2.  Incoming SYN packets on an open TCP connection

   Some TCP-based protocols attempt to start multiple TCP connections
   for a single flow of traffic.  Such protocols can sometimes work
   through NATs.  Normal TCP stacks accept incoming SYN packets, of
   course.

   REQ-1 A NAT MUST allow SYN packets in either direction on any open
         NAT session that is a TCP connection.


3.  Incoming SYN packets to non-existent sessions

   TCP-handling have two basic choices when they receive a SYN packet
   for a session that they do not intend to set up: ignore it or respond
   to it with a RST packet.  A NAT that receives a SYN packet from the
   outside for a connection that does not exist must decide whether or
   not to respond with a RST packet.  Ignoring such a SYN packet causes
   no traffic overhead, and does not expose the NAT to any known
   security vulnerability.  Ignoring the SYN instead of responding with
   an RST can help some applications that start multiple TCP
   connections.

   REQ-2 A NAT MUST NOT reply to a SYN packet sent from the outside to a
         connection that is not established.


4.  Resource exhaustion and timers

   A NAT maintains state associated with the sessions that it maintains.
   Because of this, a NAT is susceptible to a resource-exhaustion attack
   whereby the attacker attempts to cause the NAT to create more state
   that it has resources.  To prevent such an attack, a NAT needs to
   abandon sessions in order to free the state resources.

   A common method that is applicable only to TCP connections is to look
   for partially-open or partially closed TCP connections and abandon
   those based on timers specific to those states.  There is a serious
   problem with this method: the timers used by the NAT are unlikely to



Hoffman & Guha          Expires January 15, 2006                [Page 2]

Internet-Draft        NAT TCP Unicast Requirements             July 2005


   be the same as the timers that are used by the two end systems.  This
   is particularly true for end systems that do not use timers for
   partially-open or partially-closed TCP connections, but instead use
   resource-based methods.  A NAT that uses such timers is inherently
   non-deterministic.

   REQ-3 A NAT MUST NOT abandon a TCP connection simply because it has
         been in a partially-open or partially-closed state for a long
         time, or because it has been open for a long time without
         traffic.

   A NAT that is facing resource exhaustion MAY abandon TCP connections.
   This is the only time that a NAT may abandon a TCP connection, even
   one that is partially-open.

   REQ-4 In order to cause the least unexpected behavior, a NAT that is
         abandoning TCP connections to prevent resource exhaustion
         SHOULD first abandon partially-closed TCP sessions; then, only
         if needed, it SHOULD abandon partially-open TCP sessions; then,
         only if needed, it SHOULD abandon open TCP sessions that have
         had no traffic for a relatively long time.  A NAT is allowed to
         change the order of the sessions to abandon based on particular
         attack patterns.

   REQ-5 When a NAT closes an open TCP session to avoid resource
         exhaustion, it MUST send RST packets to each end of the
         session.


5.  Security considerations

   The security considerations for this document are the same as for
   [BEHAVE-UDP].  The fact that this document covers unicast TCP does
   not change any of the security considerations there. [[ Is this
   statement actually true? ]]

6.  IANA considerations

   This document does not change or create any IANA-registered values.

7.  Normative References

   [BEHAVE-UDP]
              Audet, F. and C. Jennings, "NAT Behavioral Requirements
              for Unicast UDP", draft-ietf-behave-nat-udp (work in
              progress).





Hoffman & Guha          Expires January 15, 2006                [Page 3]

Internet-Draft        NAT TCP Unicast Requirements             July 2005


Authors' Addresses

   Paul Hoffman
   Cybersecurity Association
   127 Segre Place
   Santa Cruz, CA 95060
   USA

   Email: paul.hoffman@cybersecurity.org


   Saikat Guha
   Cornell

   Email: saikat@cs.cornell.edu




































Hoffman & Guha          Expires January 15, 2006                [Page 4]

Internet-Draft        NAT TCP Unicast Requirements             July 2005


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Disclaimer of Validity

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Copyright Statement

   Copyright (C) The Internet Society (2005).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.




Hoffman & Guha          Expires January 15, 2006                [Page 5]


