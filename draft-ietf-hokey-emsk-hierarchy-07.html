<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Specification for the Derivation of Root Keys from an
      Extended Master Session Key (EMSK)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Specification for the Derivation of Root Keys from an
      Extended Master Session Key (EMSK)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">J. Salowey</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfceap-keying'>eap-keying</a> (RFC
  Ed to</td><td class="header">L. Dondeti</td></tr>
<tr><td class="header"> <a href='http://tools.ietf.org/html/rfcreplace this with RFC number)'>replace this with RFC number)</a></td><td class="header">V. Narayanan</td></tr>
<tr><td class="header">(if&nbsp;approved)</td><td class="header">Qualcomm, Inc</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">M. Nakhjiri</td></tr>
<tr><td class="header">Expires: December 25, 2008</td><td class="header">Motorola</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 23, 2008</td></tr>
</table></td></tr></table>
<h1><br />Specification for the Derivation of Root Keys from an
      Extended Master Session Key (EMSK)<br />draft-ietf-hokey-emsk-hierarchy-07</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 25, 2008.</p>

<h3>Abstract</h3>

<p>The Extensible Authentication Protocol (EAP) defined the Extended Master Session Key (EMSK) generation, but reserved it for unspecified future uses. This memo reserves the EMSK for the sole purpose of deriving root keys. Root keys are are master keys that can be used for multiple purposes, identified by usage definitions.  This document also specifies a mechanism for avoiding conflicts between root keys by deriving them in a manner that guarantee cryptographic separation. Finally, this document also defines one such root key usage: domain specific root keys are root keys made available to and used within specific key management domains.
</p>
<p>
</p>
<p>
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#applicability">1.1.</a>&nbsp;
Applicable usages of keys derived from the EMSK<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.2.</a>&nbsp;
Terminology<br />
<a href="#anchor2">2.</a>&nbsp;
Cryptographic Separation and Coordinated Key Derivation<br />
<a href="#keyframe">3.</a>&nbsp;
EMSK Key Root Derivation Framework <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#KDF">3.1.</a>&nbsp;
USRK Derivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.1.</a>&nbsp;
On the KDFs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defprf">3.1.2.</a>&nbsp;
Default KDF<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#keyname">3.2.</a>&nbsp;
EMSK and USRK Name Derivation<br />
<a href="#anchor4">4.</a>&nbsp;
Domain Specific Root Key Derivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Applicability of Multi-Domain usages<br />
<a href="#usage">5.</a>&nbsp;
Requirements for Usage Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.1.</a>&nbsp;
Root Key Management Guidelines<br />
<a href="#reqeap">6.</a>&nbsp;
Requirements for EAP System<br />
<a href="#anchor7">7.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">7.1.</a>&nbsp;
Key strength<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">7.2.</a>&nbsp;
Cryptographic separation of keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">7.3.</a>&nbsp;
Implementation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#seckeydist">7.4.</a>&nbsp;
Key Distribution<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">7.5.</a>&nbsp;
Key Lifetime<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">7.6.</a>&nbsp;
Entropy consideration<br />
<a href="#IANA">8.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">8.1.</a>&nbsp;
Key Labels<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">8.2.</a>&nbsp;
PRF numbers<br />
<a href="#anchor15">9.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document deals with keys generated by authenticated key exchange mechanisms defined
        within the EAP framework <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>. EAP defines two types of keying material;
        a Master Session Key (MSK) and an Extended Master Session Key (EMSK). The EAP specification
        implicitly assumes that the MSK produced by EAP will be used for a single purpose at a
        single device, however it does reserve the EMSK for future use. This document defines the
        EMSK to be used solely for deriving root keys using the key derivation specified. The root
        keys are meant for specific purposes called usages; a special usage class is the domain specific root keys made
        available to and used within specific key management domains. This document also provides 
        guidelines for creating usage definitions for the various uses of EAP key material and for
        the management of the root keys. In this document, the terms application and usage (or
        "usage definition") refer to a specific use case of the EAP keying material.
</p>
<p>Different uses for keys derived from the EMSK have been proposed. Some examples include
        hand off across access points in various mobile technologies, mobile IP authentication and
        higher layer application authentication. In order for a particular usage of EAP key material
        to make use of this specification it must specify a so-called usage definition. This document does not define how the derived Usage Specific Root Keys (USRK) are used, see the following section for discussion of applicable usages. It does define a framework for the derivation of USRKs for
        different purposes such that different usages can be developed independently from one
        another. The goal is to have security properties of one usage have minimal or no effect on
        the security properties of other usages.  
</p>
<p>This document does define a special class of USRK, called a Domain Specific Root Key (DSRK)
         for use in deriving keys specific to a key management domain.  Each DSRK is a root key 
         used to derive Domain Specific Usage Specific Root Keys (DSUSRK).  
         The DSUSRKs are USRKs specific to a particular key management domain. 
</p>
<p>In order to keep root keys for specific purposes separate from one another, two requirements
        are defined in the following sections. One is coordinated key derivation and another is
        cryptographic separation.
</p>
<a name="applicability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Applicable usages of keys derived from the EMSK</h3>

<p>
        The EMSK is typically established as part of network access
        authentication and authorization. It is expected that keys derived
        from EMSK will be used in protocols related to network access, such as
        handover optimizations, and the scope of these protocols is usually
        restricted to the endpoints of the lower layers over which EAP packets
        are sent.
        
</p>
<p>
          In particular, it is inappropriate for the security of higher layer
          applications to solely rely on keys derived from network access
          authentication. Even when used together with another, independent
          security mechanism, the use of these keys needs to be carefully
          evaluated with regards to the benefits of the optimization and the need
          to support multiple solutions.  Performance optimizations may not
          warrant the close tie-in that may be required between the layers in
          order to use EAP-based keys.  Such optimizations may be offset by the
          complexities of managing the validity and usage of key materials.  Keys
          generated from subsequent EAP authentications may be beyond the
          knowledge and control of applications.
        
</p>
<p>
        From an architectural point of view, applications should not make
        assumptions about the lower layer technology (such as network access
        authentication) used on any particular hop along the path between the
        application endpoints.
        
</p>
<p>
        From a practical point of view, making such assumptions would
        complicate using those applications over lower layers that do not use
        EAP, and make it more difficult for applications and network access
        technologies to evolve independently of each other.
        
</p>
<p>
        Parties using keys derived from EMSK also need trust relationships
        with the EAP endpoints, and mechanisms for securely communicating
        the keys.
        
</p>
<p>
        For most applications, it is not appropriate to assume that all
        current and future access networks are trusted to secure the
        application function. Instead, applications should implement the
        required security mechanisms in access independent manner.
        
</p>
<p>
        Implementation considerations may also complicate communication of
        keys to an application from the lower layer. For instance, in many
        configurations applications may run on a different device than the
        one providing EAP-based network access to it.
        
</p>
<p>
          Given all this, it is NOT RECOMMENDED to use keys derived from the EMSK
          as an exclusive security mechanism, when their usage is not inherently,
          and by permanent nature, tied to the lower layer where network access
          authentication was performed.
        
</p>
<p>
        Keys derived from EAP are pairwise by nature and are not directly
        suitable for multicast or other group usages such as those involved in
        some routing protocols. It is possible to use keys derived from EAP in
        protocols that distribute group keys to group participants. The
        definition of these group key distribution protocols is beyond the scope
        of this document and would require additional specification. 
        
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
          NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
          described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>
</p>
<p>The following terms are taken from <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>: EAP Server, peer,
          authenticator, Master Session Key (MSK), Extended Master Session Key (EMSK), Cryptographic
          Separation.
</p>
<p>Usage Definition</p>
<blockquote class="text">
<p>An application of cryptographic key material to provide one or more security
              functions such as authentication, authorization, encryption or integrity protection
              for related applications or services. This document provides guidelines and
              recommendations for what should be included in usage definitions. This document does
              not place any constraints on the types of use cases or services that create usage
              definitions.
</p>
</blockquote>

<p>Usage Specific Root Key (USRK)</p>
<blockquote class="text">
<p>Keying material derived from the EMSK for a particular usage definition. 
               It is used to derive child keys in a way defined by its usage definition.
</p>
</blockquote>

<p>Key Management Domain</p>
<blockquote class="text">
<p>A key management domain is specified by the scope of a given root key.
The scope is the collection of systems authorized to access key material derived from that key. Systems within a key
	    management domain may be authorized to (1) derive key materials, (2) use key materials, or (3) distribute key
	    materials to other systems in the same domain.  A derived key's scope is constrained to a subset of the scope of
	    the key it is derived from. In this document the term domain refers to a key management domain unless otherwise
	    qualified.      

</p>
</blockquote>

<p>Domain Specific Root Key (DSRK)</p>
<blockquote class="text">
<p>Keying material derived from the EMSK that is restricted to use in a specific
              key management domain. It is used to derive
              child keys for a particular usage definition. The child keys derived from a DSRK are
              referred to as domain specific usage specific root keys (DSUSRK). DSUSRKs are similar
              to the USRK, except in the fact that their scope is restricted to the same domain as
              the parent DSRK from which it is derived. 
</p>
</blockquote><p>

	
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Cryptographic Separation and Coordinated Key Derivation</h3>

<p>The EMSK is used to derive keys for multiple use cases, and thus it is required that the
        derived keys are cryptographically separate. Cryptographic separation means that when
        multiple keys are derived from an EMSK, given any derived key it is computationally
        infeasible to derive any of the other derived keys. Note that deriving the EMSK from any
        combinations of the derived keys must also be computationally infeasible. In practice this
        means that derivation of an EMSK from a derived key or derivation of one child key from
        another must require an amount of computation equivalent to that required to, say, reversing
        a cryptographic hash function.
</p>
<p>Cryptographic separation of keys derived from the same key can be achieved in many ways.
        Two obvious methods are as follows: it is plausible to use the IKEv2 PRF <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> on the EMSK and generate a key stream. Keys of various lengths may be
        provided as required from the key stream for various uses. The other option is to derive
        keys from EMSK by providing different inputs to the PRF. However, it is desirable that
        derivation of one child key from the EMSK is independent of derivation of another child key.
        This allows child keys to be derived in any order, independent of other keys. Thus it is
        desirable to use the second option from above. That implies the additional input to the PRF
        must be different for each child key derivation. This additional input to the PRF must be
        coordinated properly to meet the requirement of cryptographic separation and to prevent
        reuse of key material between usages.
</p>
<p>If cryptographic separation is not maintained then the security of one usage depends upon
        the security of all other usages that use key derived from the EMSK. If a system does not
        have this property then a usage's security depends upon all other usages deriving keys from
        the same EMSK, which is undesirable. In order to prevent security problems in one usage from
        interfering with another usage, the following cryptographic separation is required:
</p>
<p>
        </p>
<ul class="text">
<li>It MUST be computationally infeasible to compute the EMSK from any root key derived
            from it.
</li>
<li>Any root key MUST be cryptographically separate from any other root key derived from
            the same EMSK or DSRK
</li>
<li>Derivation of USRKs MUST be coordinated so that two separate cryptographic usages do
            not derive the same key.
</li>
<li>Derivation of DSRKs MUST be coordinated so that two separate key management domains do
            not derive the same key.
</li>
<li>Derivation of DSRKs and USRKs MUST be specified such that no domain can obtain a USRK by providing a
            domain name identical to a Usage Key Label.
</li>
</ul><p>
      
</p>
<p>This document provides guidelines for a key derivation mechanism, which can be used with existing and new
        EAP methods to provide cryptographic separation between usages of EMSK. This allows for the
        development of new usages without cumbersome coordination between different usage
        definitions.
</p>
<a name="keyframe"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
EMSK Key Root Derivation Framework </h3>

<p>The EMSK key derivation framework provides a coordinated means for generating multiple root
        keys from an EMSK. Further keys may then be derived from the root key for various purposes,
        including encryption, integrity protection, entity authentication by way of proof of
        possession, and subsequent key derivation. A root key is derived from the EMSK for specific
        set of uses set forth in a usage definition described in <a class='info' href='#usage'>Section&nbsp;5<span> (</span><span class='info'>Requirements for Usage Definitions</span><span>)</span></a>.
</p>
<p>The basic EMSK root key hierarchy looks as follows:
</p>
<p>
        
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>                   EMSK
                  /    \
                USRK1  USRK2
</pre></div>
      

<p>This document defines how to derive usage specific root keys (USRK) from the EMSK and also defines a specific
        USRK called  a domain specific root key (DSRK). DSRK are root keys 
        restricted to use in a particular key management domain. From the DSRK, usage specific root
        keys for a particular application may be derived (DSUSRK). The DSUSRKs are equivalent to
        USRKs that are restricted to use in a particular domain. The details of lower levels of key
        hierarchy are outside scope of this document. The key hierarchy looks as follows:
</p>
<p>
        
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                   EMSK
                  /    \
               USRK   DSRK
                     /    \
                DSUSRK1 DSUSRK2
</pre></div>
      

<a name="KDF"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
USRK Derivation</h3>

<p>The EMSK Root Key derivation function (KDF) derives a USRK from the EMSK, a key
          label, optional data, and output length. The KDF is expected to give the same output for
          the same input. The basic key derivation function is given below.
</p>
<p>
          
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     USRK = KDF(EMSK, key label | "\0" | optional data | length)

   Where:

     | denotes concatenation
     "\0" is a NULL octet (0x00 in hex)
     length is a 2 octet unsigned integer in network byte order
</pre></div>
<p>
</p>
        

<p>The key labels are printable ASCII strings unique for each usage definition and are a
          maximum of 255 octets. In general they are of the form label-string@specorg where specorg
          is the organization that controls the specification of the usage definition of the Root
          Key. The key label is intended to provide global uniqueness. Rules for the allocation of
          these labels are given in <a class='info' href='#IANA'>Section&nbsp;8<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>.
          
</p>
<p>The NULL octet after the key label is used to avoid collisions if one key label is a
          prefix of another label (e.g. "foobar" and "foobarExtendedV2"). This is considered a
          simpler solution than requiring a key label assignment policy that prevents prefixes from
          occurring.
</p>
<p>
          For the optional data the KDF MUST be capable of processing at least 2048 opaque octets. The optional data
          must be constant during the execution of the KDF.    Usage definitions MAY use the EAP session-ID <a class='info' href='#I-D.ietf-eap-keying'>[I&#8209;D.ietf&#8209;eap&#8209;keying]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a>  in the specification of the optional data parameter that go into the KDF
          function. This provides the advantage of providing data into the key derivation that is unique to the session
          that generated the keys.  
        
</p>
<p>The KDF must be able to process input keys of up to 256 bytes. It may do this by providing a mechanism for "hashing" long keys down to a suitable size that can be consumed by the underlying derivation algorithm. 
</p>
<p>
          The length is a 2-octet unsigned integer in network byte order of the output key length in octets. An
          implementation of the KDF MUST be capable of producing at least 2048 octets of output, however it is
          RECOMMENDED that Root Keys be at least 64 octets long.
</p>
<p>A usage definition requiring derivation of a Root Key must specify all the inputs (other
          than EMSK) to the key derivation function.
</p>
<p>USRKs MUST be at least 64 octets in length.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
On the KDFs</h3>

<p>This specification allows for the use of different KDFs. However, in order to have a
          coordinated key derivation function the same KDF function MUST be used for all key
          derivations for a given EMSK. If no KDF is specified, then the default KDF specified in
            <a class='info' href='#defprf'>Section&nbsp;3.1.2<span> (</span><span class='info'>Default KDF</span><span>)</span></a> MUST be used. A system may provide the capability to negotiate
          additional KDFs. KDFs are assigned numbers through IANA following the policy set in
          section <a class='info' href='#IANA'>Section&nbsp;8<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>. The rules for negotiating a KDF are as follows:
</p>
<p>
          </p>
<ul class="text">
<li>If no other KDF is specified the KDF specified in this document MUST be used. This is
              the "default" KDF.
</li>
<li>The initial authenticated key exchange MAY specify a favored KDF. For example an EAP
              method may define a preferred KDF to use in its specification. If the initial
              authenticated key exchange specifies a KDF then this MUST override the default KDF.
</li>
</ul><p>
        
</p>
<p>Note that usage definitions MUST NOT concern themselves with the details of the KDF
          construction or the KDF selection, they only need to worry about the inputs specified in
            <a class='info' href='#keyframe'>Section&nbsp;3<span> (</span><span class='info'>EMSK Key Root Derivation Framework </span><span>)</span></a>.
</p>
<a name="defprf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Default KDF</h3>

<p>The default KDF for deriving root keys from an EMSK is taken from the PRF+ key expansion
          specified in <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> based on HMAC-SHA-256 <a class='info' href='#SHA256'>[SHA256]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a>. The PRF+
          construction was chosen because of its simplicity and efficiency over other mechanisms such as
          those used in <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a>. The motivation for the design of PRF+ is
          described in <a class='info' href='#SIGMA'>[SIGMA]<span> (</span><span class='info'>Krawczyk, H., &ldquo;SIGMA: the 'SIGn-and-MAc' Approach to Authenticated Diffie-Hellman and its Use in             the IKE Protocols,&rdquo; 2003.</span><span>)</span></a>. The definition of PRF+ from <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>is given below:
</p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     PRF+ (K,S) = T1 | T2 | T3 | T4 | ...
</pre></div>
<p>Where:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     T1 = PRF (K, S | 0x01)
     T2 = PRF (K, T1 | S | 0x02)
     T3 = PRF (K, T2 | S | 0x03)
     T4 = PRF (K, T3 | S | 0x04)</pre></div>
<p>continuing as needed to compute the required length of key material. The key, K, is the
          EMSK and S is the concatenation of key label, the NULL octet, optional data  and length defined in <a class='info' href='#KDF'>Section&nbsp;3.1<span> (</span><span class='info'>USRK Derivation</span><span>)</span></a>. For this specification the PRF is 
          taken as HMAC-SHA-256 <a class='info' href='#SHA256'>[SHA256]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a>. Since PRF+ is only defined for 255
          iterations it may produce up to 8160 octets of key material.
</p>
<a name="keyname"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
EMSK and USRK Name Derivation</h3>

<p>The EAP keying framework <a class='info' href='#I-D.ietf-eap-keying'>[I&#8209;D.ietf&#8209;eap&#8209;keying]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a> specifies that the EMSK MUST be named using the
          EAP Session-Id and a binary or textual indication.  Following that requirement, the EMSK name SHALL be derived
          as follows:
</p>
<p>
          
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     EMSKname = KDF ( EAP Session-ID, "EMSK" | "\0" | length )

Where:

     | denotes concatenation
     "EMSK" consists of the 4 ASCII values for the letters
     "\0" = is a NULL octet (0x00 in hex)
     length is the 2 octet unsigned integer 8 in network byte order
</pre></div>
<p>
</p>
        

<p> 
</p>
<p>It is RECOMMENDED that all keys derived from the EMSK are referred to by the EMSKname and the context of the
          descendant key usage.  This is the default behavior.  Any exceptions SHALL be signaled by individual usages.
</p>
<p>USRKs MAY be named explicitly with a name derivation specified as follows:
</p>
<p>
          
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      USRKName =
           KDF(EAP Session-ID, key label|"\0"|optional data|length)

 Where:

      key label and optional data MUST be the same as those used
        in the corresponding USRK derivation
      length is the 2 octet unsigned integer 8 in network byte order
</pre></div>
<p>
</p>
        

<p>USRKName derivation and usage is applicable when there is ambiguity in the referencing the keys using the
          EMSKname and the associated context of the USRK usage.  The usage SHALL signal
          such an exception in key naming, so both parties know the key name used. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Domain Specific Root Key Derivation</h3>

<p>A specific USRK called a Domain Specific Root Key (DSRK) is derived from the
        EMSK for a specific set of usages in a particular key management domain. Usages derive
        specific keys for specific services from this DSRK. The DSRK may be
        distributed to a key management domain for a specific set of usages so keys can be derived
        within the key management domain for those usages.  DSRK based usages will follow a key
        hierarchy similar to the following:
</p>
<p>
        
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                EMSK
                               /    \
                              /      \
                             /        \
                            /          \
                       DSRK1            DSRK2
                      /  \                /  \
                     /    \              /    \
               DSUSRK11  DSUSRK12  DSUSRK21  DSUSRK22
</pre></div>
<p>
</p>
      

<p> The DSRK is a USRK with a key label of "dsrk@ietf.org" and the optional data containing a domain label.
        The optional data MUST contain an ASCII string representing the key management domain that the root key is being
        derived for. The DSRK MUST be at least 64 octets long. 
</p>
<p>Domain Specific Usage Specific Root Keys (DSUSRK) are derived from the DSRK. The KDF is expected to
        give the same output for the same input. The basic key derivation function is given below.
</p>
<p>
        
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     DSUSRK = KDF(DSRK, key label | "\0" | optional data | length)</pre></div>
<p>
</p>
      

<p>The key labels are printable ASCII strings unique for each usage definition within a DSRK
        usage and are a maximum of 255 octets. In general they are of the form label-string@specorg
        where specorg is the organization that controls the specification of the usage definition of
        the DSRK. The key label is intended to provide global uniqueness. Rules for the allocation
        of these labels are given in <a class='info' href='#IANA'>Section&nbsp;8<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>. For the optional data the KDF MUST be
        capable of processing at least 2048 opaque octets. The optional data must be constant during
        the execution of the KDF. The length is a 2-octet unsigned integer in network byte order of
        the output key length in octets. An implementation of the KDF MUST be capable of producing
        at least 2048 octets of output, however it is RECOMMENDED that DSUSRKs be at least 64 octets long.
</p>
<p>Usages that make use of the DSRK must define how the peer learns the domain label to use in a
        particular derivation. A multi-domain usage must define how both DSRKs and specific DSUSRKs
        are transported to different key management domains.  Note that usages may define alternate 
        ways to constrain specific keys to particular key management domains.
</p>
<p>
        To facilitate the use of EMSKname to refer to keys derived from DSRKs, EMSKname SHOULD
        be sent along with the DSRK.  The exception is when a DSRKname is expected to be used.  The usage SHALL signal
        such an exception in key naming, so both parties know the key name used.
      
</p>
<p>DSUSRKs MAY be named explicitly with a name derivation specified as follows:
</p>
<p>
          
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     DSUSRKName =
          KDF(EMSKName,key label | "\0" | optional data | length)</pre></div>
<p>
</p>
        

<p>where length is the 2 octet unsigned integer 8 in network byte order.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Applicability of Multi-Domain usages</h3>

<p>When a DSRK is distributed to a domain the domain can generate any DSUSRKs it wishes.  This keys can be used to authorize entities in a domain to perform specific functions.  In cases where it is appropriate for only a specific domain to be authorized to perform a function the usage SHOULD NOT be defined as multi-domain.
</p>
<p>In some cases only certain domains are authorized for a particular Multi-Domain usage.  In this case domains that do not have full authorization should not receive the DSRK and should only receive DSUSRKs for the usages which they are authorized.  If it is possible for a peer to know which domains are authorized for a particular usage without relying on restricting access to the DSRK to specific domains then this recommendation may be relaxed.
</p>
<a name="usage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Requirements for Usage Definitions</h3>

<p>In order for a usage definition to meet the guidelines for USRK usage it must meet the
        following recommendations:
</p>
<p>
        </p>
<ul class="text">
<li>The usage must define if it is a domain enabled usage. 
</li>
<li>The usage definition MUST NOT use the EMSK in any other way except to derive Root Keys
            using the key derivation specified in <a class='info' href='#keyframe'>Section&nbsp;3<span> (</span><span class='info'>EMSK Key Root Derivation Framework </span><span>)</span></a> of this document. They
            MUST NOT use the EMSK directly.
</li>
<li>The usage definition SHOULD NOT require caching of the EMSK. It is RECOMMENDED that the
            Root Key derived specifically for the usage definition rather than the EMSK should be
            used to derive child keys for specific cryptographic operations.
</li>
<li>Usage definition MUST define distinct key labels and optional data used in the key
            derivation described in <a class='info' href='#keyframe'>Section&nbsp;3<span> (</span><span class='info'>EMSK Key Root Derivation Framework </span><span>)</span></a>. Usage definitions are encouraged to
            use the key name described in <a class='info' href='#keyname'>Section&nbsp;3.2<span> (</span><span class='info'>EMSK and USRK Name Derivation</span><span>)</span></a> and include
            additional data in the optional data to provide additional entropy. 
</li>
<li>Usage definitions MUST define the length of their Root Keys. It is RECOMMENDED that the
            Root Keys be at least as long as the EMSK (at least 64 octets).
</li>
<li>Usage definitions MUST define how they use their Root Keys. This includes aspects of
            key management covered in the next section on Root Key Management guidelines.
</li>
<li>
</li>
</ul><p>
      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Root Key Management Guidelines</h3>

<p>This section makes recommendations for various aspects of key management of the Root Key
          including lifetime, child key derivation, caching and transport.
</p>
<p>It is RECOMMENDED that the Root Key is only used for deriving child keys. A usage definition
          must specify how and when the derivation of child keys should be done. It is RECOMMENDED
          that usages following similar considerations for key derivation are as outlined in this
          document for the Root Key derivation with respect to cryptographic separation and key
          reuse. In addition, usages should take into consideration the number of keys that will be
          derived from the Root Key and ensure that enough entropy is introduced in the derivation
          to support this usage. It is desirable that the entropy is provided by the two parties
          that derive the child key.
</p>
<p>Root Keys' lifetimes should not be more than that of the EMSK. Thus, when the EMSK expires, the Root Keys
          derived from it should be removed from use. If a new EMSK is derived from a subsequent EAP
          transaction then a usage implementation should begin to use the new Root Keys derived from
          the new EMSK as soon as possible. Whether or not child keys associated with a Root Key are
          replaced depends on the requirements of the usage definition. It is conceivable that some
          usage definition forces the child key to be replaced and others allow child keys to be
          used based on the policy of the entities that use the child key.
</p>
<p>Recall that the EMSK never leaves the EAP peer and server. That also holds true for some
          Root Keys; however, some Root Keys may be provided to other entities for child key
          derivation and delivery. Each usage definition specification will specify delivery caching
          and/or delivery procedures. Note that the purpose of the key derivation in <a class='info' href='#keyframe'>Section&nbsp;3<span> (</span><span class='info'>EMSK Key Root Derivation Framework </span><span>)</span></a> is to ensure that Root Keys are cryptographically separate from each
          other and the EMSK. In other words, given a Root Key, it is computationally infeasible to
          derive the EMSK, any other Root Keys, or child keys associated with other Root Keys. In
          addition to the Root Key, several other parameters may need to be sent.
</p>
<p>
        Root Key names may be derived using the EAP Session ID, and thus the key name may need to be sent along
          with the key. When Root Keys are delivered to another entity, the EMSKname and the lifetime associated with
          the specific root keys MUST also be transported to that entity. Recommendations for
          transporting keys are discussed in <a class='info' href='#seckeydist'>the security considerations<span> (</span><span class='info'>Key Distribution</span><span>)</span></a>.
</p>
<p>Usage definition may also define how keys are bound to particular entities. This
          can be done through the inclusion of usage parameters and identities in the child key
          derivation. Some of this data is described as "channel bindings" in <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>.
</p>
<a name="reqeap"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Requirements for EAP System</h3>

<p>The system that wishes to make use of EAP root keys derived from the EMSK must take certain
        things into consideration. The following is a list of these considerations:
</p>
<p>
        </p>
<ul class="text">
<li>The EMSK MUST NOT be used for any other purpose than the key derivation described in
            this document.
</li>
<li>The EMSK MUST be secret and not known to someone observing the authentication mechanism
            protocol exchange.
</li>
<li>The EMSK MUST be maintained within a protected location inside the entity where it is
            generated. Only root keys derived according to this specification may be exported from
            this boundary.
</li>
<li>The EMSK MUST be unique for each EAP session
</li>
<li>The EAP method MUST provide an identifier for the EAP transaction that generated the
            key
</li>
<li>The system MUST define which usage definitions are used and how they are invoked.
</li>
<li>The system may define ways to select an alternate PRF for key derivation as defined in
              <a class='info' href='#KDF'>Section&nbsp;3.1<span> (</span><span class='info'>USRK Derivation</span><span>)</span></a>.
</li>
</ul><p>
      
</p>
<p>The system MAY use the MSK transmitted to the
        NAS in any way it chooses in accordance with <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> <a class='info' href='#I-D.ietf-eap-keying'>[I&#8209;D.ietf&#8209;eap&#8209;keying]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a>
        and other relevant specifications.  This is required
        for backward compatibility. New usage definitions following this specification MUST NOT use
        the MSK. If more than one usage uses the MSK, then the cryptographic separation is not
        achieved. Implementations MUST prevent such combinations.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Key strength</h3>

<p>The effective key strength of the derived keys will never be greater than the strength of
          the EMSK (or a master key internal to an EAP mechanism).
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Cryptographic separation of keys</h3>

<p>The intent of the KDF is to derive keys that are cryptographically separate: the
          compromise of one of the usage specific root keys (USRKs) should not compromise the
          security of other USRKs or the EMSK. It is believed that the KDF chosen provides the
          desired separation.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Implementation</h3>

<p>An implementation of an EAP framework should keep the EMSK internally as close to where
          it is derived as possible and only provide an interface for obtaining Root Keys. It may
          also choose to restrict which callers have access to which keys. A usage definition MUST
          NOT assume that any entity outside the EAP server or EAP peer EAP framework has access to
          the EMSK. In particular it MUST NOT assume that a lower layer has access to the EMSK.
</p>
<a name="seckeydist"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Key Distribution</h3>

<p>In some cases it will be necessary or convenient to distribute USRKs from where they are
          generated. Since these are secret keys they MUST be transported with their integrity and
          confidentiality maintained. They MUST be transmitted between authenticated and authorized
          parties. It is also important that the context of the key usage be transmitted along with
          the key. This includes information to identify the key and constraints on its usage such
          as lifetime.
</p>
<p>This document does not define a mechanism for key transport. It is up to usage
          definitions and the systems that use them to define how keys are distributed. Usage
          definition designers may enforce constraints on key usage by various parties by deriving a
          key hierarchy and by providing entities only with the keys in the hierarchy that they
          need.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Key Lifetime</h3>

<p>The key lifetime is dependent upon how the key is generated and how the key is used.
          Since the Root Key is the responsibility of the usage definition it must determine how
          long the key is valid for. If key lifetime or key strength information is available from
          the authenticated key exchange then this information SHOULD be used in determining the
          lifetime of the key. If possible it is recommended that key lifetimes be coordinated
          throughout the system. Setting a key lifetime shorter that a system lifetime may result is
          keys becoming invalid with no convenient way to refresh them. Setting a key lifetime to
          longer may result in decreased security since the key may be used beyond its recommended
          lifetime.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
Entropy consideration</h3>

<p>The number of root keys derived from the EMSK is expected to be low. Note that there is
          no randomness required to be introduced into the EMSK to root key derivation beyond the
          root key labels. Thus, if many keys are going to be derived from an Root Key it is
          important that Root Key to child key derivation introduce fresh random numbers in deriving
          each key.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>The keywords "Private Use", "Specification Required" and "IETF Consensus" that appear in
        this document when used to describe namespace allocation are to be interpreted as described
        in <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Key Labels</h3>

<p>
        This specification introduces a new name space for "USRK key labels".
        Key labels MUST be printable US-ASCII strings, and MUST NOT
        contain the characters at-sign ("@") except as noted below,
        comma (","), whitespace,
        control characters (ASCII codes 32 or less), or the ASCII code 127 (DEL).
        Labels are case-sensitive, and MUST NOT be longer than 64 characters.
        
</p>
<p>
        Labels can be assigned based on Specification Required policy <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
        In addition, the labels "experimental1" and "experimental2" are
        reserved for experimental use. The following considerations apply
        to their use:
        
</p>
<p>
        Production networks do not necessarily support the use of
        experimental code points. The network scope of support
        for experimental values should carefully be evaluated before
        deploying any experiment across extended network domains,
        such as the public Internet. The potential to disrupt the
        stable operation of EAP devices is a consideration when
        planning an experiment using such code points.
        
</p>
<p>
        The network administrators should ensure that each code
        point is used consistently to avoid interference between
        experiments. Particular attention should be given to
        security vulnerabilities and the freedom of different domains
        to employ their own experiments. Cross-domain usage is
        NOT RECOMMENDED.
        
</p>
<p>
        Similarly, labels "private1" and "private2" have been reserved
        for Private Use within an organization. Again, cross-domain usage
        of these labels is NOT RECOMMENDED.
        
</p>
<p>
        Labels starting with a string and followed by the "@" and a valid, fully
        qualified Internet domain name [RFC1034] can be requested by
        by the person or organization who are in control of the domain name.
          Such labels can be allocated based on Expert Review with Specification Required.
          Besides the review needed for Specification Required (see Section 4.1 of <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>),
          the expert needs to review the proposed usage for conformance to this specification,
          including the suitability of the usage according to the applicability statement
          outlined in <a class='info' href='#applicability'>Section&nbsp;1.1<span> (</span><span class='info'>Applicable usages of keys derived from the EMSK</span><span>)</span></a>.
          
         It is RECOMMENDED that the specification
          contain the following information: 
        
</p>
<p>
          </p>
<ul class="text">
<li>A description of the usage
</li>
<li>The key label to be used
</li>
<li>Length of the Root Key
</li>
<li>If optional data is used, what it is and how it is maintained
</li>
<li>How child keys will be derived from the Root Key and how they will be used
</li>
<li>How lifetime of the Root Key and its child keys will be managed
</li>
<li>Where the Root Keys or child keys will be used and how they are communicated if
              necessary
</li>
</ul><p>
        
</p>
<p>The following labels are reserved by this document: "EMSK", "dsrk@ietf.org".
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
PRF numbers</h3>

<p>This specification introduces a new number space for "EMSK PRF numbers". The numbers are
          int he range 0 to 255 Numbers from 0 to 220 are assigned through the policy IETF Consensus
          and numbers in the range 221 to 255 are left for Private Use. The initial registry should
          contain the following values:
</p>
<p>
          </p>
<blockquote class="text">
<p>0 RESERVED
</p>
<p>1 HMAC-SHA-256 PRF+ (Default)
</p>
</blockquote><p>
        
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>This document expands upon previous collaboration with Pasi Eronen. This document reflects
        conversations with Bernard Aboba, Jari Arkko, Avi Lior, David McGrew, Henry Haverinen, Hao
        Zhou, Russ Housley, Glen Zorn, Charles Clancy, Dan Harkins, Alan DeKok, Yoshi Ohba and members of the EAP and
        HOKEY working groups.
</p>
<p>Thanks to Dan Harkins for the idea of using a single root key name to refer to all keys.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-eap-keying">[I-D.ietf-eap-keying]</a></td>
<td class="author-text">Aboba, B., Simon, D., and P. Eronen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-eap-keying-22.txt">Extensible Authentication Protocol (EAP) Key Management Framework</a>,&rdquo; draft-ietf-eap-keying-22 (work in progress), November&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-eap-keying-22.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SHA256">[SHA256]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; FIPS&nbsp;180-2, August&nbsp;2002.<p>
With Change Notice 1 dated February 2004
</p>
</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0822">[RFC0822]</a></td>
<td class="author-text"><a href="mailto:DCrocker@UDel-Relay">Crocker, D.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc822">Standard for the format of ARPA Internet text messages</a>,&rdquo; STD&nbsp;11, RFC&nbsp;822, August&nbsp;1982 (<a href="http://www.rfc-editor.org/rfc/rfc822.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4282">[RFC4282]</a></td>
<td class="author-text">Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc4282">The Network Access Identifier</a>,&rdquo; RFC&nbsp;4282, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4282.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIGMA">[SIGMA]</a></td>
<td class="author-text">Krawczyk, H., &ldquo;<a href="http://www.informatik.uni-trier.de/~ley/db/conf/crypto/crypto2003.html">SIGMA: the 'SIGn-and-MAc' Approach to Authenticated Diffie-Hellman and its Use in
            the IKE Protocols</a>,&rdquo; LNCS&nbsp;2729, &nbsp;Springer, 2003.<p>
Available at
          http://www.informatik.uni-trier.de/~ley/db/conf/crypto/crypto2003.html
</p>
</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lakshminath Dondeti</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Qualcomm, Inc</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ldondeti@qualcomm.com">ldondeti@qualcomm.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vidya Narayanan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Qualcomm, Inc</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:vidyan@qualcomm.com">vidyan@qualcomm.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Madjid Nakhjiri</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Motorola</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:madjid.nakhjiri@motorola.com">madjid.nakhjiri@motorola.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
