<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Ethernet Tag ID Usage Update for Ethernet A-D per EVI Route</title>
<meta content="Yubao Wang" name="author">
<meta content="
       
   This draft discusses the issues with several service interfaces of L3 EVIs.
   Then it proposes an extension to   and   
   to do ARP synchronizing and IP aliasing for Layer 3 routes that is needed for L3-EVIs to
   build a complete IP ECMP.  It also introduced two new EVPN Service Interfaces for EVPN VPLS services 
   and an extension of AC-ID extended community to improve ARP/ND Probing upon remote PE failures.
       
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="EVPN, Ethernet Tag, ET-ID, ESI, AC-aware, VLAN-based, Service Interface" name="keyword">
<meta content="draft-wang-bess-evpn-ether-tag-id-usage-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-wang-bess-evpn-ether-tag-id-usage-03-rhp5hgsd.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ET-ID Usage Update</td>
<td class="right">August 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wang</td>
<td class="center">Expires 27 February 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">BESS WG</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-08-26" class="published">26 August 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-02-27">27 February 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Wang</div>
<div class="org">ZTE Corporation</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Ethernet Tag ID Usage Update for Ethernet A-D per EVI Route</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
   This draft discusses the issues with several service interfaces of L3 EVIs.
   Then it proposes an extension to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span> and <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span> 
   to do ARP synchronizing and IP aliasing for Layer 3 routes that is needed for L3-EVIs to
   build a complete IP ECMP.  It also introduced two new EVPN Service Interfaces for EVPN VPLS services 
   and an extension of AC-ID extended community to improve ARP/ND Probing upon remote PE failures.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 February 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-service-interfaces-of-l3-ev" class="xref">Service Interfaces of L3 EVIs</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="xref">1.1.1</a>.  <a href="#name-irb-service-interface" class="xref">IRB Service Interface</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="xref">1.1.2</a>.  <a href="#name-mono-vlan-based-service-int" class="xref">Mono VLAN-based Service Interface</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.1.2.3">
                    <p id="section-toc.1-1.1.2.1.2.3.1" class="keepWithNext"><a href="#section-1.1.3" class="xref">1.1.3</a>.  <a href="#name-multiple-vlan-based-service" class="xref">Multiple VLAN-based Service Interface</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.1.2.4">
                    <p id="section-toc.1-1.1.2.1.2.4.1"><a href="#section-1.1.4" class="xref">1.1.4</a>.  <a href="#name-vlan-bundle-service-interfa" class="xref">VLAN-bundle Service Interface</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.1.2.5">
                    <p id="section-toc.1-1.1.2.1.2.5.1"><a href="#section-1.1.5" class="xref">1.1.5</a>.  <a href="#name-shared-risk-vlan-bundle-ser" class="xref">Shared Risk VLAN-bundle Service Interface</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.1.2.6">
                    <p id="section-toc.1-1.1.2.1.2.6.1"><a href="#section-1.1.6" class="xref">1.1.6</a>.  <a href="#name-integrated-routing-and-cros" class="xref">Integrated Routing and Cross-connecting Service Interface</a></p>
</li>
                </ul>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-new-service-interfaces-of-l" class="xref">New Service Interfaces of L2 EVIs</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.2.2.1">
                    <p id="section-toc.1-1.1.2.2.2.1.1"><a href="#section-1.2.1" class="xref">1.2.1</a>.  <a href="#name-multiple-vlan-based-acs-of-" class="xref">Multiple VLAN-based ACs of the Same BD</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.2.2.1.2.1">
                        <p id="section-toc.1-1.1.2.2.2.1.2.1.1"><a href="#section-1.2.1.1" class="xref">1.2.1.1</a>.  <a href="#name-attaching-these-acs-to-an-e" class="xref">Attaching these ACs to an ETI-Specific BD</a></p>
</li>
                      <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.2.2.1.2.2">
                        <p id="section-toc.1-1.1.2.2.2.1.2.2.1"><a href="#section-1.2.1.2" class="xref">1.2.1.2</a>.  <a href="#name-attaching-these-acs-to-an-et" class="xref">Attaching these ACs to an ETI-Agnostic BD</a></p>
</li>
                    </ul>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.2.2.2">
                    <p id="section-toc.1-1.1.2.2.2.2.1"><a href="#section-1.2.2" class="xref">1.2.2</a>.  <a href="#name-separated-risk-vlan-bundle-a" class="xref">Separated Risk VLAN-bundle AC</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.2.2.2.2.1">
                        <p id="section-toc.1-1.1.2.2.2.2.2.1.1"><a href="#section-1.2.2.1" class="xref">1.2.2.1</a>.  <a href="#name-dedicating-such-ac-to-a-sin" class="xref">Dedicating Such AC to a Single ETI-Specific BD</a></p>
</li>
                      <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.2.2.2.2.2">
                        <p id="section-toc.1-1.1.2.2.2.2.2.2.1"><a href="#section-1.2.2.2" class="xref">1.2.2.2</a>.  <a href="#name-attaching-such-ac-to-an-eti" class="xref">Attaching Such AC to an ETI-Agnostic BD</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-terminology-and-acronyms" class="xref">Terminology and Acronyms</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-problem-statement" class="xref">Problem Statement</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-problem-with-multiple-vlan-" class="xref">Problem with Multiple VLAN-based L3SI</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-problem-with-irb-service-in" class="xref">Problem with IRB Service Interface</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-problem-with-multipe-vlans-" class="xref">Problem with Multipe VLANs of a Single BD</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="xref">2.3.1</a>.  <a href="#name-problem-with-multipe-vlan-b" class="xref">Problem with Multipe VLAN-based L2SI</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="xref">2.3.2</a>.  <a href="#name-problem-with-separated-risk" class="xref">Problem with Separated Risk VLAN-bundle of a BD</a></p>
</li>
                </ul>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-problem-with-bump-in-the-wi" class="xref">Problem with Bump-in-the-wire Use-Case</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-problem-with-arp-nd-probing" class="xref">Problem with ARP/ND Probing upon Remote PE Failure</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-solutions" class="xref">Solutions</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-ethernet-auto-discovery-mod" class="xref">Ethernet Auto-Discovery modes</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-bdi-specific-ead-vs-aci-spe" class="xref">BDI-Specific EAD vs ACI-Specific EAD</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-use-cases-and-their-et-ids-" class="xref">Use Cases and their ET-IDs and AC-IDs</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.2.2.1">
                        <p id="section-toc.1-1.3.2.1.2.2.2.1.1"><a href="#section-3.1.2.1" class="xref">3.1.2.1</a>.  <a href="#name-eti-aci-combinations-for-l2" class="xref">ETI-ACI Combinations for L2EVI Use Cases</a></p>
</li>
                      <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.2.2.2">
                        <p id="section-toc.1-1.3.2.1.2.2.2.2.1"><a href="#section-3.1.2.2" class="xref">3.1.2.2</a>.  <a href="#name-eti-aci-combinations-for-ev" class="xref">ETI-ACI Combinations for EVPN IRB Use Cases</a></p>
</li>
                      <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.2.2.3">
                        <p id="section-toc.1-1.3.2.1.2.2.2.3.1"><a href="#section-3.1.2.3" class="xref">3.1.2.3</a>.  <a href="#name-eti-aci-combinations-for-l3" class="xref">ETI-ACI Combinations for L3EVI Use Cases</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-determining-the-aliasing-pa" class="xref">Determining the Aliasing Pathes for RT-5E/RT-2R</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-aci-specific-overlay-index-" class="xref">ACI-specific Overlay Index Extended Community</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-arp-nd-synching-and-ip-alia" class="xref">ARP/ND Synching and IP Aliasing</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-constructing-mac-ip-adverti" class="xref">Constructing MAC/IP Advertisement Route</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-constructing-ip-ad-evi-rout" class="xref">Constructing IP-AD/EVI Route</a></p>
</li>
                </ul>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-constructing-ip-prefix-adve" class="xref">Constructing IP Prefix Advertisement Route</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-secenario-specific-procedur" class="xref">Secenario-Specific Procedures</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="xref">3.6.1</a>.  <a href="#name-evpn-irb-specific-procedure" class="xref">EVPN-IRB Specific Procedures</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="xref">3.6.2</a>.  <a href="#name-on-separated-risk-vlan-bund" class="xref">On Separated Risk VLAN-bundle of the same BD</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a href="#section-3.6.3" class="xref">3.6.3</a>.  <a href="#name-on-multiple-vlan-based-acs-" class="xref">On Multiple VLAN-based ACs of the same BD</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.6.2.4">
                    <p id="section-toc.1-1.3.2.6.2.4.1"><a href="#section-3.6.4" class="xref">3.6.4</a>.  <a href="#name-bump-in-the-wire-specific-p" class="xref">Bump-in-the-wire Specific Procedures</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.6.2.5">
                    <p id="section-toc.1-1.3.2.6.2.5.1"><a href="#section-3.6.5" class="xref">3.6.5</a>.  <a href="#name-arp-nd-probing-specific-pro" class="xref">ARP/ND Probing Specific Procedures</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-explanation-for-physical-li" class="xref">Explanation for Physical Links of the Use-cases</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-failure-detections-for-p12-" class="xref">Failure Detections for P1.2 (or P2.1)</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-protection-approaches-for-n" class="xref">Protection Approaches for N1 (or N2)</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#appendix-A.2.1" class="xref">A.2.1</a>.  <a href="#name-ccc-approaches" class="xref">CCC-Approaches</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7.2.2.2.1.2.1">
                        <p id="section-toc.1-1.7.2.2.2.1.2.1.1"><a href="#appendix-A.2.1.1" class="xref">A.2.1.1</a>.  <a href="#name-ccc-active-active-protectio" class="xref">CCC Active-Active Protection</a></p>
</li>
                      <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7.2.2.2.1.2.2">
                        <p id="section-toc.1-1.7.2.2.2.1.2.2.1"><a href="#appendix-A.2.1.2" class="xref">A.2.1.2</a>.  <a href="#name-ccc-active-standby-protecti" class="xref">CCC Active-Standby Protection</a></p>
</li>
                    </ul>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#appendix-A.2.2" class="xref">A.2.2</a>.  <a href="#name-vsi-approaches" class="xref">VSI-Approaches</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduce">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">In <span>[<a href="#I-D.wang-bess-evpn-arp-nd-synch-without-irb" class="xref">I-D.wang-bess-evpn-arp-nd-synch-without-irb</a>]</span> section 5.1, the ESI of IP-VRF ACs are advertised as Overlay index of IP forwarding.
   But in IP-VRF context, the Ethernet A-D per EVI routes of the same ESI 
   are more easier to conflict with each other, 
   when they are imported into the same IP-VRF.
   This document discribes three secenarios of such kind. 
   Then it discribes the solutions of them.
   These solutions all need an extension for the Ethernet Tag ID of the Ethernet A-D per EVI routes.
   Then this draft proposes two new Service Interfaces for EVPN VPLS services, 
   they are Multiple VLAN-based ACs of the Same BD and Dedicating all VLANs of Separated Risk VLAN-bundle AC to a single BD  .
   When different VLANs on the same ES of the same Broadcast Domain can fail independently, 
   these two service interfaces will work better than VLAN-bundle and VLAN-aware bundle service interface.<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="sect-L3EVIs">
<section id="section-1.1">
        <h3 id="name-service-interfaces-of-l3-ev">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-service-interfaces-of-l3-ev" class="section-name selfRef">Service Interfaces of L3 EVIs</a>
        </h3>
<p id="section-1.1-1">The detailed explanation of this network's physical links 
   are described in <a href="#Fig-PhyLinks" class="xref">Figure 12</a> and <a href="#Sect-appendix-PL-Explain" class="xref">Appendix A</a>.
   But the network's EVCs (Ethernet Virtual Connections, which are typically established per &lt;Port, VLAN&gt; basis)
   is illustrated in the following sections per each Service Interface.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Ethernet segment ES1 is the ethernet segment of P1 and P2 of <a href="#Fig-PhyLinks" class="xref">Figure 12</a>, and its ESI is ESI21.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<div id="sect-L3SI-IRB">
<section id="section-1.1.1">
          <h4 id="name-irb-service-interface">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-irb-service-interface" class="section-name selfRef">IRB Service Interface</a>
          </h4>
<p id="section-1.1.1-1">The L3 EVI service interface per <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span> is called as IRB Service Interface in this draft.<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-SI-MonoVLAN">
<section id="section-1.1.2">
          <h4 id="name-mono-vlan-based-service-int">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-mono-vlan-based-service-int" class="section-name selfRef">Mono VLAN-based Service Interface</a>
          </h4>
<span id="name-mono-vlan-based-s-i"></span><div id="Fig-SI-MonoVLAN">
<figure id="figure-1">
            <div class="artwork art-text alignLeft" id="section-1.1.2-1.1">
<pre>
                                +-------------------+
   PNEC1                PE1     |                   |
+---------+          +----------+--------+          |
|         |          |  __(P1.1)__(VPNx) |          |
|      "  |   P1     | /                 |          |
|      #==============&lt;                  |          | PE3
|      "  |  ESI21   | \__      __       |     +----+----+
| N1+--+  |    +     |    (P1.2)  (VPNy) |     |         |
|      "  |    |     +-----------+-------+     |  (VPNx)---+N3
|      "  |    |                 |             |         |
|      "  |    |                 |             |         |
|      "  |    |        PE2      |             |         |
|      "  |    |     +-----------+-------+     |  (VPNy)---+N5
| N2+--"  |    +     |  __(P2.2)__(VPNy) |     |         |
|      "  |  ESI21   | /                 |     +----+----+
|      #==============&lt;                  |          |
|      "  |   P2     | \__      __       |          |
|         |          |    (P2.1)  (VPNx) |          |
+---------+          +----------+--------+          |
                                |                   |
                                +-------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-mono-vlan-based-s-i" class="selfRef">Mono VLAN-Based S-I</a>
            </figcaption></figure>
</div>
<p id="section-1.1.2-2">In this service interface, each ESI can have no more than one of its VLANs attached to a specified EVPN Instance.<a href="#section-1.1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.1.2-3">Take above figure for example, P1.1 and P1.2 are two subinterfaces of the same ESI,
 and &lt;ESI21, VPNx&gt; is Mono VLAN-based service interface, thus P1.1 and P1.2 can't be attached to the same EVPN Instance.
 Actually, P1.1 are attached to VPNx, while P1.2 are attached to VPNy.<a href="#section-1.1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.1.2-4">
   Note that There are no MAC-VRF or IRB interface on
   PE1/PE2/PE3 in this case.  Thus the IP-VRFs are called as EVPN instance
   instead.  Such EVPN instance can be called EVPN signalled L3VPN or
   L3EVI for short.<a href="#section-1.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-SI-MultiVLAN">
<section id="section-1.1.3">
          <h4 id="name-multiple-vlan-based-service">
<a href="#section-1.1.3" class="section-number selfRef">1.1.3. </a><a href="#name-multiple-vlan-based-service" class="section-name selfRef">Multiple VLAN-based Service Interface</a>
          </h4>
<span id="name-multiple-vlan-based-s-i"></span><div id="Fig-SI-MultiVLAN">
<figure id="figure-2">
            <div class="artwork art-text alignLeft" id="section-1.1.3-1.1">
<pre>
                            +-----------------------+
   PNEC1              PE1   |                       |
+---------+         +-------+------+                |
|         |         |  __(P1.1)    |                |
|      "  |         | /        \   |                |
|      #=============&lt;      (VPN1) |                | PE3
|      "  |  ESI21  | \__      /   |           +----+----+
| N1+--"  |    +    |    (P1.2)    |           |         |
|      "  |    |    +--------+-----+           |         |
|      "  |    |             |                 |         |
|      "  |    |             |                 | (VPN1)----+N3
|      "  |    |      PE2    |                 |         |
|      "  |    |    +--------+-----+           |         |
| N2+--"  |    +    |  __(P2.2)    |           |         |
|      "  |  ESI21  | /        \   |           +----+----+
|      #=============&lt;      (VPN1) |                |
|      "  |         | \__      /   |                |
|         |         |    (P2.1)    |                |
+---------+         +-------+------+                |
                            |                       |
                            +-----------------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-multiple-vlan-based-s-i" class="selfRef">Multiple VLAN-based S-I</a>
            </figcaption></figure>
</div>
<p id="section-1.1.3-2">This network is similar to <a href="#Fig-SI-MonoVLAN" class="xref">Figure 1</a> with a few notable exceptions as below: 
   The L3EVIs VPNx and VPNy there are the same L3EVI (VPN1) here. 
   So two of PE1's VPN1's ACs are both subinterfaces (P1.1 and P1.2) of the same ESI (ESI23).<a href="#section-1.1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.1.3-3">Note that P1.1 is the gateway of N1, while P1.2 is the gateway of N2.
   N1 and N2 are just not in the same subnets.<a href="#section-1.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-SI-SperateBundle">
<section id="section-1.1.4">
          <h4 id="name-vlan-bundle-service-interfa">
<a href="#section-1.1.4" class="section-number selfRef">1.1.4. </a><a href="#name-vlan-bundle-service-interfa" class="section-name selfRef">VLAN-bundle Service Interface</a>
          </h4>
<p id="section-1.1.4-1">When two VLANs of the same ES shares the same Gateway IP address of the same EVPN,
   These two VLANs can be configured into the same subinterface of that ES.
   This is VLAN-bundle service interface.<a href="#section-1.1.4-1" class="pilcrow">¶</a></p>
<span id="name-separated-risk-vlan-bundle-"></span><div id="Fig-SI-SperateBundle">
<figure id="figure-3">
            <div class="artwork art-text alignLeft" id="section-1.1.4-2.1">
<pre>
                            +-----------------------+
   PNEC1              PE1   |                       |
+---------+         +-------+-------------+         |
|         |         |                     |         |
|      "  |         | (P1.1)   AC1        |         |
|      #=============&lt;      &gt;======(VPN1) |         | PE3
|      "  |  ESI21  | (P1.2)              |    +----+----+
| N1+--"  |    +    |                     |    |         |
|      "  |    |    +--------+------------+    |         |
|      "  |    |             |                 |         |
|      "  |    |             |                 | (VPN1)----+N3
|      "  |    |      PE2    |                 |         |
|      "  |    |    +--------+------------+    |         |
| N2+--"  |    +    |                     |    |         |
|      "  |  ESI21  | (P2.1)   AC2        |    +----+----+
|      #=============&lt;      &gt;======(VPN1) |         |
|      "  |         | (P2.2)              |         |
|         |         |                     |         |
+---------+         +-------+-------------+         |
                            |                       |
                            +-----------------------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-separated-risk-vlan-bundle-" class="selfRef">Separated Risk VLAN-Bundle S-I</a>
            </figcaption></figure>
</div>
<p id="section-1.1.4-3">This network is similar to <a href="#Fig-SI-MultiVLAN" class="xref">Figure 2</a> with a few notable exceptions as below.
   P1.1 and P1.2 are aggregated into the same subinterface (that is AC1).
   It is AC1 that is attached to VPN1.<a href="#section-1.1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.1.4-4">Note that although P1.1 and P1.2 are aggregated into the same subinterface AC1,
   when &lt;P1, VLAN 1&gt;(P1.1) fails, &lt;P1, VLAN 1&gt;(P1.2) may not fail.
   Thus we say that AC1 are configured with Separated Risk VLAN-Bundle.<a href="#section-1.1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.1.4-5">Note that VLAN-bundle Service Interface is actually Separated Risk VLAN-Bundle Service Inerface.<a href="#section-1.1.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-L3SI-SharedBundle">
<section id="section-1.1.5">
          <h4 id="name-shared-risk-vlan-bundle-ser">
<a href="#section-1.1.5" class="section-number selfRef">1.1.5. </a><a href="#name-shared-risk-vlan-bundle-ser" class="section-name selfRef">Shared Risk VLAN-bundle Service Interface</a>
          </h4>
<p id="section-1.1.5-1">There may be other network which is similar to <a href="#sect-SI-SperateBundle" class="xref">Section 1.1.4</a>, 
   except for that the VLAN-bundle of AC1 is Shared Risk VLAN-bundle, not Separated Risk VLAN-bundle.<a href="#section-1.1.5-1" class="pilcrow">¶</a></p>
<p id="section-1.1.5-2">When we say subinterface AC1 is of Shared Risk VLAN-bundle, 
   we are saying that when an event result in P1.1's failure, that event will also result in P1.2's failure.<a href="#section-1.1.5-2" class="pilcrow">¶</a></p>
<p id="section-1.1.5-3">When AC1 is of Shared Risk VLAN-bundle, we say that &lt;ESI21, VPN1&gt; is Shared Risk VLAN-bundle service interface.<a href="#section-1.1.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-L3SI-IRC">
<section id="section-1.1.6">
          <h4 id="name-integrated-routing-and-cros">
<a href="#section-1.1.6" class="section-number selfRef">1.1.6. </a><a href="#name-integrated-routing-and-cros" class="section-name selfRef">Integrated Routing and Cross-connecting Service Interface</a>
          </h4>
<p id="section-1.1.6-1">The service interface in <span>[<a href="#I-D.wz-bess-evpn-vpws-as-vrf-ac" class="xref">I-D.wz-bess-evpn-vpws-as-vrf-ac</a>]</span> can be called as IRC (Ingegrated Routing and Cross-connecting) Service Interface.<a href="#section-1.1.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-L2EVIs">
<section id="section-1.2">
        <h3 id="name-new-service-interfaces-of-l">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-new-service-interfaces-of-l" class="section-name selfRef">New Service Interfaces of L2 EVIs</a>
        </h3>
<p id="section-1.2-1">The detailed explanation of this network's physical links 
   are described in <a href="#Fig-PhyLinks" class="xref">Figure 12</a> and <a href="#Sect-appendix-PL-Explain" class="xref">Appendix A</a>.
   But the network's EVCs (Ethernet Virtual Connections, which are typically established per &lt;Port, VLAN&gt; basis)
   is illustrated in the following sections per each Service Interface.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Ethernet segment ES1 is the ethernet segment of P1 and P2 of <a href="#Fig-PhyLinks" class="xref">Figure 12</a>, and its ESI is ESI21.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<div id="sect-L2SI-MultiVLAN">
<section id="section-1.2.1">
          <h4 id="name-multiple-vlan-based-acs-of-">
<a href="#section-1.2.1" class="section-number selfRef">1.2.1. </a><a href="#name-multiple-vlan-based-acs-of-" class="section-name selfRef">Multiple VLAN-based ACs of the Same BD</a>
          </h4>
<span id="name-multiple-vlan-based-s-i-2"></span><div id="Fig-L2SI-MultiVLAN">
<figure id="figure-4">
            <div class="artwork art-text alignLeft" id="section-1.2.1-1.1">
<pre>
                            +-----------------------+
   PNEC1              PE1   |                       |
+---------+         +-------+------+                |
|         |         |  __(P1.1)    |                |
|      "  |         | /        \   |                |
|      #=============&lt;     (BD100) |                | PE3
|      "  |  ESI21  | \__      /   |           +----+----+
| N1+--"  |    +    |    (P1.2)    |           |         |
|      "  |    |    +--------+-----+           |         |
|      "  |    |             |                 |         |
|      "  |    |             |                 | (BD100)---+N3
|      "  |    |      PE2    |                 |         |
|      "  |    |    +--------+-----+           |         |
| N2+--"  |    +    |  __(P2.2)    |           |         |
|      "  |  ESI21  | /        \   |           +----+----+
|      #=============&lt;     (BD100) |                |
|      "  |         | \__      /   |                |
|         |         |    (P2.1)    |                |
+---------+         +-------+------+                |
                            |                       |
                            +-----------------------+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-multiple-vlan-based-s-i-2" class="selfRef">Multiple VLAN-based S-I</a>
            </figcaption></figure>
</div>
<p id="section-1.2.1-2">This network is similar to <a href="#Fig-SI-MultiVLAN" class="xref">Figure 2</a> with a few notable exceptions as below: 
   The EVI there (VPN1) is a L3 EVI, but the EVI here is a L2 EVI (one of whose BDs is BD100).<a href="#section-1.2.1-2" class="pilcrow">¶</a></p>
<p id="section-1.2.1-3">Note that P1.1 and P1.2 are two ACs of BD100.
   thus they are two subinterfaces of the same ESI (ESI21) and the same BD.<a href="#section-1.2.1-3" class="pilcrow">¶</a></p>
<div id="sect-L2SI-MultiVLAN-ETI-Specific">
<section id="section-1.2.1.1">
            <h5 id="name-attaching-these-acs-to-an-e">
<a href="#section-1.2.1.1" class="section-number selfRef">1.2.1.1. </a><a href="#name-attaching-these-acs-to-an-e" class="section-name selfRef">Attaching these ACs to an ETI-Specific BD</a>
            </h5>
<p id="section-1.2.1.1-1">A Broadcast Domain (BD) whose data packets can be received along with any Ethernet Tag ID (ETI).
   When an EVPN Instance (EVI) can have multiple broadcast domains (BDs),
   every BD of that EVI Instance will be called as an ETI-specific BD in this draft.<a href="#section-1.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.2.1.1-2">
   An ETI-Specific BD is identified by an ET-ID in the context of that EVI.
   That ET-ID are called as that ETI-Specific BD's BD-ID in this draft.
   That is to say, all MAC entries of that ETI-Specific BD are in a MAC-space identified by that BD-ID.
   Thus the ET-ID fields of the RT-2 routes of these MAC entries will all be set to the value of that BD-ID.
   That's why the BD-ID is also called as the normalized ET-ID of that BD.<a href="#section-1.2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.2.1.1-3">Although the VLANs of P1.1 and P1.2 are different,
   when P1.1 and P1.2 are configured with the same normalized ET-ID,
   they will belong to the same ETI-specific BD whose BD-ID is that normalized ET-ID.<a href="#section-1.2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.2.1.1-4">If a BD is an ETI-Specific BD,
   when we say that an AC is attached to that BD, 
   we means that the AC is attached to the EVI of that BD,
   and the normalized ET-ID of that AC is configured with the BD-ID of that BD.<a href="#section-1.2.1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.2.1.1-5">So we assign the same normalized ET-ID (say ET-ID 100) to P1.1, P1.2, P2.1 and P2.2.
   As a result of that, and according to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>,
   the Ethernet A-D per EVI routes for P1.1 and P1.2 will be the same (say R1_100_P1b),
   the Ethernet A-D per EVI routes for P2.1 and P2.2 will be the same (say R1_100_P2b).
   The ET-IDs of R1_100_P1b and R1_100_P2b will be the same ET-ID 100.<a href="#section-1.2.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-L2SI-MultiVLAN-ETI-Agnostic">
<section id="section-1.2.1.2">
            <h5 id="name-attaching-these-acs-to-an-et">
<a href="#section-1.2.1.2" class="section-number selfRef">1.2.1.2. </a><a href="#name-attaching-these-acs-to-an-et" class="section-name selfRef">Attaching these ACs to an ETI-Agnostic BD</a>
            </h5>
<p id="section-1.2.1.2-1">When an EVPN Instance (EVI) can only have one broadcast domain (BD),
   the only BD of that EVI Instance will be called as an ETI-Agnostic BD in this draft.
   A broadcast domain of a L2 EVI of VLAN-based service interface is a good example of an ETI-Agnostic BD.<a href="#section-1.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2.1.2-2">
   If a BD is an ETI-Agnostic BD,
   when we say that an AC is attached to that BD, we means that the AC is attached to the EVI of that BD. 
   The ET-ID fields of the RT-2 routes of all MAC entries of a ETI-Agnostic BD will always be zero.<a href="#section-1.2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2.1.2-3">When P1.1, P1.2, P2.1 and P2.2 are attched to an ETI-agnostic BD,
   according to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>,
   the Ethernet A-D per EVI routes for P1.1 and P1.2 will be the same (say R1_100_P1c),
   the Ethernet A-D per EVI routes for P2.1 and P2.2 will be the same (say R1_100_P2c).
   The ET-IDs of R1_100_P1c and R1_100_P2c will both be the same value (that's zero) too.<a href="#section-1.2.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-L2SI-SperatedBundle">
<section id="section-1.2.2">
          <h4 id="name-separated-risk-vlan-bundle-a">
<a href="#section-1.2.2" class="section-number selfRef">1.2.2. </a><a href="#name-separated-risk-vlan-bundle-a" class="section-name selfRef">Separated Risk VLAN-bundle AC</a>
          </h4>
<p id="section-1.2.2-1">Although P1.1 and P1.2 can be aggregated into a single subinterface, this can't change
   the fact that they don't share the same risks.  When the physical
   interface P3 (see <a href="#Fig-PhyLinks" class="xref">Figure 12</a>) fails, one of them will fail, while the
   other will continue to work well.<a href="#section-1.2.2-1" class="pilcrow">¶</a></p>
<span id="name-separated-risk-vlan-bundle-s"></span><div id="Fig-L2SI-SperatedBundle">
<figure id="figure-5">
            <div class="artwork art-text alignLeft" id="section-1.2.2-2.1">
<pre>
                            +-----------------------+
   PNEC1              PE1   |                       |
+---------+         +-------+-------------+         |
|         |         |                     |         |
|      "  |         | (P1.1)   AC1        |         |
|      #=============&lt;      &gt;=====(BD100) |         | PE3
|      "  |  ESI21  | (P1.2)              |    +----+----+
| N1+--"  |    +    |                     |    |         |
|      "  |    |    +--------+------------+    |         |
|      "  |    |             |                 |         |
|      "  |    |             |                 | (BD100)---+N3
|      "  |    |      PE2    |                 |         |
|      "  |    |    +--------+------------+    |         |
| N2+--"  |    +    |                     |    |         |
|      "  |  ESI21  | (P2.1)   AC2        |    +----+----+
|      #=============&lt;      &gt;=====(BD100) |         |
|      "  |         | (P2.2)              |         |
|         |         |                     |         |
+---------+         +-------+-------------+         |
                            |                       |
                            +-----------------------+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-separated-risk-vlan-bundle-s" class="selfRef">Separated Risk VLAN-Bundle S-I</a>
            </figcaption></figure>
</div>
<p id="section-1.2.2-3">This network is similar to <a href="#Fig-L2SI-MultiVLAN" class="xref">Figure 4</a> with a few notable exceptions as below.
   P1.1 and P1.2 are aggregated into the same subinterface (that is AC1).
   Now it is AC1 that is attached to VPN1, not P1.1 or P1.2.<a href="#section-1.2.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2.2-4">Note that although P1.1 and P1.2 are aggregated into the same subinterface AC1,
   when &lt;P1, VLAN 1&gt;(P1.1) fails, &lt;P1, VLAN 1&gt;(P1.2) may not fail.
   Thus we say that AC1 are configured as Separated Risk VLAN-Bundle Service Interface.<a href="#section-1.2.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2.2-5">Note that VLAN-bundle Service Interface of [RFC7432] is actually Shared Risk VLAN-Bundle Service Inerface.<a href="#section-1.2.2-5" class="pilcrow">¶</a></p>
<div id="sect-L2SI-SperatedBundle-ETI-X">
<section id="section-1.2.2.1">
            <h5 id="name-dedicating-such-ac-to-a-sin">
<a href="#section-1.2.2.1" class="section-number selfRef">1.2.2.1. </a><a href="#name-dedicating-such-ac-to-a-sin" class="section-name selfRef">Dedicating Such AC to a Single ETI-Specific BD</a>
            </h5>
<p id="section-1.2.2.1-1">When we say AC1 (which is a VLAN-bundle subinterface) is dedicated to BD100,
   That is saying that AC1 is attached to the EVI of BD100, and all VLANs of AC1 is configured with BD100's normalized ET-ID (that's 100).<a href="#section-1.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-1.2.2.1-2">According to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, the Ethernet A-D per EVI routes for P1.1 and P1.2 will be the same (say R1_100_P1d),
 the Ethernet A-D per EVI routes for P2.1 and P2.2 will be the same (say R1_100_P2d).
 Both R1_100_P1d and R1_100_P2d will have an ET-ID 100.<a href="#section-1.2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-1.2.2.1-3">Note that if each VLAN has individual normalized ET-ID, it is just normal VLAN-aware bundle service interface as per <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.
   In such case, we say that the VLAN-mapping relationship between the AC and BD100 is 1:1 mapping,
   but when the AC is dedicated to a single ETI-Specific BD, the VLAN-mapping relationship betwenn the AC and BD100 is N:1 mapping.<a href="#section-1.2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-1.2.2.1-4">Note that when we say an VLAN-bundle AC is attached to an ETI-Specifc BD,
   that AC may be dedicated to that BD in some use cases,
   but maybe only a VLAN of that AC is attached to that BD in some other use cases.<a href="#section-1.2.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-L2SI-SperatedBundle-ETI-0">
<section id="section-1.2.2.2">
            <h5 id="name-attaching-such-ac-to-an-eti">
<a href="#section-1.2.2.2" class="section-number selfRef">1.2.2.2. </a><a href="#name-attaching-such-ac-to-an-eti" class="section-name selfRef">Attaching Such AC to an ETI-Agnostic BD</a>
            </h5>
<p id="section-1.2.2.2-1">When a BD is not ETI-Specific, we can say that it is ETI-Agnostic.
   When we say an AC is attached to an ETI-Agnostic BD, it means that all VLANs of that AC are attached to that ETI-Agnostic BD.
   In other words, the AC is dedicated to that BD.<a href="#section-1.2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2.2.2-2">When the BD is ETI-Agnostic, according to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, 
   the Ethernet A-D per EVI routes for P1.1 and P1.2 will be the same (say R1_100_P1e),
 the Ethernet A-D per EVI routes for P2.1 and P2.2 will be the same (say R1_100_P2e).
 Both R1_100_P1e and R1_100_P2e will have an zero ET-ID.<a href="#section-1.2.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-1.3">
        <h3 id="name-terminology-and-acronyms">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-terminology-and-acronyms" class="section-name selfRef">Terminology and Acronyms</a>
        </h3>
<p id="section-1.3-1">
  Most of the acronyms and terms used in this documents comes from <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, <span>[<a href="#I-D.wang-bess-evpn-arp-nd-synch-without-irb" class="xref">I-D.wang-bess-evpn-arp-nd-synch-without-irb</a>]</span>
   and <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span> except for the following:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.3-2">
          <dt id="section-1.3-2.1">* VRF AC -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.2">
            <p style="margin-left: 2.0em" id="section-1.3-2.2.1">An Attachment Circuit (AC) that attaches a CE to an IP-VRF but is
   not an IRB interface.<a href="#section-1.3-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.3">* VRF Interface -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.4">
            <p style="margin-left: 2.0em" id="section-1.3-2.4.1"> An IRB interface or a VRF-AC or an IRC interface. Note that a VRF interface will be bound to the routing space of an IP-VRF.<a href="#section-1.3-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.5">* L3 EVI -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.6">
            <p style="margin-left: 2.0em" id="section-1.3-2.6.1"> An EVPN instance spanning the Provider Edge (PE) devices
   participating in that EVPN which contains VRF ACs and maybe
   contains IRB interfaces or IRC interfaces.<a href="#section-1.3-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.7">* IP-AD/EVI -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.8">
            <p style="margin-left: 2.0em" id="section-1.3-2.8.1"> Ethernet Auto-Discovery route per EVI, and the EVI here is an IP-VRF. 
   Note that the Ethernet Tag ID of an IP-AD/EVI route may be not zero.<a href="#section-1.3-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.9">* IP-AD/ES -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.10">
            <p style="margin-left: 2.0em" id="section-1.3-2.10.1">Ethernet Auto-Discovery route per ES, and the EVI for one of its route targets is an IP-VRF.<a href="#section-1.3-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.11">* RMAC -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.12">
            <p style="margin-left: 2.0em" id="section-1.3-2.12.1">Router's MAC, which is signaled in the Router's MAC extended community.<a href="#section-1.3-2.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.13">* ESI Overlay Index -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.14">
            <p style="margin-left: 2.0em" id="section-1.3-2.14.1">ESI as overlay index.<a href="#section-1.3-2.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.15">* ET-ID -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.16">
            <p style="margin-left: 2.0em" id="section-1.3-2.16.1">Ethernet Tag ID, it is also called ETI for short in this document.<a href="#section-1.3-2.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.17">* RT-2R -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.18">
            <p style="margin-left: 2.0em" id="section-1.3-2.18.1">When a MAC/IP Advertisement Route whose ESI is not zero is used for IP-VRF forwarding, it is called as a RT-2R in this draft.
   When it is used for MAC-VRF forwarding, it is not called as a RT-2R in this draft.<a href="#section-1.3-2.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.19">* RT-5E -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.20">
            <p style="margin-left: 2.0em" id="section-1.3-2.20.1">An EVPN Prefix Advertisement Route with a non-reserved ESI as its overlay index (the ESI-as-Overlay-Index-style RT-5) .<a href="#section-1.3-2.20.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.21">* IRC -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.22">
            <p style="margin-left: 2.0em" id="section-1.3-2.22.1">Integrated Routing and Cross-connecting, thus a IRC interface is the virtual interface connecting an IP-VRF and an EVPN VPWS.<a href="#section-1.3-2.22.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.23">* CE-BGP -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.24">
            <p style="margin-left: 2.0em" id="section-1.3-2.24.1">The BGP session between PE and CE. Note that CE-BGP route doesn't have a RD or Route-Target.<a href="#section-1.3-2.24.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.25">* CE-Prefix -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.26">
            <p style="margin-left: 2.0em" id="section-1.3-2.26.1">An IP Prefixes behind a CE is called as that CE's CE-Prefix.<a href="#section-1.3-2.26.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.27">* EVC -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.28">
            <p style="margin-left: 2.0em" id="section-1.3-2.28.1">Ethernet Virtual Connection, which is typically constructed per &lt;Port, VLAN&gt; basis.<a href="#section-1.3-2.28.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.29">* ETI-Agnostic BD -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.30">
            <p style="margin-left: 2.0em" id="section-1.3-2.30.1">A Broadcast Domain (BD) whose data packets can be received along with any Ethernet Tag ID (ETI).
   Note that a broadcast domain of an L2 EVI of VLAN-aware bundle service interface is a good example of an ETI-Specific BD.<a href="#section-1.3-2.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.31">* ETI-Specific BD -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.32">
            <p style="margin-left: 2.0em" id="section-1.3-2.32.1">A Broadcast Domain (BD) whose data packets are expected to be received along with a normalized Ethernet Tag ID (ETI).
   Note that a broadcast domain of an L2 EVI of VLAN-bundle or VLAN-based service interface is a good example of an ETI-Agnostic BD.<a href="#section-1.3-2.32.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.33">* BDI-Specific EADR -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.34">
            <p style="margin-left: 2.0em" id="section-1.3-2.34.1">When the &lt;ESI, BD&gt; uses BDI-Specific Ethernet Auto-discovery mode,
   the only Ethernet A-D per EVI route of that &lt;ESI, BD&gt; is called as a BDI-Specific EADR in this draft.<a href="#section-1.3-2.34.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.35">* ACI-Specific EADR -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.36">
            <p style="margin-left: 2.0em" id="section-1.3-2.36.1">When the &lt;ESI, BD&gt; uses ACI-Specific Ethernet Auto-discovery mode,
   the Ethernet A-D per EVI routes of that &lt;ESI, BD&gt; are called as ACI-Specific EADRs in this draft.<a href="#section-1.3-2.36.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.37">* U-Tag -</dt>
          <dd style="margin-left: 1.0em" id="section-1.3-2.38">
            <p style="margin-left: 2.0em" id="section-1.3-2.38.1">User Tag, a data packet's U-tag is a tag which is not used to find out the AC of that data packet.
   The U-Tag typically is not configured on the AC.<a href="#section-1.3-2.38.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</section>
</div>
<div id="sect-problem-req">
<section id="section-2">
      <h2 id="name-problem-statement">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-problem-statement" class="section-name selfRef">Problem Statement</a>
      </h2>
<div id="sect-1.1">
<section id="section-2.1">
        <h3 id="name-problem-with-multiple-vlan-">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-problem-with-multiple-vlan-" class="section-name selfRef">Problem with Multiple VLAN-based L3SI</a>
        </h3>
<span id="name-rt-1-confliction-of-l3evis"></span><div id="Fig-L3EVI">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-2.1-1.1">
<pre>
                                 +--------------------------+
 PNEC1                      PE1  |                          |
+-------------+          +-------+------+                   | PE3
|             |          | X__(20.9)    | ----X----&gt;   +----+----+
|          "  |   P1     | /        \   | Withdraw     |         |
|          #==============&lt;      (VPN1) | IP-AD/EVI    |  (VPN1)---+N6
| R1_______"  |  ESI21   | \__      /   | ET-ID=0      |         |
|    10.2  "  |    +     |    (10.9)    |              +----+----+
|          "  |    |     +--------+-----+                   |
|          "  |    |              |                         |
|          "  |    |              |                         | DGW1
|          "  |    |        PE2   |                    +----+----+
| R2_______"  |    |     +--------+-----+              |         |
|    20.2  "  |    +     |  __(20.9)    |              |(3.3.3.3)|
|          "  |  ESI21   | /        \   |              |    |    |
|          #==============&lt;      (VPN1) | Withdraw     |  (VPN1)---+N3
|          "  |   P2     | \__      /   | IP-AD/EVI    |         |
|             |          | X  (10.9)    | ----X----&gt;   +----+----+
+-------------+          +-------+------+ ET-ID=0           |
                                 |                          |
                                 +--------------------------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-rt-1-confliction-of-l3evis" class="selfRef">RT-1 Confliction of L3EVIs</a>
          </figcaption></figure>
</div>
<p id="section-2.1-2"></p>
<p id="section-2.1-3">The IP addresses of P1.1, P1.2, P2.1, P2.2, R1 and R2 (see <a href="#Fig-SI-MultiVLAN" class="xref">Figure 2</a>) are illustrated in above Figure.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">P1 and P2 are configured with the same ESI ESI21, thus an Ethernet A-D per EVI route ETI_10_2 is advertsed for P1.1,
   an Ethernet A-D per EVI route ETI_10_3 is advertsed for P2.1,
   an Ethernet A-D per EVI route ETI_20_2 is advertsed for P1.2,
   and an Ethernet A-D per EVI route ETI_20_3 is advertsed for P2.2.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">When PE3 receives ETI_10_2 and ETI_20_2, it will pick up only one of them to be installed to the data plane.
   Because that they have the same &lt;RD,ESI,ET-ID&gt; and nexthop. We assume that the ETI_20_2 are picked out.
   When PE3 receives ETI_10_3 and ETI_20_3, it will also pick up only one of them to be installed to the data plane.
   Because that they also have the same &lt;RD,ESI,ET-ID&gt; and nexthop. We assume that the ETI_20_3 are picked out.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">Although PE1 will advertise a RT-5 Route R5_SN8_1 (whose ESI is ESI23) to PE3,
   When H3 send data packet DP_3_8 to a host in SN8 after P1.1 fails, 
   PE3 may still send DP_3_8 to PE1 because that PE3 will load-balance traffics just fllowing ETI_20_2 and ETI_20_3.
   That's a problem that will cause packet-drop or traffic-bypassing.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">When physical port P3 (see <a href="#Fig-PhyLinks" class="xref">Figure 12</a>, which illustrates the physical links of <a href="#Fig-L3EVI" class="xref">Figure 6</a>) fails, 
 the CFM session of P2.1 (10.9 of PE2) goes down (illustrated by the 'X' inside PE2), 
 while the CFM session of P2.2 (20.9 of PE2) continues to be UP.
 thus only the IP-AD/EVI route (whose ET-ID=1) of P2.1 should be withdrawn by PE2. 
 the IP-AD/EVI route (where ET-ID=2) of P2.2 and the IP-AD/ES route should not be withdrawn by PE2.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8">Note that if the ET-IDs of these two IP-AD/EVI routes are the same,
 when P2.1 fails, DGW1 will continue to load-balance traffics whose DA=20.2 to PE2,
 because that there is still another IP-AD/EVI route (of VPN1) whose ESI and ET-ID are the same.
 That's why <span><a href="#ACI-Specific-EADM" class="xref">ACI-Specific Auto-discovery</a> (<a href="#ACI-Specific-EADM" class="xref">Section 3.1.1</a>)</span> should be followed.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">The solution for this problem is decribed in <a href="#sect-Solution" class="xref">Section 3</a>.<a href="#section-2.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-1.2">
<section id="section-2.2">
        <h3 id="name-problem-with-irb-service-in">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-problem-with-irb-service-in" class="section-name selfRef">Problem with IRB Service Interface</a>
        </h3>
<p id="section-2.2-1">The detailed explanation of this network's physical links 
   are described in <a href="#Fig-PhyLinks" class="xref">Figure 12</a> and <a href="#Sect-appendix-PL-Explain" class="xref">Appendix A</a>.
   But the network's EVCs (Ethernet Virtual Connections, which are typically established per &lt;Port, VLAN&gt; basis)
   is illustrated in the following sections per each Service Interface.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span id="name-rt-1-confliction-of-evpn-ir"></span><div id="Fig-EVPN-IRB">
<figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-2.2-2.1">
<pre>
  PNEC1                         PE1
+------------+           +----------------+
|            |           |  __(BD-20)     |
| H4      "  |        P1 | /      \ IRB21 |
| |       #================   (IP-VRF)    +-----------------+
| N1______"  |   ESI21   | \__    / IRB11 |                 |
|    10.2 "  |     +     |    (BD-10)     |                 |  PE3
|         "  |     |     +----------------+             +---+----+
|         "  |     |                                    |        |
|         "  |     |                                    |(IP-VRF)+-+H3
|         "  |     |            PE2                     |        |
| N2______"  |     |     +----------------+             +---+----+
|    20.2 "  |     +     |  __(BD-10)     |                 |
|         "  |   ESI21   | /      \ IRB12 |                 |
|         #================   (IP-VRF)    +-----------------+
|         "  |        P2 | \__    / IRB22 |
|            |           |    (BD-20)     |
+------------+           +----------------+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-rt-1-confliction-of-evpn-ir" class="selfRef">RT-1 Confliction of EVPN IRB</a>
          </figcaption></figure>
</div>
<p id="section-2.2-3">The BD-10 here is the VPNx of <a href="#Fig-PhyLinks" class="xref">Figure 12</a>, 
   and the BD-20 is the VPNy of <a href="#Fig-PhyLinks" class="xref">Figure 12</a>.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">
   BD-10 and BD-20 are both BDs (broadcast domains), not IP-VRFs.
   The anycast IP address of IRB11 and IRB12 is 10.9, and the anycast IP address of IRB21 and IRB22 is 20.9.
   BD-10 and BD-20 are integrated into the same IP-VRF by IRB11, IRB12, IRB21 and IRB22.
   As a result of that, N1, IRB11 and IRB12 are of subnet SN1, 
   and N2, IRB21 and IRB22 are of subnet SN2.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">Note that IRB11 and IRB12 are IRB interfaces of BD-10 where BD-10 is a Broadcast Domain of VLAN-based Service Interface.
   IRB21 and IRB22 are IRB interfaces of BD-20 where BD-20 is also a Broadcast Domain of VLAN-based Service Interface.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">According to <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span>, 
 the IP A-D per EVI routes R1_110, R1_120, R1_210, R1_220 for P1.1, P1.2, P2.1 and P2.2 will all have zero Ethernet Tag IDs.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2-7">When PE3 receives R1_110 and R1_120, it will pick up only one of them to be installed to the data plane.
   We assume that the R1_120 is picked out.
   When PE3 receives R1_210 and R1_220, it will pick up only one of them to be installed to the data plane.
   We assume that the R1_220 is picked out.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<p id="section-2.2-8">Although PE1 will advertise a RT-2 Route R2_N1 (whose ESI is ESI21, IP is 10.2) to PE3,
   When H3 send data packet DP_H3_N1 to N1 after P1.1 fails, 
   PE3 may still send DP_H3_N1 to PE1 because that PE3 will load-balance traffics just fllowing R1_120 and R1_220.
   That's a problem that will cause packet-drop or traffic-bypassing.<a href="#section-2.2-8" class="pilcrow">¶</a></p>
<p id="section-2.2-9">The solution for this problem is decribed in <a href="#sect-IRB-specific" class="xref">Section 3.6.1</a>.<a href="#section-2.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-Problem-VLAN2BD-Nto1">
<section id="section-2.3">
        <h3 id="name-problem-with-multipe-vlans-">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-problem-with-multipe-vlans-" class="section-name selfRef">Problem with Multipe VLANs of a Single BD</a>
        </h3>
<div id="sect-1.3">
<section id="section-2.3.1">
          <h4 id="name-problem-with-multipe-vlan-b">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-problem-with-multipe-vlan-b" class="section-name selfRef">Problem with Multipe VLAN-based L2SI</a>
          </h4>
<p id="section-2.3.1-1">We want the IP addresses of N1, N2 and N3 are of the same subnet (say SN100), 
   so we select the network of <a href="#Fig-L2SI-MultiVLAN" class="xref">Figure 4</a> to accomplish that.
   Now assume that the BD100 of that network is a ETI-Agnostic broadcast domain.
   That's to say that, the EVI of BD100 is of VLAN-based service interface.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">According to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, 
 the Ethernet A-D per EVI routes for P1.1 and P1.2 will be the same (say R1_100_P1),
 the Ethernet A-D per EVI routes for P2.1 and P2.2 will be the same (say R1_100_P2).
 Both R1_100_P1 and R1_100_P2 will have a zero Ethernet Tag ID.<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-2.3.1-3">So when the CFM of subinterface P1.1 fails, if R1_100_P1 is withdrawn, 
   the forwarding of N2's packets (data packets which are destined to N2) will be in the wrong,
   but if R1_100_P1 is not withdrawn, the forwarding of N1's packets will be affected.
   That's the problem.<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
<p id="section-2.3.1-4">The solution for this problem is decribed in <a href="#sect-on-unqualified" class="xref">Section 3.6.2</a>.<a href="#section-2.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-1.4">
<section id="section-2.3.2">
          <h4 id="name-problem-with-separated-risk">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-problem-with-separated-risk" class="section-name selfRef">Problem with Separated Risk VLAN-bundle of a BD</a>
          </h4>
<p id="section-2.3.2-1">Then P1.1 and P1.2 of <a href="#sect-1.3" class="xref">Section 2.3.1</a> are aggregated into a single subinterface (see AC1 of <a href="#Fig-L2SI-SperatedBundle" class="xref">Figure 5</a>).
   The BD-100 is an ETI-Specific BD.
   Although that EVI is of VLAN-aware bundle Service Interface and the VLANs of P1.1 and P1.2 are different,
   P1.1 and P1.2 can't be attached to the same broadcast domain of that EVI.
   Because that we still want the IP addresses of N1,N2 and N3 are of the same subnet (say SN100), like what we have expected in <a href="#sect-1.3" class="xref">Section 2.3.1</a>.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.2-2">So we assign the same normalized ET-ID (say ET-ID 100) to P1.1, P1.2, P2.1 and P2.2.
   As a result of that, the Ethernet A-D per EVI routes for P1.1 and P1.2 will be the same (say R1_100_P1b),
 the Ethernet A-D per EVI routes for P2.1 and P2.2 will be the same (say R1_100_P2b).
 Both R1_100_P1b and R1_100_P2b will have a ET-ID 100.<a href="#section-2.3.2-2" class="pilcrow">¶</a></p>
<p id="section-2.3.2-3">So when the CFM of subinterface P1.1 fails, if R1_100_P1b is withdrawn, the forwarding of N2's packets (those packets destinating to N2) will be in the wrong,
   but if R1_100_P1b is not withdrawn, the forwarding of N1's packets will be affected.
   That's the problem.<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<p id="section-2.3.2-4">Note that this problem will not be resolved even if R1_100_P1b can carry two AC-ID Extended Communities (one per AC).<a href="#section-2.3.2-4" class="pilcrow">¶</a></p>
<p id="section-2.3.2-5">The solution for this problem is decribed in <a href="#sect-on-qualified" class="xref">Section 3.6.3</a>.<a href="#section-2.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-1.5">
<section id="section-2.4">
        <h3 id="name-problem-with-bump-in-the-wi">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-problem-with-bump-in-the-wi" class="section-name selfRef">Problem with Bump-in-the-wire Use-Case</a>
        </h3>
<p id="section-2.4-1">Section 4.3 of <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span> defined the Bump-in-the-wire use-case,
 where a style (which is called as RT-5E in this draft) of RT-5 routes (whose overlay index is a non-zero ESI), 
 is used to advertise the IP prefix of subnet SN1 (see <a href="#Fig-Bump-Wire" class="xref">Figure 8</a>).
 The RT-5E routes (whose IP prefix is SN1, and ESI is ESI23) of that draft is called as RT5E_SN1 in this draft.
 And the RT-1 routes (whose ESI is ESI23) corresponding to the RT5E_SN1 is called as RT1_ESI23 in this draft.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">RT1_ESI23 is advertised for BD-10, 
 but how RT5E_SN1 is advertised and how it is imported into IP-VRF are not very clear in that draft.
 In some secenarios, the obscureness may have influence on what behavior of a RT-5E route 
 should be expected for non-upgraded DGW1 following that draft. Take the following network for example:<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<span id="name-rt-1-confliction-of-bump-in"></span><div id="Fig-Bump-Wire">
<figure id="figure-8">
          <div class="artwork art-text alignLeft" id="section-2.4-3.1">
<pre>
          TS2                          NVE2
    +--------------+           +---------------+
    |              |           |               |
SN7-----(N2-M4)__  |           |  __(BD-20)    |
    |            \ |       IF2 | /             |
    |             ===============              +-------+
    |          __/ |   ESI23   | \__           |       |
 +----- (N1-M2)    |     +     |    (BD-10)    |       |  DGW1
 |  |              |     |     |               |   +---+-----+
 |  +--------------+     |     +---------------+   | (BD-10) |
 |                       |                         |   \IRB1 |
SN1                      |                         |(IP-VRF) +-+H3
 |        TS3            |             NVE3        |   /IBR3 |
 |  +--------------+     |     +---------------+   | (BD-20) |
 |  |              |     |     |               |   +---+-----+
 +------(N1-M3)__  |     +     |  __(BD-10)    |       |
    |            \ |   ESI23   | /             |       |
    |             ===============              +-------+
    |          __/ |       IF3 | \__           |
SN7-----(N2-M5)    |           |    (BD-20)    |
    |              |           |               |
    +--------------+           +---------------+

</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-rt-1-confliction-of-bump-in" class="selfRef">RT-1 Confliction of Bump-in-the-wire</a>
          </figcaption></figure>
</div>
<p id="section-2.4-4"> This network is similar to Figure 7 of <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span> with a few notable exceptions as below.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4-5"> The NVE2,NVE3,DGW1,IRB1,BD-10,ESI23,TS2,TS3 and SN1 here is the NVE2,NVE3,DGW1,IRB1,BD-10,ESI23,TS2,TS3 and SN1 there.
 The N1 here is the Virtual Appliance (whose VA-MAC is M2/M3 on TS2/TS3) there.<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<p id="section-2.4-6">But here we have another Virtual Appliance N2, which are attached to another Broadcast Domain BD-20.
 Both BD-10 and BD-20 are integrated into the same IP-VRF by DGW1.
 But the subnet SN1 can only be reached through BD-10, while the subnet SN7 can only be reached through BD-20.<a href="#section-2.4-6" class="pilcrow">¶</a></p>
<p id="section-2.4-7">If RT5E_SN1 is imported into IP-VRF directly by DGW1 using its route-target (whose value is not clear in that draft),
    PE3 will not know which BD should the RT-1 per EVI routes for RT5E_SN1 be selected from,
 and PE3 will not know which MAC should the SA of the data packets corresponding to RT5E_SN1 be set to.
 But if RT5E_SN1 (whose route-target identifying BD-10) is imported into the BD-10 at first, 
 although it can be imported into the IP-VRF following BD-10's IRB interface,
 RT5E_SN1 will not be imported into the IP-VRF on other PEs which don't have an instance of BD-10.
 Thus such PEs are precluded from connecting to the hosts of SN1 by such rules.<a href="#section-2.4-7" class="pilcrow">¶</a></p>
<p id="section-2.4-8">Note that both BD-10 and BD-20 are L2 EVIs of VLAN-based Service Interfaces.<a href="#section-2.4-8" class="pilcrow">¶</a></p>
<p id="section-2.4-9">The solution for this problem is decribed in <a href="#sect-BumpWire-Specific" class="xref">Section 3.6.4</a>.<a href="#section-2.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-1.6">
<section id="section-2.5">
        <h3 id="name-problem-with-arp-nd-probing">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-problem-with-arp-nd-probing" class="section-name selfRef">Problem with ARP/ND Probing upon Remote PE Failure</a>
        </h3>
<p id="section-2.5-1">In order to avoid blackholing, when PE2 detects loss of reachability to
   PE1, it can trigger ARP/ND requests for all synced IP prefixes
   received from PE1 across all affected BDs. This will force host
   H21a (a host of subnet SN31) to reply to the solicited ARP/ND messages from PE2 and refresh
   both MAC and IP for the corresponding host in its tables.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">This procedures are called as ARP/ND Probing in this draft,
   the problem with ARP/ND Probing are described as the following:<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<span id="name-rt-1-confliction-of-bump-in-"></span><div id="Fig-ARP-Probing">
<figure id="figure-9">
          <div class="artwork art-text alignLeft" id="section-2.5-3.1">
<pre>
                                               +-----------------+
   PNEC1                                 PE1   |                 |
+----------------------+               +-------+------+          |
|                      |  (S-VLAN21)   |  __(P1.1)    |          |
| SN31(C-VLAN31)    "  | QinQ-uplink   | /        \   |          |
| |                 #===================&lt;     (BD100) |          |
| +     QinQ-Access "  |     ESI21     | \__      /   |       +--+--+
| N1+---------------"  |       +       |    (P1.2)    |       |     |
| +  Trunk          "  |       |       +--------+-----+       |     |
| |                 "  |       |                |             |     |
| SN32(C-VLAN32)    "  |       |                |             | PE3 |
|                   "  |       |         PE2    |             |     |
|    Trunk          "  |       |       +--------+-----+       |     |
| N2+---------------"  |       +       |  __(P2.2)    |       |     |
|       QinQ-Access "  |     ESI21     | /        \   |       +--+--+
|                   #===================&lt;     (BD100) |          |
|                   "  | QinQ-uplink   | \__      /   |          |
|                      |  (S-VLAN21)   |    (P2.1)    |          |
+----------------------+               +-------+------+          |
                                               |                 |
                                               +-----------------+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-rt-1-confliction-of-bump-in-" class="selfRef">RT-1 Confliction of Bump-in-the-wire</a>
          </figcaption></figure>
</div>
<p id="section-2.5-4">But when QinQ is enabled in PNEC1 but the ACs (P1.1 and P2.1) are still dot1q subinterface.
   The ARP/ND Probing procedures will fail. Because PE2 doesn't know the required C-VLAN of H21a.
   Although AC-ID extended coummunity of <span>[<a href="#I-D.sajassi-bess-evpn-ac-aware-bundling" class="xref">I-D.sajassi-bess-evpn-ac-aware-bundling</a>]</span> can be used,
   the AC-ID extended coummunity is not used to advertise U-Tags.
   So PE2 can not trigger an ARP/ND request along with the required C-VLAN (that's C-VLAN 31) of H21a.<a href="#section-2.5-4" class="pilcrow">¶</a></p>
<p id="section-2.5-5">The solution for this problem is decribed in <a href="#sect-Probing-Specific" class="xref">Section 3.6.5</a>.<a href="#section-2.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-Solution">
<section id="section-3">
      <h2 id="name-solutions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-solutions" class="section-name selfRef">Solutions</a>
      </h2>
<p id="section-3-1">Note that the PEs follow <span>[<a href="#I-D.wang-bess-evpn-arp-nd-synch-without-irb" class="xref">I-D.wang-bess-evpn-arp-nd-synch-without-irb</a>]</span> to
   achieve the ESI load balance except for the following explicit discription.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="sect-EAD-modes">
<section id="section-3.1">
        <h3 id="name-ethernet-auto-discovery-mod">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-ethernet-auto-discovery-mod" class="section-name selfRef">Ethernet Auto-Discovery modes</a>
        </h3>
<p id="section-3.1-1">When the AC-type is N:1 mapping, we propose a new Ethernet Auto-discovery mode, 
   It is called as ACI-Specific Ethernet A-D mode in this draft,
   while the Ethernet A-D mode from <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span> are called as BDI-Specific Ethernet A-D mode in this draft.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="sect-EADModes-BDI-vs-ACI">
<section id="section-3.1.1">
          <h4 id="name-bdi-specific-ead-vs-aci-spe">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-bdi-specific-ead-vs-aci-spe" class="section-name selfRef">BDI-Specific EAD vs ACI-Specific EAD</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-3.1.1-1">
            <dt id="section-3.1.1-1.1">* BDI-Specific Ethernet A-D mode -</dt>
            <dd style="margin-left: 1.0em" id="section-3.1.1-1.2">
              <p id="section-3.1.1-1.2.1">When the AC-type is N:1 mapping, and only a single Ethernet A-D per EVI route is advertised for that &lt;ESI, BD&gt;,
   we say that the &lt;ESI, BD&gt; uses BDI-Specific Ethernet Auto-discovery mode,
   and that Ethernet A-D per EVI route is called as a BDI-Specific EADR (Ethernet A-D per EVI Route) in this draft.<a href="#section-3.1.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.1-1.3">
<div id="ACI-Specific-EADM">* ACI-Specific Ethernet A-D mode -</div>
            </dt>
<dd style="margin-left: 1.0em" id="section-3.1.1-1.4">
              <p id="section-3.1.1-1.4.1">When the AC-type is N:1 mapping, and individual Ethernet A-D per EVI routes are advertised per each VLAN of that &lt;ESI, BD&gt;,
   we say that the &lt;ESI, BD&gt; uses ACI-Specific Ethernet Auto-discovery mode,
   and each of such Ethernet A-D per EVI route is called as a ACI-Specific EADR (Ethernet A-D per EVI Route) in this draft.<a href="#section-3.1.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.1.1-2">Note that when a Shared Risk VLAN-bundle AC is dedicated to a single BD, either BDI-Specific EAD-mode or ACI-Specific EAD-mode can be used. 
   But when a Separated Risk VLAN-bundle AC is dedicated to a single BD, only ACI-Specific EAD-mode should be used.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-3">Note that when BDI-Specific Ethernet Auto-Discovery is used,
   the IP-AD per EVI route's ET-ID should be set to the BD-Identifier of its BD.
   When ETI-Specific Ethernet Auto-Discovery is used,
   the the ET-IDs of the IP-AD per EVI routes of the &lt;ESI, BD&gt; should be set per each VLAN of the bundle,
   but the ET-ID of RT-2R should still be set to the BD-Identifier of that BD.
   As a result of that, an AC-ID Overlay Index Extended Community should be carried along with that RT-2R in ETI-Specific Ethernet A-D mode.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-ETIs-vs-ACI">
<section id="section-3.1.2">
          <h4 id="name-use-cases-and-their-et-ids-">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-use-cases-and-their-et-ids-" class="section-name selfRef">Use Cases and their ET-IDs and AC-IDs</a>
          </h4>
<p id="section-3.1.2-1">The advertisement of ET-IDs and AC-IDs can be combined in many ways, 
 which are illustrated in <a href="#Table-L2-Combine" class="xref">Table 1</a>:<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<div id="sect-L2-Combine">
<section id="section-3.1.2.1">
            <h5 id="name-eti-aci-combinations-for-l2">
<a href="#section-3.1.2.1" class="section-number selfRef">3.1.2.1. </a><a href="#name-eti-aci-combinations-for-l2" class="section-name selfRef">ETI-ACI Combinations for L2EVI Use Cases</a>
            </h5>
<span id="name-combinations-for-l2evis"></span><div id="Table-L2-Combine">
<table class="center" id="table-1">
              <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-combinations-for-l2evis" class="selfRef">Combinations for L2EVIs</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">No</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#BD-T" class="xref">BD-Type</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#AC-T" class="xref">AC-Type</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#AC-ETI" class="xref">AC-ETI</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#BD-ID" class="xref">BD-ID</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI-EC-Type" class="xref">ACI-T</a>
</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Agnostic" class="xref">ETI-Agnostic</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Mono" class="xref">Mono VLAN</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">/</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Agnostic" class="xref">ETI-Agnostic</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AC-ID" class="xref">AC-ID</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Agnostic" class="xref">ETI-Agnostic</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">4</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Agnostic" class="xref">ETI-Agnostic</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Separated" class="xref">N:1 Separated *</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">5</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Specific" class="xref">ETI-Specific</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#one-by-one" class="xref">1:1 mapping</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">/</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">6 **</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Specific" class="xref">ETI-Specific</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AC-ID" class="xref">AC-ID</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">7</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Specific" class="xref">ETI-Specific</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">8</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Specific" class="xref">ETI-Specific</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Separated" class="xref">N:1 Separated</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-3.1.2.1-2">The Table is explained in details as the following:<a href="#section-3.1.2.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.2.1-3">
              <dt id="section-3.1.2.1-3.1">o The "BD-Type","AC-Type" Columns:</dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.1-3.2">
                <p id="section-3.1.2.1-3.2.1">Which use cases can each combination be used for?<a href="#section-3.1.2.1-3.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.1.2.1-3.2.2">
                  <dt id="section-3.1.2.1-3.2.2.1">
<div id="BD-T">* BD-Type:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.2.2.2"> Which type of broadcast domain is selected in that use case?<a href="#section-3.1.2.1-3.2.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.2.2.3">
<div id="AC-T">* AC-Type:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.2.2.4"> Which type of AC is slected for that BD in that use case?<a href="#section-3.1.2.1-3.2.2.4" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.2.2.5">
<div id="ETI-Specific">* ETI-Specific:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.2.2.6"> The broacast domain is an ETI-specific BD.<a href="#section-3.1.2.1-3.2.2.6" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.2.2.7">
<div id="ETI-Agnostic">* ETI-Agnostic:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.2.2.8"> The broacast domain is an ETI-agnostic BD.<a href="#section-3.1.2.1-3.2.2.8" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.2.2.9">
<div id="Mono">* Mono VLAN: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.2.2.10"> only one VLAN of the ES is attached to the ETI-Agnostic BD.<a href="#section-3.1.2.1-3.2.2.10" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.2.2.11">
<div id="Separated">* N:1 Separated: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.2.2.12">a VLAN-bundle AC whose risk factors is separated per each VLAN of its own.<a href="#section-3.1.2.1-3.2.2.12" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.2.2.13">
<div id="Shared">* N:1 Shared: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.2.2.14">a VLAN-bundle AC whose VLANs will share the same risks.<a href="#section-3.1.2.1-3.2.2.14" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.2.2.15">
<div id="N-to-1">* N:1 mapping: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.2.2.16">a VLAN-bundle AC whose VLANs are all attached to the same BD.<a href="#section-3.1.2.1-3.2.2.16" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.2.2.17">
<div id="one-by-one">* 1:1 mapping: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.2.2.18">only one VLAN of the ES is attached to the ETI-specific BD.<a href="#section-3.1.2.1-3.2.2.18" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1.2.1-3.3">o The "AC-ETI", "IP-ETI", "ACI-T" Columns:</dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.1-3.4">
                <p id="section-3.1.2.1-3.4.1">Which value can each field be assigned to?<a href="#section-3.1.2.1-3.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.1.2.1-3.4.2">
                  <dt id="section-3.1.2.1-3.4.2.1">
<div id="AC-ETI">* AC-ETI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.4.2.2">The ET-ID field of RT-1 per EVI route of that BD.<a href="#section-3.1.2.1-3.4.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.4.2.3">
<div id="BD-ID">* BD-ID: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.4.2.4">The ET-ID field of a RT-2 route. 
 it is the identifier (in the context of an EVI) of that RT-2 route's broadcast domain.<a href="#section-3.1.2.1-3.4.2.4" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.4.2.5">
<div id="ACI-EC-Type">* ACI-T:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.4.2.6">Which Extended Community should the ACI be carried in? 
 Attachment Circuit ID Extended Community or AOI Extended Community?<a href="#section-3.1.2.1-3.4.2.6" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.4.2.7">
<div id="ACI">* ACI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.4.2.8">
                    <p id="section-3.1.2.1-3.4.2.8.1">The AC-ID of an AC for a specified broadcast domain.<a href="#section-3.1.2.1-3.4.2.8.1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.1-3.4.2.8.2">Note that when the AC-Type is N:1 Separated, different VLAN of that AC have different ACI, 
 the ACI typically will be the same value with the corresponding VLAN.<a href="#section-3.1.2.1-3.4.2.8.2" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.4.2.9">
<div id="AOI">* AOI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.4.2.10">
                    <p id="section-3.1.2.1-3.4.2.10.1">The ACI is encapsulated as AOI Extended Coummunity.<a href="#section-3.1.2.1-3.4.2.10.1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.1-3.4.2.10.2">Note that in such case, the ACI is the overlay index of that RT-2R or RT-5E.
 When the AC-Type is N:1 Separated,
 each RT-1 per EVI route will select individual VLAN of that AC to be its own AOI.<a href="#section-3.1.2.1-3.4.2.10.2" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.4.2.11">
<div id="AC-ID">* AC-ID:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.4.2.12">
                    <p id="section-3.1.2.1-3.4.2.12.1">The ACI is encapsulated as Attachment Circuit ID Extended Community.<a href="#section-3.1.2.1-3.4.2.12.1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.1-3.4.2.12.2">Note that in such case the AOI is still the ET-ID field of that RT-2R or RT-5E.<a href="#section-3.1.2.1-3.4.2.12.2" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.4.2.13">
<div id="BDI">* BDI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.1-3.4.2.14">That field is set to the BD identifier of an ETI-Specific BD.<a href="#section-3.1.2.1-3.4.2.14" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.4.2.15">* 0:</dt>
                  <dd style="margin-left: 4.0em" id="section-3.1.2.1-3.4.2.16">That field is set to zero.<a href="#section-3.1.2.1-3.4.2.16" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.4.2.17">* /:</dt>
                  <dd style="margin-left: 4.0em" id="section-3.1.2.1-3.4.2.18">That Attachment Circuit ID Extended Community is not carried along with that RT-2R or RT-5E route.<a href="#section-3.1.2.1-3.4.2.18" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1.2.1-3.5">o The "No." Column:</dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.1-3.6">
                <p id="section-3.1.2.1-3.6.1">The index number of each use case.<a href="#section-3.1.2.1-3.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1.2.1-3.7">o </dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.1-3.8">
                <p id="section-3.1.2.1-3.8.1">Notes:<a href="#section-3.1.2.1-3.8.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.2.1-3.8.2">
                  <dt id="section-3.1.2.1-3.8.2.1">*</dt>
                  <dd style="margin-left: 1.5em" id="section-3.1.2.1-3.8.2.2">When the AC-Type is N:1 shared or N:1 Separated, we can say the AC-Type is N:1 mapping.<a href="#section-3.1.2.1-3.8.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.1-3.8.2.3">**</dt>
                  <dd style="margin-left: 1.5em" id="section-3.1.2.1-3.8.2.4">This follows <span>[<a href="#I-D.sajassi-bess-evpn-ac-aware-bundling" class="xref">I-D.sajassi-bess-evpn-ac-aware-bundling</a>]</span>.<a href="#section-3.1.2.1-3.8.2.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-IRB-Combine">
<section id="section-3.1.2.2">
            <h5 id="name-eti-aci-combinations-for-ev">
<a href="#section-3.1.2.2" class="section-number selfRef">3.1.2.2. </a><a href="#name-eti-aci-combinations-for-ev" class="section-name selfRef">ETI-ACI Combinations for EVPN IRB Use Cases</a>
            </h5>
<span id="name-combinations-for-evpn-irb"></span><div id="Table-IRB-Combines">
<table class="center" id="table-2">
              <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-combinations-for-evpn-irb" class="selfRef">Combinations for EVPN IRB</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">No.</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#BD-T" class="xref">BD-Type</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#L2AC-T" class="xref">L2AC-Type</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#IP-AD-ETI" class="xref">IAD-ETI</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#RT2R-ETI" class="xref">RT2R-ETI</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#IP-ACI" class="xref">IP-ACI</a>
</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">19</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Agnostic" class="xref">ETI-Agnostic</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Mono" class="xref">Mono VLAN</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">/</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">20</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Agnostic" class="xref">ETI-Agnostic</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AC-ID" class="xref">AC-ID</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">21</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Agnostic" class="xref">ETI-Agnostic</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">22</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Agnostic" class="xref">ETI-Agnostic</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Separated" class="xref">N:1 Separated</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">23</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Specific" class="xref">ETI-Specific</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#one-by-one" class="xref">1:1 mapping</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0*</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">/</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">24</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Specific" class="xref">ETI-Specific</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AC-ID" class="xref">AC-ID</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">25</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Specific" class="xref">ETI-Specific</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">26</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-Specific" class="xref">ETI-Specific</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Separated" class="xref">N:1 Separated</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">29</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-0-BDs" class="xref">ETI-0 BDs</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Any" class="xref">Any</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">30</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#ETI-X-BDs" class="xref">ETI-X BDs</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Any" class="xref">Any</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>*</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-3.1.2.2-2">The Table is explained in details as the following:<a href="#section-3.1.2.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.2.2-3">
              <dt id="section-3.1.2.2-3.1">o The "BD-Type", "L2AC-Type" Columns:</dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.2-3.2">
                <p id="section-3.1.2.2-3.2.1">Which use cases can each combination be used for?<a href="#section-3.1.2.2-3.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.1.2.2-3.2.2">
                  <dt id="section-3.1.2.2-3.2.2.1">
<div id="L2AC-T">* L2AC-Type:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-3.2.2.2">Which type of AC is used for that BD in that use case?.<a href="#section-3.1.2.2-3.2.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-3.2.2.3">
<div id="Any">* Any: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-3.2.2.4">Regardless of which type the L2 AC is.<a href="#section-3.1.2.2-3.2.2.4" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-3.2.2.5">
<div id="ETI-0-BDs">* ETI-0 BDs: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-3.2.2.6">Multiple ETI-Agnostic BDs on the same ES are integrated into the same L3EVI.<a href="#section-3.1.2.2-3.2.2.6" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-3.2.2.7">
<div id="ETI-X-BDs">* ETI-X BDs: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-3.2.2.8">Multiple ETI-Specific BDs on the same ES are integrated into the same L3EVI.<a href="#section-3.1.2.2-3.2.2.8" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1.2.2-3.3">o The "IAD-ETI", "RT2R-ETI", "IP-ACI" Columns:</dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.2-3.4">
                <p id="section-3.1.2.2-3.4.1">Which value can each field be assigned to?<a href="#section-3.1.2.2-3.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.1.2.2-3.4.2">
                  <dt id="section-3.1.2.2-3.4.2.1">
<div id="IP-AD-ETI">* IAD-ETI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-3.4.2.2">The Ethernet Tag ID field of IP AD per EVI route of that IP-VRF.<a href="#section-3.1.2.2-3.4.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-3.4.2.3">
<div id="RT2R-ETI">* RT2R-ETI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-3.4.2.4">The Ethernet Tag ID field of RT-2R route.<a href="#section-3.1.2.2-3.4.2.4" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-3.4.2.5">
<div id="IP-ACI">* IP-ACI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-3.4.2.6">
                    <p id="section-3.1.2.2-3.4.2.6.1">Which Extended Community should the ACI be carried in? 
 Attachment Circuit ID Extended Community or AOI Extended Community?<a href="#section-3.1.2.2-3.4.2.6.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1.2.2-3.5">o </dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.2-3.6">
                <p id="section-3.1.2.2-3.6.1">Notes:<a href="#section-3.1.2.2-3.6.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.2.2-3.6.2">
                  <dt id="section-3.1.2.2-3.6.2.1">*</dt>
                  <dd style="margin-left: 1.5em" id="section-3.1.2.2-3.6.2.2">The ET-ID of IP-AD per EVI route should be set to 0 according to <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span>,
 even if the BD is of VLAN-aware bundle service interface.<a href="#section-3.1.2.2-3.6.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-3.6.2.3">**</dt>
                  <dd style="margin-left: 1.5em" id="section-3.1.2.2-3.6.2.4">The ET-ID of RT-2R route should be set to the BDI of a ETI-Specific BD according to <span>[<a href="#I-D.ietf-bess-evpn-inter-subnet-forwarding" class="xref">I-D.ietf-bess-evpn-inter-subnet-forwarding</a>]</span>.<a href="#section-3.1.2.2-3.6.2.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
</dl>
<span id="name-combinations-for-bump-in-th"></span><div id="Table-BumpWire-Combines">
<table class="center" id="table-3">
              <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-combinations-for-bump-in-th" class="selfRef">Combinations for Bump-in-the-wire</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">No.</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#BD-T" class="xref">BD-Type</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#L2AC-T" class="xref">L2AC-Type</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#EAD-ETI" class="xref">L2AC-ETI</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#RT5E-ETI" class="xref">RT5E-ETI</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#IP-ACI" class="xref">IP-ACI</a>
</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">11</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWire0" class="xref">BumpWire0</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Mono" class="xref">Mono VLAN</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">/</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">12</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWire0" class="xref">BumpWire0</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AC-ID" class="xref">AC-ID</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">13</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWire0" class="xref">BumpWire0</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">14</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWire0" class="xref">BumpWire0</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Separated" class="xref">N:1 Separated</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">15*</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWireX" class="xref">BumpWireX</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#one-by-one" class="xref">1:1 mapping</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">/</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">16</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWireX" class="xref">BumpWireX</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AC-ID" class="xref">AC-ID</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">17</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWireX" class="xref">BumpWireX</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Shared" class="xref">N:1 Shared</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">18**</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWireX" class="xref">BumpWireX</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Separated" class="xref">N:1 Separated</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">27</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWire0s" class="xref">BumpWire0s</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Any" class="xref">Any</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">28</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#BumpWireXs" class="xref">BumpWireXs</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <a href="#Any" class="xref">Any</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#BDI" class="xref">BDI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-3.1.2.2-5">The Table is explained in details as the following:<a href="#section-3.1.2.2-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.2.2-6">
              <dt id="section-3.1.2.2-6.1">o The "BD-Type", "L2AC-Type" Columns:</dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.2-6.2">
                <p id="section-3.1.2.2-6.2.1">Which use cases can each combination be used for?<a href="#section-3.1.2.2-6.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.1.2.2-6.2.2">
                  <dt id="section-3.1.2.2-6.2.2.1">
<div id="BumpWire0">* BumpWire0: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-6.2.2.2">The broadcast domain is an ETI-Agnostic BD, and the use case is a Bump-in-the-wire use case.
 This is the original Bump-in-the-wire use case of <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span> section 4.3.<a href="#section-3.1.2.2-6.2.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-6.2.2.3">
<div id="BumpWireX">* BumpWireX </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-6.2.2.4">The broadcast domain is an ETI-Specific BD, and the use case is a Bump-in-the-wire use case.<a href="#section-3.1.2.2-6.2.2.4" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-6.2.2.5">
<div id="BumpWire0s">* BumpWire0s: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-6.2.2.6">Multiple BumpWire0-BDs on the same ES are integrated into the same L3EVI.<a href="#section-3.1.2.2-6.2.2.6" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-6.2.2.7">
<div id="BumpWireXs">* BumpWireXs: </div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-6.2.2.8">Multiple BumpWireX-BDs on the same ES are integrated into the same L3EVI.<a href="#section-3.1.2.2-6.2.2.8" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1.2.2-6.3">o The "L2AC-ETI", "RT5E-ETI", "IP-ACI" Columns:</dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.2-6.4">
                <p id="section-3.1.2.2-6.4.1">Which value can each field be assigned to?<a href="#section-3.1.2.2-6.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.1.2.2-6.4.2">
                  <dt id="section-3.1.2.2-6.4.2.1">
<div id="EAD-ETI">* L2AC-ETI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-6.4.2.2">The Ethernet Tag ID field of Ethernet A-D per EVI route of the L2AC of that BD.<a href="#section-3.1.2.2-6.4.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-6.4.2.3">
<div id="RT5E-ETI">* RT5E-ETI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.2-6.4.2.4">The Ethernet Tag ID field of RT-5E route.<a href="#section-3.1.2.2-6.4.2.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1.2.2-6.5">o </dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.2-6.6">
                <p id="section-3.1.2.2-6.6.1">Notes:<a href="#section-3.1.2.2-6.6.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.2.2-6.6.2">
                  <dt id="section-3.1.2.2-6.6.2.1">*</dt>
                  <dd style="margin-left: 1.5em" id="section-3.1.2.2-6.6.2.2"> When the BD-10 of above Bump-in-the-wire use case is replaced with an ETI-specific BD,
    that use case is called ETI-specific Bump-in-the-wire use case. 
 The ETI-specific Bump-in-the-wire use case is implied in <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span>
 as discussed in <a href="#Paragraph-Bump-Wire-Reference" class="xref">Section 3.5, Paragraph 4</a>.<a href="#section-3.1.2.2-6.6.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.2-6.6.2.3">**</dt>
                  <dd style="margin-left: 1.5em" id="section-3.1.2.2-6.6.2.4"> When the BD-10 of above Bump-in-the-wire use case is replaced with 
 an ETI-specific BD and ACI-Specific EAD mode ACs,
    that use case is called N:1 ETI-specific Bump-in-the-wire use case.<a href="#section-3.1.2.2-6.6.2.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-L3-Combine">
<section id="section-3.1.2.3">
            <h5 id="name-eti-aci-combinations-for-l3">
<a href="#section-3.1.2.3" class="section-number selfRef">3.1.2.3. </a><a href="#name-eti-aci-combinations-for-l3" class="section-name selfRef">ETI-ACI Combinations for L3EVI Use Cases</a>
            </h5>
<span id="name-combinations-for-l3evis"></span><div id="Table-L3-Combine">
<table class="center" id="table-4">
              <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-combinations-for-l3evis" class="selfRef">Combinations for L3EVIs</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">No.</th>
                  <th class="text-left" rowspan="1" colspan="1">Use Cases</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#L3AC-ETI" class="xref">L3AC-ETI</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#IP-ETI" class="xref">IP-ETI</a>
</th>
                  <th class="text-center" rowspan="1" colspan="1">
                    <a href="#IP-ACI" class="xref">IP-ACI</a>
</th>
                  <th class="text-left" rowspan="1" colspan="1"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">33</td>
                  <td class="text-left" rowspan="1" colspan="1">Multiple VLAN-based</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">34</td>
                  <td class="text-left" rowspan="1" colspan="1">Separated Risk</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">/</td>
                  <td class="text-left" rowspan="1" colspan="1">*</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">35</td>
                  <td class="text-left" rowspan="1" colspan="1">Mono VLAN-based</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">/</td>
                  <td class="text-left" rowspan="1" colspan="1"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">36</td>
                  <td class="text-left" rowspan="1" colspan="1">Shared Risk</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#ACI" class="xref">ACI</a>
</td>
                  <td class="text-center" rowspan="1" colspan="1">0</td>
                  <td class="text-center" rowspan="1" colspan="1">
                    <a href="#AOI" class="xref">AOI</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1">**</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-3.1.2.3-2">The Table is explained in details as the following:<a href="#section-3.1.2.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.2.3-3">
              <dt id="section-3.1.2.3-3.1">o The "Use Cases" Column:</dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.3-3.2">
                <p id="section-3.1.2.3-3.2.1">Which use cases can each combination be used for?<a href="#section-3.1.2.3-3.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.1.2.3-3.2.2">
                  <dt id="section-3.1.2.3-3.2.2.1">* L3 EVPN Service Interfaces:</dt>
                  <dd style="margin-left: 4.0em" id="section-3.1.2.3-3.2.2.2">Mutiple VLAN-based service interface, Separated Risk VLAN-bundle service interface, Mono VLAN-based service interface, Shared Risk service interface.<a href="#section-3.1.2.3-3.2.2.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1.2.3-3.3">o The "L3AC-ETI", "IP-ETI", "IP-ACI" Columns:</dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.3-3.4">
                <p id="section-3.1.2.3-3.4.1">Which value can each field be assigned to?<a href="#section-3.1.2.3-3.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.1.2.3-3.4.2">
                  <dt id="section-3.1.2.3-3.4.2.1">
<div id="IP-ETI">* IP-ETI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.3-3.4.2.2">The Ethernet Tag ID field of RT-5E route.<a href="#section-3.1.2.3-3.4.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.3-3.4.2.3">
<div id="L3AC-ETI">* L3AC-ETI:</div>
                  </dt>
<dd style="margin-left: 4.0em" id="section-3.1.2.3-3.4.2.4">The ET-ID field of IP-AD per EVI route of that L3EVI.<a href="#section-3.1.2.3-3.4.2.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1.2.3-3.5">o </dt>
              <dd style="margin-left: 1.0em" id="section-3.1.2.3-3.6">
                <p id="section-3.1.2.3-3.6.1">Notes:<a href="#section-3.1.2.3-3.6.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.2.3-3.6.2">
                  <dt id="section-3.1.2.3-3.6.2.1">*</dt>
                  <dd style="margin-left: 1.5em" id="section-3.1.2.3-3.6.2.2">Both Multiple VLAN-based service interface and Separated Risk VLAN-bundle service interface
 can use combinations 33-34. The difference is that the ACI of combination 34 
 will be encapsulated into data packets, but the ACI of combination 33 won't.<a href="#section-3.1.2.3-3.6.2.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.1.2.3-3.6.2.3">**</dt>
                  <dd style="margin-left: 1.5em" id="section-3.1.2.3-3.6.2.4">Both Mono VLAN-based service interface and Shared Risk VLAN-bundle service interface
 can use combinations 35-36. If you are not very sure whether the risks are shared or separated,
 the combination 36 will be safer.<a href="#section-3.1.2.3-3.6.2.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-5">
<section id="section-3.2">
        <h3 id="name-determining-the-aliasing-pa">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-determining-the-aliasing-pa" class="section-name selfRef">Determining the Aliasing Pathes for RT-5E/RT-2R</a>
        </h3>
<p id="section-3.2-1">When PE3 forward a data packet DP_2021 according to
   an IP Prefix advertisement route R5_2021 whose overlay index is an ESI,
   If the ET-ID of R5_2021 is a non-reserved ET-ID,
   DP_2021 should not be forwarded according to an ethernet A-D per EVI route R1_2021, 
   unless the ET-ID and ESI of R1_2021 are both the same as that of R5_2021.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
   Note that in <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span> the IP-AD per EVI route carries a "Router's MAC" extended community
   in case the RMAC is not the same among different PEs.
   In these cases, the inner destination MAC of the corresponding data packets from PE3 to PE1/PE2 must use the RMAC in IP-AD/EVI route instead, 
   even if there is a RMAC in RT-2R route.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">
   Note that this is a data-plane update of <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span> for both EVPN signalled L3VPN and <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span>.
   According to <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span> section 4.3 or <span>[<a href="#I-D.ietf-bess-evpn-inter-subnet-forwarding" class="xref">I-D.ietf-bess-evpn-inter-subnet-forwarding</a>]</span> section 5.4, the inner destination MAC will follow the RMAC of RT-5E Route or RT-2R Route.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">When selecting corresponding IP-AD/EVI routes for a RT-5E route,
 the AOI Extended Community (if it exists) of the RT-5E route is prefered than the ET-ID of the RT-5E route.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-5">
          <dt id="section-3.2-5.1">* Using ET-ID to select BDI-Specific EADRs -</dt>
          <dd style="margin-left: 1.0em" id="section-3.2-5.2">
            <p id="section-3.2-5.2.1">In this case, the RT-1 per EVI routes corresponding to that RT-5E route are selected in the context of a BD.<a href="#section-3.2-5.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2-5.2.2">There may be multiple Ethernet A-D per EVI routes which all can match the RT-5E's ESI.
    In such case, The Ethernet A-D per EVI routes with the same ET-ID as the RT-5E should be selected.<a href="#section-3.2-5.2.2" class="pilcrow">¶</a></p>
<p id="section-3.2-5.2.3">Note that when the RT-5E's ET-ID is X (X!=0), the ET-IDs of the selected Ethernet A-D per EVI routes (of that RT-5E) should be all X.<a href="#section-3.2-5.2.3" class="pilcrow">¶</a></p>
<p id="section-3.2-5.2.4">Note that the RT-5E's ET-ID not only just be used to select Ethernet A-D per EVI routes,
    but also be encapsulated into data packets 
    in order to keep compatible with ETI-specific Bump-in-the-wire use case.<a href="#section-3.2-5.2.4" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-5.3">* Using AOI to select ETI-Specific EADRs -</dt>
          <dd style="margin-left: 1.0em" id="section-3.2-5.4">
            <p id="section-3.2-5.4.1">In this case, the RT-1 per EVI routes corresponding to that RT-5E route 
    may (as required by specific secenarios) be selected either in the context of a BD, or in the context of the IP-VRF.<a href="#section-3.2-5.4.1" class="pilcrow">¶</a></p>
<p id="section-3.2-5.4.2">There may be multiple Ethernet A-D per EVI routes which all can match the RT-5E's ESI.
    In such case, The Ethernet A-D per EVI routes whose ET-ID are the same as the RT-5E's AOI should be selected.<a href="#section-3.2-5.4.2" class="pilcrow">¶</a></p>
<p id="section-3.2-5.4.3">Note that when the RT-5E's AOI is Y (Y!=0), the ET-IDs of the selected Ethernet A-D per EVI routes (of that RT-5E) should be all Y.<a href="#section-3.2-5.4.3" class="pilcrow">¶</a></p>
<p id="section-3.2-5.4.4">Note that when the RT-5E's ET-ID is not 0, and an AOI is advertised along with the RT-5E,
    the Ethernet A-D per EVI routes of that RT-5E should be selected according to the AOI.<a href="#section-3.2-5.4.4" class="pilcrow">¶</a></p>
<p id="section-3.2-5.4.5">Note that when a data packet is load-balanced according to 
    &lt;ESI, AOI&gt;, in Bump-in-the-wire use case, it is the RT-5E's ET-ID which should be
    encapsulated into the data packet, not the AOI.<a href="#section-3.2-5.4.5" class="pilcrow">¶</a></p>
<p id="section-3.2-5.4.6">Note that <span>[<a href="#I-D.sajassi-bess-evpn-ac-aware-bundling" class="xref">I-D.sajassi-bess-evpn-ac-aware-bundling</a>]</span> requires the Presence of Attachment Circuit ID Extended Community 
       MUST be ignored by non multihoming PEs.  It requires the remote PE (non-multihome PE, e.g. PE3)
       MUST process MAC route as defined in [RFC7432]. But the AOI of this case should be used to select ETI-Specific EADRs.
    This is non-compatible with the Attachment Circuit Extended Community, thus the new ACI-Specific Overlay Index Extended Community is defined.<a href="#section-3.2-5.4.6" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-6">Note that the usage of RT-2R's AOI in the context of an IP-VRF should be the same as the usage of RT-5E's AOI.
    but the RT-2R's non-zero ET-ID (in the context of an IP-VRF) don't have to be encapsulated (as VLAN-tag) into data packets in VXLAN EVPN.
 Note that the data packets over an IP-NVO tunnel will be raw IP packets. 
 In EVPN IRB use case, the non-zero ET-ID of a RT-2R (when it is used in IP-VRF context) 
 is also not used to select the corresponding RT-1 per EVI 
 routes (whose ET-ID will always be zero according to section 2.1 of <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span>) of that RT-2R route.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-AOI-EC">
<section id="section-3.3">
        <h3 id="name-aci-specific-overlay-index-">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-aci-specific-overlay-index-" class="section-name selfRef">ACI-specific Overlay Index Extended Community</a>
        </h3>
<p id="section-3.3-1">A new EVPN BGP Extended Community called Supplementary Overlay Index is
   introduced.  This new extended community is a transitive extended
   community with the Type field of 0x06 (EVPN) and the Sub-Type of TBD.
   It is advertised along with EVPN MAC/IP Advertisement Route (Route
   Type 2) per [RFC7432] in ACI-Sepecific Ethernet Auto-Discovery mode.  It
   may also be advertised along with EVPN Prefix Advertisement Route (Route Type 5)
   as per <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span>.  Generically
   speaking, the new extended community must be attached to any routes
   which are leant over an &lt;ESI, EVI&gt; of ACI-specific Ethernet Auto-Discovery.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The Supplementary Overlay Index Extended Community is encoded as an 8-octet
   value as follows:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<span id="name-supplementary-overlay-index"></span><div id="Fig-AOI-EC">
<figure id="figure-10">
          <div class="artwork art-text alignLeft" id="section-3.3-3.1">
<pre>
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Type=0x06     | Sub-Type=TBD  | Type  |O|Z|F=1| Flags | VLAN3 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | VLAN3(Cont.)  |         VLAN2         |         VLAN1         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-supplementary-overlay-index" class="selfRef">Supplementary Overlay Index Extended Community</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.3-4">
          <dt id="section-3.3-4.1">o F:</dt>
          <dd style="margin-left: 1.0em" id="section-3.3-4.2">
            <p id="section-3.3-4.2.1">Format Indicator, its value is always 1 in this draft.
    Other values are reserved.<a href="#section-3.3-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-4.3">o Type:</dt>
          <dd style="margin-left: 1.0em" id="section-3.3-4.4">
            <p id="section-3.3-4.4.1">.<a href="#section-3.3-4.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.3-4.4.2">
              <dt id="section-3.3-4.4.2.1">* 0-1:</dt>
              <dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2">
                <p id="section-3.3-4.4.2.2.1">VLAN-based AC-ID. Is VLAN2 an U-Tag?<a href="#section-3.3-4.4.2.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.3-4.4.2.2.2">
                  <dt id="section-3.3-4.4.2.2.2.1"> = 1:</dt>
                  <dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.2.2">
                    <p id="section-3.3-4.4.2.2.2.2.1">VLAN2 is an U-Tag.<a href="#section-3.3-4.4.2.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3-4.4.2.2.2.2.2">Note that when the ACI-Specific Overlay Index is used to slect RT-1 per EVI routes,
    the U-Tags of the AOI should not be used, because that
    the corresponding RT-1 per EVI route's ET-ID will always be advertised following the Type-0 AOI format.
    Thus a Type-1 AOI should be translated into a Type-0 AOI before it is used to select RT-1 per EVI routes.
    When the U-Tags of a Type-1 AOI is set to zero, it will change to the corresponding Type-0 AOI.<a href="#section-3.3-4.4.2.2.2.2.2" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.2.3"> = 0:</dt>
                  <dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.2.4">
                    <p id="section-3.3-4.4.2.2.2.4.1">Neither VLAN1 nor VLAN2 is an U-Tag.<a href="#section-3.3-4.4.2.2.2.4.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
</dl>
<span id="name-vlan-based-aois"></span><div id="Table-DoubleVLANs">
<table class="left" id="table-5">
                  <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-vlan-based-aois" class="selfRef">VLAN-based AOIs</a>
                  </caption>
<thead>
                    <tr>
                      <th class="text-left" rowspan="1" colspan="1">No.</th>
                      <th class="text-left" rowspan="1" colspan="1">Use Cases</th>
                      <th class="text-left" rowspan="1" colspan="1">Type</th>
                      <th class="text-center" rowspan="1" colspan="1">VLAN2</th>
                      <th class="text-center" rowspan="1" colspan="1">VLAN1</th>
                      <th class="text-left" rowspan="1" colspan="1">VLAN3</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="text-left" rowspan="1" colspan="1">1</td>
                      <td class="text-left" rowspan="1" colspan="1">
                        <a href="#untag" class="xref">untag</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">type 0</td>
                      <td class="text-center" rowspan="1" colspan="1">0</td>
                      <td class="text-center" rowspan="1" colspan="1">0</td>
                      <td class="text-left" rowspan="1" colspan="1">0</td>
                    </tr>
                    <tr>
                      <td class="text-left" rowspan="1" colspan="1">2</td>
                      <td class="text-left" rowspan="1" colspan="1">
                        <a href="#Default-Subinterface" class="xref">default</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">type 0</td>
                      <td class="text-center" rowspan="1" colspan="1">0</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#FFF" class="xref">FFF</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">0</td>
                    </tr>
                    <tr>
                      <td class="text-left" rowspan="1" colspan="1">3</td>
                      <td class="text-left" rowspan="1" colspan="1">
                        <a href="#dot1q" class="xref">dot1q</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">type 0</td>
                      <td class="text-center" rowspan="1" colspan="1">0</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#E" class="xref">E</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">0</td>
                    </tr>
                    <tr>
                      <td class="text-left" rowspan="1" colspan="1">4</td>
                      <td class="text-left" rowspan="1" colspan="1">
                        <a href="#QinQ" class="xref">QinQ</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">type 0</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#E" class="xref">E</a>
</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#I" class="xref">I</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">0</td>
                    </tr>
                    <tr>
                      <td class="text-left" rowspan="1" colspan="1">5</td>
                      <td class="text-left" rowspan="1" colspan="1">
                        <a href="#dot1q" class="xref">dot1q</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">type 1</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#U" class="xref">U</a>
</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#E" class="xref">E</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">0</td>
                    </tr>
                    <tr>
                      <td class="text-left" rowspan="1" colspan="1">6</td>
                      <td class="text-left" rowspan="1" colspan="1">
                        <a href="#Default-Subinterface" class="xref">default</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">type 1</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#U" class="xref">U</a>
</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#FFF" class="xref">FFF</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">0</td>
                    </tr>
                    <tr>
                      <td class="text-left" rowspan="1" colspan="1">7</td>
                      <td class="text-left" rowspan="1" colspan="1">
                        <a href="#Default-Subinterface" class="xref">default</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">type 1</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#U" class="xref">U</a>
</td>
                      <td class="text-center" rowspan="1" colspan="1">
                        <a href="#FFF" class="xref">FFF</a>
</td>
                      <td class="text-left" rowspan="1" colspan="1">
                        <a href="#U-Tag2" class="xref">U-Tag2</a>
</td>
                    </tr>
                  </tbody>
                </table>
</div>
<p id="section-3.3-4.4.2.2.4">Notes:<a href="#section-3.3-4.4.2.2.4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-3.3-4.4.2.2.5">
                  <dt id="section-3.3-4.4.2.2.5.1">
<div id="E"> E :</div>
                  </dt>
<dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.2">
                    <p id="section-3.3-4.4.2.2.5.2.1">That field is the External VLAN of the AC.<a href="#section-3.3-4.4.2.2.5.2.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.5.3">
<div id="I"> I :</div>
                  </dt>
<dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.4">
                    <p id="section-3.3-4.4.2.2.5.4.1">That field is the Internal VLAN of the AC.<a href="#section-3.3-4.4.2.2.5.4.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.5.5">
<div id="U"> U :</div>
                  </dt>
<dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.6">
                    <p id="section-3.3-4.4.2.2.5.6.1">That field is a U-Tag of a packet received by the AC.<a href="#section-3.3-4.4.2.2.5.6.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.5.7"> 0 :</dt>
                  <dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.8">
                    <p id="section-3.3-4.4.2.2.5.8.1">The tag corresponding to that field is absent.<a href="#section-3.3-4.4.2.2.5.8.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.5.9">
<div id="FFF"> FFF :</div>
                  </dt>
<dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.10">
                    <p id="section-3.3-4.4.2.2.5.10.1">The AC is the <span><a href="#Default-Subinterface" class="xref">default subinterface</a> (<a href="#Default-Subinterface" class="xref">Section 3.3</a>)</span> of the corresponding ES.<a href="#section-3.3-4.4.2.2.5.10.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.5.11">
<div id="untag"> untag :</div>
                  </dt>
<dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.12">
                    <p id="section-3.3-4.4.2.2.5.12.1">An untagged subinterface should be matched by that format.<a href="#section-3.3-4.4.2.2.5.12.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.5.13">
<div id="Default-Subinterface"> default :</div>
                  </dt>
<dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.14">
                    <p id="section-3.3-4.4.2.2.5.14.1">A default subinterface should be matched by that format.
    When the AC is a default subinterface, it will match all the remaining 
    VLAN-tags (which are left over by other subinterfaces) on its main-interface.<a href="#section-3.3-4.4.2.2.5.14.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.5.15">
<div id="dot1q"> dot1q :</div>
                  </dt>
<dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.16">
                    <p id="section-3.3-4.4.2.2.5.16.1">A dot1q subinterface should be matched by that format.<a href="#section-3.3-4.4.2.2.5.16.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.5.17">
<div id="QinQ"> QinQ :</div>
                  </dt>
<dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.18">
                    <p id="section-3.3-4.4.2.2.5.18.1">A QinQ subinterface should be matched by that format.<a href="#section-3.3-4.4.2.2.5.18.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-3.3-4.4.2.2.5.19">
<div id="U-Tag2"> U-Tag2 :</div>
                  </dt>
<dd style="margin-left: 2.0em" id="section-3.3-4.4.2.2.5.20">
                    <p id="section-3.3-4.4.2.2.5.20.1">The Inner VLAN-Tag of the U-Tag which is corresponding to VLAN2 field.
        It is only used for the type-1 AOI of a main interface's default subinterface.<a href="#section-3.3-4.4.2.2.5.20.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
<dt id="section-3.3-4.4.2.3">* 2-7:</dt>
              <dd style="margin-left: 2.0em" id="section-3.3-4.4.2.4">
                <p id="section-3.3-4.4.2.4.1">Reserved.<a href="#section-3.3-4.4.2.4.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.3-4.4.2.5">* 8-15:</dt>
              <dd style="margin-left: 2.0em" id="section-3.3-4.4.2.6">
                <p id="section-3.3-4.4.2.6.1">Reserved until all of 2-7 are used, or the first bit should be used as a specail flag.<a href="#section-3.3-4.4.2.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-4.5">o O Flag:</dt>
          <dd style="margin-left: 1.0em" id="section-3.3-4.6">
            <p id="section-3.3-4.6.1">Overlay Index Flag, this extended community is used as overlay index.<a href="#section-3.3-4.6.1" class="pilcrow">¶</a></p>
<p id="section-3.3-4.6.2">When type field is 0-1:
   For ACI-Specific Ethernet auto-discovery mode, 
   when it is carried along with a RT-2 route, 
   the O Flag should be set to 1,
   For BDI-Specific Ethernet auto-discovery, 
   when it is carried along with a RT-2 route, 
   the O Flag should be set to 0.<a href="#section-3.3-4.6.2" class="pilcrow">¶</a></p>
<p id="section-3.3-4.6.3">When the O Flag is set to 1, this AC-ID is also called as AOI (ACI-Specific Overlay Index),
   and the &lt;ESI, AOI&gt; of that RT-2R or RT-5E should be used to determine ECMP pathes.
   At the same time, the AOI should also be used like Attachment Circuit ID Extended Community too.<a href="#section-3.3-4.6.3" class="pilcrow">¶</a></p>
<p id="section-3.3-4.6.4">Note that only the lowest 8 bits of VLAN3 field should be used to select RT-1 per EVI routes.
   &lt;lowest 8 bits of VLAN3, VLAN2, VLAN1&gt; of a type-0 AOI forms an Ethernet Tag ID of an ACI-Specific EADR.<a href="#section-3.3-4.6.4" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-4.7">o Z Flag:</dt>
          <dd style="margin-left: 1.0em" id="section-3.3-4.8">
            <p id="section-3.3-4.8.1">Must be zero. Reserved for future use, 
    the receiver should ignore this extended coummunity if Z flag is not zero at now.<a href="#section-3.3-4.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-4.9">o Flags:</dt>
          <dd style="margin-left: 1.0em" id="section-3.3-4.10">
            <p id="section-3.3-4.10.1">Reserved for future use. it is set to 0 on advertising, and ignored on receiving.<a href="#section-3.3-4.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-5">Note that although this extended community is actually an extension of the AC-ID extended community (as per <span>[<a href="#I-D.sajassi-bess-evpn-ac-aware-bundling" class="xref">I-D.sajassi-bess-evpn-ac-aware-bundling</a>]</span>),
   we can assume that they may be of different Sub-Types because that they have different behaviors.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2">
<section id="section-3.4">
        <h3 id="name-arp-nd-synching-and-ip-alia">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-arp-nd-synching-and-ip-alia" class="section-name selfRef">ARP/ND Synching and IP Aliasing</a>
        </h3>
<div id="sect-2.1">
<section id="section-3.4.1">
          <h4 id="name-constructing-mac-ip-adverti">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-constructing-mac-ip-adverti" class="section-name selfRef">Constructing MAC/IP Advertisement Route</a>
          </h4>
<p id="section-3.4.1-1">
   This draft introduces a new usage/construction of MAC/IP
   Advertisement route to enable Aliasing for IP addresses in L3EVI use-cases.  The usage/construction of this route remains similar
   to that described in <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span> with a few notable exceptions as below.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.1-2.1">
   The Route-Distinguisher should be set to the corresponding L3EVI
   context.<a href="#section-3.4.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.4.1-2.2">
   The Ethernet Tag ID should be set to a value according to <a href="#Table-IRB-Combines" class="xref">Table 2</a>'s IP-ETI column.<a href="#section-3.4.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.4.1-2.3">
              <p id="section-3.4.1-2.3.1">The ACI should be set to a value according to <a href="#Table-IRB-Combines" class="xref">Table 2</a>'s IP-ACI column.<a href="#section-3.4.1-2.3.1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2.3.2">Note that the ACI may be encapsulated as Attachment Circuit ID Extended Communinty or ACI Extended Community.
 If it is encapsulated as ACI Extended Communinty, the &lt;ESI, ACI&gt; will be used to select IP-AD/EVI routes by PE3,
 and the selected IP-AD/EVI routes are used to determine the aliasing pathes of this RT-2 route.
 But if it is encapsualted as Attachment Circuit ID Extended Community, PE3 will ignore it,
 and the aliasing pathes of this RT-2 route will be determined by &lt;ESI, ET-ID&gt; as per <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.<a href="#section-3.4.1-2.3.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.4.1-2.4">
              <p id="section-3.4.1-2.4.1">In EVPN IRB, The ESI SHOULD be set to the ESI of the L2 AC from which
   the ARP entry is snooped as per <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span>.<a href="#section-3.4.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2.4.2"> In EVPN signalled L3VPN, The ESI SHOULD be set to the ESI of the VRF interface from which
   the ARP entry is learnt.<a href="#section-3.4.1-2.4.2" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2.4.3">
   Note that the &lt;ESI,ACI&gt; is used to install the synched ARP entries
   to corresponding VRF interfaces on PE1/PE2.  But on PE3, the &lt;ESI,ACI&gt; is used to load
   balance traffics.<a href="#section-3.4.1-2.4.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.4.1-2.5">
   The MAC/IP Advertisement SHOULD carry one or more IP VRF Route-
   Target (RT) attributes.<a href="#section-3.4.1-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.4.1-2.6">
              <p id="section-3.4.1-2.6.1">In EVPN Signalled L3VPN, the MPLS Label1 should be set to the same pre-configured value for all local ARP entries.
   It is just used to be compatible with existing RRs.<a href="#section-3.4.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2.6.2">In EVPN IRB, the MPLS Label1 should follow <span>[<a href="#I-D.ietf-bess-evpn-inter-subnet-forwarding" class="xref">I-D.ietf-bess-evpn-inter-subnet-forwarding</a>]</span>.<a href="#section-3.4.1-2.6.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.4.1-2.7">
   The MPLS Label2 should be set to the local label of the IP-VRF in
   MPLS or VXLAN EVPN.  But it should be set to implicit-null in SRv6
   EVPN. This is the same as <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span>.<a href="#section-3.4.1-2.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.4.1-2.8">
   The RMAC Extended Community attribute SHOULD be carried in VXLAN EVPN.
   This follows <span>[<a href="#I-D.ietf-bess-evpn-inter-subnet-forwarding" class="xref">I-D.ietf-bess-evpn-inter-subnet-forwarding</a>]</span>.<a href="#section-3.4.1-2.8" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="sect-2.2">
<section id="section-3.4.2">
          <h4 id="name-constructing-ip-ad-evi-rout">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-constructing-ip-ad-evi-rout" class="section-name selfRef">Constructing IP-AD/EVI Route</a>
          </h4>
<p id="section-3.4.2-1">
   The usage/construction of this route is similar to the IP-AD per EVI route
   described in <span>[<a href="#I-D.sajassi-bess-evpn-ip-aliasing" class="xref">I-D.sajassi-bess-evpn-ip-aliasing</a>]</span> with a few notable
   exceptions as below.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2-2.1">
   The Ethernet Tag ID (ET-ID) should be set to a value according to <a href="#Table-IRB-Combines" class="xref">Table 2</a>'s EADR-ETI column.<a href="#section-3.4.2-2.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="sect-2.3">
<section id="section-3.5">
        <h3 id="name-constructing-ip-prefix-adve">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-constructing-ip-prefix-adve" class="section-name selfRef">Constructing IP Prefix Advertisement Route</a>
        </h3>
<p id="section-3.5-1"> When an IP Prefix Advertisement is advertised,
 The Ethernet Tag ID is recommanded to be carried along with it, 
 if it is not clear that whether there will be conflictions among IP A-D per EVI routes in the future.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">Note that the Ethernet Tag ID here is not used to isolate IP address spaces.
 It is just used to resolve its ESI overlay index to a proper IP A-D per EVI route.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">The AC-ID extended community can't be considered as a substitute of the ET-ID.
 Because that the AC-ID is not the key of IP A-D per EVI routes, but the ET-ID is.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<div id="Paragraph-Bump-Wire-Reference">
<p id="section-3.5-4">Arguably, non-reserved Ethernet Tag ID in the RT-5 route, could be
   assumed that it is already in <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span>,
   because that when the BD-10 of the Bump-in-the-wire use-case is of an EVI of VLAN-aware bundl service interface,
   non-reserved ethernet tag ID will be carried along with Ethernet A-D per EVI routes,
   hence non-reserved Ethernet Tag ID should be carried along with IP Prefix Advertisement Routes too.
   Otherwise those Ethernet A-D per EVI routes can not be referred by these IP Prefix Advertisement Routes.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="sect-Secenes-Specific">
<section id="section-3.6">
        <h3 id="name-secenario-specific-procedur">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-secenario-specific-procedur" class="section-name selfRef">Secenario-Specific Procedures</a>
        </h3>
<div id="sect-IRB-specific">
<section id="section-3.6.1">
          <h4 id="name-evpn-irb-specific-procedure">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-evpn-irb-specific-procedure" class="section-name selfRef">EVPN-IRB Specific Procedures</a>
          </h4>
<p id="section-3.6.1-1">PE1 may advertise two IP A-D per EVI routes for subinterface P1.1, one (say R1_110b) is for BD-10, the other (that R1_110) is for IP-VRF.
 The Ethernet Tag ID of R1_110b is zero per <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, but the Ethernet Tag ID of R1_110 is set to the VLANs of P1.1 according to this draft.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<p id="section-3.6.1-2">When PE1 advertise a RT-5 Route for a prefix behind BD-10, 
 the Ethernet Tag ID of that RT-5 Route is determined 
 by the out-interface (P1.1) of the MAC of that prefix's overlay nexthop (10.0.0.2).<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
<p id="section-3.6.1-3">Note that R1_110b will not be imported into the IP-VRF.<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
<p id="section-3.6.1-4">PE1 may advertise two RT-2 routes for N1's MAC/IP, one (say R2_N1b) is for BD-10, the other (that R2_N1) is for the IP-VRF.
 The Ethernet Tag ID of R2_N1b is zero per <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, but the Ethernet Tag ID of R2_N1 is set to the VLANs of P1.1 according to this draft.<a href="#section-3.6.1-4" class="pilcrow">¶</a></p>
<p id="section-3.6.1-5">The MAC-VRFs and IP-VRFs in this solution will have their own copy of EVPN routes,
    This issue can be improved using the mechanisms of <a href="#sect-on-unqualified" class="xref">Section 3.6.2</a>, 
 if interoperation between VLAN-based service interface and VLAN-aware service interface per <span>[<a href="#I-D.ietf-bess-evpn-modes-interop" class="xref">I-D.ietf-bess-evpn-modes-interop</a>]</span> is provisioned in this network.<a href="#section-3.6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-on-unqualified">
<section id="section-3.6.2">
          <h4 id="name-on-separated-risk-vlan-bund">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-on-separated-risk-vlan-bund" class="section-name selfRef">On Separated Risk VLAN-bundle of the same BD</a>
          </h4>
<p id="section-3.6.2-1">PE1 will advertise different Ethernet A-D per EVI routes for P1.1 and P1.2, the Ethernet Tag ID of them will be the VLANs of corresponding AC (P1.1 or P1.2).<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">Note that the MAC/IPs on P1.1 and P1.2 will be advertised along with such ET-IDs too.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
<p id="section-3.6.2-3">When PE3 receives such Ethernet A-D per EVI routes and RT-2 routes, 
 it SHOULD process them following <span>[<a href="#I-D.ietf-bess-evpn-modes-interop" class="xref">I-D.ietf-bess-evpn-modes-interop</a>]</span>'s section 3.1.2.
 As a result of that, although PE3 works in VLAN-based or VLAN-baundle Service Interface,
 Such MAC/IPs will be istalled in BD-100 and they will be resolved to those Ethernet A-D per EVI routes under the help of such ET-IDs.<a href="#section-3.6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-on-qualified">
<section id="section-3.6.3">
          <h4 id="name-on-multiple-vlan-based-acs-">
<a href="#section-3.6.3" class="section-number selfRef">3.6.3. </a><a href="#name-on-multiple-vlan-based-acs-" class="section-name selfRef">On Multiple VLAN-based ACs of the same BD</a>
          </h4>
<p id="section-3.6.3-1">PE1 will advertise different Ethernet A-D per EVI routes for P1.1 and P1.2, 
 the Ethernet Tag ID of them will be the VLANs (10 or 20) of corresponding AC (P1.1 or P1.2), not the normalized ET-ID (100).<a href="#section-3.6.3-1" class="pilcrow">¶</a></p>
<p id="section-3.6.3-2">Note that the MAC/IPs on P1.1 and P1.2 will not be advertised along with such ET-IDs too,
 They will be advertised along with the normalized ET-ID and the corresponding AC-ID extended community per <span>[<a href="#I-D.sajassi-bess-evpn-ac-aware-bundling" class="xref">I-D.sajassi-bess-evpn-ac-aware-bundling</a>]</span>.<a href="#section-3.6.3-2" class="pilcrow">¶</a></p>
<p id="section-3.6.3-3">When PE3 receives these two Ethernet A-D per EVI routes, it installs them separately.
 Whe PE3 receives the RT-2 route for N1's address, that route carries the AC-ID 1 of P1.1,
 PE3 will resolve it to the Ethernet A-D per EVI routes (in all-active mode) whose ET-ID are 1 (not the normalized ET-ID 100).
 Whe PE3 receives the RT-2 route for N2's address, that route carries the AC-ID 2 of P1.2,
 PE3 will resolve it to the Ethernet A-D per EVI routes (in all-active mode) whose ET-ID are 2 (not the normalized ET-ID 100).<a href="#section-3.6.3-3" class="pilcrow">¶</a></p>
<p id="section-3.6.3-4">The ET-ID fields of Ethernet A-D per EVI routes follows <a href="#Table-L2-Combine" class="xref">Table 1</a>'s AC-ETI column.
 The ET-ID fields of RT-2 routes follows <a href="#Table-L2-Combine" class="xref">Table 1</a>'s BD-ID column.
 The AOI/AC-ID extended community follows <a href="#Table-L2-Combine" class="xref">Table 1</a>'s ACI-T column.<a href="#section-3.6.3-4" class="pilcrow">¶</a></p>
<p id="section-3.6.3-5">In this case, the ACI-specific EADRs can be used to do AC-influenced DF-election procedures.
 Each VLAN of that ES may have individual DF-election result.<a href="#section-3.6.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-BumpWire-Specific">
<section id="section-3.6.4">
          <h4 id="name-bump-in-the-wire-specific-p">
<a href="#section-3.6.4" class="section-number selfRef">3.6.4. </a><a href="#name-bump-in-the-wire-specific-p" class="section-name selfRef">Bump-in-the-wire Specific Procedures</a>
          </h4>
<span id="name-sbd-of-bump-in-the-wire"></span><div id="Fig-Bump-Wire-SBD">
<figure id="figure-11">
            <div class="artwork art-text alignLeft" id="section-3.6.4-1.1">
<pre>
          TS2                          NVE2
    +--------------+           +---------------+
    |              |           |               |
SN7-----(N2-M4)__  |           |  __(BD-20)    |
    |            \ |       IF2 | /             |
    |             ===============              +-------+
    |          __/ |   ESI23   | \__           |       |
 +----- (N1-M2)    |     +     |    (BD-10)    |       |  DGW8
 |  |              |     |     |               |   +---+-----+
 |  +--------------+     |     +---------------+   | (SBD8)  |
 |                       |                         |   |     |
SN1                      |                         |   |IRB8 |
 |        TS3            |             NVE3        |   |     |
 |  +--------------+     |     +---------------+   |(IP-VRF)-+-+H8
 |  |              |     |     |               |   +---+-----+
 +------(N1-M3)__  |     +     |  __(BD-10)    |       |
    |            \ |   ESI23   | /             |       |
    |             ===============              +-------+
    |          __/ |       IF3 | \__           |
SN7-----(N2-M5)    |           |    (BD-20)    |
    |              |           |               |
    +--------------+           +---------------+

</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-sbd-of-bump-in-the-wire" class="selfRef">SBD of Bump-in-the-wire</a>
            </figcaption></figure>
</div>
<p id="section-3.6.4-2">We can assume that maybe neither BD-10 nor BD-20 will be configured on DGW8, as illustrated in <a href="#Fig-Bump-Wire-SBD" class="xref">Figure 11</a>. 
   In such case, we assume that a SBD (Supplementary BD) can be provisoned on DGW1.<a href="#section-3.6.4-2" class="pilcrow">¶</a></p>
<p id="section-3.6.4-3">The SBD8 is similar to the SBD of section 4.4.3 of <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span>,
   except for the following factors:<a href="#section-3.6.4-3" class="pilcrow">¶</a></p>
<p style="margin-left: 1.5em" id="section-3.6.4-4">The SBD8 will import all the RT-5E routes and the RT-1 routes which are advertised 
   for BD-10 and BD-20 (and other such BDs of Bump-in-the-wire use cases) by the NVEs of that DC,
   But the SBD8 don't import other EVPN routes.
   and it don't have to advertise any EVPN routes (e.g. IMET route) 
   because there are no hosts (even the IP address of IRB8 will not be provisoned in this case) in the SBD.<a href="#section-3.6.4-4" class="pilcrow">¶</a></p>
<p id="section-3.6.4-5">Note that DGW3 will advertise the IP prefixes of the IP-VRF using its own EVPN label and route-targets.
   It don't have to expect any data packets to be received from such SBD.<a href="#section-3.6.4-5" class="pilcrow">¶</a></p>
<p id="section-3.6.4-6">The route advertisement behavior of NVE2 and NVE3 should also be changed:<a href="#section-3.6.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6.4-7.1">
              <p id="section-3.6.4-7.1.1">ACI-specific ethernet auto-discovery mode should be used 
   when NVEs advertise the RT-1 routes of Bump-in-the-wire use case.
   Otherwise the RT-1 routes from BD-10 and BD-20 will conflict with each other,
   because that both BD-10 and BD-20 are of VLAN-based Servcice Interface.<a href="#section-3.6.4-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.6.4-7.2">
              <p id="section-3.6.4-7.2.1">ACI-specific Overlay Index extended community should be advertised along with the RT-5E routes.
   Thus the ET-ID of these RT-5E routes can be set to zero because that BD-10 and BD-20 are ETI-agnostic BDs.<a href="#section-3.6.4-7.2.1" class="pilcrow">¶</a></p>
<p id="section-3.6.4-7.2.2">Note that the combination of &lt;ESI, AOI&gt; will be used to select 
   the corresponding RT-1 per EVI routes for these RT-5E routes
   by SBDs of other PEs.<a href="#section-3.6.4-7.2.2" class="pilcrow">¶</a></p>
<p id="section-3.6.4-7.2.3">The RT-5E routes (for the CE-prefixes behind each BD) should be advertised follows <a href="#Table-IRB-Combines" class="xref">Table 2</a>.
   Note that the IP-ETI, EADR-ETI and IP-ACI should be determined by the outgoing AC per each CE-prefix's VA MAC.
   The IP-ETI is set to the BD-ID of that outgoing AC's BD.
   Given that &lt;AC, BD&gt; is ACI-Specific EAD mode, 
   the IP-ACI is the AOI extended comunity for that &lt;AC, BD&gt;, 
   and the EADR-ETI is the same value as the IP-ACI.<a href="#section-3.6.4-7.2.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.6.4-7.3">
              <p id="section-3.6.4-7.3.1">The MAC addresses of IRB interfaces of each BD (e.g. BD-10 and BD-20) 
   should be the same as the SBD IRB interfaces of the same L3 EVI,
   otherwise the source MAC may be not expected to be learnt by the CE-side L2 switches.<a href="#section-3.6.4-7.3.1" class="pilcrow">¶</a></p>
<p id="section-3.6.4-7.3.2">Note that although the NVEs of the original Bump-in-the-wire don't have an IP-VRF instance,
   it will be no difficult for the RT5E_SN1 and RT1_ESI23 are used when there is 
   an IP-VRF (where SN9 is learnt by a CE-BGP session) and IRBs on each of the NVEs.
   In such case, maybe it will be better for the NVEs 
   to advertise its IRB (e.g. BD-10's IRB) MAC along with RT1_ESI23 (which is for BD-10)
   in order to indicate DGW8 to encapsulate that MAC as source MAC.
   By doing so, there will be no need for SBDs, 
   thus the RT-5E routes and RT-1 per EVI routes can be advertised and imported using the IP-VRF's route-targets.
   The RT-1 per EVI routes (whose MPLS label identifies that BD) can be advertised along with both BD's RT and IP-VRF's RT.
   thus the amount of RT-1 per EVI routes will not be increased.<a href="#section-3.6.4-7.3.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.6.4-8">Note that in Bump-in-the-wire use cases,
   the EVPN label that is encapsulated by DGW1/DGW3 for NVE2 or NVE2 will be a label that identifies a L2 EVI.
   So when the BD is an ETI-Specific BD, the IP-ETI MUST be encapsulated into the ethernet header of the data packets.
   Otherwise such data packets won't be received by that BD.<a href="#section-3.6.4-8" class="pilcrow">¶</a></p>
<p id="section-3.6.4-9">Note that in Bump-in-the-wire use cases,
   even if the BD is a MPLS EVPN BD,
   PE3 should send data packets to NVE2/NVE3 along with the overlay ethernet header (whose SA is the SBD IRB's MAC address),
   because the Bump-in-the-wire use case is actually a special EVPN IRB use case. 
   Otherwise NVE2/NVE3 can't decapsulate the data packets properly.<a href="#section-3.6.4-9" class="pilcrow">¶</a></p>
<p id="section-3.6.4-10">Note that in such case, the RT-5E routes technically can be directly imported into the IP-VRF identified by its route-target.
   only if there would be no more than one SBD in a specified IP-VRF.
   In original Bump-in-the-wire use-case, if there would be no more than one BD in a specified IP-VRF,
   the the RT-5E routes technically can be directly imported into 
   the IP-VRF identified by its route-target (which is determined by policy, 
   because a RT-5E route itself will be learnt by policy too, according to <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span>).
   For backward comptibility with such implementations, 
   the ET-ID (if it is not zero) of these RT-5E routes may be used to selected RT-1 per EVI routes from the only BD of that IP-VRF,
   and in such case it should be encapsulated into the ethernet header (in VXLAN EVPN) of the corresponding data packets,
   because that the RT-1 per EVI routes of Bump-in-the-wire use case are advertised for BD-10,
   and BD-10 may use VLAN-aware bundle service interface according to <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span>.<a href="#section-3.6.4-10" class="pilcrow">¶</a></p>
<p id="section-3.6.4-11">The ESIs of these RT-5E routes are used to selecte RT-1 per EVI routes in the context of a BD,
   as described in <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span>.
   When the ESIs of RT-5E routes are used to selected RT-1 per EVI routes in the context of an IP-VRF,
   it seems that this is not explicitly described in <span>[<a href="#I-D.ietf-bess-evpn-prefix-advertisement" class="xref">I-D.ietf-bess-evpn-prefix-advertisement</a>]</span>.<a href="#section-3.6.4-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-Probing-Specific">
<section id="section-3.6.5">
          <h4 id="name-arp-nd-probing-specific-pro">
<a href="#section-3.6.5" class="section-number selfRef">3.6.5. </a><a href="#name-arp-nd-probing-specific-pro" class="section-name selfRef">ARP/ND Probing Specific Procedures</a>
          </h4>
<p id="section-3.6.5-1">When PE1 synchs the ARP/ND entry of H21a to PE2,
 The AOI extended community is carried along with the RT-2 route for H21a.
 The AOI extended community is constructed in the following format:<a href="#section-3.6.5-1" class="pilcrow">¶</a></p>
<p style="margin-left: 2.0em" id="section-3.6.5-2">The Type-1 AOI is used, the VLAN1 field is the VLAN ID of subinterface P1.1 (see <a href="#Fig-ARP-Probing" class="xref">Figure 9</a>),
 and the VLAN2 field is the C-VLAN (that's C-VLAN 31) against which that ARP/ND entry is learnt on P1.1.<a href="#section-3.6.5-2" class="pilcrow">¶</a></p>
<p id="section-3.6.5-3">When PE2 receives the RT-2 route of H21a,
 it don't use the VLAN2 field to install the MAC/ARP/ND entry,
 because that VLAN2 field is a U-Tag, which would not have been configured on subinterface P2.1.
 PE2 use VLAN1 field to install the MAC/ARP/ND entry on P2.1,
 but VLAN2 field as an U-Tag are also recorded into the ARP/ND entry.<a href="#section-3.6.5-3" class="pilcrow">¶</a></p>
<p id="section-3.6.5-4">When PE2 decide to trigger the ARP/ND Probing for H21a,
 the ARP/ND request should be sent over P2.1 along with VLAN2 field as its inner VLAN-tag (the outer VLAN-tag will be VLAN1 field).<a href="#section-3.6.5-4" class="pilcrow">¶</a></p>
<p id="section-3.6.5-5">Note that it is not necessary for an U-Tag to be recorded in any MAC entries.<a href="#section-3.6.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-IANA">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-4-1">A new transitive extended community Type of 0x06 and Sub-Type of TBD
   for EVPN Supplementary Overlay Index Extended Community needs to be allocated
   by IANA.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-security">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">TBD.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-bess-evpn-modes-interop">[I-D.ietf-bess-evpn-modes-interop]</dt>
        <dd>
<span class="refAuthor">Krattiger, L.</span>, <span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Thoria, S.</span>, <span class="refAuthor">Rabadan, J.</span>, and <span class="refAuthor">J. Drake</span>, <span class="refTitle">"EVPN Interoperability Modes"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-modes-interop-00</span>, <time datetime="2021-05-31" class="refDate">31 May 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-modes-interop-00">https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-modes-interop-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-srv6-services">[I-D.ietf-bess-srv6-services]</dt>
        <dd>
<span class="refAuthor">Dawra, G.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Zhuang, S.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"SRv6 BGP based Overlay Services"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-srv6-services-07</span>, <time datetime="2021-04-11" class="refDate">11 April 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-bess-srv6-services-07">https://datatracker.ietf.org/doc/html/draft-ietf-bess-srv6-services-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.sajassi-bess-evpn-ip-aliasing">[I-D.sajassi-bess-evpn-ip-aliasing]</dt>
        <dd>
<span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Badoni, G.</span>, <span class="refAuthor">Warade, P.</span>, <span class="refAuthor">Pasupula, S.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"EVPN Support for L3 Fast Convergence and Aliasing/Backup Path"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-sajassi-bess-evpn-ip-aliasing-02</span>, <time datetime="2021-06-08" class="refDate">8 June 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-sajassi-bess-evpn-ip-aliasing-02">https://datatracker.ietf.org/doc/html/draft-sajassi-bess-evpn-ip-aliasing-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.sajassi-bess-evpn-ac-aware-bundling">[I-D.sajassi-bess-evpn-ac-aware-bundling]</dt>
        <dd>
<span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Brissette, P.</span>, <span class="refAuthor">Mishra, M. P.</span>, <span class="refAuthor">Thoria, S.</span>, <span class="refAuthor">Rabadan, J.</span>, and <span class="refAuthor">J. Drake</span>, <span class="refTitle">"AC-Aware Bundling Service Interface in EVPN"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-sajassi-bess-evpn-ac-aware-bundling-04</span>, <time datetime="2021-07-11" class="refDate">11 July 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-sajassi-bess-evpn-ac-aware-bundling-04">https://datatracker.ietf.org/doc/html/draft-sajassi-bess-evpn-ac-aware-bundling-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-evpn-prefix-advertisement">[I-D.ietf-bess-evpn-prefix-advertisement]</dt>
        <dd>
<span class="refAuthor">Rabadan, J.</span>, <span class="refAuthor">Henderickx, W.</span>, <span class="refAuthor">Drake, J.</span>, <span class="refAuthor">Lin, W.</span>, and <span class="refAuthor">A. Sajassi</span>, <span class="refTitle">"IP Prefix Advertisement in EVPN"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-prefix-advertisement-11</span>, <time datetime="2018-05-18" class="refDate">18 May 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-prefix-advertisement-11">https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-prefix-advertisement-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-evpn-inter-subnet-forwarding">[I-D.ietf-bess-evpn-inter-subnet-forwarding]</dt>
        <dd>
<span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Salam, S.</span>, <span class="refAuthor">Thoria, S.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"Integrated Routing and Bridging in EVPN"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-inter-subnet-forwarding-15</span>, <time datetime="2021-07-26" class="refDate">26 July 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-inter-subnet-forwarding-15">https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-inter-subnet-forwarding-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7432">[RFC7432]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Isaac, A.</span>, <span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"BGP MPLS-Based Ethernet VPN"</span>, <span class="seriesInfo">RFC 7432</span>, <span class="seriesInfo">DOI 10.17487/RFC7432</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8365">[RFC8365]</dt>
      <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Drake, J., Ed.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Shekhar, R.</span>, <span class="refAuthor">Uttaro, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"A Network Virtualization Overlay Solution Using Ethernet VPN (EVPN)"</span>, <span class="seriesInfo">RFC 8365</span>, <span class="seriesInfo">DOI 10.17487/RFC8365</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8365">https://www.rfc-editor.org/info/rfc8365</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.wang-bess-evpn-arp-nd-synch-without-irb">[I-D.wang-bess-evpn-arp-nd-synch-without-irb]</dt>
        <dd>
<span class="refAuthor">Wang, Y.</span> and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"ARP/ND Synching And IP Aliasing without IRB"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-wang-bess-evpn-arp-nd-synch-without-irb-07</span>, <time datetime="2021-08-09" class="refDate">9 August 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-wang-bess-evpn-arp-nd-synch-without-irb-07">https://datatracker.ietf.org/doc/html/draft-wang-bess-evpn-arp-nd-synch-without-irb-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.wz-bess-evpn-vpws-as-vrf-ac">[I-D.wz-bess-evpn-vpws-as-vrf-ac]</dt>
      <dd>
<span class="refAuthor">Wang, Y.</span> and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"EVPN VPWS as VRF Attachment Circuit"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-wz-bess-evpn-vpws-as-vrf-ac-01</span>, <time datetime="2021-07-28" class="refDate">28 July 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-wz-bess-evpn-vpws-as-vrf-ac-01">https://datatracker.ietf.org/doc/html/draft-wz-bess-evpn-vpws-as-vrf-ac-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Sect-appendix-PL-Explain">
<section id="appendix-A">
      <h2 id="name-explanation-for-physical-li">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-explanation-for-physical-li" class="section-name selfRef">Explanation for Physical Links of the Use-cases</a>
      </h2>
<span id="name-physical-links-illustrated"></span><div id="Fig-PhyLinks">
<figure id="figure-12">
        <div class="artwork art-text alignCenter" id="appendix-A-1.1">
<pre>
                                    +------------------+
                          PE1       | P6               |
            L2NE1        +----------+---------+        |
         +----------+    |  __(P1.1)__(VPNx)  |        |
+---+ P4 |          | P1 | /            \     |        |
|N1 |-----O==------=======&lt;             (NIz) |     P6 |    PE3
+---+    |   \    / |    | \__      __  /     |   +----+-------+
         |    |  |  |    |    (P1.2)  (VPNy)  |   |            |
         +----|P3|--+    +-----------+--------+   |      (VPNx)--+N3
              |  |                   |            |      /     |
         P3.1 |  | P3.2              | P7         | (NIz)--------+N4
              |  |        PE2        |            |      \     |
         +----|P3|--+    +-----------+--------+   |      (VPNy)--+N5
         |     \/   |    |  __(P2.2)__(VPNy)  |   |            |
+---+    |     /\   |    | /            \     |   +----+-------+
|N2 |-----O====--=========&lt;            (NIz)  |     P8 |
+---+ P5 |          | P2 | \__      __  /     |        |
         +----------+    |    (P2.1)  (VPNx)  |        |
            L2NE2        +----------+---------+        |
                                    | P8               |
                                    +------------------+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-physical-links-illustrated" class="selfRef">Physical Links Illustrated</a>
        </figcaption></figure>
</div>
<p id="appendix-A-2">There are three PEs, two L2NEs (Layer 2 Network Elements) and five L3NEs (Layer 3 Network Elements) in abobe network.
 The PEs are PE1, PE2 and PE3. The L2NEs are L2NE1 and L2NE2. The L3NEs are N1/N2/N3/N4/N5. 
 They are all illustrated in <a href="#Fig-PhyLinks" class="xref">Figure 12</a>.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">There are 9 physical links among these 10 physical devices as illustrated in <a href="#Fig-PhyLinks" class="xref">Figure 12</a>. 
 These physical links are called as PLi (i=1,2...8).
 The two physical ports of the same physical link PLi are both called as Pi (i=1,2...8).<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">As illustrated in <a href="#Fig-PhyLinks" class="xref">Figure 12</a>, some of these physical ports may have subinterfaces.
 When a subinterface's VLAN ID is j and it is physical port Pi's subinterface, that subinterface is called as Pi.j.
 For example, P1.2 is a subinterface of physical port P1 and its VLAN ID is 2.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<p id="appendix-A-5">There are three NIs (Network Instances) among PE1, PE2 and PE3. They are VPNx, VPNy and NIz.
 Two subinterfaces are attached to VPNx, they are P1.1 and P2.1.
 Other two subinterfaces are attached to VPNy, they are P1.2 and P2.2.
 N3 is also attched to VPNx, while N5 is also attached to VPNy.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<p id="appendix-A-6">There are two EVCs (Ethernet Virtual Connections) between L2NE1 and L2NE2, they are EVC1 and EVC2.
 The L2NE1's EVC1 instance (which is illustrated as the "O" on L2NE1) have three member interfaces, they are P4, P1.1 and P3.1, where P3.1 and P1.1 are of the same protection-group.
 The L2NE2's EVC1 instance have two member interfaces, they are P3.1 and P2.1.
 The L2NE2's EVC2 instance (which is illustrated as the "O" on L2NE2) have three member interfaces, they are P5, P2.2 and P3.2, where P3.1 and P1.1 are of the same protection-group.
 The L2NE1's EVC2 instance have two member interfaces, they are P3.2 and P1.2.
 The L2NE2's EVC1 instance and L2NE1's EVC2 instance are both CCC (Circuit Cross Connection) local connections.<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<p id="appendix-A-7">VPNx and VPNy are associated to NIz on each PE.<a href="#appendix-A-7" class="pilcrow">¶</a></p>
<div id="Sect-appendix-PLs-Detect">
<section id="appendix-A.1">
        <h3 id="name-failure-detections-for-p12-">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-failure-detections-for-p12-" class="section-name selfRef">Failure Detections for P1.2 (or P2.1)</a>
        </h3>
<p id="appendix-A.1-1">There is a CFM session CFM1 between P1.2 of PE1 and L2NE2's P3.2, when physical port P3 fails, the CFM session CFM1 will go down. 
 There is a CFM session CFM2 between P2.1 of PE2 and L2NE1's P3.1, when physical port P3 fails, the CFM session CFM2 will go down.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Sect-appendix-PLs-Protect">
<section id="appendix-A.2">
        <h3 id="name-protection-approaches-for-n">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-protection-approaches-for-n" class="section-name selfRef">Protection Approaches for N1 (or N2)</a>
        </h3>
<div id="Sect-appendix-CCC-Approaches">
<section id="appendix-A.2.1">
          <h4 id="name-ccc-approaches">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-ccc-approaches" class="section-name selfRef">CCC-Approaches</a>
          </h4>
<p id="appendix-A.2.1-1"> The L2NE1's EVC2 instance and L2NE2's EVC1 instance are both CCC local connections too.
 In L2NE1's EVC1 instance, P1.1 and P3.1 are of the same protection-group PG1.
 In L2NE2's EVC2 instance, P2.2 and P3.2 are of the same protection-group PG2.
 In PG1, both P1.1 and P3.1 will receive data packets.
 In PG2, both P2.2 and P3.2 will receive data packets.<a href="#appendix-A.2.1-1" class="pilcrow">¶</a></p>
<div id="Sect-appendix-AA-CCC-Approache">
<section id="appendix-A.2.1.1">
            <h5 id="name-ccc-active-active-protectio">
<a href="#appendix-A.2.1.1" class="section-number selfRef">A.2.1.1. </a><a href="#name-ccc-active-active-protectio" class="section-name selfRef">CCC Active-Active Protection</a>
            </h5>
<p id="appendix-A.2.1.1-1">L2NE1 (or L2NE2) will load-balance N1's (N2's) data packets between P1.1 and P3.1 (or P2.2 and P3.2).<a href="#appendix-A.2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Sect-appendix-AS-CCC-Approache">
<section id="appendix-A.2.1.2">
            <h5 id="name-ccc-active-standby-protecti">
<a href="#appendix-A.2.1.2" class="section-number selfRef">A.2.1.2. </a><a href="#name-ccc-active-standby-protecti" class="section-name selfRef">CCC Active-Standby Protection</a>
            </h5>
<p id="appendix-A.2.1.2-1">In PG1, P1.1 is the active path, P3.1 is the backup path.
 In PG2, P2.2 is the active path, P3.2 is the backup path.<a href="#appendix-A.2.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.1.2-2">That's saying that L2NE1 (or L2NE2) will not send N1's (or N2's) data packets over P3.1 (or P3.2), 
 unless P1.1 (or P2.2) or P1 (or P2) has been in failure before that data forwarding.<a href="#appendix-A.2.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Sect-appendix-VSI-Approaches">
<section id="appendix-A.2.2">
          <h4 id="name-vsi-approaches">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-vsi-approaches" class="section-name selfRef">VSI-Approaches</a>
          </h4>
<p id="appendix-A.2.2-1"> L2NE1's EVC2 instance and L2NE2's EVC1 instance are both VSI instances in this case.
 P1.1, P3.1, P2.2 and P3.2 are all individual ACs in these VSIs.<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-2">Note that L2NE2's EVC1 instance and L2NE1's EVC2 instance are still both CCC local connections in this case,
 and there is no PG1 or PG2 in this case, and there are no PWs in this case.<a href="#appendix-A.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yubao Wang</span></div>
<div dir="auto" class="left"><span class="org">ZTE Corporation</span></div>
<div dir="auto" class="left"><span class="street-address">No.68 of Zijinghua Road, Yuhuatai Distinct</span></div>
<div dir="auto" class="left"><span class="locality">Nanjing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wang.yubao2@zte.com.cn" class="email">wang.yubao2@zte.com.cn</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
