 INTERNET-DRAFT                                       Kishore Tiruveedhula
 Intended Status: Informational                        Sudhin Jacob
 Expires: October 7,2018                             Juniper Networks
                                                    February 26,2018


         Benchmarking Methodology for EVPN and PBB-EVPN 
                draft-kishjac-bmwg-evpntest-09


Abstract

This document defines methodologies for benchmarking EVPN and PBB-EVPN performance.
EVPN is defined in RFC 7432, and is being deployed in Service Provider networks. 
This document specifically covers methodologies for benchmarking EVPN/PBB-EVPN 
convergence, data plane performance, control plane performance.


Status of this Memo

    This Internet-Draft is submitted in full conformance with the  
   provisions of BCP 78 and BCP 79.

      Internet-Drafts are working documents of the Internet Engineering 
    Task Force (IETF).  Note that other groups may also distribute  
   working documents as Internet-Drafts.  The list of current Internet- 
    Drafts is at http://datatracker.ietf.org/drafts/current/.

      Internet-Drafts are draft documents valid for a maximum of six
   months and may be updated, replaced, or obsoleted by other
   documents at any   time.  It is inappropriate to use Internet-Drafts
   as reference   material or to cite them other than as "work in
   progress."

    This Internet-Draft will expire on October 7, 2018.


Copyright and License Notice

   
   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with
   respect to this document. Code Components extracted from this
   document must include Simplified BSD License text as described in
   Section 4.e of the Trust Legal Provisions and are provided without
   warranty as described in the Simplified BSD License.










   
   


Contents
1.  Introduction ...............................................	4

1.1 Terminologies ...............................................	5

2. Test Topology.................................................	6

3. Network.......................................................	8

4. PBB-EVPN Network Setup........................................	8

5 Test Cases.....................................................	10

5.1.1 To Record the time taken to learn the MAC address in DUT...	10

5.1.2. To Record the time taken to learn remote MACs in DUT which is 
advertised by remote peer........................................	13

5.1.3. To Record the time taken to flush the local entry 
due to CE link  Failure and measure the relearning rate of MACs...	15

5.1.4. To Record the time taken by DUT to flush MACs learned from 
R1 during R1 traffic generator link failure	........................17

5.1.5. To measure the MAC aging time...............................19

5.1.6. To Record the time taken by DUT to age X routes learned from
remote PE after stopping the traffic at remote PE..................	20

5.1.7. To Record the time taken by DUT to learn routes from
local and remote...................................................	23

5.2    High Availability ........................................	25


5.2.1 To Record the whether there is traffic loss due to
routing engine fail-over for redundancy test.......................	25

5.3 ARP/ND Scaling	27

6. Scale	28

6.1. To Scale the DUT to N EVI and clear BGP in DUT without traffic. .28

6.2. To Scale the DUT to N EVI and clear BGP in DUT with traffic.
Measure the convergence time........................................  29

7. Soak Test	31

7.1. To Scale the DUT to N EVI in DUT with traffic and 
run the set up for 24hrs ........................................... 31

8. Acknowledgments	33

9.  IANA Considerations............................................	33

10.  Security Considerations	33

11 References	33

11.1 Normative References	33

11.2 Informative References	34

Authors' Addresses	35





1.  Introduction

    EVPN is defined in RFC7432 which describes procedures for
   BGP MPLS-based Ethernet VPNs(EVPN).This document defines the  
   methodologies for benchmarking performance of EVPN. The scope of 
   this document is to provide methodologies for benchmarking EVPN 
   data, control plane MAC learning, MAC flush ,MAC aging,   
   convergence, high availability, scale.
   The methodologies defined for EVPN can be used for benchmarking the
    performance of PBB-EVPN.PBB-EVPN is defined in RFC 7623.It is
   being deployed in provider network. The difference between PBB-EVPN
   and EVPN is the former learns the customer MAC in data plane the
   later learns in control plane.

   Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
   NOT",   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL"
   in this   document are to be interpreted as described in RFC 2119
   [RFC2119].











1.1 Terminologies

   MHPE Multi homed Provide Edge router.

   RR   Route Reflector

   P   Provider Router

   CE Customer Router/Devices/Switch

   MHPE2 Multi homed Provider Edge router 2	

   MHPE1 Multi homed Provider Edge router 1
 
   SHPE3 Single homed Provider Edge Router 3

   AA EVPN Terminologies AA All-Active 	

   SA EVPN Terminologies SA Single-Active

   RT Router Tester

  Sub Interface    Each physical Interfaces is subdivided in to  
                   Logical units.

 EVI   EVPN Instances which will be running on sub interface or 
       physical port of the provider Edge routers.

 DF Designated Forwarder 
 
 ESI Ethernet Segment Identifier


2. Test Topology


 EVPN/PBB-EVPN Running in SA mode:
 Figure 1
                            

                          
                           
         +-------------+
         |             |
         |             |
         |    R1(SHPE1)|
         |             | + sub interfaces
         |             | +---------------------------------+
         +-----+-------+    Router Tester (IXIA/Spirent) sending 
		       |            layer 2 bi directional traffic which acts as sender/receiver
               |
               |
               |
          +-------------+
          |    ++       |
          |             |
          |    RR/P     |
          |             |
          |             |
      +---+-------------+----+
      |                      |
      |                      |
      |                      |
+-----+-------+        +-----+-------+
|             |        |             |
|     MHPE1(DUT)       |             |
|             |        |    MHPE2    |
|             |        |             |
|             |        |             |
|             |        +------+------+
+-------------+               |
              |               |
              |     +---------+
      +-------+-------------+
      |                     |
      |         CE1         |
      |   bridge domain     | sub interfaces
      |                     +-------------------------------+
      |                     |
      +---------------------+ Router Tester (IXIA/Spirent) Sending bi
	  directional layer 2 traffic with different VLAN acts as sender/receiver

           	             
			  	

 
	                      
                                                                                                                          
    
   



 





                       

           	             
			  	

                                    
	                      
                                                                                                                          
  
3. Network

The network consists of 5 routers and 2 traffic generator ports.
The traffic generator ports are connected to R1 and CE, these RT port 
will be sending uni directional or bi directional for different vlans 
depends on the test scenario.R1 is also termed as SHPE3 which is a 
single homed router is running EVPN services. DUT(MHPE1) and MHPE2 are
running multihoming EVPN services, the CE acts as a bridge which will
send the layer 2 traffic to both DUT and MHPE2. RR is the router
reflector which is also acting as provider router. All four
routers(MHPE1,MHPE2,RR,R1) except CE are running MPLS,BGP emulating a
Service provider scenario. CE is a dual home connected to DUT and
MHPE2.The testing will be done on DUT in order to bench mark the EVPN
service. DUT and the MHPE2 are running EVPN with SA/AA, In AA EVPN 
service there will be LAG running between interfaces of CE, DUT and 
MHPE2 .The DUT and other PE's will be running N EVI's (EVPN instances) 
on <X> sub interfaces. 


 4. PBB-EVPN Network Setup

The network consists of 5 routers and 2 traffic generator ports.
The traffic generator ports are connected to R1 and CE, these ports 
will be sending bi directional or uni directional layer 2 traffic for 
different vlans depending up on the various test scenarios.
R1 is also termed as SHPE3 which is a single homed router is running 
PBB-EVPN services. DUT(MHPE1) and MHPE2 are running multihoming PBB-
EVPN services ,the CE acts as a bridge which will send the layer 2 
traffic to both DUT and MHPE2. RR is the router reflector which is 
also acting as provider router. All four routers(MHPE1,MHPE2,RR,R1) 
except CE are running MPLS,BGP emulating a Service provider 
scenarios. CE is a dual home connected to DUT and MHPE2.The testing will 
be done on DUT in order to bench mark the PBB-EVPN service. DUT and 
the MHPE2 are running PBB-EVPN with SA/AA, In AA PBB-EVPN service 
there will be LAG running between the interfaces of CE, DUT and MHPE2.
The DUT and other PE's will be running <X> EVI's (PBB-EVPN instances) 
on <X> sub interfaces.




 


5 Test Cases

The following tests are conducted to measure the time taken to learn
the <X> number of MAC's locally in EVI is "T"sec. The data plane 
learning of MAC will happen locally from connected interface. The 
control plane learning of MAC is through BGP advertisements from the 
remote PE(SHPE3). The control plane learning of <X> MAC, the time 
taken will be "T'". The data plane MAC learning can be measured using 
the parameters defined in RFC 2889 section 5.8.


5.1.1 To Record the time taken to learn the MAC address in DUT

      
Objective:

To Record the time taken to learn the MAC address locally and
time taken to send these local learned MAC routes to peers.

a. Send <X> unicast frames from CE to MHPE1(DUT) working in SA
mode with different source and destination address. Measure the time
taken to learn these MAC in forwarding table and in control plane.
The data plane learning is measured using RFC 2889 section 5.8.
Sending frames to the limit of bridge domain of particular EVI.
Measure the time taken to learn all <X> MAC in data plane/hardware.
The Range of MAC is known from RT and this is verified in DUT.

b. Measure the time taken to send these <X> type 2 routes from
DUT to its peers.
	
 Procedure:

Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and
DUT.For MH PE ESI must be configured per IFD/Interface. Using RT 
(traffic generator)to send the traffic to the CE. The traffic is 
unidirectional. Since CE is working in bridge mode, frames will be 
send to ingress sub interface of DUT. The BGP must be established in 
R1,MHPE1(DUT),RR,MHPE2.


Measurement

The DUT EVPN MAC table must learn the <X> MACs in data plane in T
Time frame. The DUT must send <X> type 2 routes to remote router in T'
Time frame. Repeat the test and plot the data. The data plane
measurement is taken by considering DUT as black box the range
of X MAC is known from RT and the same is learned in DUT, the time
to learn that is measured.

The test is repeated for "N" times and the value is taken by
averaging the values.



PBB-EVPN To Record the time taken to learn the MAC address in DUT

Objective:

To Record the time taken to learn the MAC address locally.


a. Send <X> unicast frames from CE to MHPE1(DUT) working in SA
mode with different source and destination address. Measure the time
taken to learn these MACs in forwarding table. The data plane
learning is measured using RFC 2889 section 5.8.Sending frames to
the limit of bridge domain of particular EVI. Measure the time
taken to learn all <X> MAC in data plane/hardware. The Range of
MAC is known from RT and this is verified in DUT.

Procedure:

Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE
are running MPLS,BGP,RR is acting as route reflector to R1,MHPE2
and DUT. Once the BGP comes up. Record the DUT PBB-EVPN table. For MH 
PE ESI must be configured per IFD/Interface. From RT (traffic 
generator) send the traffic to the DUT. The BGP must be established in
R1,MHPE1(DUT),RR,MHPE2. The traffic is unidirectional. Since CE is 
working in bridge mode, frames will be send to ingress sub interface 
of DUT.



Measurement

The DUT MAC table must learn the <X> MACs in data plane in T time
frame. Repeat the test and plot the data. The data plane measurement
is taken   by considering DUT as black box the range of <X> MAC is
known from RT and the same is learned in DUT, the time to learn
<X> MAC is measured. The test is repeated for "N" times and the value 
is taken by averaging the values.







 5.1.2. To Record the time taken to learn remote MACs in DUT
 which is advertised by remote peer

 Objective:

 Send <X> frames with different SA and DA to R1 from RT  
 Measure the time taken to learn these <X> MACs from remote peer in
 DUT and program the EVPN MAC address table. The DUT and MHPE2 are 
 running SA mode.

Procedure:

Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and
DUT. Record the DUT EVPN table. For MH PE ESI must be configured
per IFD/Interface. Using RT(traffic generator) send the traffic to
R1.The traffic is uni directional. There wont be any traffic flow from
CE to DUT during this test. The BGP must be in established state. The 
MACS learned in R1 will be advertised to DUT by BGP.

Measurement:

The DUT MAC table must learn the <X> MAC address in T time frame.  
Repeat these test and plot the data. The test is repeated for "N" 
times and the value is taken by averaging the values.





 PBB-EVPN To Record the time taken to learn <X> MAC's from remote   
 peer by DUT.

 Objective:

 Send <X> frames with different SA and DA to R1 from RT. Measure the 
 time taken to learn these <X>  MACs from remote peer and program the 
 MAC address table of the DUT. DUT and MHPE2 are running SA mode.

 Procedure:

 Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
 running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
 DUT. Record the DUT PBB-EVPN table. For MHPE ESI must be configured 
per IFD/Interface. Using RT(traffic generator) send the traffic to R1. 
The traffic is uni directional. There wont be any traffic flow from CE 
to DUT during this test. The BGP must be in established state.

 Measurement:

The DUT MAC table must learn the <X> MAC address in T time frame.  
Repeat these test and plot the data. The test is repeated for "N" 
times and the value is taken by averaging the values.









5.1.3. To Record the time taken to flush the local entry due to CE link  
 Failure and measure the relearning rate of MACs

Objective:

Send <X> frames with different SA and DA to DUT from CE using
traffic generator. Wait till the MHPE2 learns all <X> MAC address.
Then fail the MHPE2 CE link and measure the time taken to flush these
<X> MACs from the EVPN MAC table and the time taken to relearn it.
 The DUT and MHPE2 are running SA mode. In this scenario MHPE2 is the
 Designated forwarder which learns mac and advertises to DUT.

Procedure:

 Configure EVPN EVI in R1,MHPE2,DUT. All 4 routers except CE are  
 running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
 Once the BGP is established. Record the DUT EVPN table. For MH PE ESI 
 must be configured per IFD/Interface. Using RT(traffic generator) 
 send the traffic. In this scenario traffic will be only send from CE 
 side. 

 Measurement:

 Measure the time taken for flushing these <X> MAC address. Measure 
the time taken to relearn the <X> MACs in DUT. Repeat the test 
and plot the data. 
   



PBB-EVPN  To Record the time taken to flush the local entry due to CE link failure

Objective:

Send <X> frames with different SA and DA to DUT from CE using   
traffic generator. Wait till the MHPE2 learn all <X> MAC address. Then  
fail the MHPE2 CE link and measure the time taken to flush these <X>
 MACs from the PBB-EVPN MAC table. Measure the time taken to relearn 
<X> MACS. The DUT and MHPE2 are running SA mode.

 Procedure:

 Configure PBB-EVPN EVI in R1,MHPE2,DUT. All 4 routers except CE are
 running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and
 DUT. Once the BGP is established. Record the DUT PBB-EVPN table. 
 For MH PE ESI must be configured per IFD/Interface. Using RT(traffic
 generator) send the traffic to the CE. The traffic is uni 
 directional

 Measurement:

 The DUT MAC table must learn the <X> MAC address and measure the
 time taken for flushing these X MAC address. Measure the time taken 
to relearn these <X> MACs in DUT. Repeat the test and plot the data. 








5.1.4. To Record the time taken by DUT to flush MACs learned from R1 during R1
 traffic generator link failure

Objective:

Send <X> frames with different SA and DA to DUT from R1 using traffic 
generator. Bring down the link between R1 and traffic generator. Then 
measure the time taken to flush the DUT EVPN MAC table. The DUT and 
MHPE2 are running SA mode.

Procedure:

Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
DUT. Once the BGP is established Record the DUT EVPN table. For MHPE 
ESI must be configured per IFD/Interface. Using RT(traffic generator) 
send the traffic to R1.There wont be any traffic flowing to CE from 
RT.

Measurement:

Measure the time taken to flush <X> remote MACs from EVPN MAC table  
of DUT. Repeat the test and plot the data.

PBB-EVPN To Record the time taken by DUT to flush MACs learned     
from R1 during R1 traffic generator link failure

     


 Objective:

Send <X> frames with different SA and DA to DUT from R1 using
traffic generator. Bring down the link between R1 and traffic
generator. Then measure the time taken to flush the DUT PBB-EVPN MAC
address table. The remote MACs will be learned by Data plane, but the
B-MAC will be learned by control plane. The DUT and MHPE2 are running 
SA mode.

 Procedure:

 Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are 
 running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and
 DUT. Once the BGP is established Record the DUT PBB-EVPN MAC table. 
 For MHPE ESI must be configured per IFD/Interface. Using RT(traffic
 generator) send the traffic to R1.In this scenario traffic will 
 be flowing only from R1.


Measurement:

Measure the time taken to flush <X> remote MACs from PBB-EVPN MAC 
table of DUT. Repeat the test and plot the data.







5.1.5. To measure the MAC ageing time.

Objective:

 Send <X> frames with different SA and DA to DUT from CE using  
 traffic generator. Wait till <X> MAC address are learned. Then stop 
 the traffic. Record the time taken to flush <X> MACS from DUT EVPN 
 MAC table due to ageing. The DUT and MHPE2 are running SA mode.

Procedure:

Configure EVPN EVI in R1,MHPE2,DUT. All 4 routers except CE are  
running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
DUT .Once the BGP is established. Record the DUT EVPN table. For MHPE 
ESI must be configured per IFD/Interface. Using RT(traffic generator),
send the traffic to the DUT. The traffic will be flowing from CE  
to DUT. There wont be any traffic from R1.

Measurement:

Measure the time taken to flush <X> MAC address due to ageing. Repeat
the test and plot the data.

PBB-EVPN To measure the MAC ageing time.

Objective:

Send X frames with different SA and DA to DUT from CE using  
traffic generator. Wait till <X> MAC address are learned in DUT PBB-
EVPN MAC table. Then stop the traffic. Record the time taken to flush 
<X> MAC entries due to ageing. The DUT and MHPE2 running in SA mode

Procedure:

Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
DUT.Once the BGP is established. Record the DUT PBB-EVPN MAC table.  
For MH PE ESI must be configured per IFD/Interface. Using RT(traffic 
generator) send the traffic to the DUT. The traffic is uni directional 
flowing from CE to DUT.


Measurement:

Measure the time taken to flush <X> MAC address due to ageing. Repeat
the test and plot the data.










5.1.6. To Record the time taken by DUT to age X routes learned from   
remote PE after stopping the traffic at remote PE.

Objective:

  Send X frames with different SA and DA to DUT from R1 using  
  traffic generator. Stop the traffic at remote PE R1.  
   Due to MAC ageing R1 will withdraw its routes from DUT and MHPE2.
   Measure the time taken to remove these MACs from DUT EVPN MAC   
   table. DUT and MHPE2 are running in SA mode

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
   DUT. Once the BGP is established. Record the DUT EVPN table. For MH 
   PE ESI must be configured per IFD/Interface. Using RT(traffic 
   generator) send the traffic to R1.There wont be any traffic from    
   CE.

  Measurement:

  Measure the time taken to flush <X> remote MACs learned in DUT EVPN   
  MAC table due to ageing. Repeat the test and plot the data.


   PBB-EVPN To Record the time taken by DUT to age <X> MAC from remote
   PE after stopping the traffic at remote PE.

   Objective:

   Send <X> frames with different SA and DA to DUT from R1 using  
   traffic generator. Stop the traffic at remote PE(R1).Measure the 
   time taken to remove these remote MACs from DUT PBB-EVPN MAC   
   table. The DUT and MHPE2 are running in SA mode.

   Procedure:

   Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
   DUT. Once the BGP is established. Record the DUT MAC table. For MH 
   PE ESI must be configured per IFD/Interface. Using RT(traffic 
  Generator) send the traffic to R1. There is no traffic from CE side.

   Measurement:

  Measure the time taken to flush the <X> remote MACs from DUT PBB-
  EVPN MAC table due to ageing. Repeat the test and plot the data.

 




5.1.7. To Record the time taken by DUT to learn routes from local and remote.

Objective:

Send <X> frames with different SA and DA to DUT from R1 using
traffic generator. Send <X> frames with different SA and DA from
traffic generator connected to CE. The SA and DA of flows must be
complimentary to have unicast flows. Measure the time taken by
the DUT to learn 2X in EVPN MAC. DUT and MHPE2 are running in
SA mode.

Procedure:

Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
DUT. Once the BGP is established. Record the DUT EVPN table.  For MH 
PE ESI must be configured per IFD/Interface. Using RT(traffic 
generator) send the traffic to the routers. The traffic is bi 
directional.

Measurement:

Measure the time taken to learn <2X> MAC address in DUT EVPN MAC 
table. Repeat the test and plot the data.


PBB-EVPN To Record the time taken by DUT to learn <X> MACs from      
local and <X> from remote.

 Objective:

 Send X frames with different SA and DA to DUT from R1 using  
 traffic generator. Send <X> frames with different SA and DA from  
 traffic generator connected to CE. The SA and DA of flows must be  
 complimentary to have unicast flows. Measure the time taken by the  
  DUT to learn 2X in MAC table. DUT and MHPE2 are running in SA mode.

  Procedure:

  Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
  running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
  DUT. Once the BGP is established. Record the DUT EVPN table.For MH 
  PE ESI must be configured per IFD/Interface. Using RT(traffic 
  generator) send the traffic to the routers.

  Measurement:

 Measure the time taken to learn 2X MAC address table in DUT PBB-EVPN  
 MAC table. Repeat the test and plot the data.









 5.2    High Availability

   
5.2.1 To Record the whether there is traffic loss due to routing engine
failover for redundancy test.

Objective:

Send <X> frames from CE to DUT from traffic generator with different 
SA and DA. Send <X> frames from traffic generator to R1 with different 
SA and DA so that <2X> MAC address will be learned in DUT. There is a 
bi directional traffic flow with X pps in each direction. Then do a 
routing engine failover.

Procedure:

Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
DUT. Once the BGP is established. Record the DUT EVPN table. For MH PE 
ESI must be configured per IFD/Interface. Using RT(traffic generator) 
Send bi directional to the routers.

 Measurement:

 There should be 0 traffic loss which is the ideal case, No change in 
 the DF role. DUT should not withdraw any routes. Repeat the test and 
 plot the graph.





   PBB-EVPN To Record the whether there is traffic loss due to routing
   engine failover for redundancy test.

   Objective:

  Send <X> frames to DUT with different SA and DA from CE using 
  the traffic generator. Send <X> frames from traffic generator to   
  R1 with different SA and DA so that <2X> MAC address will be learned 
  in DUT. There is a bi directional traffic flow with <X>  pps in each
  direction. Then do a routing engine failover.


Procedure:


Configure PBB-EVPN EVI in R1,MHPE2,DUT. All 4 routers except CE are
running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and   
DUT. Once the BGP is established. Record the DUT PBB-EVPN table. For 
MH PE ESI must be configured per IFD/Interface. Using RT(traffic 
generator) send the traffic to the routers.

Measurement:

There should be 0 packet loss which is the ideal case, No change
in the DF role. There should not be any withdraw of routes from DUT.







 5.3 ARP/ND Scaling

 These tests are conducted to Record the scaling parameter of arp/ND
 of the DUT.

EVPN: To Record the ARP/ND scale of the DUT with gateway IRB
   configured.

 Objective:

Send <X> arp/icmpv6 request from RT to DUT with different sender 
ip/ipv6 address to the same target gateway ip address. Measure whether 
<X> MAC+IPv4 address/MAC+IPv6 address of the hosts are learned in DUT.


 Procedure:

 Configure EPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
 running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
 DUT. Once the BGP is established. Record the DUT EVPN table. For MH PE 
 ESI must be configured per IFD/Interface. Using RT(traffic 
 generator) send arp/ICMPv6 request to the DUT which has gateway 
  configured.

  Measurement:

  The DUT must learn <X> MAC+IPV4/MAC+IPv6 and it must advertise the X
   MAC+IPV4/MAC+IPV6 to the remote router.


 6. Scale

6.1. To Scale the DUT to N EVI and clear BGP in DUT without traffic.


Objective:

The DUT, MHPE2 and R1 are scaled to "N" EVI. Clear BGP neighbors of 
the DUT. Once the adjacency is established in DUT. Measure the routes 
received from remote routers MHPE2 and R1 for <N> EVIs in the DUT.

 Procedure:

Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
DUT. Once the BGP is established. Record the DUT EVPN table. For 
MHPE,DUT ESI must be configured per IFD/Interface. 

 Measurement

  There should not be any loss of route types 1,2,3 and 4 in DUT. DUT
  Must relearn all type 1,2,3 and 4 from remote routers.

PBB-EVPN To Scale the DUT to N PBB-EVPN instances and clear BGP in
   DUT without traffic.

Objective:

 The DUT, MHPE2 and R1 are scaled to "N" PBB-EVI. Clear BGP 
 neighbors of the DUT. Once the adjacency is established in DUT. 
Measure the routes received from remote routers MHPE2 and R1 for <N> 
EVIs in the DUT.


 Procedure:

 Configure "N" PBB-EVPN instances in R1,MHPE2,DUT.All 4 routers except
 CE are running MPLS,BGP,RR is acting as route reflector to R1,MHPE2
 and DUT. Once is established. Record the DUT PBB-EVPN table. For MH 
 PE ESI must be configured per IFD/Interface.

 Measurement

There should not be any loss of route types 2,3 and 4 in DUT. The DUT 
must relearn all type 2,3 and 4 routes from remote routers.


6.2. To Scale the DUT to N EVI and clear BGP in DUT with traffic. 
Measure the convergence time

Objective:

Scale <N> EVI's in DUT,R1 and MHPE2.Send F frames to DUT from CE using  
traffic generator with different SA and DA for N EVI's. Send <F>
frames from traffic generator to R1 with different SA and DA.
There will be <2F> number of MAC address will be learned in DUT EVPN 
MAC table. There is a bi directional traffic flow with F pps in each     
direction. Then clear the BGP neighbors in the DUT. Once the adjacency 
is restored in DUT. Measure the time taken to learn all <2F> MAC  
address in DUT MAC table.

     
 Procedure:

 Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
 running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
 DUT. Once the BGP is established. Record the DUT EVPN table. For MH 
 PE ESI must be configured per IFD/Interface. Using RT(traffic 
 generator)send the traffic to the routers.

      
Measurement:

The DUT must learn all <2F> MAC address. Measure the time taken to
 learn 2F MAC in DUT, measure the flood traffic time "t" of DUT


PBB-EVPN To Scale the DUT to "N" PBB-EVPN instances and clear BGP
in DUT with traffic. Measure the convergence time

Objective:

Scale <N> PBB-EVI's in DUT,R1 and MHPE2.Send <F> frames to DUT from CE 
using traffic generator with different SA and DA for N EVI's. Send <F>
frames from traffic generator to R1 with different SA and DA.
There will be <2F> number of MAC address will be learned in DUT PBB-
EVPN MAC table. There is a bi directional traffic flow with F pps in 
each direction. Then clear the BGP neighbors in the DUT. Once the 
adjacency is restored in DUT. Measure the time taken to learn all <2F> 
MAC address in DUT PBB-MAC table.

Procedure:

  Configure PBB-EVPN instances in R1,MHPE2,DUT.All 4 routers except
  CE are running MPLS,BGP,RR is acting as route reflector to R1,MHPE2
  and DUT. Once BGP is established. Record the DUT EVPN table. For MH 
  PE ESI must be configured per IFD/Interface. Using RT(traffic
  generator) send the traffic to the routers.

      
Measurement:

The DUT must learn all 2F MAC address. Measure the time taken  
 to learn 2F MAC in DUT, measure the flood traffic time "t" of DUT


 7. Soak Test

7.1. To Scale the DUT to N EVI in DUT with traffic and run the set up for 24hrs

Objective:

Scale <N> EVIs in DUT,R1 and MHPE2.Send F frames to DUT from CE using  
traffic generator with different SA and DA for N EVI's. Send <F>
frames from traffic generator to R1 with different SA and DA.
There will be <2F> number of MAC address will be learned in DUT EVPN 
MAC table. There is a bi directional traffic flow with F pps in each     
direction. The DUT must run with traffic for 24 hours, every hour 
check for memory leak, crash.
.





 Procedure:

 Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
 running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and  
 DUT. Once the BGP is established. Record the DUT EVPN table. For MH 
 PE ESI must be configured per IFD/Interface. Using RT(traffic 
 generator) send the traffic to the routers.

 Measurement:

Take the hourly reading of CPU, process memory. There should not be
 any leak, crashes, CPU spikes.

 
 PBB-EVPN To Scale the DUT to N PBB-EVPN instances in DUT with traffic        
 and run the set up for 24hrs

  Objective:

Scale <N> PBB-EVI's in DUT,R1 and MHPE2.Send <F> frames to DUT from CE 
using traffic generator with different SA and DA for N EVI's. Send <F>
frames from traffic generator to R1 with different SA and DA. There 
will be <2F> number of MAC address will be learned in DUT PBB-EVPN MAC 
table. There is a bi directional traffic flow with <F> pps in each     
direction. The DUT must run with traffic for 24 hours, every hour 
check the memory leak, crashes.

 Procedure:

 Configure <N> PBB-EVPN instances in R1, MHPE2, DUT. All 4 routers 
 except CE are running MPLS,BGP,RR is acting as route reflector to 
 R1,MHPE2 and DUT. Once the BGP comes up Record the DUT EVPN table. 
 for MH PE ESI must be configured per IFD/Interface. Using RT(traffic
  generator)send the traffic to the routers.

 Measurement:

 Take the hourly reading of CPU process, memory usages. There should 
 not be any memory leak, crashes, CPU spikes.





8. Acknowledgments

We would like to thank Fioccola Giuseppe of Telecom Italia
reviewing our draft and commenting it. We would like to thank Sarah 
Banks, the work group chair for guiding us in this draft.


9.  IANA Considerations

 This memo includes no request to IANA.
10.  Security Considerations

 There is no additional consideration from RFC 6192.

11 References

11.1 Normative References


            [RFC2119]  Bradner, S., "Key words for use in RFCs to
              Indicate Requirement Levels", BCP 14, RFC 2119,           
                DOI 10.17487/RFC2119, June 1997,<http://www.rfc-
              editor.org/info/rfc2119>.

            [RFC2544]  Bradner, S. and J. McQuaid, "Benchmarking
              Methodology for Network Interconnect Devices", RFC   
              2544,DOI 10.17487/RFC2544, June 1999,<http://www.rfc-
              editor.org/info/rfc2544>. 
			  
		 [RFC2889]  R.Mandeville and J. Perser "Benchmarking  
                       Methodology for LAN Switching Devices"
			  

11.2 Informative References



            [RFC7432]  Sajassi, A., Ed., Aggarwal, R., Bitar, N.,
              Isaac, A.,Uttaro, J., Drake, J., and W.Henderickx, 
			  "BGP MPLS-Based Ethernet VPN",
              RFC 7432, DOI 10.17487/RFC7432, February             
              2015, <http://www.rfc-editor.org/info/rfc7432>.

            [RFC7623]  Sajassi, A., Ed., Aggarwal, R., Bitar, N.,
              Isaac, A.,J., Drake, J., and W. Henderickx,
              " Provider Backbone Bridging Combined with Ethernet
              VPN(PBB-EVPN)",RFC 7623,10.17487/RFC7623,September 2015              
              <http://www.rfc-editor.org/info/rfc7623>.


              			  

Authors' Addresses


   Appendix A.  Appendix

   Authors' Addresses

      Sudhin Jacob (editor)
      Juniper Networks
      Bangalore
      India

      Phone: +91 8061212543
      Email: sjacob@juniper.net
             sudhinjacob@rediffmail.com



      Kishore Tiruveedhula
      Juniper Networks
      10 Technology Park Dr
      Westford, MA  01886
      USA

      Phone: +1 9785898861
      Email: kishoret@juniper.net

