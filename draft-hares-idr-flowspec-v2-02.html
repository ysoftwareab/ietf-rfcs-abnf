<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>BGP Flow Specification Version 2</title>
<meta content="Susan Hares" name="author">
<meta content="Donald Eastlake" name="author">
<meta content="
       BGP flow specification version 1 (RFC8955, RFC8956) describes the distribution
   of traffic filter policy (traffic filters and actions) which are distributed
   via BGP to BGP peers. Multiple applications utilize the BGP distributed 
   traffic filter policy.  These applications include:  
      (1) mitigation of Denial of Service (DoS), (2) enabling of traffic filtering 
      in BGP/MPLS VPNS,  and(3)centralized traffic control for networks utilizing either 
   SDN control of router firewall functions. During the deployment of BGP flow specification 
   v1, the following issues were detected:  1) problems due to the lack of clear TLV encoding 
   for rules for flow specifications, 2) desire to order filters rules, and 3) 
   ordering of actions to provide deterministic actions.  Version 2 of the BGP flow specification 
   protocol addresses these features. 
       
        BGP Flow Specification v2 is encapsulated in a different NLRI which encapsulates previous 
   flow specification information. 
       
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="RFC" name="keyword">
<meta content="Request for Comments" name="keyword">
<meta content="I-D" name="keyword">
<meta content="Internet-Draft" name="keyword">
<meta content="BGP Flow Specification" name="keyword">
<meta content="draft-hares-idr-flowspec-v2-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-hares-idr-flowspec-v2-02-dq5syd85.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BGP FlowSpec v2</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hares &amp; Eastlake</td>
<td class="center">Expires 27 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">IDR Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hares-idr-flowspec-v2-02</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07-26" class="published">26 July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-27">27 January 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Hares</div>
<div class="org">Hickory Hill Consulting</div>
</div>
<div class="author">
      <div class="author-name">D. Eastlake</div>
<div class="org">Futurewei</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">BGP Flow Specification Version 2</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">BGP flow specification version 1 (RFC8955, RFC8956) describes the distribution
   of traffic filter policy (traffic filters and actions) which are distributed
   via BGP to BGP peers. Multiple applications utilize the BGP distributed 
   traffic filter policy.  These applications include:  
      (1) mitigation of Denial of Service (DoS), (2) enabling of traffic filtering 
      in BGP/MPLS VPNS,  and(3)centralized traffic control for networks utilizing either 
   SDN control of router firewall functions. During the deployment of BGP flow specification 
   v1, the following issues were detected:  1) problems due to the lack of clear TLV encoding 
   for rules for flow specifications, 2) desire to order filters rules, and 3) 
   ordering of actions to provide deterministic actions.  Version 2 of the BGP flow specification 
   protocol addresses these features.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2"> BGP Flow Specification v2 is encapsulated in a different NLRI which encapsulates previous 
   flow specification information.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc ulBare">
<li class="ulEmpty compact toc ulBare" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-flow-specification-v1-revie" class="xref">Flow Specification v1 Review</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-ordering-flow-specification" class="xref">Ordering Flow Specification Data Proposed for v2</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc ulBare" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-definitions-and-acronyms" class="xref">Definitions and Acronyms</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-rfc-2119-language" class="xref">RFC 2119 language</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc ulBare" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-dissemination-of-bgp-flow-s" class="xref">Dissemination of BGP Flow Specification v2 NLRI</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-encoding-of-bgp-fs-v2-filte" class="xref">Encoding of BGP-FS v2 Filters</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-encoding-of-value-field-for" class="xref">Encoding of Value field for Rule Identification (Value = 00)</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-encoding-of-value-field-for-" class="xref">Encoding of Value field for default Action of Block traffic</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.  <a href="#name-encoding-of-value-field-for-d" class="xref">Encoding of Value field for default Action of Permit traffic</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="xref">3.1.4</a>.  <a href="#name-encoding-of-value-field-fil" class="xref">Encoding of Value field filters plus actions(Value = 03)</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a href="#section-3.1.5" class="xref">3.1.5</a>.  <a href="#name-encoding-of-value-fields-fi" class="xref">Encoding of Value Fields filters passed in Wide Communities</a></p>
</li>
                  <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.6">
                    <p id="section-toc.1-1.3.2.1.2.6.1"><a href="#section-3.1.6" class="xref">3.1.6</a>.  <a href="#name-encoding-of-value-fields-fil" class="xref">Encoding of Value Fields filters for Tunnels (Value = 05)</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc ulBare" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-optional-security-additions" class="xref">Optional Security Additions</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-bgp-fs-v2-and-bgpsec" class="xref">BGP FS v2 and BGPSEC</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-bgp-fs-v2-with-with-roa" class="xref">BGP FS v2 with with ROA</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-revise-flow-specification-s" class="xref">Revise Flow Specification Security for centralized Server</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc ulBare" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-flow-specificatoin-v2-safis" class="xref">Flow Specificatoin V2 SAFIs</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-bgp-capability-code" class="xref">BGP Capability Code</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-new-registries" class="xref">New Registries</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc ulBare" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="ulEmpty compact toc ulBare" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc ulBare" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">BGP (<span>[<a href="#RFC4271" class="xref">RFC4271</a>]</span>) flow specification (see <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>) 
   describes the distribution of traffic filter policy (traffic filters and actions) which are distributed via BGP to 
      BGP peers.  The traffic filter policy is applied when packets are received on a 
      router with the flow specification function turned on. 
   Multiple applications utilize the BGP distributed 
   traffic filter policy.  These applications include:  
      (1) mitigation of Denial of Service (DoS), (2) enabling of traffic filtering 
      in BGP/MPLS VPNS, and (3)centralized traffic control for networks utilizing either 
   SDN control of router firewall functions. During the deployment of BGP flow specification 
   v1, the following issues were detected:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">problems such as non-extensibility due to the lack of clear TLV encoding,<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.2">desire to order filtering rules, and<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.3"> desire to order actions to provide deterministic interactions of actions.<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-3">
   Version 2 of the BGP flow specification 
   protocol addresses these features.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document specifies six new BGP Flow Specification NLRI wit
   (3 AFIs (1, 2, and 6) with two SAFI (TBD1 and TBD2) that allow user-ordered list 
   of traffic match filters, and user-ordered traffic match actions encoded in BGP Wide Communities. 
   These NLRIs provide encoding for both the ordinary and the VPN cases for IPv4, IPv6, 
   and layer 2 covering all the cases covered by <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>,
   <span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span>, and  <span>[<a href="#I-D.ietf-idr-flowspec-nvo3" class="xref">I-D.ietf-idr-flowspec-nvo3</a>]</span>.
   
   This document provides an overview in this section and the following other sections provide 
   additional detail:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">section 2 - Definitions,<a href="#section-1-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.2">section 3 - Rules for dissemination of Flow Specification v2,<a href="#section-1-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.3">section 4 - Optional Security,<a href="#section-1-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.4">section 5 - IANA considerations,<a href="#section-1-5.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.5">section 6 - security considerations.<a href="#section-1-5.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-6">
   This section reviews the existing flow specification and provides a logical description of
   ordered flow specification.<a href="#section-1-6" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-flow-specification-v1-revie">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-flow-specification-v1-revie" class="section-name selfRef">Flow Specification v1 Review</a>
        </h3>
<p id="section-1.1-1">
   If one considers the reception of the packet as  an event,
   then BGP flow specification describes a set of 
   Event-MatchCondition-Action (ECA) policies where the 
   match-condition is defined in the BGP NLRI, and the action is defined
   either by the default condition (accept traffic) or actions 
   defined in Extended BGP Community values <span>[<a href="#RFC4360" class="xref">RFC4360</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">
   The initial set of conditions <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span> 
   for this policy includes 13 types of match filters encoded the following: 
   specific AFI/SAFIs for the IPv4 and IPv6 AFIs:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-1.1-3.1">IPv4 traffic: AFI:1, SAFI:133;<a href="#section-1.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-1.1-3.2">IPv6 Traffic: AFI:2  SAFI:133<a href="#section-1.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-1.1-3.3">BGP/MPLS IPv4 VPN: AFI:1, SAFI: 134<a href="#section-1.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-1.1-3.4"> BGP/MPLS IPv6 VPN: AFI:2, SAFI: 134<a href="#section-1.1-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-4"> The 13 types of filters are the following:<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-5.1">Type 1: Destination Prefix<a href="#section-1.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.2">Type 2: Source Prefix<a href="#section-1.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.3">Type 3: IP Protocol (v4,<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> ) 
   or Upper Layer Protocol (v6, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-1.1-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.4">Type 4: Port<a href="#section-1.1-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.5">Type 5: Destination Port<a href="#section-1.1-5.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.6">Type 6: Source Port<a href="#section-1.1-5.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.7">Type 7: ICMPv4 Type (v4,<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> ) or
     ICMPv6 Type (v6, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-1.1-5.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.8">Type 8: ICMPv4 Code (v4,<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> ) or
    ICMPv6 code(v6, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-1.1-5.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.9">Type 9: TCP flags (v4,<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> )<a href="#section-1.1-5.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.10">Type 10: Packet length<a href="#section-1.1-5.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.11">Type 11: DSCP marking<a href="#section-1.1-5.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.12">Type 12: Fragment<a href="#section-1.1-5.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.13">Type 13: Flow Label (v6, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-1.1-5.13" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-6">
  The actions specified <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>
  for exclusion on Extended Community (0xttss) are the following:<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-7.1">Traffic rate limited by bytes   (0x8006) [2 byte AS, 4 byte float]<a href="#section-1.1-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-7.2">Traffic action (set by bitmask, bits 47 and 46 defined) (0x8007)<a href="#section-1.1-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-7.3">rt-redirect IPv4 (0x8008) [2 byte AS, 4 octet value]<a href="#section-1.1-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-7.4">rt-redirect IPv4 (0x8108) [4 byte IPv4 address, 2 octet value]<a href="#section-1.1-7.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-7.5">rt-redirect IPv4 (0x8108) [4 byte AS, 2 octet value]<a href="#section-1.1-7.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-7.6">traffic marking  (0x8009) (DSCP value)<a href="#section-1.1-7.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-7.7">Traffic rate limited by packets (0x800C) [2 byte AS, 4 byte float]<a href="#section-1.1-7.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-7.8">rt-redirect IPv6 (0x820D) [2 byte AS, 4 octet value]<a href="#section-1.1-7.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-7.9">rt-redirect IPv6 (0x810D) [4 byte IPv4 address, 2 octet value]<a href="#section-1.1-7.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-7.10">rt-redirect IPv6 (0x820D) [4 byte AS, 2 octet value]<a href="#section-1.1-7.10" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-8"> The flow specification filers and actions combine to make up flow 
  specification rules associated with an NRLI.  The Extended Communities 
  for actions can be attached to a single rule or multiple rules. 
 Figure 1 shows a diagram of the flow specification data structures.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-1.1-9">
<pre>

     +--------------------------------------+
     | Flow Specification (FS)              |
     |  Policy                              |
     +--------------------------------------+
         ^               ^              ^
         |               |              |
         |               |              |
+--------^----+  +-------^-------+     +-------------+
|   FS Rule1  |  |   FS Rule     | ... |  FS rule    |
+-------------+  +---------------+     +-------------+
                    :          :
                    :          :
                 ...:          :........
                 :                     :
       +---------V---------+      +----V-------------+
       |  Rule Condition   |      |   Rule Action    |
       |  in BGP NLRIs     |      | in BGP extended  |
           | AFIs: 1 and 2     |      | Communities      |
       | SAFI 133, 134     |      |                  |
       +-------------------+      +------------------+
           :     :    :                 :      :    :
      .....:     .    :.....       .....:      .    :.....
      :          :         :       :           :         :
 +----V---+  +---V----+ +--V---+ +-V------+ +--V-----++--V---+
 |  Match |  | match  | |match | | Action | | action ||action|
 |Operator|  |Variable| |Value | |Operator| |variable|| Value|
 |*1      |  |        | |      | |(subtype| |        ||      |
 +--------+  +--------+ +------+ +--------+ +--------++------+

   *1 match operator may be complex.

   Figure 1: BGP Flow Specification Policy
</pre><a href="#section-1.1-9" class="pilcrow">¶</a>
</div>
</section>
<section id="section-1.2">
        <h3 id="name-ordering-flow-specification">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-ordering-flow-specification" class="section-name selfRef">Ordering Flow Specification Data Proposed for v2</a>
        </h3>
<p id="section-1.2-1">An minimal ordering specification of the rules is an order indicator
per rule. The inclusion of names for each rule, match condition and action 
allows for logical indirection. The existing extended community 
which tags multiple NLRIs could be saved as an indirect reference
by name.  For Flow specification v1 actions, the Extended 
actions could be assigned default names.  The 
actions could be linked to many NLRIs.  Figure 2 below 
 provides a logical diagram of the ordering of 
rules and the association of names per rule, rule match action, 
and rule action.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Since many policies also group data flow specifications under rule groups, 
many implementations may order set of rules under a particular group policy. 
Network Management display of BGP filers may use the Rule Grouping mechanism 
to display the filters.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-1.2-3">
<pre>

       +--------------------------------+
       |          Rule Group            |
       +------------------------------ -+
         ^          ^                  ^
                 |          ----------         |
         |                   |             ------
         |                   |               |
+--------^-------+   +-------^-----+     +---^-----+
|      Rule1     |   |     Rule2   | ... |  Rule-n |
+----------------+   +-------------+     +---------+
                      :  :   :    :
    :.................:  :   :    :
    :          |.........:   :    :
 +--V--+    +--V--+          :    :
 | name|    |order| .........:    :.....
 +-----+    +-----+ :                  :
                    :                  :
   +----------------V----+  +-----V-------  --+
   |Rule Match condition |  | Rule Action     |
   +---------------------+  +-----------------+
    :      :     :    :       :      :   :   :
 +--V--+   :     :    :    +--V--+   :   :   :
 | name|   :     :    :    |name |   :   :   :
 +-----+   :     :    :    +-----+       :   :   :
           :     :    :              :   :   :...........
           :     :    :              :   :              :
      .....:     .    :.....       ..:   :.....         :
      :          :         :       :          :         :
 +----V---+  +---V----+ +--V---+ +-V------++--V-----++--V---+
 |  Match |  | match  | |match | | Action || action ||action|
 |Operator|  |variable| |Value | |Operator||Variable|| Value|
 +--------+  +--------+ +------+ +--------++--------++------+

   Figure 2: Order Flow Specification Data storage
</pre><a href="#section-1.2-3" class="pilcrow">¶</a>
</div>
</section>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<section id="section-2.1">
        <h3 id="name-definitions-and-acronyms">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-definitions-and-acronyms" class="section-name selfRef">Definitions and Acronyms</a>
        </h3>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-2.1-1.1">BGPSEC - secure BGP <span>[<a href="#RFC8205" class="xref">RFC8205</a>]</span> updated by <span>[<a href="#RFC8206" class="xref">RFC8206</a>]</span><a href="#section-2.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-2.1-1.2">BGP Session ephemeral state - state which does not survive the loss of BGP peer,<a href="#section-2.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-2.1-1.3">Ephemeral state - state which does not survive the reboot of a software module,
    or a hardware reboot. Ephemeral state can be ephemeral configuration state or 
    operational state.<a href="#section-2.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-2.1-1.4">configuration state - state which persist across a reboot of software module within 
       a routing system or a reboot of a hardware routing device.<a href="#section-2.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-2.1-1.5">NETCONF: The Network Configuration Protocol <span>[<a href="#RFC6241" class="xref">RFC6241</a>]</span>.<a href="#section-2.1-1.5" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-2.1-1.6">RESTCONF:  The RESTCONF configuration Protocol <span>[<a href="#RFC8040" class="xref">RFC8040</a>]</span><a href="#section-2.1-1.6" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-2.1-1.7"> ROA: Route Origin Authentication <span>[<a href="#RFC6482" class="xref">RFC6482</a>]</span><a href="#section-2.1-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-2.2">
        <h3 id="name-rfc-2119-language">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-rfc-2119-language" class="section-name selfRef">RFC 2119 language</a>
        </h3>
<p id="section-2.2-1">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
          <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span><a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-3">
      <h2 id="name-dissemination-of-bgp-flow-s">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dissemination-of-bgp-flow-s" class="section-name selfRef">Dissemination of BGP Flow Specification v2 NLRI</a>
      </h2>
<p id="section-3-1">
 The BGP Flow Specification version 2 (BGP-FS v2) uses an NRLI with the format for
 AFIs for IPv4 (AFI = 1), IPv6 (AFI = 2), and L2VPN (L2VPN = 6) with one of 
 two following SAFIs  (TBD1 for routes and TBD2 for VPN routes).  
  This NLRI information is encoded using MP_REACH_NLRI and MP_UNREACH_NLRI attributes defined in
 <span>[<a href="#RFC4760" class="xref">RFC4760</a>]</span>.  When advertising Flow Specification, the length of the 
  Next-Hop Network Address MUST be set to 0.  The Network Address of the 
  Next-Hop Field MUST be ignored.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Implementations wishing to exchange flow specification rules MUST use 
BGP's Capability Advertisement facility to exchange the Multiprotocol Extension Capability Code 
(Code 1) as defined in <span>[<a href="#RFC4760" class="xref">RFC4760</a>]</span>, and 
indicate a capability for flow specification v2 (Code TBD3).<a href="#section-3-2" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-encoding-of-bgp-fs-v2-filte">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-encoding-of-bgp-fs-v2-filte" class="section-name selfRef">Encoding of BGP-FS v2 Filters</a>
        </h3>
<p id="section-3.1-1">The AFI/SAFI NLRI for BGP Flow Specification has the format:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1-2">
<pre>
 +---------------------------+
 |length (2 octets)          |
 +---------------------------+
 | Sub-TLVs (variable)       |
 | +=======================+ |
 | | order (2 octets)      | |
 | +-----------------------+ |
 | | type (2 octets)       | |
 | +-----------------------+ |
 | | length-tlv(2 octets)  | |
 | +-----------------------+ |
 | | value (variable)      | |
 | +=======================+ |
 +---------------------------+

 Figure 3 -Flow Specification v2 format
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">
  where:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1"> length - is the value of the initial length of field in 
  overall bytes of the Sub-TLVs.<a href="#section-3.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-4.2"> order - is 2 octet field indicating the flow-specification global rule order.<a href="#section-3.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-4.3">
            <p id="section-3.1-4.3.1"> type - is one of the following types<a href="#section-3.1-4.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.3.2.1">identifier (value = 00),<a href="#section-3.1-4.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-4.3.2.2">match rule (value = 01) with default action of block traffic,<a href="#section-3.1-4.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-4.3.2.3">match rule (value = 02) with default action of permit traffic,<a href="#section-3.1-4.3.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-4.3.2.4">match rule (value = 03) with action TLVs,<a href="#section-3.1-4.3.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-4.3.2.5">match rule (value = 04) with Wide Communities Action TLVs,<a href="#section-3.1-4.3.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-4.3.2.6">match rule (value = 05) with tunnel matching from 
  <span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span><a href="#section-3.1-4.3.2.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-4.3.2.7">match rule (value = 06) with tunnel matching from
     <span>[<a href="#I-D.ietf-idr-flowspec-nvo3" class="xref">I-D.ietf-idr-flowspec-nvo3</a>]</span><a href="#section-3.1-4.3.2.7" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.1-4.4"> length-tlv - is the length of the value part of the Sub-TLV,<a href="#section-3.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-4.5">value is a series of sub-TLVs fields (TLV)
  depended on the type value defined in the sections below.<a href="#section-3.1-4.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-5">Filters are processed in the order specified by the user.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<section id="section-3.1.1">
          <h4 id="name-encoding-of-value-field-for">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-encoding-of-value-field-for" class="section-name selfRef">Encoding of Value field for Rule Identification (Value = 00)</a>
          </h4>
<p id="section-3.1.1-1">The BGP flow specification V2 identifier sub-TLVs use the following format:<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.1-2">
<pre>
 +------------------------+
 |length (2 octets)       |
 +------------------------+
 | Sub-TLVs (variable)    |
 | +====================+ |
 | | order (2 octets)   | |
 | +--------------------+ |
 | | type = 00          | |
 | +--------------------+ |
 | | length (n octets)  | |
 | +--------------------+ |
 | | identifier for     | |
 | | rule (variable)    | |
 | +====================+ |
 +------------------------+

 Figure 4 - NRLI revision
</pre><a href="#section-3.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.1-3">
  The identifier is a string of octets of variable length.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-3.1.2">
          <h4 id="name-encoding-of-value-field-for-">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-encoding-of-value-field-for-" class="section-name selfRef">Encoding of Value field for default Action of Block traffic</a>
          </h4>
<p id="section-3.1.2-1">The BGP flow specification V2 identifier sub-TLVs use the following format:<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.2-2">
<pre>
 +--------------------------+
 |length (2 octets)         |
 +--------------------------+
 | Sub-TLVs (variable)      |
 | +======================+ |
 | | order (2 octets)     | |
 | +----------------------+ |
 | | type = 01            | |
 | +----------------------+ |
 | | length (variable)    | |
 | +----------------------+ |
 | | value field          | |
 | | AFI/SAFI field (4)   | |
 | | components (variable | |
 | +======================+ |
 +--------------------------+

 Figure 5 - Flow specification v2
 with default Block traffic flow
</pre><a href="#section-3.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.2-3">Flow Specification v2 with a default Action of block traffic has 
  AFI/SAFI at the beginning of the enclosing MP_REACH_NLRI or MP_UNREACH_NLRI
  and the following sub-TLVs in the value field:<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-3.1.2-4.1">
              <p id="section-3.1.2-4.1.1">Component fields as defined in the following documents:<a href="#section-3.1.2-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2-4.1.2.1">
                  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>,<a href="#section-3.1.2-4.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.2-4.1.2.2">
                  <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>,<a href="#section-3.1.2-4.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.2-4.1.2.3">
                  <span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span><a href="#section-3.1.2-4.1.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</section>
<section id="section-3.1.3">
          <h4 id="name-encoding-of-value-field-for-d">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-encoding-of-value-field-for-d" class="section-name selfRef">Encoding of Value field for default Action of Permit traffic</a>
          </h4>
<p id="section-3.1.3-1">The BGP flow specification V2 identifier sub-TLVs use the following format:<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.3-2">
<pre>
 +--------------------------+
 |length (2 octets)         |
 +--------------------------+
 | Sub-TLVs (variable)      |
 | +======================+ |
 | | order (2 octets)     | |
 | +----------------------+ |
 | | type = 01            | |
 | +----------------------+ |
 | | length (variable)    | |
 | +----------------------+ |
 | | value field          | |
 | | AFI/SAFI field (4)   | |
 | | components (variable | |
 | +======================+ |
 +--------------------------+

 Figure 6 - Flow specification v2
 with default permit traffic flow
</pre><a href="#section-3.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.3-3">Flow Specification v2 with Filters and Default action 
  of block traffic has an AFI/SAFI at the beginning of the 
   enclosing MP_REACH_NLRI or MP_UNREAC_NLRI and the following sub-TLVs
  in the value field:<a href="#section-3.1.3-3" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-3.1.3-4.1">a value of an AFI/SAFI field with 4 bytes
  [AFI 2 Bytes, SAFI 1 byte, 1 Byte reserved]<a href="#section-3.1.3-4.1" class="pilcrow">¶</a>
</li>
            <li class="ulEmpty normal" id="section-3.1.3-4.2">
              <p id="section-3.1.3-4.2.1">Component fields as defined in the following documents:<a href="#section-3.1.3-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3-4.2.2.1">
                  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>,<a href="#section-3.1.3-4.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.3-4.2.2.2">
                  <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>,<a href="#section-3.1.3-4.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.3-4.2.2.3">
                  <span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span><a href="#section-3.1.3-4.2.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</section>
<section id="section-3.1.4">
          <h4 id="name-encoding-of-value-field-fil">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-encoding-of-value-field-fil" class="section-name selfRef">Encoding of Value field filters plus actions(Value = 03)</a>
          </h4>
<p id="section-3.1.4-1">The BGP flow specification V2 identifier sub-TLVs use the following format:<a href="#section-3.1.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.4-2">
<pre>
 +----------------------------+
 |length (2 octets)           |
 +----------------------------+
 | Sub-TLVs (variable)        |
 | +=======================+  |
 | | order (2 octets)      |  |
 | +-----------------------+  |
 | | type = 01             |  |
 | +-----------------------+  |
 | | length (2 octets)     |  |
 | +-----------------------+  |
 | | value field           |  |
 | |                       |  |
 | | Action length   (4)   |  |
 | | Action sub-TLVs (var) |  |
 | | number of filters     |  |
 | | [filter 1]            |  |
 | | AFI/SAFI field (4)    |  |
 | | components (variable) |  |
 | | [filter 2]            |  |
 | | AFI/SAFI field (4)    |  |
 | | components (variable) |  |
 | | ....                  |  |
 | +=======================+  |
 +----------------------------+

 Figure 7 - Flow Specification with
 Actions encoded in NLRI
</pre><a href="#section-3.1.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.4-3">The Flow Specification v2 with action fields applies actions to 
the AFI/SAFI field.  The format of the field is<a href="#section-3.1.4-3" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-3.1.4-4.1">Action length (4 bytes)<a href="#section-3.1.4-4.1" class="pilcrow">¶</a>
</li>
            <li class="ulEmpty normal" id="section-3.1.4-4.2">
              <p id="section-3.1.4-4.2.1">Action SubTLVs (variable) in format Type (2 bytes), 
  length (2 bytes), and value (variable). 
  The types are:<a href="#section-3.1.4-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.4-4.2.2.1">Extended community (01)<a href="#section-3.1.4-4.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.2.2">Wide Community (02)<a href="#section-3.1.4-4.2.2.2" class="pilcrow">¶</a>
</li>
              </ul>
<div class="artwork art-text alignLeft" id="section-3.1.4-4.2.3">
<pre>
  [Type (2 bytes)][Extended-Community-type (2 bytes)][6 bytes]

 Figure 8 - Extended Community action type encoding
</pre><a href="#section-3.1.4-4.2.3" class="pilcrow">¶</a>
</div>
<p id="section-3.1.4-4.2.4">
  The Extended community types are the following:<a href="#section-3.1.4-4.2.4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.4-4.2.5.1">Type 1: Traffic rate limited by bytes   (0x8006) [2 byte AS, 4 byte float]<a href="#section-3.1.4-4.2.5.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.2">Type 2: Traffic action (set by bitmask, bits 47 and 46 defined) (0x8007)<a href="#section-3.1.4-4.2.5.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.3">Type 3: rt-redirect IPv4 (0x8008) [2 byte AS, 4 octet value]<a href="#section-3.1.4-4.2.5.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.4">Type 4: rt-redirect IPv4 (0x8108) [4 byte IPv4 address, 2 octet value]<a href="#section-3.1.4-4.2.5.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.5">Type 5: rt-redirect IPv4 (0x8108) [4 byte AS, 2 octet value]<a href="#section-3.1.4-4.2.5.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.6">Type 6: traffic marking  (0x8009) (DSCP value)<a href="#section-3.1.4-4.2.5.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.7">Type 7: Traffic rate limited by packets (0x800C) [2 byte AS, 4 byte float]<a href="#section-3.1.4-4.2.5.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.8">Type 8: rt-redirect IPv6 (0x820D) [2 byte AS, 4 octet value]<a href="#section-3.1.4-4.2.5.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.9">Type 9: rt-redirect IPv6 (0x810D) [4 byte IPv4 address, 2 octet value]<a href="#section-3.1.4-4.2.5.9" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.10">Type 10: rt-redirect IPv6 (0x820D) [4 byte AS, 2 octet value]<a href="#section-3.1.4-4.2.5.10" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.2.5.11">
              </ul>
</li>
            <li class="ulEmpty normal" id="section-3.1.4-4.3">
              <p id="section-3.1.4-4.3.1">Component fields as defined in the following documents:<a href="#section-3.1.4-4.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.4-4.3.2.1">
                  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>,<a href="#section-3.1.4-4.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.3.2.2">
                  <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>,<a href="#section-3.1.4-4.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.1.4-4.3.2.3">
                  <span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span><a href="#section-3.1.4-4.3.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.1.4-5">The BGP-FS version 2 actions are passed in a Wide Community <span>[<a href="#I-D.ietf-idr-wide-bgp-communities" class="xref">I-D.ietf-idr-wide-bgp-communities</a>]</span>
atom with the following format.<a href="#section-3.1.4-5" class="pilcrow">¶</a></p>
</section>
<section id="section-3.1.5">
          <h4 id="name-encoding-of-value-fields-fi">
<a href="#section-3.1.5" class="section-number selfRef">3.1.5. </a><a href="#name-encoding-of-value-fields-fi" class="section-name selfRef">Encoding of Value Fields filters passed in Wide Communities</a>
          </h4>
<p id="section-3.1.5-1">The BGP Flow specification version 2 actions are passed in a 
Wide Community <span>[<a href="#I-D.ietf-idr-wide-bgp-communities" class="xref">I-D.ietf-idr-wide-bgp-communities</a>]</span>
atom with the following format:<a href="#section-3.1.5-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.5-2">
<pre>
 +----------------------------+
 |length (2 octets)           |
 +----------------------------+
 | Sub-TLVs (variable)        |
 | +=======================+  |
 | | order (2 octets)      |  |
 | +-----------------------+  |
 | | type = 01             |  |
 | +-----------------------+  |
 | | length (2 octets)     |  |
 | +-----------------------+  |
 | | value field           |  |
 | |                       |  |
 | | Action length(4)      |  |
 | | Atom-id-1  (4)        |  |
 | | Atom-id-2 (4)         |  |
 | | number of filters     |  |
 | | [filter 1]            |  |
 | | AFI/SAFI field (4)    |  |
 | | components (variable) |  |
 | | [filter 2]            |  |
 | | AFI/SAFI field (4)    |  |
 | | components (variable) |  |
 | | ....                  |  |
 | +=======================+  |
 +----------------------------+

 Figure 9 - Flow Specification with
 IDs for Wide Community Actions
</pre><a href="#section-3.1.5-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.5-3">The BGP Atom IDs in the 
 Wide Community must contain:<a href="#section-3.1.5-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.5-4">
<pre>
+--------------------------+
| Atom ID (4 octets)       |
+--------------------------+
| order (2 octets)         |
+--------------------------+
| Action type (2 octets)   |
+--------------------------+
| Action length (2 octets) |
+--------------------------+
| Action Values (variable) |
| (multiples of 2 octets)  |
+--------------------------+

Figure 10
Wide Community Atom

</pre><a href="#section-3.1.5-4" class="pilcrow">¶</a>
</div>
<p id="section-3.1.5-5">
where:<a href="#section-3.1.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5-6.1">Action type (2 octets) - is the type of action. These actions can be 
standardized (0x0001 - 0x3ffff), vendor specific (0x40000-0x7FFFF),
or reserved (0x0, 0x80000-0xFFFFFFFF).<a href="#section-3.1.5-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.5-6.2">Action length - length of actions including variable field,<a href="#section-3.1.5-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.5-6.3">Action values - value of actions (variable) defined in individual 
definitions.<a href="#section-3.1.5-6.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.1.5-7">The BGP Flow Specification (BGP-FS) atom can be part of the Wide Community 
container (type 1) or the BGP Flow Specification Atom can be part of the
BGP Flow Specification container (type 2) which will have:<a href="#section-3.1.5-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.5-8">
<pre>
+-----------------------------+
| Source AS Number  (4 octets)|
+-----------------------------+
| list of atoms (variable)    |
+-----------------------------+
Figure 11: Atom format
</pre><a href="#section-3.1.5-8" class="pilcrow">¶</a>
</div>
</section>
<section id="section-3.1.6">
          <h4 id="name-encoding-of-value-fields-fil">
<a href="#section-3.1.6" class="section-number selfRef">3.1.6. </a><a href="#name-encoding-of-value-fields-fil" class="section-name selfRef">Encoding of Value Fields filters for Tunnels (Value = 05)</a>
          </h4>
<p id="section-3.1.6-1">AFter the initial order, type, and length the values for 
matching tunneled packets are the format show in Figure 12.
The Tunnel Type field is a value from the IANA BGP Tunnel
Encapsulation Attribute Tunnel Types Registry.  If it is desired to 
match the packeet headers after the tunnel header, the Inner AFI
field specifies the AFI for that match which is ANDed with the 
Outer Flowspec match.  An absent Inner FlowSpec is consider to 
always match.  The Inner flow specification for tunnel filter
can also include tunnel header field components from 
<span>[<a href="#I-D.ietf-idr-flowspec-nvo3" class="xref">I-D.ietf-idr-flowspec-nvo3</a>]</span>.<a href="#section-3.1.6-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.6-2">
<pre>
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
| Tunnel Type                     2 octets      |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
| Inner AFI                       2 octets      |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
| Outer Flowspec Length           2 octets      |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
| Outer Flowspec Components       variable      :
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
Optional Inner Flowspec, present if Inner AFI non-zero
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
| Inner Flowspec Components       variable      :
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

Figure 12
</pre><a href="#section-3.1.6-2" class="pilcrow">¶</a>
</div>
</section>
</section>
</section>
<section id="section-4">
      <h2 id="name-optional-security-additions">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-optional-security-additions" class="section-name selfRef">Optional Security Additions</a>
      </h2>
<p id="section-4-1">This section discusses the optional BGP Security additions for BGP-FS v2
relating to BGPSEC <span>[<a href="#RFC8205" class="xref">RFC8205</a>]</span> and ROA.<a href="#section-4-1" class="pilcrow">¶</a></p>
<section id="section-4.1">
        <h3 id="name-bgp-fs-v2-and-bgpsec">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-bgp-fs-v2-and-bgpsec" class="section-name selfRef">BGP FS v2 and BGPSEC</a>
        </h3>
<p id="section-4.1-1"> Flow specification v1 (<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)
do not BGP Flow specifications to be passed BGPSEC <span>[<a href="#RFC8205" class="xref">RFC8205</a>]</span>
  BGP Flow Specification v2 can be passed in BGPSEC, but it is not required.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2">
        <h3 id="name-bgp-fs-v2-with-with-roa">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-bgp-fs-v2-with-with-roa" class="section-name selfRef">BGP FS v2 with with ROA</a>
        </h3>
<p id="section-4.2-1">
  BGP Flow Specification v2 can utilize ROAs in the validation. If BGP-FS v2 is 
  used with BGPSEC and ROA, the first thing is to validate the 
  route within BGPSEC and second to utilize BGP ROA to validate
  the route origin.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2"> The BGP-FS peers using both ROA and BGP-FS validation 
  determine that a BGP Flow specification is valid
  if and only if one of the following cases:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-3.1">
            <p id="section-4.2-3.1.1">If the BGP Flow Specification NLRI has a IPv4 or 
  IPv6 address in destination address match
  filter and the following is true:<a href="#section-4.2-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-3.1.2.1">A BGP ROA has been received to validate the originator, and<a href="#section-4.2-3.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-3.1.2.2">the route is the best-match unicast route for the destination
  prefix embedded in the match filter; or<a href="#section-4.2-3.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.2-3.2">
            <p id="section-4.2-3.2.1">If a BGP ROA has not been received that matches the 
  IPv4 or IPv6 destination address in the destination filter, the 
  match filter must abide by the <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and
  <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span> validation rules of:<a href="#section-4.2-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-3.2.2.1">The originator match of the flow specification matches the
  originator of the best-match unicast route for the destination
  prefix filter embedded in the flow specification", and<a href="#section-4.2-3.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-3.2.2.2">No more specific unicast routes exist when compared with the 
   flow destination prefix that have been received from a different
   neighboring AS than the best-match unicast route, which has been 
   determined in step A.<a href="#section-4.2-3.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-4.2-4">
  The best match is defined to be the longest-match NLRI with the highest preference.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3">
        <h3 id="name-revise-flow-specification-s">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-revise-flow-specification-s" class="section-name selfRef">Revise Flow Specification Security for centralized Server</a>
        </h3>
<p id="section-4.3-1">
The distribution of Flow Specifications from a centralized server supports
mitigation of DoS attacks. <span>[<a href="#I-D.ietf-idr-bgp-flowspec-oid" class="xref">I-D.ietf-idr-bgp-flowspec-oid</a>]</span> 
suggests the following redefined procedure for validation for this case:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
A route is valid if the following conditions holds true:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-3.1">The originator of the flow specification matches the
   originator of the best-match unicast route for the
   destination prefix embedded in the flow specification.<a href="#section-4.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-3.2">The AS_PATH and AS4_PATH attribute of the flow
   specification are empty (on originating AS)<a href="#section-4.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-3.3">The AS_PATH and AS4_PATH attribute of the flow
  specification does not contain AS_SET and AS_SEQUENCE
  segments (on originating AS with AS Confederation)<a href="#section-4.3-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-4">This reduced validation mechanism can be used for BGP-FS v2 within 
a single domain.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
</section>
</section>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This section complies with <span>[<a href="#RFC7153" class="xref">RFC7153</a>]</span><a href="#section-5-1" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-flow-specificatoin-v2-safis">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-flow-specificatoin-v2-safis" class="section-name selfRef">Flow Specificatoin V2 SAFIs</a>
        </h3>
<p id="section-5.1-1"> IANA is required to assign two SAFI Values from the 
   registry at https://www.iana.org/assignments/safi-namespace 
   from the Standard Action Range as follows:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-2">
<pre>
        Value   Description      Reference
     -----   -------------    ---------------
      TBD1   BGP-FS V2        [This document]
      TBD2   BGP-FS V2 VPN    [this document]

</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
</section>
<section id="section-5.2">
        <h3 id="name-bgp-capability-code">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-bgp-capability-code" class="section-name selfRef">BGP Capability Code</a>
        </h3>
<p id="section-5.2-1">
   IANA is requested to assign a Capability Code from the registry at 
   https://www.iana.org/assignments/capability-codes/ from the IETF Review
   range as follows:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-2">
<pre>
   Value   Description            Reference       Controller
   -----  ---------------------  ---------------  ----------
    TBD3  Flow Specification V2  [this document]  IETF
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
</section>
<section id="section-5.3">
        <h3 id="name-new-registries">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-new-registries" class="section-name selfRef">New Registries</a>
        </h3>
<p id="section-5.3-1">IANA is requested to create the following new registries:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-5.3-2.1">
            <p id="section-5.3-2.1.1">Registry for BGP-FS v2 action types with the<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1.2.1">0x00 - reserved<a href="#section-5.3-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.2">0x01 - 0x3FFFF - standards action<a href="#section-5.3-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.3">0x40000- 0x7FFFF - vendor specific filters<a href="#section-5.3-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.4">0x80000 -0xFFFFFFFF - reserved<a href="#section-5.3-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.5">0x80000 -0xFFFFFFFF - reserved<a href="#section-5.3-2.1.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="ulEmpty normal" id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">Registry for BGP-FS v2 action types with the 
   following ranges:<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.2.2.1"> 0x0 - reserved<a href="#section-5.3-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.2.2.2">0x01 - 0x3ffff - standards action<a href="#section-5.3-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.2.2.3">0x40000 - 0x7ffff - vendor actions<a href="#section-5.3-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.2.2.4">0x80000 - 0xFFFFFFF - reserved<a href="#section-5.3-2.2.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</section>
</div>
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">The use of ROA improves on <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>
   to check the route origination is valid can improve the 
   validation sequence for a multiple-AS environment.  The use of BGPSEC 
   <span>[<a href="#RFC8205" class="xref">RFC8205</a>]</span> to secure the packet
   can increase security of BGP flow specification information sent in the packet.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The use of the reduced validation within an AS <span>[<a href="#I-D.ietf-idr-bgp-flowspec-oid" class="xref">I-D.ietf-idr-bgp-flowspec-oid</a>]</span>
   can provide adequate validation for distribution of flow specification within an single 
   autonomous system for prevention of DDOS.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Distribution of flow filters may provide insight into traffic being sent within 
   an AS, but this information should be composite information that does not reveal the
   traffic patterns of individuals.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-idr-bgp-flowspec-oid">[I-D.ietf-idr-bgp-flowspec-oid]</dt>
        <dd>
<span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Alcaide, J.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Smith, D.</span>, and <span class="refAuthor">P. Mohapatra</span>, <span class="refTitle">"Revised Validation Procedure for BGP Flow Specifications"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-bgp-flowspec-oid-15</span>, <time datetime="2021-06-03" class="refDate">3 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-bgp-flowspec-oid-15.txt">https://www.ietf.org/archive/id/draft-ietf-idr-bgp-flowspec-oid-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-flowspec-l2vpn">[I-D.ietf-idr-flowspec-l2vpn]</dt>
        <dd>
<span class="refAuthor">Hao, W.</span>, <span class="refAuthor">Eastlake, D. E.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">S. Zhuang</span>, <span class="refTitle">"BGP Dissemination of L2 Flow Specification Rules"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-flowspec-l2vpn-17</span>, <time datetime="2021-05-12" class="refDate">12 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-l2vpn-17.txt">https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-l2vpn-17.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-flowspec-nvo3">[I-D.ietf-idr-flowspec-nvo3]</dt>
        <dd>
<span class="refAuthor">Eastlake, D.</span>, <span class="refAuthor">Weiguo, H.</span>, <span class="refAuthor">Zhuang, S.</span>, <span class="refAuthor">Li, Z.</span>, and <span class="refAuthor">R. Gu</span>, <span class="refTitle">"BGP Dissemination of Flow Specification Rules for Tunneled Traffic"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-flowspec-nvo3-13</span>, <time datetime="2021-02-22" class="refDate">22 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/internet-drafts/draft-ietf-idr-flowspec-nvo3-13.txt">https://www.ietf.org/internet-drafts/draft-ietf-idr-flowspec-nvo3-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-wide-bgp-communities">[I-D.ietf-idr-wide-bgp-communities]</dt>
        <dd>
<span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Haas, J.</span>, <span class="refAuthor">Lange, A.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Amante, S.</span>, and <span class="refAuthor">P. Jakma</span>, <span class="refTitle">"BGP Community Container Attribute"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-wide-bgp-communities-05</span>, <time datetime="2018-07-02" class="refDate">2 July 2018</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-wide-bgp-communities-05.txt">https://www.ietf.org/archive/id/draft-ietf-idr-wide-bgp-communities-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4360">[RFC4360]</dt>
        <dd>
<span class="refAuthor">Sangli, S.</span>, <span class="refAuthor">Tappan, D.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"BGP Extended Communities Attribute"</span>, <span class="seriesInfo">RFC 4360</span>, <span class="seriesInfo">DOI 10.17487/RFC4360</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4360">https://www.rfc-editor.org/info/rfc4360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4760">[RFC4760]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Chandra, R.</span>, <span class="refAuthor">Katz, D.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"Multiprotocol Extensions for BGP-4"</span>, <span class="seriesInfo">RFC 4760</span>, <span class="seriesInfo">DOI 10.17487/RFC4760</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4760">https://www.rfc-editor.org/info/rfc4760</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6482">[RFC6482]</dt>
        <dd>
<span class="refAuthor">Lepinski, M.</span>, <span class="refAuthor">Kent, S.</span>, and <span class="refAuthor">D. Kong</span>, <span class="refTitle">"A Profile for Route Origin Authorizations (ROAs)"</span>, <span class="seriesInfo">RFC 6482</span>, <span class="seriesInfo">DOI 10.17487/RFC6482</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6482">https://www.rfc-editor.org/info/rfc6482</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7153">[RFC7153]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span> and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"IANA Registries for BGP Extended Communities"</span>, <span class="seriesInfo">RFC 7153</span>, <span class="seriesInfo">DOI 10.17487/RFC7153</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7153">https://www.rfc-editor.org/info/rfc7153</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8955">[RFC8955]</dt>
        <dd>
<span class="refAuthor">Loibl, C.</span>, <span class="refAuthor">Hares, S.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">McPherson, D.</span>, and <span class="refAuthor">M. Bacher</span>, <span class="refTitle">"Dissemination of Flow Specification Rules"</span>, <span class="seriesInfo">RFC 8955</span>, <span class="seriesInfo">DOI 10.17487/RFC8955</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8955">https://www.rfc-editor.org/info/rfc8955</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8956">[RFC8956]</dt>
      <dd>
<span class="refAuthor">Loibl, C., Ed.</span>, <span class="refAuthor">Raszuk, R., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"Dissemination of Flow Specification Rules for IPv6"</span>, <span class="seriesInfo">RFC 8956</span>, <span class="seriesInfo">DOI 10.17487/RFC8956</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8956">https://www.rfc-editor.org/info/rfc8956</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8205">[RFC8205]</dt>
        <dd>
<span class="refAuthor">Lepinski, M., Ed.</span> and <span class="refAuthor">K. Sriram, Ed.</span>, <span class="refTitle">"BGPsec Protocol Specification"</span>, <span class="seriesInfo">RFC 8205</span>, <span class="seriesInfo">DOI 10.17487/RFC8205</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8206">[RFC8206]</dt>
      <dd>
<span class="refAuthor">George, W.</span> and <span class="refAuthor">S. Murphy</span>, <span class="refTitle">"BGPsec Considerations for Autonomous System (AS) Migration"</span>, <span class="seriesInfo">RFC 8206</span>, <span class="seriesInfo">DOI 10.17487/RFC8206</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8206">https://www.rfc-editor.org/info/rfc8206</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Susan Hares</span></div>
<div dir="auto" class="left"><span class="org">Hickory Hill Consulting</span></div>
<div dir="auto" class="left"><span class="street-address">7453 Hickory Hill</span></div>
<div dir="auto" class="left">
<span class="locality">Saline</span>, <span class="region">MI</span> <span class="postal-code">48176</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shares@ndzh.com" class="email">shares@ndzh.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Donald Eastlake</span></div>
<div dir="auto" class="left"><span class="org">Futurewei</span></div>
<div dir="auto" class="left">
<span class="region">FL</span> </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:d3e3e3@gmail.com" class="email">d3e3e3@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
