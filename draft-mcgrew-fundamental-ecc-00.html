<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Fundamental Elliptic Curve Cryptography Algorithms</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Fundamental Elliptic Curve Cryptography Algorithms">
<meta name="keywords" content="Elliptic Curve Cryptography">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. McGrew</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">July 06, 2009</td></tr>
<tr><td class="header">Expires: January 7, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Fundamental Elliptic Curve Cryptography Algorithms<br />draft-mcgrew-fundamental-ecc-00.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 7, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
This note describes the fundamental algorithms of Elliptic Curve
Cryptography (ECC) as they are defined in some early references.
These descriptions may be useful to those who want to implement the
fundamental algorithms without using any of the specialized methods
that were developed in following years.  Only elliptic curves based on
fields of character greater than three are in scope.

</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Mathematical Background<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Mod">2.1.</a>&nbsp;
Modular Arithmetic<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#GROUP">2.2.</a>&nbsp;
Group Operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FIELD">2.3.</a>&nbsp;
Finite Fields<br />
<a href="#ECG">3.</a>&nbsp;
Elliptic Curve Groups<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.</a>&nbsp;
Homogenous Coordinates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#params">3.2.</a>&nbsp;
Group Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.2.1.</a>&nbsp;
Security<br />
<a href="#ECDH">4.</a>&nbsp;
Elliptic Curve Diffie-Hellman (ECDH)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Data Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#REP">4.2.</a>&nbsp;
Compact Representation<br />
<a href="#ECES">5.</a>&nbsp;
Elliptic Curve ElGamal Signatures (ECES)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#kpair">5.1.</a>&nbsp;
Keypair Generation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.2.</a>&nbsp;
Signature Creation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.3.</a>&nbsp;
Signature Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#hash">5.4.</a>&nbsp;
Hash Functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.5.</a>&nbsp;
Rationale<br />
<a href="#AECES">6.</a>&nbsp;
Abbreviated ECES Signatures (AECES)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">6.1.</a>&nbsp;
Keypair Generation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.2.</a>&nbsp;
Signature Creation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">6.3.</a>&nbsp;
Signature Verification<br />
<a href="#Interop">7.</a>&nbsp;
Interoperability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">7.1.</a>&nbsp;
ECDH<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SigInterop">7.2.</a>&nbsp;
ECES, AECES, and ECDSA<br />
<a href="#IPR">8.</a>&nbsp;
Intellectual Property<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">8.1.</a>&nbsp;
Disclaimer<br />
<a href="#SEC">9.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">9.1.</a>&nbsp;
Subgroups<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">9.2.</a>&nbsp;
Diffie-Hellman<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#twogroups">9.3.</a>&nbsp;
Group Representation and Security<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">9.4.</a>&nbsp;
Signatures<br />
<a href="#anchor17">10.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor18">11.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#rng">Appendix&nbsp;A.</a>&nbsp;
Random Number Generation<br />
<a href="#Example">Appendix&nbsp;B.</a>&nbsp;
Example Elliptic Curve Group<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
ECC is a public-key technology that offers performance advantages at
higher security levels.  It includes an Elliptic Curve version of
Diffie-Hellman key exchange protocol <a class='info' href='#DH1976'>[DH1976]<span> (</span><span class='info'>Diffie, W. and M. Hellman, &ldquo;New Directions in Cryptography,&rdquo; 1976.</span><span>)</span></a> and an
Elliptic Curve version of the ElGamal Signature Algorithm
<a class='info' href='#E1985'>[E1985]<span> (</span><span class='info'>ElGamal, T., &ldquo;A public key cryptosystem and a signature scheme            based on discrete logarithms,&rdquo; 1985.</span><span>)</span></a>.  The elliptic curve versions of these
algorithms are referred to as ECDH and ECES, respectively.  The
adoption of ECC has been slower than had been anticipated, perhaps due
to the lack of freely available normative documents and uncertainty
over intellectual property rights.

</p>
<p>
This note contains a description of the fundamental algorithms of ECC
over fields with characteristic greater than three, based directly on
original references.  Its intent is to provide the Internet community
with a normative specification of the basic algorithms that predate
any specialized or optimized algorithms.  

</p>
<p>
The rest of the note is organized as follows.  <a class='info' href='#Mod'>Section&nbsp;2.1<span> (</span><span class='info'>Modular Arithmetic</span><span>)</span></a>,
<a class='info' href='#GROUP'>Section&nbsp;2.2<span> (</span><span class='info'>Group Operations</span><span>)</span></a>, and <a class='info' href='#FIELD'>Section&nbsp;2.3<span> (</span><span class='info'>Finite Fields</span><span>)</span></a> furnish the
necessary terminology and notation from modular arithmetic, group
theory and the theory of finite fields, respectively.  <a class='info' href='#ECG'>Section&nbsp;3<span> (</span><span class='info'>Elliptic Curve Groups</span><span>)</span></a> defines the groups based on elliptic curves over finite
fields of characteristic greater than three.  <a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a>
and <a class='info' href='#ECES'>Section&nbsp;5<span> (</span><span class='info'>Elliptic Curve ElGamal Signatures (ECES)</span><span>)</span></a> present the fundamental ECDH and ECES
algorithms, respectively.  <a class='info' href='#AECES'>Section&nbsp;6<span> (</span><span class='info'>Abbreviated ECES Signatures (AECES)</span><span>)</span></a> presents an
abbreviated form of ECES.  The previous sections contain all of the
normative text (the text that defines the norm for
implementations conforming to this specification), and all of the
following sections are purely informative.  Interoperability is
discussed in <a class='info' href='#Interop'>Section&nbsp;7<span> (</span><span class='info'>Interoperability</span><span>)</span></a>.  <a class='info' href='#IPR'>Section&nbsp;8<span> (</span><span class='info'>Intellectual Property</span><span>)</span></a> reviews
intellectual property issues.  <a class='info' href='#SEC'>Section&nbsp;9<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> summarizes
security considerations.  <a class='info' href='#rng'>Appendix&nbsp;A<span> (</span><span class='info'>Random Number Generation</span><span>)</span></a> describes random number
generation and <a class='info' href='#Example'>Appendix&nbsp;B<span> (</span><span class='info'>Example Elliptic Curve Group</span><span>)</span></a> provides an example of an
Elliptic Curve group.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Mathematical Background</h3>

<p>
This section reviews mathematical preliminaries and establishes
terminology and notation that is used below.

</p>
<a name="Mod"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Modular Arithmetic</h3>

<p>
This section reviews modular arithmetic.  Two integers x and y are
said to be congruent modulo n if x - y is an integer multiple of n.

</p>
<p>
Two integers x and y are coprime when their greatest common divisor is
1; in this case, there is no third number z such that z divides x and
z divides y.

</p>
<p>
The set Zp = { 0, 1, 2, ..., p-1 } is closed under the operations of
modular addition, modular subtraction, modular multiplication, and
modular inverse.  These operations are as follows.  
</p>
<blockquote class="text">
<p>
For each pair of integers a and b in Zp, a + b mod p is equal to
<br />
 a + b if a + b < p, and is equal to a + b - p
otherwise.

</p>
<p>
For each pair of integers a and b in Zp, a - b mod p is equal to
<br />
 a - b if a + b > p, and is equal to a + b
otherwise.

</p>
<p>
For each pair of integers a and b in Zp, a * b mod p is equal to the remainder
of a * b divided by p.

</p>
<p>
For each integer x in Zp that is coprime with p, the inverse of x modulo p is
denoted as 1 / x mod p, and can be computed using the extended
euclidean algorithm (see Section 4.5.2 of <a class='info' href='#K1981v2'>[K1981v2]<span> (</span><span class='info'>Knuth, D., &ldquo;The Art of Computer Programming, Vol. 2: Seminumerical Algorithms,&rdquo; 1981.</span><span>)</span></a>, for
example).

</p>
</blockquote><p>
Algorithms for these operations are well known; for instance, see Chapter
4 of <a class='info' href='#K1981v2'>[K1981v2]<span> (</span><span class='info'>Knuth, D., &ldquo;The Art of Computer Programming, Vol. 2: Seminumerical Algorithms,&rdquo; 1981.</span><span>)</span></a>.

</p>
<a name="GROUP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Group Operations</h3>

<p>
This section establishes some terminology and notation for
mathematical groups, which is needed later on.  Background references
abound; see <a class='info' href='#D1966'>[D1966]<span> (</span><span class='info'>Deskins, W., &ldquo;Abstract Algebra,&rdquo; 1966.</span><span>)</span></a>, for example.

</p>
<p>
A group is a set of elements G and an associated operation that
combines any two elements in G and returns a third element in G.
The operation is denoted as * and its application is denoted
as a * b, for any two elements a and b in G.  Repeated application
of the group operation n times to the element a is denoted as 
a^N, for any element a in G and any positive integer N.   That is,
a^2, = a * a, <br />
 a^3 = a * a * a, and so on.    

</p>
<p>
The above definition of a group operation uses multiplicative
notation.  Sometimes an alternative called additive notation is used,
in which a * b is denoted as a + b, and a^N is denoted as N * a.  In
multiplicative notation, g^N is called exponentiation, while the
equivalent operation in additive notation is called scalar
multiplication.  In this document, multiplicative notation is used
throughout for consistency.

</p>
<p>
Every group has an special element called the identity element, which
we denote as e.  For each element a in G, e * a = a * e = a.  By 
convention, a^0 is equal to the identity element for any a in G.  

</p>
<p>
A cyclic group of order R is a group that contains the R elements
<br />
 g, g^2, g^3, ..., g^R.  The element g is
called the generator of the group.  The element g^R is equal to the
identity element e.  Note that g^X is equal to g^(X modulo R) for any
non-negative integer X.

</p>
<p>
Given the element a of order N, and an integer i between 1 and N-1,
inclusive, the element a^i can be computed by the "square and
multiply" method outlined in Section 2.1
of <a class='info' href='#M1983'>[M1983]<span> (</span><span class='info'>Massey, J., &ldquo;Logarithms in finite cyclic groups - cryptographic issues,&rdquo; 1983.</span><span>)</span></a> (see also Knuth, Vol. 2, Section
4.6.3.), or other methods.

</p>
<a name="FIELD"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Finite Fields</h3>

<p>
This section establishes terminology and notation for finite fields
with prime characteristic.

</p>
<p>
When p is a prime number, then the set Zp, with the associated
addition, subtraction, multiplication and division operations, is a
finite field with character p.  There is a one-to-one correspondence
between the integers between zero and p-1 and the elements of the
field.  The field is denoted as Fp.

</p>
<p>
Equations involving field elements do not include the "mod p"
operation, but it is understood to be implicit.  For example,
the statement that x, y, and z are in Fp and 
</p>
<blockquote class="text">
<p>
  z = x + y 

</p>
</blockquote><p>
is equivalent to the statement that x, y, and z are in Zp and
</p>
<blockquote class="text">
<p>
  z = x + y mod p.

</p>
</blockquote><p>

</p>
<a name="ECG"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Elliptic Curve Groups</h3>

<p>
This note only covers elliptic curves over fields with characteristic
greater than three.  For other fields, the definition of the elliptic
curve group would be different.

</p>
<p>
An elliptic curve over a field F is defined by the curve equation 
</p>
<blockquote class="text">
<p>
y^2 = x^3 + a*x + b,  

</p>
</blockquote><p>
where x, y, a, and b are elements of the field Fp <a class='info' href='#M1985'>[M1985]<span> (</span><span class='info'>Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; 1985.</span><span>)</span></a>.  A point on an elliptic curve is a pair (x,y) of
values in Fp that satisfy the curve equation, such that x and y are
both in Fp, or it is a special point (@,@) that represents the identity
element (which is called the "point at infinity").  The order of an
elliptic curve group is the number of distinct points.

</p>
<p>
Two elliptic curve points (x1,y1) and (x2,y2) are equal whenever x1=x2
and y1=y2, or when both points are the point at infinity.

</p>
<p> 
The group operation associated with the elliptic curve group is as
follows <a class='info' href='#BC1989'>[BC1989]<span> (</span><span class='info'>Bender, A. and G. Castagnoli, &ldquo;On the Implementation of Elliptic Curve Cryptosystems,&rdquo; 1989.</span><span>)</span></a>.  To an arbitrary pair of points P and
Q specified by their coordinates (x1,y1) and (x2,y2) respectively, the
group operation assigns a third point P*Q with the coordinates
(x3,y3).  These coordinates are computed as follows
</p>
<blockquote class="text">
<p>
  (x3,y3) = (@,@) when P is not equal to Q and x1 is equal to x2.

</p>
<p>
   x3 = ((y2-y1)/(x2-x1))^2 - x1 - x2  and <br />

   y3 = (x1-x3)*(y2-y1)/(x2-x1) - y1 when P is not equal to Q and <br />
 
x1 is not equal to x2.

</p>
<p>
(x3,y3) = (@,@) when P is equal to Q, P is equal to (0,0) and P is an element of the group.

</p>
<p>
x3 = ((3*x1^2 + a)/(2*y1))^2 - 2*x1  and <br />

y3 = (x1-x3)*(3*x1^2 + a)/(2*y1) - y1 if P is equal to Q.

</p>
</blockquote><p>
In the above equations, a, x1, x2, x3, y1, y2, and y3 are elements of
the field Fp; thus, computation of x3 and y3 in practice use a "mod p"
operation.

</p>
<p>
The representation of elliptic curve points as a pair of integers in
Zp is known as the affine coordinate representation.  This
representation is suitable as an external data representation for
communicating or storing group elements, though the point at infinity
must be treated as a special case.


</p>
<p>
Some pairs of integers are not valid elliptic curve points.  A valid
pair will satisfy the curve equation, while an invalid pair will not.

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Homogenous Coordinates</h3>

<p>
An alternative way to implement the group operation is to use
homogeneous coordinates <a class='info' href='#K1987'>[K1987]<span> (</span><span class='info'>Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; 1987.</span><span>)</span></a> (see also <a class='info' href='#KMOV1991'>[KMOV1991]<span> (</span><span class='info'>Koyama, K., Menezes, A., Vanstone, S., and T. Okamoto, &ldquo;New Public-Key Schemes Based on Elliptic Curves over the Ring Zn,&rdquo; 1991.</span><span>)</span></a>).  This method is typically more efficient because
it does not require a modular inverse operation.

</p>
<p>
An elliptic curve point (x,y) is equivalent to a point (X,Y,Z) in
homogeneous coordinates whenever x=X/Z and y=Y/Z.

</p>
<p>
Let P1=(X1,Y1,Z1) and P2=(X2,Y2,Z2) be points on an elliptic curve and
suppose that the points P1, P2 are not equal to (@,@), P1 is not equal
to P2, and P1 is not equal to -P2.  Then the product P3=(X3,Y3,Z3) =
P1 * P2 is given by
</p>
<blockquote class="text">
<p>
X3 = v * (Z2 * (Z1 * u^2 - 2 * X1 * v^2) - v^3),

</p>
<p>
Y3 = z2 * (3 * X1 * u * v^2 - Y1 * v^3 - Z1 * u^3),

</p>
<p>
Z3 = 8 * (Y1)^3 * (Z1)^3,

</p>
</blockquote><p>
where u = Y2 * Z1 - Y1 * Z2 and v = X2 * Z1 - X1 * Z2.

</p>
<p>
The product P3=(X3,Y3,Z3) = P1 * P1 is given by 
</p>
<blockquote class="text">
<p>
  X3 = 2 * Y1 * Z1 * (w^2 - 8 * X1 * Y1^2 * Z1),

</p>
<p>
  Y3 = 4 * Y1^2 * Z1 * (3 * w * X1 - 2 * Y1^2 * Z1) - w^3,

</p>
<p>
  Z3 = 8 * (Y1 * Z1)^3.

</p>
</blockquote><p>

</p>
<p>
In the above equations, a, u, v, w, X1, X2, X3, Y1, Y2, Y3, Z1, Z2,
and Z3 are elements of the field Fp; thus, computation of X3, Y3, and
Z3 in practice use a "mod p" operation.

</p>
<p>
When converting from affine coordinates to homogeneous coordinates, 
it is convenient to set Z to 1.   When converting from homogeneous
coordinates to affine coordinates, it is necessary to perform
a modular inverse to find 1/Z mod p.  

</p>
<a name="params"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Group Parameters</h3>

<p>
An elliptic curve group over a finite field with characteristic
greater than three is completely specified by the following
parameters:
</p>
<blockquote class="text">
<p>
The prime number p that indicates the order of the field Fp.

</p>
<p>
The value a used in the curve equation.   

</p>
<p>
The value b used in the curve equation.

</p>
<p>
The generator g of the group.  

</p>
</blockquote><p>
The order n of the group generated by g.

</p>
<p>
An example of an Elliptic Curve Group is provided in <a class='info' href='#Example'>Appendix&nbsp;B<span> (</span><span class='info'>Example Elliptic Curve Group</span><span>)</span></a>.

</p>
<p>
Each elliptic curve point is associated with with a particular group,
i.e a particular parameter set.  Two elliptic curve groups are equal
if and only if each of the parameters in the set are equal.  The
elliptic curve group operation is only defined between two points on
the same group.  It is an error to apply the group operation to two
elements that are from different groups, or to apply the group
operation to a pair of coordinates that are not a valid point.
See <a class='info' href='#twogroups'>Section&nbsp;9.3<span> (</span><span class='info'>Group Representation and Security</span><span>)</span></a> for further information.

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Security</h3>

<p>
Security is highly dependent on the choice of these parameters.
This section gives normative guidance on acceptable choices.
See also <a class='info' href='#SEC'>Section&nbsp;9<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> for more information.

</p>
<p>
The order of the group generated by g should be divisible by a large
prime, in order to preclude easy solution of the discrete logarithm
problem <a class='info' href='#K1987'>[K1987]<span> (</span><span class='info'>Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; 1987.</span><span>)</span></a>

</p>
<p>
With some parameter choices, the discrete log problem is significantly
easier to solve.  This includes parameter sets in which b = 0 and p = 3
(mod 4), and parameter sets in which a = 0 and 
<br />

p = 2 (mod 3)
<a class='info' href='#MOV1993'>[MOV1993]<span> (</span><span class='info'>Menezes, A., Vanstone, S., and T. Okamoto, &ldquo;Reducing Elliptic Curve Logarithms to 	     Logarithms in a Finite Field,&rdquo; September, 1993.</span><span>)</span></a>.  These parameter choices are inferior for
cryptographic purposes and should not be used.

</p>
<a name="ECDH"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Elliptic Curve Diffie-Hellman (ECDH)</h3>

<p>
The Diffie-Hellman (DH) key exchange protocol <a class='info' href='#DH1976'>[DH1976]<span> (</span><span class='info'>Diffie, W. and M. Hellman, &ldquo;New Directions in Cryptography,&rdquo; 1976.</span><span>)</span></a>
allows two parties communicating over an insecure channel to agree on
a secret key.  It was originally defined in terms of operations in the
multiplicative group of a field with a large prime characteristic.
Massey <a class='info' href='#M1983'>[M1983]<span> (</span><span class='info'>Massey, J., &ldquo;Logarithms in finite cyclic groups - cryptographic issues,&rdquo; 1983.</span><span>)</span></a> observed that it can be easily
generalized so that it is defined in terms of an arbitrary
mathematical group.  Miller <a class='info' href='#M1985'>[M1985]<span> (</span><span class='info'>Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; 1985.</span><span>)</span></a> and Koblitz <a class='info' href='#K1987'>[K1987]<span> (</span><span class='info'>Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; 1987.</span><span>)</span></a> analyzed the DH protocol over an elliptic curve
group.  We describe DH following the former reference.

</p>
<p>
Let G be a group, and g be a generator for that group, and let t
denote the order of G.  The DH protocol runs as follows.  Party A
chooses an exponent j between 1 and t-1 uniformly at random, computes
g^j and sends that element to B.  Party B chooses an exponent k
between 1 and t-1 uniformly at random, computes g^k and sends that
element to A.  Each party can compute g^(j*k); party A computes
(g^k)^j, and party B computes (g^j)^k.

</p>
<p>
See <a class='info' href='#rng'>Appendix&nbsp;A<span> (</span><span class='info'>Random Number Generation</span><span>)</span></a> regarding generation of random numbers.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Data Types</h3>

<p>
An ECDH private key a is an integer in Zt.  

</p>
<p>
The corresponding ECDH public key Y is group element, where Y = g^a.
Each public key is associated with a particular group, i.e. a
particular parameter set as per <a class='info' href='#params'>Section&nbsp;3.2<span> (</span><span class='info'>Group Parameters</span><span>)</span></a>.  

</p>
<p> 
The shared secret computed by both parties is a group element.

</p>
<p>
Each run of the ECDH protocol is associated with a particular group,
and both of the public keys and the shared secret are elements of that
group.

</p>
<a name="REP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Compact Representation</h3>

<p>
As described in the final paragraph of <a class='info' href='#M1985'>[M1985]<span> (</span><span class='info'>Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; 1985.</span><span>)</span></a>, the
x-coordinate of the shared secret value g^(j*k) is a suitable
representative for the entire point whenever exponentiation is used as
a one-way function.  In the ECDH key exchange protocol, after the element
g^(j*k) has been computed, the x-coordinate of that value can be used
as the shared secret.  We call this compact output.

</p>
<p>
Following <a class='info' href='#M1985'>[M1985]<span> (</span><span class='info'>Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; 1985.</span><span>)</span></a> again, when compact output is used in
ECDH, only the x-coordinate of an elliptic curve point needs to be
transmitted, instead of both coordinates as in the typical affine
coordinate representation.  We call this the compact representation.

</p>
<p>
ECDH can be used with or without compact output.  Both parties in a
particular run of the ECDH protocol must use the same method.  ECDH
can be used with or without compact representation.  If compact
representation is used in a particular run of the ECDH protocol, then
compact output must be used as well.

</p>
<a name="ECES"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Elliptic Curve ElGamal Signatures (ECES)</h3>

<p>
The ElGamal signature algorithm was introduced in 1984
<a class='info' href='#E1984a'>[E1984a]<span> (</span><span class='info'>ElGamal, T., &ldquo;Cryptography and logarithms over finite fields,&rdquo; 1984.</span><span>)</span></a> <a class='info' href='#E1984b'>[E1984b]<span> (</span><span class='info'>ElGamal, T., &ldquo;Cryptography and logarithms over finite fields,&rdquo; 1984.</span><span>)</span></a>
<a class='info' href='#E1985'>[E1985]<span> (</span><span class='info'>ElGamal, T., &ldquo;A public key cryptosystem and a signature scheme            based on discrete logarithms,&rdquo; 1985.</span><span>)</span></a>.  It is based on the discrete logarithm problem
in the multiplicative group of the integers modulo a large prime
number.  It is straightforward to extended it to use an elliptic curve
group.  In this section we recall a well-specified elliptic curve
version of the ElGamal Signature Algorithm, as described in
<a class='info' href='#A1992'>[A1992]<span> (</span><span class='info'>Anderson, J., &ldquo;Response to the proposed DSS,&rdquo; July&nbsp;1992.</span><span>)</span></a> and <a class='info' href='#MV1993'>[MV1993]<span> (</span><span class='info'>Menezes, A. and S. Vanstone, &ldquo;Elliptic Curve Cryptosystems and Their Implementation,&rdquo; 1993.</span><span>)</span></a>.
This signature method is called Elliptic Curve ElGamal Signatures (ECES).

</p>
<p>
The algorithm uses an elliptic curve group, as described in <a class='info' href='#params'>Section&nbsp;3.2<span> (</span><span class='info'>Group Parameters</span><span>)</span></a>.  We denote the generator as alpha, and the order of
the generator as n.  We follow <a class='info' href='#MV1993'>[MV1993]<span> (</span><span class='info'>Menezes, A. and S. Vanstone, &ldquo;Elliptic Curve Cryptosystems and Their Implementation,&rdquo; 1993.</span><span>)</span></a> in describing
the algorithms in terms of mathematical groups.

</p>
<p>
ECES uses a collision-resistant hash function, so that it can
sign messages of arbitrary length.  We denote the hash function as
h().  Its input is a bit string of arbitrary length, and its output is
an integer between zero and n-1, inclusive.

</p>
<p>
ECES uses a function g() from the set of group elements to the set of
integers Zn.  This function returns the x-coordinate of the affine
coordinate representation of the elliptic curve point.

</p>
<a name="kpair"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Keypair Generation</h3>

<p>
The private key a is an integer between 0 and n - 1, inclusive,
generated uniformly at random.  The public key is the group element <br />

Q = alpha^a.  

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Signature Creation</h3>

<p>
To sign message m, using the private key a:
</p>
<ol class="text">
<li>
    First, choose an integer k uniformly at random from the set of all
    integers k in Zn that are coprime to n.  (If n is a prime, then
    choose an integer uniformly at random between 1 and n-1.)  (See
    <a class='info' href='#rng'>Appendix&nbsp;A<span> (</span><span class='info'>Random Number Generation</span><span>)</span></a> regarding random integers.)
  
</li>
<li>
    Next, compute the group element r = alpha^k.
  
</li>
<li>
    Finally, compute the integer s as
  
<blockquote class="text">
<p> s = (h(m) + a * g(r)) / k (mod n). 
</p>
</blockquote>
  
</li>
<li>
    If s is equal to zero, then the signature creation 
    must be repeated, starting at Step 1 and using
    a newly chosen k value.
  
</li>
</ol><p>
The signature for message m is the ordered pair (r, s).  Note that the
first component is a group element, and the second is a non-negative
integer.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Signature Verification</h3>

<p>
To verify the message m and the signature (r,s) using
the public key Q:
</p>
<blockquote class="text">
<p>
    Compute the group element r^s * Q^(-g(r)).
  
</p>
<p>
    Compute the group element alpha^h(m).
  
</p>
<p>
  Verify that the two elements previously computed are the same.  If
  they are identical, then the signature and message pass the
  verification; otherwise, they fail.
  
</p>
</blockquote><p>

</p>
<a name="hash"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Hash Functions</h3>

<p>
Let H() denote a hash function whose output is a fixed-length bit
string.  To use H in ECES, we define the mapping between that output
and the integers between zero and n-1; this realizes the function h()
described above.   Given a bit string m, the function h(m) is computed
as follows:
</p>
<ol class="text">
<li>
H(m) is evaluated; the result is a fixed-length bit string.

</li>
<li>
Convert the resulting bit string to an integer i by treating its
leftmost (initial) bit as the most significant bit of i, and treating
its rightmost (final) bit as the least significant bit of i.

</li>
<li>
After conversion, reduce i modulo n, where n is the group order.

</li>
</ol><p>

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Rationale</h3>

<p>
This subsection is not normative and is provided only as background information.

</p>
<p>
The signature verification will pass whenever the signature is
properly generated, because
</p>
<blockquote class="text">
<p>
r^s * Q^(-g(r)) = alpha^(k*s - a*g(r)) = alpha^h(m).

</p>
</blockquote><p>

</p>
<p>
The reason that the random variable k must be coprime with n is so
that 1/k mod n is defined.

</p>
<p>
A valid signature with s=0 leaks the secret key, since in that case 
a = h(m) / g(r) mod n.  We adopt Rivest's suggestion to avoid
this problem <a class='info' href='#R1992'>[R1992]<span> (</span><span class='info'>Rivest, R., &ldquo;Response to the proposed DSS,&rdquo; July&nbsp;1992.</span><span>)</span></a>.

</p>
<p>
As described in the final paragraph of <a class='info' href='#M1985'>[M1985]<span> (</span><span class='info'>Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; 1985.</span><span>)</span></a>, for it
is suitable to use the x-coordinate of a particular elliptic curve
point as a representative for that point.  This is what the function
g() does.

</p>
<a name="AECES"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Abbreviated ECES Signatures (AECES)</h3>

<p>
The ECES system is secure and efficient, but has signatures that are
slightly larger than they need to be.  Koyama and Tsuruoka described a
signature system based on Elliptic Curve ElGamal, but with shorter
signatures <a class='info' href='#KT1994'>[KT1994]<span> (</span><span class='info'>Koyama, K. and Y. Tsuruoka, &ldquo;Digital signature system based on elliptic curve 	     and signer device and verifier device for said system,&rdquo; 1994.</span><span>)</span></a>.  Their idea is to include only the
x-coordinate of the EC point in the signature, instead of both
coordinates.  Menezes, Qu, and Vanstone independently developed the
same idea, which was the basis for the "Elliptic Curve Signature
Scheme with Appendix (ECSSA)" submission to the IEEE 1363 working
group <a class='info' href='#MQV1994'>[MQV1994]<span> (</span><span class='info'>Menezes, A., Qu, M., and S. Vanstone, &ldquo;Submission to the IEEE P1363 Working Group (Part 6: 	    Elliptic Curve Systems, Draft 2),&rdquo; October, 1994.</span><span>)</span></a>.

</p>
<p>
In this section we describe an Elliptic Curve Signature Scheme that
hash a single elliptic curve coordinate in the signature instead of
both coordinates.  It is based on ECSSA, but with an inversion
operation moved from the signature operation to the verification
operation, so that the signing operation is more compatible with ECES.
(See <a class='info' href='#AMV1990'>[AMV1990]<span> (</span><span class='info'>Agnew, G., Mullin, R., and S. Vanstone, &ldquo;Improved Digital Signature Scheme based on Discrete Exponentiation,&rdquo; July, 1990.</span><span>)</span></a> and <a class='info' href='#A1992'>[A1992]<span> (</span><span class='info'>Anderson, J., &ldquo;Response to the proposed DSS,&rdquo; July&nbsp;1992.</span><span>)</span></a> for a
discussion of these alternatives; the security of the methods is
equivalent.)  We refer to this scheme as Abbreviated ECES, or AECES.

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Keypair Generation</h3>

<p>
Keypairs are the same as for ECES and are as described in <a class='info' href='#kpair'>Section&nbsp;5.1<span> (</span><span class='info'>Keypair Generation</span><span>)</span></a>.

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Signature Creation</h3>

<p>
In this section we describe how to compute the signature for a message m
using the private key a.  

</p>
<p>
Signature creation is as for ECES, with the following additional step:
</p>
<ol class="text">
<li>
    Let the integer s1 be equal to the x-coordinate of r.
  
</li>
</ol><p>
The signature is the ordered pair (s1, s).    Both signature components
are non-negative integers.

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Signature Verification</h3>

<p>
Given the message m, the public key Q, and the signature (s1,s) verification is as follows:
</p>
<ol class="text">
<li>
    Compute the inverse of s modulo q.  We denote this value as w. 
  
</li>
<li>
    Compute the non-negative integers u and v, where 
    
<blockquote class="text">
<p>
	u = w * h(m) mod q, and 
      
</p>
<p>
	v = w * s1 mod q.
      
</p>
</blockquote> 
  
</li>
<li>
    Compute the elliptic curve point R' = alpha^u * Q^v
  
</li>
<li>
    If the x-coordinate of R' is equal to s1, then the signature and
    message pass the verification; otherwise, they fail.
  
</li>
</ol><p>

</p>
<a name="Interop"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Interoperability</h3>

<p>
The algorithms in this note can be used to interoperate with
some other ECC specifications.  This section provides details
for each algorithm.

</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
ECDH</h3>

<p>
<a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a> can be used with the Internet Key Exchange (IKE)
versions one <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a> or two <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.  These algorithms are compatible
with the ECP groups for the defined by
<a class='info' href='#RFC4753'>[RFC4753]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;ECP Groups For IKE and IKEv2,&rdquo; January&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a>, and <a class='info' href='#RFC2412'>[RFC2412]<span> (</span><span class='info'>Orman, H., &ldquo;The OAKLEY Key Determination Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a>.   The group definition used in this protocol
uses an affine coordinate representation of the public key
and uses neither the compact output nor the compact representation
of <a class='info' href='#REP'>Section&nbsp;4.2<span> (</span><span class='info'>Compact Representation</span><span>)</span></a>.
Note that some groups use a negative curve
parameter "a" and express this fact in the curve equation rather than
in the parameter.  The test cases in Section 8 of <a class='info' href='#RFC4753'>[RFC4753]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;ECP Groups For IKE and IKEv2,&rdquo; January&nbsp;2007.</span><span>)</span></a> can be used to test an implementation; these cases
use the multiplicative notation, as does this note.  The KEi and KEr
payloads are equal to g^i and g^r, respectively, with 64 bits of
encoding data prepended to them.

</p>
<p>
The algorithms in <a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a> can be used to interoperate
with the IEEE <a class='info' href='#P1363'>[P1363]<span> (</span><span class='info'>, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; 2000.</span><span>)</span></a> and ANSI <a class='info' href='#X9.62'>[X9.62]<span> (</span><span class='info'>, &ldquo;Public Key Cryptography for the Financial Services                    Industry: The Elliptic Curve Digital Signature                    Algorithm (ECDSA),&rdquo; .</span><span>)</span></a>
standards for ECDH based on fields of characteristic greater than
three.  

</p>
<a name="SigInterop"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
ECES, AECES, and ECDSA</h3>

<p>
The Digital Signature Algorithm (DSA) is based on the discrete
logarithm problem over the multiplicative subgroup of the finite field
large prime order <a class='info' href='#DSA1991'>[DSA1991]<span> (</span><span class='info'>, &ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; August&nbsp;1991.</span><span>)</span></a><a class='info' href='#FIPS186'>[FIPS186]<span> (</span><span class='info'>, &ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; 1994.</span><span>)</span></a>.
The Elliptic Curve Digital Signature Algorithm (ECDSA) <a class='info' href='#P1363'>[P1363]<span> (</span><span class='info'>, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; 2000.</span><span>)</span></a> <a class='info' href='#X9.62'>[X9.62]<span> (</span><span class='info'>, &ldquo;Public Key Cryptography for the Financial Services                    Industry: The Elliptic Curve Digital Signature                    Algorithm (ECDSA),&rdquo; .</span><span>)</span></a> is an elliptic curve version
of DSA.

</p>
<p>
AECES can interoperate with the IEEE <a class='info' href='#P1363'>[P1363]<span> (</span><span class='info'>, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; 2000.</span><span>)</span></a> and ANSI
<a class='info' href='#X9.62'>[X9.62]<span> (</span><span class='info'>, &ldquo;Public Key Cryptography for the Financial Services                    Industry: The Elliptic Curve Digital Signature                    Algorithm (ECDSA),&rdquo; .</span><span>)</span></a> standards for Elliptic Curve DSA (ECDSA) based
on fields of characteristic greater than three.

</p>
<p>
An ECES signature can be converted into an ECDSA signature by discarding
the y-coordinate from the elliptic curve point.

</p>
<p>
There is a strong correspondence between ECES signatures and ECDSA signatures.  
In the notation of <a class='info' href='#ECES'>Section&nbsp;5<span> (</span><span class='info'>Elliptic Curve ElGamal Signatures (ECES)</span><span>)</span></a>, an ECDSA signature
consists of the pair of integers (g(r), s), and signature verification
passes if and only if 
</p>
<blockquote class="text">
<p>
  A^(h(m)/s) * Q^(g(r)/s) = r,
  
</p>
</blockquote><p>
where the equality of the elliptic curve elements is checked by
checking for the equality of their x-coordinates.  For valid
signatures, (h(m)+a*r)/s mod q = k, and thus the two sides are equal.
An ECDSA signature contains only the x-coordinate g(r), but this is
sufficient to allow the signatures to be checked with the above
method.

</p>
<p>
Whenever the ECES signature (r, s) is valid for a particular message m,
and public key Q, then there is a valid ECDSA signature (g(r), s) for the same
message and public key.

</p>
<p>
Whenever the ECDSA signature (c, d) is valid for a particular message
m, and public key Q, then there is a valid ECES signature for the same
message and public key.  This signature has the form ((c, f(c)), d),
or ((c, q-f(c)), d) where the function f takes as input an integer in
Zq and is defined as
</p>
<blockquote class="text">
<p>
   f(x) = sqrt(x^3 + a*x + b) (mod q).
  
</p>
</blockquote><p>
It is possible to compute the square root modulo q, for instance, by
using Shanks's method <a class='info' href='#K1987'>[K1987]<span> (</span><span class='info'>Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; 1987.</span><span>)</span></a>.  However, it is not as
efficient to convert an ECDSA signature (or an AECES signature) to an
ECES signature.

</p>
<a name="IPR"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Intellectual Property</h3>

<p>
Concerns about intellectual property have slowed the adoption of ECC,
because a number of optimizations and specialized algorithms have
been patented in recent years.  

</p>
<p>
All of the normative references in this note were published during or
before October, 1994, and all of the normative text in this note is
based solely on those references.

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Disclaimer</h3>

<p>
   This document is not intended as legal advice.  Readers are advised
   to consult their own legal advisers if they would like a legal
   interpretation of their rights.

</p>
<p>
   The IETF policies and processes regarding intellectual property and
   patents are outlined in <a class='info' href='#RFC3979'>[RFC3979]<span> (</span><span class='info'>Bradner, S., &ldquo;Intellectual Property Rights in IETF Technology,&rdquo; March&nbsp;2005.</span><span>)</span></a> and
   <a class='info' href='#RFC4879'>[RFC4879]<span> (</span><span class='info'>Narten, T., &ldquo;Clarification of the Third Party Disclosure Procedure in RFC 3979,&rdquo; April&nbsp;2007.</span><span>)</span></a> and at
   https://datatracker.ietf.org/ipr/about/.

</p>
<a name="SEC"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>
The security level of an elliptic curve cryptosystem is determined by
the cryptanalytic algorithm that is the least expensive for an
attacker to implement.   There are several algorithms to consider.

</p>
<p>
The Polhig-Hellman method is a divide-and-conquer technique
<a class='info' href='#PH1978'>[PH1978]<span> (</span><span class='info'>Polhig, S. and M. Hellman, &ldquo;An Improved Algorithm for Computing Logarithms over 	     GF(p) and its Cryptographic Significance,&rdquo; 1978.</span><span>)</span></a>.  If the group order n can be 
factored as
</p>
<blockquote class="text">
<p>
    n = q1 * q2 *  ... * qz,
    
</p>
</blockquote><p>
then the discrete log problem over the group can be solved by
independently solving a discrete log problem in groups of order q1,
q2, ..., qz, then combining the results using the Chinese remainder
theorem.   The overall computational cost is dominated by 
that of the discrete log problem in the subgroup with the
largest order. 

</p>
<p>
Shanks algorithm <a class='info' href='#K1981v3'>[K1981v3]<span> (</span><span class='info'>Knuth, D., &ldquo;The Art of Computer Programming, Vol. 3:            Sorting and Searching,&rdquo; 1981.</span><span>)</span></a> computes a discrete
logarithm in a group of order n using O(sqrt(n)) operations and
O(sqrt(n)) storage.  The Pollard rho algorithm <a class='info' href='#P1978'>[P1978]<span> (</span><span class='info'>Pollard, J., &ldquo;Monte Carlo methods for index computation mod p,&rdquo; 1978.</span><span>)</span></a>
computes a discrete logarithm in a group of order n using O(sqrt(n))
operations, with a negligible amount of storage, and can be
efficiently parallelized.

</p>
<p>
The Pollard lambda algorithm  <a class='info' href='#P1978'>[P1978]<span> (</span><span class='info'>Pollard, J., &ldquo;Monte Carlo methods for index computation mod p,&rdquo; 1978.</span><span>)</span></a> can 
solve the discrete logarithm problem using O(sqrt(w))
operations and O(log(w)) storage, when the exponent
belongs to a set of w elements.  

</p>
<p>
The algorithms described above work in any group.  There
are specialized algorithms that specifically target
elliptic curve groups.  There are no subexponential algorithms
against general elliptic curve groups, though
there are methods that target certain special 
elliptic curve groups; see <a class='info' href='#MOV1993'>[MOV1993]<span> (</span><span class='info'>Menezes, A., Vanstone, S., and T. Okamoto, &ldquo;Reducing Elliptic Curve Logarithms to 	     Logarithms in a Finite Field,&rdquo; September, 1993.</span><span>)</span></a>
and <a class='info' href='#FR1994'>[FR1994]<span> (</span><span class='info'>Frey, G. and H. Ruck, &ldquo;A remark concerning m-divisibility and the discrete 	     logarithm in the divisor class group of curves.,&rdquo; 1994.</span><span>)</span></a>.

</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Subgroups</h3>

<p>
A group consisting of a set of elements S with associated group
operation * is a subgroup of the group with the set of elements G, if
the latter group uses the same group operation and S is a subset of G.
For each elliptic curve equation, there is an elliptic curve group
whose group order is equal to the order of the elliptic curve; that
is, there is a group that contains every point on the curve.  

</p>
<p>
The order m of the elliptic curve is divisible by the order n of the
group associated with the generator; that is, for each elliptic curve
group, m = n * c for some number c.  The number c is called the
"cofactor" <a class='info' href='#P1363'>[P1363]<span> (</span><span class='info'>, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; 2000.</span><span>)</span></a>.  Each elliptic curve group (e.g.
each parameter set as in <a class='info' href='#params'>Section&nbsp;3.2<span> (</span><span class='info'>Group Parameters</span><span>)</span></a>) is associated with a
particular cofactor.

</p>
<p>
It is possible and desirable to use a cofactor equal to 1.  

</p>
<p>
It is common to use a "safe prime group" in the conventional
Diffie-Hellman protocol over the multiplicative group of the prime
field Fp (see Appendix E of <a class='info' href='#RFC2412'>[RFC2412]<span> (</span><span class='info'>Orman, H., &ldquo;The OAKLEY Key Determination Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a> for example).  A
safe prime group is the subgroup of prime order q of the
multiplicative group of Zp, where p-1 = 2*q.  The use of safe prime
groups simplifies protocol design, implementation and use, because they
minimize the effectiveness of some cryptanalytic attacks.  Elliptic
curve groups with a cofactor of 1 have similar benefits.

</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Diffie-Hellman</h3>

<p>
Note that the key exchange protocol as defined in
<a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a> does not protect against active attacks; Party A
must use some method to ensure that (g^k) originated with the intended
communicant B, rather than an attacker, and Party B must do the same
with (g^j).

</p>
<p>
It is not sufficient to authenticate the shared secret g^(j*k), since
this leaves the protocol open to attacks that manipulate the public
keys.  Instead, the values of the public keys g^x and g^y that are
exchanged should be directly authenticated.  This is the strategy used
by protocols that build on Diffie-Hellman and which use end-entity
authentication to protect against active attacks, such as OAKLEY <a class='info' href='#RFC2412'>[RFC2412]<span> (</span><span class='info'>Orman, H., &ldquo;The OAKLEY Key Determination Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a> and the Internet Key Exchange <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a><a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.

</p>
<p>
When the cofactor of a group is not equal to 1, there are a number of
attacks that are possible against ECDH.   See <a class='info' href='#VW1996'>[VW1996]<span> (</span><span class='info'>van Oorschot, P. and M. Wiener, &ldquo;On Diffie-Hellman key agreement with short exponents,&rdquo; 1996.</span><span>)</span></a>,
<a class='info' href='#AV1996'>[AV1996]<span> (</span><span class='info'>Anderson, R. and S. Vaudenay, &ldquo;Minding Your P's and Q's,&rdquo; 1996.</span><span>)</span></a>, and <a class='info' href='#LL1997'>[LL1997]<span> (</span><span class='info'>Lim, C. and P. Lee, &ldquo;A Key Recovery Attack on Discrete Log-based Schemes 	     Using a Prime Order Subgroup,&rdquo; 1997.</span><span>)</span></a>.

</p>
<a name="twogroups"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Group Representation and Security</h3>

<p>
The elliptic curve group operation does not explicitly incorporate the
parameter b from the curve equation.  This opens the possibility that
a malicious attacker could learn information about an ECDH private key
by submitting a bogus public key <a class='info' href='#BMM2000'>[BMM2000]<span> (</span><span class='info'>Biehl, I., Meyer, B., and V. Muller, &ldquo;Differential fault analysis on elliptic curve cryptosystems,&rdquo; 2000.</span><span>)</span></a>.  An
attacker can craft an elliptic curve group G' that has identical
parameters to a group G that is being used in an ECDH protocol, except
that b is different.  An attacker can submit a point on G' into a run
of the ECDH protocol that is using group G, and gain information from
the fact that the group operations using the private key of the device
under attack are effectively taking place in G' instead of G.

</p>
<p>
This attack can gain useful information about an ECDH private key that
is associated with a static public key, that is, a public key that is
used in more than one run of the protocol.  However, it does not
gain any useful information against ephemeral keys.

</p>
<p>
This sort of attack is thwarted if an ECDH implementation does not
assume that each pair of coordinates in Zp is actually a point on the
appropriate elliptic curve.

</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
Signatures</h3>

<p>
Elliptic curve parameters should only be used if they come from a
trusted source; otherwise, some attacks are possible
<a class='info' href='#AV1996'>[AV1996]<span> (</span><span class='info'>Anderson, R. and S. Vaudenay, &ldquo;Minding Your P's and Q's,&rdquo; 1996.</span><span>)</span></a>, <a class='info' href='#V1996'>[V1996]<span> (</span><span class='info'>Vaudenay, S., &ldquo;Hidden Collisions on DSS,&rdquo; 1996.</span><span>)</span></a>.

</p>
<p>
In principle, any collision-resistant hash function is suitable
for use in ECES.  To facilitate interoperability, we recognize
the following hashes as suitable for use as the function H defined in 
<a class='info' href='#hash'>Section&nbsp;5.4<span> (</span><span class='info'>Hash Functions</span><span>)</span></a>:
</p>
<blockquote class="text">
<p>
    SHA-256, which has a 256-bit output.  
  
</p>
<p>
    SHA-384, which has a 384-bit output.
  
</p>
<p>
    SHA-512, which has a 512-bit output.
  
</p>
</blockquote><p>
All of these hash functions are defined in <a class='info' href='#FIPS180-2'>[FIPS180&#8209;2]<span> (</span><span class='info'>, &ldquo;SECURE HASH STANDARD,&rdquo; August&nbsp;2002.</span><span>)</span></a>.

</p>
<p>
The number of bits in the output of the hash used in ECES should be
equal or close to the number of bits needed to represent the
group order.

</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>
This note has no actions for IANA.  This section should be removed by
the RFC editor before publication as an RFC.

</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>
The author expresses his thanks to the originators of elliptic curve
cryptography, whose work made this note possible.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="A1992">[A1992]</a></td>
<td class="author-text">Anderson, J., &ldquo;Response to the proposed DSS,&rdquo; Communications of the ACM&nbsp;v.35 n.7 p.50-52, July&nbsp;1992.</td></tr>
<tr><td class="author-text" valign="top"><a name="AMV1990">[AMV1990]</a></td>
<td class="author-text">Agnew, G., Mullin, R., and S. Vanstone, &ldquo;Improved Digital Signature Scheme based on Discrete Exponentiation,&rdquo; Electronics Letters&nbsp;Vol. 26, No. 14, July, 1990.</td></tr>
<tr><td class="author-text" valign="top"><a name="BC1989">[BC1989]</a></td>
<td class="author-text">Bender, A. and G. Castagnoli, &ldquo;On the Implementation of Elliptic Curve Cryptosystems,&rdquo; Advances in Cryptology - CRYPTO '89 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 435, 1989.</td></tr>
<tr><td class="author-text" valign="top"><a name="D1966">[D1966]</a></td>
<td class="author-text">Deskins, W., &ldquo;Abstract Algebra,&rdquo; MacMillan Company&nbsp;, 1966.</td></tr>
<tr><td class="author-text" valign="top"><a name="DH1976">[DH1976]</a></td>
<td class="author-text">Diffie, W. and M. Hellman, &ldquo;New Directions in Cryptography,&rdquo; IEEE Transactions in Information Theory&nbsp;IT-22, pp 644-654, 1976.</td></tr>
<tr><td class="author-text" valign="top"><a name="E1984a">[E1984a]</a></td>
<td class="author-text">ElGamal, T., &ldquo;Cryptography and logarithms over finite fields,&rdquo; Stanford University&nbsp;UMI Order No. DA 8420519, 1984.</td></tr>
<tr><td class="author-text" valign="top"><a name="E1984b">[E1984b]</a></td>
<td class="author-text">ElGamal, T., &ldquo;Cryptography and logarithms over finite fields,&rdquo; Advances in Cryptology - CRYPTO '84 Proceedings&nbsp;Springer Lecture Notes in Computer Science (LNCS) volume 196, 1984.</td></tr>
<tr><td class="author-text" valign="top"><a name="E1985">[E1985]</a></td>
<td class="author-text">ElGamal, T., &ldquo;A public key cryptosystem and a signature scheme
           based on discrete logarithms,&rdquo; IEEE Transactions on Information Theory&nbsp;Vol 30, No. 4, pp. 469-472, 1985.</td></tr>
<tr><td class="author-text" valign="top"><a name="FR1994">[FR1994]</a></td>
<td class="author-text">Frey, G. and H. Ruck, &ldquo;A remark concerning m-divisibility and the discrete
	     logarithm in the divisor class group of curves.,&rdquo; Mathematics of Computation&nbsp;Vol. 62, No. 206, pp. 865-874, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="K1981v2">[K1981v2]</a></td>
<td class="author-text">Knuth, D., &ldquo;The Art of Computer Programming, Vol. 2: Seminumerical Algorithms,&rdquo; Addison Wesley&nbsp;, 1981.</td></tr>
<tr><td class="author-text" valign="top"><a name="K1987">[K1987]</a></td>
<td class="author-text">Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; Mathematics of Computation&nbsp;Vol. 48, 1987, 203-209, 1987.</td></tr>
<tr><td class="author-text" valign="top"><a name="M1983">[M1983]</a></td>
<td class="author-text">Massey, J., &ldquo;Logarithms in finite cyclic groups - cryptographic issues,&rdquo; Processings of the 4th Symposium on Information Theory&nbsp;, 1983.</td></tr>
<tr><td class="author-text" valign="top"><a name="M1985">[M1985]</a></td>
<td class="author-text">Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; Advances in Cryptology - CRYPTO '85 Proceedings&nbsp;Springer Lecture Notes in Computer Science (LNCS) volume 218, 1985.</td></tr>
<tr><td class="author-text" valign="top"><a name="MOV1993">[MOV1993]</a></td>
<td class="author-text">Menezes, A., Vanstone, S., and T. Okamoto, &ldquo;Reducing Elliptic Curve Logarithms to
	     Logarithms in a Finite Field,&rdquo; IEEE Transactions on Information Theory&nbsp;Vol 39, No. 5, pp. 1639-1646, September, 1993.</td></tr>
<tr><td class="author-text" valign="top"><a name="MQV1994">[MQV1994]</a></td>
<td class="author-text">Menezes, A., Qu, M., and S. Vanstone, &ldquo;Submission to the IEEE P1363 Working Group (Part 6:
	    Elliptic Curve Systems, Draft 2),&rdquo; Working Document&nbsp;, October, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="MV1993">[MV1993]</a></td>
<td class="author-text">Menezes, A. and S. Vanstone, &ldquo;Elliptic Curve Cryptosystems and Their Implementation,&rdquo; Journal of Cryptology&nbsp;Volume 6, No. 4, pp209-224, 1993.</td></tr>
<tr><td class="author-text" valign="top"><a name="R1992">[R1992]</a></td>
<td class="author-text">Rivest, R., &ldquo;Response to the proposed DSS,&rdquo; Communications of the ACM&nbsp;v.35 n.7 p.41-47., July&nbsp;1992.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AV1996">[AV1996]</a></td>
<td class="author-text">Anderson, R. and S. Vaudenay, &ldquo;Minding Your P's and Q's,&rdquo; Advances in Cryptology - ASIACRYPT '96
		     Proceedings&nbsp;Spinger Lecture Notes in
		     Computer Science (LNCS) volume 1163, 1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="BMM2000">[BMM2000]</a></td>
<td class="author-text">Biehl, I., Meyer, B., and V. Muller, &ldquo;Differential fault analysis on elliptic curve cryptosystems,&rdquo; Advances in Cryptology - CRYPTO 2000 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 1880, 2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="DSA1991">[DSA1991]</a></td>
<td class="author-text">&ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; Federal Register&nbsp;Vol. 56, August&nbsp;1991.</td></tr>
<tr><td class="author-text" valign="top"><a name="FIPS180-2">[FIPS180-2]</a></td>
<td class="author-text">&ldquo;SECURE HASH STANDARD,&rdquo; Federal Information Processing Standard (FIPS)&nbsp;180-2, August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="FIPS186">[FIPS186]</a></td>
<td class="author-text">&ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; Federal Information Processing Standard&nbsp;FIPS-186, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="K1981v3">[K1981v3]</a></td>
<td class="author-text">Knuth, D., &ldquo;The Art of Computer Programming, Vol. 3:
           Sorting and Searching,&rdquo; Addison Wesley&nbsp;, 1981.</td></tr>
<tr><td class="author-text" valign="top"><a name="KMOV1991">[KMOV1991]</a></td>
<td class="author-text">Koyama, K., Menezes, A., Vanstone, S., and T. Okamoto, &ldquo;New Public-Key Schemes Based on Elliptic Curves over the Ring Zn,&rdquo; Advances in Cryptology - CRYPTO '91 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 576, 1991.</td></tr>
<tr><td class="author-text" valign="top"><a name="KT1994">[KT1994]</a></td>
<td class="author-text">Koyama, K. and Y. Tsuruoka, &ldquo;Digital signature system based on elliptic curve
	     and signer device and verifier device for said system,&rdquo; Japanese Unexamined Patent Application
		     Publication&nbsp;H6-43809, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="LL1997">[LL1997]</a></td>
<td class="author-text">Lim, C. and P. Lee, &ldquo;A Key Recovery Attack on Discrete Log-based Schemes
	     Using a Prime Order Subgroup,&rdquo; Advances in Cryptology - CRYPTO '97 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 1294, 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="P1363">[P1363]</a></td>
<td class="author-text">&ldquo;Standard Specifications for Public Key Cryptography,&rdquo; Institute of Electric and Electronic Engineers (IEEE)&nbsp;P1363, 2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="P1978">[P1978]</a></td>
<td class="author-text">Pollard, J., &ldquo;Monte Carlo methods for index computation mod p,&rdquo; Mathematics of Computation&nbsp;Vol. 32, 1978.</td></tr>
<tr><td class="author-text" valign="top"><a name="PH1978">[PH1978]</a></td>
<td class="author-text">Polhig, S. and M. Hellman, &ldquo;An Improved Algorithm for Computing Logarithms over
	     GF(p) and its Cryptographic Significance,&rdquo; IEEE Transactions on Information Theory&nbsp;Vol 24, pp. 106-110, 1978.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2409">[RFC2409]</a></td>
<td class="author-text"><a href="mailto:dharkins@cisco.com">Harkins, D.</a> and <a href="mailto:carrel@ipsec.org">D. Carrel</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2409">The Internet Key Exchange (IKE)</a>,&rdquo; RFC&nbsp;2409, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2409.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2409.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2409.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2412">[RFC2412]</a></td>
<td class="author-text"><a href="mailto:ho@darpa.mil">Orman, H.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2412">The OAKLEY Key Determination Protocol</a>,&rdquo; RFC&nbsp;2412, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2412.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2412.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2412.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3979">[RFC3979]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc3979">Intellectual Property Rights in IETF Technology</a>,&rdquo; BCP&nbsp;79, RFC&nbsp;3979, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3979.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4753">[RFC4753]</a></td>
<td class="author-text">Fu, D. and J. Solinas, &ldquo;<a href="http://tools.ietf.org/html/rfc4753">ECP Groups For IKE and IKEv2</a>,&rdquo; RFC&nbsp;4753, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4753.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4879">[RFC4879]</a></td>
<td class="author-text">Narten, T., &ldquo;<a href="http://tools.ietf.org/html/rfc4879">Clarification of the Third Party Disclosure Procedure in RFC 3979</a>,&rdquo; BCP&nbsp;79, RFC&nbsp;4879, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4879.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="V1996">[V1996]</a></td>
<td class="author-text">Vaudenay, S., &ldquo;Hidden Collisions on DSS,&rdquo; Advances in Cryptology - CRYPTO '96
		     Proceedings&nbsp;Spinger Lecture Notes in
		     Computer Science (LNCS) volume 1109, 1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="VW1996">[VW1996]</a></td>
<td class="author-text">van Oorschot, P. and M. Wiener, &ldquo;On Diffie-Hellman key agreement with short exponents,&rdquo; Advances in Cryptology - EUROCRYPT '96 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 1070, 1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="X9.62">[X9.62]</a></td>
<td class="author-text">&ldquo;Public Key Cryptography for the Financial Services
                   Industry: The Elliptic Curve Digital Signature
                   Algorithm (ECDSA),&rdquo; American National Standards Institute (ANSI)&nbsp; X9.62.</td></tr>
</table>

<a name="rng"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Random Number Generation</h3>

<p>
It is easy to generate an integer uniformly at random between zero and
2^t, for some positive integer t.  Generate a random bit string that
contains exactly t bits, and then convert the bit string to a
non-negative integer by treating the bits as the coefficients in a
base-two expansion of an integer.

</p>
<p>
It is sometimes necessary to generate an integer r uniformly at random
so that r satisfies a certain property P, for example, lying within a
certain interval.  A simple way to do this is with the rejection
method:
</p>
<ol class="text">
<li>
Generate a candidate number c uniformly at random from a set that
includes many numbers that satisfy property P.

</li>
<li>
If c satisfies property P, then return c.  Otherwise, return to Step
1.

</li>
</ol><p> 
For example, to generate a number between 1 and n-1,
repeatedly generate integers between zero and 2^t, stopping at the
first integer that falls within that interval.

</p>
<a name="Example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Example Elliptic Curve Group</h3>

<p>
For concreteness, we recall an elliptic curve defined by Solinas and
Yu in <a class='info' href='#RFC4753'>[RFC4753]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;ECP Groups For IKE and IKEv2,&rdquo; January&nbsp;2007.</span><span>)</span></a> and referred to as P-256, which is
believed to provide a 128-bit security level.  We use the notation of 
<a class='info' href='#params'>Section&nbsp;3.2<span> (</span><span class='info'>Group Parameters</span><span>)</span></a>, and express the generator in the affine
coordinate representation g=(gx,gy), where the values gx and gy are 
in Zp.  

</p>
<p>
p: FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF

</p>
<p>
a: - 3

</p>
<p>
b: 5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B

</p>
<p>
n: FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551


</p>
<p>
gx: 6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296

</p>
<p>
gy: 4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5

</p>
<p>
Note that p can also be expressed as 
</p>
<blockquote class="text">
<p>
     p = 2^(256)-2^(224)+2^(192)+2^(96)-1.
   
</p>
</blockquote><p>

</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David A. McGrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">510 McCarthy Blvd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Milpitas, CA  95035</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">(408) 525 8651</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcgrew@cisco.com">mcgrew@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.mindspring.com/~dmcgrew/dam.htm">http://www.mindspring.com/~dmcgrew/dam.htm</a></td></tr>
</table>
</body></html>
