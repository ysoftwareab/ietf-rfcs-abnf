<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The OAuth 2.0 Authorization Framework: Claims</title>
<meta content="Travis Spencer" name="author">
<meta content="
       
                This document extends the OAuth 2.0 framework to include a
                simple query language that can be used by clients to request
                certain claims from an authorization server. This mechanism can
                be used during the authorization request and refresh request. It
                also defines a response parameter of the token and introspection
                endpoints that indicates to the caller which claims were
                authorized by the resource owner. Lastly, it stipulates how this
                request parameter can be used during token exchange, and how
                clients may request that certain claims be placed in an access
                token intended for a particular resource server.
       
    " name="description">
<meta content="xml2rfc 2.35.0" name="generator">
<meta content="RFC" name="keyword">
<meta content="Request for Comments" name="keyword">
<meta content="JSON" name="keyword">
<meta content="Claim" name="keyword">
<meta content="Assertion" name="keyword">
<meta content="OAuth" name="keyword">
<meta content="draft-spencer-oauth-claims-01" name="ietf.draft">
<link href="/tmp/draft-spencer-oauth-claims-01-3PMZ6Z.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .sourcecode {
    margin-bottom: 1em;
  }
}</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Claims</td>
<td class="right">November 2019</td>
</tr></thead>
<tfoot><tr>
<td class="left">Spencer</td>
<td class="center">Expires 26 May 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OAuth Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-spencer-oauth-claims-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2019-11-23" class="published">23 November 2019</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-05-26">26 May 2020</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Spencer</div>
<div class="org">Curity AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The OAuth 2.0 Authorization Framework: Claims</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
                This document extends the OAuth 2.0 framework to include a
                simple query language that can be used by clients to request
                certain claims from an authorization server. This mechanism can
                be used during the authorization request and refresh request. It
                also defines a response parameter of the token and introspection
                endpoints that indicates to the caller which claims were
                authorized by the resource owner. Lastly, it stipulates how this
                request parameter can be used during token exchange, and how
                clients may request that certain claims be placed in an access
                token intended for a particular resource server.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 26 May 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2019 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-claims-vis-a-vis-scope-toke" class="xref">Claims vis-a-vis Scope Tokens</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-notational-conventions" class="xref">Notational Conventions</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-protocol-flow" class="xref">Protocol Flow</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-authorization-request" class="xref">Authorization Request</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-refresh-request" class="xref">Refresh Request</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-token-introspection" class="xref">Token Introspection</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-token-exchange" class="xref">Token Exchange</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-claims-request-object" class="xref">Claims Request Object</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-requesting-particular-claim" class="xref">Requesting Particular Claim Names and Claim Values</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-critical-members-of-a-claim" class="xref">Critical Members of a Claims Request Object</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-special-claims-sinks" class="xref">Special Claims Sinks</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-obtaining-authorization" class="xref">Obtaining Authorization</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-authorization-code-grant" class="xref">Authorization Code Grant</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-authorization-request-2" class="xref">Authorization Request</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-error-response" class="xref">Error Response</a><a href="#section-toc.1-1.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-access-token-response" class="xref">Access Token Response</a><a href="#section-toc.1-1.4.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-implicit-flow" class="xref">Implicit Flow</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-authorization-request-3" class="xref">Authorization Request</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-access-token-response-2" class="xref">Access Token Response</a><a href="#section-toc.1-1.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-error-response-2" class="xref">Error Response</a><a href="#section-toc.1-1.4.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-resource-owner-password-cre" class="xref">Resource Owner Password Credentials Grant</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-access-token-request" class="xref">Access Token Request</a><a href="#section-toc.1-1.4.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-access-token-response-3" class="xref">Access Token Response</a><a href="#section-toc.1-1.4.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-client-credentials-grant" class="xref">Client Credentials Grant</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.  <a href="#name-access-token-request-2" class="xref">Access Token Request</a><a href="#section-toc.1-1.4.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.  <a href="#name-access-token-response-4" class="xref">Access Token Response</a><a href="#section-toc.1-1.4.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-token-refresh" class="xref">Token Refresh</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-token-refresh-request" class="xref">Token Refresh Request</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-access-refresh-response" class="xref">Access Refresh Response</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-token-exchange-2" class="xref">Token Exchange</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-token-introspection-2" class="xref">Token Introspection</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-requesting-claims-for-a-par" class="xref">Requesting Claims for a Particular Protected Resource</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-authorization-server-metada" class="xref">Authorization Server Metadata</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-document-history" class="xref">Document History</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
                As stated in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-1.4" class="relref">Section 1.4</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>, an
                access token represents the specific scope and duration of
                access. The requested scope is verified by the authorization server
                according to its policy, and the perhaps-different scope
                is granted by the resource owner. The requested and granted
                scope may vary due to the authorization server's policy and/or
                the resource owner's limitation of the granted scope. The
                resulting scope is enforced by the resource server. The way in
                which the client indicates the intended scope of access is by
                the <code>scope</code> request parameter defined
                in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>. This specification
                defines a more sophisticated instrument to achieve this same
                purpose.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
                At times, this existing mechanism is too limited. In some uses
                cases, for example, a client may need to request particular
                claims from an authorization server. It may also do this to
                request specific claim values. Furthermore, a client may need
                to indicate to the authorization server that certain claims are
                essential for its ability to operate. In such cases, the grant
                is of little use to the client if the resource owner does not
                comply. Another example of when the existing
                <code>scope</code> parameter is insufficient is
                when the client knows that some claim is required by a
                particular resource server. The extent of a client's knowledge
                is usually limited to knowing that a claim is needed in an
                access token; however, in some cases, it may also know that a
                claim should be restricted to access tokens issued to a
                particular resource server. In these situations, the existing
                mechanism for stipulating the scope of access is insufficient.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
                To accommodate these use cases and requirements, this
                specification defines a new request parameter that can be used
                when the client obtains an authorization grant, as described in
                <span><a href="https://rfc-editor.org/rfc/rfc6749#section-1.3" class="relref">Section 1.3</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span> and
                <span><a href="https://tools.ietf.org/html/draft-ietf-oauth-token-exchange-19#section-2.1" class="relref">Section 2.1</a> of [<a href="#I-D.ietf-oauth-token-exchange" class="xref">I-D.ietf-oauth-token-exchange</a>]</span>. For each request
                wherein these fix grant types -- authorization code, implicit,
                resource owner password credentials, client credentials, and
                token exchange -- are sought, this specification defines a new
                parameter called <code>claims</code>. It can be
                used by a client with any of these to request that certain
                claims and/or particular claim values be authorized by the
                resource owner. The value of this parameter is a
                JavaScript Object Notation (JSON) object <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span>. This can also be used to indicate to the authorization server
                that the client considers some or all of the claims to be
                required. The client can also use this object to indicate that
                certain claim values are preferred or essential to its ability
                to operate on behalf of the resource owner.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
                During a refresh request (as described in
                <span><a href="https://rfc-editor.org/rfc/rfc6749#section-1.5" class="relref">Section 1.5</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>), the <code>claims</code>
                parameter defined herein can also be used to alter the resulting
                scope of access. This can be used, for example, to lessen the
                scope by including a certain subset of claims that should be in
                the new access token. After such, a client may increase the
                scope in a subsequent refresh request by including additional
                claim names in the JSON object value of the <code>
                claims</code> authorization request parameter. When it does so,
                the client cannot, however, expand the scope from that which was
                initially authorized by the resource owner.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
                This specification also stipulates how the authorized claim
                names are returned from an authorization request and the result
                of introspecting a token.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">
                This specification is designed to be compatible with OpenID
                Connect <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span> but does not require the
                authorization server to support that protocol.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="claims-vis-a-vis-scope-tokens">
<section id="section-1.1">
        <h3 id="name-claims-vis-a-vis-scope-toke">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-claims-vis-a-vis-scope-toke" class="section-name selfRef">Claims vis-a-vis Scope Tokens</a>
        </h3>
<p id="section-1.1-1">
                    As previously stated, claims relate to scope tokens. How
                    exactly is beyond the extent of this specification. Instead,
                    this document provides a framework in which these two
                    constructs can be used together or independently. That said,
                    however, there are at least three common ways that claims
                    will be used:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-1.1-2">
          <li id="section-1.1-2.1">Not at all (in which case this specification is
                        irrelevant).<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-1.1-2.2">In lieu of scope tokens.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-1.1-2.3">Together with scope tokens.<a href="#section-1.1-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-1.1-3">
                    The first and second option are straightforward. The third,
                    however, will require a specification to define the
                    relation between the two in order to achieve
                    interoperability. For instance, <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>
                    relates claims to scope tokens by grouping
                    certain claims into various scope tokens. This grouping of
                    claims into various scope tokens is RECOMMENDED when
                    simultaneously using claims and scope tokens to request
                    authorization.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notational-conventions">
<section id="section-1.2">
        <h3 id="name-notational-conventions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-1.2-1">
                    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
                    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
                    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
                    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
                    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
                    interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
                    shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">
                    Unless otherwise noted, all the protocol parameter names and
                    values are case sensitive.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.3">
        <h3 id="name-terminology">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.3-1">
                    This specification uses the terms "Access Token",
                    "Authorization Code", "Authorization Endpoint",
                    "Authorization Grant", "Authorization Server", "Client",
                    "Grant Type", "Redirection URI",
                    "Refresh Token", "Resource Owner", "Resource Server",
                    and "Token Endpoint" defined by <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>;
                    "Claim", "Claim Name", and "Claim Value" defined by
                    <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>; and the following defined herein:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-1.3-2">
          <dt id="section-1.3-2.1">Claims Sink</dt>
          <dd style="margin-left: 4.0em" id="section-1.3-2.2">
                        The location or destination where the authorization server
                        MAY include all requested claims that are
                        authorized by the resource owner. An access token
                        intended for an unspecified resource server or an
                        access token the client intends to send to a
                        particular resource server or an ID token (when the
                        OpenID Connect profile of this specification is
                        used) are examples of claims sinks.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-1.3-2.3">Claims Request Object</dt>
          <dd style="margin-left: 4.0em" id="section-1.3-2.4">
                        Has the meaning ascribed to it in <a href="#claims-request-object" class="xref">Section 3</a>.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-1.3-2.5">Claims Sink Query Object</dt>
          <dd style="margin-left: 4.0em" id="section-1.3-2.6">
                        Has the meaning ascribed to it in <a href="#requesting-particular-claim-names-and-claim-values" class="xref">Section 3.1</a>.<a href="#section-1.3-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-1.3-2.7">Claim Value Query Object</dt>
          <dd style="margin-left: 4.0em" id="section-1.3-2.8">
                        Has the meaning ascribed to it in <a href="#requesting-particular-claim-names-and-claim-values" class="xref">Section 3.1</a>.<a href="#section-1.3-2.8" class="pilcrow">¶</a>
</dd>
<dt id="section-1.3-2.9">Critical Claim</dt>
          <dd style="margin-left: 4.0em" id="section-1.3-2.10">
                        Has the meaning ascribed to it in <a href="#critical-members-of-a-claims-request-object" class="xref">Section 3.2</a>.<a href="#section-1.3-2.10" class="pilcrow">¶</a>
</dd>
<dt id="section-1.3-2.11">Essential Claim</dt>
          <dd style="margin-left: 4.0em" id="section-1.3-2.12">
                        A claim specified by the client as being necessary
                        to ensure a smooth authorization experience for a
                        specific task requested by the resource owner.<a href="#section-1.3-2.12" class="pilcrow">¶</a>
</dd>
<dt id="section-1.3-2.13">Scope Token</dt>
          <dd style="margin-left: 4.0em" id="section-1.3-2.14">
                        A case-sensitive string joined by spaces together
                        with other such strings and included in the the
                        <code>scope</code> request parameter
                        of an authorization request (i.e., a
                        <code>scope-token</code> as set
                        forth in the ABNF of
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>).<a href="#section-1.3-2.14" class="pilcrow">¶</a>
</dd>
<dt id="section-1.3-2.15">Voluntary Claim</dt>
          <dd style="margin-left: 4.0em" id="section-1.3-2.16">
                        A claim specified by the client as being useful but
                        not essential for the specific task requested by
                        the resource owner.<a href="#section-1.3-2.16" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="protocol-flow">
<section id="section-2">
      <h2 id="name-protocol-flow">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol Flow</a>
      </h2>
<div id="authorization-request">
<section id="section-2.1">
        <h3 id="name-authorization-request">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-2.1-1">
                   When a client requests authorization from the resource owner
                   indirectly via the authorization server, the protocol flow
                   MAY include a query for certain claims. Based on the policy
                   of the authorization server and the delegated access of the
                   resource owner, certain claims MAY be granted. Given an
                   authorization grant, the authorization server informs the
                   client as to which claims were actually issued (if different
                   from those requested). This message exchange pattern is
                   shown in
                   <a href="#authorization-request-protocol-flow" class="xref">Figure 1</a>:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-protocol-flow-that-includes"></span><div id="authorization-request-protocol-flow">
<figure id="figure-1">
          <div class="artwork art-text alignLeft art-ascii-art" id="section-2.1-2.1">
<pre>
+--------+                               +---------------+
| Client |--(A)- Authorization request -&gt;| Authorization |
|        |     including claims request  |    Server     |
|        |              parameter        |               |
|        |                               |               |
|        |&lt;-(B)-- Authorization grant ---|               |
|        |                               |               |
|        |--(C)-- Authorization grant --&gt;|               |
|        |                               |               |
|        |&lt;-(D)-Access token including --|               |
+--------+       granted claim names     +---------------+

                    </pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-protocol-flow-that-includes" class="selfRef">Protocol Flow that Includes Requested and                     Granted Claims</a>
          </figcaption></figure>
</div>
<p id="section-2.1-3">
                    The steps in the flow illustrated in Figure 1 are generally
                    the same as those described in
                    <span><a href="https://rfc-editor.org/rfc/rfc6749#section-1.2" class="relref">Section 1.2</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span> with a few important distinctions:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-4.1">
                        During the authorization request (A), the client
                        includes a claims request object as the
                        corresponding value of the
                        <code>claims</code> request
                        parameter, as described in <a href="#requesting-particular-claim-names-and-claim-values" class="xref">Section 3.1</a> below.<a href="#section-2.1-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-4.2">After obtaining (B) and presenting the authorization
                        grant (C), the response MAY include an access token
                        and a possibly-empty list of claim names that were
                        authorized (D). If the asserted claims embodied by
                        the access token differ from those requested (A),
                        then the authorization server MUST include a list
                        of authorized claim names in the authorization
                        response (D).<a href="#section-2.1-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="refresh-request">
<section id="section-2.2">
        <h3 id="name-refresh-request">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-refresh-request" class="section-name selfRef">Refresh Request</a>
        </h3>
<p id="section-2.2-1">
                    As described in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-1.5" class="relref">Section 1.5</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span> and
                    further explained in section 6 thereof, a client that was
                    issued a refresh token MAY use this to narrow the scope of
                    access for an access token. It does this by sending the
                    <code>scope</code> request parameter in step
                    (G) of Figure 2 of <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>. At times, the
                    client might want to be more explicit about which claims
                    should be included in the refreshed access token or about
                    where those claims should be asserted.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">
                    To address this need, this document defines an additional
                    input parameter that the client may send to the
                    authorization server when it presents a refresh token to
                    the token endpoint. This update to the flow wherein a client
                    refreshes an access token to narrow the scope of access to
                    a particular set of claims is shown in
                    <a href="#refresh-token-flow" class="xref">Figure 2</a>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<span id="name-narrowing-the-scope-of-acce"></span><div id="refresh-token-flow">
<figure id="figure-2">
          <div class="artwork art-text alignLeft art-ascii-art" id="section-2.2-3.1">
<pre>
+--------+                               +---------------+
| Client |--(A)----- Refresh token -----&gt;| Authorization |
|        |     including claims request  |    Server     |
|        |              parameter        |               |
|        |                               |               |
|        |&lt;-(B)------ Access token ------|               |
|        | including granted claim names |               |
+--------+     &amp; optional refresh token  +---------------+

                    </pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-narrowing-the-scope-of-acce" class="selfRef">Narrowing the Scope of Access to a                     Particular Set of Claims</a>
          </figcaption></figure>
</div>
<p id="section-2.2-4">
                    Downscoping in this flow is achieved when the client
                    requests a subset of the claims authorized by the resource owner.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">
                    The client MAY request to change the claims sink where the
                    authorized claims should be asserted using this flow. If the
                    client does so, it is RECOMMENDED that the authorization server
                    accept this change baring any policy to the contrary.
                    The client MAY also send a claim value in the claim value
                    query object(s) of the request. When it does, the
                    authorization server SHOULD consider this request when
                    asserting the claim but it MAY return an error if asserting
                    a different claim value is against its policy or exceeds the
                    authorization granted by the resource owner. If it is a
                    critical claim, the requested claim value MUST be asserted
                    or an error MUST result if the authorization server supports
                    critical claims.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">
                    There are many corner cases that can arise when implementing
                    this flow. Most stem from policy and configuration changes
                    of the authorization server which may happen between the
                    time an access token is issued and it is refreshed. Other
                    complications arise when claims are used together with scope
                    tokens. Both are beyond the scope of this specification and
                    not addressed by this memo.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-introspection-response">
<section id="section-2.3">
        <h3 id="name-token-introspection">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-token-introspection" class="section-name selfRef">Token Introspection</a>
        </h3>
<p id="section-2.3-1">
                    <span>[<a href="#RFC7662" class="xref">RFC7662</a>]</span> stipulates that the introspection
                    endpoint of an authorization server must return a JSON
                    <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span> document representing the meta
                    information surrounding the token, including its scope. This
                    specification extends that object to include the claim names
                    that the resource owner authorized the client for. This
                    request/response interaction pattern is shown in
                    <a href="#introspection-flow" class="xref">Figure 3</a>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<span id="name-introspecting-an-access-tok"></span><div id="introspection-flow">
<figure id="figure-3">
          <div class="artwork art-text alignLeft art-ascii-art" id="section-2.3-2.1">
<pre>
+--------+                               +---------------+
| Client |--(A)----- Access token -----&gt; | Authorization |
|        | send to introspection endpoint|    Server     |
|        |                               |               |
|        |                               |               |
|        |&lt;-(B)------ JSON object -------|               |
|        |    including granted claim    |               |
+--------+             names             +---------------+

                    </pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-introspecting-an-access-tok" class="selfRef">Introspecting an Access Token and Obtaining Granted Claims</a>
          </figcaption></figure>
</div>
<p id="section-2.3-3">
                    Using this flow, a client will be informed about the
                    authorized claim names in the same way it is informed about
                    the scope of access by way of the
                    <code>scope</code> response member.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-exchange">
<section id="section-2.4">
        <h3 id="name-token-exchange">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-token-exchange" class="section-name selfRef">Token Exchange</a>
        </h3>
<p id="section-2.4-1">TBD<a href="#section-2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="claims-request-object">
<section id="section-3">
      <h2 id="name-claims-request-object">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-claims-request-object" class="section-name selfRef">Claims Request Object</a>
      </h2>
<p id="section-3-1">
                The <code>claims</code> request parameter value
                is a UTF-8 encoded JSON object ("Claims Request Object")
                specifying requested claims. Prior to transmission to the
                authorization server it is also form-URL-encoded as appropriate.
                The claims request object is not intended to be a mechanism that
                the client may use to instruct the authorization server to
                assert specific claims. Instead, it is a simple query language
                that a client can use to request certain claims or to specify
                that it would like the authorization server to obtain
                authorization from the resource owner for a claim, perhaps with
                a particular claim value. The claims request object provides a
                client with a more structured method of requesting the scope of
                access that the resource owner authorizes it for.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
                The top-level members of the claims request object SHOULD
                include at least one claims sink. The only specific claims sinks
                defined by this specification are
                <code>access_token</code>,
                <code>*</code>, and
                <code>?</code>. Additionally,
                this specification also sets forth a mechanism by which a client
                may signal to the authorization server which claims it prefers
                to be included in an access token that it intends to be furnished to
                a particular resource server; this is done by using an absolute
                URI of the target service or resource as a claims sink. A claims
                request object MAY also contain the member
                <code>crit</code> to indicate parts of the
                claims request object that the authorization server MUST
                understand if the <code>crit</code> member
                itself is understood. Other members of a claims request object
                MAY be present; any that are not understood by the authorization server
                MUST be ignored.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
                An example of a claims request object that is sent to the
                authorization server as the value of the
                <code>claims</code> request parameter provided during an
                authorization request, refresh request or token exchange
                request is shown in
                <a href="#example-claims-request-object" class="xref">Figure 4</a>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<span id="name-example-of-a-claims-request"></span><div id="example-claims-request-object">
<figure id="figure-4">
        <div class="artwork art-text alignLeft" id="section-3-4.1">
<pre>
                        
{
    "access_token" : {

    }
}
                </pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-a-claims-request" class="selfRef">Example of a Claims Request Object</a>
        </figcaption></figure>
</div>
<p id="section-3-5">
                In this non-normative example, the
                <code>access_token</code> member is the
                claims sink. It is the location where the authorization server
                MAY include any of the requested claims that the resource owner
                authorizes. If the authorization server uses the requested
                claims from a particular claims sink to derive or determine
                alternative claims which it asserts, it is RECOMMENDED to
                consider the client's request to include those alternative
                claims in the same requested claims sink.<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="requesting-particular-claim-names-and-claim-values">
<section id="section-3.1">
        <h3 id="name-requesting-particular-claim">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-requesting-particular-claim" class="section-name selfRef">Requesting Particular Claim Names and Claim Values</a>
        </h3>
<p id="section-3.1-1">
                    Within the claims request object, a claims sink is
                    associated with another JSON object ("Claims Sink Query
                    Object"). This object contains properties that have the name
                    of a claim which the client is requesting the authorization server
                    to assert. The possible values associated with each
                    of these is <code>null</code> or another
                    JSON object ("Claim Value Query Object").<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
                    When the value is <code>null</code>, it
                    indicates that the claim with the associated claim name is a
                    voluntary claim, and the client has no specific requirements
                    on the claim value. Conversely, when the claim value query
                    object is not <code>null</code> it is a
                    JSON object with the following properties:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-3.1-3">
          <dt id="section-3.1-3.1">essential</dt>
          <dd style="margin-left: 4.0em" id="section-3.1-3.2">
                        OPTIONAL. Indicates whether the claim being
                        requested is an essential claim. If the value is
                        <code>true</code>, this indicates
                        that the claim is an essential claim. If the value
                        is <code>false</code> or if this
                        property is not include, then the claim is a
                        voluntary claim.<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</dd>
<dt id="section-3.1-3.3">value</dt>
          <dd style="margin-left: 4.0em" id="section-3.1-3.4">
                        OPTIONAL. Requests that the claim be returned with
                        a particular value.<a href="#section-3.1-3.4" class="pilcrow">¶</a>
</dd>
<dt id="section-3.1-3.5">values</dt>
          <dd style="margin-left: 4.0em" id="section-3.1-3.6">
                        OPTIONAL. Requests that the claim be returned with
                        one of a set of values, with the values appearing
                        in order of preference.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-3.1-4">
                    The properties <code>value</code> and
                    <code>values</code> are mutually exclusive.
                    If the client sends a claim value query object with both,
                    the authorization server MUST return an error as described
                    in <a href="#obtaining-authorization" class="xref">Section 4</a> below.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">
                    By requesting essential claims, the client indicates to the
                    authorization server (who indicates to the resource owner)
                    that releasing these claims will ensure a smooth
                    authorization for the specific task requested by that
                    resource owner. If the claims are not available because the
                    resource owner did not authorize their release or they are
                    not present, the authorization server MUST NOT generate an
                    error when claims are not returned.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">
                    Other members of the claim value query object MAY be defined
                    to provide additional information about the requested
                    claims. Any members of the claims value query object that are
                    not understood by the authorization server MUST be ignored.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">
                    A non-normative example of the two possible types of values
                    for a claim value query object is shown in
                    <a href="#example-claim-value-query-object" class="xref">Figure 5</a>.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<span id="name-example-of-a-claim-value-qu"></span><div id="example-claim-value-query-object">
<figure id="figure-5">
          <div class="artwork art-text alignLeft" id="section-3.1-8.1">
<pre>
                            
{
    "access_token" : {
        "https://example.com/claim1" : null,
        "fname" : {
            "value" : "John"
        }
    }
}
                    </pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-a-claim-value-qu" class="selfRef">Example of a Claim Value Query Object</a>
          </figcaption></figure>
</div>
<p id="section-3.1-9">
                    In this example, there are two claim names which the client
                    is requesting
                    <code>https://example.com/claim1</code> and
                    <code>fname</code>. The values associated
                    with these are claim value query objects. The former is a
                    simple query where the client has no preference on a
                    particular value. For this reason, the client specifies the
                    value <code>null</code>. In the later case,
                    the client has more precise needs: it desires the
                    authorization server to assert a claim value of
                    <code>John</code> for the claim name
                    <code>fname</code>. In such situations the
                    authorization server MAY issue a claim with the claim name
                    <code>fname</code> but with some other claim
                    value than <code>John</code>. Both are
                    voluntary claims.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.1-10">
                    An example of an essential claim is shown in the
                    non-normative listing of
                    <a href="#example-essential-claim-value-query" class="xref">Figure 6</a>.<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<span id="name-example-of-querying-for-an-"></span><div id="example-essential-claim-value-query">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-3.1-11.1">
<pre>
                            
{
    "access_token" : {
        "consentId" : {
            "essential" : true
        }
    }
}
                    </pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-of-querying-for-an-" class="selfRef">Example of querying for an Essential Claim</a>
          </figcaption></figure>
</div>
<p id="section-3.1-12">
                    This query indicates that the client would like the
                    authorization server to issue an access token with a scope
                    that includes a claim with the claim name
                    <code>consentId</code>. To ensure a smooth
                    authorization experience at the resource server where the
                    client will present the resulting access token, the client
                    has indicated that the <code>consentId</code>
                    claim is required, making it an essential claim.<a href="#section-3.1-12" class="pilcrow">¶</a></p>
<p id="section-3.1-13">
                    As described above, a client may also indicate that it
                    wishes the authorization server to assert a claim having a
                    claim value that the client has some preference for. A
                    non-normative example of such a query is show in
                    <a href="#example-essential-claim-value-with-certain-value" class="xref">Figure 7</a>.<a href="#section-3.1-13" class="pilcrow">¶</a></p>
<span id="name-example-of-querying-for-an-e"></span><div id="example-essential-claim-value-with-certain-value">
<figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-3.1-14.1">
<pre>
                            
{
    "access_token" : {
        "accountId" : {
            "values" : ["act-123", "act-456"],
            "essential" : true
        },
        "paymentId" : {
            "value" : "pid-123456",
            "essential" : true
        }
    }
}
                    </pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-example-of-querying-for-an-e" class="selfRef">Example of querying for an Essential Claim with Certain Values</a>
          </figcaption></figure>
</div>
<p id="section-3.1-15">
                    In this example, the client is requesting that the
                    authorization server assert two essential claims: one named
                    <code>accountId</code> and another named
                    <code>paymentId</code>. In the former case,
                    the client requests that the claim value be
                    <code>act-123</code> or
                    <code>act-456</code>. In the later case, a
                    claim named <code>paymentId</code> is
                    requested by the client to have a claim value of
                    <code>pid-123456</code>. Again, the
                    authorization server MUST NOT return an error if the
                    resource owner does not authorize both of these claims or
                    if they are non-existent. This is merely a request for a
                    certain scope of access.<a href="#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16">
                    Another example inspired by the Revised Directive on
                    Payment Services (PSD2) is shown in the
                    non-normative listing of <a href="#psd2-example" class="xref">Figure 8</a>.<a href="#section-3.1-16" class="pilcrow">¶</a></p>
<span id="name-psd2-related-example"></span><div id="psd2-example">
<figure id="figure-8">
          <div class="artwork art-text alignLeft" id="section-3.1-17.1">
<pre>
                            
{
    "access_token" : {
        "instructedAmount" : {
            "value" : {
                "amount" : 123.50,
                "currency" : "EUR"
            },
            "essential" : true
        },
        "debtorAccount/iban" : {
            "value" : "DE40100100103307118608",
            "essential" : true
        },
        "creditorName" : {
            "value" : "Merchant123",
            "essential" : true
        },
        "creditorAccount/iban" : {
            "value" : "DE02100100109307118603",
            "essential" : true
        },
        "remittanceInformationUnstructured" : {
            "value" : "Ref Number Merchant",
            "essential" : true
        }
    }
}
                    </pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-psd2-related-example" class="selfRef">PSD2-related Example</a>
          </figcaption></figure>
</div>
<p id="section-3.1-18">
                    In this example, the client is requesting (but not forcing)
                    the authorization server to obtain authorization from the
                    resource owner for five essential claims:
                    <code>instructedAmount</code>,
                    <code>debtorAccount/iban</code>,
                    <code>creditorName</code>,
                    <code>creditorAccount/iban</code>, and
                    <code>remittanceInformationUnstructured</code>.
                    The claim value query object associated with each of these
                    claim names has a particular value the client strongly
                    prefers. One interesting case is the value of the
                    <code>instructedAmount</code> essential
                    claim; the query for the value of this claim is a JSON
                    object with two properties. The authorization server might
                    use this claims request object to obtain the resource owner's
                    consent before granting them, for instance. It
                    might also check these values against a data source before
                    asserting them. Based on the resource owner's choice or the
                    data source lookup results, the authorization server may
                    not issue the claims at all or may do so with some other
                    value. For example, the authorization server may actually
                    find that the <code>instructedAmount</code>
                    value requested exceeds its policy's allowed limit and only
                    prompt the resource owner to authorize 100 Euro.<a href="#section-3.1-18" class="pilcrow">¶</a></p>
<p id="section-3.1-19">
                    
                    Another interesting example of how structured scope of
                    access can be requested is shown in the listing of
                    <a href="#esi-example" class="xref">Figure 9</a>.<a href="#section-3.1-19" class="pilcrow">¶</a></p>
<span id="name-esi-related-example"></span><div id="esi-example">
<figure id="figure-9">
          <div class="artwork art-text alignLeft" id="section-3.1-20.1">
<pre>
                            
{
    "access_token" : {
        "credentialID" : {
            "value" : "qes_eidas",
            "essential" : true
        },
        "documentDigests" : {
            "value" : {
                "hash":"sTOgwOm+474gFj0q0x1iSNspKqbcse4IeiqlDg/HW=",
                "label":"Mobile Subscription Contract"
            },
            "essential" : true
        },
        "hashAlgorithmOID" : {
            "value" : "2.16.840.1.101.3.4.2.1"
        }
    }
}
                    </pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-esi-related-example" class="selfRef">ESI-related Example</a>
          </figcaption></figure>
</div>
<p id="section-3.1-21">
                    This example shows how a client may request claims defined
                    by the Electronic Signatures and Infrastructures (ESI)
                    Protocols for remote digital signature creation. Like the
                    previous example, the claims request object for the
                    <code>access_token</code> claims sink
                    includes a claim value query object for the
                    <code>documentDigests</code> claim that
                    includes a JSON object with multiple properties.<a href="#section-3.1-21" class="pilcrow">¶</a></p>
<p id="section-3.1-22">
                    These illustrative examples hopefully impress upon the
                    reader the versatility of this query language and the
                    authorization server's prerogative to assert any claims with
                    any claim values it chooses in its sole discretion. If the
                    client's needs are stronger than preferential, it MAY use
                    the <code>crit</code> member of the
                    claims request object which the authorization server MAY
                    understand.<a href="#section-3.1-22" class="pilcrow">¶</a></p>
</section>
</div>
<div id="critical-members-of-a-claims-request-object">
<section id="section-3.2">
        <h3 id="name-critical-members-of-a-claim">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-critical-members-of-a-claim" class="section-name selfRef">Critical Members of a Claims Request Object</a>
        </h3>
<p id="section-3.2-1">
                    As described previously, the client can indicate to the
                    authorization server that certain claims are preferential or
                    essential to the smooth operation of the client. At times,
                    however, the client's needs are stronger and require certain
                    claims to be asserted. In such situations, the client would
                    rather the authorization server return an error than grant
                    access with different claims than those requested. This is
                    not always possible for an authorization server, however,
                    and a client MUST NOT assume that the authorization server
                    can be controlled in this manner. To know if this
                    interaction pattern in supported, the client must have a
                    priori knowledge gained by some means not defined by this
                    specification or by the presence of a <code>
                    true</code> value in the authorization server's
                    <code>critical_claims_supported</code>
                    metadata (see section
                    <a href="#authorization-server-metadata" class="xref">Section 9</a> below). An
                    authorization server is RECOMMENDED to support this
                    capability unless it cannot. When it does, the authorization server
                    MUST issue any claim denoted as critical or it MUST
                    return an error. The error must be
                    <code>invalid_claims</code> as described below
                    in <a href="#obtaining-authorization" class="xref">Section 4</a>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
                    A client indicates to the authorization server that it must
                    understand certain claims and be able to assert them by
                    including a list of JSON Pointers
                    <span>[<a href="#RFC6901" class="xref">RFC6901</a>]</span>
                    associated with the <code>crit</code> member
                    of the claims request object. Each such claim that the
                    elements of this list point to is a "Critical Claim". The
                    JSON Pointers in this list MUST refer to members of the
                    claims request object and MUST NOT point to elements within
                    the list itself. If any JSON Pointer refers to an element of
                    the JSON Pointer list, the authorization server MUST return
                    an error with a code of
                    <code>invalid_request</code> if it supports
                    critical claims. When the JSON Pointers are valid, if the
                    authorization server does not understand any of the claims
                    pointed to by any of the elements of this list, the
                    authorization server MUST return an error of
                    <code>invalid_claims</code>. Likewise, if
                    the authorization server is unable to assert a critical
                    claim (and it supports critical claims), it MUST return the
                    same error. If a critical claim is requested with a certain
                    value (as in the following example), the authorization server
                    MUST assert the claim with that exact claim value. If
                    it's not able to (e.g., because the resource owner does not
                    have an attribute with that particular value), the
                    authorization server MUST return an error with a code of
                    <code>invalid_claims</code> unless it does
                    not support critical claims.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">
                    A non-normative example of a claims request object with a
                    critical claim is shown in
                    <a href="#crit-claim-example" class="xref">Figure 10</a>.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<span id="name-example-of-a-request-contai"></span><div id="crit-claim-example">
<figure id="figure-10">
          <div class="artwork art-text alignLeft" id="section-3.2-4.1">
<pre>
                            
{
    "crit" : [
 "/access_token/verified_claims/verification/trust_framework/value"
    ],
    "access_token" : {
        "verified_claims" : {
            "verification" : {
                "trust_framework" : {
                    "value" : "de_aml"
                }
            }
        }
    }
}
                    </pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-example-of-a-request-contai" class="selfRef">Example of a Request Containing a Critical Claim</a>
          </figcaption></figure>
</div>
<p id="section-3.2-5">
                    In this example, the
                    <code>value</code> member of the
                    JSON object associated with
                    <code>trust_framework</code> must be
                    understood by the authorization server because it is
                    pointed by the element of the critical claims list. The way
                    in which the authorization server understands this
                    particular query is beyond the scope of this specification.
                    The only part of this example that is germane is the
                    <code>crit</code> member of the claims
                    request object which requires the authorization server to
                    understand and assert a particular claim value (provided it
                    understands the <code>crit</code> itself).
                    If it cannot and if it supports critical claims, it must
                    return an error.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">
                    It is not uncommon for a claim name to defined as a URI
                    containing slashes (<code>/</code>, %x2F). When such a claim is
                    critical, the escaping described in
                    <span><a href="https://rfc-editor.org/rfc/rfc6901#section-3" class="relref">Section 3</a> of [<a href="#RFC6901" class="xref">RFC6901</a>]</span> MUST be used, as in the
                    non-normative listing of
                    <a href="#escaped-critical-claim-example" class="xref">Figure 11</a>.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<span id="name-example-of-escaping-the-jso"></span><div id="escaped-critical-claim-example">
<figure id="figure-11">
          <div class="artwork art-text alignLeft" id="section-3.2-7.1">
<pre>
                            
{
    "crit" : ["/access_token/https:~1~1example.com~1claim1"],
    "access_token" : {
        "https://example.com/claim1" : null,
    }
}
                    </pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-example-of-escaping-the-jso" class="selfRef">Example of Escaping the JSON Pointer used to Refer to a Critical Claim with a Name Containing Slashes</a>
          </figcaption></figure>
</div>
</section>
</div>
<section id="section-3.3">
        <h3 id="name-special-claims-sinks">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-special-claims-sinks" class="section-name selfRef">Special Claims Sinks</a>
        </h3>
<p id="section-3.3-1">
                    A client may know that it needs a particular claim; however,
                    it may not be aware which claims sink the claim should be
                    included in. The client may prefer to leave this determination
                    to the authorization server. In such cases, the client MAY
                    use the claims sink <code>?</code> (%x3F) as
                    mentioned in <a href="#claims-request-object" class="xref">Section 3</a>
                    above. This special claim sink may result in the claim being
                    issued in the access token or any other claims sink that the
                    authorization server deems appropriate. A non-normative
                    example of a claims request object indicating that a
                    particular claim be asserted in any claims sink is shown in
                    <a href="#example-any-claims-sink" class="xref">Figure 12</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span id="name-example-requesting-a-claim-"></span><div id="example-any-claims-sink">
<figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-3.3-2.1">
<pre>
                            
{
    "?" : {
        "https://example.com/claim1" : null,
    }
}
                    </pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-example-requesting-a-claim-" class="selfRef">Example Requesting a Claim to be Asserted in Any Claims Sink</a>
          </figcaption></figure>
</div>
<p id="section-3.3-3">
                    Similarly, there are situations where the client wishes
                    claims to be asserted in all claims sinks the authorization server
                    supports. Rather than requiring the the client to
                    repeat its requirement for each claims sink, it MAY use the
                    special claims sink <code>*</code> (%x2A).
                    This claims sink indicates to the authorization server that
                    the client prefers all claims included in the claims request
                    object to be asserted in each claim sink that the
                    authorization server supports. The two claims request
                    objects shown in Figure
                    <a href="#example-all-claims-sink" class="xref">Figure 13</a> and
                    <a href="#example-comparable-to-all-claims-sink" class="xref">Figure 14</a>
                    are equivalent (if the authorization server only supports
                    the two claims sinks shown in the latter).<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<span id="name-example-requesting-a-claim-t"></span><div id="example-all-claims-sink">
<figure id="figure-13">
          <div class="artwork art-text alignLeft" id="section-3.3-4.1">
<pre>
                            
{
    "*" : {
        "https://exmaple.com/claim1" : null,
    }
}
                        </pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-example-requesting-a-claim-t" class="selfRef">Example Requesting a Claim to be Asserted in All Claims Sinks</a>
          </figcaption></figure>
</div>
<span id="name-equivalent-example-of-reque"></span><div id="example-comparable-to-all-claims-sink">
<figure id="figure-14">
          <div class="artwork art-text alignLeft" id="section-3.3-5.1">
<pre>
                            
{
    "access_token" : {
        "https://exmaple.com/claim1" : null,
    },
    "my-good-claims-sink" : {
        "https://exmaple.com/claim1" : null,
    }
}
                    </pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-equivalent-example-of-reque" class="selfRef">Equivalent Example of Requesting a Claim to be Asserted in All Claims Sinks</a>
          </figcaption></figure>
</div>
<p id="section-3.3-6">
                    The use of either the claims sink
                    <code>?</code> and
                    <code>*</code> with any other claims sink
                    in the same claims request object is undefined. The
                    authorization server SHOULD return an error or apply some other
                    logic not defined by this specification. The client SHOULD
                    NOT make such queries unless it has some knowledge gained a
                    priori about the authorization server's support of such a
                    query.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="obtaining-authorization">
<section id="section-4">
      <h2 id="name-obtaining-authorization">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-obtaining-authorization" class="section-name selfRef">Obtaining Authorization</a>
      </h2>
<p id="section-4-1">
                As stated in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4" class="relref">Section 4</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>, a request
                for an access token requires the client to obtain authorization
                from the resource owner. As described there, this
                can be done using various grant types. To make a request for
                certain claims, the <code>claims</code> request
                parameter defined herein is used when requesting an
                authorization code, implicit, resource owner password
                credentials, or client credentials grant type. The
                <code>claims</code> request parameter MAY also
                be used with additional grant type that use the extension
                mechanism defined in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>
                if so profiled by some other specification.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="authorization-code-grant">
<section id="section-4.1">
        <h3 id="name-authorization-code-grant">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-authorization-code-grant" class="section-name selfRef">Authorization Code Grant</a>
        </h3>
<div id="authorization-code-grant-authorization-request">
<section id="section-4.1.1">
          <h4 id="name-authorization-request-2">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-authorization-request-2" class="section-name selfRef">Authorization Request</a>
          </h4>
<p id="section-4.1.1-1">
                        When a client seeks to obtain authorization using
                        the authorization code grant type defined in
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>, the client
                        MAY include the following additional query
                        component that it sends to the authorization
                        endpoint URI:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.1.1-2">
            <dt id="section-4.1.1-2.1">claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.1.1-2.2">
                                OPTIONAL. A claims request object as
                                described in
                                <a href="#claims-request-object" class="xref">Section 3</a>.<a href="#section-4.1.1-2.2" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-4.1.1-3">
                        The value of this parameter must use the
                        <code>application/x-www-form-urlencoded</code>
                        format defined in Appendix B of
                        <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">
                        A non-normative example of a request to the authorization
                        endpoint with a URL-encoded value of the claims parameter
                        is shown in
                        <a href="#example-authorize-request-with-claims" class="xref">Figure 15</a>
                        (with extra line breaks for display purposes only):<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<span id="name-example-of-using-the-claims"></span><div id="example-authorize-request-with-claims">
<figure id="figure-15">
            <div class="artwork art-text alignLeft" id="section-4.1.1-5.1">
<pre>
                            
GET /authorize?client_id=s6BhdRkqt3&amp;response_type=code&amp;
    claims=%7B%0A%20%20%22access_token%22%20%3A%20%7B%20%0A
        %20%20%20%20%22https%3A%2F%2Fexample.com%2Fclaim1%22%20%3A
        %20null%2C%0A%20%20%20%20%22fname%22%20%3A%20%7B%0A%20%20
        %20%20%20%20%22value%22%20%3A%20%22John%22%0A%20%20%20%20
        %7D%0A%20%20%7D%0A%7D
Host: server.example.com

                        </pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-example-of-using-the-claims" class="selfRef">Example of Using the Claims Request                             Parameter on the Authorize Endpoint</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="authorization-code-grant-error-response">
<section id="section-4.1.2">
          <h4 id="name-error-response">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-error-response" class="section-name selfRef">Error Response</a>
          </h4>
<p id="section-4.1.2-1">
                        If the authorization server understands the
                        <code>claims</code> request
                        parameter, it MUST
                        redirect the user-agent of the resource owner to
                        the client's redirection endpoint as described in
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.1.2.1" class="relref">Section 4.1.2.1</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span> with
                        one of the following
                        <code>error</code> values:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.1.2-2">
            <dt id="section-4.1.2-2.1">claims_not_supported</dt>
            <dd style="margin-left: 4.0em" id="section-4.1.2-2.2">
                            The authorization server understands but does not support
                            the <code>claims</code>
                            request parameter, and the client SHOULD
                            NOT use it when requesting authorization.<a href="#section-4.1.2-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-4.1.2-2.3">invalid_request</dt>
            <dd style="margin-left: 4.0em" id="section-4.1.2-2.4">
                            The authorization server MAY use this
                            less-descriptive error code to indicate that
                            the claims request parameter value is not
                            accepted, e.g., because it is syntactically
                            incorrect. It is, however, RECOMMENDED that the
                            authorization server return
                            <code>claims_not_supported</code>
                            or <code>invalid_claims</code> as
                            appropriate.<a href="#section-4.1.2-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-4.1.2-2.5">invalid_claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.1.2-2.6">
                            When a client makes a request for a critical
                            claim, and the authorization server cannot
                            assert such a claim because it is invalid,
                            unknown, or malformed, this error results. If
                            the request includes only claim names in the
                            claims request object which are disallowed
                            according to the authorization server's policy,
                            this error (or the less-descriptive alternative,
                            <code>invalid_request</code>)
                            MUST result.<a href="#section-4.1.2-2.6" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
<div id="authorization-code-grant-access-token-response">
<section id="section-4.1.3">
          <h4 id="name-access-token-response">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-access-token-response" class="section-name selfRef">Access Token Response</a>
          </h4>
<p id="section-4.1.3-1">
                        In a non-error case, the authorization server MAY
                        include details about the claims that the client
                        is authorized for. This is done by augmenting the
                        response defined in
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.1.4" class="relref">Section 4.1.4</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>. In particular, the
                        authorization server MAY include the following
                        response member in the JSON object returned from
                        the token endpoint:<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.1.3-2">
            <dt id="section-4.1.3-2.1">claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.1.3-2.2">
                            OPTIONAL, if identical to the claims
                            requested by the client; otherwise,
                            REQUIRED. The space-separated claim names
                            granted by the resource owner which denote
                            the scope of the access token that is
                            returned in the same response.<a href="#section-4.1.3-2.2" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="implicit-flow">
<section id="section-4.2">
        <h3 id="name-implicit-flow">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-implicit-flow" class="section-name selfRef">Implicit Flow</a>
        </h3>
<div id="implicit-flow-authorization-request">
<section id="section-4.2.1">
          <h4 id="name-authorization-request-3">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-authorization-request-3" class="section-name selfRef">Authorization Request</a>
          </h4>
<p id="section-4.2.1-1">
                        When a client seeks to obtain authorization using
                        the implicit grant type defined in
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>, the client MAY include
                        the following additional query component that it
                        sends to the authorization endpoint URI:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.2.1-2">
            <dt id="section-4.2.1-2.1">claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.2.1-2.2">
                            OPTIONAL. A claims request object as
                            described in
                            <a href="#claims-request-object" class="xref">Section 3</a>.<a href="#section-4.2.1-2.2" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-4.2.1-3">
                        The value of this parameter must use the
                        <code>application/x-www-form-urlencoded</code>
                        format defined in Appendix B of
                        <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implicit-flow-authorization-response">
<section id="section-4.2.2">
          <h4 id="name-access-token-response-2">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-access-token-response-2" class="section-name selfRef">Access Token Response</a>
          </h4>
<p id="section-4.2.2-1">
                        In a non-error case, the authorization server MAY
                        include details about the claims that the client is
                        authorized for. This is done by augmenting the
                        response defined in
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.2.2" class="relref">Section 4.2.2</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>. In particular, the
                        authorization server MAY include the following
                        response parameter included on the fragment
                        component of the redirection URI:<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.2.2-2">
            <dt id="section-4.2.2-2.1">claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.2.2-2.2">
                            OPTIONAL, if identical to the claims
                            requested by the client; otherwise,
                            REQUIRED. The space-separated claim names
                            granted by the resource owner which denote
                            the scope of the access token that is
                            returned in the same response.<a href="#section-4.2.2-2.2" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
<div id="implicit-flow-error-response">
<section id="section-4.2.3">
          <h4 id="name-error-response-2">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-error-response-2" class="section-name selfRef">Error Response</a>
          </h4>
<p id="section-4.2.3-1">
                        If the authorization server understands the
                        <code>claims</code> request
                        parameter, it MUST
                        redirect the user-agent of the resource owner to
                        the client's redirection URI as described in
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.2.2.1" class="relref">Section 4.2.2.1</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span> with
                        one of the following
                        <code>error</code> values:<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.2.3-2">
            <dt id="section-4.2.3-2.1">claims_not_supported</dt>
            <dd style="margin-left: 4.0em" id="section-4.2.3-2.2">
                            The authorization server understands but does not support
                            the <code>claims</code>
                            request parameter, and the client SHOULD
                            NOT use it when requesting authorization.<a href="#section-4.2.3-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2.3-2.3">invalid_request</dt>
            <dd style="margin-left: 4.0em" id="section-4.2.3-2.4">
                            The authorization server MAY use this
                            less-descriptive error code to indicate that the
                            claims request parameter value is not
                            accepted, e.g., because it is syntactically.
                            incorrect. It is, however, RECOMMENDED that the
                            authorization server return
                            <code>claims_not_supported</code>
                            or <code>invalid_claims</code> as
                            appropriate.<a href="#section-4.2.3-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2.3-2.5">invalid_claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.2.3-2.6">
                            When a client makes a request for a critical
                            claim, and the authorization server cannot
                            assert such a claim because it is invalid,
                            unknown, or malformed, this error results. If
                            the request includes only claim names in the
                            claims request object which are disallowed
                            according to the authorization server's policy,
                            this error (or the less-descriptive alternative,
                            <code>invalid_request</code>)
                            MUST result.<a href="#section-4.2.3-2.6" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="resource-owner-password-credentials-grant">
<section id="section-4.3">
        <h3 id="name-resource-owner-password-cre">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-resource-owner-password-cre" class="section-name selfRef">Resource Owner Password Credentials Grant</a>
        </h3>
<div id="ropc-access-token-request">
<section id="section-4.3.1">
          <h4 id="name-access-token-request">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-access-token-request" class="section-name selfRef">Access Token Request</a>
          </h4>
<p id="section-4.3.1-1">
                        When a client seeks to obtain authorization using
                        the resource owner password credentials grant type
                        defined in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>,
                        the client MAY include the following additional
                        parameter using the
                        <code>application/x-www-form-urlencoded</code>
                        format per Appendix B of <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>
                        with a character encoding of UTF-8 in the HTTP
                        request entity-body:<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.3.1-2">
            <dt id="section-4.3.1-2.1">claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.3.1-2.2">
                            OPTIONAL. A claims request object as
                            described in
                            <a href="#claims-request-object" class="xref">Section 3</a>.<a href="#section-4.3.1-2.2" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
<div id="ropc-access-token-response">
<section id="section-4.3.2">
          <h4 id="name-access-token-response-3">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-access-token-response-3" class="section-name selfRef">Access Token Response</a>
          </h4>
<p id="section-4.3.2-1">
                        In a non-error case, the authorization server MAY
                        include details about the claims that the client is
                        authorized for. This is done by augmenting the
                        response defined in
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.3.3" class="relref">Section 4.3.3</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>. In particular, the
                        authorization server MAY include the following
                        response member in the JSON object returned from
                        the token endpoint:<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.3.2-2">
            <dt id="section-4.3.2-2.1">claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.3.2-2.2">
                            OPTIONAL, if identical to the claims
                            requested by the client; otherwise,
                            REQUIRED. The space-separated claim names
                            the client is authorized for which denote
                            the scope of the access token that is
                            returned in the same response.<a href="#section-4.3.2-2.2" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-4.3.2-3">
                        If the request is invalid due to the value
                        of the <code>claims</code>
                        parameter, the authorization server returns an
                        error with one of the following error codes:<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.3.2-4">
            <dt id="section-4.3.2-4.1">claims_not_supported</dt>
            <dd style="margin-left: 4.0em" id="section-4.3.2-4.2">
                            The authorization server understands but does not support
                            the <code>claims</code>
                            request parameter, and the client SHOULD
                            NOT use it when requesting an access token.<a href="#section-4.3.2-4.2" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3.2-4.3">invalid_request</dt>
            <dd style="margin-left: 4.0em" id="section-4.3.2-4.4">
                            The authorization server MAY use this
                            less-descriptive error code to indicate that
                            the claims request parameter value is not
                            accepted, accepted, e.g., because it is
                            syntactically incorrect. It is, however,
                            RECOMMENDED that the authorization server return
                            <code>claims_not_supported</code>
                            or <code>invalid_claims</code> as
                            appropriate.<a href="#section-4.3.2-4.4" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3.2-4.5">invalid_claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.3.2-4.6">
                            When a client makes a request for a critical
                            claim, and the authorization server cannot
                            assert such a claim because it is invalid,
                            unknown, or malformed, this error results. If
                            the request includes only claim names in the
                            claims request object which are disallowed
                            according to the authorization server's policy,
                            this error (or the less-descriptive alternative,
                            <code>invalid_request</code>)
                            MUST result.<a href="#section-4.3.2-4.6" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="client-credentials-grant">
<section id="section-4.4">
        <h3 id="name-client-credentials-grant">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-client-credentials-grant" class="section-name selfRef">Client Credentials Grant</a>
        </h3>
<div id="cc-access-token-request">
<section id="section-4.4.1">
          <h4 id="name-access-token-request-2">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-access-token-request-2" class="section-name selfRef">Access Token Request</a>
          </h4>
<p id="section-4.4.1-1">
                        When a client seeks to obtain authorization using
                        the client credentials grant type defined in
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>, the client
                        MAY include the following additional parameter
                        using the
                        <code>application/x-www-form-urlencoded</code>
                        format per Appendix B of <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>
                        with a character encoding of UTF-8 in the HTTP
                        request entity-body:<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.4.1-2">
            <dt id="section-4.4.1-2.1">claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.4.1-2.2">
                            OPTIONAL. A claims request object as
                            described in  <a href="#claims-request-object" class="xref">Section 3</a>.<a href="#section-4.4.1-2.2" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
<div id="cc-access-token-response">
<section id="section-4.4.2">
          <h4 id="name-access-token-response-4">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-access-token-response-4" class="section-name selfRef">Access Token Response</a>
          </h4>
<p id="section-4.4.2-1">
                        In a non-error case, the authorization server MAY
                        include details about the claims that the client
                        is authorized for. This is done by augmenting the
                        response defined in
                        <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.4.3" class="relref">Section 4.4.3</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>. In particular, the
                        authorization server MAY include the following
                        response member in the JSON object returned from
                        the token endpoint:<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.4.2-2">
            <dt id="section-4.4.2-2.1">claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.4.2-2.2">
                                OPTIONAL, if identical to the claims
                                requested by the client; otherwise,
                                REQUIRED. The space-separated claim names
                                the client is authorized for which denote
                                the scope of the access token that is
                                returned in the same response.<a href="#section-4.4.2-2.2" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-4.4.2-3">
                        If the request is invalid due to the
                        value of the <code>claims</code>
                        parameter, the authorization server returns an
                        error with one of the following error codes:<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.4.2-4">
            <dt id="section-4.4.2-4.1">claims_not_supported</dt>
            <dd style="margin-left: 4.0em" id="section-4.4.2-4.2">
                            The authorization server understands but does not support
                            the <code>claims</code>
                            request parameter, and the client SHOULD
                            NOT use it when requesting an access token.<a href="#section-4.4.2-4.2" class="pilcrow">¶</a>
</dd>
<dt id="section-4.4.2-4.3">invalid_request</dt>
            <dd style="margin-left: 4.0em" id="section-4.4.2-4.4">
                            The authorization server MAY use this
                            less-descriptive error code to indicate that
                            the claims request parameter value is not
                            accepted, e.g., because it is syntactically
                            incorrect. It is, however, RECOMMENDED that the
                            authorization server return
                            <code>claims_not_supported</code>
                            or <code>invalid_claims</code> as
                            appropriate.<a href="#section-4.4.2-4.4" class="pilcrow">¶</a>
</dd>
<dt id="section-4.4.2-4.5">invalid_claims</dt>
            <dd style="margin-left: 4.0em" id="section-4.4.2-4.6">
                            When a client makes a request for a critical
                            claim, and the authorization server cannot
                            assert such a claim because it is invalid,
                            unknown, or malformed, this error results. If
                            the request includes only claim names in the
                            claims request object which are disallowed
                            according to the authorization server's policy,
                            this error (or the less-descriptive alternative,
                            <code>invalid_request</code>)
                            MUST result.<a href="#section-4.4.2-4.6" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="token-refresh">
<section id="section-5">
      <h2 id="name-token-refresh">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-token-refresh" class="section-name selfRef">Token Refresh</a>
      </h2>
<p id="section-5-1">
                As defined in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-6" class="relref">Section 6</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>, a client
                may be provided with a refresh token. When it is, it can
                present this to the token endpoint of the authorization server
                in a refresh request. This specification extends the
                request and response of this flow as described in the following
                subsections.<a href="#section-5-1" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-token-refresh-request">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-token-refresh-request" class="section-name selfRef">Token Refresh Request</a>
        </h3>
<p id="section-5.1-1">
                    When performing a token refresh request, the client MAY
                    send the following parameter using the
                    <code>application/x-www-form-urlencoded</code>
                    format per Appendix B of <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> with
                    a character encoding of UTF-8 in the HTTP request
                    entity-body:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-5.1-2">
          <dt id="section-5.1-2.1">claims</dt>
          <dd style="margin-left: 4.0em" id="section-5.1-2.2">
                        OPTIONAL. A claims request object as described in
                        <a href="#claims-request-object" class="xref">Section 3</a>.<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-5.1-3">
                    If the client includes a claims request object in the
                    request, it SHOULD ensure that the claim names in the
                    claims value query object(s) are ones that were authorized
                    by the resource owner. It can do this by remembering what
                    was originally requested and/or from the authorization server's
                    response to its authorization request which
                    will include the list of claim names if they differ from
                    those originally requested.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
<div id="refresh-access-token-response">
<section id="section-5.2">
        <h3 id="name-access-refresh-response">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-access-refresh-response" class="section-name selfRef">Access Refresh Response</a>
        </h3>
<p id="section-5.2-1">
                    In a non-error case, the authorization server MAY include
                    details about the claims that the client is authorized for.
                    This is done by augmenting the response defined in
                    <span><a href="https://rfc-editor.org/rfc/rfc6749#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>. In particular, the
                    authorization server MAY include the following response
                    member in the JSON object returned from the token endpoint:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-5.2-2">
          <dt id="section-5.2-2.1">claims</dt>
          <dd style="margin-left: 4.0em" id="section-5.2-2.2">
                        OPTIONAL, if identical to the claims requested by
                        the client; otherwise, REQUIRED. The
                        space-separated claim names the client is
                        authorized for which denote the scope of the access
                        token that is returned in the same response.<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-5.2-3">
                    If the request is invalid due to the value of the value of
                    the <code>claims</code> parameter, the
                    authorization server returns an error with one of the
                    following error codes:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-5.2-4">
          <dt id="section-5.2-4.1">claims_not_supported</dt>
          <dd style="margin-left: 4.0em" id="section-5.2-4.2">
                        The authorization server understands but does not
                        support the <code>claims</code>
                        request parameter, and the client SHOULD NOT use
                        it when requesting an access token.<a href="#section-5.2-4.2" class="pilcrow">¶</a>
</dd>
<dt id="section-5.2-4.3">invalid_request</dt>
          <dd style="margin-left: 4.0em" id="section-5.2-4.4">
                        The authorization server MAY use this
                        less-descriptive error code to indicate that the
                        claims request parameter value is not accepted,
                        e.g., because it is syntactically incorrect. It
                        is, however, RECOMMENDED that the authorization server
                        return
                        <code>claims_not_supported</code>
                        or <code>invalid_claims</code> as
                        appropriate.<a href="#section-5.2-4.4" class="pilcrow">¶</a>
</dd>
<dt id="section-5.2-4.5">invalid_claims</dt>
          <dd style="margin-left: 4.0em" id="section-5.2-4.6">
                        When a client makes a request for a critical claim,
                        and the authorization server cannot assert such a
                        claim because it is invalid, unknown, or malformed,
                        this error results. If the request includes only
                        claim names in the claims request object which are
                        disallowed according to the authorization server's
                        policy, this error (or the
                        less-descriptive alternative,
                        <code>invalid_request</code>)
                        MUST result.<a href="#section-5.2-4.6" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="token-exhange">
<section id="section-6">
      <h2 id="name-token-exchange-2">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-token-exchange-2" class="section-name selfRef">Token Exchange</a>
      </h2>
<p id="section-6-1">TBD<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-introspection">
<section id="section-7">
      <h2 id="name-token-introspection-2">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-token-introspection-2" class="section-name selfRef">Token Introspection</a>
      </h2>
<p id="section-7-1">
                This specification defines an additional top-level member in
                the JSON <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span> object of the authorization server's
                introspection endpoint response as stipulated in
                <span><a href="https://rfc-editor.org/rfc/rfc7662#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC7662" class="xref">RFC7662</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-7-2">
        <dt id="section-7-2.1">claims</dt>
        <dd style="margin-left: 4.0em" id="section-7-2.2">
                    OPTIONAL. The space-separated claim names granted by the resource owner
                    which denote the scope of the access token.<a href="#section-7-2.2" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
<section id="section-8">
      <h2 id="name-requesting-claims-for-a-par">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-requesting-claims-for-a-par" class="section-name selfRef">Requesting Claims for a Particular Protected Resource</a>
      </h2>
<p id="section-8-1">TBD<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
<div id="authorization-server-metadata">
<section id="section-9">
      <h2 id="name-authorization-server-metada">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-authorization-server-metada" class="section-name selfRef">Authorization Server Metadata</a>
      </h2>
<p id="section-9-1">
                An authorization server that supports the
                <code>claims</code> request parameter SHOULD
                declare this fact by including the following property in the
                authorization server metadata response
                <span>[<a href="#RFC8414" class="xref">RFC8414</a>]</span>:<a href="#section-9-1" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-9-2">
        <dt id="section-9-2.1">claims_parameter_supported</dt>
        <dd style="margin-left: 4.0em" id="section-9-2.2">
                    OPTIONAL. A boolean value indicating that the
                    authorization server supports the
                    <code>claims</code> request parameter or
                    not. A value of <code>true</code>
                    indicates that it is supported. A value of
                    <code>false</code>, a
                    <code>null</code> value, or the absence
                    of the property means that the
                    <code>claims</code> request parameter is
                    not supported by the authorization server.<a href="#section-9-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-9-2.3">claims_supported</dt>
        <dd style="margin-left: 4.0em" id="section-9-2.4">
                    RECOMMENDED. JSON array containing a list of the claim
                    names of the Claims that the authorization server MAY
                    be able to supply values for. Note that for privacy or
                    other reasons, this might not be an exhaustive list.<a href="#section-9-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-9-2.5">critical_claims_supported</dt>
        <dd style="margin-left: 4.0em" id="section-9-2.6">
                    OPTIONAL. A boolean value indicating that the
                    authorization server supports the possibility for the
                    client to indicate that certain parts of a claims
                    request object MUST be understood by the authorization server.
                    A value of <code>false</code>,
                    a <code>null</code> value, or the
                    absence of this member means that the authorization server
                    MAY not support this interaction pattern, and
                    the client MUST NOT assume that it does.<a href="#section-9-2.6" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-9-3">
                If the authorization server returns a value of
                <code>false</code> for
                <code>claims_parameter_supported</code> and
                true for <code>critical_claims_supported</code>,
                the interpretation by the client is undefined. It is
                RECOMMENDED that the client assume that the authorization server
                is misconfigured and that it not attempt to request
                claims in a manner defined by this specification.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">
                A non-normative example of an authorization server metadata
                response which indicates that the
                <code>claims</code> request parameter and
                critical claims are supported by the server is shown in
                <a href="#authorization-server-metadata-example" class="xref">Figure 16</a>.<a href="#section-9-4" class="pilcrow">¶</a></p>
<span id="name-example-of-metadata-of-an-a"></span><div id="authorization-server-metadata-example">
<figure id="figure-16">
        <div class="artwork art-text alignLeft" id="section-9-5.1">
<pre>
                        
HTTP/1.1 200 OK
Content-Type: application/json

{
    "issuer" :
        "https://server.example.com",
    "authorization_endpoint" :
        "https://server.example.com/authorize",
    "token_endpoint" :
        "https://server.example.com/token",
    "token_endpoint_auth_methods_supported" :
        ["client_secret_basic", "private_key_jwt"],
    "token_endpoint_auth_signing_alg_values_supported" :
        ["RS256", "ES256"],
    "userinfo_endpoint" :
        "https://server.example.com/userinfo",
    "jwks_uri" :
        "https://server.example.com/jwks.json",
    "registration_endpoint" :
        "https://server.example.com/register",
    "scopes_supported" :
        ["openid", "profile", "email", "address", "phone",
         "offline_access"],
    "response_types_supported" :
        ["code", "code token"],
    "service_documentation" :
        "http://server.example.com/service_documentation.html",
    "ui_locales_supported" :
        ["en-US", "en-GB", "en-CA", "fr-FR", "fr-CA"],
    "claims_parameter_supported" : true,
    "critical_claims_supported" : true,
    "claims_supported" : ["sub", "http://example.com/monkey" ]
}
                </pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-example-of-metadata-of-an-a" class="selfRef">Example of Metadata of an Authorization Server                     that Supports the Claims Request Parameter and                     Critical Claims</a>
        </figcaption></figure>
</div>
<p id="section-9-6">
                Note the last three members in particular.<a href="#section-9-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">TBD<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-11">
      <h2 id="name-privacy-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-11-1">TBD<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-12-1">TBD<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-normative-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC6749">[RFC6749]</dt>
      <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dt id="RFC6901">[RFC6901]</dt>
      <dd>
<span class="refAuthor">Bryan, P., Ed.</span><span class="refAuthor">, Zyp, K.</span><span class="refAuthor">, and M. Nottingham, Ed.</span>, <span class="refTitle">"JavaScript Object Notation (JSON) Pointer"</span>, <span class="seriesInfo">RFC 6901</span>, <span class="seriesInfo">DOI 10.17487/RFC6901</span>, <time datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6901">https://www.rfc-editor.org/info/rfc6901</a>&gt;</span>. </dd>
<dt id="RFC7519">[RFC7519]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dt id="RFC7662">[RFC7662]</dt>
      <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refTitle">"OAuth 2.0 Token Introspection"</span>, <span class="seriesInfo">RFC 7662</span>, <span class="seriesInfo">DOI 10.17487/RFC7662</span>, <time datetime="2015-10">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7662">https://www.rfc-editor.org/info/rfc7662</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC8259">[RFC8259]</dt>
      <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dt id="RFC8414">[RFC8414]</dt>
    <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Sakimura, N.</span><span class="refAuthor">, and J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-14">
      <h2 id="name-informative-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="OpenID.Core">[OpenID.Core]</dt>
      <dd>
<span class="refAuthor">Sakimura, N.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Jones, M.B.</span><span class="refAuthor">, de Medeiros, B.</span><span class="refAuthor">, and C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0"</span>, <span class="seriesInfo">OpenID Foundation Standards</span>, <time datetime="2014-02-25">25 February 2014</time>, <span>&lt;<a href="http://openid.net/specs/openid-connect-core-1_0.html">http://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dt id="I-D.ietf-oauth-token-exchange">[I-D.ietf-oauth-token-exchange]</dt>
    <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Nadalin, A.</span><span class="refAuthor">, Campbell, B.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and C. Mortimore</span>, <span class="refTitle">"OAuth 2.0 Token Exchange"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-token-exchange-19</span>, <time datetime="2019-07-21">21 July 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-token-exchange-19">https://tools.ietf.org/html/draft-ietf-oauth-token-exchange-19</a>&gt;</span>. </dd>
</dl>
</section>
<div id="Acknowledgements">
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">
                The following individuals contributed ideas, feedback, wording and editorial guidance to this specification:<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">
                Mark Dobrinic, Jacob Ideskog, Torsten Lodderstedt, Alice Russo<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="section-appendix.b">
      <h2 id="name-document-history">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="section-appendix.b-1">
                [[ to be removed by the RFC editor before publication as an RFC ]]<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">-01<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.b-3.1">Use of XML entities for common terms in XML version of doc<a href="#section-appendix.b-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-3.2">Convert XML to v. 3 format<a href="#section-appendix.b-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-3.3">Added additional acknowledgements<a href="#section-appendix.b-3.3" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-3.4">Updated keywords paragraph<a href="#section-appendix.b-3.4" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-3.5">Updated links to other RFCs<a href="#section-appendix.b-3.5" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-3.6">Small format changes and fixing of typos<a href="#section-appendix.b-3.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-4">-00<a href="#section-appendix.b-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.b-5.1">
                    Initial draft.<a href="#section-appendix.b-5.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Travis Spencer</span></div>
<div dir="auto" class="left"><span class="org">Curity AB</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:travis@curity.io" class="email">travis@curity.io</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
