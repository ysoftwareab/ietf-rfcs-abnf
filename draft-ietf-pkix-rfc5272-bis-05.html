<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Certificate Management over CMS (CMC) Updates</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Updates to RFC 5272 - Certificate Management over CMS (CMC)">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 New Section 1.3.  Changes Since RFC 5272">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Update Section 6. Controls">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Replace Section 6.3. Linking Identity and POP Information">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Replace Section 6.3.3.  Renewal and Rekey Messages">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 New Section 6.20 RA Identity Proof Witness control">
<link href="#rfc.section.2.6" rel="Chapter" title="2.6 New Section 6.21 Response Body Control">
<link href="#rfc.section.2.7" rel="Chapter" title="2.7 New Section 7. Other Attributes">
<link href="#rfc.section.2.8" rel="Chapter" title="2.8 New Section 7.1 Change Subject Name Attribute">
<link href="#rfc.section.2.9" rel="Chapter" title="2.9 New Section 9. Certificate Requirements">
<link href="#rfc.section.2.10" rel="Chapter" title="2.10 New Section 9.1. Extended Key Usage">
<link href="#rfc.section.2.11" rel="Chapter" title="2.11 New Section 9.2. Subject Information Access">
<link href="#rfc.section.2.12" rel="Chapter" title="2.12 Updates Section 8. Security Considerations">
<link href="#rfc.section.3" rel="Chapter" title="3 Updates to RFC 5273 - Certificate Management over CMS (CMC): Transport Protocols">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Update to Section 5 TCP-Based Protocol">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 New Section 6. IANA Considerations">
<link href="#rfc.section.4" rel="Chapter" title="4 Updates to RFC 5274 - Certificate Management Message over CMS (CMC): Compliance Requirements">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Update to Section 4.2 Controls">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informational References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A ASN.1 Modules">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 1988 ASN.1 Module">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 2008 ASN.1 Module">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document contains a set of updates to the base syntax for CMC, a Certificate Management protocol using the Cryptographic Message Syntax (CMS).  This document updates RFC 5272, RFC 5273 and RFC 5274.  " />
  <meta name="description" content="This document contains a set of updates to the base syntax for CMC, a Certificate Management protocol using the Cryptographic Message Syntax (CMS).  This document updates RFC 5272, RFC 5273 and RFC 5274.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">J. Schaad</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Soaring Hawk Consulting</td>
</tr>
<tr>
<td class="left">Updates: 5272, 5273, 5274 (if approved)</td>
<td class="right">August 12, 2011</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right"></td>
</tr>
<tr>
<td class="left">Expires: February 13, 2012</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Certificate Management over CMS (CMC) Updates<br />
  <span class="filename">draft-ietf-pkix-rfc5272-bis-05</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document contains a set of updates to the base syntax for CMC, a Certificate Management protocol using the Cryptographic Message Syntax (CMS).  This document updates RFC 5272, RFC 5273 and RFC 5274.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on February 13, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Terminology</a>
</li>
<li>2.   <a href="#rfc.section.2">Updates to RFC 5272 - Certificate Management over CMS (CMC)</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">New Section 1.3.  Changes Since RFC 5272</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Update Section 6. Controls</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Replace Section 6.3. Linking Identity and POP Information</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Replace Section 6.3.3.  Renewal and Rekey Messages</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">New Section 6.20 RA Identity Proof Witness control</a>
</li>
<li>2.6.   <a href="#rfc.section.2.6">New Section 6.21 Response Body Control</a>
</li>
<li>2.7.   <a href="#rfc.section.2.7">New Section 7. Other Attributes</a>
</li>
<li>2.8.   <a href="#rfc.section.2.8">New Section 7.1 Change Subject Name Attribute</a>
</li>
<li>2.9.   <a href="#rfc.section.2.9">New Section 9. Certificate Requirements</a>
</li>
<li>2.10.   <a href="#rfc.section.2.10">New Section 9.1. Extended Key Usage</a>
</li>
<li>2.11.   <a href="#rfc.section.2.11">New Section 9.2. Subject Information Access</a>
</li>
<li>2.12.   <a href="#rfc.section.2.12">Updates Section 8. Security Considerations</a>
</li>
<li>3.   <a href="#rfc.section.3">Updates to RFC 5273 - Certificate Management over CMS (CMC): Transport Protocols</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Update to Section 5 TCP-Based Protocol</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">New Section 6. IANA Considerations</a>
</li>
<li>4.   <a href="#rfc.section.4">Updates to RFC 5274 - Certificate Management Message over CMS (CMC): Compliance Requirements</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Update to Section 4.2 Controls</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informational References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">ASN.1 Modules</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">1988 ASN.1 Module</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">2008 ASN.1 Module</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">While dealing with the Suite B profile of CMC <a href="#I-D.turner-suiteb-cmc">[I-D.turner-suiteb-cmc]</a>, a number of deficiencies were noted in the current base CMC specification.  This document has a set of updates to <a href="#RFC5272">[RFC5272]</a>, <a href="#RFC5273">[RFC5273]</a> and <a href="#RFC5274">[RFC5274]</a> to deal with those issues.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Terminology</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Updates to RFC 5272 - Certificate Management over CMS (CMC)</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> New Section 1.3.  Changes Since RFC 5272</h1>
<p id="rfc.section.2.1.p.1">This section is inserted before the current section 1.3.  </p>
<p id="rfc.section.2.1.p.2">The following changes were made in this document.  </p>

<ul>
<li>Addition of new controls: <dl>
<dt>RA Identity Witness</dt>
<dd style="margin-left: 8">allows for an RA to perform the identity checking using the identity and shared-secret and then tell any following servers that the identity check was successfully performed.  </dd>
<dt>Response Body</dt>
<dd style="margin-left: 8">allows for an RA to identify a nested response for an EE to process.</dd>
</dl>
<p> </p>
</li>
<li>Creation of a new attribute Change Subject Name that allows a client to request a change in the subject name and subject alternate name fields in a certificate.  </li>
<li>Add Extended Key Usages for CMC - Define a new Subject Information Access to hold locations to contact the CMC server.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Update Section 6. Controls</h1>
<p id="rfc.section.2.2.p.1">Table 1 is to be updated by the addition of the following rows:</p>
<div id="#rfc.table.1"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>CMC Control Attributes</caption>
<thead><tr>
<th class="left">Control Identifier</th>
<th class="left">OID</th>
<th class="left">Syntax</th>
<th class="left">Section</th>
</tr></thead>
<tbody>
<tr>
<td class="left">id-cmc-raIdentityWitness</td>
<td class="left">id-cmc TBD</td>
<td class="left">BodyPartPath</td>
<td class="left">6.20</td>
</tr>
<tr>
<td class="left">id-cmc-responseBody</td>
<td class="left">id-cmc TBD</td>
<td class="left">BodyPartPath</td>
<td class="left">6.21</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Replace Section 6.3. Linking Identity and POP Information</h1>
<p id="rfc.section.2.3.p.1">Replace the text of the section with the following text.</p>
<p id="rfc.section.2.3.p.2">In a Full PKI Request, identity proof information about the client is carried in the certificate associated with the signature of the SignedData containing the certification requests, one of the two identity proof controls or the MAC computed for the AuthenticatedData containing the certification requests.  Proof-of-possession information for key pairs, however, is carried separately for each PKCS #10 or CRMF certification request.  (For keys capable of generating a digital signature, the POP is provided by the signature on the PKCS #10 or CRMF request.  For encryption-only keys, the controls described in Section 6.7 are used.)  In order to prevent substitution-style attacks, the protocol must guarantee that the same entity supplied both the POP and proof-of-identity information.  </p>
<p id="rfc.section.2.3.p.3">We describe three mechanisms for linking identity and POP information: witness values cryptographically derived from a shared-secret (Section 6.3.1), shared-secret/subject name matching (Section 6.3.2), and subject name matching to an existing certificate (Section 6.3.3).  Clients and servers MUST support the witness value and the certificate linking techniques.  Clients and servers MAY support shared-secret/name matching or MAY support other bilateral techniques of similar strength.  The idea behind the first two mechanisms is to force the client to sign some data into each certification request that can be directly associated with the shared-secret; this will defeat attempts to include certification requests from different entities in a single Full PKI Request.  </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> Replace Section 6.3.3.  Renewal and Rekey Messages</h1>
<p id="rfc.section.2.4.p.1">New section title is "Existing Certificate Linking".  Replace all text in this section with this text.  </p>
<p id="rfc.section.2.4.p.2">Linking between the POP and an identity is easy when an existing certificate is used.  The client copies all of the naming information from the existing certificate (subject name and subject alternative name) into the new certification request.  The POP on the new public key is then performed by using the new key to sign the identity information (linking the POP to a specific identity).  The identity information is then tied to the POP information by signing the entire enrollment request with the public key of the existing certificate.  </p>
<p id="rfc.section.2.4.p.3">Existing certificate linking can be used in the following circumstances: </p>

<ul class="empty">
<li>When replacing a certificate by doing a renewal or rekey certification request.</li>
<li>Using of an existing certificate to get a new certificate.  An example of this would be to get a key establishment certificate after having gotten a signature certificate.</li>
<li>Using a third party certificate to get a new certificate from a CA.  An example of this would be to use a certificate and key pair distributed with a device to prove an identity.  This requires that the CA have an out-of-band channel to map the identity in the device certificate to the new EE identity.</li>
</ul>

<p> </p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> New Section 6.20 RA Identity Proof Witness control</h1>
<p id="rfc.section.2.5.p.1">The RA Identity Proof Witness control allows an RA to indicate to subsequence control processors that all of the identity proof requirements have been met.  This permits the identity proof to be performed at a location closer to the end-entity.  For example, the identity proof could be done at a physical location while the CA could be company-wide (and thus span multiple physical locations).  The RA performs the identity proof, and potentially other tasks that require the secret to be used, while the CA would be prevented from knowing the secret.  If the identity proof fails, then the RA returns an error to the client denoting that fact.  </p>
<p id="rfc.section.2.5.p.2">The relevant ASN.1 for the RA Identity Proof Witness control is as follows: </p>
<div id="#rfc.figure.1"></div>
<pre>
   cmc-raIdentityWitness CMC-CONTROL ::=
      { BodyPartPath IDENTIFIED BY id-cmc-raIdentityWitness }

   id-cmc-raIdentityWitness OBJECT IDENTIFIER ::= {id-cmc TBD}
</pre>
<p id="rfc.section.2.5.p.3">The above ASN.1 defines the following items: </p>

<dl>
<dt>cmc-raIdentityWitness</dt>
<dd style="margin-left: 8">is a CMC-CONTROL associating the object identifier id-cmc-raIdentityWitness and the type BodyPartPath.  This object is omitted from the 1988 module. The object is added to the object set Cmc-Control-Set .  The control is only permitted to occur in the control sequence of a PKIData object.  It is not permitted to occur in the control sequence of a PKIResponse.  The control is only permitted to be used by an RA.  The control may occur multiple times in a control sequence with each occurrence pointing to a different object.  </dd>
<dt>id-cmc-rsIdentitiyWitness</dt>
<dd style="margin-left: 8">is the object identifier used to identify this CMC control.  </dd>
<dt>BodyPartPath</dt>
<dd style="margin-left: 8">is the type structure associated with the control.  The syntax of BodyPartPath is defined in Section 3.2.2.  The path contains a sequence of body part identifiers leading to one of the following items: <dl>
<dt>Identity Proof control</dt>
<dd style="margin-left: 8">if the RA verified the identity proof in this control.</dd>
<dt>Identity Proof Version 2</dt>
<dd style="margin-left: 8">if the RA verified the identity proof in this control.</dd>
<dt>Full PKI Request</dt>
<dd style="margin-left: 8">if the RA performed an out-of-band identity proof for this request.  The request SHOULD NOT contain either Identity Proof control.</dd>
<dt>Simple PKI Request</dt>
<dd style="margin-left: 8">if the RA performed an out-of-band identity proof for this request.</dd>
</dl>
<p> </p>
</dd>
</dl>

<p> </p>
<p id="rfc.section.2.5.p.4">The RA Identity Proof Witness control will frequently be associated with a Modify Certification Request control which changes the name fields in the associated certification requests as the RA will frequently know the actual name to be assigned to the entity requesting the certificate and the entity will not know the actual details of the name.  (The association would be set up by the operator at the time the shared secret was generated by the RA.) </p>
<p id="rfc.section.2.5.p.5">When this control is placed in a message, it is RECOMMENDED that the Control Processed control be placed in the body sequence as well.  Using the explicit new control, rather than implicitly relying on the Control Processed control is important due to the need to explicitly know which identity proofs have been performed.  The new control also allows an RA to state that out-of-band identity proofs have been performed.  </p>
<p id="rfc.section.2.5.p.6">When the identity proof is performed by an RA, the RA also needs to validate the linking between the identity proof and the name information wrapped inside of the key proof-of-possession.  </p>
<h1 id="rfc.section.2.6">
<a href="#rfc.section.2.6">2.6.</a> New Section 6.21 Response Body Control</h1>
<p id="rfc.section.2.6.p.1">This item is to be added to the table in section 6.</p>
<p id="rfc.section.2.6.p.2">The Response Body Control is designed for an RA to inform an EE that there is an embedded response message that needs to be processed as part of the processing of this message.  This control is designed to be used in a couple of different cases where an RA has done some additional processing on the certificate request such as key generation and needs to respond with both the original response message from the certificate issuer as well as in the response the RA is generating.  Another case where this is useful is when the shared secret is between the RA and the EE (rather than between the CA and the EE) and the RA needs to return a Publish Trust Anchors control in order to populate the correct trust points.</p>
<p id="rfc.section.2.6.p.3">The relevant ASN.1 for the Response Body Control is as follows:</p>
<div id="#rfc.figure.2"></div>
<pre>
  cmc-responseBody CMC-CONTROL ::= {
     BodyPartPath IDENTIFIED BY id-cmc-responseBody
  }

  id-cmc-responseBody OBJECT IDENTIFIER ::= {id-cmc TBD}
</pre>
<p id="rfc.section.2.6.p.4">The above ASN.1 defines the following items: </p>

<dl>
<dt>cmc-responseBody</dt>
<dd style="margin-left: 8">is a CMC-CONTROL associating the object identifier id-cmc-responseBody with the type BodyPartPath.  This object is omitted from the 1988 module.  The object is added to the object set Cmc-Control-Set.  The control is only permitted to occur in the control sequence of a PKIResponse.  The control is not permitted to occur in the control sequence of a PKIData.  It is only expected that an intermediary RA will use this control; a CA generally does not need the control as it is creating the original innermost message.</dd>
<dt>id-cmc-responseBody</dt>
<dd style="margin-left: 8">is the object identifier used to identify this CMC control.</dd>
<dt>BodyPartPath</dt>
<dd style="margin-left: 8">is the type structure associated with the control.  The syntax of BodyPartPath is defined in Section 3.2.2.  The path contains a sequence of body part identifiers leading to a cmsSequence item which contains a PKIResponse within it.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.7">
<a href="#rfc.section.2.7">2.7.</a> New Section 7. Other Attributes</h1>
<p id="rfc.section.2.7.p.1">This section is to be inserted before the current section 7.</p>
<p id="rfc.section.2.7.p.2">There are a number of different locations that various types of attributes can be placed in either a CMC request or a CMC response message.  These places include the attribute sequence of a PKCS #10 request, registration controls in CRMF and the various CMS attribute sequences.</p>
<h1 id="rfc.section.2.8">
<a href="#rfc.section.2.8">2.8.</a> New Section 7.1 Change Subject Name Attribute</h1>
<p id="rfc.section.2.8.p.1">The Client Name Change Request Attribute is designed for a client to ask for a change in its name as part of a certificate request.  This cannot be done in the simple way of just changing the requested subject name in the certificate template because of security issues.  The name in the certificate request needs to match the name in the certificate used to sign the request in order that identity and possession proofs are correctly applied.  </p>
<p id="rfc.section.2.8.p.2">The relevant ASN.1 for the Client Name Change Request attribute is as follows: </p>
<div id="#rfc.figure.3"></div>
<pre>
   at-cmc-changeSubjectName ATTRIBUTE ::=
      { ChangeSubjectName IDENTIFIED BY id-cmc-changeSubjectName }

   id-cmc-changeSubjectName OBJECT IDENTIFIER ::= {id-cmc TBD}

   ChangeSubjectName ::= SEQUENCE {
       subject             Name OPTIONAL,
       subjectAlt          SubjectAltName OPTIONAL
   }
   (WITH COMPONENTS {..., subject PRESENT} |
         COMPONENTS {..., subjectAlt PRESENT} )
        </pre>
<p id="rfc.section.2.8.p.3">The attribute is designed to be used as an ATTRIBUTE object.  As such the attribute is placed in one of the following two places: </p>

<ul class="empty">
<li>The attributes field in a CertificationRequest.</li>
<li>The controls field of a CertRequest for a CRMF certification request.</li>
</ul>

<p> </p>
<p id="rfc.section.2.8.p.4">The control is identified by the Object Identifier id-cmc-changeSubjectName.  </p>
<p id="rfc.section.2.8.p.5">The ASN.1 type associated with control is ChangeSubjectName.  The fields of the structure are configured as follows: </p>

<dl>
<dt>subject</dt>
<dd style="margin-left: 8">contains the requested subject name for the new certificate.</dd>
<dt>subjectAlt</dt>
<dd style="margin-left: 8">contains the requested subject alternative name for the new certificate.</dd>
</dl>

<p> </p>
<p id="rfc.section.2.8.p.6">At least one of the fields in the sequence MUST be present when encoding the structure.  </p>
<p id="rfc.section.2.8.p.7">When the CA processes this attribute in a certification request it will do the following: </p>

<ol>
<li>The subject field is copied to the name field of the template if present.  If the subject field is absent, the name field of the template will be set to a empty sequence.</li>
<li>The subjectAlt field is used as the content of a SubjectAltName extension in the certificate if present.  The subjectAltName extension is removed from the certificate template if the subjectAlt field is absent.</li>
</ol>

<p> </p>
<h1 id="rfc.section.2.9">
<a href="#rfc.section.2.9">2.9.</a> New Section 9. Certificate Requirements</h1>
<p id="rfc.section.2.9.p.1">This section is to be inserted before the current section 8.  </p>
<p id="rfc.section.2.9.p.2">Certificates for servers used in the CMC protocol SHOULD conform with the profile defined in <a href="#RFC5280">[RFC5280]</a>.  This document defines some additional items that can appear in CMC server certificates.  Section 9.1 defines some additional Extended Key Usage values that can appear in certificates.  Section 9.2 defines a new Subject Information Access value which allows for a CMC certificate to publish information on how to contact the services it provides.  </p>
<h1 id="rfc.section.2.10">
<a href="#rfc.section.2.10">2.10.</a> New Section 9.1. Extended Key Usage</h1>
<p id="rfc.section.2.10.p.1">The Extended Key Usage (EKU) extension is used to restrict the use of a certificate to specific applications.  We define three different EKUs in this document.  The ASN.1 to define these EKUs is: </p>
<div id="#rfc.figure.4"></div>
<pre>
   id-kp-cmcCA OBJECT IDENTIFIER ::= { id-kp TBD }
   id-kp-cmcRA OBJECT IDENTIFIER ::= { id-kp TBD }
   id-kp-cmcArchive OBJECT IDENTIFIER ::= { id-kp TBD }
        </pre>
<p id="rfc.section.2.10.p.2">The usage description for each of the EKUs is as follows: </p>

<dl>
<dt>CMC Certification Authorities</dt>
<dd style="margin-left: 8">are identified by the id-kp-cmcCA extended key usage.  The certificate may be the same as the CA certificate or may be different than the CA certificate.  If a different certificate is used, the certificates containing the id-kp-cmcCA extended key usage SHOULD have the same name as the certificate used for issuing the certificates.  (Using a separate key pair for CMC protocol operations and for issuing Certificates and CRLs decreases the number of operations for which the private key would be used.)</dd>
<dt>CMC Registration Authorities</dt>
<dd style="margin-left: 8">are identified by the id-kp-cmcRA extended key usage.  This usage is placed into RA certificates.</dd>
<dt>CMC Archive Servers</dt>
<dd style="margin-left: 8">are identified by the id-kp-cmcArchive extended key usage.  CMC Archive Servers and the associated protocol are to be defined in a future document.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.11">
<a href="#rfc.section.2.11">2.11.</a> New Section 9.2. Subject Information Access</h1>
<p id="rfc.section.2.11.p.1">The subject information access extension indicates how to access the information and services for the subject of the certificate.  We define a new value to go into this extension to identify the different locations that CMC services will be available.  If this value is placed in a certificate, an appropriate extended key usage defined in section 8.1 MUST be included in the certificate as well.  </p>
<p id="rfc.section.2.11.p.2">The id-ad-cmc OID is used when the subject offers certification services using the CMC Protocol.  Where the CMC services are available via HTTP or FTP, accessLocation MUST be a uniformResourceIdentifier.  Where the CMC services are available via electronic mail, accessLocation MUST be an rfc822Name.  Where CMC services are available using TCP/IP, the dNSName or iPAddress name forms MUST be used. Since the GeneralName data structure does not permit the inclusion of a port number, in the absence of other external configuration information, the value of TBD1 should be used.  The semantics of other name forms of accessLocation (when accessMethod is id-ad-cmc) are not defined by this specification.  </p>
<p id="rfc.section.2.11.p.3">The ASN.1 for this extension is:  GeneralName </p>
<p id="rfc.section.2.11.p.4">id-ad-cmc OBJECT IDENTIFIER ::= { id-ad TBD } </p>
<h1 id="rfc.section.2.12">
<a href="#rfc.section.2.12">2.12.</a> Updates Section 8. Security Considerations</h1>
<p id="rfc.section.2.12.p.1">The following paragraph is to be added to the end of section 8.</p>
<p id="rfc.section.2.12.p.2">A number of controls such as the RA Identity Proof Witness control exist for an RA to either make assertions about or modify a certificate request.  Care must be taken by any upstream request processor such as the CA that the RA is fully identified and authorized to make assertion or modification it is claiming.  If it is not identified or authorized then any request needs to be rejected.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Updates to RFC 5273 - Certificate Management over CMS (CMC): Transport Protocols</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Update to Section 5 TCP-Based Protocol</h1>
<p id="rfc.section.3.1.p.1">The following replaces paragraph 3 in section 5.</p>
<p id="rfc.section.3.1.p.2">CMC requires a registered port number to send and receive CMC messages over TCP.  The title of this IP Protocol number is "pkix-cmc".  The value of this TCP port is TBD1.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> New Section 6. IANA Considerations</h1>
<p id="rfc.section.3.2.p.1">This is a new section to be inserted before the current section 6.</p>
<div id="#rfc.figure.5"></div>
<pre>
     Keyword      Decimal   Description
     pkix-cmc     TBD1/tcp  PKIX Certificate Management using CMS (CMC)
</pre>
<p id="rfc.section.3.2.p.2">IANA is requested to assign a TCP port number in the Registered Port Number range for the use of CMC.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Updates to RFC 5274 - Certificate Management Message over CMS (CMC): Compliance Requirements</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Update to Section 4.2 Controls</h1>
<p id="rfc.section.4.1.p.1">The following lines should be added to the end of Table 1.  </p>
<div id="#rfc.table.2"></div>
<div id="#control_table"></div>
<p>The following table lists the name and level of support required for each control.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>CMC Control Attributes</caption>
<thead><tr>
<th class="left">Control</th>
<th class="left">EE</th>
<th class="left">RA</th>
<th class="left">CA</th>
</tr></thead>
<tbody>
<tr>
<td class="left">RaIdentityWitness</td>
<td class="left">N/A</td>
<td class="left">MUST</td>
<td class="left">(2)</td>
</tr>
<tr>
<td class="left">id-cmc-responseBody</td>
<td class="left">(6)</td>
<td class="left">(6)</td>
<td class="left">N/A</td>
</tr>
</tbody>
</table>
<p id="rfc.section.4.1.p.2">New Note #6</p>
<p id="rfc.section.4.1.p.3">6.  EE's SHOULD implement if designed to work with RAs and MUST implement if intended to be used in enviroments where RAs are used for identity validation or key generation.  RAs SHOULD implement for checking responses back for consistency.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> IANA Considerations</h1>
<p id="rfc.section.5.p.1">This document contains a new IANA considerations section to be added to <a href="#RFC5273">[RFC5273]</a> as part of this update. </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Security Considerations</h1>
<p id="rfc.section.6.p.1">No changes are made to the existing security considerations of RFC 5273 and RFC 5274.  The security considerations for RFC 5272 have been slightly modified (section 2.12).</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5272">[RFC5272]</b></td>
<td class="top">
<a>Schaad, J.</a> and <a>M. Myers</a>, "<a href="http://tools.ietf.org/html/rfc5272">Certificate Management over CMS (CMC)</a>", RFC 5272, June 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5273">[RFC5273]</b></td>
<td class="top">
<a>Schaad, J.</a> and <a>M. Myers</a>, "<a href="http://tools.ietf.org/html/rfc5273">Certificate Management over CMS (CMC): Transport Protocols</a>", RFC 5273, June 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5274">[RFC5274]</b></td>
<td class="top">
<a>Schaad, J.</a> and <a>M. Myers</a>, "<a href="http://tools.ietf.org/html/rfc5274">Certificate Management Messages over CMS (CMC): Compliance Requirements</a>", RFC 5274, June 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informational References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="CMS">[CMS]</b></td>
<td class="top">
<a>Housley, R.</a>, "<a href="http://tools.ietf.org/html/rfc5652">Cryptographic Message Syntax (CMS)</a>", RFC 5652, September 2009.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.turner-suiteb-cmc">[I-D.turner-suiteb-cmc]</b></td>
<td class="top">
<a>Zieglar, L</a>, <a>Peck, M</a> and <a>S Turner</a>, "<a href="http://tools.ietf.org/html/draft-turner-suiteb-cmc-03">Suite B Profile of Certificate Management over CMS</a>", Internet-Draft draft-turner-suiteb-cmc-03, June 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4211">[RFC4211]</b></td>
<td class="top">
<a>Schaad, J.</a>, "<a href="http://tools.ietf.org/html/rfc4211">Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)</a>", RFC 4211, September 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5912">[RFC5912]</b></td>
<td class="top">
<a>Hoffman, P.</a> and <a>J. Schaad</a>, "<a href="http://tools.ietf.org/html/rfc5912">New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)</a>", RFC 5912, June 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> ASN.1 Modules</h1>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> 1988 ASN.1 Module</h1>
<p id="rfc.section.Appendix A.1.p.1">This section contains the updated ASN.1 module for <a href="#RFC5272">[RFC5272]</a>.  This module replaces the module in Appendix A.  Although a 2008 ASN.1 Module is provided, this remains the normative module as per the policy of the PKIX working group.</p>
<div id="#rfc.figure.6"></div>
<pre>
EnrollmentMessageSyntax
 { iso(1) identified-organization(3) dod(4) internet(1)
   security(5) mechansims(5) pkix(7) id-mod(0) id-mod-cmc2011(TBD50) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

 -- EXPORTS All --
 -- The types and values defined in this module are exported for use
 -- in the other ASN.1 modules.  Other applications may use them for
 -- their own purposes.

 IMPORTS

   -- PKIX Part 1 - Implicit    From [RFC5280]
      GeneralName, CRLReason, ReasonFlags, GeneralNames
      FROM PKIX1Implicit88 {iso(1) identified-organization(3) dod(6)
              internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
              id-pkix1-implicit(19)}

   -- PKIX Part 1 - Explicit    From [RFC5280]
      AlgorithmIdentifier, Extension, Name, CertificateSerialNumber,
      id-ad, id-kp
      FROM PKIX1Explicit88 {iso(1) identified-organization(3) dod(6)
              internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
              id-pkix1-explicit(18)}

   -- Cryptographic Message Syntax   FROM [CMS]
      ContentInfo, Attribute, IssuerAndSerialNumber
        FROM CryptographicMessageSyntax2004 { iso(1) member-body(2)
             us(840) rsadsi(113549) pkcs(1) pkcs-9(9) smime(16)
             modules(0) cms-2004(24)}

 -- CRMF                         FROM [RFC4211]
    CertReqMsg, PKIPublicationInfo, CertTemplate
    FROM PKIXCRMF-2005 {iso(1) identified-organization(3) dod(6)
           internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
           id-mod-crmf2005(36)};

   -- Global Types
      -- UTF8String ::= [UNIVERSAL 12] IMPLICIT OCTET STRING
        -- The content of this type conforms to RFC 2279.

  id-pkix OBJECT IDENTIFIER  ::= { iso(1) identified-organization(3)
      dod(6) internet(1) security(5) mechanisms(5) pkix(7) }

 id-cmc OBJECT IDENTIFIER ::= {id-pkix 7}   -- CMC controls
 id-cct OBJECT IDENTIFIER ::= {id-pkix 12}  -- CMC content types

 -- The following controls have the type OCTET STRING

 id-cmc-identityProof OBJECT IDENTIFIER ::= {id-cmc 3}
 id-cmc-dataReturn OBJECT IDENTIFIER ::= {id-cmc 4}
 id-cmc-regInfo OBJECT IDENTIFIER ::= {id-cmc 18}
 id-cmc-responseInfo OBJECT IDENTIFIER ::= {id-cmc 19}
 id-cmc-queryPending OBJECT IDENTIFIER ::= {id-cmc 21}
 id-cmc-popLinkRandom OBJECT IDENTIFIER ::= {id-cmc 22}
 id-cmc-popLinkWitness OBJECT IDENTIFIER ::= {id-cmc 23}

 -- The following controls have the type UTF8String

 id-cmc-identification OBJECT IDENTIFIER ::= {id-cmc 2}

 -- The following controls have the type INTEGER

 id-cmc-transactionId OBJECT IDENTIFIER ::= {id-cmc 5}

 -- The following controls have the type OCTET STRING

 id-cmc-senderNonce OBJECT IDENTIFIER ::= {id-cmc 6}
 id-cmc-recipientNonce OBJECT IDENTIFIER ::= {id-cmc 7}

 -- This is the content type used for a request message in the protocol

 id-cct-PKIData OBJECT IDENTIFIER ::= { id-cct 2 }

 PKIData ::= SEQUENCE {
     controlSequence    SEQUENCE SIZE(0..MAX) OF TaggedAttribute,
     reqSequence        SEQUENCE SIZE(0..MAX) OF TaggedRequest,
     cmsSequence        SEQUENCE SIZE(0..MAX) OF TaggedContentInfo,
     otherMsgSequence   SEQUENCE SIZE(0..MAX) OF OtherMsg
 }

  bodyIdMax INTEGER ::= 4294967295

  BodyPartID ::= INTEGER(0..bodyIdMax)

 TaggedAttribute ::= SEQUENCE {
     bodyPartID         BodyPartID,
     attrType           OBJECT IDENTIFIER,
     attrValues         SET OF AttributeValue
 }

  AttributeValue ::= ANY

  TaggedRequest ::= CHOICE {
      tcr               [0] TaggedCertificationRequest,
      crm               [1] CertReqMsg,
      orm               [2] SEQUENCE {
          bodyPartID            BodyPartID,
          requestMessageType    OBJECT IDENTIFIER,
          requestMessageValue   ANY DEFINED BY requestMessageType
      }
  }

  TaggedCertificationRequest ::= SEQUENCE {
      bodyPartID            BodyPartID,
      certificationRequest  CertificationRequest
  }

  CertificationRequest ::= SEQUENCE {
    certificationRequestInfo  SEQUENCE {
      version                   INTEGER,
      subject                   Name,
      subjectPublicKeyInfo      SEQUENCE {
        algorithm                 AlgorithmIdentifier,
        subjectPublicKey          BIT STRING },
      attributes                [0] IMPLICIT SET OF Attribute },
    signatureAlgorithm        AlgorithmIdentifier,
    signature                 BIT STRING
  }

 TaggedContentInfo ::= SEQUENCE {
     bodyPartID              BodyPartID,
     contentInfo             ContentInfo
 }

 OtherMsg ::= SEQUENCE {
     bodyPartID        BodyPartID,
     otherMsgType      OBJECT IDENTIFIER,
     otherMsgValue     ANY DEFINED BY otherMsgType }

 --  This defines the response message in the protocol
 id-cct-PKIResponse OBJECT IDENTIFIER ::= { id-cct 3 }

 ResponseBody ::= PKIResponse

 PKIResponse ::= SEQUENCE {
     controlSequence   SEQUENCE SIZE(0..MAX) OF TaggedAttribute,
     cmsSequence       SEQUENCE SIZE(0..MAX) OF TaggedContentInfo,
     otherMsgSequence  SEQUENCE SIZE(0..MAX) OF OtherMsg

 }

 -- Used to return status state in a response

 id-cmc-statusInfo OBJECT IDENTIFIER ::= {id-cmc 1}

 CMCStatusInfo ::= SEQUENCE {
     cMCStatus       CMCStatus,
     bodyList        SEQUENCE SIZE (1..MAX) OF BodyPartID,
     statusString    UTF8String OPTIONAL,
     otherInfo        CHOICE {
       failInfo         CMCFailInfo,
       pendInfo         PendInfo } OPTIONAL
 }

 PendInfo ::= SEQUENCE {
     pendToken        OCTET STRING,
     pendTime         GeneralizedTime
 }

 CMCStatus ::= INTEGER {
     success         (0),
     failed          (2),
     pending         (3),
     noSupport       (4),
     confirmRequired (5),
     popRequired     (6),
     partial                (7)
 }

 -- Note:
 -- The spelling of unsupportedExt is corrected in this version.
 -- In RFC 2797, it was unsuportedExt.

 CMCFailInfo ::= INTEGER {
     badAlg          (0),
     badMessageCheck (1),
     badRequest      (2),
     badTime         (3),
     badCertId       (4),
     unsupportedExt  (5),
     mustArchiveKeys (6),
     badIdentity     (7),
     popRequired     (8),
     popFailed       (9),
     noKeyReuse      (10),
     internalCAError (11),
     tryLater        (12),
     authDataFail    (13)
 }

 -- Used for RAs to add extensions to certification requests
 id-cmc-addExtensions OBJECT IDENTIFIER ::= {id-cmc 8}

 AddExtensions ::= SEQUENCE {
     pkiDataReference    BodyPartID,
     certReferences      SEQUENCE OF BodyPartID,
     extensions          SEQUENCE OF Extension
 }


 id-cmc-encryptedPOP OBJECT IDENTIFIER ::= {id-cmc 9}
 id-cmc-decryptedPOP OBJECT IDENTIFIER ::= {id-cmc 10}

 EncryptedPOP ::= SEQUENCE {
     request       TaggedRequest,
     cms             ContentInfo,
     thePOPAlgID     AlgorithmIdentifier,
     witnessAlgID    AlgorithmIdentifier,
     witness         OCTET STRING
 }

 DecryptedPOP ::= SEQUENCE {
     bodyPartID      BodyPartID,
     thePOPAlgID     AlgorithmIdentifier,
     thePOP          OCTET STRING
 }

  id-cmc-lraPOPWitness OBJECT IDENTIFIER ::= {id-cmc 11}

  LraPopWitness ::= SEQUENCE {
      pkiDataBodyid   BodyPartID,
      bodyIds         SEQUENCE OF BodyPartID
  }

 --
 id-cmc-getCert OBJECT IDENTIFIER ::= {id-cmc 15}

 GetCert ::= SEQUENCE {
     issuerName      GeneralName,
     serialNumber    INTEGER }

 id-cmc-getCRL OBJECT IDENTIFIER ::= {id-cmc 16}

 GetCRL ::= SEQUENCE {
     issuerName    Name,
     cRLName       GeneralName OPTIONAL,
     time          GeneralizedTime OPTIONAL,
     reasons       ReasonFlags OPTIONAL }

 id-cmc-revokeRequest OBJECT IDENTIFIER ::= {id-cmc 17}

 RevokeRequest ::= SEQUENCE {
     issuerName            Name,
     serialNumber          INTEGER,
     reason                CRLReason,
     invalidityDate         GeneralizedTime OPTIONAL,
     passphrase            OCTET STRING OPTIONAL,
     comment               UTF8String OPTIONAL }

 id-cmc-confirmCertAcceptance OBJECT IDENTIFIER ::= {id-cmc 24}

 CMCCertId ::= IssuerAndSerialNumber

 -- The following is used to request V3 extensions be added to a
 -- certificate

 id-ExtensionReq OBJECT IDENTIFIER ::= {iso(1) member-body(2) us(840)
      rsadsi(113549) pkcs(1) pkcs-9(9) 14}

 ExtensionReq ::= SEQUENCE SIZE (1..MAX) OF Extension

 -- The following exists to allow Diffie-Hellman Certification 
 -- Requests Messages to be well-formed

 id-alg-noSignature OBJECT IDENTIFIER ::= {id-pkix id-alg(6) 2}

 NoSignatureValue ::= OCTET STRING

 --  Unauthenticated attribute to carry removable data.
 --    This could be used in an update of "CMC Extensions: Server Side
 --    Key Generation and Key Escrow" (February 2005) and in other
 --    documents.

 id-aa OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840)
       rsadsi(113549) pkcs(1) pkcs-9(9) smime(16) id-aa(2)}
 id-aa-cmc-unsignedData OBJECT IDENTIFIER ::= {id-aa 34}

 CMCUnsignedData ::= SEQUENCE {
     bodyPartPath        BodyPartPath,
     identifier          OBJECT IDENTIFIER,
     content             ANY DEFINED BY identifier
 }

 --  Replaces CMC Status Info
 --

 id-cmc-statusInfoV2 OBJECT IDENTIFIER ::= {id-cmc 25}

 CMCStatusInfoV2 ::= SEQUENCE {
    cMCStatus             CMCStatus,
    bodyList              SEQUENCE SIZE (1..MAX) OF
                                   BodyPartReference,
    statusString          UTF8String OPTIONAL,
    otherInfo             CHOICE {
      failInfo               CMCFailInfo,
      pendInfo               PendInfo,
      extendedFailInfo       SEQUENCE {
         failInfoOID            OBJECT IDENTIFIER,
         failInfoValue          AttributeValue
      }
    } OPTIONAL
 }

 BodyPartReference ::= CHOICE {
    bodyPartID           BodyPartID,
    bodyPartPath         BodyPartPath
 }

 BodyPartPath ::= SEQUENCE SIZE (1..MAX) OF BodyPartID

 --  Allow for distribution of trust anchors
 --

 id-cmc-trustedAnchors OBJECT IDENTIFIER ::= {id-cmc 26}

 PublishTrustAnchors ::= SEQUENCE {
     seqNumber      INTEGER,
     hashAlgorithm  AlgorithmIdentifier,
     anchorHashes     SEQUENCE OF OCTET STRING
 }

 id-cmc-authData OBJECT IDENTIFIER ::= {id-cmc 27}

 AuthPublish ::= BodyPartID

 --   These two items use BodyPartList
 id-cmc-batchRequests OBJECT IDENTIFIER ::= {id-cmc 28}
 id-cmc-batchResponses OBJECT IDENTIFIER ::= {id-cmc 29}

 BodyPartList ::= SEQUENCE SIZE (1..MAX) OF BodyPartID

 --
 id-cmc-publishCert OBJECT IDENTIFIER ::= {id-cmc 30}

 CMCPublicationInfo ::= SEQUENCE {
     hashAlg                      AlgorithmIdentifier,
     certHashes                   SEQUENCE OF OCTET STRING,
     pubInfo                          PKIPublicationInfo
 }

 id-cmc-modCertTemplate OBJECT IDENTIFIER ::= {id-cmc 31}

 ModCertTemplate ::= SEQUENCE {
     pkiDataReference             BodyPartPath,
     certReferences               BodyPartList,
     replace                      BOOLEAN DEFAULT TRUE,
     certTemplate                 CertTemplate
 }

 -- Inform follow on servers that one or more controls have already 
 -- been processed

 id-cmc-controlProcessed OBJECT IDENTIFIER ::= {id-cmc 32}

 ControlsProcessed ::= SEQUENCE {
     bodyList              SEQUENCE SIZE(1..MAX) OF BodyPartReference
 }

 --  Identity Proof control w/ algorithm agility

 id-cmc-identityProofV2 OBJECT IDENTIFIER ::= { id-cmc 34 }

 IdentifyProofV2 ::= SEQUENCE {
     proofAlgID       AlgorithmIdentifier,
     macAlgId         AlgorithmIdentifier,
     witness          OCTET STRING
 }

 id-cmc-popLinkWitnessV2 OBJECT IDENTIFIER ::= { id-cmc 33 }
 PopLinkWitnessV2 ::= SEQUENCE {
     keyGenAlgorithm   AlgorithmIdentifier,
     macAlgorithm      AlgorithmIdentifier,
     witness           OCTET STRING
 }

 --

 id-cmc-raIdentityWitness OBJECT IDENTIFIER ::= {id-cmc TBD42}


 --
 --  Allow for an End-Entity to request a change in name
 --  This item is added to RegControlSet in CRMF
 --

 id-cmc-changeSubjectName OBJECT IDENTIFIER ::= {id-cmc TBD43}

 ChangeSubjectName ::= SEQUENCE {
     subject             Name OPTIONAL,
     subjectAlt          GeneralNames OPTIONAL
 }
 -- (WITH COMPONENTS {..., subject PRESENT} |
 --  WITH COMPONENTS {..., subjectAlt PRESENT} )

 --
 --  Key purpose identifiers are in the extended key usage extension
 -- 

 id-kp-cmcCA OBJECT IDENTIFIER ::= { id-kp TBD44 }
 id-kp-cmcRA OBJECT IDENTIFIER ::= { id-kp TBD45 }
 id-kp-cmcArchive OBJECT IDENTIFIER ::= { id-kp TBD46 }

 --
 --  Subject Information Access identifier
 --

 id-ad-cmc OBJECT IDENTIFIER ::= { id-ad TBD47 }

END
</pre>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> 2008 ASN.1 Module</h1>
<p id="rfc.section.Appendix A.2.p.1">An updated 2009 ASN.1 module has been provided as part of this update.  The module contains changes that were made as part of the re-write to current ASN.1 standards in <a href="#RFC5912">[RFC5912]</a> as well as the changes for this document.  </p>
<div id="#rfc.figure.7"></div>
<pre>
  EnrollmentMessageSyntax-2009
      {iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechansims(5) pkix(7) id-mod(0) 
      id-mod-cmc2002-02(TBD49)}
  DEFINITIONS IMPLICIT TAGS ::=
  BEGIN
  EXPORTS ALL;
  IMPORTS

  AttributeSet{}, Extension{}, EXTENSION, ATTRIBUTE
  FROM PKIX-CommonTypes-2009
      {iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-pkixCommon-02(57)}

  AlgorithmIdentifier{}, DIGEST-ALGORITHM, KEY-WRAP, KEY-DERIVATION,
      MAC-ALGORITHM, SIGNATURE-ALGORITHM, PUBLIC-KEY
  FROM AlgorithmInformation-2009
      {iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0)
      id-mod-algorithmInformation-02(58)}

  CertificateSerialNumber, GeneralName, CRLReason, ReasonFlags,
      CertExtensions, GeneralNames
  FROM PKIX1Implicit-2009
      {iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-implicit-02(59)}

  Name, id-pkix, PublicKeyAlgorithms, SignatureAlgorithms, id-ad, id-kp
  FROM PKIX1Explicit-2009
      {iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-explicit-02(51)}

  ContentInfo, IssuerAndSerialNumber, CONTENT-TYPE
  FROM CryptographicMessageSyntax-2009
    { iso(1) member-body(2) us(840) rsadsi(113549)
       pkcs(1) pkcs-9(9) smime(16) modules(0) id-mod-cms-2009(58) }

  CertReqMsg, PKIPublicationInfo, CertTemplate
  FROM PKIXCRMF-2009
      {iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-crmf2005-02(55)}

  mda-sha1
  FROM PKIXAlgs-2009
       { iso(1) identified-organization(3) dod(6)
       internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
       id-mod-pkix1-algorithms2008-02(56)}

  kda-PBKDF2, maca-hMAC-SHA1
  FROM CryptographicMessageSyntaxAlgorithms-2009
      { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
      smime(16) modules(0) id-mod-cmsalg-2001-02(37) }

  mda-sha256
  FROM PKIX1-PSS-OAEP-Algorithms-2009
       { iso(1) identified-organization(3) dod(6)
         internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
         id-mod-pkix1-rsa-pkalgs-02(54) } ;

  --  CMS Content types defined in this document

  CMC-ContentTypes CONTENT-TYPE ::= { ct-PKIData | ct-PKIResponse, ... }

  --  Signature Algorithms defined in this document

  SignatureAlgs SIGNATURE-ALGORITHM ::= { sa-noSignature }

  --  CMS Unsigned Attributes

  CMC-UnsignedAtts ATTRIBUTE ::= { aa-cmc-unsignedData }

  --
  --

  id-cmc OBJECT IDENTIFIER ::= {id-pkix 7}   -- CMC controls
  id-cct OBJECT IDENTIFIER ::= {id-pkix 12}  -- CMC content types

  -- This is the content type for a request message in the protocol

  ct-PKIData CONTENT-TYPE ::=
      { TYPE PKIData IDENTIFIED BY id-cct-PKIData }
  id-cct-PKIData OBJECT IDENTIFIER ::= { id-cct 2 }

  PKIData ::= SEQUENCE {
      controlSequence    SEQUENCE SIZE(0..MAX) OF TaggedAttribute,
      reqSequence        SEQUENCE SIZE(0..MAX) OF TaggedRequest,
      cmsSequence        SEQUENCE SIZE(0..MAX) OF TaggedContentInfo,
      otherMsgSequence   SEQUENCE SIZE(0..MAX) OF OtherMsg
  }

  BodyPartID ::= INTEGER(0..4294967295)

  TaggedAttribute ::= SEQUENCE {
      bodyPartID         BodyPartID,
      attrType           CMC-CONTROL.&amp;id({Cmc-Control-Set}),
      attrValues         SET OF CMC-CONTROL.
                             &amp;Type({Cmc-Control-Set}{@attrType})
  }

  Cmc-Control-Set CMC-CONTROL ::= {
      cmc-identityProof | cmc-dataReturn | cmc-regInfo |
      cmc-responseInfo | cmc-queryPending | cmc-popLinkRandom |
      cmc-popLinkWitness | cmc-identification | cmc-transactionId |
      cmc-senderNonce | cmc-recipientNonce | cmc-statusInfo |
      cmc-addExtensions | cmc-encryptedPOP | cmc-decryptedPOP |
      cmc-lraPOPWitness | cmc-getCert | cmc-getCRL |
      cmc-revokeRequest | cmc-confirmCertAcceptance |
      cmc-statusInfoV2 | cmc-trustedAnchors | cmc-authData |
      cmc-batchRequests | cmc-batchResponses | cmc-publishCert |
      cmc-modCertTemplate | cmc-controlProcessed |
      cmc-identityProofV2 | cmc-popLinkWitnessV2, ...,
      cmc-raIdentityWitness }

  OTHER-REQUEST ::= TYPE-IDENTIFIER

  --  We do not define any other requests in this document
  --     examples might be attribute certification requests

  OtherRequests OTHER-REQUEST ::= {...}

  TaggedRequest ::= CHOICE {
      tcr               [0] TaggedCertificationRequest,
      crm               [1] CertReqMsg,
      orm               [2] SEQUENCE {
          bodyPartID            BodyPartID,
          requestMessageType    OTHER-REQUEST.&amp;id({OtherRequests}),
          requestMessageValue   OTHER-REQUEST.&amp;Type({OtherRequests}
                                    {@.requestMessageType})
      }
  }

  TaggedCertificationRequest ::= SEQUENCE {
      bodyPartID            BodyPartID,
      certificationRequest  CertificationRequest
  }

  AttributeList ATTRIBUTE ::= {at-extension-req, ...,
      at-cmc-changeSubjectName}

  CertificationRequest ::= SEQUENCE {
     certificationRequestInfo  SEQUENCE {
         version                   INTEGER,
         subject                   Name,
         subjectPublicKeyInfo      SEQUENCE {
             algorithm                 AlgorithmIdentifier{PUBLIC-KEY,
                                           {PublicKeyAlgorithms}},
             subjectPublicKey          BIT STRING
         },
         attributes                [0] IMPLICIT SET OF
                                       AttributeSet{{AttributeList}}
      },
      signatureAlgorithm        AlgorithmIdentifier
                                    {SIGNATURE-ALGORITHM,
                                        {SignatureAlgorithms}},
      signature                 BIT STRING
  }

  TaggedContentInfo ::= SEQUENCE {
      bodyPartID              BodyPartID,
      contentInfo             ContentInfo
  }

  OTHER-MSG ::= TYPE-IDENTIFIER

  --  No other messages currently defined

  OtherMsgSet OTHER-MSG ::= {...}

  OtherMsg ::= SEQUENCE {
      bodyPartID        BodyPartID,
      otherMsgType      OTHER-MSG.&amp;id({OtherMsgSet}),
      otherMsgValue     OTHER-MSG.&amp;Type({OtherMsgSet}{@otherMsgType}) }

  --  This defines the response message in the protocol

  ct-PKIResponse CONTENT-TYPE ::=
      { TYPE PKIResponse IDENTIFIED BY id-cct-PKIResponse }
  id-cct-PKIResponse OBJECT IDENTIFIER ::= { id-cct 3 }

  ResponseBody ::= PKIResponse

  PKIResponse ::= SEQUENCE {
      controlSequence   SEQUENCE SIZE(0..MAX) OF TaggedAttribute,
      cmsSequence       SEQUENCE SIZE(0..MAX) OF TaggedContentInfo,
      otherMsgSequence  SEQUENCE SIZE(0..MAX) OF OtherMsg
  }

  CMC-CONTROL ::= TYPE-IDENTIFIER

  -- The following controls have the type OCTET STRING

  cmc-identityProof CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-identityProof }
  id-cmc-identityProof OBJECT IDENTIFIER ::= {id-cmc 3}

  cmc-dataReturn CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-dataReturn }
  id-cmc-dataReturn OBJECT IDENTIFIER ::= {id-cmc 4}

  cmc-regInfo CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-regInfo }
  id-cmc-regInfo OBJECT IDENTIFIER ::= {id-cmc 18}

  cmc-responseInfo CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-responseInfo }
  id-cmc-responseInfo OBJECT IDENTIFIER ::= {id-cmc 19}

  cmc-queryPending CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-queryPending }
  id-cmc-queryPending OBJECT IDENTIFIER ::= {id-cmc 21}

  cmc-popLinkRandom CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-popLinkRandom }
  id-cmc-popLinkRandom OBJECT IDENTIFIER ::= {id-cmc 22}

  cmc-popLinkWitness CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-popLinkWitness }
  id-cmc-popLinkWitness OBJECT IDENTIFIER ::= {id-cmc 23}

  -- The following controls have the type UTF8String

  cmc-identification CMC-CONTROL ::=
      { UTF8String IDENTIFIED BY id-cmc-identification }
  id-cmc-identification OBJECT IDENTIFIER ::= {id-cmc 2}

  -- The following controls have the type INTEGER

  cmc-transactionId CMC-CONTROL ::=
      { INTEGER IDENTIFIED BY id-cmc-transactionId }
  id-cmc-transactionId OBJECT IDENTIFIER ::= {id-cmc 5}

  -- The following controls have the type OCTET STRING

  cmc-senderNonce CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-senderNonce }
  id-cmc-senderNonce OBJECT IDENTIFIER ::= {id-cmc 6}

  cmc-recipientNonce CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-recipientNonce }
  id-cmc-recipientNonce OBJECT IDENTIFIER ::= {id-cmc 7}

  -- Used to return status in a response

  cmc-statusInfo CMC-CONTROL ::=
      { CMCStatusInfo IDENTIFIED BY id-cmc-statusInfo }
  id-cmc-statusInfo OBJECT IDENTIFIER ::= {id-cmc 1}

  CMCStatusInfo ::= SEQUENCE {
      cMCStatus       CMCStatus,
      bodyList        SEQUENCE SIZE (1..MAX) OF BodyPartID,
      statusString    UTF8String OPTIONAL,
      otherInfo       CHOICE {
         failInfo         CMCFailInfo,
         pendInfo         PendInfo
      } OPTIONAL
  }

  PendInfo ::= SEQUENCE {
      pendToken        OCTET STRING,
      pendTime         GeneralizedTime
  }

  CMCStatus ::= INTEGER {
      success         (0),
      failed          (2),
      pending         (3),
      noSupport       (4),
      confirmRequired (5),
      popRequired     (6),
      partial         (7)
  }

  CMCFailInfo ::= INTEGER {
      badAlg          (0),
      badMessageCheck (1),
      badRequest      (2),
      badTime         (3),
      badCertId       (4),
      unsuportedExt   (5),
      mustArchiveKeys (6),
      badIdentity     (7),
      popRequired     (8),
      popFailed       (9),
      noKeyReuse      (10),
      internalCAError (11),
      tryLater        (12),
      authDataFail    (13)
  }

  -- Used for RAs to add extensions to certification requests

  cmc-addExtensions CMC-CONTROL ::=
      { AddExtensions IDENTIFIED BY id-cmc-addExtensions }
  id-cmc-addExtensions OBJECT IDENTIFIER ::= {id-cmc 8}

  AddExtensions ::= SEQUENCE {
      pkiDataReference    BodyPartID,
      certReferences      SEQUENCE OF BodyPartID,
      extensions          SEQUENCE OF Extension{{CertExtensions}}
  }

  cmc-encryptedPOP CMC-CONTROL ::=
      { EncryptedPOP IDENTIFIED BY id-cmc-encryptedPOP }
  cmc-decryptedPOP CMC-CONTROL ::=
      { DecryptedPOP IDENTIFIED BY id-cmc-decryptedPOP }
  id-cmc-encryptedPOP OBJECT IDENTIFIER ::= {id-cmc 9}
  id-cmc-decryptedPOP OBJECT IDENTIFIER ::= {id-cmc 10}

  EncryptedPOP ::= SEQUENCE {
      request       TaggedRequest,
      cms             ContentInfo,
      thePOPAlgID     AlgorithmIdentifier{MAC-ALGORITHM, {POPAlgs}},
      witnessAlgID    AlgorithmIdentifier{DIGEST-ALGORITHM,
                          {WitnessAlgs}},
      witness         OCTET STRING
  }

  POPAlgs MAC-ALGORITHM ::= {maca-hMAC-SHA1, ...}
  WitnessAlgs DIGEST-ALGORITHM ::= {mda-sha1, ...}

  DecryptedPOP ::= SEQUENCE {
      bodyPartID      BodyPartID,
      thePOPAlgID     AlgorithmIdentifier{MAC-ALGORITHM, {POPAlgs}},
      thePOP          OCTET STRING
  }

  cmc-lraPOPWitness CMC-CONTROL ::=
      { LraPopWitness IDENTIFIED BY id-cmc-lraPOPWitness }

  id-cmc-lraPOPWitness OBJECT IDENTIFIER ::= {id-cmc 11}

  LraPopWitness ::= SEQUENCE {
      pkiDataBodyid   BodyPartID,
      bodyIds         SEQUENCE OF BodyPartID
  }

  --

  cmc-getCert CMC-CONTROL ::=
      { GetCert IDENTIFIED BY id-cmc-getCert }
  id-cmc-getCert OBJECT IDENTIFIER ::= {id-cmc 15}

  GetCert ::= SEQUENCE {
      issuerName      GeneralName,
      serialNumber    INTEGER }


  cmc-getCRL CMC-CONTROL ::=
      { GetCRL IDENTIFIED BY id-cmc-getCRL }
  id-cmc-getCRL OBJECT IDENTIFIER ::= {id-cmc 16}

  GetCRL ::= SEQUENCE {
      issuerName    Name,
      cRLName       GeneralName OPTIONAL,
      time          GeneralizedTime OPTIONAL,
      reasons       ReasonFlags OPTIONAL }

  cmc-revokeRequest CMC-CONTROL ::=
      { RevokeRequest IDENTIFIED BY id-cmc-revokeRequest}
  id-cmc-revokeRequest OBJECT IDENTIFIER ::= {id-cmc 17}

  RevokeRequest ::= SEQUENCE {
      issuerName            Name,
      serialNumber          INTEGER,
      reason                CRLReason,
      invalidityDate         GeneralizedTime OPTIONAL,
      passphrase            OCTET STRING OPTIONAL,
      comment               UTF8String OPTIONAL }


  cmc-confirmCertAcceptance CMC-CONTROL ::=
      { CMCCertId IDENTIFIED BY id-cmc-confirmCertAcceptance }
  id-cmc-confirmCertAcceptance OBJECT IDENTIFIER ::= {id-cmc 24}

  CMCCertId ::= IssuerAndSerialNumber

  -- The following is used to request V3 extensions be added
  --     to a certificate

  at-extension-req ATTRIBUTE ::=
      { TYPE ExtensionReq IDENTIFIED BY id-ExtensionReq }
  id-ExtensionReq OBJECT IDENTIFIER ::= {iso(1) member-body(2) us(840)
      rsadsi(113549) pkcs(1) pkcs-9(9) 14}

  ExtensionReq ::= SEQUENCE SIZE (1..MAX) OF
      Extension{{CertExtensions}}

  -- The following allows Diffie-Hellman Certification Request
  --     Messages to be well-formed

  sa-noSignature SIGNATURE-ALGORITHM ::= {
      IDENTIFIER id-alg-noSignature
      VALUE NoSignatureValue
      PARAMS TYPE NULL ARE required
      HASHES { mda-sha1 }
  }
  id-alg-noSignature OBJECT IDENTIFIER ::= {id-pkix id-alg(6) 2}

  NoSignatureValue ::= OCTET STRING

  --  Unauthenticated attribute to carry removable data.

  id-aa OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840)
      rsadsi(113549) pkcs(1) pkcs-9(9) smime(16) id-aa(2)}

  aa-cmc-unsignedData ATTRIBUTE ::=
      { TYPE CMCUnsignedData IDENTIFIED BY id-aa-cmc-unsignedData }
  id-aa-cmc-unsignedData OBJECT IDENTIFIER ::= {id-aa 34}

  CMCUnsignedData ::= SEQUENCE {
      bodyPartPath        BodyPartPath,
      identifier          TYPE-IDENTIFIER.&amp;id,
      content             TYPE-IDENTIFIER.&amp;Type
  }

  --  Replaces CMC Status Info
  --

  cmc-statusInfoV2 CMC-CONTROL ::=
      { CMCStatusInfoV2 IDENTIFIED BY id-cmc-statusInfoV2 }
  id-cmc-statusInfoV2 OBJECT IDENTIFIER ::= {id-cmc 25}


  EXTENDED-FAILURE-INFO ::= TYPE-IDENTIFIER

  ExtendedFailures EXTENDED-FAILURE-INFO ::= {...}

  CMCStatusInfoV2 ::= SEQUENCE {
     cMCStatus             CMCStatus,
     bodyList              SEQUENCE SIZE (1..MAX) OF
                                    BodyPartReference,
     statusString          UTF8String OPTIONAL,
     otherInfo             CHOICE {
         failInfo               CMCFailInfo,
         pendInfo               PendInfo,
         extendedFailInfo       [1] SEQUENCE {
            failInfoOID            TYPE-IDENTIFIER.&amp;id
                                       ({ExtendedFailures}),
            failInfoValue          TYPE-IDENTIFIER.&amp;Type
                                       ({ExtendedFailures}
                                           {@.failInfoOID})
         }
      } OPTIONAL
  }

  BodyPartReference ::= CHOICE {
     bodyPartID           BodyPartID,
     bodyPartPath         BodyPartPath
  }

  BodyPartPath ::= SEQUENCE SIZE (1..MAX) OF BodyPartID

  --  Allow for distribution of trust anchors
  --

  cmc-trustedAnchors CMC-CONTROL ::=
      { PublishTrustAnchors IDENTIFIED BY id-cmc-trustedAnchors }
  id-cmc-trustedAnchors OBJECT IDENTIFIER ::= {id-cmc 26}

  PublishTrustAnchors ::= SEQUENCE {
      seqNumber      INTEGER,
      hashAlgorithm  AlgorithmIdentifier{DIGEST-ALGORITHM,
                         {HashAlgorithms}},
      anchorHashes   SEQUENCE OF OCTET STRING
  }

  HashAlgorithms DIGEST-ALGORITHM ::= {
     mda-sha1 | mda-sha256, ...
  }

  cmc-authData CMC-CONTROL ::=
      { AuthPublish IDENTIFIED BY id-cmc-authData }
  id-cmc-authData OBJECT IDENTIFIER ::= {id-cmc 27}

  AuthPublish ::= BodyPartID

  --   These two items use BodyPartList

  cmc-batchRequests CMC-CONTROL ::=
      { BodyPartList IDENTIFIED BY id-cmc-batchRequests }
  id-cmc-batchRequests OBJECT IDENTIFIER ::= {id-cmc 28}

  cmc-batchResponses CMC-CONTROL ::=
      { BodyPartList IDENTIFIED BY id-cmc-batchResponses }
  id-cmc-batchResponses OBJECT IDENTIFIER ::= {id-cmc 29}

  BodyPartList ::= SEQUENCE SIZE (1..MAX) OF BodyPartID

  cmc-publishCert CMC-CONTROL ::=
      { CMCPublicationInfo IDENTIFIED BY id-cmc-publishCert }
  id-cmc-publishCert OBJECT IDENTIFIER ::= {id-cmc 30}

  CMCPublicationInfo ::= SEQUENCE {
      hashAlg        AlgorithmIdentifier{DIGEST-ALGORITHM,
                           {HashAlgorithms}},
      certHashes     SEQUENCE OF OCTET STRING,
      pubInfo        PKIPublicationInfo
  }

  cmc-modCertTemplate CMC-CONTROL ::=
      { ModCertTemplate IDENTIFIED BY id-cmc-modCertTemplate }

  id-cmc-modCertTemplate OBJECT IDENTIFIER ::= {id-cmc 31}

  ModCertTemplate ::= SEQUENCE {
      pkiDataReference             BodyPartPath,
      certReferences               BodyPartList,
      replace                      BOOLEAN DEFAULT TRUE,
      certTemplate                 CertTemplate
  }

  -- Inform follow-on servers that one or more controls have
  --     already been processed

  cmc-controlProcessed CMC-CONTROL ::=
      { ControlsProcessed IDENTIFIED BY id-cmc-controlProcessed }
  id-cmc-controlProcessed OBJECT IDENTIFIER ::= {id-cmc 32}

  ControlsProcessed ::= SEQUENCE {
      bodyList              SEQUENCE SIZE(1..MAX) OF BodyPartReference
  }

  --  Identity Proof control w/ algorithm agility

  cmc-identityProofV2 CMC-CONTROL ::=
      { IdentityProofV2 IDENTIFIED BY id-cmc-identityProofV2 }
  id-cmc-identityProofV2 OBJECT IDENTIFIER ::= { id-cmc 33 }

  IdentityProofV2 ::= SEQUENCE {
      proofAlgID       AlgorithmIdentifier{DIGEST-ALGORITHM,
                           {WitnessAlgs}},
      macAlgId         AlgorithmIdentifier{MAC-ALGORITHM, {POPAlgs}},
      witness          OCTET STRING
  }

  cmc-popLinkWitnessV2 CMC-CONTROL ::=
      { PopLinkWitnessV2 IDENTIFIED BY id-cmc-popLinkWitnessV2 }
  id-cmc-popLinkWitnessV2 OBJECT IDENTIFIER ::= { id-cmc 34 }

  PopLinkWitnessV2 ::= SEQUENCE {
      keyGenAlgorithm   AlgorithmIdentifier{KEY-DERIVATION,
                            {KeyDevAlgs}},
      macAlgorithm      AlgorithmIdentifier{MAC-ALGORITHM, {POPAlgs}},
      witness           OCTET STRING
  }

  KeyDevAlgs KEY-DERIVATION ::= {kda-PBKDF2, ...}

  cmc-raIdentityWitness CMC-CONTROL ::=
     { BodyPartPath IDENTIFIED BY id-cmc-raIdentityWitness }

  id-cmc-raIdentityWitness OBJECT IDENTIFIER ::= {id-cmc TBD42}


  --
  --  Allow for an End-Entity to request a change in name
  --  This item is added to RegControlSet in CRMF
  --
  at-cmc-changeSubjectName ATTRIBUTE ::=
     { TYPE ChangeSubjectName IDENTIFIED BY id-cmc-changeSubjectName }

  id-cmc-changeSubjectName OBJECT IDENTIFIER ::= {id-cmc TBD43}

  ChangeSubjectName ::= SEQUENCE {
      subject             Name OPTIONAL,
      subjectAlt          GeneralNames OPTIONAL
  }
  (WITH COMPONENTS {..., subject PRESENT} |
   WITH COMPONENTS {..., subjectAlt PRESENT} )

  --
  --  Key purpose identifiers are in the extended key usage extension
  -- 

  id-kp-cmcCA OBJECT IDENTIFIER ::= { id-kp TBD44 }
  id-kp-cmcRA OBJECT IDENTIFIER ::= { id-kp TBD45 }
  id-kp-cmcArchive OBJECT IDENTIFIER ::= { id-kp TBD46 }

  --
  --  Subject Information Access identifier
  --

  id-ad-cmc OBJECT IDENTIFIER ::= { id-ad TBD47 }

  END
</pre>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jim Schaad</span> 
	  <span class="n hidden">
		<span class="family-name">Schaad</span>
	  </span>
	</span>
	<span class="org vcardline">Soaring Hawk Consulting</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jimsch@augustcellars.com">jimsch@augustcellars.com</a></span>

  </address>
</div>

</body>
</html>