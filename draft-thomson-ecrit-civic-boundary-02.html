<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Describing Boundaries for Civic Addresses</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Describing Boundaries for Civic Addresses">
<meta name="keywords" content="Internet-Draft, Civic, Location, Address, Boundary">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">ECRIT</td><td class="header">M. Thomson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Andrew Corporation</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">K. Wolf</td></tr>
<tr><td class="header">Expires: August 5, 2011</td><td class="header">nic.at GmbH</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 1, 2011</td></tr>
</table></td></tr></table>
<h1><br />Describing Boundaries for Civic Addresses<br />draft-thomson-ecrit-civic-boundary-02</h1>

<h3>Abstract</h3>

<p>Algorithms for decision-making based on civic address inputs are described.  This includes an algorithm for determining whether one civic address is entirely contained within another.  Other algorithms and supplementary discussions relating to the use of civic addresses in describing boundaries are included.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on August 5, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#model">2.</a>&nbsp;
Civic Address Model<br />
<a href="#boundary">3.</a>&nbsp;
Civic Address Boundaries<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">3.1.</a>&nbsp;
Determining if an Address is Within a Boundary<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#algorithm">3.2.</a>&nbsp;
Algorithm Summary<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">3.3.</a>&nbsp;
False Negatives<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.4.</a>&nbsp;
False Positives<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.5.</a>&nbsp;
Address Boundary Limitations<br />
<a href="#anchor5">4.</a>&nbsp;
Boundary Combining Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.</a>&nbsp;
Boundary Unions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.</a>&nbsp;
Boundary Intersections<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.3.</a>&nbsp;
Avoiding False Positives<br />
<a href="#anchor9">5.</a>&nbsp;
Example<br />
<a href="#iana">6.</a>&nbsp;
IANA Considerations<br />
<a href="#security">7.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Civic address information (<a class='info' href='#RFC4776'>[RFC4776]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Option for Civic Addresses Configuration Information,&rdquo; November&nbsp;2006.</span><span>)</span></a>, <a class='info' href='#RFC5139'>[RFC5139]<span> (</span><span class='info'>Thomson, M. and J. Winterbottom, &ldquo;Revised Civic Location Format for Presence Information Data Format Location Object (PIDF-LO),&rdquo; February&nbsp;2008.</span><span>)</span></a>) can be used to describe the location of an entity in terms of the human-constructed environment.  This description can be be made more or less precise through the addition or removal of labels (respectively).
      
</p>
<p>A less precise civic address can be used to describe a zone or region by only including sufficient labels to identify the region.  This method is used in the <a class='info' href='#RFC5222'>Location-to-Service Translation (LoST) protocol<span> (</span><span class='info'>Hardie, T., Newton, A., Schulzrinne, H., and H. Tschofenig, &ldquo;LoST: A Location-to-Service Translation Protocol,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5222], to convey information to a client about the extents of a particular region where service is guaranteed to be consistent.
      
</p>
<p>This information, called a service boundary, allows a client to make decisions about civic addresses other than the one used to query.  If another civic address is determined to be "within" the service boundary, the client does not need to request service information from the LoST server.
      
</p>
<p>LoST does not provide a definition of "within" for civic addresses.  This document describes an algorithm that provides a definition for whether a civic address is contained within another address.
      
</p>
<p>Other operations on civic addresses are described, allowing client software to make decisions about the intersection and union of two civic addresses.
      
</p>
<a name="model"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Civic Address Model</h3>

<p>The simplest model of a civic address is that which considers it as an unordered set of labels.  Each label is assigned zero or more values; each value has an associated language (and script).
      
</p>
<p>The format in <a class='info' href='#RFC4776'>RFC 4776<span> (</span><span class='info'>Schulzrinne, H., &ldquo;Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Option for Civic Addresses Configuration Information,&rdquo; November&nbsp;2006.</span><span>)</span></a> [RFC4776] allows for values to be given to labels with different languages or scripts.  No special considerations apply in applying this model.
      
</p>
<p>The format in <a class='info' href='#RFC5139'>RFC 5139<span> (</span><span class='info'>Thomson, M. and J. Winterbottom, &ldquo;Revised Civic Location Format for Presence Information Data Format Location Object (PIDF-LO),&rdquo; February&nbsp;2008.</span><span>)</span></a> [RFC5139] uses multiple <tt>civicAddress</tt> elements to form a single address if labels are provided in multiple languages.  Thus, when extracting address information from a <a class='info' href='#RFC4119'>PIDF-LO<span> (</span><span class='info'>Peterson, J., &ldquo;A Presence-based GEOPRIV Location Object Format,&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4119] document, a civic address in this model is formed from all <tt>civicAddress</tt> elements in the same tuple.
      
</p>
<p>A civic address describes a series of spatial partitions or regions.  Every address includes an implied partition that identifies the habited portion of the Earth.  Every label with a value describes a partition of space at a specific scale.  The intersection of the spaces described by all the included labels is the resulting location.
      
</p>
<p>The algorithm described in this document relies on the following rule:
      </p>
<blockquote class="text">
<p>The location described by a set of civic address labels is entirely contained within the location described by any subset of those labels.
        
</p>
</blockquote><p>
      
</p>
<p>The following characteristics of civic addresses have no bearing on the algorithms described:
      </p>
<ol class="text">
<li>The civic address formats of <a class='info' href='#RFC4776'>[RFC4776]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Option for Civic Addresses Configuration Information,&rdquo; November&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#RFC5139'>[RFC5139]<span> (</span><span class='info'>Thomson, M. and J. Winterbottom, &ldquo;Revised Civic Location Format for Presence Information Data Format Location Object (PIDF-LO),&rdquo; February&nbsp;2008.</span><span>)</span></a> include a limited set of hierarchical elements.  The <tt>country</tt> and <tt>A1</tt> through <tt>A6</tt> labels follow a strict hierarchy.  The algorithms described do not rely on this hierarchy.
        
</li>
<li>The physical region described by a civic address is not necessarily contiguous.  For instance, an address might omit a thoroughfare name, but include a house number of 23.  Such an address identifies every house at number 23 within the area described by other labels.
        
</li>
</ol><p>
      
</p>
<p>More sophisticated models and algorithms are possible in the presence of additional information about the address data.  If this sort of information is present, many more options are available for processing addresses.  The simple algorithms in this document operate on the address information only, but do not preclude use of outside information.
      
</p>
<a name="boundary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Civic Address Boundaries</h3>

<p>A civic address boundary has the same format as a civic address.
      
</p>
<p>A civic address boundary describes a region by containing fewer labels than the addresses of locations contained within the boundary.  In that respect, the boundary might be considered an incomplete address, allthough a boundary is actually a valid civic address that simply describes a larger location.
      
</p>
<p>A larger region is described by including fewer labels; a smaller region might be described by including more labels, or labels that are more specific.
      
</p>
<p>For example, if the described region is the province of Zeeland in the Netherlands, only two labels are required: a country of <tt>NL</tt> and an A1 field of <tt>ZE</tt>.
      
</p>
<p>A label that is omitted from the civic address boundary indicates that civic addresses within the boundary may have any value for the label.
      
</p>
<p>This process does not provide any assurance that a civic address exists, only that if it does exist, it is contained entirely within the described boundary.  Determining whether such an address actually exists usually requires additional information, and is therefore not considered by this document.
      
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Determining if an Address is Within a Boundary</h3>

<p>A civic address is entirely enclosed within a boundary if every label of the boundary that has a value has an equivalent value in the address.  A civic address boundary can entirely enclose another civic address boundary.
        
</p>
<p>Case folding is performed on values before comparison.
        
</p>
<p>A label is considered equivalent if at least one value from the boundary has the same value in the address for the same language (and script).  If values are provided in multiple languages, any language that is present in both boundary and address can be used.
        
</p>
<p>[[TBD: If the label contains different values for the same language, does this override the above - in light of the Austrian example below, it's probably better that the more lenient equivalence test is used.]]
        
</p>
<p>Labels that have the same value, but a different language, are not equivalent.  Without information on different translations of the label, the label must be considered to be different.
        
</p>
<a name="algorithm"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Algorithm Summary</h3>

<p>The algorithm for determining whether an address is contained entirely within a given boundary can be summarized by the following pseudocode:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   SET iswithin = true
   FOR EACH label IN boundary DO:
      IF boundary[label] exists THEN:
         SET equivalent = false
         FOR lang IN boundary[label] DO:
            IF boundary[label][lang] == address[label][lang] THEN:
               SET equivalent = true
            END
         END
         IF NOT equivalent THEN SET iswithin = false
      END
   END
   RETURN iswithin
</pre></div>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
False Negatives</h3>

<p>This test can produce false negatives for a number of reasons:
        </p>
<ol class="text">
<li>A particular label might be specified with different languages in the boundary and the address.  This label might be considered equivalent if the two values have the same meaning.
          <br />
<br />

          For instance, the German city Muenchen is known as Munich in English - knowledge of this translation is required to determine that these two values are equivalent.
          
</li>
<li>A label might have equivalent values, but subtly different <a class='info' href='#RFC5646'>language tags<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] that result in a failed comparison.
          <br />
<br />

          For instance, in many cases, a language tag of <tt>en</tt> is not significantly different from variants that use the same primary language subtag.  Identical values with <tt>en</tt> and <tt>en-US</tt> or <tt>en-Latn</tt> would compare as different, even though the latter two tags are simply more specific than the first.  Even <tt>en-GB</tt> is rarely different to these for text that is used in addressing.
          <br />
<br />

          For creators of civic addresses and boundaries, the guidance in <a class='info' href='#RFC5646'>[RFC5646]<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a>, Section 4.1 recommends that subtags are only added if they include useful distinguishing information.  This is intended to avoid processing errors such as this.  This guidance is particularly relevant in relation to use of CAtype 128 (script) in the binary encoding of <a class='info' href='#RFC4776'>[RFC4776]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Option for Civic Addresses Configuration Information,&rdquo; November&nbsp;2006.</span><span>)</span></a>, which is often unnecessarily specified.
          
</li>
<li>The address might use different labels than the boundary to produce the same result.
          <br />
<br />

          For instance, a boundary might use labels <tt>A1</tt> through <tt>A6</tt> to describe a location, whereas the same location is described using a postal code in place of these elements.  The address is within the described boundary, but this cannot be determined without knowing that the postal code and A-labels are equivalent.
          <br />
<br />

          In some countries, specific address codes can be used to replace some or all of the other address labels.  In some instances, an address consisting of the country and the <tt>ADDCODE</tt> label can be sufficiently descriptive for an application; however, this would not be identified as being within a boundary that was specified using other address labels.
          
</li>
<li>There are many cases where a value can be expressed in different ways.  This includes abbreviations, commonly accepted misspellings, and generally recognized variations in addresses.
          <br />
<br />

          For instance, abbreviations are common for thoroughfare suffixes, like <tt>Street</tt> (<tt>St.</tt> or <tt>St</tt>) or <tt>Road</tt> (<tt>Rd.</tt> or <tt>Rd</tt>).
          <br />
<br />

          In another example, the <a class='info' href='#RFC5774'>Austrian addressing recommendations<span> (</span><span class='info'>Wolf, K. and A. Mayrhofer, &ldquo;Considerations for Civic Addresses in the Presence Information Data Format Location Object (PIDF-LO): Guidelines and IANA Registry Definition,&rdquo; March&nbsp;2010.</span><span>)</span></a> [RFC5774] let certain labels contain either a code or a descriptive name.  Without knowing that <tt>Oberbaumgarten</tt> and <tt>Oberbaumgarten;1208</tt> refer to the same Katastralgemeindenamen, these values must be considered to be different.
          
</li>
</ol><p>
        By using additional information, a system might be able to identify more equivalent labels than the basic algorithm.  This can remove some, if not all such false negatives.  However, a system should not rely on another system having and employing such knowledge.
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
False Positives</h3>

<p>This algorithm guarantees, that a civic address that exists is entirely contained within a boundary.
        
</p>
<p>No allowance is made for addresses that do no exist.  It is trivially possible to construct a non-sensical or non-existent civic address that is considered "within" a boundary using this algorithm.  This can be done by starting with the civic address boundary and adding arbitrary values to labels that do not already have values.
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Address Boundary Limitations</h3>

<p>The address format allows a limited expression for address boundaries.  This representation can only be used in limited applications.  This simple boundary expression is not suitable for any application that is sensitive to false negatives.
        
</p>
<p>In the case of <a class='info' href='#I-D.ietf-ecrit-lost-sync'>boundary interchange between LoST servers<span> (</span><span class='info'>Schulzrinne, H. and H. Tschofenig, &ldquo;Synchronizing Location-to-Service Translation (LoST) Protocol based Service Boundaries and Mapping Elements,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ecrit&#8209;lost&#8209;sync] would likely require multiple specific boundaries to describe a single boundary.  A number of well-known cases would generate a very large number of such boundaries.  For instance, if a boundary runs up the middle of street that places odd and even house numbers on opposite sides of the street, each house on that street would require an individual address.
        
</p>
<p>Concatenation of address data can introduce other limitations.  The limited set of address labels can mean that each field can hold several discrete units of data.  An <a class='info' href='#RFC5774'>address mapping<span> (</span><span class='info'>Wolf, K. and A. Mayrhofer, &ldquo;Considerations for Civic Addresses in the Presence Information Data Format Location Object (PIDF-LO): Guidelines and IANA Registry Definition,&rdquo; March&nbsp;2010.</span><span>)</span></a> [RFC5774] might specify that underlying data be concatenated and mapped to a single label.
        
</p>
<p>The algorithm described here operates on entire labels only.  The algorithm and boundary expression does not allow only part of a label to change.  If concatenated data is included in the one label, a generic processer cannot know of this and distinguish between parts that must match and parts that do not matter.  To do so would require knowledge of the modes of concatenation, what delimiters were used and it would require syntax that distinguishes important parts from unimportant parts.
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Boundary Combining Algorithms</h3>

<p>In some cases, it might be necessary to combine boundaries.  This section describes three algorithms, including simple union and intersection.
      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Boundary Unions</h3>

<p>The union of two civic address boundaries (or addresses) is a single boundary that contains all civic addresses that are contained within either original boundary.
        
</p>
<p>The boundary that forms the union of two other boundaries is formed of all labels that are equivalent in both boundaries.
        
</p>
<p>If labels differ in the two boundaries, then the resulting union might also include addresses that are in neither boundary.  Only use this algorithm if false positives are acceptable.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   SET union = empty address
   FOR EACH label IN boundary1,boundary2 DO:
      IF boundary1[label] EQUIV boundary2[label] THEN
         SET union[label] = boundary1[label]
      END
   END
   RETURN union
</pre></div>
<p>The value of any label in a union of boundaries should include a value for all languages that are present in both boundaries.
        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Boundary Intersections</h3>

<p>The intersection of two boundaries (or addresses) is a single boundary that contains all addresses that are found in both original boundaries.
        
</p>
<p>The boundary that forms the intersection of two other boundaries is formed of the combined value of the labels from both boundaries.
        
</p>
<p>If the value of any label is present in both boundaries, but not equivalent, the two boundaries do not intersect for the purposes of this algorithm.  In practice, while it is possible that two such boundaries could overlap, this algorithm cannot detect this.  Furthermore, the civic address representation does not provide a way to express such an overlap.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   SET intersection = empty address
   FOR EACH label IN boundary1,boundary2 DO:
      IF boundary1[label] exists AND boundary2[label] exists
          AND boundary1[label] NOT EQUIV boundary2[label] THEN
          ERROR No overlap
      END
      IF boundary1[label] exists THEN:
         SET intersection[label] = boundary1[label]
      ELSE
         SET intersection[label] = boundary2[label]
      END
   END
   RETURN intersection
</pre></div>
<p>The value of any label in an intersection of boundaries may include a value for all languages that are present in both boundaries.
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Avoiding False Positives</h3>

<p>The service boundaries in <a class='info' href='#RFC5222'>LoST<span> (</span><span class='info'>Hardie, T., Newton, A., Schulzrinne, H., and H. Tschofenig, &ldquo;LoST: A Location-to-Service Translation Protocol,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5222] rely on the absence of false positives when determining if an address is within a boundary.  False negatives are tolerated, because this only results in the LoST client making another request to discover an unchanged service.  A false positive is not desirable because a device could retain a service mapping that is likely to be invalid.
        
</p>
<p><a class='info' href='#I-D.ietf-ecrit-rough-loc'>[I&#8209;D.ietf&#8209;ecrit&#8209;rough&#8209;loc]<span> (</span><span class='info'>Barnes, R. and M. Lepinski, &ldquo;Using Imprecise Location for Emergency Context Resolution,&rdquo; August&nbsp;2010.</span><span>)</span></a> describes an algorithm where an address is formed of the intersection of multiple boundaries.  If no intersection the result of this algorithm was failure, then usable location information cannot be provided to the LoST client.
        
</p>
<p>For a LoST service boundary, the goal is to provide a boundary that contains as few labels as possible.  For a rough location, the goal is to provide an address with as few labels as possible.  False positives are not desirable in either case.
        
</p>
<p>Thus, both cases have a similar goal, and both have a more precise address to operate on.  In LoST, this is the address used to query the server; for rough locations, this is the address that is to be hidden.
        
</p>
<p>To avoid false positives in determining whether an address falls within a boundary, labels from the more precise address are added.  Any label where the inputs to the union or intersection disagree is given a value from the precise address.  This ensures that the resulting address or boundary entirely contains the precise address.
        
</p>
<p>Alternatively, given a precise address and a number of boundaries that are to be combined by either union or intersection, an address or boundary can be formed by removing all labels from the precise address that do not have a value in any boundary.  This algorithm produces an identical result.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   SET result = precise address
   FOR EACH label IN result DO:
      SET found = false
      FOR EACH boundary IN boundaries DO:
         IF boundary[label] exists THEN SET found = true
      END
      IF not found THEN CLEAR result[label]
   END
   RETURN result
</pre></div>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Example</h3>

<p>The following civic address boundary (shown in <a class='info' href='#RFC5139'>XML form<span> (</span><span class='info'>Thomson, M. and J. Winterbottom, &ldquo;Revised Civic Location Format for Presence Information Data Format Location Object (PIDF-LO),&rdquo; February&nbsp;2008.</span><span>)</span></a> [RFC5139]), describes a region of Los Angeles, USA.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   &lt;civicAddress
       xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"&gt;
     &lt;country&gt;US&lt;/country&gt;
     &lt;A1&gt;CA&lt;/A1&gt;
     &lt;A2&gt;Orange&lt;/A2&gt;
     &lt;A3&gt;Los Angeles&lt;/A3&gt;
     &lt;A4&gt;Anaheim&lt;/A4&gt;
     &lt;PC&gt;92802&lt;/PC&gt;
   &lt;/civicAddress&gt;
</pre></div>
<p>The following address includes additional labels, it does not change the value of any label.
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   &lt;civicAddress
       xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"&gt;
     &lt;country&gt;US&lt;/country&gt;
     &lt;A1&gt;CA&lt;/A1&gt;
     &lt;A2&gt; Orange &lt;/A2&gt;
     &lt;A3&gt;Los Angeles&lt;/A3&gt;
     &lt;A4&gt;Anaheim&lt;/A4&gt;
     &lt;PRD&gt;South&lt;/PRD&gt;&lt;RD&gt;Harbor&lt;/RD&gt;&lt;STS&gt;Boulevard&lt;/STS&gt;
     &lt;HNO&gt;1313&lt;/HNO&gt;&lt;NAM&gt;Disneyland&lt;/NAM&gt;
     &lt;PC&gt;92802&lt;/PC&gt;
   &lt;/civicAddress&gt;
</pre></div>
<p>An equivalent address that would not be considered "within" the boundary by the generic algorithm would be one that specified <tt>Orange County</tt> for the <tt>A2</tt> label.  It's also possible to unambiguously describe the location without fields <tt>A1</tt> through <tt>A4</tt>, since a ZIP (postal) code of <tt>92802</tt> provides sufficient information.
     
</p>
<p>Thus, the following variant is not considered "within" the boundary, even if it is the same address.  That is, without context-specific knowledge, the algorithm produces a false negative on this address.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   &lt;civicAddress
       xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"&gt;
     &lt;country&gt;US&lt;/country&gt;
     &lt;PRD&gt;South&lt;/PRD&gt;&lt;RD&gt;Harbor&lt;/RD&gt;&lt;STS&gt;Boulevard&lt;/STS&gt;
     &lt;HNO&gt;1313&lt;/HNO&gt;&lt;NAM&gt;Disneyland&lt;/NAM&gt;
     &lt;PC&gt;92802&lt;/PC&gt;
   &lt;/civicAddress&gt;
</pre></div>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document has no IANA actions.
</p>
<p>[[RFC Editor: please remove this section prior to publication.]]
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>This document describes a civic address model and algorithms for manipulating civic addresses and boundaries in the same format.  There are no known security considerations arising from the described application of these algorithms.
      
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4119">[RFC4119]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4119">A Presence-based GEOPRIV Location Object Format</a>,&rdquo; RFC&nbsp;4119, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4119.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4776">[RFC4776]</a></td>
<td class="author-text">Schulzrinne, H., &ldquo;<a href="http://tools.ietf.org/html/rfc4776">Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Option for Civic Addresses Configuration Information</a>,&rdquo; RFC&nbsp;4776, November&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4776.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5139">[RFC5139]</a></td>
<td class="author-text">Thomson, M. and J. Winterbottom, &ldquo;<a href="http://tools.ietf.org/html/rfc5139">Revised Civic Location Format for Presence Information Data Format Location Object (PIDF-LO)</a>,&rdquo; RFC&nbsp;5139, February&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5139.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5222">[RFC5222]</a></td>
<td class="author-text">Hardie, T., Newton, A., Schulzrinne, H., and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc5222">LoST: A Location-to-Service Translation Protocol</a>,&rdquo; RFC&nbsp;5222, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5222.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5646">[RFC5646]</a></td>
<td class="author-text">Phillips, A. and M. Davis, &ldquo;<a href="http://tools.ietf.org/html/rfc5646">Tags for Identifying Languages</a>,&rdquo; BCP&nbsp;47, RFC&nbsp;5646, September&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5646.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5774">[RFC5774]</a></td>
<td class="author-text">Wolf, K. and A. Mayrhofer, &ldquo;<a href="http://tools.ietf.org/html/rfc5774">Considerations for Civic Addresses in the Presence Information Data Format Location Object (PIDF-LO): Guidelines and IANA Registry Definition</a>,&rdquo; BCP&nbsp;154, RFC&nbsp;5774, March&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5774.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ecrit-rough-loc">[I-D.ietf-ecrit-rough-loc]</a></td>
<td class="author-text">Barnes, R. and M. Lepinski, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-rough-loc-03.txt">Using Imprecise Location for Emergency Context Resolution</a>,&rdquo; draft-ietf-ecrit-rough-loc-03 (work in progress), August&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-rough-loc-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ecrit-lost-sync">[I-D.ietf-ecrit-lost-sync]</a></td>
<td class="author-text">Schulzrinne, H. and H. Tschofenig, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-lost-sync-09.txt">Synchronizing Location-to-Service Translation (LoST) Protocol based Service Boundaries and Mapping Elements</a>,&rdquo; draft-ietf-ecrit-lost-sync-09 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-lost-sync-09.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Martin Thomson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andrew Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andrew Building (39)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wollongong University Campus</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Northfields Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wollongong, NSW  2522</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Australia</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+61 2 4221 2915</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:martin.thomson@andrew.com">martin.thomson@andrew.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Karl Heinz Wolf</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">nic.at GmbH</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Karlsplatz 1/2/9</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wien  A-1010</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Austria</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+43 1 5056416 37</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:karlheinz.wolf@nic.at">karlheinz.wolf@nic.at</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.nic.at/">http://www.nic.at/</a></td></tr>
</table>
</body></html>
