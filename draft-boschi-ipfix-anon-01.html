<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IP Flow Anonymisation Support</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IP Flow Anonymisation Support">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IPFIX Working Group</td><td class="header">E. Boschi</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">B. Trammell</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">Hitachi Europe</td></tr>
<tr><td class="header">Expires: January 15, 2009</td><td class="header">July 14, 2008</td></tr>
</table></td></tr></table>
<h1><br />IP Flow Anonymisation Support<br />draft-boschi-ipfix-anon-01.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 15, 2009.</p>

<h3>Abstract</h3>

<p>This document describes anonymisation techniques for IP flow data. It
    provides a categorization of common anonymisation schemes and defines the
    parameters needed to describe them. It describes support for anonymization
    within the IPFIX protocol, providing the basis for the definition of
    information models for configuring anonymisation techniques within an
    IPFIX Metering or Exporting Process, and for reporting the technique in
    use to an IPFIX Collecting Process.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
IPFIX Protocol Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#intro-docs">1.2.</a>&nbsp;
IPFIX Documents Overview<br />
<a href="#anchor3">2.</a>&nbsp;
Terminology<br />
<a href="#anchor4">3.</a>&nbsp;
Categorisation of Anonymisation Techniques<br />
<a href="#anchor5">4.</a>&nbsp;
Anonymisation of IP Flow Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.</a>&nbsp;
IP Address Anonymisation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.1.1.</a>&nbsp;
Truncation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.1.2.</a>&nbsp;
Random Permutations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.1.3.</a>&nbsp;
Prefix-preserving Pseudonymisation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.2.</a>&nbsp;
Timestamp Anonymisation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.2.1.</a>&nbsp;
Precision Degradation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.2.2.</a>&nbsp;
Enumeration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.2.3.</a>&nbsp;
Random Time Shifts<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.3.</a>&nbsp;
Counter Anonymisation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.3.1.</a>&nbsp;
Precision Degradation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.3.2.</a>&nbsp;
Binning<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.3.3.</a>&nbsp;
Random Noise Addition<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.4.</a>&nbsp;
Anonymisation of Other Flow Fields<br />
<a href="#anchor19">5.</a>&nbsp;
Parameters for the Description of Anonymisation Techniques<br />
<a href="#anchor20">6.</a>&nbsp;
Anonymisation Support in IPFIX<br />
<a href="#anchor21">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor22">8.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The standardisation of an IP flow information export protocol <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> and associated representations removes a
    technical barrier to the sharing of IP flow data across organizational
    boundaries and with network operations, security, and research communities
    for a wide variety of purposes. However, with wider dissemination comes
    greater risks to the privacy of the users of networks under measurement,
    and to the security of those networks. While it is not a complete solution
    to the issues posed by distribution of IP flow information, anonymisation
    is an important tool for the protection of privacy within network
    measurement infrastructures.
</p>
<p>This document presents a mechanism for representing anonymised data
    within IPFIX and guidelines for using it. It begins with a categorization
    of anonymisation techniques. It then describes applicability of each
    technique to commonly anonymisable fields of IP flow data, organized by
    information element data type and semantics as in <a class='info' href='#RFC5102'>[RFC5102]<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; January&nbsp;2008.</span><span>)</span></a>; enumerates the parameters required by each of
    the applicable anonymisation techniques; and provides guidelines for the
    use of each of these techniques in accordance with best practices in data
    protection. Finally, it specifies a mechanism for exporting anonymised
    data and binding anonymisation metadata to templates using IPFIX
    Options.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
IPFIX Protocol Overview</h3>

<p>In the IPFIX protocol, { type, length, value } tuples are expressed
      in templates containing { type, length } pairs, specifying which { value
      } fields are present in data records conforming to the Template, giving
      great flexibility as to what data is transmitted. Since Templates are
      sent very infrequently compared with Data Records, this results in
      significant bandwidth savings. Various different data formats may be
      transmitted simply by sending new Templates specifying the { type,
      length } pairs for the new data format. See <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> for more information.
</p>
<p>The <a class='info' href='#RFC5102'>IPFIX information model<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5102] defines a
      large number of standard Information Elements which provide the
      necessary { type } information for Templates. The use of standard
      elements enables interoperability among different vendors'
      implementations. Additionally, non-standard enterprise-specific elements
      may be defined for private use.
</p>
<a name="intro-docs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
IPFIX Documents Overview</h3>

<p><a class='info' href='#RFC5101'>"Specification of the IPFIX
      Protocol for the Exchange of IP Traffic Flow Information"<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5101]
      and its associated documents
      define the IPFIX Protocol, which provides network engineers and
      administrators with access to IP traffic flow information.
</p>
<p><a class='info' href='#I-D.ietf-ipfix-arch'>"Architecture for IP Flow
      Information Export"<span> (</span><span class='info'>Sadasivan, G. and N. Brownlee, &ldquo;Architecture Model for IP Flow Information Export,&rdquo; October&nbsp;2003.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;arch] defines
      the architecture for the export of measured IP flow information out of
      an IPFIX Exporting Process to an IPFIX Collecting Process, and the
      basic terminology used to describe the elements of this architecture,
      per the requirements defined in <a class='info' href='#RFC3917'>"Requirements
      for IP Flow Information Export"<span> (</span><span class='info'>Quittek, J., Zseby, T., Claise, B., and S. Zander, &ldquo;Requirements for IP Flow Information Export (IPFIX),&rdquo; October&nbsp;2004.</span><span>)</span></a> [RFC3917]. The IPFIX Protocol document
      <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> then covers the details of the method for
      transporting IPFIX Data Records and Templates via a congestion-aware
      transport protocol from an IPFIX Exporting Process to an IPFIX
      Collecting Process.
</p>
<p><a class='info' href='#RFC5102'>"Information Model for IP Flow
      Information Export"<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5102] describes the Information Elements used by IPFIX, including
      details on Information Element naming, numbering, and data type
      encoding. Finally, <a class='info' href='#I-D.ietf-ipfix-as'>"IPFIX
      Applicability"<span> (</span><span class='info'>Zseby, T., &ldquo;IPFIX Applicability,&rdquo; July&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;as] describes the various applications of the IPFIX
      protocol and their use of information exported via IPFIX, and relates
      the IPFIX architecture to other measurement architectures and
      frameworks.
</p>
<p>This document references the Protocol and Architecture documents for
      terminology and extends the IPFIX Information Model to provide new
      Information Elements for anonymisation metadata.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>Terms used in this document that are defined in the Terminology section
    of the <a class='info' href='#RFC5101'>IPFIX Protocol<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5101] document are to be
    interpreted as defined there.
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
    document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC
    2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Categorisation of Anonymisation Techniques</h3>

<p>Anonymisation modifies a data set in order to
    protect the identity of the people or entities described by the data set
    from disclosure. With respect to network traffic data, anonymisation
    generally attempts to preserve some set of properties of the network
    traffic useful for a given application or applications, while ensuring the
    data cannot be traced back to the specific networks, hosts, or users
    generating the traffic.
</p>
<p>Anonymisation may be broadly split into three categories:
    generalisation and reversible or irreversible substitution. When
    generalisation is used, identifying information is grouped in sets, and
    one single value is used to identify each set element. In effect, this
    causes multiple records to become indistinguishable, thereby aggregating
    them together. Generalisation is an irreversible operation, in that the
    information needed to identify a single record from its "generalised
    value" is lost.
</p>
<p>Substitution (or pseudonymization) maps the real space of identifiers
    or values into a separate, replacement space, using some
    substitution function. If the substitution function is invertible or can
    otherwise be reversed, then the substitution is reversible, and a real
    identifier can be recovered from a given replacement identifier. This allows 
    to keep different elements distinguishable from each other: the number of different 
    elements in the real and the replacement space is the same.
</p>
<p>Irreversible substitution results when a randomising or one-way function
    is used to map the value space; real identifiers cannot be recovered in an
    irreversible substitution. The number of different elements in the real and 
    replacement spaces is not necessarily the same.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Anonymisation of IP Flow Data</h3>

<p>Due to the restricted semantics of IP flow data, there are a relatively
    limited set of specific anonymisation techniques available on flow data,
    though each falls into the broad categories above. Each type of field that
    may commonly appear in a flow record may have its own applicable specific
    techniques.
</p>
<p>While anonymisation is generally applied at the resolution of single
    fields within a flow record, attacks against anonymisation use entire
    flows and relationships between hosts and flows within a given data set.
    Therefore, fields which may not necessarily be identifying by themselves
    may be anonymised in order to increase the anonymity of the data set as a
    whole.
</p>
<p>Of all the fields in an IP flow record, only IP addresses directly
    identify entities in the real world. Each IP address is associated with an
    interface on a network host, and can potentially be identified with a
    single user. Additionally, IP addresses are structured identifiers; that
    is, partial IP address prefixes may be used to identify networks just as
    full IP addresses identify hosts. This makes anonymisation of IP addresses
    particularly important.
</p>
<p>Port numbers identify abstract entities (applications) as opposed to
    real-world entities, but they can be used to classify hosts and user
    behavior. Passive port fingerprinting, both of well-known and ephemeral
    ports, can be used to determine the operating system running on a host.
    Relative data volumes by port can also be used to determine the host's
    function (workstation, web server, etc.); this information can be used to
    identify hosts and users.
</p>
<p>While not identifiers in and of themselves, timestamps and counters
    can reveal the behavior of the hosts and users on a network. Any given
    network activity is recognizable by a pattern of relative time differences
    and data volumes in the associated sequence of flows, even without host
    address information. They can therefore be used to identify hosts and
    users. Timestamps and counters are also vulnerable to traffic injection
    attacks, where traffic with a known pattern is injected into a network
    under measurement, and this pattern is later identified in the anonymised
    data set. 
</p>
<p>The simplest and most extreme form of anonymisation, which can be
    applied to any field of a flow record, is black-marker anonymisation, or
    complete deletion of a given field. While black-marker anonymisation completely protects the data in the
    deleted fields from the risk of disclosure, it also reduces the utility of
    the anonymised data set as a whole. Techniques that retain some
    information while reducing (though not eliminating) the disclosure risk
    will be extensively discussed in the following sections; note that the
    techniques specifically applicable to IP addresses, timestamps, and counters 
    will be discussed in separate sections.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
IP Address Anonymisation</h3>

<p>The following table gives an overview of the schemes for IP address
      anonymization described in this document and their categorization.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Scheme</th><th align="left">Action</th><th align="left">Reversibility</th></tr>
<tr>
<td align="left">Truncation</td>
<td align="left">Generalisation</td>
<td align="left">N</td>
</tr>
<tr>
<td align="left">Random Permutation</td>
<td align="left">Substitution</td>
<td align="left">Y/N</td>
</tr>
<tr>
<td align="left">Prefix-preserving Pseudonymisation</td>
<td align="left">Substitution</td>
<td align="left">Y</td>
</tr>
</table>
<br clear="all" />

<p>Note that random permutations might be either reversible or not, depending 
      on the function used.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Truncation</h3>

<p>Truncation removes "n" of the least significant bits from an IP Address. 
      Note that truncating 8 bits would replace an IP Address with the corresponding 
      class C network address.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Random Permutations</h3>

<p>When random permutations are used, each IP Address is replaced with a 
      random permutation on the set of possible IP Addresses. The permutation function 
      can be implemented using hash tables.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
Prefix-preserving Pseudonymisation</h3>

<p>Prefix-preserving pseudonymisation preserves the structure of IP Addresses. 
      If two IP Addresses match on a prefix of "n" bits, their anonymised versions 
      will match on a prefix of "n" bits too.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Timestamp Anonymisation</h3>

<p>[TODO: introductory text]
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Scheme</th><th align="left">Action</th><th align="left">Reversibility</th></tr>
<tr>
<td align="left">Precision Degradation</td>
<td align="left">Generalisation</td>
<td align="left">N</td>
</tr>
<tr>
<td align="left">Enumeration</td>
<td align="left">Substitution</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="left">Random Shifts</td>
<td align="left">Substitution</td>
<td align="left">Y</td>
</tr>
</table>
<br clear="all" />

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Precision Degradation</h3>

<p>Precision Degradation removes the most precise components of a timestamp, 
      accounting all events occurring in each given interval (e.g. one millisecond 
      for millisecond level degradation) as simultaneous. This has the effect of 
      potentially collapsing many timestamps into one.
      With this technique time precision is reduced, and sequencing may be lost,
      but the information at which time the event happened is kept. 
      
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Enumeration</h3>

<p>Enumeration keeps the chronological order in which events occurred while 
      eliminating time information. Timestamps are substituted by equidistant timestamps 
      (or numbers) starting from an rendomly chosen start value.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Random Time Shifts</h3>

<p>Random Time Shifts keep the information on how far apart two events are 
      from each other. This is achieved by shifting all timestamps by the same 
      random number. Note that random time shifts also preserve chronological order.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Counter Anonymisation</h3>

<p>Counters (such as packet and octet volumes per flow) are subject to
fingerprinting and injection attacks against anonymisation, as
timestamps are, but relative magnitudes of activity can be useful for
certain analysis tasks. [TODO: more intro text]
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Scheme</th><th align="left">Action</th><th align="left">Reversibility</th></tr>
<tr>
<td align="left">Precision Degradation</td>
<td align="left">Generalisation</td>
<td align="left">N</td>
</tr>
<tr>
<td align="left">Binning</td>
<td align="left">Generalisation</td>
<td align="left">N</td>
</tr>
<tr>
<td align="left">Random noise addition</td>
<td align="left">Substitution</td>
<td align="left">N</td>
</tr>
</table>
<br clear="all" />

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Precision Degradation</h3>

<p>As with precision degradation in timestamps, precision degradation of
    counters removes lower-order bits of the counters, treating all the
    counters in a given range as having the same value. Depending on the
    precision reduction, this loses information about the relationships
    between sizes of similarly-sized flows, but keeps relative magnitude
    information.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Binning</h3>

<p>Binning can be seen as a special case of precision degradation; the
    operation is identical, except for in precision degradation the counter
    ranges are uniform, and in binning they need not be. For example, a common
    counter binning scheme for packet counters could be to bin values 1-2
    together, and 3-infinity together, thereby separating potentially
    completely-opened TCP connections from unopened ones. Binning schemes are
    generally chosen to keep precisely the amount of information required in a
    counter for a given analysis task
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Random Noise Addition</h3>

<p>Random noise addition adds a random amount to a counter in each flow;
    this is used to keep relative magnitude information and minimize the
    disruption to size relationship information while avoiding fingerprinting
    attacks against anonymization.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Anonymisation of Other Flow Fields</h3>

<p>[TODO: as section 4.1]
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Parameters for the Description of Anonymisation Techniques</h3>

<p>[TODO: see corresponding section of draft-ietf-psamp-sample-tech for
    the proposed structure of this section.] 
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Anonymisation Support in IPFIX</h3>

<p>[TODO: Here we'll describe how the information specified above can be
    transmitted on the wire using an option template. The idea is to scope the
    option to the Template ID and for each field specify which are anonymised,
    providing info on the output characteristics of the technique, and which
    ones aren't.]
</p>
<p>[EDITOR'S NOTE: Multiple anon. techniques applied on an IE at the same
    time is indicated with multiple elements of the same type (in application
    order as in PSAMP)]
</p>
<p>[EDITOR'S NOTE: for blackmarking we'll recommend not to export the
    information at all following the data protection law principle that only
    necessary information should be exported.]
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>[TODO: write this section.]
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document contains no actions for IANA.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5101">[RFC5101]</a></td>
<td class="author-text">Claise, B., &ldquo;<a href="http://tools.ietf.org/html/rfc5101">Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information</a>,&rdquo; RFC&nbsp;5101, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5101.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5102">[RFC5102]</a></td>
<td class="author-text">Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;<a href="http://tools.ietf.org/html/rfc5102">Information Model for IP Flow Information Export</a>,&rdquo; RFC&nbsp;5102, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5102.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-arch">[I-D.ietf-ipfix-arch]</a></td>
<td class="author-text">Sadasivan, G. and N. Brownlee, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-arch-02.txt">Architecture Model for IP Flow Information Export</a>,&rdquo; draft-ietf-ipfix-arch-02 (work in progress), October&nbsp;2003 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-arch-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-as">[I-D.ietf-ipfix-as]</a></td>
<td class="author-text">Zseby, T., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-as-12.txt">IPFIX Applicability</a>,&rdquo; draft-ietf-ipfix-as-12 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-as-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-architecture">[I-D.ietf-ipfix-architecture]</a></td>
<td class="author-text">Sadasivan, G., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-architecture-12.txt">Architecture for IP Flow Information Export</a>,&rdquo; draft-ietf-ipfix-architecture-12 (work in progress), September&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-architecture-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-reducing-redundancy">[I-D.ietf-ipfix-reducing-redundancy]</a></td>
<td class="author-text">Boschi, E., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-reducing-redundancy-04.txt">Reducing Redundancy in IP Flow Information Export (IPFIX) and Packet  Sampling (PSAMP) Reports</a>,&rdquo; draft-ietf-ipfix-reducing-redundancy-04 (work in progress), May&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-reducing-redundancy-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3917">[RFC3917]</a></td>
<td class="author-text">Quittek, J., Zseby, T., Claise, B., and S. Zander, &ldquo;<a href="http://tools.ietf.org/html/rfc3917">Requirements for IP Flow Information Export (IPFIX)</a>,&rdquo; RFC&nbsp;3917, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3917.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Elisa Boschi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hitachi Europe</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">c/o ETH Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gloriastrasse 35</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">8092 Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Switzerland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+41 44 632 70 57</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:elisa.boschi@hitachi-eu.com">elisa.boschi@hitachi-eu.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Trammell</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hitachi Europe</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">c/o ETH Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gloriastrasse 35</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">8092 Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Switzerland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+41 44 632 70 13</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:brian.trammell@hitachi-eu.com">brian.trammell@hitachi-eu.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
