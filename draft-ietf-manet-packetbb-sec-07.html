<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>MANET Cryptographical Signature TLV Definition</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Applicability Statement">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Architecture">
<link href="#rfc.section.5" rel="Chapter" title="5 Overview and Functioning">
<link href="#rfc.section.6" rel="Chapter" title="6 General Signature TLV Structure">
<link href="#rfc.section.7" rel="Chapter" title="7 General Timestamp TLV Structure">
<link href="#rfc.section.8" rel="Chapter" title="8 Packet TLVs">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Packet SIGNATURE TLV">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Packet TIMESTAMP TLV">
<link href="#rfc.section.9" rel="Chapter" title="9 Message TLVs">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Message SIGNATURE TLV">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Message TIMESTAMP TLV">
<link href="#rfc.section.10" rel="Chapter" title="10 Address Block TLVs">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Address Block SIGNATURE TLV">
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 Address Block TIMESTAMP TLV">
<link href="#rfc.section.11" rel="Chapter" title="11 Signature: Basic">
<link href="#rfc.section.12" rel="Chapter" title="12 Signature: Cryptographic Function over a Hash Value">
<link href="#rfc.section.12.1" rel="Chapter" title="12.1 General Signature TLV Structure">
<link href="#rfc.section.12.1.1" rel="Chapter" title="12.1.1 Rationale">
<link href="#rfc.section.12.2" rel="Chapter" title="12.2 Considerations for Calculating the Signature">
<link href="#rfc.section.12.2.1" rel="Chapter" title="12.2.1 Packet SIGNATURE TLV">
<link href="#rfc.section.12.2.2" rel="Chapter" title="12.2.2 Message SIGNATURE TLV">
<link href="#rfc.section.12.2.3" rel="Chapter" title="12.2.3 Address Block SIGNATURE TLV">
<link href="#rfc.section.12.3" rel="Chapter" title="12.3 Example of a Signed Message">
<link href="#rfc.section.13" rel="Chapter" title="13 IANA Considerations">
<link href="#rfc.section.13.1" rel="Chapter" title="13.1 Expert Review: Evaluation Guidelines">
<link href="#rfc.section.13.2" rel="Chapter" title="13.2 Packet TLV Type Registrations">
<link href="#rfc.section.13.3" rel="Chapter" title="13.3 Message TLV Type Registrations">
<link href="#rfc.section.13.4" rel="Chapter" title="13.4 Address Block TLV Type Registrations">
<link href="#rfc.section.13.5" rel="Chapter" title="13.5 Hash Function">
<link href="#rfc.section.13.6" rel="Chapter" title="13.6 Cryptographic Algorithm">
<link href="#rfc.section.14" rel="Chapter" title="14 Security Considerations">
<link href="#rfc.section.15" rel="Chapter" title="15 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="16 References">
<link href="#rfc.references.1" rel="Chapter" title="16.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="16.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes general and flexible TLVs (type-length-value structure) for representing cryptographic signatures as well as timestamps, using the generalized MANET packet/message format " />
  <meta name="description" content="This document describes general and flexible TLVs (type-length-value structure) for representing cryptographic signatures as well as timestamps, using the generalized MANET packet/message format " />
  <meta name="keywords" content="MANET" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Mobile Ad hoc Networking (MANET)</td>
<td class="right">U. Herberg</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Fujitsu Laboratories of America</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">T. Clausen</td>
</tr>
<tr>
<td class="left">Expires: May 18, 2012</td>
<td class="right">LIX, Ecole Polytechnique</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">November 15, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">MANET Cryptographical Signature TLV Definition<br />
  <span class="filename">draft-ietf-manet-packetbb-sec-07</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes general and flexible TLVs (type-length-value structure) for representing cryptographic signatures as well as timestamps, using the generalized MANET packet/message format <a href="#RFC5444">[RFC5444]</a>. It defines two Packet TLVs, two Message TLVs, and two Address Block TLVs, for affixing cryptographic signatures and timestamps to a packet, message and address, respectively.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 18, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Applicability Statement</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Architecture</a>
</li>
<li>5.   <a href="#rfc.section.5">Overview and Functioning</a>
</li>
<li>6.   <a href="#rfc.section.6">General Signature TLV Structure</a>
</li>
<li>7.   <a href="#rfc.section.7">General Timestamp TLV Structure</a>
</li>
<li>8.   <a href="#rfc.section.8">Packet TLVs</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">Packet SIGNATURE TLV</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">Packet TIMESTAMP TLV</a>
</li>
<li>9.   <a href="#rfc.section.9">Message TLVs</a>
</li>
<li>9.1.   <a href="#rfc.section.9.1">Message SIGNATURE TLV</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">Message TIMESTAMP TLV</a>
</li>
<li>10.   <a href="#rfc.section.10">Address Block TLVs</a>
</li>
<li>10.1.   <a href="#rfc.section.10.1">Address Block SIGNATURE TLV</a>
</li>
<li>10.2.   <a href="#rfc.section.10.2">Address Block TIMESTAMP TLV</a>
</li>
<li>11.   <a href="#rfc.section.11">Signature: Basic</a>
</li>
<li>12.   <a href="#rfc.section.12">Signature: Cryptographic Function over a Hash Value</a>
</li>
<li>12.1.   <a href="#rfc.section.12.1">General Signature TLV Structure</a>
</li>
<li>12.1.1.   <a href="#rfc.section.12.1.1">Rationale</a>
</li>
<li>12.2.   <a href="#rfc.section.12.2">Considerations for Calculating the Signature</a>
</li>
<li>12.2.1.   <a href="#rfc.section.12.2.1">Packet SIGNATURE TLV</a>
</li>
<li>12.2.2.   <a href="#rfc.section.12.2.2">Message SIGNATURE TLV</a>
</li>
<li>12.2.3.   <a href="#rfc.section.12.2.3">Address Block SIGNATURE TLV</a>
</li>
<li>12.3.   <a href="#rfc.section.12.3">Example of a Signed Message</a>
</li>
<li>13.   <a href="#rfc.section.13">IANA Considerations</a>
</li>
<li>13.1.   <a href="#rfc.section.13.1">Expert Review: Evaluation Guidelines</a>
</li>
<li>13.2.   <a href="#rfc.section.13.2">Packet TLV Type Registrations</a>
</li>
<li>13.3.   <a href="#rfc.section.13.3">Message TLV Type Registrations</a>
</li>
<li>13.4.   <a href="#rfc.section.13.4">Address Block TLV Type Registrations</a>
</li>
<li>13.5.   <a href="#rfc.section.13.5">Hash Function</a>
</li>
<li>13.6.   <a href="#rfc.section.13.6">Cryptographic Algorithm</a>
</li>
<li>14.   <a href="#rfc.section.14">Security Considerations</a>
</li>
<li>15.   <a href="#rfc.section.15">Acknowledgements</a>
</li>
<li>16.   <a href="#rfc.references">References</a>
</li>
<li>16.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>16.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document specifies: <a href="#decomposition">Section 12</a>: </p>

<ul>
<li>two TLVs for carrying cryptographic signatures and timestamps in packets, messages, and address blocks as defined by <a href="#RFC5444">[RFC5444]</a>, </li>
<li>a generic framework for calculating cryptographic signatures, accounting (for Message TLVs) for mutable message header fields (&lt;msg-hop-limit&gt; and &lt;msg-hop-count&gt;),  where these fields are present in messages.  </li>
</ul>

<p> This document requests from IANA: </p>

<ul>
<li>allocations for these Packet, Message, and Address Block TLVs from the 0-223 Packet TLV range, the 0-127 Message TLV range and the 0-127 Address Block TLV range from <a href="#RFC5444">[RFC5444]</a>, </li>
<li>creation of two IANA registries for recording code points for hash function and signature calculation, respectively.  </li>
</ul>

<p> Finally, this document defines, in </p>

<ul><li>one common method for generating signatures as a cryptographic function, calculated  over the hash value of the content to be signed.  </li></ul>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<p id="rfc.section.2.p.2">This document uses the terminology and notation defined in  <a href="#RFC5444">[RFC5444]</a>. In particular, the following TLV fields from <a href="#RFC5444">[RFC5444]</a> are used in this specification: </p>

<dl>
<dt>&lt;msg-hop-limit&gt;</dt>
<dd style="margin-left: 8">-  hop limit of a message, as specified in Section 5.2 of <a href="#RFC5444">[RFC5444]</a>.</dd>
<dt>&lt;msg-hop-count&gt;</dt>
<dd style="margin-left: 8">-  hop count of a message, as specified in Section 5.2 of <a href="#RFC5444">[RFC5444]</a>.</dd>
<dt>&lt;length&gt;</dt>
<dd style="margin-left: 8">-  length of a TLV in octets, as specified in Section 5.4.1 of <a href="#RFC5444">[RFC5444]</a>.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#applStatement" id="applStatement">Applicability Statement</a>
</h1>
<p id="rfc.section.3.p.1">MANET routing protocols using the format defined in <a href="#RFC5444">[RFC5444]</a> are accorded the ability to carry additional information in control messages and packets, through inclusion of TLVs. Information so included MAY be used by a MANET routing protocol, or by an extension of a MANET routing protocol, according to its specification.  </p>
<p id="rfc.section.3.p.2">This document specifies how to include a cryptographic signature for a packet, a message, and addresses in address blocks within a message, by way of such TLVs.  This document also specifies how to treat "mutable" fields, specifically the &lt;msg-hop-count&gt; and &lt;msg-hop-limit&gt; fields, if present in the message header when calculating signatures, such that the resulting signature can be correctly verified by any recipient, and how to include this signature.  </p>
<p id="rfc.section.3.p.3">This document describes a generic framework for creating signatures, and how to include these signatures in TLVs. In <a href="#decomposition">Section 12</a>,  an example method for calculating such signatures is given, using a cryptographic function over the hash value of the content to be signed.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Security Architecture</h1>
<p id="rfc.section.4.p.1">Basic MANET routing protocol specifications are often "oblivious to security", however have a clause allowing a control message to be rejected as "badly formed" prior to it being processed or forwarded. MANET routing protocols such as <a href="#RFC6130">[RFC6130]</a> and <a href="#OLSRv2">[OLSRv2]</a> recognize external reasons (such as failure to verify a signature)  for rejecting a message as "badly formed", and therefore "invalid for processing". This architecture is a result of the observation that with respect to security in MANETs, "one size rarely fits all" and that MANET routing protocol deployment domains have varying security requirements ranging from "unbreakable" to "virtually none". The virtue of this approach is that MANET routing protocol specifications (and implementations) can remain "generic", with extensions providing proper deployment-domain specific security mechanisms.  </p>
<p id="rfc.section.4.p.2">The MANET routing protocol "security architecture", in which this specification situates itself, can therefore be summarized as follows: </p>

<ul>
<li>Security-oblivious MANET routing protocol specifications, with a clause allowing an extension to reject a message (prior to processing/forwarding) as "badly formed".  </li>
<li>MANET routing protocol security extensions, rejecting messages as "badly formed", as appropriate for a given deployment-domain specific security requirement.  </li>
<li>Code-points and an exchange format for information, necessary for specification of such MANET routing protocol security extensions.  </li>
</ul>

<p> </p>
<p id="rfc.section.4.p.3">This document addresses the last of these issues, by specifying a common exchange format for cryptographic signatures, making reservations from within the Packet TLV, Message TLV, and Address Block TLV registries of <a href="#RFC5444">[RFC5444]</a>, to be used (and shared) among MANET routing protocol security extensions.  </p>
<p id="rfc.section.4.p.4">For the specific decomposition of a signature into a cryptographic function over a hash value, specified in <a href="#decomposition">Section 12</a>, this document establishes two IANA registries for code-points for hash functions and cryptographic functions adhering to <a href="#RFC5444">[RFC5444]</a>.  </p>
<p id="rfc.section.4.p.5">With respect to <a href="#RFC5444">[RFC5444]</a>, this document: </p>

<ul>
<li>is intended to be used in the non-normative, but intended,  mode of use described in Appendix B of <a href="#RFC5444">[RFC5444]</a>.</li>
<li>is a specific example of the Security Considerations section of <a href="#RFC5444">[RFC5444]</a> (the authentication part).</li>
</ul>

<p> </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#overview" id="overview">Overview and Functioning</a>
</h1>
<p id="rfc.section.5.p.1">This document specifies a syntactical representation of security related information for use with <a href="#RFC5444">[RFC5444]</a> addresses, messages, and packets, as well as establishes IANA registrations and registries.  </p>
<p id="rfc.section.5.p.2">Moreover, this document provides guidelines how MANET routing protocols and MANET routing protocol extensions, using this specification, should treat Signature and Timestamp TLVs, and mutable fields in messages. This specification does not represent a stand-alone protocol; MANET routing protocols and MANET routing protocol extensions, using this specification, MUST provide instructions as to how to handle packets, messages and addresses with security information, associated as specified in this document.  </p>
<p id="rfc.section.5.p.3">This document requests assignment of TLV types from the registries defined for Packet, Message and Address Block TLVs in <a href="#RFC5444">[RFC5444]</a>. When a TLV type is assigned from one of these registries, a registry for "Type Extensions" for that TLV type is created by IANA. This document utilizes these "Type Extension" registries so created, in order to specify internal structure (and accompanying processing) of the &lt;value&gt; field of a TLV.  </p>
<p id="rfc.section.5.p.4">For example, and as defined in this document, a SIGNATURE TLV with Type Extension = 0 specifies that the &lt;value&gt; field has no pre-defined internal structure, but is simply a sequence of octets. A SIGNATURE TLV with Type Extension = 1 specifies that the &lt;value&gt; field has a pre-defined internal structure, and defines its interpretation (specifically, the &lt;value&gt; field consists of a cryptographic operation over a hash value, with fields indicating which hash function and cryptographic operation has been used, specified in <a href="#decomposition">Section 12</a>).  </p>
<p id="rfc.section.5.p.5">Other documents may request assignments for other Type Extensions, and must if so specify their internal structure (if any) and interpretation.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#signatureTLVformat" id="signatureTLVformat">General Signature TLV Structure</a>
</h1>
<p id="rfc.section.6.p.1">The value of the Signature TLV is: </p>
<div id="#rfc.figure.1"></div>
<pre>
          &lt;value&gt; := &lt;signature-value&gt;
			</pre>
<p id="rfc.section.6.p.2">where: </p>
<p></p>

<dl>
<dt>&lt;signature-value&gt;</dt>
<dd style="margin-left: 8">is a field, of &lt;length&gt; octets, which contains the information, to be interpreted by the signature verification process, as specified by the Type Extension.  </dd>
</dl>

<p> </p>
<p id="rfc.section.6.p.4">Note that this does not stipulate how to calculate the &lt;signature-value&gt;, nor the internal structure hereof, if any; such MUST be specified by way of the Type Extension for the SIGNATURE TLV type, see <a href="#IANA">Section 13</a>. This document specifies two such type-extensions, for signatures without pre-defined structures, and for signatures constructed by way of a cryptographic operation over a hash-value.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#timestampTLVformat" id="timestampTLVformat">General Timestamp TLV Structure</a>
</h1>
<p id="rfc.section.7.p.1">The value of the Timestamp TLV is: </p>
<div id="#rfc.figure.2"></div>
<pre>
       &lt;value&gt; := &lt;time-value&gt;
	</pre>
<p id="rfc.section.7.p.2">where: </p>

<dl>
<dt>&lt;time-value&gt;</dt>
<dd style="margin-left: 8">is an unsigned integer field, of length &lt;length&gt;, which contains the timestamp.  </dd>
<dt></dt>
<dd style="margin-left: 8">Note that this does not stipulate how to calculate the &lt;time-value&gt;, nor the internal structure hereof, if any; such MUST be specified by way of the Type Extension for the TIMESTAMP TLV type, see <a href="#IANA">Section 13</a>.  </dd>
</dl>

<p> A timestamp is essentially "freshness information".  As such, its setting and interpretation is to be determined by the MANET routing protocol, or MANET routing protocol extension, that uses the timestamp, and may, e.g., correspond to a UNIX-timestamp, GPS timestamp or a simple sequence number.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#packetSignatures" id="packetSignatures">Packet TLVs</a>
</h1>
<p id="rfc.section.8.p.1">Two Packet TLVs are defined, for including the cryptographic signature of a packet, and for including the timestamp indicating the time at which the cryptographic signature was calculated.  </p>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#packetsignatureTLV" id="packetsignatureTLV">Packet SIGNATURE TLV</a>
</h1>
<p id="rfc.section.8.1.p.1">A Packet SIGNATURE TLV is an example of a Signature TLV as described in <a href="#signatureTLVformat">Section 6</a>.</p>
<p id="rfc.section.8.1.p.2">The following considerations apply: </p>

<ul>
<li>As packets defined in <a href="#RFC5444">[RFC5444]</a> are never forwarded by routers, no special considerations are required regarding mutable fields (e.g. &lt;msg-hop-count&gt; and &lt;msg-hop-limit&gt;), if present, when calculating the signature.  </li>
<li>Any Packet SIGNATURE TLVs already present in the Packet TLV block MUST be removed before calculating the signature, and the Packet TLV block size MUST be recalculated accordingly. The TLVs can be restored after having calculated the signature value.  </li>
</ul>
<p id="rfc.section.8.1.p.3">The rationale for removing any Packet SIGNATURE TLV already present prior to calculating the signature is that several signatures may be added to the same packet, e.g., using different signature functions.</p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> <a href="#packettimestampTLV" id="packettimestampTLV">Packet TIMESTAMP TLV</a>
</h1>
<p id="rfc.section.8.2.p.1">A Packet TIMESTAMP TLV is an example of a Timestamp TLV as described in <a href="#timestampTLVformat">Section 7</a>. If a packet contains a TIMESTAMP TLV and a SIGNATURE TLV, the TIMESTAMP TLV SHOULD be added to the packet before any SIGNATURE TLV, in order that it be included in the calculation of the signature.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#messageSignatures" id="messageSignatures">Message TLVs</a>
</h1>
<p id="rfc.section.9.p.1">Two Message TLVs are defined, for including the cryptographic signature of a message, and for including the timestamp indicating the time at which the cryptographic signature was calculated.  </p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> <a href="#signatureTLV" id="signatureTLV">Message SIGNATURE TLV</a>
</h1>
<p id="rfc.section.9.1.p.1">A Message SIGNATURE TLV is an example of a Signature TLV as described in <a href="#signatureTLVformat">Section 6</a>. When determining the &lt;signature-value&gt; for a message, the following considerations must be applied: </p>

<ul>
<li>The fields &lt;msg-hop-limit&gt; and &lt;msg-hop-count&gt;, if present, MUST both be assumed to have the value 0 (zero) when calculating the signature.  </li>
<li>Any Message SIGNATURE TLVs already present in the Message TLV block MUST be removed before calculating the signature, and the message size as well as the Message TLV block size MUST be recalculated accordingly. Removed SIGNATURE TLVs SHOULD be restored after having calculated the signature value.  </li>
</ul>

<p> </p>
<p id="rfc.section.9.1.p.2">The rationale for removing any Message SIGNATURE TLV already present prior to calculating the signature is that several signatures may be added to the same message, e.g., using different signature functions.  </p>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> <a href="#timestampTLV" id="timestampTLV">Message TIMESTAMP TLV</a>
</h1>
<p id="rfc.section.9.2.p.1">A Message TIMESTAMP TLV is an example of a Timestamp TLV as described in <a href="#timestampTLVformat">Section 7</a>. If a message contains a TIMESTAMP TLV and a SIGNATURE TLV, the TIMESTAMP TLV SHOULD be added to the message before the SIGNATURE TLV, in order that it be included in the calculation of the signature.  </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#addressblockSignatures" id="addressblockSignatures">Address Block TLVs</a>
</h1>
<p id="rfc.section.10.p.1">Two Address Block TLVs are defined, for associating a cryptographic signature to an address, and for including the timestamp indicating the time at which the cryptographic signature was calculated.  </p>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> <a href="#addressblocksignatureTLV" id="addressblocksignatureTLV">Address Block SIGNATURE TLV</a>
</h1>
<p id="rfc.section.10.1.p.1">An Address Block SIGNATURE TLV is an example of a Signature TLV as described in <a href="#signatureTLVformat">Section 6</a>. The signature is  calculated over the address, concatenated with any other values, for example, any other TLV value that is associated with that address. A MANET routing protocol or MANET routing protocol extension using Address Block SIGNATURE TLVs MUST specify how to include any such concatenated attribute of the address in the verification process of the signature.  </p>
<h1 id="rfc.section.10.2">
<a href="#rfc.section.10.2">10.2.</a> <a href="#addressblocktimestampTLV" id="addressblocktimestampTLV">Address Block TIMESTAMP TLV</a>
</h1>
<p id="rfc.section.10.2.p.1">An Address Block TIMESTAMP TLV is an example of a Timestamp TLV as described in <a href="#timestampTLVformat">Section 7</a>. If both a TIMESTAMP TLV and a SIGNATURE TLV are associated with an address, the timestamp value should be considered when calculating the value of the signature.  </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#simple" id="simple">Signature: Basic</a>
</h1>
<p id="rfc.section.11.p.1">The basic signature proposed, represented by way of a SIGNATURE TLV with Type Extension = 0, is a simple bit-field containing the cryptographic signature. This assumes that the mechanism stipulating how signatures are calculated and verified is established outside of this specification, e.g., by way of administrative configuration or external out-of-band signaling. Thus, the &lt;signature-value&gt; for when using Type Extension = 0 is: </p>
<div id="#rfc.figure.3"></div>
<pre>
          &lt;signature-value&gt; := &lt;signature-data&gt;
			</pre>
<p id="rfc.section.11.p.2">where: </p>

<dl>
<dt>&lt;signature-data&gt;</dt>
<dd style="margin-left: 8">is an  unsigned integer field, of length &lt;length&gt;, which contains the cryptographic signature.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#decomposition" id="decomposition">Signature: Cryptographic Function over a Hash Value</a>
</h1>
<p id="rfc.section.12.p.1">One common way of calculating a signature is applying a cryptographic function on a hash value of the content. This decomposition is specified in the following, using a Type Extension = 1 in the Signature TLVs.  </p>
<h1 id="rfc.section.12.1">
<a href="#rfc.section.12.1">12.1.</a> General Signature TLV Structure</h1>
<p id="rfc.section.12.1.p.1">The following data structure allows representation of a cryptographic signature, including specification of the appropriate hash function and cryptographic function used for calculating the signature: </p>
<div id="#rfc.figure.4"></div>
<pre>
          &lt;signature-value&gt; := &lt;hash-function&gt;
                               &lt;cryptographic-function&gt;
                               &lt;key-index&gt;
                               &lt;signature-data&gt;
			</pre>
<p id="rfc.section.12.1.p.2">where: <a href="#IANA">Section 13</a>.  </p>

<dl>
<dt>&lt;hash-function&gt;</dt>
<dd style="margin-left: 8">is an 8-bit unsigned integer field specifying the hash function.  </dd>
<dt>&lt;cryptographic-function&gt;</dt>
<dd style="margin-left: 8">is an 8-bit unsigned integer field specifying the cryptographic function.  </dd>
<dt>&lt;key-index&gt;</dt>
<dd style="margin-left: 8">is an 8-bit unsigned integer field specifying the key index of the key which was used to sign the message, which allows unique identification of different keys with the same originator.  It is the responsibility of each key              originator to make sure that actively used keys that it               issues have distinct key indices and that all key indices               have a value not equal to 0x00.  The value 0x00 is reserved for               a pre-installed, shared key.  </dd>
<dt>&lt;signature-data&gt;</dt>
<dd style="margin-left: 8">is an unsigned integer field, whose length is &lt;length&gt; - 3, and which contains the cryptographic signature.  </dd>
</dl>

<p> The version of this TLV, specified in this section, assumes that calculating the signature can be decomposed into: </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">signature-value = cryptographic-function(hash-function(content))</dd>
</dl>

<p> The hash function and the cryptographic function correspond to the entries in two IANA registries, set up by this specification in </p>
<h1 id="rfc.section.12.1.1">
<a href="#rfc.section.12.1.1">12.1.1.</a> <a href="#rationale" id="rationale">Rationale</a>
</h1>
<p id="rfc.section.12.1.1.p.1">The rationale for separating the hash function and the cryptographic function into two octets instead of having all combinations in a single octet - possibly as TLV type extension - is twofold: First, if further hash functions or cryptographic functions are added in the future, the number space might not remain continuous.  More importantly, the number space of possible combinations would be rapidly exhausted. As new or improved cryptographic mechanism are continuously being developed and introduced, this format should be able to accommodate such for the foreseeable future.  </p>
<p id="rfc.section.12.1.1.p.2">The rationale for not including a field that lists parameters of the cryptographic signature in the TLV is, that before being able to validate a cryptographic signature, routers have to exchange or acquire keys (e.g. public keys). Any additional parameters can be provided together with the keys in that bootstrap process. It is therefore not necessary, and would even entail an extra overhead, to transmit the parameters within every message.  One implicitly available parameter is the length of the signature, which is &lt;length&gt; - 3, and which depends on the choice of the cryptographic function.  </p>
<h1 id="rfc.section.12.2">
<a href="#rfc.section.12.2">12.2.</a> Considerations for Calculating the Signature</h1>
<p id="rfc.section.12.2.p.1">In the following, considerations are listed, which MUST be applied when calculating the signature for Packet, Message and Address SIGNATURE TLVs, respectively.  </p>
<h1 id="rfc.section.12.2.1">
<a href="#rfc.section.12.2.1">12.2.1.</a> Packet SIGNATURE TLV</h1>
<p id="rfc.section.12.2.1.p.1">When determining the &lt;signature-value&gt; for a Packet, the signature is calculated over the three fields &lt;hash-function&gt;, &lt;cryptographic-function&gt; and &lt;key-index&gt; (in that order), concatenated with the entire Packet, including the packet header, all Packet TLVs (other than Packet SIGNATURE TLVs) and all included Messages and their message headers, in accordance with <a href="#packetsignatureTLV">Section 8.1</a>.  </p>
<h1 id="rfc.section.12.2.2">
<a href="#rfc.section.12.2.2">12.2.2.</a> Message SIGNATURE TLV</h1>
<p id="rfc.section.12.2.2.p.1">When determining the &lt;signature-value&gt; for a message, the signature is calculated over the three fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;, and &lt;key-index&gt; (in that order), concatenated with the entire message. The considerations in <a href="#signatureTLV">Section 9.1</a> MUST be applied.  </p>
<h1 id="rfc.section.12.2.3">
<a href="#rfc.section.12.2.3">12.2.3.</a> Address Block SIGNATURE TLV</h1>
<p id="rfc.section.12.2.3.p.1">When determining the &lt;signature-value&gt; for an address, the signature is calculated over the three fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;, and &lt;key-index&gt; (in that order), concatenated with the address, concatenated with any other values, for example, any other TLV value that is associated with that address. A MANET routing protocol or MANET routing protocol extension using Address Block SIGNATURE TLVs MUST specify how to include any such concatenated attribute of the address in the verification process of the signature. The considerations in <a href="#addressblocktimestampTLV">Section 10.2</a> MUST be applied.  </p>
<h1 id="rfc.section.12.3">
<a href="#rfc.section.12.3">12.3.</a> Example of a Signed Message</h1>
<p id="rfc.section.12.3.p.1">The sample message depicted in <a href="#exampleMessage">Figure 5</a> is  derived from  appendix D of <a href="#RFC5444">[RFC5444]</a>. The message contains a SIGNATURE Message TLV, with the value representing a 16 octet long signature of the whole message. The type extension of the Message TLV is 1, for the specific decomposition of a signature into a cryptographic function over a hash value, as specified in <a href="#decomposition">Section 12</a>.  </p>
<div id="#rfc.figure.5"></div>
<div id="#exampleMessage"></div>
<pre>
   0                   1                   2                   3  
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | PV=0 |  PF=8  |    Packet Sequence Number     | Message Type  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | MF=15 | MAL=3 |      Message Length = 40      | Msg. Orig Addr|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |       Message Originator Address (cont)       |   Hop Limit   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Hop Count   |    Message Sequence Number    | Msg. TLV Block|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | Length = 30   |   SIGNATURE   |  MTLVF = 144  |  MTLVExt = 1  |  
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |Value Len = 19 |   Hash Func   |  Crypto Func  |    Key Index  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value                            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value (cont)                     |        
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
          </pre>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.13.p.1">This specification defines: </p>

<ul>
<li>two Packet TLV types, which MUST be allocated from the 0-223 range of the "Assigned Packet TLV Types" repository of <a href="#RFC5444">[RFC5444]</a> as specified in <a href="#table_IANA_packet_TLV_types">Table 1</a>,</li>
<li>two Message TLV types, which MUST be allocated from the 0-127 range of the "Assigned Message TLV Types" repository of <a href="#RFC5444">[RFC5444]</a> as specified in <a href="#table_IANA_message_TLV_types">Table 2</a>,</li>
<li>two Address Block TLV types, which MUST be allocated from the 0-127 range of the "Assigned Address Block TLV Types" repository of <a href="#RFC5444">[RFC5444]</a> as specified in <a href="#table_IANA_addressblock_TLV_types">Table 3</a>.</li>
</ul>

<p> This specification requests: </p>

<ul><li>creation of type extension registries for these TLV types with initial values as in <a href="#table_IANA_packet_TLV_types">Table 1</a> to <a href="#table_IANA_addressblock_TLV_types">Table 3</a>.</li></ul>

<p> </p>
<p id="rfc.section.13.p.2">IANA is requested to assign the same numerical value to the Packet TLV, Message TLV and Address Block TLV types with the same name.  </p>
<p id="rfc.section.13.p.3">The following terms are used with the meanings defined in <a href="#BCP26">[BCP26]</a>: "Namespace", "Assigned Value", "Registration", "Unassigned", "Reserved", "Hierarchical Allocation", and "Designated Expert".  </p>
<p id="rfc.section.13.p.4">The following policies are used with the meanings defined in <a href="#BCP26">[BCP26]</a>: "Private Use", "Expert Review", and "Standards Action".  </p>
<h1 id="rfc.section.13.1">
<a href="#rfc.section.13.1">13.1.</a> Expert Review: Evaluation Guidelines</h1>
<p id="rfc.section.13.1.p.1">For the registries for TLV type extensions where an Expert Review is required, the designated expert SHOULD take the same general recommendations into consideration as are specified by <a href="#RFC5444">[RFC5444]</a>.</p>
<p id="rfc.section.13.1.p.2">For the Timestamp TLV, the same type extensions for all Packet, Message and Address TLVs SHOULD be numbered identically.</p>
<h1 id="rfc.section.13.2">
<a href="#rfc.section.13.2">13.2.</a> Packet TLV Type Registrations</h1>
<p id="rfc.section.13.2.p.1">IANA is requested to make allocations from the "Packet TLV Types" namespace of <a href="#RFC5444">[RFC5444]</a> for the Packet TLVs  specified in <a href="#table_IANA_packet_TLV_types">Table 1</a>.  </p>
<div id="#rfc.table.1"></div>
<div id="#table_IANA_packet_TLV_types"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Packet TLV types</caption>
<thead><tr>
<th class="center">Name</th>
<th class="center">Type</th>
<th class="center">Type Extension</th>
<th class="center">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">SIGNATURE</td>
<td class="center">TBD1</td>
<td class="center">0</td>
<td class="center">Signature of a packet</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">1</td>
<td class="center">Signature, decomposed into cryptographic function over a hash value, as specified in <a href="#decomposition">Section 12</a> in this document.</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">2-223</td>
<td class="center">Expert Review</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">224-255</td>
<td class="center">Experimental Use</td>
</tr>
<tr>
<td class="center">TIMESTAMP</td>
<td class="center">TBD2</td>
<td class="center">0</td>
<td class="center">Unsigned timestamp of arbitrary length, given by the TLV length field. The MANET routing protocol has to define how to interpret this timestamp</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">1-223</td>
<td class="center">Expert Review</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">224-255</td>
<td class="center">Experimental Use</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.13.3">
<a href="#rfc.section.13.3">13.3.</a> Message TLV Type Registrations</h1>
<p id="rfc.section.13.3.p.1">IANA is requested to make allocations from the "Message TLV Types" namespace of <a href="#RFC5444">[RFC5444]</a> for the Message TLVs  specified in <a href="#table_IANA_message_TLV_types">Table 2</a>.  </p>
<div id="#rfc.table.2"></div>
<div id="#table_IANA_message_TLV_types"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Message TLV types</caption>
<thead><tr>
<th class="center">Name</th>
<th class="center">Type</th>
<th class="center">Type Extension</th>
<th class="center">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">SIGNATURE</td>
<td class="center">TBD3</td>
<td class="center">0</td>
<td class="center">Signature of a message</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">1</td>
<td class="center">Signature, decomposed into cryptographic function over a hash value, as specified in <a href="#decomposition">Section 12</a> in this document.</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">2-223</td>
<td class="center">Expert Review</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">224-255</td>
<td class="center">Experimental Use</td>
</tr>
<tr>
<td class="center">TIMESTAMP</td>
<td class="center">TBD4</td>
<td class="center">0</td>
<td class="center">Unsigned timestamp of arbitrary length, given by the TLV length field.</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">1-223</td>
<td class="center">Expert Review</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">224-255</td>
<td class="center">Experimental Use</td>
</tr>
</tbody>
</table>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>     </p>
<h1 id="rfc.section.13.4">
<a href="#rfc.section.13.4">13.4.</a> Address Block TLV Type Registrations</h1>
<p id="rfc.section.13.4.p.1">IANA is requested to make allocations from the "Address Block TLV Types" namespace of <a href="#RFC5444">[RFC5444]</a> for the Packet TLVs  specified in <a href="#table_IANA_addressblock_TLV_types">Table 3</a>.  </p>
<div id="#rfc.table.3"></div>
<div id="#table_IANA_addressblock_TLV_types"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Address Block TLV types</caption>
<thead><tr>
<th class="center">Name</th>
<th class="center">Type</th>
<th class="center">Type Extension</th>
<th class="center">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">SIGNATURE</td>
<td class="center">TBD5</td>
<td class="center">0</td>
<td class="center">Signature of an object (e.g. an address)</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">1</td>
<td class="center">Signature, decomposed into cryptographic function over a hash value, as specified in <a href="#decomposition">Section 12</a> in this document.</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">2-223</td>
<td class="center">Expert Review</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">224-255</td>
<td class="center">Experimental Use</td>
</tr>
<tr>
<td class="center">TIMESTAMP</td>
<td class="center">TBD6</td>
<td class="center">0</td>
<td class="center">Unsigned timestamp of arbitrary length, given by the TLV length field.</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">1-223</td>
<td class="center">Expert Review</td>
</tr>
<tr>
<td class="center"></td>
<td class="center"></td>
<td class="center">224-255</td>
<td class="center">Experimental Use</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.13.5">
<a href="#rfc.section.13.5">13.5.</a> Hash Function</h1>
<p id="rfc.section.13.5.p.1">IANA is requested to create a new registry for hash functions that can be used when creating a signature, as specified in <a href="#decomposition">Section 12</a> of this document. The initial assignments and allocation policies are specified in <a href="#table_hash_registry">Table 4</a>.  </p>
<div id="#rfc.table.4"></div>
<div id="#table_hash_registry"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Hash-Function registry</caption>
<thead><tr>
<th class="center">Hash function value</th>
<th class="center">Algorithm</th>
<th class="center">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="center">none</td>
<td class="center">The "identity function": the hash value of an object is the object itself</td>
</tr>
<tr>
<td class="center">1-223</td>
<td class="center"></td>
<td class="center">Expert Review</td>
</tr>
<tr>
<td class="center">224-255</td>
<td class="center"></td>
<td class="center">Experimental Use</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.13.6">
<a href="#rfc.section.13.6">13.6.</a> Cryptographic Algorithm</h1>
<p id="rfc.section.13.6.p.1">IANA is requested to create a new registry for the cryptographic function, as specified in <a href="#decomposition">Section 12</a> of this document. Initial assignments and allocation policies are specified in <a href="#table_cryptographic_registry">Table 5</a>.  </p>
<div id="#rfc.table.5"></div>
<div id="#table_cryptographic_registry"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Cryptographic function registry</caption>
<thead><tr>
<th class="center">Cryptographic function value</th>
<th class="center">Algorithm</th>
<th class="center">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="center">none</td>
<td class="center">The "identity function": the value of an encrypted hash is the hash itself</td>
</tr>
<tr>
<td class="center">1-223</td>
<td class="center"></td>
<td class="center">Expert Review</td>
</tr>
<tr>
<td class="center">224-255</td>
<td class="center"></td>
<td class="center">Experimental Use</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.14">
<a href="#rfc.section.14">14.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.14.p.1">This document does not specify a protocol. It provides a syntactical component for cryptographic signatures of messages and packets as defined in <a href="#RFC5444">[RFC5444]</a>. It can be used to address security issues of a MANET routing protocol or MANET routing protocol extension. As such, it has the same security considerations as <a href="#RFC5444">[RFC5444]</a>.</p>
<p id="rfc.section.14.p.2">In addition, a MANET routing protocol or MANET routing protocol extension that uses this specification MUST specify the usage as well as the security that is attained by the cryptographic signatures of a message or a packet.</p>
<p id="rfc.section.14.p.3">As an example, a MANET routing protocol that uses this component to reject "badly formed" messages if a control message does not contain a valid signature, SHOULD indicate the security assumption that if the signature is valid, the message is considered valid. It also SHOULD indicate the security issues that are counteracted by this measure (e.g. link or identity spoofing) as well as the issues that are not counteracted (e.g. compromised keys).  </p>
<h1 id="rfc.section.15">
<a href="#rfc.section.15">15.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.15.p.1">The authors would like to thank Bo Berry (Cisco), Alan Cullen (BAE), Justin Dean (NRL), Christopher Dearlove (BAE), Paul Lambert (Marvell), Jerome Milan (Ecole Polytechnique) and Henning Rogge (FGAN) for their constructive comments on the document.</p>
<h1 id="rfc.references">
<a href="#rfc.references">16.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">16.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="BCP26">[BCP26]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", RFC 5226, BCP 26, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", RFC 2119, BCP 14, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5444">[RFC5444]</b></td>
<td class="top">
<a title="Ecole Polytechnique, France">Clausen, T.H.</a>, <a title="BAE Systems Advanced Technology Centre, UK">Dearlove, C.M.</a>, <a title="Naval Research Laboratory, USA">Dean, J.W.</a> and <a title="INRIA Rocquencourt">C. Adjih</a>, "<a href="http://tools.ietf.org/html/rfc5444">Generalized MANET Packet/Message Format</a>", RFC 5444, February 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">16.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC6130">[RFC6130]</b></td>
<td class="top">
<a title="Ecole Polytechnique, France">Clausen, T.H.</a>, <a title="Naval Research Laboratory, USA">Dean, J.W.</a> and <a title="BAE Systems Advanced Technology Centre, UK">C.M. Dearlove</a>, "<a href="http://tools.ietf.org/html/rfc6130">MANET Neighborhood Discovery Protocol (NHDP)</a>", RFC 6130, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="OLSRv2">[OLSRv2]</b></td>
<td class="top">
<a title="Ecole Polytechnique, France">Clausen, T.H.</a>, <a title="BAE Systems Advanced Technology Centre, UK">Dearlove, C.M.</a> and <a title="Project Hipercom, INRIA Rocquencourt, France">P. Jacquet</a>, "<a>The Optimized Link State Routing Protocol version 2</a>", work in progress draft-ietf-manet-olsrv2-13.txt, October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ulrich Herberg</span> 
	  <span class="n hidden">
		<span class="family-name">Herberg</span>
	  </span>
	</span>
	<span class="org vcardline">Fujitsu Laboratories of America</span>
	<span class="adr">
	  <span>1240 E. Arques Ave. M/S 345</span>

	  <span class="vcardline">
		<span class="locality">Sunnyvale</span>,  
		<span class="region">CA, 94085</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ulrich@herberg.name">ulrich@herberg.name</a></span>

<span class="vcardline">URI: <a href="http://www.herberg.name/">http://www.herberg.name/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Thomas Heide Clausen</span> 
	  <span class="n hidden">
		<span class="family-name">Clausen</span>
	  </span>
	</span>
	<span class="org vcardline">LIX, Ecole Polytechnique</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">91128 Palaiseau Cedex</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">Phone: +33 6 6058 9349</span>

<span class="vcardline">EMail: <a href="mailto:T.Clausen@computer.org">T.Clausen@computer.org</a></span>

<span class="vcardline">URI: <a href="http://www.thomasclausen.org/">http://www.thomasclausen.org/</a></span>

  </address>
</div>

</body>
</html>