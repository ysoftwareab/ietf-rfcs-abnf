<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Transmission of IP Packets over Overlay Multilink Network (OMNI) Interfaces</title>
<meta content="Fred L. Templin" name="author">
<meta content="Tony Whyman" name="author">
<meta content="
       Mobile network platforms and devices (e.g., aircraft of various
      configurations, terrestrial vehicles, seagoing vessels, enterprise
      wireless devices, pedestrians with cell phones, etc.) communicate with
      networked correspondents over multiple access network data links and
      configure mobile routers to connect end user networks. A multilink
      interface specification is presented that enables mobile nodes to
      coordinate with a network-based mobility service and/or with other
      mobile node peers. This document specifies the transmission of IP
      packets over Overlay Multilink Network (OMNI) Interfaces. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="I-D" name="keyword">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-templin-6man-omni-35" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/35a-npvj4zdo.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">IPv6 over OMNI Interfaces</td>
<td class="right">August 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Templin &amp; Whyman</td>
<td class="center">Expires 11 February 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-templin-6man-omni-35</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-08-10" class="published">10 August 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-02-11">11 February 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. L. Templin, <span class="editor">Ed.</span>
</div>
<div class="org">The Boeing Company</div>
</div>
<div class="author">
      <div class="author-name">A. Whyman</div>
<div class="org">MWA Ltd c/o Inmarsat Global Ltd</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Transmission of IP Packets over Overlay Multilink Network (OMNI) Interfaces</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Mobile network platforms and devices (e.g., aircraft of various
      configurations, terrestrial vehicles, seagoing vessels, enterprise
      wireless devices, pedestrians with cell phones, etc.) communicate with
      networked correspondents over multiple access network data links and
      configure mobile routers to connect end user networks. A multilink
      interface specification is presented that enables mobile nodes to
      coordinate with a network-based mobility service and/or with other
      mobile node peers. This document specifies the transmission of IP
      packets over Overlay Multilink Network (OMNI) Interfaces.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 11 February 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty ulBare">
<li class="toc compact ulEmpty ulBare" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-requirements" class="xref">Requirements</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-overlay-multilink-network-o" class="xref">Overlay Multilink Network (OMNI) Interface Model</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-omni-interface-maximum-tran" class="xref">OMNI Interface Maximum Transmission Unit (MTU)</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-the-omni-adaptation-layer-o" class="xref">The OMNI Adaptation Layer (OAL)</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-oal-source-encapsulation-an" class="xref">OAL Source Encapsulation and Fragmentation</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-oal-net-encapsulation-and-r" class="xref">OAL *NET Encapsulation and Re-Encapsulation</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-oal-net-decapsulation-and-r" class="xref">OAL *NET Decapsulation and Reassembly</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-oal-header-compression" class="xref">OAL Header Compression</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-carrier-packet-in-carrier-p" class="xref">Carrier Packet in Carrier Packet Encapsulation</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-oal-identification-window-m" class="xref">OAL Identification Window Maintenance</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="xref">6.7</a>.  <a href="#name-oal-fragment-retransmission" class="xref">OAL Fragment Retransmission</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="xref">6.8</a>.  <a href="#name-oal-mtu-feedback-messaging" class="xref">OAL MTU Feedback Messaging</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="xref">6.9</a>.  <a href="#name-oal-requirements" class="xref">OAL Requirements</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a href="#section-6.10" class="xref">6.10</a>. <a href="#name-oal-fragmentation-security-" class="xref">OAL Fragmentation Security Implications</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6.2.11">
                <p id="section-toc.1-1.6.2.11.1"><a href="#section-6.11" class="xref">6.11</a>. <a href="#name-oal-super-packets" class="xref">OAL Super-Packets</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-frame-format" class="xref">Frame Format</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-link-local-addresses-llas" class="xref">Link-Local Addresses (LLAs)</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-unique-local-addresses-ulas" class="xref">Unique-Local Addresses (ULAs)</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-global-unicast-addresses-gu" class="xref">Global Unicast Addresses (GUAs)</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-node-identification" class="xref">Node Identification</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-address-mapping-unicast" class="xref">Address Mapping - Unicast</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-the-omni-option" class="xref">The OMNI Option</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-omni-sub-options" class="xref">OMNI Sub-Options</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a href="#section-12.2.1" class="xref">12.2.1</a>.  <a href="#name-pad1" class="xref">Pad1</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.2">
                    <p id="section-toc.1-1.12.2.2.2.2.1"><a href="#section-12.2.2" class="xref">12.2.2</a>.  <a href="#name-padn" class="xref">PadN</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.3">
                    <p id="section-toc.1-1.12.2.2.2.3.1"><a href="#section-12.2.3" class="xref">12.2.3</a>.  <a href="#name-interface-attributes" class="xref">Interface Attributes</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.4">
                    <p id="section-toc.1-1.12.2.2.2.4.1"><a href="#section-12.2.4" class="xref">12.2.4</a>.  <a href="#name-multilink-forwarding-parame" class="xref">Multilink Forwarding Parameters</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.5">
                    <p id="section-toc.1-1.12.2.2.2.5.1"><a href="#section-12.2.5" class="xref">12.2.5</a>.  <a href="#name-traffic-selector" class="xref">Traffic Selector</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.6">
                    <p id="section-toc.1-1.12.2.2.2.6.1"><a href="#section-12.2.6" class="xref">12.2.6</a>.  <a href="#name-geo-coordinates" class="xref">Geo Coordinates</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.7">
                    <p id="section-toc.1-1.12.2.2.2.7.1"><a href="#section-12.2.7" class="xref">12.2.7</a>.  <a href="#name-dynamic-host-configuration-" class="xref">Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Message</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.8">
                    <p id="section-toc.1-1.12.2.2.2.8.1"><a href="#section-12.2.8" class="xref">12.2.8</a>.  <a href="#name-host-identity-protocol-hip-" class="xref">Host Identity Protocol (HIP) Message</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.9">
                    <p id="section-toc.1-1.12.2.2.2.9.1"><a href="#section-12.2.9" class="xref">12.2.9</a>.  <a href="#name-pim-sm-message" class="xref">PIM-SM Message</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.10">
                    <p id="section-toc.1-1.12.2.2.2.10.1"><a href="#section-12.2.10" class="xref">12.2.10</a>. <a href="#name-reassembly-limit" class="xref">Reassembly Limit</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.11">
                    <p id="section-toc.1-1.12.2.2.2.11.1"><a href="#section-12.2.11" class="xref">12.2.11</a>. <a href="#name-fragmentation-report" class="xref">Fragmentation Report</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.12">
                    <p id="section-toc.1-1.12.2.2.2.12.1"><a href="#section-12.2.12" class="xref">12.2.12</a>. <a href="#name-node-identification-2" class="xref">Node Identification</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.13">
                    <p id="section-toc.1-1.12.2.2.2.13.1"><a href="#section-12.2.13" class="xref">12.2.13</a>. <a href="#name-icmpv6-error" class="xref">ICMPv6 Error</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12.2.2.2.14">
                    <p id="section-toc.1-1.12.2.2.2.14.1"><a href="#section-12.2.14" class="xref">12.2.14</a>. <a href="#name-sub-type-extension" class="xref">Sub-Type Extension</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-address-mapping-multicast" class="xref">Address Mapping - Multicast</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-multilink-conceptual-sendin" class="xref">Multilink Conceptual Sending Algorithm</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-multiple-omni-interfaces" class="xref">Multiple OMNI Interfaces</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-client-proxy-server-loop-pr" class="xref">Client-Proxy/Server Loop Prevention</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-router-discovery-and-prefix" class="xref">Router Discovery and Prefix Registration</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-window-synchronization" class="xref">Window Synchronization</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-router-discovery-in-ip-mult" class="xref">Router Discovery in IP Multihop and IPv4-Only Networks</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="xref">15.3</a>.  <a href="#name-dhcpv6-based-prefix-registr" class="xref">DHCPv6-based Prefix Registration</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-secure-redirection" class="xref">Secure Redirection</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="xref">17</a>. <a href="#name-proxy-server-resilience" class="xref">Proxy/Server Resilience</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="xref">18</a>. <a href="#name-detecting-and-responding-to" class="xref">Detecting and Responding to Proxy/Server Failures</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-19" class="xref">19</a>. <a href="#name-transition-considerations" class="xref">Transition Considerations</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#section-20" class="xref">20</a>. <a href="#name-omni-interfaces-on-open-int" class="xref">OMNI Interfaces on Open Internetworks</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#section-21" class="xref">21</a>. <a href="#name-time-varying-mnps" class="xref">Time-Varying MNPs</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#section-22" class="xref">22</a>. <a href="#name-hhits-and-temporary-ulas" class="xref">(H)HITs and Temporary ULAs</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#section-23" class="xref">23</a>. <a href="#name-address-selection" class="xref">Address Selection</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.24">
            <p id="section-toc.1-1.24.1"><a href="#section-24" class="xref">24</a>. <a href="#name-error-messages" class="xref">Error Messages</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.25">
            <p id="section-toc.1-1.25.1"><a href="#section-25" class="xref">25</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.1">
                <p id="section-toc.1-1.25.2.1.1"><a href="#section-25.1" class="xref">25.1</a>.  <a href="#name-protocol-numbers-registry" class="xref">"Protocol Numbers" Registry</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.2">
                <p id="section-toc.1-1.25.2.2.1"><a href="#section-25.2" class="xref">25.2</a>.  <a href="#name-ieee-802-numbers-registry" class="xref">"IEEE 802 Numbers" Registry</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.3">
                <p id="section-toc.1-1.25.2.3.1"><a href="#section-25.3" class="xref">25.3</a>.  <a href="#name-ipv4-special-purpose-addres" class="xref">"IPv4 Special-Purpose Address" Registry</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.4">
                <p id="section-toc.1-1.25.2.4.1"><a href="#section-25.4" class="xref">25.4</a>.  <a href="#name-ipv6-neighbor-discovery-opt" class="xref">"IPv6 Neighbor Discovery Option Formats" Registry</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.5">
                <p id="section-toc.1-1.25.2.5.1"><a href="#section-25.5" class="xref">25.5</a>.  <a href="#name-ethernet-numbers-registry" class="xref">"Ethernet Numbers" Registry</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.6">
                <p id="section-toc.1-1.25.2.6.1"><a href="#section-25.6" class="xref">25.6</a>.  <a href="#name-icmpv6-code-fields-type-2-p" class="xref">"ICMPv6 Code Fields: Type 2 - Packet Too Big" Registry</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.7">
                <p id="section-toc.1-1.25.2.7.1"><a href="#section-25.7" class="xref">25.7</a>.  <a href="#name-omni-option-sub-type-values" class="xref">"OMNI Option Sub-Type Values" (New Registry)</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.8">
                <p id="section-toc.1-1.25.2.8.1"><a href="#section-25.8" class="xref">25.8</a>.  <a href="#name-omni-geo-coordinates-type-v" class="xref">"OMNI Geo Coordinates Type Values" (New Registry)</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.9">
                <p id="section-toc.1-1.25.2.9.1"><a href="#section-25.9" class="xref">25.9</a>.  <a href="#name-omni-node-identification-id" class="xref">"OMNI Node Identification ID-Type Values" (New Registry)</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.10">
                <p id="section-toc.1-1.25.2.10.1"><a href="#section-25.10" class="xref">25.10</a>. <a href="#name-omni-option-sub-type-extens" class="xref">"OMNI Option Sub-Type Extension Values" (New Registry)</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.11">
                <p id="section-toc.1-1.25.2.11.1"><a href="#section-25.11" class="xref">25.11</a>. <a href="#name-omni-rfc4380-udp-ip-header-" class="xref">"OMNI RFC4380 UDP/IP Header Option" (New Registry)</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.12">
                <p id="section-toc.1-1.25.2.12.1"><a href="#section-25.12" class="xref">25.12</a>. <a href="#name-omni-rfc6081-udp-ip-trailer" class="xref">"OMNI RFC6081 UDP/IP Trailer Option" (New Registry)</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.25.2.13">
                <p id="section-toc.1-1.25.2.13.1"><a href="#section-25.13" class="xref">25.13</a>. <a href="#name-additional-considerations" class="xref">Additional Considerations</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.26">
            <p id="section-toc.1-1.26.1"><a href="#section-26" class="xref">26</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.27">
            <p id="section-toc.1-1.27.1"><a href="#section-27" class="xref">27</a>. <a href="#name-implementation-status" class="xref">Implementation Status</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.28">
            <p id="section-toc.1-1.28.1"><a href="#section-28" class="xref">28</a>. <a href="#name-document-updates" class="xref">Document Updates</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.29">
            <p id="section-toc.1-1.29.1"><a href="#section-29" class="xref">29</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.30">
            <p id="section-toc.1-1.30.1"><a href="#section-30" class="xref">30</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.30.2.1">
                <p id="section-toc.1-1.30.2.1.1"><a href="#section-30.1" class="xref">30.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.30.2.2">
                <p id="section-toc.1-1.30.2.2.1"><a href="#section-30.2" class="xref">30.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.31">
            <p id="section-toc.1-1.31.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-oal-checksum-algorithm" class="xref">OAL Checksum Algorithm</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.32">
            <p id="section-toc.1-1.32.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-ipv6-nd-message-authenticat" class="xref">IPv6 ND Message Authentication and Integrity</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.33">
            <p id="section-toc.1-1.33.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-vdl-mode-2-considerations" class="xref">VDL Mode 2 Considerations</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.34">
            <p id="section-toc.1-1.34.1"><a href="#appendix-D" class="xref">Appendix D</a>.  <a href="#name-client-proxy-server-isolati" class="xref">Client-Proxy/Server Isolation Through L2 Address Mapping</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.35">
            <p id="section-toc.1-1.35.1"><a href="#appendix-E" class="xref">Appendix E</a>.  <a href="#name-change-log" class="xref">Change Log</a></p>
</li>
          <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.36">
            <p id="section-toc.1-1.36.1"><a href="#appendix-F" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Mobile network platforms and devices (e.g., aircraft of various
      configurations, terrestrial vehicles, seagoing vessels, enterprise
      wireless devices, pedestrians with cellphones, etc.) configure mobile
      routers with multiple interface connections to wireless and/or
      wired-line data links. These data links may have diverse performance,
      cost and availability properties that can change dynamically according
      to mobility patterns, flight phases, proximity to infrastructure, etc.
      The mobile router acts as a Client of a network-based Mobility Service
      (MS) by configuring a virtual interface over its underlying interface
      data link connections to support the "6M's of modern Internetworking"
      (see below).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Each Client configures a virtual interface (termed the "Overlay
      Multilink Network Interface (OMNI)") as a thin layer over its underlying
      interfaces. The OMNI interface is therefore the only interface
      abstraction exposed to the IP layer and behaves according to the
      Non-Broadcast, Multiple Access (NBMA) interface principle, while
      underlying interfaces appear as link layer communication channels in the
      architecture. The OMNI interface internally employs the "OMNI Adaptation
      Layer (OAL)" to ensure that original IP packets are delivered without
      loss due to size restrictions. The OMNI interface connects to a virtual
      overlay service known as the "OMNI link". The OMNI link spans one or
      more Internetworks that may include private-use infrastructures and/or
      the global public Internet itself.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The Client's OMNI interface interacts with the MS and/or other
      Clients through IPv6 Neighbor Discovery (ND) control message exchanges
      <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>. The MS consists of a distributed set of
      Proxy/Servers (and other infrastructure elements) that also configure
      OMNI interfaces. An example MS termed "Automatic Extended Route
      Optimization (AERO)" appears in <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>.
      In terms of precedence, the AERO specification may provide
      first-principle insights into a representative mobility service
      architecture as context for this specification.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Each OMNI interface provides a multilink nexus for exchanging inbound
      and outbound traffic via the correct underlying interface(s). The IP
      layer sees the OMNI interface as a point of connection to the OMNI link.
      Each OMNI link has one or more associated Mobility Service Prefixes
      (MSPs), which are typically IP Global Unicast Address (GUA) prefixes
      assigned to the link and from which Mobile Network Prefixes (MNPs) are
      derived. If there are multiple OMNI links, the IP layer will see
      multiple OMNI interfaces.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Each Client receives an MNP through IPv6 ND control message exchanges
      with Proxy/Servers. The Client uses the MNP for numbering
      downstream-attached End User Networks (EUNs) independently of the access
      network data links selected for data transport. The Client acts as a
      mobile router on behalf of its EUNs, and uses OMNI interface control
      messaging to coordinate with Proxy/Servers and/or other Clients. The
      Client iterates its control messaging over each of the OMNI interface's
      underlying interfaces in order to register each interface with the MS
      (see <a href="#aeropd" class="xref">Section 15</a>).<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Clients may connect to multiple distinct OMNI links within the same
      OMNI domain by configuring multiple OMNI interfaces, e.g., omni0, omni1,
      omni2, etc. Each OMNI interface is configured over a set of underlying
      interfaces and provides a nexus for Safety-Based Multilink (SBM)
      operation. Each OMNI interface within the same OMNI domain configures a
      common ULA prefix [ULA]::/48, and configures a unique 16-bit Subnet ID
      '*' to construct the sub-prefix [ULA*]::/64 (see: <a href="#span-address" class="xref">Section 9</a>). The IP layer applies SBM routing to select a
      specific OMNI interface, then the selected OMNI interface applies
      Performance-Based Multilink (PBM) internally to select appropriate
      underlying interfaces. Applications select SBM topologies based on IP
      layer Segment Routing <span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span>, while each OMNI
      interface orchestrates PBM internally based on OMNI layer Segment
      Routing.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">OMNI provides a link model suitable for a wide range of use cases. In
      particular, the International Civil Aviation Organization (ICAO) Working
      Group-I Mobility Subgroup is developing a future Aeronautical
      Telecommunications Network with Internet Protocol Services (ATN/IPS) and
      has issued a liaison statement requesting IETF adoption <span>[<a href="#ATN" class="xref">ATN</a>]</span> in support of ICAO Document 9896 <span>[<a href="#ATN-IPS" class="xref">ATN-IPS</a>]</span>. The IETF IP Wireless Access in Vehicular
      Environments (ipwave) working group has further included problem
      statement and use case analysis for OMNI in a document now in AD
      evaluation for RFC publication <span>[<a href="#I-D.ietf-ipwave-vehicular-networking" class="xref">I-D.ietf-ipwave-vehicular-networking</a>]</span>. Still other communities
      of interest include AEEC, RTCA Special Committee 228 (SC-228) and NASA
      programs that examine commercial aviation, Urban Air Mobility (UAM) and
      Unmanned Air Systems (UAS). Pedestrians with handheld devices represent
      another large class of potential OMNI users.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">OMNI supports the "6M's of modern Internetworking" including:<a href="#section-1-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-9">
<li id="section-1-9.1">Multilink - a Client's ability to coordinate multiple
          diverse underlying data links as a single logical unit (i.e., the
          OMNI interface) to achieve the required communications performance
          and reliability objectives.<a href="#section-1-9.1" class="pilcrow">¶</a>
</li>
        <li id="section-1-9.2">Multinet - the ability to span the OMNI link over a segment
          routing topology with multiple diverse network administrative
          domains while maintaining seamless end-to-end communications between
          mobile Clients and correspondents such as air traffic controllers,
          fleet administrators, etc.<a href="#section-1-9.2" class="pilcrow">¶</a>
</li>
        <li id="section-1-9.3">Mobility - a Client's ability to change network
          points of attachment (e.g., moving between wireless base stations)
          which may result in an underlying interface address change, but
          without disruptions to ongoing communication sessions with peers
          over the OMNI link.<a href="#section-1-9.3" class="pilcrow">¶</a>
</li>
        <li id="section-1-9.4">Multicast - the ability to send a single network
          transmission that reaches multiple Clients belonging to the same
          interest group, but without disturbing other Clients not subscribed
          to the interest group.<a href="#section-1-9.4" class="pilcrow">¶</a>
</li>
        <li id="section-1-9.5">Multihop - a mobile Client vehicle-to-vehicle relaying
          capability useful when multiple forwarding hops between vehicles may
          be necessary to "reach back" to an infrastructure access
          point connection to the OMNI link.<a href="#section-1-9.5" class="pilcrow">¶</a>
</li>
        <li id="section-1-9.6">MTU assurance - the ability to deliver packets of various
          robust sizes between peers without loss due to a link size
          restriction, and to dynamically adjust packets sizes to achieve the
          optimal performance for each independent traffic flow.<a href="#section-1-9.6" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-1-10">This document specifies the transmission of IP packets and control
      messages over OMNI interfaces. The OMNI interface supports either IP
      protocol version (i.e., IPv4 <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span> or IPv6 <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>) as the network layer data plane, while using IPv6 ND
      messaging as the control plane independently of the data plane IP
      protocol(s). The OAL operates as a sublayer between L3 and L2 based on
      IPv6 encapsulation <span>[<a href="#RFC2473" class="xref">RFC2473</a>]</span> as discussed in the
      following sections.<a href="#section-1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The terminology in the normative references applies; especially, the
      terms "link" and "interface" are the same as defined in the IPv6 <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> and IPv6 Neighbor Discovery (ND) <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> specifications. Additionally, this document assumes
      the following IPv6 ND message types: Router Solicitation (RS), Router
      Advertisement (RA), Neighbor Solicitation (NS), Neighbor Advertisement
      (NA) and Redirect. Clients and Proxy/Servers that implement IPv6 ND
      maintain per-neighbor state in Neighbor Cache Entries (NCEs). Each NCE
      is indexed by the neighbor's Link-Local Address (LLA), while the
      Unique-Local Address (ULA) used for encapsulation provides context for
      Identification verification.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The Protocol Constants defined in Section 10 of <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> are used in their same format and meaning in this
      document. The terms "All-Routers multicast", "All-Nodes multicast" and
      "Subnet-Router anycast" are the same as defined in <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span> (with Link-Local scope assumed).<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The term "IP" is used to refer collectively to either Internet
      Protocol version (i.e., IPv4 <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span> or IPv6 <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>) when a specification at the layer in question
      applies equally to either version.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The following terms are defined within the scope of this
      document:<a href="#section-2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2-5">
        <dt id="section-2-5.1">Client</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.2">a network platform/device mobile
          router that has one or more distinct upstream data link connections
          grouped together into one or more logical units. The Client's data
          link connection parameters can change over time due to, e.g., node
          mobility, link quality, etc. The Client further connects
          downstream-attached End User Networks (EUNs).<a href="#section-2-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.3">End User Network (EUN)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.4">a simple or complex
          downstream-attached mobile network that travels with the Client as a
          single logical unit. The IP addresses assigned to EUN devices remain
          stable even if the Client's upstream data link connections
          change.<a href="#section-2-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.5">Mobility Service (MS)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.6">a mobile routing
          service that tracks Client movements and ensures that Clients remain
          continuously reachable even across mobility events. The MS consists
          of the set of all Proxy/Servers (and any other supporting
          infrastructure nodes) for the OMNI link. Specific MS details are out
          of scope for this document, with an example found in <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>.<a href="#section-2-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.7">Proxy/Server</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.8">a segment routing topology edge
          node that provides Clients with a multi-purpose interface to the MS.
          As a server, the Proxy/Server responds directly to some Client IPv6
          ND messages. As a proxy, the Proxy/Server forwards other Client IPv6
          ND messages to other Proxy/Servers and Clients. As a router, the
          Proxy/Server provides a forwarding service for ordinary data packets
          that may be essential in some environments and a last resort in
          others.<a href="#section-2-5.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.9">Hub Proxy/Server</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.10">a single Proxy/Server
          selected by the Client that provides a designated router and
          mobility anchor point service for all of the Client's underlying
          interfaces. Clients normally select the first FHS Proxy/Server they
          coordinate with to serve in the Hub role, as all FHS Proxy/Servers
          are equally capable candidates to serve in that capacity.<a href="#section-2-5.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.11">First-Hop Segment (FHS) Proxy/Server</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.12">a
          Proxy/Server for an underlying interface of the source Client that
          forwards packets sent by the source Client over that interface into
          the segment routing topology. FHS Proxy/Servers act as intermediate
          forwarding nodes to facilitate RS/RA exchanges between a Client and
          its Hub Proxy/Server.<a href="#section-2-5.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.13">Last-Hop Segment (LHS) Proxy/Server</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.14">a
          Proxy/Server for an underlying interface of the target Client that
          forwards packets received from the segment routing topology to the
          target Client over that interface.<a href="#section-2-5.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.15">Segment Routing Topology (SRT)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.16">a multinet
          forwarding region between the FHS Proxy/Server and LHS Proxy/Server.
          FHS/LHS Proxy/Servers and the SRT span the OMNI link on behalf of
          source/target Client pairs using segment routing in a manner outside
          the scope of this document (see: <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>).<a href="#section-2-5.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.17">Mobility Service Prefix (MSP)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.18">an aggregated
          IP Global Unicast Address (GUA) prefix (e.g., 2001:db8::/32,
          192.0.2.0/24, etc.) assigned to the OMNI link and from which
          more-specific Mobile Network Prefixes (MNPs) are delegated. OMNI
          link administrators typically obtain MSPs from an Internet address
          registry, however private-use prefixes can alternatively be used
          subject to certain limitations (see: <a href="#gua" class="xref">Section 10</a>). OMNI
          links that connect to the global Internet advertise their MSPs to
          their interdomain routing peers.<a href="#section-2-5.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.19">Mobile Network Prefix (MNP)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.20">a longer IP
          prefix delegated from an MSP (e.g., 2001:db8:1000:2000::/56,
          192.0.2.8/30, etc.) and assigned to a Client. Clients sub-delegate
          the MNP to devices located in EUNs. Note that OMNI link Relay nodes
          may also service non-MNP routes (i.e., GUA prefixes not covered by
          an MSP) but that these correspond to fixed correspondent nodes and
          not Clients. Other than this distinction, MNP and non-MNP routes are
          treated exactly the same by the OMNI routing system.<a href="#section-2-5.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.21">Access Network (ANET)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.22">a data link service
          network (e.g., an aviation radio access network, satellite service
          provider network, cellular operator network, WiFi network, etc.)
          that connects Clients. Physical and/or data link level security is
          assumed, and sometimes referred to as "protected spectrum". Private
          enterprise networks and ground domain aviation service networks may
          provide multiple secured IP hops between the Client's point of
          connection and the nearest Proxy/Server.<a href="#section-2-5.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.23">ANET interface</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.24">a Client's attachment to a
          link in an ANET.<a href="#section-2-5.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.25">Internetwork (INET)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.26">a connected network
          region with a coherent IP addressing plan that provides transit
          forwarding services between ANETs and nodes that connect directly to
          the open INET via unprotected media. No physical and/or data link
          level security is assumed, therefore security must be applied by
          upper layers. The global public Internet itself is an example.<a href="#section-2-5.26" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.27">INET interface</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.28">a node's attachment to a link
          in an INET.<a href="#section-2-5.28" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.29">*NET</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.30">a "wildcard" term used when a given
          specification applies equally to both ANET and INET cases.<a href="#section-2-5.30" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.31">OMNI link</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.32">a Non-Broadcast, Multiple Access
          (NBMA) virtual overlay configured over one or more INETs and their
          connected ANETs. An OMNI link may comprise multiple INET segments
          joined by bridges the same as for any link; the addressing plans in
          each segment may be mutually exclusive and managed by different
          administrative entities.<a href="#section-2-5.32" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.33">OMNI interface</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.34">a node's attachment to an OMNI
          link, and configured over one or more underlying *NET interfaces. If
          there are multiple OMNI links in an OMNI domain, a separate OMNI
          interface is configured for each link.<a href="#section-2-5.34" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.35">OMNI Adaptation Layer (OAL)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.36">an OMNI interface
          sublayer service whereby original IP packets admitted into the
          interface are wrapped in an IPv6 header and subject to fragmentation
          and reassembly. The OAL is also responsible for generating
          MTU-related control messages as necessary, and for providing
          addressing context for OMNI link SRT traversal.<a href="#section-2-5.36" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.37">original IP packet</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.38">a whole IP packet or
          fragment admitted into the OMNI interface by the network layer prior
          to OAL encapsulation and fragmentation, or an IP packet delivered to
          the network layer by the OMNI interface following OAL decapsulation
          and reassembly.<a href="#section-2-5.38" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.39">OAL packet</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.40">an original IP packet encapsulated
          in OAL headers and trailers, which is then submitted for OAL
          fragmentation and reassembly.<a href="#section-2-5.40" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.41">OAL fragment</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.42">a portion of an OAL packet
          following fragmentation but prior to *NET encapsulation, or
          following *NET encapsulation but prior to OAL reassembly.<a href="#section-2-5.42" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.43">(OAL) atomic fragment</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.44">an OAL packet that does
          not require fragmentation is always encapsulated as an "atomic
          fragment" with a Fragment Header with Fragment Offset and More
          Fragments both set to 0, but with a valid Identification value.<a href="#section-2-5.44" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.45">(OAL) carrier packet</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.46">an encapsulated OAL
          fragment following *NET encapsulation or prior to *NET
          decapsulation. OAL sources and destinations exchange carrier packets
          over underlying interfaces, and may be separated by one or more OAL
          intermediate nodes. OAL intermediate nodes may perform
          re-encapsulation on carrier packets by removing the *NET headers of
          the first hop network and replacing them with new *NET headers for
          the next hop network.<a href="#section-2-5.46" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.47">OAL source</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.48">an OMNI interface acts as an OAL
          source when it encapsulates original IP packets to form OAL packets,
          then performs OAL fragmentation and *NET encapsulation to create
          carrier packets.<a href="#section-2-5.48" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.49">OAL destination</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.50">an OMNI interface acts as an
          OAL destination when it decapsulates carrier packets, then performs
          OAL reassembly and decapsulation to derive the original IP
          packet.<a href="#section-2-5.50" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.51">OAL intermediate node</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.52">an OMNI interface acts
          as an OAL intermediate node when it removes the *NET headers of
          carrier packets received on a first segment, then re-encapsulates
          the carrier packets in new *NET headers and forwards them into the
          next segment.<a href="#section-2-5.52" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.53">OMNI Option</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.54">an IPv6 Neighbor Discovery option
          providing multilink parameters for the OMNI interface as specified
          in <a href="#interface" class="xref">Section 12</a>.<a href="#section-2-5.54" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.55">Mobile Network Prefix Link Local Address (MNP-LLA)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.56">an
          IPv6 Link Local Address that embeds the most significant 64 bits of
          an MNP in the lower 64 bits of fe80::/64, as specified in <a href="#aero-address" class="xref">Section 8</a>.<a href="#section-2-5.56" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.57">Mobile Network Prefix Unique Local Address (MNP-ULA)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.58">an
          IPv6 Unique-Local Address derived from an MNP-LLA.<a href="#section-2-5.58" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.59">Administrative Link Local Address (ADM-LLA)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.60">an
          IPv6 Link Local Address that embeds a 32-bit
          administratively-assigned identification value in the lower 32 bits
          of fe80::/96, as specified in <a href="#aero-address" class="xref">Section 8</a>.<a href="#section-2-5.60" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.61">Administrative Unique Local Address (ADM-ULA)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.62">an
          IPv6 Unique-Local Address derived from an ADM-LLA.<a href="#section-2-5.62" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.63">Multilink</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.64">an OMNI interface's manner of
          managing diverse underlying interface connections to data links as a
          single logical unit. The OMNI interface provides a single unified
          interface to upper layers, while underlying interface selections are
          performed on a per-packet basis considering traffic selectors such
          as DSCP, flow label, application policy, signal quality, cost, etc.
          Multilink selections are coordinated in both the outbound and
          inbound directions.<a href="#section-2-5.64" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.65">Multinet</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.66">an OAL intermediate node's manner of
          spanning multiple diverse IP Internetworks and/or private enterprise
          networks at the OAL layer below IP. Through intermediate node
          concatenation of SRT bridged network segments, multiple diverse
          Internetworks (such as the global public IPv4 and IPv6 Internets)
          can serve as transit segments in a bridged path for forwarding IP
          packets end-to-end. This bridging capability provide benefits such
          as supporting IPv4/IPv6 transition and coexistence, joining multiple
          diverse operator networks into a cooperative single service network,
          etc.<a href="#section-2-5.66" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.67">Multihop</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.68">an iterative relaying of IP packets
          between Client's over an OMNI underlying interface technology (such
          as omnidirectional wireless) without support of fixed
          infrastructure. Multihop services entail Client-to-Client relaying
          within a Mobile/Vehicular Ad-hoc Network (MANET/VANET) for
          Vehicle-to-Vehicle (V2V) communications and/or for
          Vehicle-to-Infrastructure (V2I) "range extension" where Clients
          within range of communications infrastructure elements provide
          forwarding services for other Clients.<a href="#section-2-5.68" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.69">L2</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.70">The second layer in the OSI network model.
          Also known as "layer-2", "link-layer", "sub-IP layer", "data link
          layer", etc.<a href="#section-2-5.70" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.71">L3</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.72">The third layer in the OSI network model.
          Also known as "layer-3", "network-layer", "IP layer", etc.<a href="#section-2-5.72" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.73">underlying interface</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.74">a *NET interface over
          which an OMNI interface is configured. The OMNI interface is seen as
          a L3 interface by the IP layer, and each underlying interface is
          seen as a L2 interface by the OMNI interface. The underlying
          interface either connects directly to the physical communications
          media or coordinates with another node where the physical media is
          hosted.<a href="#section-2-5.74" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.75">Mobility Service Identification (MSID)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.76">Each
          Proxy/Server is assigned a unique 32-bit Identification (MSID) (see:
          <a href="#aero-address" class="xref">Section 8</a>). IDs are assigned according to
          MS-specific guidelines (e.g., see: <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>).<a href="#section-2-5.76" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.77">Safety-Based Multilink (SBM)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.78">A means for
          ensuring fault tolerance through redundancy by connecting multiple
          affiliated OMNI interfaces to independent routing topologies (i.e.,
          multiple independent OMNI links).<a href="#section-2-5.78" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.79">Performance Based Multilink (PBM)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.80">A means for
          selecting one or more underlying interface(s) for packet
          transmission and reception within a single OMNI interface.<a href="#section-2-5.80" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.81">OMNI Domain</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.82">The set of all SBM/PBM OMNI links
          that collectively provides services for a common set of MSPs. Each
          OMNI domain consists of a set of affiliated OMNI links that all
          configure the same ::/48 ULA prefix with a unique 16-bit Subnet ID
          as discussed in <a href="#span-address" class="xref">Section 9</a>.<a href="#section-2-5.82" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.83">Multilink Forwarding Information Base (MFIB)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.84">A
          forwarding table on each OMNI source, destination and intermediate
          node that includes Multilink Forwarding Vectors (MFV) with both next
          hop forwarding instructions and context for reconstructing
          compressed headers for specific underlying interface pairs used to
          communicate with peers. See: <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>
          for further discussion.<a href="#section-2-5.84" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.85">Multilink Forwarding Vector (MFV)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.86">An MFIB
          entry that includes soft state for each underlying interface
          pairwise communication session between peers. MFVs are identified by
          both a next-hop and previous-hop MFV Index (MFVI), with the next-hop
          established based on an IPv6 ND solicitation and the previous hop
          established based on the solicited IPv6 ND advertisement response.
          See: <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span> for further
          discussion.<a href="#section-2-5.86" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.87">Multilink Forwarding Vector Index (MVFI)</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.88">A 4
          octet value selected by an OMNI node when it creates an MFV, then
          advertised to either a next-hop or previous-hop. OMNI intermediate
          nodes assign two distinct MFVIs for each MFV and advertise one to
          the next-hop and the other to the previous-hop. OMNI end systems
          assign and advertise a single MFVI. See: <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span> for further discussion.<a href="#section-2-5.88" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="reqs">
<section id="section-3">
      <h2 id="name-requirements">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-3-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in BCP 14
      <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span><span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when,
      they appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">An implementation is not required to internally use the architectural
      constructs described here so long as its external behavior is consistent
      with that described in this document.<a href="#section-3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aerospec">
<section id="section-4">
      <h2 id="name-overlay-multilink-network-o">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-overlay-multilink-network-o" class="section-name selfRef">Overlay Multilink Network (OMNI) Interface Model</a>
      </h2>
<p id="section-4-1">An OMNI interface is a virtual interface configured over one or more
      underlying interfaces, which may be physical (e.g., an aeronautical
      radio link, etc.) or virtual (e.g., an Internet or higher-layer
      "tunnel"). The OMNI interface architectural layering model is the same
      as in <span>[<a href="#RFC5558" class="xref">RFC5558</a>]</span><span>[<a href="#RFC7847" class="xref">RFC7847</a>]</span>, and augmented as
      shown in <a href="#aeroint" class="xref">Figure 1</a>. The IP layer therefore sees the OMNI
      interface as a single L3 interface nexus for multiple underlying
      interfaces that appear as L2 communication channels in the
      architecture.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-omni-interface-architectura"></span><div id="aeroint">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-4-2.1">
<pre>                                  +----------------------------+
                                  |    Upper Layer Protocol    |
           Session-to-IP    +----&gt;|                            |
           Address Binding  |     +----------------------------+
                            +----&gt;|           IP (L3)          |
           IP Address       +----&gt;|                            |
           Binding          |     +----------------------------+
                            +----&gt;|       OMNI Interface       |
           Logical-to-      +----&gt;|   (OMNI Adaptation Layer)  |
           Physical         |     +----------------------------+
           Interface        +----&gt;|  L2  |  L2  |       |  L2  |
           Binding                |(IF#1)|(IF#2)| ..... |(IF#n)|
                                  +------+------+       +------+
                                  |  L1  |  L1  |       |  L1  |
                                  |      |      |       |      |
                                  +------+------+       +------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-omni-interface-architectura" class="selfRef">OMNI Interface Architectural Layering Model</a>
        </figcaption></figure>
</div>
<p id="section-4-3">Each underlying interface provides an L2/L1 abstraction according to
      one of the following models:<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">INET interfaces connect to an INET either natively or through one
          or several IPv4 Network Address Translators (NATs). Native INET
          interfaces have global IP addresses that are reachable from any INET
          correspondent. NATed INET interfaces typically have private IP
          addresses and connect to a private network behind one or more NATs
          that provide INET access.<a href="#section-4-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.2">ANET interfaces connect to a protected ANET that is separated
          from the open INET by a Proxy/Server. The ANET interface may be
          either on the same L2 link segment as the Proxy/Server, or separated
          from the Proxy/Server by multiple IP hops.<a href="#section-4-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.3">VPNed interfaces use security encapsulation over a *NET to a
          Proxy/Server acting as a Virtual Private Network (VPN) gateway.
          Other than the link-layer encapsulation format, VPNed interfaces
          behave the same as for Direct interfaces.<a href="#section-4-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.4">Direct (aka "point-to-point") interfaces connect directly to a
          peer without crossing any *NET paths. An example is a line-of-sight
          link between a remote pilot and an unmanned aircraft.<a href="#section-4-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-5">The OMNI interface forwards original IP packets from the
      network layer (L3) using the OMNI Adaptation Layer (OAL) (see: <a href="#intmtu" class="xref">Section 5</a>) as an encapsulation and fragmentation sublayer
      service. This "OAL source" then further encapsulates the resulting OAL
      packets/fragments in *NET headers to create OAL carrier packets for
      transmission over underlying interfaces (L2/L1). The target OMNI
      interface receives the carrier packets from underlying interfaces
      (L1/L2) and discards the *NET headers. If the resulting OAL
      packets/fragments are addressed to itself, the OMNI interface acts as an
      "OAL destination" and performs reassembly if necessary, discards the OAL
      encapsulation, and delivers the original IP packet to the network layer
      (L3). If the OAL fragments are addressed to another node, the OMNI
      interface instead acts as an "OAL intermediate node" by re-encapsulating
      in new *NET headers and forwarding the new carrier packets over an
      underlying interface without reassembling or discarding the OAL
      encapsulation. The OAL source and OAL destination are seen as
      "neighbors" on the OMNI link, while OAL intermediate nodes provide a
      virtual bridging service that joins the segments of a (multinet) Segment
      Routing Topology (SRT).<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">The OMNI interface can send/receive original IP packets to/from
      underlying interfaces while including/omitting various encapsulations
      including OAL, UDP, IP and L2. The network layer can also access the
      underlying interfaces directly while bypassing the OMNI interface
      entirely when necessary. This architectural flexibility may be
      beneficial for underlying interfaces (e.g., some aviation data links)
      for which encapsulation overhead may be a primary consideration. OMNI
      interfaces that send original IP packets directly over underlying
      interfaces without invoking the OAL can only reach peers located on the
      same OMNI link segment. Source Clients can instead use the OAL to
      coordinate with target Clients in the same or different OMNI link
      segments by sending initial carrier packets to a First-Hop Segment (FHS)
      Proxy/Server. The FHS Proxy/Sever then forwards the packets into the SRT
      spanning tree, which transports them to a Last-Hop Segment (LHS)
      Proxy/Server for the target Client.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">Original IP packets sent directly over underlying interfaces are
      subject to the same path MTU related issues as for any Internetworking
      path, and do not include per-packet identifications that can be used for
      data origin verification and/or link-layer retransmissions. Original IP
      packets presented directly to an underlying interface that exceed the
      underlying network path MTU are dropped with an ordinary ICMPv6 Packet
      Too Big (PTB) message returned. These PTB messages are subject to loss
      <span>[<a href="#RFC2923" class="xref">RFC2923</a>]</span> the same as for any non-OMNI IP interface.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">The OMNI interface encapsulation/decapsulation layering possibilities
      are shown in <a href="#omni-layering" class="xref">Figure 2</a> below. Imaginary vertical
      lines drawn between the Network Layer and Underlying interfaces in the
      figure denote the encapsulation/decapsulation layering combinations
      possible. Common combinations include NULL (i.e., direct access to
      underlying interfaces with or without using the OMNI interface), IP/IP,
      IP/UDP/IP, IP/UDP/IP/L2, IP/OAL/UDP/IP, IP/OAL/UDP/L2, etc.<a href="#section-4-8" class="pilcrow">¶</a></p>
<span id="name-omni-interface-layering"></span><div id="omni-layering">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-4-9.1">
<pre>   +------------------------------------------------------------+
   |             Network Layer (Original IP packets)            |
   +--+---------------------------------------------------------+
      |         OMNI Interface (virtual sublayer nexus)         |
      +--------------------------+------------------------------+
                                 |      OAL Encaps/Decaps       |
                                 +------------------------------+
                                 |        OAL Frag/Reass        |
                    +------------+---------------+--------------+
                    | UDP Encaps/Decaps/Compress |
               +----+---+------------+--------+--+  +--------+
               | IP E/D |            | IP E/D |     | IP E/D |
           +---+------+-+----+    +--+---+----+     +----+---+--+
           |L2 E/D|   |L2 E/D|    |L2 E/D|               |L2 E/D|
   +-------+------+---+------+----+------+---------------+------+
   |                   Underlying Interfaces                    |
   +------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-omni-interface-layering" class="selfRef">OMNI Interface Layering</a>
        </figcaption></figure>
</div>
<p id="section-4-10">The OMNI/OAL model gives rise to a number of opportunities:<a href="#section-4-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-11.1">Clients receive MNPs from the MS, and coordinate with the MS
          through IPv6 ND message exchanges with Proxy/Servers. Clients use
          the MNP to construct a unique Link-Local Address (MNP-LLA) through
          the algorithmic derivation specified in <a href="#aero-address" class="xref">Section 8</a> and assign the LLA to the OMNI interface.
          Since MNP-LLAs are uniquely derived from an MNP, no Duplicate
          Address Detection (DAD) or Multicast Listener Discovery (MLD)
          messaging is necessary.<a href="#section-4-11.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.2">since Temporary ULAs are statistically unique, they can be used
          without DAD until an MNP-LLA is obtained.<a href="#section-4-11.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.3">underlying interfaces on the same L2 link segment as a
          Proxy/Server do not require any L3 addresses (i.e., not even
          link-local) in environments where communications are coordinated
          entirely over the OMNI interface.<a href="#section-4-11.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.4">as underlying interface properties change (e.g., link quality,
          cost, availability, etc.), any active interface can be used to
          update the profiles of multiple additional interfaces in a single
          message. This allows for timely adaptation and service continuity
          under dynamically changing conditions.<a href="#section-4-11.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.5">coordinating underlying interfaces in this way allows them to be
          represented in a unified MS profile with provisions for mobility and
          multilink operations.<a href="#section-4-11.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.6">exposing a single virtual interface abstraction to the IPv6 layer
          allows for multilink operation (including QoS based link selection,
          packet replication, load balancing, etc.) at L2 while still
          permitting L3 traffic shaping based on, e.g., DSCP, flow label,
          etc.<a href="#section-4-11.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.7">the OMNI interface allows multinet traversal over the SRT when
          nodes located in different network administrative domains need to
          communicate with one another. This mode of operation would not be
          possible via direct communications over the underlying interfaces
          themselves.<a href="#section-4-11.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.8">the OAL supports lossless and adaptive path MTU mitigations not
          available for communications directly over the underlying interfaces
          themselves. The OAL supports "packing" of multiple IP payload
          packets within a single OAL packet.<a href="#section-4-11.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.9">the OAL applies per-packet identification values that allow for
          link-layer reliability and data origin authentication.<a href="#section-4-11.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.10">L3 sees the OMNI interface as a point of connection to the OMNI
          link; if there are multiple OMNI links (i.e., multiple MS's), L3
          will see multiple OMNI interfaces.<a href="#section-4-11.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-11.11">Multiple independent OMNI interfaces can be used for increased
          fault tolerance through Safety-Based Multilink (SBM), with
          Performance-Based Multilink (PBM) applied within each interface.<a href="#section-4-11.11" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-12">Note that even when the OMNI virtual interface is present,
      applications can still access underlying interfaces either through the
      network protocol stack using an Internet socket or directly using a raw
      socket. This allows for intra-network (or point-to-point) communications
      without invoking the OMNI interface and/or OAL. For example, when an
      IPv6 OMNI interface is configured over an underlying IPv4 interface,
      applications can still invoke IPv4 intra-network communications as long
      as the communicating endpoints are not subject to mobility dynamics.<a href="#section-4-12" class="pilcrow">¶</a></p>
<p id="section-4-13"><a href="#dsp_model" class="xref">Figure 3</a> depicts the architectural model for a
      source Client with an attached EUN connecting to the OMNI link via
      multiple independent *NETs. The Client's OMNI interface sends IPv6 ND
      messages over available underlying interfaces to FHS Proxy/Servers using
      any necessary *NET encapsulations. The IPv6 ND messages traverse the
      *NETs until they reach an FHS Proxy/Server (FHS#1, FHS#2, ..., FHS#n),
      which returns an IPv6 ND message response and/or forwards a proxyed
      version of the message over the SRT to an LHS Proxy/Server near the
      target Client (LHS#1, LHS#2, ..., LHS#m). The Hop Limit in IPv6 ND
      messages is not decremented due to encapsulation; hence, the source and
      target Client OMNI interfaces appear to be attached to a common
      link.<a href="#section-4-13" class="pilcrow">¶</a></p>
<span id="name-source-target-client-coordi"></span><div id="dsp_model">
<figure id="figure-3">
        <div class="artwork art-text alignLeft" id="section-4-14.1">
<pre>                        +--------------+        (:::)-.
                        |Source Client |&lt;--&gt;.-(::EUN:::)
                        +--------------+      `-(::::)-'
                        |OMNI interface|
                        +----+----+----+
               +--------|IF#1|IF#2|IF#n|------ +
              /         +----+----+----+        \
             /                 |                 \
            /                  |                  \
           v                   v                   v
        (:::)-.              (:::)-.              (:::)-.
   .-(::*NET:::)        .-(::*NET:::)        .-(::*NET:::)
     `-(::::)-'           `-(::::)-'           `-(::::)-'
      +-----+              +-----+              +-----+
 ...  |FHS#1|  .........   |FHS#2|   .........  |FHS#n|  ...
.     +--|--+              +--|--+              +--|--+     .
.        |                    |                    |
.        \                    v                    /        .
.         \                                       /         .
.           v                 (:::)-.           v            .
.                        .-(::::::::)                       .
.                    .-(::: Segment :::)-.                  .
.                  (:::::   Routing   ::::)                 .
.                     `-(:: Topology ::)-'                  .
.                         `-(:::::::-'                      .
.                  /          |          \                  .
.                 /           |           \                 .
.                v            v            v
.     +-----+              +-----+              +-----+     .
 ...  |LHS#1|  .........   |LHS#2|   .........  |LHS#m|  ...
      +--|--+              +--|--+              +--|--+
          \                   |                    /
           v                  v                   v
                    &lt;-- Target Clients --&gt;
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-source-target-client-coordi" class="selfRef">Source/Target Client Coordination over the OMNI Link</a>
        </figcaption></figure>
</div>
<p id="section-4-15">After the initial IPv6 ND message exchange, the source Client (and/or
      any nodes on its attached EUNs) can send packets to the target Client
      over the OMNI interface. OMNI interface multilink services will forward
      the packets via FHS Proxy/Servers for the correct underlying *NETs. The
      FHS Proxy/Server then forwards them over the SRT which delivers them to
      an LHS Proxy/Server, and the LHS Proxy/Server in turn forwards the
      packets to the target Client. (Note that when the source and target
      Client are on the same SRT segment, the FHS and LHS Proxy/Servers are
      often one and the same.)<a href="#section-4-15" class="pilcrow">¶</a></p>
<p id="section-4-16">When a Client coordinates with its FHS Proxy/Servers, it selects one
      to serve in the Hub Proxy/Server role (not shown in the figure). Clients
      then register all of their underlying interfaces with the Hub
      Proxy/Server via the FHS Proxy/Server in a pure proxy role. The Hub
      Proxy/Server then provides a designated router and mobility anchor point
      service for the Client.<a href="#section-4-16" class="pilcrow">¶</a></p>
<p id="section-4-17">Clients therefore use Proxy/Servers as gateways into the SRT to reach
      OMNI link correspondents via a spanning tree established in a manner
      outside the scope of this document. Proxy/Servers forward critical MS
      control messages via the secured spanning tree and forward other
      messages via the unsecured spanning tree (see Security Considerations).
      When route optimization is applied as discussed in <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>, Clients can instead forward directly
      to an SRT intermediate system themselves (or directly to correspondents
      in the same SRT segment) to reduce Proxy/Server load.<a href="#section-4-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intmtu">
<section id="section-5">
      <h2 id="name-omni-interface-maximum-tran">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-omni-interface-maximum-tran" class="section-name selfRef">OMNI Interface Maximum Transmission Unit (MTU)</a>
      </h2>
<p id="section-5-1">The OMNI interface observes the link nature of tunnels, including the
      Maximum Transmission Unit (MTU), Maximum Reassembly Unit (MRU) and the
      role of fragmentation and reassembly <span>[<a href="#I-D.ietf-intarea-tunnels" class="xref">I-D.ietf-intarea-tunnels</a>]</span>. The OMNI interface is configured
      over one or more underlying interfaces as discussed in <a href="#aerospec" class="xref">Section 4</a>, where the interfaces (and their associated *NET
      paths) may have diverse MTUs. OMNI interface considerations for
      accommodating original IP packets of various sizes are discussed in the
      following sections.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">IPv6 underlying interfaces are REQUIRED to configure a minimum MTU of
      1280 bytes and a minimum MRU of 1500 bytes <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>.
      Therefore, the minimum IPv6 path MTU is 1280 bytes since routers on the
      path are not permitted to perform network fragmentation even though the
      destination is required to reassemble more. The network therefore MUST
      forward original IP packets of at least 1280 bytes without generating an
      IPv6 Path MTU Discovery (PMTUD) Packet Too Big (PTB) message <span>[<a href="#RFC8201" class="xref">RFC8201</a>]</span>. (While the source can apply "source fragmentation"
      for locally-generated IPv6 packets up to 1500 bytes and larger still if
      it knows the destination configures a larger MRU, this does not affect
      the minimum IPv6 path MTU.)<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">IPv4 underlying interfaces are REQUIRED to configure a minimum MTU of
      68 bytes <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span> and a minimum MRU of 576 bytes <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span><span>[<a href="#RFC1122" class="xref">RFC1122</a>]</span>. Therefore, when the Don't
      Fragment (DF) bit in the IPv4 header is set to 0 the minimum IPv4 path
      MTU is 576 bytes since routers on the path support network fragmentation
      and the destination is required to reassemble at least that much. The
      OMNI interface therefore MUST set DF to 0 in the IPv4 encapsulation
      headers of carrier packets that are no larger than 576 bytes, and SHOULD
      set DF to 1 in larger carrier packets unless it has a way to determine
      the encapsulation destination MRU and has carefully considered the
      issues discussed in <a href="#fragsec" class="xref">Section 6.10</a>.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The OMNI interface configures an MTU and MRU of 9180 bytes <span>[<a href="#RFC2492" class="xref">RFC2492</a>]</span>; the size is therefore not a reflection of the
      underlying interface or *NET path MTUs, but rather determines the
      largest original IP packet the OAL (and/or underlying interface) can
      forward or reassemble. For each OAL destination (i.e., for each OMNI
      link neighbor), the OAL source may discover "hard" or "soft" Reassembly
      Limit values smaller than the MRU based on receipt of IPv6 ND messages
      with OMNI Reassembly Limit sub-options (see: <a href="#sub7.8" class="xref">Section 12.2.10</a>).
      The OMNI interface employs the OAL as an encapsulation sublayer service
      to transform original IP packets into OAL packets/fragments, and the OAL
      in turn uses *NET encapsulation to forward carrier packets over the
      underlying interfaces (see: <a href="#oal2" class="xref">Section 6</a>).<a href="#section-5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oal2">
<section id="section-6">
      <h2 id="name-the-omni-adaptation-layer-o">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-the-omni-adaptation-layer-o" class="section-name selfRef">The OMNI Adaptation Layer (OAL)</a>
      </h2>
<p id="section-6-1">When an OMNI interface forwards an original IP packet from the
      network layer for transmission over one or more underlying interfaces,
      the OMNI Adaptation Layer (OAL) acting as the OAL source drops the
      packet and returns a PTB message if the packet exceeds the MRU and/or
      the hard Reassembly Limit for the intended OAL destination. Otherwise,
      the OAL source applies encapsulation to form OAL packets subject to
      fragmentation producing OAL fragments suitable for *NET encapsulation
      and transmission as carrier packets over underlying interfaces as
      described in <a href="#oal23" class="xref">Section 6.1</a>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">These carrier packets travel over one or more underlying networks
      spanned by OAL intermediate nodes in the SRT, which re-encapsulate by
      removing the *NET headers of the first underlying network and appending
      *NET headers appropriate for the next underlying network in succession.
      (This process supports the multinet concatenation capability needed for
      joining multiple diverse networks.) After re-encapsulation by zero or
      more OAL intermediate nodes, the carrier packets arrive at the OAL
      destination.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">When the OAL destination receives the carrier packets, it discards
      the *NET headers and reassembles the resulting OAL fragments into an OAL
      packet as described in <a href="#oal37" class="xref">Section 6.3</a>. The OAL destination then
      decapsulates the OAL packet to obtain the original IP packet, which it
      then delivers to the network layer. The OAL source may be either the
      source Client or its FHS Proxy/Server, while the OAL destination may be
      either the LHS Proxy/Server or the target Client. Proxy/Servers (and
      other SRT infrastructure node types such as those discussed in <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>) may also serve as OAL intermediate
      nodes.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The OAL presents an OMNI sublayer abstraction similar to ATM
      Adaptation Layer 5 (AAL5). Unlike AAL5 which performs segmentation and
      reassembly with fixed-length 53 octet cells over ATM networks, however,
      the OAL uses IPv6 encapsulation, fragmentation and reassembly with
      larger variable-length cells over heterogeneous underlying networks.
      Detailed operations of the OAL are specified in the following
      sections.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="oal23">
<section id="section-6.1">
        <h3 id="name-oal-source-encapsulation-an">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-oal-source-encapsulation-an" class="section-name selfRef">OAL Source Encapsulation and Fragmentation</a>
        </h3>
<p id="section-6.1-1">When the network layer forwards an original IP packet into the OMNI
        interface, the OAL source inserts an IPv6 encapsulation header but
        does not decrement the Hop Limit/TTL of the original IP packet since
        encapsulation occurs at a layer below IP forwarding <span>[<a href="#RFC2473" class="xref">RFC2473</a>]</span>. The OAL source copies the "Type of Service/Traffic
        Class" <span>[<a href="#RFC2983" class="xref">RFC2983</a>]</span> and "Congestion Experienced" <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> values in the original packet's IP header into the
        corresponding fields in the OAL header, then sets the OAL header "Flow
        Label" as specified in <span>[<a href="#RFC6438" class="xref">RFC6438</a>]</span>. The OAL source
        finally sets the OAL header IPv6 Hop Limit to a conservative value
        sufficient to enable loop-free forwarding over multiple concatenated
        OMNI link segments and sets the Payload Length to the length of the
        original IP packet.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The OAL next selects source and destination addresses for the IPv6
        header of the resulting OAL packet. Client OMNI interfaces set the OAL
        IPv6 header source address to a Unique Local Address (ULA) based on
        the Mobile Network Prefix (MNP-ULA), while Proxy/Server OMNI
        interfaces set the source address to an Administrative ULA (ADM-ULA)
        (see: <a href="#span-address" class="xref">Section 9</a>). When a Client OMNI interface
        does not (yet) have an MNP-ULA, it can use a Temporary ULA and/or Host
        Identity Tag (HIT) instead (see: <a href="#hip-nd" class="xref">Section 22</a>).<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">When the OAL source forwards an original IP packet toward a final
        destination via an ANET underlying interface, it sets the OAL IPv6
        header source address to its own ULA and sets the destination to
        either the Administrative ULA (ADM-ULA) of the ANET peer or the Mobile
        Network Prefix ULA (MNP-ULA) corresponding to the final destination
        (see below). The OAL source then fragments the OAL packet if
        necessary, encapsulates the OAL fragments in any ANET headers and
        sends the resulting carrier packets to the ANET peer which either
        reassembles before forwarding if the OAL destination is its own ULA or
        forwards the fragments toward the true OAL destination without first
        reassembling otherwise.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">When the OAL source forwards an original IP packet toward a final
        destination via an INET underlying interface, it sets the OAL IPv6
        header source address to its own ULA and sets the destination to the
        ULA of an OAL destination node on the final *NET segment. The OAL
        source then fragments the OAL packet if necessary, encapsulates the
        OAL fragments in any *NET headers and sends the resulting carrier
        packets toward the OAL destination on the LHS OMNI node which
        reassembles before forwarding the original IP packets toward the final
        destination.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Following OAL IPv6 encapsulation and address selection, the OAL
        source next appends a 2 octet trailing checksum (initialized to 0) at
        the end of the original IP packet while incrementing the OAL header
        IPv6 Payload Length field to reflect the addition of the trailer. The
        format of the resulting OAL packet following encapsulation is shown in
        <a href="#OAL-packet" class="xref">Figure 4</a>:<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<span id="name-oal-packet-before-fragmenta"></span><div id="OAL-packet">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-6.1-6.1">
<pre>   +----------+-----+-----+-----+-----+-----+-----+----+
   |  OAL Hdr |         Original IP packet        |Csum|
   +----------+-----+-----+-----+-----+-----+-----+----+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-oal-packet-before-fragmenta" class="selfRef">OAL Packet Before Fragmentation</a>
          </figcaption></figure>
</div>
<p id="section-6.1-7">The OAL source next selects a 32-bit Identification value for the
        packet as specified in <a href="#oal7.9" class="xref">Section 6.6</a> then calculates an OAL
        checksum using the algorithm specified in <a href="#fletcher" class="xref">Appendix A</a>.
        The OAL source calculates the checksum over the entire OAL packet
        beginning with a pseudo-header of the IPv6 header similar to that
        found in Section 8.1 of <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> and extending to the
        end of the (0-initialized) checksum trailer. The OAL IPv6
        pseudo-header is formed as shown in <a href="#pseudo-header" class="xref">Figure 5</a>:<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<span id="name-oal-ipv6-pseudo-header"></span><div id="pseudo-header">
<figure id="figure-5">
          <div class="artwork art-text alignLeft" id="section-6.1-8.1">
<pre>   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                     OAL Source Address                        +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                  OAL Destination Address                      +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |       OAL Payload Length      |     zero      |  Next Header  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Identification                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-oal-ipv6-pseudo-header" class="selfRef">OAL IPv6 Pseudo-Header</a>
          </figcaption></figure>
</div>
<p id="section-6.1-9">After calculating the checksum, the OAL source next fragments the
        OAL packet if necessary while assuming the IPv4 minimum path MTU
        (i.e., 576 bytes) as the worst case for OAL fragmentation regardless
        of the underlying interface IP protocol version since IPv6/IPv4
        protocol translation and/or IPv6-in-IPv4 encapsulation may occur in
        any *NET path. By always assuming the IPv4 minimum even for IPv6
        underlying interfaces, the OAL source may produce smaller fragments
        with additional encapsulation overhead but will always interoperate
        and never run the risk of loss due to an MTU restriction or due to
        presenting an underlying interface with a carrier packet that exceeds
        its MRU. Additionally, the OAL path could traverse multiple SRT
        segments with intermediate OAL forwarding nodes performing
        re-encapsulation where the *NET encapsulation of the previous segment
        is replaced by the *NET encapsulation of the next segment which may be
        based on a different IP protocol version and/or encapsulation
        sizes.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<p id="section-6.1-10">The OAL source therefore assumes a default minimum path MTU of 576
        bytes at each SRT segment for the purpose of generating OAL fragments
        for *NET encapsulation and transmission as carrier packets. Each
        successive SRT intermediate node includes either a 20 byte IPv4 or 40
        byte IPv6 header, an 8 byte UDP header and in some cases an IP
        security encapsulation (40 bytes maximum assumed) during
        re-encapsulation. Intermediate nodes at any SRT segment may also
        insert a Routing Header (assume 40 bytes worst-case) as an extension
        to the existing 40 byte OAL IPv6 header plus 8 byte Fragment Header.
        Therefore, assuming a worst case of (40 + 40 + 8) = 88 bytes for *NET
        encapsulation plus (40 + 40 + 8) = 88 bytes for OAL encapsulation
        leaves no less than (576 - 88 - 88) = 400 bytes to accommodate a
        portion of the original IP packet/fragment. The OAL source therefore
        sets a minimum Maximum Payload Size (MPS) of 400 bytes as the basis
        for the minimum-sized OAL fragment that can be assured of traversing
        all SRT segments without loss due to an MTU/MRU restriction. The
        Maximum Fragment Size (MFS) for OAL fragmentation is therefore
        determined by the MPS plus the size of the OAL encapsulation headers.
        (Note that the OAL source includes the 2 octet trailer as part of the
        payload during fragmentation, and the OAL destination regards it as
        ordinary payload until reassembly and checksum verification are
        complete.)<a href="#section-6.1-10" class="pilcrow">¶</a></p>
<p id="section-6.1-11">The OAL source SHOULD maintain "path MPS" values for individual OAL
        destinations initialized to the minimum MPS and increased to larger
        values (up to the OMNI interface MTU) if better information is known
        or discovered. For example, when *NET peers share a common underlying
        link or a fixed path with a known larger MTU, the OAL source can set
        path MPS to this larger size (i.e., instead of 576 bytes) as long as
        the *NET peer reassembles before re-encapsulating and forwarding
        (while re-fragmenting if necessary). Also, if the OAL source has a way
        of knowing the maximum *NET encapsulation size for all SRT segments
        along the path it may be able to increase path MPS to reserve
        additional room for payload data. The OAL source must include the
        uncompressed OAL header size in its path MPS calculation, since it may
        need to include a full header at any time.<a href="#section-6.1-11" class="pilcrow">¶</a></p>
<p id="section-6.1-12">The OAL source can also optimistically set a larger path MPS and/or
        actively probe individual OAL destinations to discover larger sizes
        using packetization layer probes in a similar fashion as <span>[<a href="#RFC4821" class="xref">RFC4821</a>]</span><span>[<a href="#RFC8899" class="xref">RFC8899</a>]</span>, but care must be taken to
        avoid setting static values for dynamically changing paths leading to
        black holes. The probe involves sending an OAL packet larger than the
        current path MPS and receiving a small acknowledgement response (with
        the possible receipt of link-layer error message in case the probe was
        lost). For this purpose, the OAL source can send an NS message with
        one or more OMNI options with large PadN sub-options (see: <a href="#interface" class="xref">Section 12</a>) in order to receive a small NA response from the
        OAL destination. While observing the minimum MPS will always result in
        robust and secure behavior, the OAL source should optimize path MPS
        values when more efficient utilization may result in better
        performance (e.g. for wireless aviation data links). (If so, the OAL
        source should maintain separate path MPS values for each (source,
        target) underlying interface pair for the same OAL destination, since
        each underlying interface pair may support a different path MPS.)<a href="#section-6.1-12" class="pilcrow">¶</a></p>
<p id="section-6.1-13">When the OAL source performs fragmentation, it SHOULD produce the
        minimum number of non-overlapping fragments under current MPS
        constraints, where each non-final fragment MUST be at least as large
        as the minimum MPS, while the final fragment MAY be smaller. The OAL
        source also converts all original IP packets no larger than the
        current MPS into "atomic fragments" by including a Fragment Header
        with Fragment Offset and More Fragments both set to 0.<a href="#section-6.1-13" class="pilcrow">¶</a></p>
<p id="section-6.1-14">For each fragment produced, the OAL source writes an ordinal number
        for the fragment into the Reserved field in the IPv6 Fragment Header.
        Specifically, the OAL source writes the ordinal number '0' for the
        first fragment, '1' for the second fragment, '2' for the third
        fragment, etc. up to and including the final fragment. Since the
        minMPS is 400 and the MTU is 9180, the OAL source will produce at most
        23 fragments for each OAL packet; the OAL destination therefore
        unconditionally discards any fragments with an ordinal number larger
        than 22.<a href="#section-6.1-14" class="pilcrow">¶</a></p>
<p id="section-6.1-15">The OAL source finally encapsulates the fragments in *NET headers
        to form carrier packets and forwards them over an underlying
        interface, while retaining the fragments and their ordinal numbers
        (i.e., #0, #1, #2, etc.) for a brief period to support link-layer
        retransmissions (see: <a href="#oal3.6" class="xref">Section 6.7</a>). OAL fragment and
        carrier packet formats are shown in <a href="#oal-fragment" class="xref">Figure 6</a>.<a href="#section-6.1-15" class="pilcrow">¶</a></p>
<span id="name-oal-fragments-and-carrier-p"></span><div id="oal-fragment">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-6.1-16.1">
<pre>     +----------+--+-------------+
     |  OAL Hdr |FH|   Frag #0   |
     +----------+--+-------------+
         +----------+--+-------------+
         |  OAL Hdr |FH|   Frag #1   |
         +----------+--+-------------+
             +----------+--+-------------+
             |  OAL Hdr |FH|   Frag #2   |
             +----------+--+-------------+
                               ....
                 +----------+--+-------------+----+
                 |  OAL Hdr |FH| Frag #(N-1) |Csum|
                 +----------+--+-------------+----+
     a) OAL fragments after fragmentation
        (FH = Fragment Header; Csum appears only in final fragment)


     +--------+--+-----+-----+-----+-----+-----+----+
     |OAL Hdr |FH|      Original IP packet     |Csum|
     +--------+--+-----+-----+-----+-----+-----+----+
     b) An OAL atomic fragment with FH but no fragmentation.


     +--------+----------+--+-------------+
     |*NET Hdr|  OAL Hdr |FH|   Frag #i   |
     +--------+----------+--+-------------+
     c) OAL carrier packet after *NET encapsulation
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-oal-fragments-and-carrier-p" class="selfRef">OAL Fragments and Carrier Packets</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="oal42">
<section id="section-6.2">
        <h3 id="name-oal-net-encapsulation-and-r">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-oal-net-encapsulation-and-r" class="section-name selfRef">OAL *NET Encapsulation and Re-Encapsulation</a>
        </h3>
<p id="section-6.2-1">The OAL source or intermediate node encapsulates each OAL fragment
        (with either full or compressed headers) in *NET encapsulation headers
        to create a carrier packet. The OAL source or intermediate node (i.e.,
        the *NET source) includes a UDP header as the innermost sublayer if
        NAT traversal and/or packet filtering middlebox traversal are
        required; otherwise, the *NET source includes either a full or
        compressed IP header or a true L2 header (e.g., such as for
        Ethernet-compatible links). The *NET source then appends any
        additional encapsulation sublayer headers necessary and presents the
        resulting carrier packet to an underlying interface, where the
        underlying network conveys it to a next-hop OAL intermediate node or
        destination (i.e., the *NET destination).<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The *NET source encapsulates the OAL information immediately
        following the *NET innermost sublayer header. If the first four bits
        of the encapsulated OAL information following the innermost sublayer
        header encode the value '6', the information must include an
        uncompressed IPv6 header followed by any IPv6 extension headers
        followed by upper layer protocol headers and data. Otherwise, the
        first four bits include a "Type" value, and the OAL information
        appears in an alternate format as specified in <a href="#oal98" class="xref">Section 6.4</a>). Alternate formats for Types '0' and '1' are
        currently specified, while all other Type values except '4' and '6'
        are reserved for future use.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">The OAL node prepares the innermost *NET encapsulation header as
        follows:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-4.1">For UDP, the *NET source sets the UDP source port to 8060
            (i.e., the port number reserved for AERO/OMNI). When the *NET
            destination is a Proxy/Server or Bridge, the *NET source sets the
            UDP destination port to 8060; otherwise, the *NET source sets the
            UDP destination port to its cached port number value for the peer.
            The *NET source finally sets the UDP Length the same as specified
            in <span>[<a href="#RFC0768" class="xref">RFC0768</a>]</span>.<a href="#section-6.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-4.2">For IP encapsulation, the IP port number is set to TBD1 as the
            Internet Protocol number for OMNI. For IPv4, the *NET source sets
            the Total Length the same as specified in <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span>; for IPv6, the *NET source sets the Payload
            Length the same as specified in <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>.<a href="#section-6.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-4.3">For encapsulations over Ethernet-compatible L2s, the EtherType
            is set to TBD2 as the EtherType number for OMNI. Since the
            Ethernet header does not include a length field, for the OMNI
            EtherType the Ethernet header is followed by a two-octet length
            field followed immediately by the encapsulated OAL information.
            The length field encodes the length in octets (in network byte
            order) of the information following the Ethernet header including
            the length field, but excluding the Ethernet trailer.<a href="#section-6.2-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-5">When a *NET source includes a UDP header, it SHOULD calculate and
        include a UDP checksum in carrier packets with full OAL headers to
        ensure header integrity, and MAY disable UDP checksums in carrier
        packets with compressed OAL headers. If the *NET source discovers that
        a path is dropping carrier packets with UDP checksums disabled, it
        should enable UDP checksums in future carrier packets sent to the same
        *NET destination. If the *NET source discovers that a path is dropping
        carrier packets that do not include a UDP header, it should include a
        UDP header in future carrier packets.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">When a *NET source sends carrier packets with compressed OAL
        headers and with UDP checksums disabled, mis-delivery due to
        corruption of the 4-octet Multilink Forwarding Vector Index (MFVI) is
        possible but unlikely since the corrupted index would somehow have to
        match valid state in the (sparsely-populated) Multilink Forwarding
        Information Based (MFIB). In the unlikely event that a match occurs,
        an OAL destination may receive a mis-delivered carrier packet but can
        immediately reject the packet if it has an incorrect Identification.
        If the Identification value is somehow accepted, the OAL destination
        may submit the mis-delivered carrier packet to the reassembly cache
        where it will most likely be rejected due to incorrect reassembly
        parameters. Finally, if a reassembly that includes the mis-delivered
        carrier packets somehow succeeds (or, for atomic fragments) the OAL
        destination will verify the OAL checksum to detect corruption that
        somehow eluded earlier checks. See: <span>[<a href="#RFC6935" class="xref">RFC6935</a>]</span><span>[<a href="#RFC6936" class="xref">RFC6936</a>]</span> for further discussion.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">For *NET encapsulations over IP, when the *NET source is also the
        OAL source it next copies the "Type of Service/Traffic Class" <span>[<a href="#RFC2983" class="xref">RFC2983</a>]</span> and "Congestion Experienced" <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> values in the OAL IPv6 header into the
        corresponding fields in the *NET IP header, then (for IPv6) set the
        *NET IPv6 header "Flow Label" as specified in <span>[<a href="#RFC6438" class="xref">RFC6438</a>]</span>. The *NET source then sets the *NET IP TTL/Hop
        Limit the same as for any host (i.e., it does not copy the Hop Limit
        value from the OAL header) and finally sets the source and destination
        IP addresses to direct the carrier packet to the next hop. For carrier
        packets undergoing re-encapsulation, the OAL intermediate node *NET
        source decrements the OAL IPv6 header Hop Limit and discards the
        carrier packet if the value reaches 0. The *NET source then copies the
        "Type of Service/Traffic Class" and "Congestion Experienced" values
        from the previous hop *NET encapsulation header into the OAL IPv6
        header, then finally sets the source and destination IP addresses the
        same as above.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<p id="section-6.2-8">Following *NET encapsulation/re-encapsulation, the *NET source
        sends the resulting carrier packets over one or more underlying
        interfaces. The underlying interfaces often connect directly to
        physical media on the local platform (e.g., a laptop computer with
        WiFi, etc.), but in some configurations the physical media may be
        hosted on a separate Local Area Network (LAN) node. In that case, the
        OMNI interface can establish a Layer-2 VLAN or a point-to-point tunnel
        (at a layer below the underlying interface) to the node hosting the
        physical media. The OMNI interface may also apply encapsulation at the
        underlying interface layer (e.g., as for a tunnel virtual interface)
        such that carrier packets would appear "double-encapsulated" on the
        LAN; the node hosting the physical media in turn removes the LAN
        encapsulation prior to transmission or inserts it following reception.
        Finally, the underlying interface must monitor the node hosting the
        physical media (e.g., through periodic keepalives) so that it can
        convey up/down/status information to the OMNI interface.<a href="#section-6.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oal37">
<section id="section-6.3">
        <h3 id="name-oal-net-decapsulation-and-r">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-oal-net-decapsulation-and-r" class="section-name selfRef">OAL *NET Decapsulation and Reassembly</a>
        </h3>
<p id="section-6.3-1">When an OMNI interface receives a carrier packet from an underlying
        interface, it discards the *NET encapsulation headers and examines the
        OAL header of the enclosed OAL fragment. If the OAL fragment is
        addressed to a different node, the OMNI interface (acting as an OAL
        intermediate node) re-encapsulates and forwards as discussed in <a href="#oal42" class="xref">Section 6.2</a>. If the OAL fragment is addressed to itself, the OMNI
        interface (acting as an OAL destination) accepts or drops the fragment
        based on the (Source, Destination, Identification)-tuple and/or
        integrity checks.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">The OAL destination next drops all non-final OAL fragments smaller
        than the minimum MPS and all fragments that would overlap or leave
        "holes" smaller than the minimum MPS with respect to other fragments
        already received. The OAL destination updates a checklist of the
        ordinal numbers of each accepted fragment of the same OAL packet
        (i.e., as Frag #0, Frag #1, Frag #2, etc.), then admits the fragments
        into the reassembly cache. When reassembly is complete, the OAL
        destination next verifies the OAL packet checksum and discards the
        packet if the checksum is incorrect. If the OAL packet was accepted,
        the OAL destination then removes the OAL header/trailer, then delivers
        the original IP packet to the network layer.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">Carrier packets often travel over paths where all links in the path
        include CRC-32 integrity checks for effective hop-by-hop error
        detection for payload sizes up to the OMNI interface MTU <span>[<a href="#CRC" class="xref">CRC</a>]</span>, but other paths may traverse links (such as tunnels
        over IPv4) that do not include integrity checks. The OAL checksum
        therefore allows OAL destinations to detect reassembly misassociation
        splicing errors and/or carrier packet corruption caused by unprotected
        links <span>[<a href="#CKSUM" class="xref">CKSUM</a>]</span>.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">The OAL checksum also provides algorithmic diversity with respect
        to both lower layer CRCs and upper layer Internet checksums as part of
        a complimentary multi-layer integrity assurance architecture. Any
        corruption not detected by lower layer integrity checks is therefore
        very likely to be detected by upper layer integrity checks that use
        diverse algorithms.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oal98">
<section id="section-6.4">
        <h3 id="name-oal-header-compression">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-oal-header-compression" class="section-name selfRef">OAL Header Compression</a>
        </h3>
<p id="section-6.4-1">When OAL source, intermediate and destination nodes exchange IPv6
        ND messages to establish header compression state. After an initial
        IPv6 ND message exchange, OAL nodes can apply OAL Header Compression
        to significantly reduce encapsulation overhead.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">Each node establishes a Multilink Forwarding Information Based
        (MFIB) soft state entry known as a Multilink Forwarding Vector (MVF)
        which supports both carrier packet forwarding and OAL header
        compression/decompression. For OAL sources, the MFV is referenced by a
        single MFV Index (MFVI) that provides compression/decompression
        context for the next hop. For OAL destinations, the MFV is referenced
        by a single MFVI that provides context for the previous hop. For OAL
        intermediate nodes, the MFV is referenced by two MFVIs - one for the
        previous hop and one for the next hop.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">When an OAL node uses *NET encapsulation to forward carrier packets
        directly to a next hop, it can omit significant portions of the OAL
        IPv6 header and Fragment Headers while including an OAL compressed
        header. The full OAL IPv6 header or compressed header follows
        immediately after the innermost *NET encapsulation (i.e., UDP, IP or
        L2) as discussed in <a href="#oal42" class="xref">Section 6.2</a>. Two OAL compressed header
        types (Type '0' and Type '1') are specified below, while future
        documents may specify additional types.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">For OAL first-fragments (including atomic fragments), the OAL node
        uses OMNI Compressed Header - Type 0 (OCH-0) as shown in <a href="#compress-type0" class="xref">Figure 7</a>:<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<span id="name-omni-compressed-header-type"></span><div id="compress-type0">
<figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-6.4-5.1">
<pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ *
   |Type=0 | Traffic Class |           Flow Label                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Next Header  |  Hop Limit  |M|      Identification (0-1)     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |       Identification (2-3)    |           MFVI (0-1)          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            MFVI (2-3)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-omni-compressed-header-type" class="selfRef">OMNI Compressed Header - Type 0 (OCH-0)</a>
          </figcaption></figure>
</div>
<p id="section-6.4-6">The format begins with a 4-bit Type field set to 0, and is
        followed by the uncompressed Traffic Class and Flow Label copied from
        the OAL IPv6 header, followed by a Next Header field set to the
        protocol number for the header immediately following the IPv6 Fragment
        Header. The Next Header field is then followed by a 7-bit compressed
        Hop Limit field set to the minimum of 127 and the uncompressed OAL
        IPv6 Hop Limit value. The Hop Limit is then followed by a compressed
        Fragment Header beginning with a (M)ore Fragments bit followed by a
        4-octet Identification and with all other fields omitted. The
        compressed Fragment Header is then followed by a 4-octet Multilink
        Forwarding Vector Index (MFVI).<a href="#section-6.4-6" class="pilcrow">¶</a></p>
<p id="section-6.4-7">The uncompressed OAL fragment body is then included immediately
        following the OCH-0 header, and the *NET header length field is
        reduced by the difference in length between the compressed headers and
        full-length IPv6 and Fragment headers. The OCH-0 format applies for
        first fragments only, which are always regarded as ordinal fragment 0
        even though no explicit Ordinal field is included.<a href="#section-6.4-7" class="pilcrow">¶</a></p>
<p id="section-6.4-8">For OAL non-first fragments (i.e., those with non-zero Fragment
        Offsets), the OAL uses OMNI Compressed Header - Type 1 (OCH-1) as
        shown in <a href="#compress-type1" class="xref">Figure 8</a>:<a href="#section-6.4-8" class="pilcrow">¶</a></p>
<span id="name-omni-compressed-header-type-"></span><div id="compress-type1">
<figure id="figure-8">
          <div class="artwork art-text alignLeft" id="section-6.4-9.1">
<pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Type=1 | Ordinal |R|M|    Fragment Offset      |     ID (0)    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Identification (1-3)              |    MFVI (0)   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  MFVI (1-3)                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-omni-compressed-header-type-" class="selfRef">OMNI Compressed Header - Type 1 (OCH-1)</a>
          </figcaption></figure>
</div>
<p id="section-6.4-10">The format begins with a Type field set to 1 and the IPv6
        header is omitted entirely. The Type field is followed by a compressed
        IPv6 Fragment Header with a 5-bit Ordinal number field, a (R)eserved
        bit set to 0, and with ((M)ore Fragments/Fragment
        Offset/Identification) copied from the uncompressed fragment header.
        The compressed Fragment Header is followed by a 4-octet MFVI the same
        as for OCH-0.<a href="#section-6.4-10" class="pilcrow">¶</a></p>
<p id="section-6.4-11">The uncompressed OAL fragment body is then included immediately
        following the OCH-1 header, and the *NET header length field is
        reduced by the difference in length between the compressed headers and
        full-length IPv6 and Fragment headers. The OCH-1 format applies for
        non-first fragments only; therefore, Ordinal is set to a monotonically
        increasing value beginning with 1 for the first non-first fragment, 2
        for the second non-first fragment, etc., up to and including the final
        fragment.<a href="#section-6.4-11" class="pilcrow">¶</a></p>
<p id="section-6.4-12">When an OAL destination or intermediate node receives a carrier
        packet, it determines the length of the encapsulated OAL information
        by examining the length field of the innermost *NET header then
        examines the first four bits immediately following the *NET header. If
        the bits contain the value 6, the OAL node processes the remainder as
        an uncompressed OAL fragment, If the bits contain the value 0 or 1,
        the OAL node instead processes the remainder of the header as an OCH-0
        or OCH-1, respectively.<a href="#section-6.4-12" class="pilcrow">¶</a></p>
<p id="section-6.4-13">For OCH-O/1, the OAL node then uses the MFVI to locate the cached
        MFV. The OAL node uses the MFV to determine the next hop intermediate
        OAL node for forwarding. During forwarding, the OAL node changes the
        MFVI to the cached value for the MVF next hop. If the OAL node is the
        destination, it instead reconstructs the full OAL headers then adds
        the resulting OAL fragment to the reassembly cache if the
        Identification is acceptable. Since OCH-1 does not include Traffic
        Class, Flow Label, Next Header or Hop Limit information, the OAL node
        writes the value 0 into those fields when it reconstructs the full OAL
        headers. The values will be correctly populated during reassembly
        after an OAL first fragment with an OCH-0 or uncompressed OAL header
        arrives.<a href="#section-6.4-13" class="pilcrow">¶</a></p>
<p id="section-6.4-14">Note: OAL header compression does not interfere with checksum
        calculation and verification, which must be applied according to the
        full OAL pseudo-header per <a href="#oal23" class="xref">Section 6.1</a> even when
        compression is used.<a href="#section-6.4-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oal2000">
<section id="section-6.5">
        <h3 id="name-carrier-packet-in-carrier-p">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-carrier-packet-in-carrier-p" class="section-name selfRef">Carrier Packet in Carrier Packet Encapsulation</a>
        </h3>
<p id="section-6.5-1">When an OAL source is unable to forward carrier packets directly to
        an OAL destination without the involved services of an OAL
        intermediate node, the OAL source must regard the OAL intermediate
        node as an ingress tunnel endpoint. The OAL source must therefore
        include a NCE and MFV for the OAL destination while the OAL
        intermediate node must have a NCE and MFV for the egress tunnel
        endpoint. This will result in encapsulation when carrier packets sent
        by the OAL source arrive at the OAL intermediate node.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">For example, if the OAL source has an NCE/MFV with MFVI 0x2376a7b5
        and Identification 0x12345678 for the OAL destination, and the OAL
        intermediate node has an NCE/MFV with MFVI 0x692a64fc and
        Identification 0x98765432 for the egress tunnel endpoint, the OAL
        source prepares the carrier packet using OCH-0/1 compression with the
        MFVI and Identification corresponding to the OAL destination but with
        *NET header information addressed to the next hop toward the OAL
        intermediate node. When the OAL intermediate node receives the carrier
        packet, it recognizes the MFVI included by the OAL source and
        determines the correct egress tunnel endpoint.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">The OAL intermediate node then discards the *NET headers from the
        previous hop and encapsulates the original OCH-0/1 within a second
        OCH-0/1. The OAL intermediate node then includes *NET encapsulation
        headers with destinations appropriate for the next hop on the path to
        the egress tunnel endpoint. The encapsulation appears as shown in
        <a href="#cp-in-cp" class="xref">Figure 9</a>:<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<span id="name-carrier-packet-in-carrier-pa"></span><div id="cp-in-cp">
<figure id="figure-9">
          <div class="artwork art-text alignLeft" id="section-6.5-4.1">
<pre>
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                     |
   |                                     |
   |                                     |
   |        Carrier packet data          |
   |                                     |
   |                                     |
   |                                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Original OCH-0/1           |
   |    MFVI=0x2376a7b5, Id=0x12345678   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Encapsulation OCH-0/1        |
   |    MFVI=0x692a64fc, Id=0x98765432   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            *NET headers             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-carrier-packet-in-carrier-pa" class="selfRef">Carrier Packet in Carrier Packet Encapsulation</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="oal7.9">
<section id="section-6.6">
        <h3 id="name-oal-identification-window-m">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-oal-identification-window-m" class="section-name selfRef">OAL Identification Window Maintenance</a>
        </h3>
<p id="section-6.6-1">The OAL encapsulates each original IP packet as an OAL packet then
        performs fragmentation to produce one or more carrier packets with the
        same 32-bit Identification value. In environments were spoofing is not
        considered a threat, OAL nodes send OAL packets with Identifications
        beginning with an unpredictable Initial Send Sequence (ISS) value
        <span>[<a href="#RFC7739" class="xref">RFC7739</a>]</span> incremented (modulo 2**32) for each
        successive OAL packet and may reset ISS to a new unpredictable value
        at any time. In other environments, OMNI interfaces should maintain
        explicit per-neighbor send and receive windows to exclude spurious
        carrier packets that might clutter the reassembly cache. OMNI
        interface neighbors use TCP-like synchronization to maintain windows
        with unpredictable ISS values incremented (modulo 2 *32) for each
        successive OAL packet and re-negotiate windows frequently to maintain
        an unpredictable profile.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">OMNI interface neighbors exchange IPv6 ND messages with OMNI
        options that include TCP-like information fields to manage streams of
        OAL packets instead of streams of octets. As a link-layer service, the
        OAL provides low-persistence best-effort retransmission with no
        mitigations for duplication, reordering or deterministic delivery.
        Since the service model is best-effort and only control message
        sequence numbers are acknowledged, OAL nodes can select unpredictable
        new initial sequence numbers outside of the current window without
        delaying for the Maximum Segment Lifetime (MSL).<a href="#section-6.6-2" class="pilcrow">¶</a></p>
<p id="section-6.6-3">OMNI interface neighbors maintain current and previous window state
        in IPv6 ND neighbor cache entries (NCEs) to support dynamic rollover
        to a new window while still sending OAL packets and accepting carrier
        packets from the previous windows. Each NCE is indexed by the
        neighbor's LLA, which must also match the ULA used for OAL
        encapsulation. OMNI interface neighbors synchronize windows through
        asymmetric and/or symmetric IPv6 ND message exchanges. When a node
        receives an IPv6 ND message with new window information, it resets the
        previous window state based on the current window then resets the
        current window based on new and/or pending information.<a href="#section-6.6-3" class="pilcrow">¶</a></p>
<p id="section-6.6-4">The IPv6 ND message OMNI option header includes TCP-like
        information fields including Sequence Number, Acknowledgement Number,
        Window and flags (see: <a href="#interface" class="xref">Section 12</a>). OMNI interface
        neighbors maintain the following TCP-like state variables in the
        NCE:<a href="#section-6.6-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.6-5">
<pre>    Send Sequence Variables (current, previous and pending)

      SND.NXT - send next
      SND.WND - send window
      ISS     - initial send sequence number

    Receive Sequence Variables (current and previous)

      RCV.NXT - receive next
      RCV.WND - receive window
      IRS     - initial receive sequence number
</pre><a href="#section-6.6-5" class="pilcrow">¶</a>
</div>
<p id="section-6.6-6">OMNI interface neighbors "OAL A" and "OAL B" exchange IPv6 ND
        messages per <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> with OMNI options that include
        TCP-like information fields. When OAL A synchronizes with OAL B, it
        maintains both a current and previous SND.WND beginning with a new
        unpredictable ISS and monotonically increments SND.NXT for each
        successive OAL packet transmission. OAL A initiates synchronization by
        including the new ISS in the Sequence Number of an authentic IPv6 ND
        NS/RS message with the SYN flag set and with Window set to M as a
        tentative receive window size while creating a NCE in the INCOMPLETE
        state if necessary. OAL A caches the new ISS as pending, uses the new
        ISS as the Identification for OAL encapsulation, then sends the
        resulting OAL packet to OAL B and waits up to RetransTimer
        milliseconds to receive a solicited NA/RA ACK response (retransmitting
        up to MAX_UNICAST_SOLICIT times if necessary).<a href="#section-6.6-6" class="pilcrow">¶</a></p>
<p id="section-6.6-7">When OAL B receives the carrier packets containing the NS/RS SYN,
        it creates a NCE in the STALE state if necessary, resets its RCV
        variables, caches the tentative (send) window size M, and selects a
        (receive) window size N (up to 2^24) to indicate the number of OAL
        packets it is willing to accept under the current RCV.WND. (The
        RCV.WND should be large enough to minimize control message overhead
        yet small enough to provide an effective filter for spurious carrier
        packets.) OAL B then prepares a solicited NA/RA message with the ACK
        flag set, with the Acknowledgement Number set to OAL A's next sequence
        number, and with Window set to N. Since OAL B does not assert an ISS
        of its own, it uses OAL A's IRS as the Identification for OAL
        encapsulation then sends the resulting OAL packet to OAL A.<a href="#section-6.6-7" class="pilcrow">¶</a></p>
<p id="section-6.6-8">When OAL A receives the carrier packets containing the solicited
        NA/RA, it notes that their Identification matches its pending ISS. OAL
        A then sets the NCE state to REACHABLE and resets its SND variables
        based on the Window size and Acknowledgement Number (which must
        include the sequence number following the pending ISS). OAL A can then
        begin sending OAL packets to OAL B with Identification values within
        the (new) current SND.WND for up to ReachableTime milliseconds or
        until the NCE is updated by a new IPv6 ND message exchange. This
        implies that OAL A must send a new NS/RS SYN message before sending
        more than N OAL packets within the current SND.WND, i.e., even if
        ReachableTime is not nearing expiration.<a href="#section-6.6-8" class="pilcrow">¶</a></p>
<p id="section-6.6-9">After OAL B returns the solicited NA/RA, it accepts carrier packets
        received from OAL A within either the current or previous RCV.WND as
        well as any new authentic NS/RS SYN messages received from OAL A even
        if outside the windows. IPv6 ND messages used for window
        synchronization must therefore fit within a single carrier packet
        (i.e., within current MPS constraints), since the carrier packets of
        fragmented IPv6 ND messages with out-of-window Identification values
        could be part of a DoS attack and should not be admitted into the
        reassembly cache. OAL B discards all other carrier packets received
        from OAL A with out-of-window Identifications.<a href="#section-6.6-9" class="pilcrow">¶</a></p>
<p id="section-6.6-10">OMNI interface neighbors can employ asymmetric window
        synchronization as described above using two independent [(NS/RS SYN)
        -&gt; (NA/RA ACK)] exchanges (i.e., a four-message exchange), or they
        can employ symmetric window synchronization using a modified version
        of the TCP three-way handshake as follows:<a href="#section-6.6-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.6-11.1">OAL A prepares an NS/RS SYN message with an unpredictable ISS
            not within the current SND.WND and with Window set to M as a
            tentative receive window size. OAL A caches the new ISS and Window
            size as pending information, uses the pending ISS as the
            Identification for OAL encapsulation, then sends the resulting OAL
            packet to OAL B and waits up to RetransTimer milliseconds to
            receive a solicited NA/RA ACK response (retransmitting up to
            MAX_UNICAST_SOLICIT times if necessary).<a href="#section-6.6-11.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.6-11.2">OAL B receives the carrier packets containing the NS/RS SYN,
            then resets its RCV variables based on the Sequence Number while
            caching OAL A's tentative receive Window size M and a new
            unpredictable ISS outside of its current window as pending
            information. OAL B then prepares a solicited NA/RA response with
            Sequence Number set to the pending ISS and Acknowledgement Number
            set to OAL A's next sequence number. OAL B then sets both the SYN
            and ACK flags, sets Window to N and sets the OPT flag according to
            whether an explicit NS ACK is optional or mandatory. OAL B then
            uses the pending ISS as the Identification for OAL encapsulation,
            sends the resulting OAL packet to OAL A and waits up to
            RetransTimer milliseconds to receive an acknowledgement
            (retransmitting up to MAX_UNICAST_SOLICIT times if necessary).<a href="#section-6.6-11.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.6-11.3">OAL A receives the carrier packets containing the NA/RA
            SYN/ACK, then resets its SND variables based on the
            Acknowledgement Number (which must include the sequence number
            following the pending ISS) and OAL B's advertised Window N. OAL A
            then resets its RCV variables based on the Sequence Number and
            marks the NCE as REACHABLE. If the OPT flag is clear, OAL A next
            prepares an immediate solicited NA message with the ACK flag set,
            the Acknowledgement Number set to OAL B's next sequence number,
            with Window set a value that may be the same as or different than
            M, and with the OAL encapsulation Identification to SND.NXT, then
            sends the resulting OAL packet to OAL B. If the OPT flag is set
            and OAL A has OAL packets queued to send to OAL B, it can
            optionally begin sending their carrier packets under the (new)
            current SND.WND as implicit acknowledgements instead of returning
            an explicit NA ACK. In that case, the tentative Window size M
            becomes the current receive window size.<a href="#section-6.6-11.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.6-11.4">OAL B receives the implicit/explicit acknowledgement(s) then
            resets its SND state based on the pending/advertised values and
            marks the NCE as REACHABLE. If OAL B receives an explicit
            acknowledgement, it uses the advertised Window size and abandons
            the tentative size. (Note that OAL B sets the OPT flag in the NA
            SYN/ACK to assert that it will interpret timely receipt of carrier
            packets within the (new) current window as an implicit
            acknowledgement. Potential benefits include reduced delays and
            control message overhead, but use case analysis is outside the
            scope of this specification.)<a href="#section-6.6-11.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.6-12">Following synchronization, OAL A and OAL B hold updated NCEs and
        can exchange OAL packets with Identifications set to SND.NXT while the
        state remains REACHABLE and there is available window capacity. Either
        neighbor may at any time send a new NS/RS SYN to assert a new ISS. For
        example, if OAL A's current SND.WND for OAL B is nearing exhaustion
        and/or ReachableTime is nearing expiration, OAL A continues to send
        OAL packets under the current SND.WND while also sending an NS/RS SYN
        with a new unpredictable ISS. When OAL B receives the NS/RS SYN, it
        resets its RCV variables and may optionally return either an
        asymmetric NA/RA ACK or a symmetric NA/RA SYN/ACK to also assert a new
        ISS. While sending IPv6 ND SYNs, both neighbors continue to send OAL
        packets with Identifications set to the current SND.NXT then reset the
        SND variables after an acknowledgement is received.<a href="#section-6.6-12" class="pilcrow">¶</a></p>
<p id="section-6.6-13">While the optimal symmetric exchange is efficient, anomalous
        conditions such as receipt of old duplicate SYNs can cause confusion
        for the algorithm as discussed in Section 3.4 of <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span>. For this reason, the OMNI option header includes
        an RST flag which OAL nodes set in solicited NA responses to ACKs
        received with incorrect acknowledgement numbers. The RST procedures
        (and subsequent synchronization recovery) are conducted exactly as
        specified in <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span>.<a href="#section-6.6-13" class="pilcrow">¶</a></p>
<p id="section-6.6-14">OMNI interfaces may set the PNG ("ping") flag in IPv6 ND
        advertisement messages when a reachability confirmation is needed.
        (OMNI interfaces therefore most often set the PNG flag in
        (unsolicited) advertisement messages and ignore it in solicitation
        messages.) When an OMNI interface receives a PNG, it returns a
        solicited NA ACK with the PNG message Identification in the
        Acknowledgment, but without updating RCV state variables. OMNI
        interfaces return unicast solicited NA ACKs even for multicast PNG
        destination addresses, since OMNI link multicast is based on unicast
        emulation. OMNI interfaces may also send unsolicited NA messages to
        request selective retransmissions (see: <a href="#sub9.5" class="xref">Section 12.2.11</a>).<a href="#section-6.6-14" class="pilcrow">¶</a></p>
<p id="section-6.6-15">OMNI interfaces that employ the window synchronization procedures
        described above observe the following requirements:<a href="#section-6.6-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.6-16.1">OMNI interfaces MUST select new unpredictable ISS values that
            are outside of the current SND.WND.<a href="#section-6.6-16.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.6-16.2">OMNI interfaces MUST set the initial NS SYN message Window
            field to a tentative value to be used only if no concluding NA ACK
            is sent.<a href="#section-6.6-16.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.6-16.3">OMNI interfaces that receive NA/RA messages with the PNG and/or
            SYN flag set MUST NOT set the PNG and/or SYN flag in solicited NA
            responses.<a href="#section-6.6-16.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.6-16.4">OMNI interfaces that send NA/RA messages with the PNG and/or
            SYN flag set MUST ignore solicited NA responses with the PNG
            and/or SYN flag set.<a href="#section-6.6-16.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.6-16.5">OMNI interfaces MUST send IPv6 ND messages used for window
            synchronization securely while using unpredictable Identification
            values until synchronization is complete.<a href="#section-6.6-16.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.6-17">When an OMNI interface sends an RS SYN to the link-scoped
        All-Routers multicast address (ff02::2) <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span>, it
        may receive multiple unicast RA ACK or SYN/ACK replies - each with a
        distinct LLA source address. The OMNI interface then creates a
        separate NCE for each distinct neighbor and completes window
        synchronization through independent message exchanges with each
        neighbor. The fact that all neighbors receive the same ISS in the
        original RS SYN is not a matter for concern, as further window
        synchronization will be conducted on a per-neighbor basis.<a href="#section-6.6-17" class="pilcrow">¶</a></p>
<p id="section-6.6-18">Note: Although OMNI interfaces employ TCP-like window
        synchronization and support solicited NA ACK responses to NA/RA SYNs
        and PNGs, all other aspects of the IPv6 ND protocol (e.g., control
        message exchanges, NCE state management, timers, retransmission
        limits, etc.) are honored exactly per <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>.<a href="#section-6.6-18" class="pilcrow">¶</a></p>
<p id="section-6.6-19">Note: Recipients of OAL-encapsulated IPv6 ND messages index the NCE
        based on the ULA source address, which also determines the carrier
        packet Identification window. However, IPv6 ND messages may contain an
        LLA source address that does not match the ULA source address when the
        recipient acts as a proxy.<a href="#section-6.6-19" class="pilcrow">¶</a></p>
<p id="section-6.6-20">Note: OMNI interface neighbors apply the same send and receive
        windows for all of their (multilink) underlying interface pairs that
        exchange carrier packets. Each interface pair represents a distinct
        underlying network path, and the set of paths traversed may be highly
        diverse when multiple interface pairs are used. OMNI intermediate
        nodes therefore SHOULD NOT take actions based on window
        synchronization parameters in IPv6 ND messages they forward since
        there is no way to ensure network-wide middlebox state
        consistency.<a href="#section-6.6-20" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oal3.6">
<section id="section-6.7">
        <h3 id="name-oal-fragment-retransmission">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-oal-fragment-retransmission" class="section-name selfRef">OAL Fragment Retransmission</a>
        </h3>
<p id="section-6.7-1">When the OAL source sends carrier packets to an OAL destination, it
        should cache recently sent packets in case timely best-effort
        selective retransmission is requested. The OAL destination in turn
        maintains a checklist for the (Source, Destination,
        Identification)-tuple of recently received carrier packets and notes
        the ordinal numbers of OAL packet fragments already received (i.e., as
        Frag #0, Frag #1, Frag #2, etc.). The timeframe for maintaining the
        OAL source and destination caches determines the link persistence
        (see: <span>[<a href="#RFC3366" class="xref">RFC3366</a>]</span>).<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<p id="section-6.7-2">If the OAL destination notices some fragments missing after most
        other fragments within the same link persistence timeframe have
        already arrived, it may issue an Automatic Repeat Request (ARQ) with
        Selective Repeat (SR) by sending a uNA message to the OAL source. The
        OAL destination creates a uNA message with an OMNI option with one or
        more Fragmentation Report sub-options that include a list of
        (Identification, Bitmap)-tuples for fragments received and missing
        from this OAL source (see: <a href="#interface" class="xref">Section 12</a>). The OAL
        destination includes an authentication signature if necessary,
        performs OAL encapsulation (with the its own address as the OAL source
        and the source address of the message that prompted the uNA as the OAL
        destination) and sends the message to the OAL source.<a href="#section-6.7-2" class="pilcrow">¶</a></p>
<p id="section-6.7-3">When the OAL source receives the uNA message, it authenticates the
        message then examines the Fragmentation Report. For each (Source,
        Destination, Identification)-tuple, the OAL source determines whether
        it still holds the corresponding carrier packets in its cache and
        retransmits any for which the Bitmap indicates a loss event. For
        example, if the Bitmap indicates that ordinal fragments #3, #7, #10
        and #13 from the same OAL packet are missing the OAL source only
        retransmits carrier packets containing those fragments. When the OAL
        destination receives the retransmitted carrier packets, it admits the
        enclosed fragments into the reassembly cache and updates its
        checklist. If some fragments are still missing, the OAL destination
        may send a small number of additional uNA ARQ/SRs within the link
        persistence timeframe.<a href="#section-6.7-3" class="pilcrow">¶</a></p>
<p id="section-6.7-4">The OAL therefore provides a link-layer low persistence ARQ/SR
        service consistent with <span>[<a href="#RFC3366" class="xref">RFC3366</a>]</span> and Section 8.1 of
        <span>[<a href="#RFC3819" class="xref">RFC3819</a>]</span>. The service provides the benefit of timely
        best-effort link-layer retransmissions which may reduce packet loss
        and avoid some unnecessary end-to-end delays.<a href="#section-6.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oal3">
<section id="section-6.8">
        <h3 id="name-oal-mtu-feedback-messaging">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-oal-mtu-feedback-messaging" class="section-name selfRef">OAL MTU Feedback Messaging</a>
        </h3>
<p id="section-6.8-1">When the OMNI interface forwards original IP packets from the
        network layer, it invokes the OAL and returns internally-generated
        ICMPv4 Fragmentation Needed <span>[<a href="#RFC1191" class="xref">RFC1191</a>]</span> or ICMPv6 Path
        MTU Discovery (PMTUD) Packet Too Big (PTB) <span>[<a href="#RFC8201" class="xref">RFC8201</a>]</span>
        messages as necessary. This document refers to both of these
        ICMPv4/ICMPv6 message types simply as "PTBs", and introduces a
        distinction between PTB "hard" and "soft" errors as discussed
        below.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
<p id="section-6.8-2">Ordinary PTB messages with ICMPv4 header "unused" field or ICMPv6
        header Code field value 0 are hard errors that always indicate that a
        packet has been dropped due to a real MTU restriction. In particular,
        the OAL source drops the packet and returns a PTB hard error if the
        packet exceeds the OAL destination MRU. However, the OMNI interface
        can also forward large original IP packets via OAL encapsulation and
        fragmentation while at the same time returning PTB soft error messages
        (subject to rate limiting) if it deems the original IP packet too
        large according to factors such as link performance characteristics,
        reassembly congestion, etc. This ensures that the path MTU is adaptive
        and reflects the current path used for a given data flow. The OMNI
        interface can therefore continuously forward packets without loss
        while returning PTB soft error messages recommending a smaller size if
        necessary. Original sources that receive the soft errors in turn
        reduce the size of the packets they send (i.e., the same as for hard
        errors), but can soon resume sending larger packets if the soft errors
        subside.<a href="#section-6.8-2" class="pilcrow">¶</a></p>
<p id="section-6.8-3">An OAL source sends PTB soft error messages by setting the ICMPv4
        header "unused" field or ICMPv6 header Code field to the value 1 if a
        original IP packet was deemed lost (e.g., due to reassembly timeout)
        or to the value 2 otherwise. The OAL source sets the PTB destination
        address to the original IP packet source, and sets the source address
        to one of its OMNI interface addresses that is routable from the
        perspective of the original source. The OAL source then sets the MTU
        field to a value smaller than the original packet size but no smaller
        than 576 for ICMPv4 or 1280 for ICMPv6, writes the leading portion of
        the original IP packet into the "packet in error" field, and returns
        the PTB soft error to the original source. When the original source
        receives the PTB soft error, it temporarily reduces the size of the
        packets it sends the same as for hard errors but may seek to increase
        future packet sizes dynamically while no further soft errors are
        arriving. (If the original source does not recognize the soft error
        code, it regards the PTB the same as a hard error but should heed the
        retransmission advice given in <span>[<a href="#RFC8201" class="xref">RFC8201</a>]</span> suggesting
        retransmission based on normal packetization layer retransmission
        timers.)<a href="#section-6.8-3" class="pilcrow">¶</a></p>
<p id="section-6.8-4">An OAL destination may experience reassembly cache congestion, and
        can return uNA messages to the OAL source that originated the
        fragments (subject to rate limiting) to advertise reduced hard/soft
        Reassembly Limits and/or to report individual reassembly failures. The
        OAL destination creates a uNA message with an OMNI option containing
        an authentication message sub-option (if the OAL source is on an open
        Internetwork) followed optionally by at most one hard and one soft
        Reassembly Limit sub-options with reduced hard/soft values, and with
        one of them optionally including the leading portion an OAL first
        fragment containing the header of an original IP packet whose source
        must be notified (see: <a href="#interface" class="xref">Section 12</a>). The OAL
        destination encapsulates the leading portion of the OAL first fragment
        (beginning with the OAL header) in the "OAL First Fragment" field of
        sub-option, signs the message if an authentication sub-option is
        included, performs OAL encapsulation (with the its own address as the
        OAL source and the source address of the message that prompted the uNA
        as the OAL destination) and sends the message to the OAL source.<a href="#section-6.8-4" class="pilcrow">¶</a></p>
<p id="section-6.8-5">When the OAL source receives the uNA message, it records the new
        hard/soft Reassembly Limit values for this OAL destination if the OMNI
        option includes Reassembly Limit sub-options. If a hard or soft
        Reassembly Limit sub-option includes an OAL First Fragment, the OAL
        source next sends a corresponding network layer PTB hard or soft error
        to the original source to recommend a smaller size. For hard errors,
        the OAL source sets the PTB Code field to 0. For soft errors, the OAL
        source sets the PTB Code field to 1 if the L flag in the Reassembly
        Limit sub-option is 1; otherwise, the OAL source sets the Code field
        to 2. The OAL source crafts the PTB by extracting the leading portion
        of the original IP packet from the OAL First Fragment field (i.e., not
        including the OAL header) and writes it in the "packet in error" field
        of a PTB with destination set to the original IP packet source and
        source set to one of its OMNI interface addresses that is routable
        from the perspective of the original source. For future transmissions,
        if the original IP packet is larger than the hard Reassembly Limit for
        this OAL destination the OAL source drops the packet and returns a PTB
        hard error with MTU set to the hard Reassembly Limit. If the packet is
        no larger than the current hard Reassembly Limit but larger than the
        current soft limit, the OAL source can also return a PTB soft error
        (subject to rate limiting) with Code set to 2 and MTU set to the
        current soft limit while still forwarding the packet to the OMNI
        destination.<a href="#section-6.8-5" class="pilcrow">¶</a></p>
<p id="section-6.8-6">Original sources that receive PTB soft errors can dynamically tune
        the size of the original IP packets they to send to produce the best
        possible throughput and latency, with the understanding that these
        parameters may change over time due to factors such as congestion,
        mobility, network path changes, etc. The receipt or absence of soft
        errors should be seen as hints of when increasing or decreasing packet
        sizes may be beneficial. The OMNI interface supports continuous
        transmission and reception of packets of various sizes in the face of
        dynamically changing network conditions. Moreover, since PTB soft
        errors do not indicate a hard limit, original sources that receive
        soft errors can begin sending larger packets without waiting for the
        recommended 10 minutes specified for PTB hard errors <span>[<a href="#RFC1191" class="xref">RFC1191</a>]</span><span>[<a href="#RFC8201" class="xref">RFC8201</a>]</span>. The OMNI interface
        therefore provides an adaptive service that accommodates MTU diversity
        especially well-suited for dynamic multilink environments.<a href="#section-6.8-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oal52">
<section id="section-6.9">
        <h3 id="name-oal-requirements">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-oal-requirements" class="section-name selfRef">OAL Requirements</a>
        </h3>
<p id="section-6.9-1">In light of the above, OAL sources, destinations and intermediate
        nodes observe the following normative requirements:<a href="#section-6.9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.9-2.1">OAL sources MUST NOT use the OAL to forward original IP packets
            larger than the OMNI interface MTU or the OAL destination hard
            Reassembly Limit.(i.e., whether as atomic fragments or multiple
            fragments).<a href="#section-6.9-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.9-2.2">OAL sources MUST forward original IP packets smaller than the
            minimum MPS minus the trailer size as atomic fragments (i.e., and
            not as multiple fragments).<a href="#section-6.9-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.9-2.3">OAL sources MUST produce non-final fragments with payloads no
            smaller than the minimum MPS during fragmentation.<a href="#section-6.9-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.9-2.4">OAL sources MUST NOT produce fragments that include any
            extension headers other than a single Fragment Header.<a href="#section-6.9-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.9-2.5">OAL intermediate nodes SHOULD and OAL destinations MUST
            unconditionally drop any OAL fragments with offset and length that
            would cause the reassembled packet to exceed the OMNI interface
            MRU and/or OAL destination hard Reassembly Limit.<a href="#section-6.9-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.9-2.6">OAL intermediate nodes SHOULD and OAL destinations MUST
            unconditionally drop any non-final OAL fragments with payloads
            smaller than the minimum MPS.<a href="#section-6.9-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.9-2.7">OAL intermediate nodes SHOULD and OAL destinations MUST
            unconditionally drop OAL fragments that include any extension
            headers other than a single Fragment Header.<a href="#section-6.9-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.9-2.8">OAL destinations MUST drop any new OAL fragments with Offset
            and Payload length that would overlap with other fragments and/or
            leave holes smaller than the minimum MPS between fragments that
            have already been received.<a href="#section-6.9-2.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.9-3">Note: Under the minimum MPS, ordinary 1500 byte original IP packets
        would require at most 4 OAL fragments, with each non-final fragment
        containing 400 payload bytes and the final fragment containing 302
        payload bytes (i.e., the final 300 bytes of the original IP packet
        plus the 2 octet trailer). Likewise, maximum-length 9180 byte original
        IP packets would require at most 23 fragments. For all packet sizes,
        the likelihood of successful reassembly may improve when the OMNI
        interface sends all fragments of the same fragmented OAL packet
        consecutively over the same underlying interface pair instead of
        spread across multiple underlying interface pairs. Finally, an assured
        minimum/path MPS allows continuous operation over all paths including
        those that traverse bridged L2 media with dissimilar MTUs.<a href="#section-6.9-3" class="pilcrow">¶</a></p>
<p id="section-6.9-4">Note: Certain legacy network hardware of the past millennium was
        unable to accept packet "bursts" resulting from an IP fragmentation
        event - even to the point that the hardware would reset itself when
        presented with a burst. This does not seem to be a common problem in
        the modern era, where fragmentation and reassembly can be readily
        demonstrated at line rate (e.g., using tools such as 'iperf3') even
        over fast links on ordinary hardware platforms. Even so, the OAL
        source could impose an inter-fragment delay while the OAL destination
        is reporting reassembly congestion (see: <a href="#oal3" class="xref">Section 6.8</a>) and
        decrease the delay when reassembly congestion subsides.<a href="#section-6.9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fragsec">
<section id="section-6.10">
        <h3 id="name-oal-fragmentation-security-">
<a href="#section-6.10" class="section-number selfRef">6.10. </a><a href="#name-oal-fragmentation-security-" class="section-name selfRef">OAL Fragmentation Security Implications</a>
        </h3>
<p id="section-6.10-1">As discussed in Section 3.7 of <span>[<a href="#RFC8900" class="xref">RFC8900</a>]</span>, there are
        four basic threats concerning IPv6 fragmentation; each of which is
        addressed by effective mitigations as follows:<a href="#section-6.10-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.10-2">
<li id="section-6.10-2.1">Overlapping fragment attacks - reassembly of overlapping
            fragments is forbidden by <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>; therefore,
            this threat does not apply to the OAL.<a href="#section-6.10-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.10-2.2">Resource exhaustion attacks - this threat is mitigated by
            providing a sufficiently large OAL reassembly cache and
            instituting "fast discard" of incomplete reassemblies
            that may be part of a buffer exhaustion attack. The reassembly
            cache should be sufficiently large so that a sustained attack does
            not cause excessive loss of good reassemblies but not so large
            that (timer-based) data structure management becomes
            computationally expensive. The cache should also be indexed based
            on the arrival underlying interface such that congestion
            experienced over a first underlying interface does not cause
            discard of incomplete reassemblies for uncongested underlying
            interfaces.<a href="#section-6.10-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.10-2.3">Attacks based on predictable fragment identification values -
            in environments where spoofing is possible, this threat is
            mitigated through the use of Identification windows beginning with
            unpredictable values per <a href="#oal7.9" class="xref">Section 6.6</a>. By maintaining
            windows of acceptable Identifications, OAL neighbors can quickly
            discard spurious carrier packets that might otherwise clutter the
            reassembly cache. The OAL additionally provides an integrity check
            to detect corruption that may be caused by spurious fragments
            received with in-window Identification values.<a href="#section-6.10-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.10-2.4">Evasion of Network Intrusion Detection Systems (NIDS) - since
            the OAL source employs a robust MPS, network-based firewalls can
            inspect and drop OAL fragments containing malicious data thereby
            disabling reassembly by the OAL destination. However, since OAL
            fragments may take different paths through the network (some of
            which may not employ a firewall) each OAL destination must also
            employ a firewall.<a href="#section-6.10-2.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.10-3">IPv4 includes a 16-bit Identification (IP ID) field with only
        65535 unique values such that at high data rates the field could wrap
        and apply to new carrier packets while the fragments of old packets
        using the same IP ID are still alive in the network <span>[<a href="#RFC4963" class="xref">RFC4963</a>]</span>. Since carrier packets sent via an IPv4 path with
        DF=0 are normally no larger than 576 bytes, IPv4 fragmentation is
        possible only at small-MTU links in the path which should support data
        rates low enough for safe reassembly <span>[<a href="#RFC3819" class="xref">RFC3819</a>]</span>. (IPv4
        carrier packets larger than 576 bytes with DF=0 may incur high data
        rate reassembly errors in the path, but the OAL checksum provides OAL
        destination integrity assurance.) Since IPv6 provides a 32-bit
        Identification value, IP ID wraparound at high data rates is not a
        concern for IPv6 fragmentation.<a href="#section-6.10-3" class="pilcrow">¶</a></p>
<p id="section-6.10-4">Fragmentation security concerns for large IPv6 ND messages are
        documented in <span>[<a href="#RFC6980" class="xref">RFC6980</a>]</span>. These concerns are addressed
        when the OMNI interface employs the OAL instead of directly
        fragmenting the IPv6 ND message itself. For this reason, OMNI
        interfaces MUST NOT send IPv6 ND messages larger than the OMNI
        interface MTU, and MUST employ OAL encapsulation and fragmentation for
        IPv6 ND messages larger than the minimum/path MPS for this OAL
        destination.<a href="#section-6.10-4" class="pilcrow">¶</a></p>
<p id="section-6.10-5">Unless the path is secured at the network-layer or below (i.e., in
        environments where spoofing is possible), OMNI interfaces MUST NOT
        send ordinary carrier packets with Identification values outside the
        current window and MUST secure IPv6 ND messages used for address
        resolution or window state synchronization. OAL destinations SHOULD
        therefore discard without reassembling any out-of-window OAL fragments
        received over an unsecured path.<a href="#section-6.10-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="packing">
<section id="section-6.11">
        <h3 id="name-oal-super-packets">
<a href="#section-6.11" class="section-number selfRef">6.11. </a><a href="#name-oal-super-packets" class="section-name selfRef">OAL Super-Packets</a>
        </h3>
<p id="section-6.11-1">By default, the OAL source includes a 40-byte IPv6 encapsulation
        header for each original IP packet during OAL encapsulation. The OAL
        source also calculates and appends a 2 octet trailing checksum then
        performs fragmentation such that a copy of the 40-byte IPv6 header
        plus an 8-byte IPv6 Fragment Header is included in each OAL fragment
        (when a Routing Header is added, the OAL encapsulation headers become
        larger still). However, these encapsulations may represent excessive
        overhead in some environments. OAL header compression can dramatically
        reduce the amount of encapsulation overhead, however a complimentary
        technique known as "packing" (see: <span>[<a href="#I-D.ietf-intarea-tunnels" class="xref">I-D.ietf-intarea-tunnels</a>]</span>) supports encapsulation of
        multiple original IP packets and/or control messages within a single
        OAL "super-packet".<a href="#section-6.11-1" class="pilcrow">¶</a></p>
<p id="section-6.11-2">When the OAL source has multiple original IP packets to send to the
        same OAL destination with total length no larger than the OAL
        destination MRU, it can concatenate them into a super-packet
        encapsulated in a single OAL header and trailing checksum. Within the
        OAL super-packet, the IP header of the first original IP packet (iHa)
        followed by its data (iDa) is concatenated immediately following the
        OAL header, then the IP header of the next original packet (iHb)
        followed by its data (iDb) is concatenated immediately following the
        first original packet, etc. with the trailing checksum included last.
        The OAL super-packet format is transposed from <span>[<a href="#I-D.ietf-intarea-tunnels" class="xref">I-D.ietf-intarea-tunnels</a>]</span> and shown in <a href="#super-packet" class="xref">Figure 10</a>:<a href="#section-6.11-2" class="pilcrow">¶</a></p>
<span id="name-oal-super-packet-format"></span><div id="super-packet">
<figure id="figure-10">
          <div class="artwork art-text alignLeft" id="section-6.11-3.1">
<pre>                &lt;------- Original IP packets -------&gt;
                +-----+-----+
                | iHa | iDa |
                +-----+-----+
                      |
                      |     +-----+-----+
                      |     | iHb | iDb |
                      |     +-----+-----+
                      |           |
                      |           |     +-----+-----+
                      |           |     | iHc | iDc |
                      |           |     +-----+-----+
                      |           |           |
                      v           v           v
     +----------+-----+-----+-----+-----+-----+-----+----+
     |  OAL Hdr | iHa | iDa | iHb | iDb | iHc | iDc |Csum|
     +----------+-----+-----+-----+-----+-----+-----+----+
     &lt;--- OAL "Super-Packet" with single OAL Hdr/Csum ---&gt;
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-oal-super-packet-format" class="selfRef">OAL Super-Packet Format</a>
          </figcaption></figure>
</div>
<p id="section-6.11-4">When the OAL source prepares a super-packet, it applies OAL
        fragmentation and *NET encapsulation then sends the resulting carrier
        packets to the OAL destination. When the OAL destination receives the
        super-packet it reassembles if necessary, verifies and removes the
        trailing checksum, then regards the remaining OAL header Payload
        Length as the sum of the lengths of all payload packets. The OAL
        destination then selectively extracts each original IP packet (e.g.,
        by setting pointers into the super-packet buffer and maintaining a
        reference count, by copying each packet into a separate buffer, etc.)
        and forwards each packet to the network layer. During extraction, the
        OAL determines the IP protocol version of each successive original IP
        packet 'j' by examining the four most-significant bits of iH(j), and
        determines the length of the packet by examining the rest of iH(j)
        according to the IP protocol version.<a href="#section-6.11-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="frame">
<section id="section-7">
      <h2 id="name-frame-format">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-frame-format" class="section-name selfRef">Frame Format</a>
      </h2>
<p id="section-7-1">When the OMNI interface forwards original IP packets from the network
      layer it first invokes the OAL to create OAL packets/fragments if
      necessary, then includes any *NET encapsulations and finally engages the
      native frame format of the underlying interface. For example, for
      Ethernet-compatible interfaces the frame format is specified in <span>[<a href="#RFC2464" class="xref">RFC2464</a>]</span>, for aeronautical radio interfaces the frame format
      is specified in standards such as ICAO Doc 9776 (VDL Mode 2 Technical
      Manual), for various forms of tunnels the frame format is found in the
      appropriate tunneling specification, etc.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">See <a href="#omni-layering" class="xref">Figure 2</a> for a map of the various *NET
      layering combinations possible. For any layering combination, the final
      layer (e.g., UDP, IP, Ethernet, etc.) must have an assigned number and
      frame format representation that is compatible with the selected
      underlying interface.<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aero-address">
<section id="section-8">
      <h2 id="name-link-local-addresses-llas">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-link-local-addresses-llas" class="section-name selfRef">Link-Local Addresses (LLAs)</a>
      </h2>
<p id="section-8-1">OMNI interfaces assign IPv6 Link-Local Addresses (LLAs) through
      pre-service administrative actions. Clients assign "MNP-LLAs" with
      interface identifiers that embed the MNP, while Proxy/Servers assign
      "ADM-LLAs" that include an administrative ID guaranteed to be unique on
      the link. LLAs are configured as follows:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">IPv6 MNP-LLAs encode the most-significant 64 bits of a MNP within
          the least-significant 64 bits of the IPv6 link-local prefix
          fe80::/64, i.e., in the LLA "interface identifier" portion. The
          prefix length for the LLA is determined by adding 64 to the MNP
          prefix length. For example, for the MNP 2001:db8:1000:2000::/56 the
          corresponding MNP-LLA prefix is fe80::2001:db8:1000:2000/120. (The
          master MNP-LLA for each "/N" prefix sets the final 128-N bits to 0,
          but all MNP-LLAs that match the prefix are accepted.) Non-MNP routes
          are also represented the same as for MNP-LLAs, but include a GUA
          prefix that is not properly covered by the MSP.<a href="#section-8-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.2">IPv4-compatible MNP-LLAs are constructed as fe80::ffff:[IPv4],
          i.e., the interface identifier consists of 16 '0' bits, followed by
          16 '1' bits, followed by a 32bit IPv4 address/prefix. The prefix
          length for the LLA is determined by adding 96 to the MNP prefix
          length. For example, the IPv4-Compatible MNP-LLA for 192.0.2.0/24 is
          fe80::ffff:192.0.2.0/120, also written as fe80::ffff:c000:0200/120.
          (The master MNP-LLA for each "/N" prefix sets the final 128-N bits
          to 0, but all MNP-LLAs that match the prefix are accepted.)<a href="#section-8-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.3">ADM-LLAs are assigned to Proxy/Servers (and possibly other SRT
          infrastructure elements) and MUST be managed for uniqueness. The
          lower 32 bits of the LLA includes a unique integer "MSID" value
          between 0x00000001 and 0xfeffffff, e.g., as in fe80::1, fe80::2,
          fe80::3, etc., fe80::feffffff. The ADM-LLA prefix length is
          determined by adding 96 to the MSID prefix length. For example, if
          the prefix length for MSID 0x10012001 is 16 then the ADM-LLA prefix
          length is set to 112 and the LLA is written as fe80::1001:2001/112.
          The "zero" address for each ADM-LLA prefix is the Subnet-Router
          anycast address for that prefix <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span>; for
          example, the Subnet-Router anycast address for fe80::1001:2001/112
          is simply fe80::1001:2000. The MSID range 0xff000000 through
          0xffffffff is reserved for future use.<a href="#section-8-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-3">Since the prefix 0000::/8 is "Reserved by the IETF" <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span>, no MNPs can be allocated from that block ensuring
      that there is no possibility for overlap between the different MNP- and
      ADM-LLA constructs discussed above.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">Since MNP-LLAs are based on the distribution of administratively
      assured unique MNPs, and since ADM-LLAs are guaranteed unique through
      administrative assignment, OMNI interfaces set the autoconfiguration
      variable DupAddrDetectTransmits to 0 <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span>.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">Note: If future protocol extensions relax the 64-bit boundary in IPv6
      addressing, the additional prefix bits of an MNP could be encoded in
      bits 16 through 63 of the MNP-LLA. (The most-significant 64 bits would
      therefore still be in bits 64-127, and the remaining bits would appear
      in bits 16 through 48.) However, the analysis provided in <span>[<a href="#RFC7421" class="xref">RFC7421</a>]</span> suggests that the 64-bit boundary will remain in the
      IPv6 architecture for the foreseeable future.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">Note: Even though this document honors the 64-bit boundary in IPv6
      addressing, it specifies prefix lengths longer than /64 for routing
      purposes. This effectively extends IPv6 routing determination into the
      interface identifier portion of the IPv6 address, but it does not
      redefine the 64-bit boundary. Modern routing protocol implementations
      honor IPv6 prefixes of all lengths, up to and including /128.<a href="#section-8-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="span-address">
<section id="section-9">
      <h2 id="name-unique-local-addresses-ulas">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-unique-local-addresses-ulas" class="section-name selfRef">Unique-Local Addresses (ULAs)</a>
      </h2>
<p id="section-9-1">OMNI domains use IPv6 Unique-Local Addresses (ULAs) as the source and
      destination addresses in OAL packet IPv6 encapsulation headers. ULAs are
      only routable within the scope of a an OMNI domain, and are derived from
      the IPv6 Unique Local Address prefix fc00::/7 followed by the L bit set
      to 1 (i.e., as fd00::/8) followed by a 40-bit pseudo-random Global ID to
      produce the prefix [ULA]::/48, which is then followed by a 16-bit Subnet
      ID then finally followed by a 64 bit Interface ID as specified in
      Section 3 of <span>[<a href="#RFC4193" class="xref">RFC4193</a>]</span>. All nodes in the same OMNI domain
      configure the same 40-bit Global ID as the OMNI domain identifier. The
      statistic uniqueness of the 40-bit pseudo-random Global ID allows
      different OMNI domains to be joined together in the future without
      requiring renumbering.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Each OMNI link instance is identified by a 16-bit Subnet ID value
      between 0x0000 and 0xfeff in bits 48-63 of [ULA]::/48. The Subnet ID
      values 0xff00 through 0xfffe are reserved for future use, while 0xffff
      denotes the presence of a Temporary ULA (see below). For example, OMNI
      ULAs associated with instance 0 are configured from the prefix
      [ULA]:0000::/64, instance 1 from [ULA]:0001::/64, instance 2 from
      [ULA]:0002::/64, etc. ULAs and their associated prefix lengths are
      configured in correspondence with LLAs through stateless prefix
      translation where "MNP-ULAs" are assigned in correspondence to MNP-LLAs
      and "ADM-ULAs" are assigned in correspondence to ADM-LLAs. For example,
      for OMNI link instance [ULA]:1010::/64:<a href="#section-9-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-3.1">the MNP-ULA corresponding to the MNP-LLA fe80::2001:db8:1:2 with
          a 56-bit MNP length is derived by copying the lower 64 bits of the
          LLA into the lower 64 bits of the ULA as [ULA]:1010:2001:db8:1:2/120
          (where, the ULA prefix length becomes 64 plus the IPv6 MNP
          length).<a href="#section-9-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-3.2">the MNP-ULA corresponding to fe80::ffff:192.0.2.0 with a 28-bit
          MNP length is derived by simply writing the LLA interface ID into
          the lower 64 bits as [ULA]:1010:0:ffff:192.0.2.0/124 (where, the ULA
          prefix length is 64 plus 32 plus the IPv4 MNP length).<a href="#section-9-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-3.3">the ADM-ULA corresponding to fe80::1000/112 is simply
          [ULA]:1010::1000/112.<a href="#section-9-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-3.4">the ADM-ULA corresponding to fe80::/128 is simply
          [ULA]:1010::/128.<a href="#section-9-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-3.5">etc.<a href="#section-9-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-9-4">The ULA presents an IPv6 address format that is routable within the
      OMNI routing system and can be used to convey link-scoped IPv6 ND
      messages across multiple hops using IPv6 encapsulation <span>[<a href="#RFC2473" class="xref">RFC2473</a>]</span>. The OMNI link extends across one or more underling
      Internetworks to include all Proxy/Servers. All Clients are also
      considered to be connected to the OMNI link, however unnecessary
      encapsulations are omitted whenever possible to conserve bandwidth (see:
      <a href="#concept" class="xref">Section 14</a>).<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">Temporary ULAs are constructed per <span>[<a href="#RFC8981" class="xref">RFC8981</a>]</span> based on
      the prefix [ULA]:ffff::/64 and used by Clients when they have no other
      addresses. Temporary ULAs can be used for Client-to-Client
      communications outside the context of any supporting OMNI link
      infrastructure, and can also be used as an initial address while the
      Client is in the process of procuring an MNP. Temporary ULAs are not
      routable within the OMNI routing system, and are therefore useful only
      for OMNI link "edge" communications. Temporary ULAs employ optimistic
      DAD principles <span>[<a href="#RFC4429" class="xref">RFC4429</a>]</span> since they are probabilistically
      unique.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">Each OMNI link may be subdivided into SRT segments that often
      correspond to different administrative domains or physical partitions.
      OMNI nodes can use Segment Routing <span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span> to support
      efficient forwarding to destinations located in other OMNI link
      segments. A full discussion of Segment Routing over the OMNI link
      appears in <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>.<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">Note: IPv6 ULAs taken from the prefix fc00::/7 followed by the L bit
      set to 0 (i.e., as fc00::/8) are never used for OMNI OAL addressing,
      however the range could be used for MSP/MNP addressing under certain
      limiting conditions (see: <a href="#gua" class="xref">Section 10</a>).<a href="#section-9-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gua">
<section id="section-10">
      <h2 id="name-global-unicast-addresses-gu">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-global-unicast-addresses-gu" class="section-name selfRef">Global Unicast Addresses (GUAs)</a>
      </h2>
<p id="section-10-1">OMNI domains use IP Global Unicast Address (GUA) prefixes <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span> as Mobility Service Prefixes (MSPs) from which Mobile
      Network Prefixes (MNP) are delegated to Clients. Fixed correspondent
      node networks reachable from the OMNI domain are represented by non-MNP
      GUA prefixes that are not derived from the MSP, but are treated in all
      other ways the same as for MNPs.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">For IPv6, GUA MSPs are assigned by IANA <span>[<a href="#IPV6-GUA" class="xref">IPV6-GUA</a>]</span>
      and/or an associated regional assigned numbers authority such that the
      OMNI domain can be interconnected to the global IPv6 Internet without
      causing inconsistencies in the routing system. An OMNI domain could
      instead use ULAs with the 'L' bit set to 0 (i.e., from the prefix
      fc00::/8)<span>[<a href="#RFC4193" class="xref">RFC4193</a>]</span>, however this would require
      IPv6 NAT if the domain were ever connected to the global IPv6
      Internet.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">For IPv4, GUA MSP are assigned by IANA <span>[<a href="#IPV4-GUA" class="xref">IPV4-GUA</a>]</span>
      and/or an associated regional assigned numbers authority such that the
      OMNI domain can be interconnected to the global IPv4 Internet without
      causing routing inconsistencies. An OMNI domain could instead use
      private IPv4 prefixes (e.g., 10.0.0.0/8, etc.) <span>[<a href="#RFC3330" class="xref">RFC3330</a>]</span>,
      however this would require IPv4 NAT if the domain were ever connected to
      the global IPv4 Internet. OMNI interfaces advertise IPv4 MSPs into IPv6
      routing systems as IPv4-mapped IPv6 prefixes <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span>
      (e.g., the IPv6 prefix for the IPv4 MSP 192.0.2.0/24 is
      ::ffff:192.0.2.0/120).<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">OMNI interfaces assign the IPv4 anycast address TBD3, and IPv4
      routers that configure OMNI interfaces advertise the prefix TBD3/N into
      the routing system of other networks (see: IANA Considerations). OMNI
      interfaces also configure global IPv6 anycast addresses formed according
      to <span>[<a href="#RFC3056" class="xref">RFC3056</a>]</span> as:<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">2002:TBD3[32]:MNP[64]:Link_ID[16]<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">where TBD3[32] is the 32 bit IPv4 anycast address, MNP[64] encodes an
      MSP zero-padded to 64 bits (if necessary) and Link_ID[16] encodes a 16
      bit value between 0 and 0xfffe that identifies a specific OMNI link
      within an OMNI domain (the Link_ID value 0xffff is an OMNI link
      "anycast" value configured by all OMNI interfaces within the same
      domain). For example, the OMNI IPv6 anycast address for MSP
      2001:db8::/32 is 2002:TBD3[32]:2001:db8:0:0:Link_ID[16], the OMNI IPv6
      anycast address for MSP 192.0.2.0/24 is
      2002:TBD3[32]:0000:ffff:c000:0200:Link_ID[16], etc.).<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">OMNI interfaces assign OMNI IPv6 anycast addresses, and IPv6 routers
      that configure OMNI interfaces advertise the corresponding prefixes into
      the routing system of other networks. An OMNI IPv6 anycast prefix is
      formed the same as for any IPv6 prefix; for example, the prefix
      2002:TBD3[32]:2001:db8::/80 matches all OMNI IPv6 anycast addresses
      covered by the prefix. By advertising OMNI IPv6 anycast prefixes in this
      way, OMNI Clients can locate and associate with the OMNI domain and/or a
      specific link within the OMNI domain that services the MSP of
      interest.<a href="#section-10-7" class="pilcrow">¶</a></p>
<p id="section-10-8">OMNI interfaces use OMNI IPv6 and IPv4 anycast addresses to support
      Service Discovery in the spirit of <span>[<a href="#RFC7094" class="xref">RFC7094</a>]</span>, i.e., the
      addresses are not intended for use in long-term transport protocol
      sessions. Specific applications for OMNI IPv6 and IPv4 anycast addresses
      are discussed throughout the document as well as in <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>.<a href="#section-10-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="node-id">
<section id="section-11">
      <h2 id="name-node-identification">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-node-identification" class="section-name selfRef">Node Identification</a>
      </h2>
<p id="section-11-1">OMNI Clients and Proxy/Servers that connect over open Internetworks
      include a unique node identification value for themselves in the OMNI
      options of their IPv6 ND messages (see: <a href="#sub10" class="xref">Section 12.2.12</a>). An
      example identification value alternative is the Host Identity Tag (HIT)
      as specified in <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span>, while Hierarchical HITs
      (HHITs) <span>[<a href="#I-D.ietf-drip-rid" class="xref">I-D.ietf-drip-rid</a>]</span> may be more appropriate for
      certain domains such as the Unmanned (Air) Traffic Management (UTM)
      service for Unmanned Air Systems (UAS). Another example is the
      Universally Unique IDentifier (UUID) <span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span> which can
      be self-generated by a node without supporting infrastructure with very
      low probability of collision.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">When a Client is truly outside the context of any infrastructure, it
      may have no MNP information at all. In that case, the Client can use an
      IPv6 temporary ULA or (H)HIT as an IPv6 source/destination address for
      sustained communications in Vehicle-to-Vehicle (V2V) and (multihop)
      Vehicle-to-Infrastructure (V2I) scenarios. The Client can also propagate
      the ULA/(H)HIT into the multihop routing tables of (collective)
      Mobile/Vehicular Ad-hoc Networks (MANETs/VANETs) using only the vehicles
      themselves as communications relays.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">When a Client connects via a protected-spectrum ANET, an alternate
      form of node identification (e.g., MAC address, serial number, airframe
      identification value, VIN, etc.) may be sufficient. The Client can then
      include OMNI "Node Identification" sub-options (see: <a href="#sub10" class="xref">Section 12.2.12</a>) in IPv6 ND messages should the need to transmit
      identification information over the network arise.<a href="#section-11-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interface">
<section id="section-12">
      <h2 id="name-address-mapping-unicast">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-address-mapping-unicast" class="section-name selfRef">Address Mapping - Unicast</a>
      </h2>
<p id="section-12-1">OMNI interfaces maintain a neighbor cache for tracking per-neighbor
      state and use the link-local address format specified in <a href="#aero-address" class="xref">Section 8</a>. IPv6 Neighbor Discovery (ND) <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> messages sent over OMNI interfaces without
      encapsulation observe the native underlying interface Source/Target
      Link-Layer Address Option (S/TLLAO) format (e.g., for Ethernet the
      S/TLLAO is specified in <span>[<a href="#RFC2464" class="xref">RFC2464</a>]</span>). IPv6 ND messages sent
      over OMNI interfaces using encapsulation do not include S/TLLAOs, but
      instead include a new option type that encodes encapsulation addresses,
      interface attributes and other OMNI link information. Hence, this
      document does not define an S/TLLAO format but instead defines a new
      option type termed the "OMNI option" designed for these purposes. (Note
      that OMNI interface IPv6 ND messages sent without encapsulation may
      include both OMNI options and S/TLLAOs, but the information conveyed in
      each is mutually exclusive.)<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">OMNI interfaces prepare IPv6 ND messages that include one or more
      OMNI options (and any other IPv6 ND options) then completely populate
      all option information. If the OMNI interface includes an authentication
      signature, it sets the IPv6 ND message Checksum field to 0 and
      calculates the authentication signature over the entire length of the
      message (beginning with a pseudo-header of the IPv6 header) but does not
      calculate/include the IPv6 ND message checksum itself. If the OMNI
      interface forwards the message to a next hop over the secured spanning
      tree path, it need not include either an authentication signature or
      checksum since lower layers already ensure authentication and integrity.
      In all other cases, the OMNI interface calculates the standard IPv6 ND
      message checksum and writes the value in the Checksum field. OMNI
      interfaces verify authentication and/or integrity of each IPv6 ND
      message received according to the specific check(s) included, and
      process the message further only following verification.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">OMNI interface Clients such as aircraft typically have many wireless
      data link types (e.g. satellite-based, cellular, terrestrial, air-to-air
      directional, etc.) with diverse performance, cost and availability
      properties. The OMNI interface would therefore appear to have multiple
      L2 connections, and may include information for multiple underlying
      interfaces in a single IPv6 ND message exchange. OMNI interfaces manage
      their dynamically-changing multilink profiles by including OMNI options
      in IPv6 ND messages as discussed in the following subsections.<a href="#section-12-3" class="pilcrow">¶</a></p>
<div id="omni-opt">
<section id="section-12.1">
        <h3 id="name-the-omni-option">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-the-omni-option" class="section-name selfRef">The OMNI Option</a>
        </h3>
<p id="section-12.1-1">The first OMNI option appearing in an IPv6 ND message is formatted
        as shown in <a href="#llaov6" class="xref">Figure 11</a>:<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<span id="name-omni-option-format"></span><div id="llaov6">
<figure id="figure-11">
          <div class="artwork art-text alignLeft" id="section-12.1-2.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |      Type     |     Length    |    Preflen    |  S/T-omIndex  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Sequence Number                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     Acknowledgment Number                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |S|A|R|O|P|     |                                               |
     |Y|C|S|P|N| Res |                   Window                      |
     |N|K|T|T|G|     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     ~                          Sub-Options                          ~
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-omni-option-format" class="selfRef">OMNI Option Format</a>
          </figcaption></figure>
</div>
<p id="section-12.1-3">In this format:<a href="#section-12.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-4.1">Type is set to TBD4.<a href="#section-12.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.2">Length is set to the number of 8 octet blocks in the option.
            The value 0 is invalid, while the values 1 through 255 (i.e., 8
            through 2040 octets, respectively) indicate the total length of
            the OMNI option.<a href="#section-12.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.3">Preflen is an 8 bit field that determines the length of prefix
            associated with an LLA. Values 0 through 128 specify a valid
            prefix length (all other values are invalid). For IPv6 ND messages
            sent from a Client to the MS, Preflen applies to the IPv6 source
            LLA and provides the length that the Client is requesting or
            asserting to the MS. For IPv6 ND messages sent from the MS to the
            Client, Preflen applies to the IPv6 destination LLA and indicates
            the length that the MS is granting to the Client. For IPv6 ND
            messages sent between MS endpoints, Preflen provides the length
            associated with the source/target Client MNP that is subject of
            the ND message.<a href="#section-12.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.4">S/T-omIndex is an 8 bit field that includes an omIndex value
            for the source or target underlying interface for this IPv6 ND
            message. Client OMNI interfaces MUST number each distinct
            underlying interface with an omIndex value between '1' and '255'
            that represents a Client-specific 8-bit mapping for the actual
            ifIndex value assigned by network management <span>[<a href="#RFC2863" class="xref">RFC2863</a>]</span>, then set S/T-omIndex to either a specific
            omIndex value or '0' to denote "unspecified". Proxy/Server OMNI
            interfaces use the omIndex value '0' to denote an INET underlying
            interface and/or to inform a peer Proxy/Server that a Client has
            departed.<a href="#section-12.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.5">The remaining header fields before "Sub-Options" are modeled
            from the Transmission Control Protocol (TCP) header specified in
            Section 3.1 of <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span> and include a 32 bit
            Sequence Number followed by a 32 bit Acknowledgement Number
            followed by 8 flags bits followed by a 24-bit Window. The (SYN,
            ACK, RST) flags are used for TCP-like window synchronization,
            while the TCP (URG, PSH, FIN) flags are not used and therefore
            omitted. The (OPT, PNG) flags are OMNI-specific, and the remaining
            flags are Reserved. Together, these fields support the asymmetric
            and symmetric OAL window synchronization services specified in
            <a href="#oal7.9" class="xref">Section 6.6</a>.<a href="#section-12.1-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.6">Sub-Options is a Variable-length field padded if necessary such
            that the complete OMNI Option is an integer multiple of 8 octets
            long. Sub-Options contains zero or more sub-options as specified
            in <a href="#sub-opt" class="xref">Section 12.2</a>.<a href="#section-12.1-4.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-12.1-5">The OMNI option is included in all OMNI interface IPv6 ND
        messages; the option is processed by receiving interfaces that
        recognize it and otherwise ignored. If multiple OMNI option instances
        appear in the same IPv6 ND message, only the first option includes the
        OMNI header fields before the Sub-Options while all others are coded
        as follows:<a href="#section-12.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-12.1-6">
<pre>      0                   1                   2
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     |     Type      |     Length    | Sub-Options ...
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><a href="#section-12.1-6" class="pilcrow">¶</a>
</div>
<p id="section-12.1-7">The OMNI interface processes all OMNI option instances
        received in the same IPv6 ND message in the consecutive order in which
        they appear. The OMNI option(s) included in each IPv6 ND message may
        include full or partial information for the neighbor. The OMNI
        interface therefore retains the union of the information in the most
        recently received OMNI options in the corresponding NCE.<a href="#section-12.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sub-opt">
<section id="section-12.2">
        <h3 id="name-omni-sub-options">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-omni-sub-options" class="section-name selfRef">OMNI Sub-Options</a>
        </h3>
<p id="section-12.2-1">Each OMNI option includes a Sub-Options block containing zero or
        more individual sub-options. Each consecutive sub-option is
        concatenated immediately following its predecessor. All sub-options
        except Pad1 (see below) are in type-length-value (TLV) format encoded
        as follows:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<span id="name-sub-option-format"></span><div id="sub-format">
<figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-12.2-2.1">
<pre>      0                   1                   2
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     | Sub-Type|      Sub-length     | Sub-Option Data ...
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-sub-option-format" class="selfRef">Sub-Option Format</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2-3.1">
            <p id="section-12.2-3.1.1">Sub-Type is a 5-bit field that encodes the Sub-Option type.
            Sub-options defined in this document are:<a href="#section-12.2-3.1.1" class="pilcrow">¶</a></p>
<div id="sub-types">
<figure id="figure-13">
              <div class="artwork art-text alignLeft" id="section-12.2-3.1.2.1">
<pre>     Sub-Option Name             Sub-Type
     Pad1                           0
     PadN                           1
     Multilink Fwding Parameters    2
     Interface Attributes           3
     Traffic Selector               4
     Geo Coordinates                5
     DHCPv6 Message                 6
     HIP Message                    7
     PIM-SM Message                 8
     Reassembly Limit               9
     Fragmentation Report          10
     Node Identification           11
     ICMPv6 Error                  12
     Sub-Type Extension            30
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a></figcaption></figure>
</div>
<p id="section-12.2-3.1.3">Sub-Types 13-29 are available for future assignment for
            major protocol functions. Sub-Type 31 is reserved by IANA.<a href="#section-12.2-3.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-3.2">Sub-Length is an 11-bit field that encodes the length of the
            Sub-Option Data in octets.<a href="#section-12.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-3.3">Sub-Option Data is a block of data with format determined by
            Sub-Type and length determined by Sub-Length.<a href="#section-12.2-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-12.2-4">The OMNI interface codes each sub-option with a 2 octet
        header that includes Sub-Type in the most significant 5 bits followed
        by Sub-Length in the next most significant 11 bits. Each sub-option
        encodes a maximum Sub-Length value of 2038 octets minus the lengths of
        the header and any preceding sub-options for this OMNI option. This
        allows ample Sub-Option Data space for coding large objects (e.g.,
        ASCII strings, domain names, protocol messages, security codes, etc.),
        while a single OMNI option is limited to 2040 octets the same as for
        any IPv6 ND option.<a href="#section-12.2-4" class="pilcrow">¶</a></p>
<p id="section-12.2-5">The OMNI interface codes initial sub-options in a first OMNI option
        instance and subsequent sub-options in additional instances in the
        same IPv6 ND message in the intended order of processing. The OMNI
        interface can then code any remaining sub-options in additional IPv6
        ND messages if necessary. Implementations must observe these size
        limits and refrain from sending IPv6 ND messages larger than the OMNI
        interface MTU.<a href="#section-12.2-5" class="pilcrow">¶</a></p>
<p id="section-12.2-6">The OMNI interface processes all OMNI option Sub-Options received
        in an IPv6 ND message while skipping over and ignoring any
        unrecognized sub-options. The OMNI interface processes the Sub-Options
        of all OMNI option instances in the consecutive order in which they
        appear in the IPv6 ND message, beginning with the first instance and
        continuing through any additional instances to the end of the message.
        If an individual sub-option length would cause processing to exceed
        the OMNI option instance and/or IPv6 ND message lengths, the OMNI
        interface accepts any sub-options already processed for that instance
        and ignores the final sub-option. The interface then processes any
        remaining OMNI option instances in the same fashion to the end of the
        IPv6 ND message.<a href="#section-12.2-6" class="pilcrow">¶</a></p>
<p id="section-12.2-7">When an OMNI interface includes an authentication sub-option (e.g.,
        see: <a href="#sub9" class="xref">Section 12.2.8</a>), it MUST appear as the first sub-option of
        the first OMNI option which must appear immediately following the IPv6
        ND message header. If the IPv6 ND message includes additional
        authentication sub-options, only the first sub-option is processed and
        all others are ignored.<a href="#section-12.2-7" class="pilcrow">¶</a></p>
<p id="section-12.2-8">When a Client OMNI interface prepares an RS or secured NS message,
        it includes a Multilink Forwarding Parameters sub-option specific to
        the underlying interface that will transmit the RS/NS (see: <a href="#sub4" class="xref">Section 12.2.3</a>) immediately following the authentication sub-option
        if present; otherwise as the first sub-option of the first OMNI option
        which must appear immediately following the IPv6 ND message
        header.<a href="#section-12.2-8" class="pilcrow">¶</a></p>
<p id="section-12.2-9">Note: large objects that exceed the maximum Sub-Option Data length
        are not supported under the current specification; if this proves to
        be limiting in practice, future specifications may define support for
        fragmenting large sub-options across multiple OMNI options within the
        same IPv6 ND message (or even across multiple IPv6 ND messages, if
        necessary).<a href="#section-12.2-9" class="pilcrow">¶</a></p>
<p id="section-12.2-10">The following sub-option types and formats are defined in this
        document:<a href="#section-12.2-10" class="pilcrow">¶</a></p>
<div id="sub0">
<section id="section-12.2.1">
          <h4 id="name-pad1">
<a href="#section-12.2.1" class="section-number selfRef">12.2.1. </a><a href="#name-pad1" class="section-name selfRef">Pad1</a>
          </h4>
<span id="name-pad1-2"></span><div id="pad0">
<figure id="figure-14">
            <div class="artwork art-text alignLeft" id="section-12.2.1-1.1">
<pre>      0
      0 1 2 3 4 5 6 7
     +-+-+-+-+-+-+-+-+
     | S-Type=0|x|x|x|
     +-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-pad1-2" class="selfRef">Pad1</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.1-2.1">Sub-Type is set to 0. If multiple instances appear in OMNI
              options of the same message all are processed.<a href="#section-12.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.1-2.2">Sub-Type is followed by 3 'x' bits, set to any value on
              transmission (typically all-zeros) and ignored on reception.
              Pad1 therefore consists of 1 octet with the most significant 5
              bits set to 0, and with no Sub-Length or Sub-Option Data fields
              following.<a href="#section-12.2.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-12.2.1-3">If more than one octet of padding is required, the PadN
          option, described next, should be used, rather than multiple Pad1
          options.<a href="#section-12.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sub1">
<section id="section-12.2.2">
          <h4 id="name-padn">
<a href="#section-12.2.2" class="section-number selfRef">12.2.2. </a><a href="#name-padn" class="section-name selfRef">PadN</a>
          </h4>
<span id="name-padn-2"></span><div id="padn">
<figure id="figure-15">
            <div class="artwork art-text alignLeft" id="section-12.2.2-1.1">
<pre>      0                   1                   2
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     | S-Type=1|    Sub-length=N     | N padding octets ...
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-padn-2" class="selfRef">PadN</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.2-2.1">Sub-Type is set to 1. If multiple instances appear in OMNI
              options of the same message all are processed.<a href="#section-12.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.2-2.2">Sub-Length is set to N that encodes the number of padding
              octets that follow.<a href="#section-12.2.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.2-2.3">Sub-Option Data consists of N octets, set to any value on
              transmission (typically all-zeros) and ignored on receipt.<a href="#section-12.2.2-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-12.2.2-3">When a proxy forwards an IPv6 ND message with OMNI options,
          it can employ PadN to cancel any sub-options (other than Pad1) that
          should not be processed by the next hop by simply writing the value
          '1' over the Sub-Type. When the proxy alters the IPv6 ND message
          contents in this way, any included authentication and integrity
          checks are invalidated but need not be re-calculated if
          authentication and integrity assurance will be applied by lower
          layers on the path to the next hop. See: <a href="#integrity" class="xref">Appendix B</a>
          for a discussion of IPv6 ND message authentication and
          integrity.<a href="#section-12.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sub4">
<section id="section-12.2.3">
          <h4 id="name-interface-attributes">
<a href="#section-12.2.3" class="section-number selfRef">12.2.3. </a><a href="#name-interface-attributes" class="section-name selfRef">Interface Attributes</a>
          </h4>
<p id="section-12.2.3-1">The Interface Attributes sub-option provides forwarding
          information for the multilink conceptual sending algorithm discussed
          in <a href="#concept" class="xref">Section 14</a>. The forwarding information is used for
          selecting among potentially multiple candidate underlying interfaces
          that can be used to forward carrier packets to the neighbor based on
          factors such as traffic selectors and link quality. Interface
          Attributes further includes link-layer address information to be
          used for either direct INET encapsulation for targets in the local
          SRT segment or spanning tree forwarding for targets in remote SRT
          segments.<a href="#section-12.2.3-1" class="pilcrow">¶</a></p>
<p id="section-12.2.3-2">Hub Proxy/Servers include Interface Attributes for all of a
          target Client's underlying interfaces in NA Address Resolution
          messages. Proxy/Servers also include Interface Attributes for all of
          a target Client's underlying interfaces in uNA messages used to
          publish Client information changes (see: <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span> for more information). When the
          node that sent the NS message receives the NA, it can use all of the
          included Interface Attributes and/or Traffic Selectors to formulate
          a map of the prospective target node as well as to seed the
          information to be populated in a Multilink Forwarding Parameters
          sub-option.<a href="#section-12.2.3-2" class="pilcrow">¶</a></p>
<p id="section-12.2.3-3">Interface Attributes must be honored by all implementations in
          the format shown below:<a href="#section-12.2.3-3" class="pilcrow">¶</a></p>
<span id="name-interface-attributes-2"></span><div id="ifIndex-tuple2">
<figure id="figure-16">
            <div class="artwork art-text alignLeft" id="section-12.2.3-4.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | S-Type=2|    Sub-length=N     |    omIndex    |     omType    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Provider ID  | Link  | Resvd | FMT |   SRT   |     LHS (0)   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     LHS (1-3)                 |               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               ~
     ~                                                               ~
     ~                   Link Layer Address (L2ADDR)                 ~
     ~                                                               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-interface-attributes-2" class="selfRef">Interface Attributes</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.3-5.1">Sub-Type is set to 2. NA messages used for Address Resolution
              and uNA messages include Interface Attributes for all of the
              target Client's underlying interfaces. If the IPv6 ND message
              includes multiple Interface Attributes instances with the same
              omIndex value (whether in the same OMNI option or additional
              OMNI options), only the first instance is processed and all
              others are ignored.<a href="#section-12.2.3-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.3-5.2">Sub-Length is set to N that encodes the number of Sub-Option
              Data octets that follow.<a href="#section-12.2.3-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.3-5.3">
              <p id="section-12.2.3-5.3.1">Sub-Option Data contains an "Interface Attributes" option
              encoded as follows:<a href="#section-12.2.3-5.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.3-5.3.2.1">omIndex is a 1-octet value corresponding to a specific
                  underlying interface the same as specified above for the
                  OMNI option S/T-omIndex field. The OMNI options of a single
                  message may include multiple Interface Attributes
                  sub-options, with each distinct omIndex value pertaining to
                  a different underlying interface.<a href="#section-12.2.3-5.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.3-5.3.2.2">omType is set to an 8-bit integer value corresponding to
                  the underlying interface identified by omIndex. The value
                  represents an OMNI interface-specific 8-bit mapping for the
                  actual IANA ifType value registered in the 'IANAifType-MIB'
                  registry [http://www.iana.org].<a href="#section-12.2.3-5.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.3-5.3.2.3">Provider ID is set to an OMNI interface-specific 8-bit ID
                  value for the network service provider associated with this
                  omIndex.<a href="#section-12.2.3-5.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.3-5.3.2.4">Link encodes a 4-bit link metric. The value '0' means the
                  link is DOWN, and the remaining values mean the link is UP
                  with metric ranging from '1' ("lowest") to '15'
                  ("highest").<a href="#section-12.2.3-5.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.3-5.3.2.5">Resvd is 4-bit field reserved for future use, set to 0 on
                  transmit and ignored on receipt.<a href="#section-12.2.3-5.3.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.3-5.3.2.6">
                  <p id="section-12.2.3-5.3.2.6.1">FMT - a 3-bit "Forward/Mode/Type" code interpreted as
                  follows:<a href="#section-12.2.3-5.3.2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.3-5.3.2.6.2.1">When the most significant bit (i.e., "FMT-Forward")
                      is clear, the LHS Proxy/Server performs OAL reassembly
                      and decapsulation to obtain the original IP packet
                      before forwarding. If the FMT-Mode bit is clear, the LHS
                      Proxy/Server then forwards the original IP packet at
                      layer 3; otherwise, it invokes the OAL to
                      re-encapsulate, re-fragment and forwards the resulting
                      carrier packets to the Client via the selected
                      underlying interface. When FMT-Forward is set, the LHS
                      Proxy/Server forwards unsecured OAL fragments to the
                      Client without reassembling, while reassembling secured
                      OAL fragments before re-fragmenting and forwarding to
                      the Client. If FMT-Mode is clear, all carrier packets
                      destined to the Client must always be forwarded through
                      the Proxy/Server; otherwise the Client is eligible for
                      direct forwarding over the open INET where it may be
                      located behind one or more NATs.<a href="#section-12.2.3-5.3.2.6.2.1" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-12.2.3-5.3.2.6.2.2">The next most significant bit (i.e., "FMT-Mode") is
                      interpreted in conjunction with the FMT-Forward bit, as
                      discussed above.<a href="#section-12.2.3-5.3.2.6.2.2" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-12.2.3-5.3.2.6.2.3">The least significant bit (i.e., "FMT-Type")
                      determines the IP address version encoded in L2ADDR. If
                      FMT-Type is clear, L2ADDR includes a 4-octet IPv4
                      address. If FMT-Type is set, L2ADDR includes a 16-octet
                      IPv6 address.<a href="#section-12.2.3-5.3.2.6.2.3" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-12.2.3-5.3.2.7">SRT - a 5-bit Segment Routing Topology prefix length
                  value that (when added to 96) determines the prefix length
                  to apply to the ULA formed from concatenating [ULA*]::/96
                  with the 32 bit LHS MSID value that follows. For example,
                  the value 16 corresponds to the prefix length 112.<a href="#section-12.2.3-5.3.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.3-5.3.2.8">LHS - the 32 bit MSID of the LHS Proxy/Server on the path
                  to the target. When SRT and LHS are both set to 0, the LHS
                  Proxy/Server is considered unspecified in this IPv6 ND
                  message. SRT and LHS together provide guidance for the OMNI
                  interface forwarding algorithm. Specifically, if SRT/LHS is
                  located in the local OMNI link segment then the target
                  Client can be reached either through its dependent LHS
                  Proxy/Server or directly following NAT traversal conversion.
                  Otherwise, the target Client is located on a different SRT
                  segment and must be reached via the spanning tree. See <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span> for further discussion.<a href="#section-12.2.3-5.3.2.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.3-5.3.2.9">Link Layer Address (L2ADDR) - identifies the link-layer
                  address (i.e., the encapsulation address) of the
                  source/target according to FMT. The first 2 octets encodes a
                  UDP port number, and an IP address appears in the next 4
                  octets for IPv4 or 16 octets for IPv6. The UDP port number
                  and IP address are recorded in network byte order, and in
                  ones-compliment "obfuscated" form per <span>[<a href="#RFC4380" class="xref">RFC4380</a>]</span>.<a href="#section-12.2.3-5.3.2.9" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="sub15">
<section id="section-12.2.4">
          <h4 id="name-multilink-forwarding-parame">
<a href="#section-12.2.4" class="section-number selfRef">12.2.4. </a><a href="#name-multilink-forwarding-parame" class="section-name selfRef">Multilink Forwarding Parameters</a>
          </h4>
<p id="section-12.2.4-1">OMNI nodes include the Multilink Forwarding Parameters sub-option
          in NS/NA messages used to coordinate with multilink route
          optimization targets, or in RS/RA messages used to coordinate with
          (remote) Proxy/Servers. If a solicitation message includes the
          sub-option, the solicited advertisement response must also include
          the sub-option. The OMNI node MUST include the sub-option in the
          first OMNI option immediately following the HIP message sub-option
          and/or a single Pad1/PadN if present. Otherwise, the OMNI node MUST
          include the sub-option immediately following the OMNI header.<a href="#section-12.2.4-1" class="pilcrow">¶</a></p>
<p id="section-12.2.4-2">The Multilink Forwarding Parameters sub-option includes the
          necessary state for establishing Multilink Forwarding Vectors (MFVs)
          in the Multilink Forwarding Information Bases (MFIBs) of the OAL
          source, destination and intermediate nodes in the path. The
          sub-option also records addressing information for FHS/LHS nodes on
          the path, including "INADDRs" which MUST be unicast IP encapsulation
          addresses (i.e, and not anycast/multicast). The manner for
          populating multilink forwarding information is specified in detail
          in <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>.<a href="#section-12.2.4-2" class="pilcrow">¶</a></p>
<p id="section-12.2.4-3">The Multilink Forwarding Parameters sub-option is formatted as
          shown in <a href="#mfwd" class="xref">Figure 17</a>:<a href="#section-12.2.4-3" class="pilcrow">¶</a></p>
<span id="name-multilink-forwarding-paramet"></span><div id="mfwd">
<figure id="figure-17">
            <div class="artwork art-text alignLeft" id="section-12.2.4-4.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | S-Type=3|    Sub-length=N     |FHS Cli omIndex|     omType    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Provider ID  | Link  | Resvd | FMT |   SRT   |               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               ~
     ~                  FHS Client UDP Port/INADDR                   ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                 FHS Proxy/Server MSID/INADDR                  ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                    FHS Bridge MSID/INADDR                     ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |LHS Cli omIndex|     omType    |  Provider ID  | Link  | Resvd |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | FMT |   SRT   |                                               ~
     +-+-+-+-+-+-+-+-+                                               ~
     ~                  LHS Client UDP Port/INADDR                   ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                 LHS Proxy/Server MSID/INADDR                  ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                     LHS Bridge MSID/INADDR                    ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~           Tunnel Window Synchronization Parameters            ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                                                               ~
     ~        Multilink Forwarding Vector Index (MFVI) List          ~
     ~               (5 consecutive 4-octet MFVIs)                   ~
     ~                                                               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  A  |  B  |Job|
     +-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-multilink-forwarding-paramet" class="selfRef">Multilink Forwarding Parameters</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.4-5.1">Sub-Type is set to 3. If multiple instances appear in the
              same message (i.e., whether in a single OMNI option or multiple)
              the first instance is processed and all others are ignored.<a href="#section-12.2.4-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.4-5.2">Sub-Length is set to N that encodes the number of Sub-Option
              Data octets that follow.<a href="#section-12.2.4-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.4-5.3">
              <p id="section-12.2.4-5.3.1">Sub-Option Data contains Multilink Forwarding Parameters as
              follows:<a href="#section-12.2.4-5.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.4-5.3.2.1">FHS Client omIndex, omType, Provider ID and Link/Reserved
                  are fields (at offset 0 from the beginning of the Sub-Option
                  Data) that include link parameters for the FHS Client
                  underlying interface. (This is the same information that
                  would appear in an Interface Attributes sub-option.)<a href="#section-12.2.4-5.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.2">(FHS) FMT/SRT is a 1-octet field that applies to the FHS
                  information. The SRT prefix length information applies to
                  all FHS elements since all are by definition in the same SRT
                  segment. The FMT-Forward/Mode bits determine the
                  characteristics of the FHS Proxy/Server relationship for
                  this specific FHS Client underlying interface (i.e., the
                  same as described in <a href="#sub4" class="xref">Section 12.2.3</a>), and the
                  FMT-Type bits determine the IP address version for all
                  INADDR fields relative to this SRT segment. Unlike the case
                  for Interface Attributes, all INADDR fields are always 16
                  bits in length regardless of the IP protocol version (for
                  IPv4, INADDR is encoded as an IPv4-mapped IPv6 address <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span>). The IP address (as well as UDP port
                  number when present) is recoded in network byte order, and
                  in ones-compliment "obfuscated" form the same as described
                  in <a href="#sub4" class="xref">Section 12.2.3</a>.<a href="#section-12.2.4-5.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.3">FHS Client UDP Port/INADDR includes the *NET
                  encapsulation 2-octet UDP port number followed by the
                  16-octet INADDR observed by the FHS Proxy/Server when it
                  processes an IPv6 ND solicitation message sent by the FHS
                  Client containing this option. When an FHS Client RS message
                  includes a non-zero UDP Port and INADDR, the FHS
                  Proxy/Server that receives the RS should compare the
                  UDP/INADDR values with the actual *NET encapsulation
                  addresses; if the addresses differ the presence of a NAT is
                  indicated.<a href="#section-12.2.4-5.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.4">FHS Proxy/Server MSID/INADDR includes a 4-octet FHS
                  Proxy/Server MSID followed by a 16 octet INADDR the same as
                  above. INADDR identifies an open INET interface not located
                  behind NATs, therefore no UDP port number is included since
                  port number 8060 is used when the *NET encapsulation
                  includes a UDP header.<a href="#section-12.2.4-5.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.5">FHS Bridge MSID/INADDR encodes a 4 octet MSID followed by
                  a 16-octet INADDR exactly as for the FHS Proxy/Server
                  MSID/INADDR.<a href="#section-12.2.4-5.3.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.6">LHS Client omIndex, omType, Provider ID, Link/Reserved,
                  FMT/SRT, Client UDP/INADDR, Proxy/Server MSID/INADDR and
                  Bridge MSID/INADDR are coded exactly the same as for their
                  FHS counterparts above except that they provide information
                  for LHS elements.<a href="#section-12.2.4-5.3.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.7">Tunnel Window Synchronization Parameters is a 12-octet
                  block that consists of a 4-octet Sequence Number followed by
                  a 4-octet Acknowledgement Number followed by a 1-octet Flags
                  field followed by a 3-octet Window field (i.e., the same as
                  for the OMNI header parameters). End systems can therefore
                  use the OMNI header parameters for end-to-end window
                  synchronization while tunnel endpoints use the tunnel
                  parameters for simultaneous middlebox window synchronization
                  in a single NS/NA message exchange. The Tunnel Window
                  Synchronization Parameters block offset is 33 octets before
                  the end of the Sub-Option Data.<a href="#section-12.2.4-5.3.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.8">Multilink Forwarding Vector Index (MFVI) List is a list
                  of at most 5 consecutive 4-octet MFVIs. The FHS/LHS source
                  and each intermediate node on the path to the destination
                  processes the list according to the A, B and Job codes (see
                  below).<a href="#section-12.2.4-5.3.2.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.9">A is a 3-bit count of the number of "A" MVFI List entries
                  (valid values are 0-5).<a href="#section-12.2.4-5.3.2.9" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.10">B is a 3-bit count of the number of "B" MVFI List entries
                  (valid values are 0-5).<a href="#section-12.2.4-5.3.2.10" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.4-5.3.2.11">
                  <p id="section-12.2.4-5.3.2.11.1">Job is a 2-bit code that determines the manner in which
                  each node in the path processes the MVFI List as
                  follows:<a href="#section-12.2.4-5.3.2.11.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.4-5.3.2.11.2.1">00 - "Initialize; Build B" - the FHS source sets this
                      code in a solicitation used to initialize MFV state (any
                      other messages that include this code MUST be dropped).
                      The FHS source first sets A/B to 0, and the FHS source
                      and each intermediate node along the path to the LHS
                      destination that processes the message creates a new
                      MFV. Each node that processes the message then assigns a
                      unique 4-octet "B" MFVI to the MVF and also writes the
                      value into list entry B, then increments B. When the
                      message arrives at the LHS destination, B will contain
                      the number of MFVI List "B" entries, with the FHS source
                      entry first, followed by entries for each consecutive
                      intermediate node and ending with an entry for the final
                      intermediate node (i.e., the list is populated in the
                      forward direction).<a href="#section-12.2.4-5.3.2.11.2.1" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-12.2.4-5.3.2.11.2.2">01 - "Follow B; Build A" - the LHS source sets this
                      code in a solicited advertisement response to a
                      solicitation with code "00" (any other messages that
                      include this code MUST be dropped). The LHS source first
                      copies the MFVI List and B value from the code "00"
                      solicitation into these fields and sets A to 0. The LHS
                      source and each intermediate node along the path to the
                      FHS destination that processes the message then uses
                      MFVI List entry B to locate the corresponding MFV. Each
                      node that processes the message then assigns a unique
                      4-octet "A" MFVI to the MVF and also writes the value
                      into list entry B, then increments A and decrements B.
                      When the message arrives at the FHS destination, A will
                      contain the number of MFVI List "A" entries, with the
                      LHS source entry last, preceded by entries for each
                      consecutive intermediate node and beginning with an
                      entry for the final intermediate node (i.e., the list is
                      populated in the reverse direction).<a href="#section-12.2.4-5.3.2.11.2.2" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-12.2.4-5.3.2.11.2.3">10 - "Follow A; Record B" - the FHS node that sent
                      the original code "00" solicitation and received the
                      corresponding code "01" advertisement sets this code in
                      any subsequent solicitations/advertisements sent to the
                      same LHS destination. The FHS source copies the MVFI
                      List and A value from the code "01" advertisement into
                      these fields and sets B to 0. The FHS source and each
                      intermediate node along the path to the LHS destination
                      that processes the message then uses the "A" MFVI found
                      at list entry B to locate the corresponding MFV. Each
                      node that processes the message then writes the MVF's
                      "B" MFVI into list entry B, then decrements A and
                      increments B. When the message arrives at the LHS
                      destination, B will contain the number of MFVI List "B"
                      entries populated in the forward direction.<a href="#section-12.2.4-5.3.2.11.2.3" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-12.2.4-5.3.2.11.2.4">11 - "Follow B; Record A" - the LHS node that
                      received the original code "00" solicitation and sent
                      the corresponding code "01" advertisement sets this code
                      in any subsequent solicitations/advertisements sent to
                      the same FHS destination. The LHS source copies the MVFI
                      List and B values from the code "00" solicitation into
                      these fields and sets A to 0. The LHS source and each
                      intermediate node along the path to the FHS destination
                      that processes the message then uses the "B" MFVI List
                      entry found at list entry B to locate the corresponding
                      MFV. Each node that processes the message then writes
                      the MFV's "A" MFVI into list entry B, then increments A
                      and decrements B. When the message arrives at the FHS
                      destination, A will contain the number of MFVI List "A"
                      entries populated in the reverse direction.<a href="#section-12.2.4-5.3.2.11.2.4" class="pilcrow">¶</a>
</li>
                  </ul>
<p id="section-12.2.4-5.3.2.11.3">A, B and Job determine the per-hop behavior at each
                  FHS/LHS source, intermediate node and destination that
                  processes an IPv6 ND message. When a Job code specifies
                  "Initialize", each FHS/LHS node that processes the message
                  creates a new MVF. When a Job code specifies "Build", each
                  node that processes the message assigns a new MFVI. When a
                  Job code specifies "Follow", each node that processes the
                  message uses an A/B MFVI List entry to locate an MFV (if the
                  MFV cannot be located, the node returns a parameter problem
                  and drops the message). Using this algorithm, FHS sources
                  that send code "00" solicitations and receive code "01
                  advertisements discover only "A" information, while LHS
                  sources that receive code "00" solicitations and return code
                  "01" advertisements discover only "B" information. FHS/LHS
                  intermediate nodes can instead examine A, B and the MFVI
                  List to determine the number of previous hops, the number of
                  remaining hops, and the A/B MFVIs associated with the
                  previous/remaining hops. However, no intermediate nodes will
                  discover inappropriate A/B MFVIs for their location in the
                  multihop forwarding chain. See: <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span> for further discussion on
                  A/B MFVI processing.<a href="#section-12.2.4-5.3.2.11.3" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="sub4.1">
<section id="section-12.2.5">
          <h4 id="name-traffic-selector">
<a href="#section-12.2.5" class="section-number selfRef">12.2.5. </a><a href="#name-traffic-selector" class="section-name selfRef">Traffic Selector</a>
          </h4>
<p id="section-12.2.5-1">When used in conjunction with Interface Attributes and/or
          Multilink Forwarding Parameters information, the Traffic Selector
          sub-option provides forwarding information for the multilink
          conceptual sending algorithm discussed in <a href="#concept" class="xref">Section 14</a>.<a href="#section-12.2.5-1" class="pilcrow">¶</a></p>
<p id="section-12.2.5-2">Clients include Traffic Selector sub-options specific to the
          omIndexes of underlying interfaces serviced by the same FHS/Hub
          Proxy/Servers. Prospective peer Clients that receive the Traffic
          Selectors in NA messages can then use them to drive the multilink
          forwarding algorithm.<a href="#section-12.2.5-2" class="pilcrow">¶</a></p>
<p id="section-12.2.5-3">Proxy/Servers include Traffic Selectors for all of a target
          Client's underlying interfaces in NA Address Resolution messages.
          Proxy/Servers also include Traffic Selectors for all of a target
          Client's underlying interfaces in uNA messages used to publish
          Client information changes. See: <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span> for more information.<a href="#section-12.2.5-3" class="pilcrow">¶</a></p>
<p id="section-12.2.5-4">Traffic Selectors must be honored by all implementations in the
          format shown below:<a href="#section-12.2.5-4" class="pilcrow">¶</a></p>
<span id="name-traffic-selector-2"></span><div id="traffic-select">
<figure id="figure-18">
            <div class="artwork art-text alignLeft" id="section-12.2.5-5.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | S-Type=4|    Sub-length=N     |    omIndex    |   TS Format   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                                                               ~
     ~                RFC 6088 Format Traffic Selector               ~
     ~                                                               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-traffic-selector-2" class="selfRef">Traffic Selector</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.5-6.1">Sub-Type is set to 4. Each IPv6 ND message may contain zero
              or more Traffic Selectors for each omIndex; when multiple
              Traffic Selectors for the same omIndex appear, all are processed
              and the cumulative information from all is retained.<a href="#section-12.2.5-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.5-6.2">Sub-Length is set to N that encodes the number of Sub-Option
              Data octets that follow.<a href="#section-12.2.5-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.5-6.3">
              <p id="section-12.2.5-6.3.1">Sub-Option Data contains a "Traffic Selector" encoded as
              follows:<a href="#section-12.2.5-6.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.5-6.3.2.1">omIndex is a 1-octet value corresponding to a specific
                  underlying interface the same as specified above for the
                  OMNI option S/T-omIndex field. The OMNI options of a single
                  message may include multiple Traffic Selector sub-options,
                  with each distinct omIndex value pertaining to a different
                  underlying interface.<a href="#section-12.2.5-6.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.5-6.3.2.2">TS Format is a 1-octet field that encodes a Traffic
                  Selector version per <span>[<a href="#RFC6088" class="xref">RFC6088</a>]</span> when T is 1.
                  If TS Format encodes the value 1 or 2, the Traffic Selector
                  includes IPv4 or IPv6 information, respectively. If TS
                  Format encodes the value 0, the Traffic Selector field is
                  omitted.<a href="#section-12.2.5-6.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.5-6.3.2.3">When TS Format is non-zero, the remainder of the
                  sub-option includes a traffic selector formatted per <span>[<a href="#RFC6088" class="xref">RFC6088</a>]</span> beginning with the "Flags (A-N)" field,
                  and with the Traffic Selector IP protocol version coded in
                  the TS Format field. If a single interface identified by
                  omIndex requires Traffic Selectors for multiple IP protocol
                  versions, or if a Traffic Selector block would exceed the
                  space available in a single Interface Attributes sub-option,
                  the remaining information is coded in additional Traffic
                  Selector sub-options that all encode the same omIndex.<a href="#section-12.2.5-6.3.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="sub7">
<section id="section-12.2.6">
          <h4 id="name-geo-coordinates">
<a href="#section-12.2.6" class="section-number selfRef">12.2.6. </a><a href="#name-geo-coordinates" class="section-name selfRef">Geo Coordinates</a>
          </h4>
<span id="name-geo-coordinates-sub-option"></span><div id="geo-opt">
<figure id="figure-19">
            <div class="artwork art-text alignLeft" id="section-12.2.6-1.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | S-Type=5|    Sub-length=N     |    Geo Type   |Geo Coordinates
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ...
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-geo-coordinates-sub-option" class="selfRef">Geo Coordinates Sub-option</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.6-2.1">Sub-Type is set to 5. If multiple instances appear in OMNI
              options of the same message all are processed.<a href="#section-12.2.6-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.6-2.2">Sub-Length is set to N that encodes the number of Sub-Option
              Data octets that follow.<a href="#section-12.2.6-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.6-2.3">
              <p id="section-12.2.6-2.3.1">Geo Type is a 1 octet field that encodes a type designator
              that determines the format and contents of the Geo Coordinates
              field that follows. The following types are currently
              defined:<a href="#section-12.2.6-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.6-2.3.2.1">0 - NULL, i.e., the Geo Coordinates field is
                  zero-length.<a href="#section-12.2.6-2.3.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-12.2.6-2.4">A set of Geo Coordinates of length up to the remaining
              available space for this OMNI option. New formats to be
              specified in future documents and may include attributes such as
              latitude/longitude, altitude, heading, speed, etc.<a href="#section-12.2.6-2.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="sub8">
<section id="section-12.2.7">
          <h4 id="name-dynamic-host-configuration-">
<a href="#section-12.2.7" class="section-number selfRef">12.2.7. </a><a href="#name-dynamic-host-configuration-" class="section-name selfRef">Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Message</a>
          </h4>
<p id="section-12.2.7-1">The Dynamic Host Configuration Protocol for IPv6 (DHCPv6)
          sub-option may be included in the OMNI options of Client RS messages
          and Proxy/Server RA messages. FHS Proxy/Servers that forward RS/RA
          messages between a Client and an LHS Proxy/Server also forward
          DHCPv6 Sub-Options unchanged. Note that DHCPv6 messages do not
          include a Checksum field since integrity is protected by the IPv6 ND
          message checksum, authentication signature and/or lower-layer
          authentication and integrity checks.<a href="#section-12.2.7-1" class="pilcrow">¶</a></p>
<span id="name-dhcpv6-message-sub-option"></span><div id="d-dhcpv6">
<figure id="figure-20">
            <div class="artwork art-text alignLeft" id="section-12.2.7-2.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | S-Type=6|    Sub-length=N     |    msg-type   |  id (octet 0) |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   transaction-id (octets 1-2) |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     .                        DHCPv6 options                         .
     .                 (variable number and length)                  .
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-dhcpv6-message-sub-option" class="selfRef">DHCPv6 Message Sub-option</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.7-3.1">Sub-Type is set to 6. If multiple instances appear in OMNI
              options of the same message the first is processed and all
              others are ignored.<a href="#section-12.2.7-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.7-3.2">Sub-Length is set to N that encodes the number of Sub-Option
              Data octets that follow. The 'msg-type' and 'transaction-id'
              fields are always present; hence, the length of the DHCPv6
              options is limited by the remaining available space for this
              OMNI option.<a href="#section-12.2.7-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.7-3.3">'msg-type' and 'transaction-id' are coded according to
              Section 8 of <span>[<a href="#RFC8415" class="xref">RFC8415</a>]</span>.<a href="#section-12.2.7-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.7-3.4">A set of DHCPv6 options coded according to Section 21 of
              <span>[<a href="#RFC8415" class="xref">RFC8415</a>]</span> follows.<a href="#section-12.2.7-3.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="sub9">
<section id="section-12.2.8">
          <h4 id="name-host-identity-protocol-hip-">
<a href="#section-12.2.8" class="section-number selfRef">12.2.8. </a><a href="#name-host-identity-protocol-hip-" class="section-name selfRef">Host Identity Protocol (HIP) Message</a>
          </h4>
<p id="section-12.2.8-1">The Host Identity Protocol (HIP) Message sub-option should be
          included in OMNI options to provide authentication for IPv6 ND
          messages exchanged between Clients and FHS Proxy/Servers over an
          open Internetwork. FHS Proxy/Servers authenticate the HIP
          authentication signatures in source Client IPv6 ND messages before
          securely forwarding them to other OMNI nodes. LHS Proxy/Servers that
          receive secured IPv6 ND messages from other OMNI nodes insert HIP
          authentication signatures before forwarding them to the target
          Client.<a href="#section-12.2.8-1" class="pilcrow">¶</a></p>
<p id="section-12.2.8-2">OMNI interfaces MUST include the HIP message as the first
          sub-option of the first OMNI option, which MUST appear immediately
          following the IPv6 ND message header. OMNI interfaces can therefore
          easily locate the HIP message and verify the authentication
          signature without applying deep inspection. OMNI interfaces that
          receive IPv6 ND messages over unsecured paths without a HIP message
          (or other authentication sub-option) instead verify the IPv6 ND
          message checksum.<a href="#section-12.2.8-2" class="pilcrow">¶</a></p>
<p id="section-12.2.8-3">OMNI interfaces include the HIP message sub-option when they
          forward IPv6 ND messages that require security over INET underlying
          interfaces, i.e., where authentication and integrity is not already
          assured by lower layers. OMNI interfaces that process secured IPv6
          ND messages verify the signature then either process the rest of the
          message locally or forward a proxyed copy to the next hop.<a href="#section-12.2.8-3" class="pilcrow">¶</a></p>
<p id="section-12.2.8-4">When a FHS Client inserts a HIP message sub-option in an NS/NA
          message destined to a target in a remote spanning tree segment, it
          must ensure that the insertion does not cause the message to exceed
          the path MPS. When the remote segment LHS Proxy/Server forwards the
          NS/NA message from the spanning tree to the target Client, it
          inserts a new HIP message sub-option if necessary while overwriting
          or cancelling the (now defunct) HIP message sub-option supplied by
          the FHS Client.<a href="#section-12.2.8-4" class="pilcrow">¶</a></p>
<p id="section-12.2.8-5">If the defunct HIP sub-option size was smaller than the space
          needed for the LHS Client HIP message (or, if no defunct HIP
          sub-option is present), the LHS Proxy/Server adjusts the space
          immediately following the OMNI header by copying the preceding
          portion of the IPv6 ND message into buffer headroom free space or
          copying the remainder of the IPv6 ND message into buffer tailroom
          free space. The LHS Proxy/Server then insets the new HIP sub-option
          immediately after the OMNI header and immediately before the next
          sub-option while properly overwriting the defunct sub-option if
          present.<a href="#section-12.2.8-5" class="pilcrow">¶</a></p>
<p id="section-12.2.8-6">If the defunct HIP sub-option size was larger than the space
          needed for the LHS Client HIP message, the LHS Proxy/Server instead
          overwrites the existing sub-option and writes a single Pad1 or PadN
          sub-option over the next 1-2 octets to cancel the remainder of the
          defunct sub-option. If the LHS Proxy/Server cannot create sufficient
          space through any means without causing the OMNI option to exceed
          2040 bytes or causing the IPv6 ND message to exceed the OMNI
          interface MTU, it returns a suitable error (see: <a href="#sub14" class="xref">Section 12.2.13</a>) and drops the message.<a href="#section-12.2.8-6" class="pilcrow">¶</a></p>
<p id="section-12.2.8-7">The HIP message sub-option is formatted as shown below:<a href="#section-12.2.8-7" class="pilcrow">¶</a></p>
<span id="name-hip-message-sub-option"></span><div id="hip-opt">
<figure id="figure-21">
            <div class="artwork art-text alignLeft" id="section-12.2.8-8.1">
<pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | S-Type=7|    Sub-length=N     |0| Packet Type |Version| RES.|1|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |           Reserved            |           Controls            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                Sender's Host Identity Tag (HIT)               |
     |                                                               |
     |                                                               |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               Receiver's Host Identity Tag (HIT)              |
     |                                                               |
     |                                                               |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     /                        HIP Parameters                         /
     /                                                               /
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-hip-message-sub-option" class="selfRef">HIP Message Sub-option</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.8-9.1">Sub-Type is set to 7. If multiple instances appear in OMNI
              options of the same message the first is processed and all
              others are ignored.<a href="#section-12.2.8-9.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.8-9.2">Sub-Length is set to N, i.e., the length of the option in
              octets beginning immediately following the Sub-Length field and
              extending to the end of the HIP parameters. The length of the
              entire HIP message is therefore limited by the remaining
              available space for this OMNI option.<a href="#section-12.2.8-9.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.8-9.3">The HIP message is coded per Section 5 of <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span>, except that the OMNI "Sub-Type" and
              "Sub-Length" fields replace the first 2 octets of the HIP
              message header (i.e., the Next Header and Header Length fields).
              Also, since the IPv6 ND message is already protected by the
              authentication signature and/or lower-layer authentication and
              integrity checks, the HIP message Checksum field is replaced by
              a Reserved field set to 0 on transmission and ignored on
              reception.<a href="#section-12.2.8-9.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-12.2.8-10">Note: In some environments, maintenance of a Host Identity
          Tag (HIT) namespace may be unnecessary for securely associating an
          OMNI node with an IPv6 address-based identity. In that case, other
          types of IPv6 addresses (e.g., a Client's MNP-LLA, a Proxy/Server's
          ADM-LLA, etc.) can be used instead of HITs in the authentication
          signature as long as the address can be uniquely associated with the
          Sender/Receiver.<a href="#section-12.2.8-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sub93">
<section id="section-12.2.9">
          <h4 id="name-pim-sm-message">
<a href="#section-12.2.9" class="section-number selfRef">12.2.9. </a><a href="#name-pim-sm-message" class="section-name selfRef">PIM-SM Message</a>
          </h4>
<p id="section-12.2.9-1">The Protocol Independent Multicast - Sparse Mode (PIM-SM) Message
          sub-option may be included in the OMNI options of IPv6 ND messages.
          PIM-SM messages are formatted as specified in Section 4.9 of <span>[<a href="#RFC7761" class="xref">RFC7761</a>]</span>, with the exception that the Checksum field is
          replaced by a Reserved field (set to 0) since the IPv6 ND message is
          already protected by the IPv6 ND message checksum, authentication
          signature and/or lower-layer authentication and integrity checks.
          The PIM-SM message sub-option format is shown in <a href="#pim-opt" class="xref">Figure 22</a>:<a href="#section-12.2.9-1" class="pilcrow">¶</a></p>
<span id="name-pim-sm-message-option-forma"></span><div id="pim-opt">
<figure id="figure-22">
            <div class="artwork art-text alignLeft" id="section-12.2.9-2.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | S-Type=8|    Sub-length=N     |PIM Ver| Type  |   Reserved    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     /                         PIM-SM Message                        /
     /                                                               /
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-pim-sm-message-option-forma" class="selfRef">PIM-SM Message Option Format</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.9-3.1">Sub-Type is set to 8. If multiple instances appear in OMNI
              options of the same message all are processed.<a href="#section-12.2.9-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.9-3.2">Sub-Length is set to N, i.e., the length of the option in
              octets beginning immediately following the Sub-Length field and
              extending to the end of the PIM-SM message. The length of the
              entire PIM-SM message is therefore limited by the remaining
              available space for this OMNI option.<a href="#section-12.2.9-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.9-3.3">The PIM-SM message is coded exactly as specified in Section
              4.9 of <span>[<a href="#RFC7761" class="xref">RFC7761</a>]</span>, except that the Checksum field
              is replaced by a Reserved field set to 0 on transmission and
              ignored on reception. The "PIM Ver" field MUST encode the value
              2, and the "Type" field encodes the PIM message type. (See
              Section 4.9 of <span>[<a href="#RFC7761" class="xref">RFC7761</a>]</span> for a list of PIM-SM
              message types and formats.)<a href="#section-12.2.9-3.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="sub7.8">
<section id="section-12.2.10">
          <h4 id="name-reassembly-limit">
<a href="#section-12.2.10" class="section-number selfRef">12.2.10. </a><a href="#name-reassembly-limit" class="section-name selfRef">Reassembly Limit</a>
          </h4>
<p id="section-12.2.10-1">The Reassembly Limit sub-option may be included in the OMNI
          options of IPv6 ND messages. The message consists of a 15-bit
          Reassembly Limit value, followed by a flag bit (H) optionally
          followed by an (N-2)-octet leading portion of an OAL First Fragment
          that triggered the message.<a href="#section-12.2.10-1" class="pilcrow">¶</a></p>
<span id="name-reassembly-limit-2"></span><div id="mru-opt">
<figure id="figure-23">
            <div class="artwork art-text alignLeft" id="section-12.2.10-2.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | S-Type=9|    Sub-length=N     |      Reassembly Limit       |H|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          OAL First Fragment (As much of invoking packet       |
     +         as possible without causing the IPv6 ND message       +
     |                to exceed the minimum IPv6 MTU)                |
     +                                                               +
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-reassembly-limit-2" class="selfRef">Reassembly Limit</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.10-3.1">Sub-Type is set to 9. If multiple instances appear in OMNI
              options of the same message the first occurring "hard" and
              "soft" Reassembly Limit values are accepted, and any additional
              Reassembly Limit values are ignored.<a href="#section-12.2.10-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.10-3.2">Sub-Length is set to 2 if no OAL First Fragment is included,
              or to a value N greater than 2 if an OAL First Fragment is
              included.<a href="#section-12.2.10-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.10-3.3">A 15-bit Reassembly Limit follows, and includes a value
              between 1500 and 9180. If any other value is included, the
              sub-option is ignored. The value indicates the hard or soft
              limit for original IP packets that the source of the message is
              currently willing to reassemble; the source may increase or
              decrease the hard or soft limit at any time through the
              transmission of new IPv6 ND messages. Until the first IPv6 ND
              message with a Reassembly Limit sub-option arrives, OMNI nodes
              assume initial default hard/soft limits of 9180 (I.e., the OMNI
              interface MRU). After IPv6 ND messages with Reassembly Limit
              sub-options arrive, the OMNI node retains the most recent
              hard/soft limit values until new IPv6 ND messages with different
              values arrive.<a href="#section-12.2.10-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.10-3.4">The 'H' flag is set to 1 if the Reassembly Limit is a "Hard"
              limit, and set to 0 if the Reassembly Limit is a "Soft"
              limit.<a href="#section-12.2.10-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.10-3.5">If N is greater than 2, the remainder of the Reassembly Limit
              sub-option encodes the leading portion of an OAL First Fragment
              that prompted this IPv6 ND message. The first fragment is
              included beginning with the OAL IPv6 header, and continuing with
              as much of the fragment payload as possible without causing the
              IPv6 ND message to exceed the minimum IPv6 MTU.<a href="#section-12.2.10-3.5" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="sub9.5">
<section id="section-12.2.11">
          <h4 id="name-fragmentation-report">
<a href="#section-12.2.11" class="section-number selfRef">12.2.11. </a><a href="#name-fragmentation-report" class="section-name selfRef">Fragmentation Report</a>
          </h4>
<p id="section-12.2.11-1">The Fragmentation Report may be included in the OMNI options of
          uNA messages sent from an OAL destination to an OAL source. The
          message consists of (N / 8)-many (Identification, Bitmap)-tuples
          which include the Identification values of OAL fragments received
          plus a Bitmap marking the ordinal positions of individual fragments
          received and fragments missing.<a href="#section-12.2.11-1" class="pilcrow">¶</a></p>
<span id="name-fragmentation-report-2"></span><div id="fragmentation-report">
<figure id="figure-24">
            <div class="artwork art-text alignLeft" id="section-12.2.11-2.1">
<pre>       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |S-Type=10|   Sub-Length = N    | Identification #1 (bits 0 -15)|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Identification #1 (bits 15-31)|    Bitmap #1 (bits 0 - 15)    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |       Bitmap #1 (bits 16-31)  | Identification #2 (bits 0 -15)|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Identification #2 (bits 15-31)|    Bitmap #2 (bits 0 - 15)    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |       Bitmap #2 (bits 16-31)  | Identification #3 (bits 0 -15)|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Identification #3 (bits 15-31)|    Bitmap #3 (bits 0 - 15)    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |       Bitmap #3 (bits 16-31)  |             ...               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+             ...               +
     |                              ...                              |
     +                              ...                              +
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-fragmentation-report-2" class="selfRef">Fragmentation Report</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.11-3.1">Sub-Type is set to 10. If multiple instances appear in OMNI
              options of the same message all are processed.<a href="#section-12.2.11-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.11-3.2">Sub-Length is set to N, i.e., the length of the option in
              octets beginning immediately following the Sub-Length field and
              extending to the end of the sub-option. If N is not an integral
              multiple of 8 octets, the sub-option is ignored. The length of
              the entire sub-option should not cause the entire IPv6 ND
              message to exceed the minimum MPS.<a href="#section-12.2.11-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.11-3.3">Identification (i) includes the IPv6 Identification value
              found in the Fragment Header of a received OAL fragment. (Only
              those Identification values included represent fragments for
              which loss was unambiguously observed; any Identification values
              not included correspond to fragments that were either received
              in their entirety or may still be in transit.)<a href="#section-12.2.11-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.11-3.4">
              <p id="section-12.2.11-3.4.1">Bitmap (i) includes an ordinal checklist of fragments, with
              each bit set to 1 for a fragment received or 0 for a fragment
              missing. (Each OAL packet may consist of at most 23 fragments,
              therefore Bitmap (i) bits 0-22 are consulted while bits 23-31
              are reserved for future use and ignored.) For example, for a
              20-fragment OAL packet with ordinal fragments #3, #10, #13 and
              #17 missing and all other fragments received, Bitmap (i) encodes
              the following:<a href="#section-12.2.11-3.4.1" class="pilcrow">¶</a></p>
<div id="frag-bitmap">
<figure id="figure-25">
                <div class="artwork art-text alignLeft" id="section-12.2.11-3.4.2.1">
<pre>      0                   1                   2
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
     |1|1|1|0|1|1|1|1|1|1|0|1|1|0|1|1|1|0|1|1|0|0|0|...
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a></figcaption></figure>
</div>
<p id="section-12.2.11-3.4.3">(Note that loss of an OAL atomic fragment is
              indicated by a Bitmap(i) with all bits set to 0.)<a href="#section-12.2.11-3.4.3" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sub10">
<section id="section-12.2.12">
          <h4 id="name-node-identification-2">
<a href="#section-12.2.12" class="section-number selfRef">12.2.12. </a><a href="#name-node-identification-2" class="section-name selfRef">Node Identification</a>
          </h4>
<span id="name-node-identification-3"></span><div id="hhit-tag">
<figure id="figure-26">
            <div class="artwork art-text alignLeft" id="section-12.2.12-1.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |S-Type=11|    Sub-length=N    |     ID-Type    |               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               ~
     ~            Node Identification Value (N-1 octets)             ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-node-identification-3" class="selfRef">Node Identification</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.12-2.1">Sub-Type is set to 11. If multiple instances appear in OMNI
              options of the same IPv6 ND message the first instance of a
              specific ID-Type is processed and all other instances of the
              same ID-Type are ignored. (It is therefore possible for a single
              IPv6 ND message to convey multiple distinct Node Identifications
              - each with a different ID-Type.)<a href="#section-12.2.12-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.12-2.2">Sub-Length is set to N that encodes the number of Sub-Option
              Data octets that follow. The ID-Type field is always present;
              hence, the maximum Node Identification Value length is limited
              by the remaining available space in this OMNI option.<a href="#section-12.2.12-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.12-2.3">
              <p id="section-12.2.12-2.3.1">ID-Type is a 1 octet field that encodes the type of the Node
              Identification Value. The following ID-Type values are currently
              defined:<a href="#section-12.2.12-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.12-2.3.2.1">0 - Universally Unique IDentifier (UUID) <span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span>. Indicates that Node Identification Value
                  contains a 16 octet UUID.<a href="#section-12.2.12-2.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.12-2.3.2.2">1 - Host Identity Tag (HIT) <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span>.
                  Indicates that Node Identification Value contains a 16 octet
                  HIT.<a href="#section-12.2.12-2.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.12-2.3.2.3">2 - Hierarchical HIT (HHIT) <span>[<a href="#I-D.ietf-drip-rid" class="xref">I-D.ietf-drip-rid</a>]</span>. Indicates that Node
                  Identification Value contains a 16 octet HHIT.<a href="#section-12.2.12-2.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.12-2.3.2.4">3 - Network Access Identifier (NAI) <span>[<a href="#RFC7542" class="xref">RFC7542</a>]</span>. Indicates that Node Identification Value
                  contains an N-1 octet NAI.<a href="#section-12.2.12-2.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.12-2.3.2.5">4 - Fully-Qualified Domain Name (FQDN) <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span>. Indicates that Node Identification Value
                  contains an N-1 octet FQDN.<a href="#section-12.2.12-2.3.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.12-2.3.2.6">5 - IPv6 Address. Indicates that Node Identification
                  contains a 16-octet IPv6 address that is not a (H)HIT. The
                  IPv6 address type is determined according to the IPv6
                  addressing architecture <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span>.<a href="#section-12.2.12-2.3.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.12-2.3.2.7">6 - 252 - Unassigned.<a href="#section-12.2.12-2.3.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.12-2.3.2.8">253-254 - Reserved for experimentation, as recommended in
                  <span>[<a href="#RFC3692" class="xref">RFC3692</a>]</span>.<a href="#section-12.2.12-2.3.2.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-12.2.12-2.3.2.9">255 - reserved by IANA.<a href="#section-12.2.12-2.3.2.9" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-12.2.12-2.4">Node Identification Value is an (N - 1) octet field encoded
              according to the appropriate the "ID-Type" reference above.<a href="#section-12.2.12-2.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-12.2.12-3">OMNI interfaces code Node Identification Values used for DHCPv6
          messaging purposes as a DHCP Unique IDentifier (DUID) using the
          "DUID-EN for OMNI" format with enterprise number 45282 (see: <a href="#iana" class="xref">Section 25</a>) as shown in <a href="#duid-hit" class="xref">Figure 27</a>:<a href="#section-12.2.12-3" class="pilcrow">¶</a></p>
<span id="name-duid-en-for-omni-format"></span><div id="duid-hit">
<figure id="figure-27">
            <div class="artwork art-text alignLeft" id="section-12.2.12-4.1">
<pre>      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |         DUID-Type (2)         |      EN (high bits == 0)      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     EN (low bits = 45282)     |    ID-Type    |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     .                    Node Identification Value                  .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-duid-en-for-omni-format" class="selfRef">DUID-EN for OMNI Format</a>
            </figcaption></figure>
</div>
<p id="section-12.2.12-5">In this format, the OMNI interface codes the ID-Type and Node
          Identification Value fields from the OMNI sub-option following a 6
          octet DUID-EN header, then includes the entire "DUID-EN for OMNI" in
          a DHCPv6 message per <span>[<a href="#RFC8415" class="xref">RFC8415</a>]</span>.<a href="#section-12.2.12-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sub14">
<section id="section-12.2.13">
          <h4 id="name-icmpv6-error">
<a href="#section-12.2.13" class="section-number selfRef">12.2.13. </a><a href="#name-icmpv6-error" class="section-name selfRef">ICMPv6 Error</a>
          </h4>
<span id="name-icmpv6-error-2"></span><div id="icmpv6-err">
<figure id="figure-28">
            <div class="artwork art-text alignLeft" id="section-12.2.13-1.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |S-Type=12|    Sub-length=N    |                                ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-                                ~
     ~                    RFC4443 Error Message Body                 ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-icmpv6-error-2" class="selfRef">ICMPv6 Error</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.13-2.1">Sub-Type is set to 12. If multiple instances appear in OMNI
              options of the same IPv6 ND message all are processed.<a href="#section-12.2.13-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.13-2.2">Sub-Length is set to N that encodes the number of Sub-Option
              Data octets that follow.<a href="#section-12.2.13-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.13-2.3">RFC4443 Error Message Body is an N-octet field encoding the
              body of an ICMPv6 Error Message per Section 2.1 of <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span> (ICMPv6 informational messages must not be
              included and must be ignored if received). OMNI interfaces
              include as much of the ICMPv6 error message body in the
              sub-option as possible without causing the IPv6 ND message to
              exceed the minimum IPv6 MTU.<a href="#section-12.2.13-2.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="sub30">
<section id="section-12.2.14">
          <h4 id="name-sub-type-extension">
<a href="#section-12.2.14" class="section-number selfRef">12.2.14. </a><a href="#name-sub-type-extension" class="section-name selfRef">Sub-Type Extension</a>
          </h4>
<p id="section-12.2.14-1">Since the Sub-Type field is only 5 bits in length, future
          specifications of major protocol functions may exhaust the remaining
          Sub-Type values available for assignment. This document therefore
          defines Sub-Type 30 as an "extension", meaning that the actual
          Sub-Option type is determined by examining a 1 octet
          "Extension-Type" field immediately following the Sub-Length field.
          The Sub-Type Extension is formatted as shown in <a href="#sub-type-extend" class="xref">Figure 29</a>:<a href="#section-12.2.14-1" class="pilcrow">¶</a></p>
<span id="name-sub-type-extension-2"></span><div id="sub-type-extend">
<figure id="figure-29">
            <div class="artwork art-text alignLeft" id="section-12.2.14-2.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |S-Type=30|     Sub-length=N    | Extension-Type|               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               ~
     ~                                                               ~
     ~                       Extension-Type Body                     ~
     ~                                                               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-29" class="selfRef">Figure 29</a>:
<a href="#name-sub-type-extension-2" class="selfRef">Sub-Type Extension</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.14-3.1">Sub-Type is set to 30. If multiple instances appear in OMNI
              options of the same message all are processed, where each
              individual extension defines its own policy for processing
              multiple of that type.<a href="#section-12.2.14-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.14-3.2">Sub-Length is set to N that encodes the number of Sub-Option
              Data octets that follow. The Extension-Type field is always
              present, and the maximum Extension-Type Body length is limited
              by the remaining available space in this OMNI option.<a href="#section-12.2.14-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.14-3.3">Extension-Type contains a 1 octet Sub-Type Extension value
              between 0 and 255.<a href="#section-12.2.14-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-12.2.14-3.4">Extension-Type Body contains an N-1 octet block with format
              defined by the given extension specification.<a href="#section-12.2.14-3.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-12.2.14-4">Extension-Type values 2 through 252 are available for
          assignment by future specifications, which must also define the
          format of the Extension-Type Body and its processing rules.
          Extension-Type values 253 and 254 are reserved for experimentation,
          as recommended in <span>[<a href="#RFC3692" class="xref">RFC3692</a>]</span>, and value 255 is
          reserved by IANA. Extension-Type values 0 and 1 are defined in the
          following subsections:<a href="#section-12.2.14-4" class="pilcrow">¶</a></p>
<div id="ext0">
<section id="section-12.2.14.1">
            <h5 id="name-rfc4380-header-extension-op">
<a href="#section-12.2.14.1" class="section-number selfRef">12.2.14.1. </a><a href="#name-rfc4380-header-extension-op" class="section-name selfRef">RFC4380 Header Extension Option</a>
            </h5>
<span id="name-rfc4380-header-extension-opt"></span><div id="header-extend">
<figure id="figure-30">
              <div class="artwork art-text alignLeft" id="section-12.2.14.1-1.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |S-Type=30|      Sub-length=N   |   Ext-Type=0  |   Header Type |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                      Header Option Value                      ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-30" class="selfRef">Figure 30</a>:
<a href="#name-rfc4380-header-extension-opt" class="selfRef">RFC4380 Header Extension Option (Extension-Type 0)</a>
              </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.14.1-2.1">Sub-Type is set to 30.<a href="#section-12.2.14.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-12.2.14.1-2.2">Sub-Length is set to N that encodes the number of
                Sub-Option Data octets that follow. The Extension-Type and
                Header Type fields are always present, and the Header Option
                Value is limited by the remaining available space in this OMNI
                option.<a href="#section-12.2.14.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-12.2.14.1-2.3">Extension-Type is set to 0. Each instance encodes exactly
                one header option per Section 5.1.1 of <span>[<a href="#RFC4380" class="xref">RFC4380</a>]</span>, with the leading '0' octet omitted and the
                following octet coded as Header Type. If multiple instances of
                the same Header Type appear in OMNI options of the same
                message the first instance is processed and all others are
                ignored. If Header Type indicates an Authentication
                Encapsulation (see below), the entire sub-option MUST appear
                as the first sub-option of the first OMNI option, which MUST
                appear immediately following the IPv6 ND message header.<a href="#section-12.2.14.1-2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-12.2.14.1-2.4">
                <p id="section-12.2.14.1-2.4.1">Header Type and Header Option Value are coded exactly as
                specified in Section 5.1.1 of <span>[<a href="#RFC4380" class="xref">RFC4380</a>]</span>; the
                following types are currently defined:<a href="#section-12.2.14.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.14.1-2.4.2.1">0 - Origin Indication (IPv4) - value coded per Section
                    5.1.1 of <span>[<a href="#RFC4380" class="xref">RFC4380</a>]</span>.<a href="#section-12.2.14.1-2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-12.2.14.1-2.4.2.2">1 - Authentication Encapsulation - value coded per
                    Section 5.1.1 of <span>[<a href="#RFC4380" class="xref">RFC4380</a>]</span>.<a href="#section-12.2.14.1-2.4.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-12.2.14.1-2.4.2.3">2 - Origin Indication (IPv6) - value coded per Section
                    5.1.1 of <span>[<a href="#RFC4380" class="xref">RFC4380</a>]</span>, except that the address
                    is a 16-octet IPv6 address instead of a 4-octet IPv4
                    address.<a href="#section-12.2.14.1-2.4.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-12.2.14.1-2.5">Header Type values 3 through 252 are available for
                assignment by future specifications, which must also define
                the format of the Header Option Value and its processing
                rules. Header Type values 253 and 254 are reserved for
                experimentation, as recommended in <span>[<a href="#RFC3692" class="xref">RFC3692</a>]</span>,
                and value 255 is Reserved by IANA.<a href="#section-12.2.14.1-2.5" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="ext1">
<section id="section-12.2.14.2">
            <h5 id="name-rfc6081-trailer-extension-o">
<a href="#section-12.2.14.2" class="section-number selfRef">12.2.14.2. </a><a href="#name-rfc6081-trailer-extension-o" class="section-name selfRef">RFC6081 Trailer Extension Option</a>
            </h5>
<span id="name-rfc6081-trailer-extension-op"></span><div id="origin-ind">
<figure id="figure-31">
              <div class="artwork art-text alignLeft" id="section-12.2.14.2-1.1">
<pre>      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |S-Type=30|      Sub-length=N   |   Ext-Type=1  |  Trailer Type |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                     Trailer Option Value                      ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-31" class="selfRef">Figure 31</a>:
<a href="#name-rfc6081-trailer-extension-op" class="selfRef">RFC6081 Trailer Extension Option (Extension-Type 1)</a>
              </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-12.2.14.2-2.1">Sub-Type is set to 30.<a href="#section-12.2.14.2-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-12.2.14.2-2.2">Sub-Length is set to N that encodes the number of
                Sub-Option Data octets that follow. The Extension-Type and
                Trailer Type fields are always present, and the maximum-length
                Trailer Option Value is limited by the remaining available
                space in this OMNI option.<a href="#section-12.2.14.2-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-12.2.14.2-2.3">Extension-Type is set to 1. Each instance encodes exactly
                one trailer option per Section 4 of <span>[<a href="#RFC6081" class="xref">RFC6081</a>]</span>.
                If multiple instances of the same Trailer Type appear in OMNI
                options of the same message the first instance is processed
                and all others ignored.<a href="#section-12.2.14.2-2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-12.2.14.2-2.4">
                <p id="section-12.2.14.2-2.4.1">Trailer Type and Trailer Option Value are coded exactly as
                specified in Section 4 of <span>[<a href="#RFC6081" class="xref">RFC6081</a>]</span>; the
                following Trailer Types are currently defined:<a href="#section-12.2.14.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.14.2-2.4.2.1">0 - Unassigned<a href="#section-12.2.14.2-2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-12.2.14.2-2.4.2.2">1 - Nonce Trailer - value coded per Section 4.2 of
                    <span>[<a href="#RFC6081" class="xref">RFC6081</a>]</span>.<a href="#section-12.2.14.2-2.4.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-12.2.14.2-2.4.2.3">2 - Unassigned<a href="#section-12.2.14.2-2.4.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-12.2.14.2-2.4.2.4">3 - Alternate Address Trailer (IPv4) - value coded per
                    Section 4.3 of <span>[<a href="#RFC6081" class="xref">RFC6081</a>]</span>.<a href="#section-12.2.14.2-2.4.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-12.2.14.2-2.4.2.5">4 - Neighbor Discovery Option Trailer - value coded per
                    Section 4.4 of <span>[<a href="#RFC6081" class="xref">RFC6081</a>]</span>.<a href="#section-12.2.14.2-2.4.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-12.2.14.2-2.4.2.6">5 - Random Port Trailer - value coded per Section 4.5
                    of <span>[<a href="#RFC6081" class="xref">RFC6081</a>]</span>.<a href="#section-12.2.14.2-2.4.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-12.2.14.2-2.4.2.7">6 - Alternate Address Trailer (IPv6) - value coded per
                    Section 4.3 of <span>[<a href="#RFC6081" class="xref">RFC6081</a>]</span>, except that each
                    address is a 16-octet IPv6 address instead of a 4-octet
                    IPv4 address.<a href="#section-12.2.14.2-2.4.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-12.2.14.2-2.5">Trailer Type values 7 through 252 are available for
                assignment by future specifications, which must also define
                the format of the Trailer Option Value and its processing
                rules. Trailer Type values 253 and 254 are reserved for
                experimentation, as recommended in <span>[<a href="#RFC3692" class="xref">RFC3692</a>]</span>,
                and value 255 is Reserved by IANA.<a href="#section-12.2.14.2-2.5" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="mcast">
<section id="section-13">
      <h2 id="name-address-mapping-multicast">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-address-mapping-multicast" class="section-name selfRef">Address Mapping - Multicast</a>
      </h2>
<p id="section-13-1">The multicast address mapping of the native underlying interface
      applies. The Client mobile router also serves as an IGMP/MLD Proxy for
      its EUNs and/or hosted applications per <span>[<a href="#RFC4605" class="xref">RFC4605</a>]</span>.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">The Client uses Multicast Listener Discovery (MLDv2) <span>[<a href="#RFC3810" class="xref">RFC3810</a>]</span> to coordinate with Proxy/Servers, and *NET L2
      elements use MLD snooping <span>[<a href="#RFC4541" class="xref">RFC4541</a>]</span>. The Client can also
      employ multicast routing protocols to coordinate with network-based
      multicast sources as specified in <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>.<a href="#section-13-2" class="pilcrow">¶</a></p>
<p id="section-13-3">Since the OMNI link model is NBMA, OMNI links support link-scoped
      multicast through iterative unicast transmissions to individual
      multicast group members (i.e., unicast/multicast emulation).<a href="#section-13-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="concept">
<section id="section-14">
      <h2 id="name-multilink-conceptual-sendin">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-multilink-conceptual-sendin" class="section-name selfRef">Multilink Conceptual Sending Algorithm</a>
      </h2>
<p id="section-14-1">The Client's IPv6 layer selects the outbound OMNI interface according
      to SBM considerations when forwarding original IP packets from local or
      EUN applications to external correspondents. Each OMNI interface
      maintains a neighbor cache the same as for any IPv6 interface, but
      includes additional state for multilink coordination. Each Client OMNI
      interface maintains default routes via Proxy/Servers discovered as
      discussed in <a href="#aeropd" class="xref">Section 15</a>, and may configure more-specific
      routes discovered through means outside the scope of this
      specification.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">For each original IP packet it forwards, the OMNI interface selects
      one or more source underlying interfaces based on PBM factors (e.g.,
      traffic attributes, cost, performance, message size, etc.) and one or
      more target underlying interfaces for the neighbor based on Interface
      Attributes received in IPv6 ND messages (see: <a href="#sub4" class="xref">Section 12.2.3</a>).
      Multilink forwarding may also direct packet replication across multiple
      underlying interface pairs for increased reliability at the expense of
      duplication. The set of all Interface Attributes and Traffic Selectors
      received in IPv6 ND messages determines the multilink forwarding profile
      for selecting target underlying interfaces.<a href="#section-14-2" class="pilcrow">¶</a></p>
<p id="section-14-3">When the OMNI interface sends an original IP packet over a selected
      source underlying interface, it first employs OAL encapsulation and
      fragmentation as discussed in <a href="#intmtu" class="xref">Section 5</a>, then performs
      *NET encapsulation as directed by the appropriate MFV. The OMNI
      interface also performs *NET encapsulation (following OAL encapsulation)
      when the nearest Proxy/Server is located multiple hops away as discussed
      in <a href="#multihop" class="xref">Section 15.2</a>.<a href="#section-14-3" class="pilcrow">¶</a></p>
<p id="section-14-4">OMNI interface multilink service designers MUST observe the BCP
      guidance in Section 15 <span>[<a href="#RFC3819" class="xref">RFC3819</a>]</span> in terms of implications
      for reordering when original IP packets from the same flow may be spread
      across multiple underlying interfaces having diverse properties.<a href="#section-14-4" class="pilcrow">¶</a></p>
<div id="multi-aero">
<section id="section-14.1">
        <h3 id="name-multiple-omni-interfaces">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-multiple-omni-interfaces" class="section-name selfRef">Multiple OMNI Interfaces</a>
        </h3>
<p id="section-14.1-1">Clients may connect to multiple independent OMNI links within the
        same or different OMNI domains to support SBM. The Client configures a
        separate OMNI interface for each link so that multiple interfaces
        (e.g., omni0, omni1, omni2, etc.) are exposed to the IP layer. Each
        OMNI interface configures one or more OMNI anycast addresses (see:
        <a href="#gua" class="xref">Section 10</a>), and the Client injects the corresponding
        anycast prefixes into the EUN routing system. Multiple distinct OMNI
        links can therefore be used to support fault tolerance, load
        balancing, reliability, etc.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<p id="section-14.1-2">Applications in EUNs can use Segment Routing to select the desired
        OMNI interface based on SBM considerations. The application writes an
        OMNI anycast address into the original IP packet's destination
        address, and writes the actual destination (along with any additional
        intermediate hops) into the Segment Routing Header. Standard IP
        routing directs the packet to the Client's mobile router entity, where
        the anycast address identifies the correct OMNI interface for next hop
        forwarding. When the Client receives the packet, it replaces the IP
        destination address with the next hop found in the Segment Routing
        Header and forwards the message via the OMNI interface identified by
        the anycast address.<a href="#section-14.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AR-looping">
<section id="section-14.2">
        <h3 id="name-client-proxy-server-loop-pr">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-client-proxy-server-loop-pr" class="section-name selfRef">Client-Proxy/Server Loop Prevention</a>
        </h3>
<p id="section-14.2-1">After a Proxy/Server has registered an MNP for a Client (see: <a href="#aeropd" class="xref">Section 15</a>), the Proxy/Server will forward all packets destined
        to an address within the MNP to the Client. The Client will under
        normal circumstances then forward the packet to the correct
        destination within its internal networks.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<p id="section-14.2-2">If at some later time the Client loses state (e.g., after a
        reboot), it may begin returning packets with destinations
        corresponding to its MNP to the Proxy/Server as its default router.
        The Proxy/Server therefore drops any original IP packets received from
        the Client with a destination address that corresponds to the Client's
        MNP (i.e., whether LLA, ULA or GUA), and drops any carrier packets
        with both source and destination address corresponding to the same
        Client's MNP regardless of their origin.<a href="#section-14.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="aeropd">
<section id="section-15">
      <h2 id="name-router-discovery-and-prefix">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-router-discovery-and-prefix" class="section-name selfRef">Router Discovery and Prefix Registration</a>
      </h2>
<p id="section-15-1">Clients interface with the MS by sending RS messages with OMNI
      options under the assumption that a Proxy/Server on the *NET will
      process the message and respond. The RS message is received by an "FHS"
      Proxy/Server, which may in turn forward a proxyed copy of the RS to the
      Client's current Hub Proxy/Server (which may be located on a remote
      LHS). The Client then configures default routes for the OMNI interface
      based on any RA message responses.<a href="#section-15-1" class="pilcrow">¶</a></p>
<p id="section-15-2">For each underlying interface, the Client sends RS messages with OMNI
      options to coordinate with FHS Proxy/Servers and a single Hub
      Proxy/Server identified by MSID values. Example MSID discovery methods
      are given in <span>[<a href="#RFC5214" class="xref">RFC5214</a>]</span> and include data link login
      parameters, name service lookups, static configuration, a static "hosts"
      file, etc. When the Client sends an RS message to a new FHS
      Proxy/Server, it first generates an MFVI then includes an OMNI option
      with an authentication signature if necessary and a Multilink Forwarding
      Parameters sub-option for the source underlying interface. The RS
      message includes link-scoped All-Routers multicast or a unicast ADM-LLA
      as the RS destination address, and includes an OMNI IPv6 anycast address
      or a specific unicast ADM-ULA as the OAL destination address when OAL
      encapsulation is used.<a href="#section-15-2" class="pilcrow">¶</a></p>
<p id="section-15-3">When an FHS Proxy/Server receives an RS with destination set to its
      own ADM-LLA, it authenticates the message then assumes the Hub
      Proxy/Server role and processes the message locally. The Hub
      Proxy/Server creates a NCE for the Client and caches the information in
      the Multilink Forwarding Parameters and any Traffic Selector
      sub-options, then acts as the sole entry point for injecting the
      Client's MNP into the MSE routing system (i.e., after performing any
      necessary MNP prefix delegation operations). The Hub Proxy/Server then
      prepares to return an RA message directly to the Client. When an FHS
      Proxy/Server receives an RS with destination set to link-scoped
      All-Routers multicast, it can either assume the Hub role the same as
      above or select an ADM-LLA for another Proxy/Server to serve as the Hub
      and proceed as discussed below.<a href="#section-15-3" class="pilcrow">¶</a></p>
<p id="section-15-4">When an FHS Proxy/Server receives an RS with destination set to the
      ADM-LLA of another Proxy/Server, the FHS Proxy/Server authenticates and
      proxies the message. The FHS Proxy/Server must then write the FHS
      Client's *NET addresses and its own address information in the
      appropriate Multilink Forwarding Parameters sub-option fields. The FHS
      Proxy/Server then re-encapsulates the RS in an OAL header with source
      set to its own ADM-ULA and destination set to the ADM-ULA of the Hub
      Proxy/Server then forwards the RS over the SRT secured spanning tree.
      When the Hub Proxy/Server receives the RS, it caches any state
      (including Multilink Forwarding Parameters information, Traffic
      Selectors and window synchronization parameters) and performs any
      necessary prefix delegation and routing protocol injection. The Hub
      Proxy/Server then returns an RA via the secured spanning tree with its
      own ADM-ULA as the OAL source and the ADM-ULA of the FHS Proxy/Server as
      the OAL destination, while writing its own address information in the
      Multilink Forwarding Parameters sub-option. When the FHS Proxy/Server
      receives the RA, it re-encapsulates in a new OAL header with
      source/destination set to the destination/source RS OAL addresses while
      including an authentication signature if necessary.<a href="#section-15-4" class="pilcrow">¶</a></p>
<p id="section-15-5">Clients configure OMNI interfaces that observe the properties
      discussed in the previous section. The OMNI interface and its underlying
      interfaces are said to be in either the "UP" or "DOWN" state according
      to administrative actions in conjunction with the interface connectivity
      status. An OMNI interface transitions to UP or DOWN through
      administrative action and/or through state transitions of the underlying
      interfaces. When a first underlying interface transitions to UP, the
      OMNI interface also transitions to UP. When all underlying interfaces
      transition to DOWN, the OMNI interface also transitions to DOWN.<a href="#section-15-5" class="pilcrow">¶</a></p>
<p id="section-15-6">When a Client OMNI interface transitions to UP, it sends RS messages
      to register its MNP and an initial set of underlying interfaces that are
      also UP. The Client sends additional RS messages to refresh lifetimes
      and to register/deregister underlying interfaces as they transition to
      UP or DOWN. The Client's OMNI interface sends initial RS messages over
      an UP underlying interface with its MNP-LLA as the source (or with the
      unspecified address (::) as the source if it does not yet have an
      MNP-LLA) and with destination set to link-scoped All-Routers multicast.
      The OMNI interface includes an OMNI option per <a href="#interface" class="xref">Section 12</a> with a Preflen assertion, a Multilink Forwarding
      Parameters sub-option for the underlying interface, Reassembly Limits,
      and with any other necessary OMNI sub-options (e.g., authentication).
      The OMNI interface then sets the S/T-omIndex field to identify the
      underlying interface used to forward the RS message.<a href="#section-15-6" class="pilcrow">¶</a></p>
<p id="section-15-7">The OMNI interface then forwards the RS over the underlying interface
      using OAL encapsulation and fragmentation if necessary. If the Client
      uses OAL encapsulation for RS messages sent to an unsynchronized INET
      interface neighbor, the entire RS message must fit within a single
      carrier packet (i.e., an atomic fragment) so that the FHS Proxy/Server
      can verify the authentication signature without having to reassemble.
      The OMNI interface selects an Identification value (see: <a href="#oal7.9" class="xref">Section 6.6</a>), sets the OAL source address to the ULA corresponding
      to the RS source (or a Temporary ULA if the RS source is the unspecified
      address (::)) and sets the OAL destination to an OMNI IPv6 anycast or
      ADM-ULA unicast address then sends the message.<a href="#section-15-7" class="pilcrow">¶</a></p>
<p id="section-15-8">FHS Proxy/Servers reached via the underlying interface receive IPv6
      ND messages with OMNI options and create a NCE for the Client if
      necessary while coordinating with a Hub Proxy/Server as discussed above.
      When the Hub Proxy/Server processes the RS OMNI information, it first
      validates the prefix registration information then injects/withdraws the
      MNP in the MS as necessary and caches/discards the new Preflen, MNP and
      Multilink Forwarding Parameters. The Hub Proxy/Server then returns an RA
      message with an OMNI option per <a href="#interface" class="xref">Section 12</a> using OAL
      encapsulation with an Identification value selected per <a href="#oal7.9" class="xref">Section 6.6</a>.<a href="#section-15-8" class="pilcrow">¶</a></p>
<p id="section-15-9">The Hub Proxy/Server returns each RA to the FHS Proxy/Server for the
      specific Client underlying interface, and the FHS Proxy/Server returns a
      proxyed version of the RA to the Client via the same underlying
      interface over which the RS was received while setting the P flag in the
      RA flags field <span>[<a href="#RFC4389" class="xref">RFC4389</a>]</span>. Each RA message includes the
      Client's MNP-LLA as the destination, the ADM-LLA of Hub Proxy/Server as
      the source, and an OMNI option with S/T-omIndex set to the value
      included in the RS. The OMNI option also includes a Preflen
      confirmation, Multilink Forwarding Parameters and any other necessary
      OMNI sub-options. The RA also includes any information for the link,
      including RA Cur Hop Limit, M and O flags, Router Lifetime, Reachable
      Time and Retrans Timer values, and includes any necessary options such
      as PIOs with (A; L=0) that include MSPs for the link <span>[<a href="#RFC8028" class="xref">RFC8028</a>]</span> or RIOs <span>[<a href="#RFC4191" class="xref">RFC4191</a>]</span> with more-specific
      routes.<a href="#section-15-9" class="pilcrow">¶</a></p>
<p id="section-15-10">The FHS Proxy/Server proxies the RA using nested OAL encapsulation
      with an Identification value selected per <a href="#oal7.9" class="xref">Section 6.6</a>, with
      source set to its own ADM-ULA and destination set to the MNP-ULA or
      temporary ULA of the Client. The FHS Proxy/Server then sends the
      solicited RA message to the Client and MAY later send periodic and/or
      event-driven unsolicited RA messages per <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>. In
      that case, the S/T-omIndex field in the OMNI option of each unsolicited
      RA message identifies the target underlying interface of the destination
      Client.<a href="#section-15-10" class="pilcrow">¶</a></p>
<p id="section-15-11">When the Client receives the RA message, it updates the OMNI
      interface NCE for the Hub Proxy/Server's ADM-LLA via the L2 address and
      ADM-ULA of the FHS Proxy/Server. The Client then caches the RA MFV
      information as the values to include in other IPv6 ND messages it sends
      over this underlying interface. If the Client connects to multiple
      *NETs, it records the additional FHS Proxy/Server L2/ADM-ULA addresses
      and MFV information in the Hub Proxy/Server NCE. The Client then
      configures default routes and assigns the OMNI Subnet Router Anycast
      address corresponding to the MNP (e.g., 2001:db8:1:2::) to the OMNI
      interface. The Client then manages its underlying interfaces according
      to their states as follows:<a href="#section-15-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-12.1">When an underlying interface transitions to UP, the Client sends
          an RS over the underlying interface with an OMNI option with
          sub-options as specified above.<a href="#section-15-12.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-12.2">When an underlying interface transitions to DOWN, the Client
          sends an unsolicited NA message over any UP underlying interface
          with an OMNI option containing Interface Attributes sub-options for
          the DOWN underlying interface with Link set to '0'. The Client sends
          isolated unsolicited NAs when reliability is not thought to be a
          concern (e.g., if redundant transmissions are sent on multiple
          underlying interfaces), or may instead set the PNG flag in the OMNI
          header to trigger a reliable solicited NA reply.<a href="#section-15-12.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-12.3">When the Router Lifetime for the Hub Proxy/Server nears
          expiration, the Client sends an RS over any underlying interface to
          receive a fresh RA. If no RA messages are received over a first
          underlying interface (i.e., after retrying), the Client marks the
          underlying interface as DOWN and should attempt to contact the Hub
          Proxy/Server via a different underlying interface. If the Hub
          Proxy/Server is unresponsive over additional underlying interface,
          the Client selects a different FHS Proxy/Server and sends an RS
          message with destination set to the ADM-LLA of the FHS Proxy/Server
          which will then assume the Hub role.<a href="#section-15-12.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-12.4">When all of a Client's underlying interfaces have transitioned to
          DOWN (or if the prefix registration lifetime expires), all
          associated Proxy/Servers withdraw the MNP the same as if they had
          received a message with a release indication.<a href="#section-15-12.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-15-13">The Client is responsible for retrying each RS exchange up to
      MAX_RTR_SOLICITATIONS times separated by RTR_SOLICITATION_INTERVAL
      seconds until an RA is received. If no RA is received over an UP
      underlying interface (i.e., even after attempting to contact alternate
      Proxy/Servers), the Client declares this underlying interface as
      DOWN.<a href="#section-15-13" class="pilcrow">¶</a></p>
<p id="section-15-14">The IPv6 layer sees the OMNI interface as an ordinary IPv6 interface.
      Therefore, when the IPv6 layer sends an RS message the OMNI interface
      returns an internally-generated RA message as though the message
      originated from an IPv6 router. The internally-generated RA message
      contains configuration information that is consistent with the
      information received from the RAs generated by the MS. Whether the OMNI
      interface IPv6 ND messaging process is initiated from the receipt of an
      RS message from the IPv6 layer or independently of the IPv6 layer is an
      implementation matter. Some implementations may elect to defer the IPv6
      ND messaging process until an RS is received from the IPv6 layer, while
      others may elect to initiate the process proactively. Still other
      deployments may elect to administratively disable the ordinary RS/RA
      messaging used by the IPv6 layer over the OMNI interface, since they are
      not required to drive the internal RS/RA processing. (Note that this
      same logic applies to IPv4 implementations that employ ICMP-based Router
      Discovery per <span>[<a href="#RFC1256" class="xref">RFC1256</a>]</span>.)<a href="#section-15-14" class="pilcrow">¶</a></p>
<p id="section-15-15">Note: Client RS messages include a Multilink Forwarding Parameters
      MFVI that corresponds to MFIB state that it holds for each FHS
      Proxy/Server used to reach the Hub, and the Hub Proxy/Server RA messages
      include Multilink Forwarding Parameter MFVIs that correspond to MFIB
      state for the Client. Each MFIB MFV entry includes both the MNP-ULA of
      the Client and the ADM-ULA of the Proxy/Server. Once MVF entries have
      been established, Clients and Proxy/Servers can exchange carrier packets
      using OAL header compression.<a href="#section-15-15" class="pilcrow">¶</a></p>
<p id="section-15-16">Note: The Router Lifetime value in RA messages indicates the time
      before which the Client must send another RS message over this
      underlying interface (e.g., 600 seconds), however that timescale may be
      significantly longer than the lifetime the MS has committed to retain
      the prefix registration (e.g., REACHABLETIME seconds). Proxy/Servers are
      therefore responsible for keeping MS state alive on a shorter timescale
      than the Client is required to do on its own behalf.<a href="#section-15-16" class="pilcrow">¶</a></p>
<p id="section-15-17">Note: On multicast-capable underlying interfaces, Clients should send
      periodic unsolicited multicast NA messages and Proxy/Servers should send
      periodic unsolicited multicast RA messages as "beacons" that can be
      heard by other nodes on the link. If a node fails to receive a beacon
      after a timeout value specific to the link, it can initiate a unicast
      exchange to test reachability.<a href="#section-15-17" class="pilcrow">¶</a></p>
<div id="rs-ra-win">
<section id="section-15.1">
        <h3 id="name-window-synchronization">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-window-synchronization" class="section-name selfRef">Window Synchronization</a>
        </h3>
<p id="section-15.1-1">In environments where Identification window synchronization is
        necessary, the RS/RA exchanges discussed above observe the procedures
        specified in <a href="#oal7.9" class="xref">Section 6.6</a>. The initial RS/RA exchange
        between a Client and Hub Proxy/Server over a first underlying
        interface must invoke end-to-end window synchronization when
        necessary, while subsequent RS/RA exchanges with the same Hub
        Proxy/Server performed over additional underlying interfaces within
        ReachableTime and with in-window Identification values need not also
        invoke end-to-end window synchronization. Following the initial
        exchange, future window (re)synchronizations can occur over any
        underlying interface, i.e., and not necessarily only over the one used
        for the initial exchange.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<p id="section-15.1-2">When a Client needs to perform window synchronization via a new FHS
        Proxy/Server, it sets the RS SYN source address to its own MNP-LLA and
        destination address to the ADM-LLA of the Hub Proxy/Server. The Client
        then performs OAL encapsulation using its own MNP-ULA as the source
        and the ADM-ULA of the FHS Proxy/Server as the destination and
        includes a Multilink Forwarding Parameters sub-option with Tunnel
        Window Synchronization parameters then forwards the resulting carrier
        packets to the FHS Proxy/Server. The FHS Proxy/Server authenticates
        the message, caches the Tunnel Window Synchronization parameters then
        re-encapsulates it with its own ADM-ULA as the source and the ADM-ULA
        of the Hub Proxy/Server as the target.<a href="#section-15.1-2" class="pilcrow">¶</a></p>
<p id="section-15.1-3">The FHS Proxy/Server then forwards the carrier packets via the
        secured spanning tree to the Hub Proxy/Server, which updates its
        Tunnel Window Synchronization information for the FHS Proxy/Server and
        returns a unicast RA message with source set to its own ADM-LLA and
        destination set to the Client's MNP-LLA. The Hub Proxy/Server then
        performs OAL encapsulation using its own ADM-ULA as the source and the
        ADM-ULA of the FHS Proxy/Server as the destination, then forwards the
        carrier packets via the secured spanning tree to the FHS Proxy/Server.
        The FHS Proxy/Server then caches the Window Synchronization
        information, re-encapsulates the message using its own ADM-ULA as the
        source, the MNP-ULA of the Client as the destination, and includes an
        authentication signature if necessary. The FHS Proxy/Server then
        forwards the message to the Client which updates its window
        synchronization information for both the Hub and FHS Proxy/Servers as
        necessary.<a href="#section-15.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multihop">
<section id="section-15.2">
        <h3 id="name-router-discovery-in-ip-mult">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-router-discovery-in-ip-mult" class="section-name selfRef">Router Discovery in IP Multihop and IPv4-Only Networks</a>
        </h3>
<p id="section-15.2-1">On some *NETs, a Client may be located multiple IP hops away from
        the nearest OMNI link Proxy/Server. Forwarding through IP multihop
        *NETs is conducted through the application of a routing protocol
        (e.g., a MANET/VANET routing protocol over omni-directional wireless
        interfaces, an inter-domain routing protocol in an enterprise network,
        etc.).<a href="#section-15.2-1" class="pilcrow">¶</a></p>
<p id="section-15.2-2">A Client located potentially multiple *NET hops away from the
        nearest Proxy/Server prepares an RS message, sets the source address
        to its MNP-LLA (or to the unspecified address (::) if it does not yet
        have an MNP-LLA), and sets the destination to link-scoped All-Routers
        multicast or a unicast ADM-LLA the same as discussed above. The OMNI
        interface then employs OAL encapsulation, sets the OAL source address
        to the ULA corresponding to the RS source (or to a Temporary ULA if
        the RS source was the unspecified address (::)) and sets the OAL
        destination to an OMNI IPv6 anycast address based on either a native
        IPv6 or IPv4-mapped IPv6 prefix (see: <a href="#gua" class="xref">Section 10</a>).<a href="#section-15.2-2" class="pilcrow">¶</a></p>
<p id="section-15.2-3">For IPv6-enabled *NETs, if the underlying interface does not
        configure an IPv6 GUA the Client forwards the message without further
        encapsulation. Otherwise, the Client encapsulates the message in
        UDP/IPv6 headers, sets the source to the underlying interface GUA and
        sets the destination to the same OMNI IPv6 anycast address. The Client
        then forwards the message into the IPv6 multihop routing system which
        conveys it to the nearest Proxy/Server that advertises a matching OMNI
        IPv6 anycast prefix.<a href="#section-15.2-3" class="pilcrow">¶</a></p>
<p id="section-15.2-4">For IPv4-only *NETs, the Client encapsulates the RS message in
        UDP/IPv4 headers, sets the source to the underlying interface IPv4
        address and sets the destination to the IPv4 anycast address TBD3
        (see: IANA Considerations). The Client then forwards the message into
        the IPv4 multihop routing system which conveys it to the nearest
        Proxy/Server that advertises the corresponding IPv4 prefix. If the
        nearest Proxy/Server is too busy and/or does not configure the
        specified OMNI IPv6 anycast address, it should forward (without
        Proxying) the OAL-encapsulated RS to another nearby Proxy/Server
        connected to the same IPv4 (multihop) network that configures the OMNI
        IPv6 anycast address. (In environments where reciprocal RS forwarding
        cannot be supported, the first Proxy/Server should instead return an
        RA based on its own MSP(s).)<a href="#section-15.2-4" class="pilcrow">¶</a></p>
<p id="section-15.2-5">When an intermediate *NET hop that participates in the routing
        protocol receives the encapsulated RS, it forwards the message
        according to its routing tables (note that an intermediate node could
        be a fixed infrastructure element or another Client). This process
        repeats iteratively until the RS message is received by a penultimate
        *NET hop within single-hop communications range of a Proxy/Server,
        which forwards the message to the Proxy/Server.<a href="#section-15.2-5" class="pilcrow">¶</a></p>
<p id="section-15.2-6">When the Proxy/Server that configures the OMNI IPv6 anycast OAL
        destination receives the message, it decapsulates the RS and assumes
        either the Hub or FHS role (in which case, it forwards the RS to a
        candidate Hub). The Hub Proxy/Server then prepares an RA message with
        source address set to its own ADM-LLA and destination address set to
        the Client MNP-LLA. The Hub Proxy/Server then performs OAL
        encapsulation and fragmentation, with the RA OAL source/destination
        set to the RS OAL destination/source and forwards the RA to the FHS
        Proxy/Server or directly to the Client.<a href="#section-15.2-6" class="pilcrow">¶</a></p>
<p id="section-15.2-7">When the Hub or FHS Proxy/Server forwards the RA to the Client, it
        encapsulates the message in *NET encapsulation headers (if necessary)
        with (source, destination) set to the (destination,source) of the RS
        encapsulation headers. The Proxy/Server then forwards the message to a
        *NET node within communications range, which forwards the message
        according to its routing tables to an intermediate node. The multihop
        forwarding process within the *NET continues repetitively until the
        message is delivered to the original Client, which decapsulates the
        message and performs autoconfiguration the same as if it had received
        the RA directly from a Proxy/Server on the same physical link.<a href="#section-15.2-7" class="pilcrow">¶</a></p>
<p id="section-15.2-8">Note: When the RS message includes anycast OAL and/or *NET
        encapsulation destinations, the FHS Proxy/Server must use the same
        anycast addresses as the OAL and/or *NET encapsulation sources to
        support forwarding of the RA message and any initial data packets over
        any NATs on the path. When the Client receives the RA, it will
        discover the unicast OAL and/or IPv4 encapsulation addresses by
        examining the Multilink Forwarding Parameters and can forward future
        packets using the unicast (instead of anycast) addresses to populate
        NAT state in the forward path. After the Client begins using unicast
        OAL/*NET encapsulation addresses in this way, the FHS Proxy/Server
        should also begin using the same unicast addresses in the reverse
        direction.<a href="#section-15.2-8" class="pilcrow">¶</a></p>
<p id="section-15.2-9">Note: As an alternate approach to multihop forwarding via IPv6
        encapsulation, the Client and Proxy/Server could statelessly translate
        the IPv6 LLAs into ULAs and forward the RS/RA messages without
        encapsulation. This would violate the <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>
        requirement that certain IPv6 ND messages must use link-local
        addresses and must not be accepted if received with Hop Limit less
        than 255. This document therefore mandates encapsulation since the
        overhead is nominal considering the infrequent nature and small size
        of IPv6 ND messages. Future documents may consider encapsulation
        avoidance through translation while updating <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>.<a href="#section-15.2-9" class="pilcrow">¶</a></p>
<p id="section-15.2-10">Note: An alternate approach to multihop forwarding via IPv4
        encapsulation would be to employ IPv6/IPv4 protocol translation.
        However, for IPv6 ND messages the LLAs would be truncated due to
        translation and the OMNI Router and Prefix Discovery services would
        not be able to function. The use of IPv4 encapsulation is therefore
        indicated.<a href="#section-15.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dhcpv6">
<section id="section-15.3">
        <h3 id="name-dhcpv6-based-prefix-registr">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-dhcpv6-based-prefix-registr" class="section-name selfRef">DHCPv6-based Prefix Registration</a>
        </h3>
<p id="section-15.3-1">When a Client is not pre-provisioned with an MNP-LLA (or, when the
        Client requires additional MNP delegations), it requests the MS to
        select MNPs on its behalf and set up the correct routing state. The
        DHCPv6 service <span>[<a href="#RFC8415" class="xref">RFC8415</a>]</span> supports this requirement.<a href="#section-15.3-1" class="pilcrow">¶</a></p>
<p id="section-15.3-2">When a Client requires the MS to select MNPs, it sends an RS
        message with source set to the unspecified address (::) if it has no
        MNP_LLAs. If the Client requires only a single MNP delegation, it can
        then include a Node Identification sub-option in the OMNI option and
        set Preflen to the length of the desired MNP. If the Client requires
        multiple MNP delegations and/or more complex DHCPv6 services, it
        instead includes a DHCPv6 Message sub-option containing a Client
        Identifier, one or more IA_PD options and a Rapid Commit option then
        sets the 'msg-type' field to "Solicit", and includes a 3 octet
        'transaction-id'. The Client then sets the RS destination to
        link-scoped All-Routers multicast and sends the message using OAL
        encapsulation and fragmentation if necessary as discussed above.<a href="#section-15.3-2" class="pilcrow">¶</a></p>
<p id="section-15.3-3">When the Hub Proxy/Server receives the RS message, it performs OAL
        reassembly if necessary. Next, if the RS source is the unspecified
        address (::) and/or the OMNI option includes a DHCPv6 message
        sub-option, the Hub Proxy/Server acts as a "Proxy DHCPv6 Client" in a
        message exchange with the locally-resident DHCPv6 server. If the RS
        did not contain a DHCPv6 message sub-option, the Hub Proxy/Server
        generates a DHCPv6 Solicit message on behalf of the Client using an
        IA_PD option with the prefix length set to the OMNI header Preflen
        value and with a Client Identifier formed from the OMNI option Node
        Identification sub-option; otherwise, the Hub Proxy/Server uses the
        DHCPv6 Solicit message contained in the OMNI option. The Hub
        Proxy/Server then sends the DHCPv6 message to the DHCPv6 Server, which
        delegates MNPs and returns a DHCPv6 Reply message with PD parameters.
        (If the Hub Proxy/Server wishes to defer creation of Client state
        until the DHCPv6 Reply is received, it can instead act as a
        Lightweight DHCPv6 Relay Agent per <span>[<a href="#RFC6221" class="xref">RFC6221</a>]</span> by
        encapsulating the DHCPv6 message in a Relay-forward/reply exchange
        with Relay Message and Interface ID options. In the process, the Hub
        Proxy/Server packs any state information needed to return an RA to the
        Client in the Relay-forward Interface ID option so that the
        information will be echoed back in the Relay-reply.)<a href="#section-15.3-3" class="pilcrow">¶</a></p>
<p id="section-15.3-4">When the Hub Proxy/Server receives the DHCPv6 Reply, it adds routes
        to the routing system and creates MNP-LLAs based on the delegated
        MNPs. The Hub Proxy/Server then sends an RA back to the Client with
        the DHCPv6 Reply message included in an OMNI DHCPv6 message sub-option
        if and only if the RS message had included an explicit DHCPv6 Solicit.
        If the RS message source was the unspecified address (::), the Hub
        Proxy/Server includes one of the (newly-created) MNP-LLAs as the RA
        destination address and sets the OMNI option Preflen accordingly;
        otherwise, the Hub Proxy/Server includes the RS source address as the
        RA destination address. The Hub Proxy/Server then sets the RA source
        address to its own ADM-LLA then performs OAL encapsulation and
        fragmentation and sends the RA to the Client (i.e., either directly or
        via an FHS Proxy/Server). When the Client receives the RA, it
        reassembles and discards the OAL encapsulation, then creates a default
        route, assigns Subnet Router Anycast addresses and uses the RA
        destination address as its primary MNP-LLA. The Client will then use
        this primary MNP-LLA as the source address of any IPv6 ND messages it
        sends as long as it retains ownership of the MNP.<a href="#section-15.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="redirect">
<section id="section-16">
      <h2 id="name-secure-redirection">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-secure-redirection" class="section-name selfRef">Secure Redirection</a>
      </h2>
<p id="section-16-1">If the *NET link model is multiple access, the FHS Proxy/Server is
      responsible for assuring that address duplication cannot corrupt the
      neighbor caches of other nodes on the link. When the Client sends an RS
      message on a multiple access *NET link, the Proxy/Server verifies that
      the Client is authorized to use the address and responds with an RA (or
      forwards the RS to the Hub) only if the Client is authorized.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">After verifying Client authorization and returning an RA, the
      Proxy/Server MAY return IPv6 ND Redirect messages to direct Clients
      located on the same *NET link to exchange packets directly without
      transiting the Proxy/Server. In that case, the Clients can exchange
      packets according to their unicast L2 addresses discovered from the
      Redirect message instead of using the dogleg path through the
      Proxy/Server. In some *NET links, however, such direct communications
      may be undesirable and continued use of the dogleg path through the
      Proxy/Server may provide better performance. In that case, the
      Proxy/Server can refrain from sending Redirects, and/or Clients can
      ignore them.<a href="#section-16-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vrrp">
<section id="section-17">
      <h2 id="name-proxy-server-resilience">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-proxy-server-resilience" class="section-name selfRef">Proxy/Server Resilience</a>
      </h2>
<p id="section-17-1">*NETs SHOULD deploy Proxy/Servers in Virtual Router Redundancy
      Protocol (VRRP) <span>[<a href="#RFC5798" class="xref">RFC5798</a>]</span> configurations so that service
      continuity is maintained even if one or more Proxy/Servers fail. Using
      VRRP, the Client is unaware which of the (redundant) FHS Proxy/Servers
      is currently providing service, and any service discontinuity will be
      limited to the failover time supported by VRRP. Widely deployed public
      domain implementations of VRRP are available.<a href="#section-17-1" class="pilcrow">¶</a></p>
<p id="section-17-2">Proxy/Servers SHOULD use high availability clustering services so
      that multiple redundant systems can provide coordinated response to
      failures. As with VRRP, widely deployed public domain implementations of
      high availability clustering services are available. Note that
      special-purpose and expensive dedicated hardware is not necessary, and
      public domain implementations can be used even between lightweight
      virtual machines in cloud deployments.<a href="#section-17-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pulse">
<section id="section-18">
      <h2 id="name-detecting-and-responding-to">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-detecting-and-responding-to" class="section-name selfRef">Detecting and Responding to Proxy/Server Failures</a>
      </h2>
<p id="section-18-1">In environments where fast recovery from Proxy/Server failure is
      required, FHS Proxy/Servers SHOULD use proactive Neighbor Unreachability
      Detection (NUD) in a manner that parallels Bidirectional Forwarding
      Detection (BFD) <span>[<a href="#RFC5880" class="xref">RFC5880</a>]</span> to track Hub Proxy/Server
      reachability. FHS Proxy/Servers can then quickly detect and react to
      failures so that cached information is re-established through alternate
      paths. Proactive NUD control messaging is carried only over
      well-connected ground domain networks (i.e., and not low-end *NET links
      such as aeronautical radios) and can therefore be tuned for rapid
      response.<a href="#section-18-1" class="pilcrow">¶</a></p>
<p id="section-18-2">FHS Proxy/Servers perform proactive NUD for Hub Proxy/Servers for
      which there are currently active Clients on the *NET. If a Hub
      Proxy/Server fails, the FHS Proxy/Server can quickly inform Clients of
      the outage by sending multicast RA messages on the *NET interface. The
      FHS Proxy/Server sends RA messages to Clients via the *NET interface
      with an OMNI option with a Release ID for the failed LHS Proxy/Server,
      and with destination address set to All-Nodes multicast (ff02::1) <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span>.<a href="#section-18-2" class="pilcrow">¶</a></p>
<p id="section-18-3">The FHS Proxy/Server SHOULD send MAX_FINAL_RTR_ADVERTISEMENTS RA
      messages separated by small delays <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>. Any Clients
      on the *NET interface that have been using the (now defunct) Hub
      Proxy/Server will receive the RA messages.<a href="#section-18-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trans">
<section id="section-19">
      <h2 id="name-transition-considerations">
<a href="#section-19" class="section-number selfRef">19. </a><a href="#name-transition-considerations" class="section-name selfRef">Transition Considerations</a>
      </h2>
<p id="section-19-1">When a Client connects to an *NET link for the first time, it sends
      an RS message with an OMNI option. If the first hop router recognizes
      the option, it responds according to the appropriate FHS/Hub
      Proxy/Server role resulting in an RA message with an OMNI option
      returned to the Client. The Client then engages this FHS Proxy/Sever
      according to the OMNI link model specified above. If the first hop
      router is a legacy IPv6 router, however, it instead returns an RA
      message with no OMNI option and with a non-OMNI unicast source LLA as
      specified in <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>. In that case, the Client engages
      the *NET according to the legacy IPv6 link model and without the OMNI
      extensions specified in this document.<a href="#section-19-1" class="pilcrow">¶</a></p>
<p id="section-19-2">If the *NET link model is multiple access, there must be assurance
      that address duplication cannot corrupt the neighbor caches of other
      nodes on the link. When the Client sends an RS message on a multiple
      access *NET link with an LLA source address and an OMNI option, first
      hop routers that recognize the OMNI option ensure that the Client is
      authorized to use the address and return an RA with a non-zero Router
      Lifetime only if the Client is authorized. First hop routers that do not
      recognize the OMNI option instead return an RA that makes no statement
      about the Client's authorization to use the source address. In that
      case, the Client should perform Duplicate Address Detection to ensure
      that it does not interfere with other nodes on the link.<a href="#section-19-2" class="pilcrow">¶</a></p>
<p id="section-19-3">An alternative approach for multiple access *NET links to ensure
      isolation for Client-Proxy/Server communications is through L2 address
      mappings as discussed in <a href="#ipv6ndmap" class="xref">Appendix D</a>. This arrangement
      imparts a (virtual) point-to-point link model over the (physical)
      multiple access link.<a href="#section-19-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="openint">
<section id="section-20">
      <h2 id="name-omni-interfaces-on-open-int">
<a href="#section-20" class="section-number selfRef">20. </a><a href="#name-omni-interfaces-on-open-int" class="section-name selfRef">OMNI Interfaces on Open Internetworks</a>
      </h2>
<p id="section-20-1">Client OMNI interfaces configured over IPv6-enabled underlying
      interfaces on an open Internetwork without an OMNI-aware first-hop
      router receive IPv6 RA messages with no OMNI options, while OMNI
      interfaces configured over IPv4-only underlying interfaces receive no
      IPv6 RA messages at all (but may receive IPv4 RA messages <span>[<a href="#RFC1256" class="xref">RFC1256</a>]</span>). Client OMNI interfaces that receive RA messages
      with OMNI options configure addresses, on-link prefixes, etc. on the
      underlying interface that received the RA according to standard IPv6 ND
      and address resolution conventions <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span>. Client OMNI interfaces configured over IPv4-only
      underlying interfaces configure IPv4 address information on the
      underlying interfaces using mechanisms such as DHCPv4 <span>[<a href="#RFC2131" class="xref">RFC2131</a>]</span>.<a href="#section-20-1" class="pilcrow">¶</a></p>
<p id="section-20-2">Client OMNI interfaces configured over underlying interfaces
      connected to open Internetworks can apply security services such as VPNs
      to connect to a Proxy/Server, or can establish a direct link to the
      Proxy/Server through some other means (see <a href="#aerospec" class="xref">Section 4</a>).
      In environments where an explicit VPN or direct link may be impractical,
      Client OMNI interfaces can instead send IPv6 ND messages with
      authentication signatures using UDP/IP encapsulation.<a href="#section-20-2" class="pilcrow">¶</a></p>
<p id="section-20-3">OMNI interfaces use UDP service port number 8060 (see: <a href="#iana9" class="xref">Section 25.13</a> and Section 3.6 of <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>), and use simple UDP/IP encapsulation
      for both IPv4 and IPv6 underlying interfaces. The OMNI interface submits
      original IP packets for OAL encapsulation, then encapsulates the
      resulting OAL fragments immediately following a UDP header. (The first
      four bits following the UDP header determine whether the OAL headers are
      uncompressed/compressed as discussed in <a href="#oal98" class="xref">Section 6.4</a>.) The
      OMNI interface sets the UDP length to the encapsulated OAL fragment
      length.<a href="#section-20-3" class="pilcrow">¶</a></p>
<p id="section-20-4">For Client-Proxy/Server (e.g., "Vehicle-to-Infrastructure (V2I)")
      neighbor exchanges, the source must include an OMNI option with an
      authentication sub-option in all IPv6 ND messages. The source can apply
      HIP security services per <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span> using the IPv6 ND
      message OMNI option as a "shipping container" to convey an
      authentication signature in a (unidirectional) HIP "Notify" message. For
      Client-Client (e.g., "Vehicle-to-Vehicle (V2V)") neighbor exchanges, two
      Clients can exchange HIP "Initiator/Responder" messages coded in OMNI
      options of multiple IPv6 NS/NA messages for mutual authentication
      according to the HIP protocol. (Note: a simple Hashed Message
      Authentication Code (HMAC) such as specified in <span>[<a href="#RFC4380" class="xref">RFC4380</a>]</span>
      can be used as an alternate authentication service in some
      environments.)<a href="#section-20-4" class="pilcrow">¶</a></p>
<p id="section-20-5">When an OMNI interface includes an authentication sub-option, it must
      appear as the first sub-option of the first OMNI option in the IPv6 ND
      message which must appear immediately following the IPv6 ND message
      header. When an OMNI interface prepares a HIP message sub-option, it
      includes its own (H)HIT as the Sender's HIT and the neighbor's (H)HIT if
      known as the Receiver's HIT (otherwise 0). If (H)HITs are not available
      within the OMNI operational environment, the source can instead include
      other IPv6 address types instead of (H)HITs as long as the Sender and
      Receiver have some way to associate the IPv6 address with the neighbor
      (e.g., via a node identifier, MAC address, etc. embedded in the
      address).<a href="#section-20-5" class="pilcrow">¶</a></p>
<p id="section-20-6">Before calculating the authentication signature, the source sets both
      the IPv6 ND message Checksum and authentication signature fields to 0.
      The source then calculates the authentication signature over the full
      length of the IPv6 ND message beginning with a pseudo-header of the IPv6
      header (i.e., the same as specified in <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span>) and
      extending over all IPv6 ND message options including all OMNI options.
      The source next writes the authentication signature into the sub-option
      signature field and forwards the message with the Checksum field still
      set to 0.<a href="#section-20-6" class="pilcrow">¶</a></p>
<p id="section-20-7">After establishing a VPN or preparing for UDP/IP encapsulation, OMNI
      interfaces send RS/RA messages for Client-Proxy/Server coordination
      (see: <a href="#aeropd" class="xref">Section 15</a>) and NS/NA messages for route
      optimization, window synchronization and mobility management (see: <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>). These control plane messages must be
      authenticated while other control and data plane messages are delivered
      the same as for ordinary best-effort traffic with source address and/or
      Identification window-based data origin verification. Upper layer
      protocol sessions over OMNI interfaces that connect over open
      Internetworks without an explicit VPN should therefore employ transport-
      or higher-layer security to ensure authentication, integrity and/or
      confidentiality.<a href="#section-20-7" class="pilcrow">¶</a></p>
<p id="section-20-8">Clients should avoid using INET Proxy/Servers as general-purpose
      routers for steady streams of carrier packets that do not require
      authentication. Clients should instead coordinate with other INET nodes
      that can provide forwarding services instead of burdening the
      Proxy/Server (or preferably coordinate directly with peer Clients
      directly). Procedures for coordinating with peer Clients and discovering
      INET nodes that can provide better forwarding services are discussed in
      <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>.<a href="#section-20-8" class="pilcrow">¶</a></p>
<p id="section-20-9">Clients that attempt to contact peers over INET underlying interfaces
      often encounter NATs in the path. OMNI interfaces accommodate NAT
      traversal using UDP/IP encapsulation and the mechanisms discussed in
      <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span>. Proxy/Servers include Origin
      Indications in RA messages over INET underlying interfaces to allow
      Clients to detect the presence of NATs.<a href="#section-20-9" class="pilcrow">¶</a></p>
<p id="section-20-10">Note: Following the initial IPv6 ND message exchange, OMNI interfaces
      configured over INET underlying interfaces maintain neighbor
      relationships by transmitting periodic IPv6 ND messages with OMNI
      options that include HIP "Update" and/or "Notify" messages. When HMAC
      authentication is used instead of HIP, the Client and Proxy/Server
      exchange all IPv6 ND messages with HMAC signatures included based on a
      shared-secret.<a href="#section-20-10" class="pilcrow">¶</a></p>
<p id="section-20-11">Note: OMNI interfaces configured over INET underlying interfaces
      should employ the Identification window synchronization mechanisms
      specified in <a href="#oal7.9" class="xref">Section 6.6</a> in order to reject spurious carrier
      packets that might otherwise clutter the reassembly cache. This is
      especially important in environments where carrier packet spoofing
      and/or corruption is a threat.<a href="#section-20-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reuse">
<section id="section-21">
      <h2 id="name-time-varying-mnps">
<a href="#section-21" class="section-number selfRef">21. </a><a href="#name-time-varying-mnps" class="section-name selfRef">Time-Varying MNPs</a>
      </h2>
<p id="section-21-1">In some use cases, it is desirable, beneficial and efficient for the
      Client to receive a constant MNP that travels with the Client wherever
      it moves. For example, this would allow air traffic controllers to
      easily track aircraft, etc. In other cases, however (e.g., intelligent
      transportation systems), the Client may be willing to sacrifice a
      modicum of efficiency in order to have time-varying MNPs that can be
      changed every so often to defeat adversarial tracking.<a href="#section-21-1" class="pilcrow">¶</a></p>
<p id="section-21-2">The prefix delegation services discussed in <a href="#dhcpv6" class="xref">Section 15.3</a>
      allows Clients that desire time-varying MNPs to obtain short-lived
      prefixes to send RS messages with source set to the unspecified address
      (::) and/or with an OMNI option with DHCPv6 Option sub-options. The
      Client would then be obligated to renumber its internal networks
      whenever its MNP (and therefore also its OMNI address) changes. This
      should not present a challenge for Clients with automated network
      renumbering services, but may disrupt persistent sessions that would
      prefer to use a constant address.<a href="#section-21-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hip-nd">
<section id="section-22">
      <h2 id="name-hhits-and-temporary-ulas">
<a href="#section-22" class="section-number selfRef">22. </a><a href="#name-hhits-and-temporary-ulas" class="section-name selfRef">(H)HITs and Temporary ULAs</a>
      </h2>
<p id="section-22-1">Clients that generate (H)HITs but do not have pre-assigned MNPs can
      request MNP delegations by issuing IPv6 ND messages that use the (H)HIT
      instead of a Temporary ULA. In particular, when a Client creates an RS
      message it can set the source to the unspecified address (::) and
      destination to link-scoped All-Routers multicast. The IPv6 ND message
      includes an OMNI option with a HIP message sub-option, and need not
      include a Node Identification sub-option if the Client's HIT appears in
      the HIP message. The Client then encapsulates the message in an IPv6
      header with the (H)HIT as the source address. The Client then sends the
      message as specified in <a href="#multihop" class="xref">Section 15.2</a>.<a href="#section-22-1" class="pilcrow">¶</a></p>
<p id="section-22-2">When a Proxy/Server receives the RS message, it notes that the source
      was the unspecified address (::), then examines the encapsulation source
      address to determine that the source is a (H)HIT and not a Temporary
      ULA. The Proxy/Server next invokes the DHCPv6 protocol to request an MNP
      prefix delegation while using the HIT (in the form of a DUID) as the
      Client Identifier, then prepares an RA message with source address set
      to its own ADM-LLA and destination set to the MNP-LLA corresponding to
      the delegated MNP. The Proxy/Server next includes an OMNI option with a
      HIP message sub-option and any DHCPv6 prefix delegation parameters. The
      Proxy/Server finally encapsulates the RA in an IPv6 header with source
      address set to its own ADM-ULA and destination set to the (H)HIT from
      the RS encapsulation source address, then returns the encapsulated RA to
      the Client.<a href="#section-22-2" class="pilcrow">¶</a></p>
<p id="section-22-3">Clients can also use (H)HITs and/or Temporary ULAs for direct
      Client-to-Client communications outside the context of any OMNI link
      supporting infrastructure. When two Clients encounter one another they
      can use their (H)HITs and/or Temporary ULAs as original IPv6 packet
      source and destination addresses to support direct communications.
      Clients can also inject their (H)HITs and/or Temporary ULAs into a
      MANET/VANET routing protocol to enable multihop communications. Clients
      can further exchange IPv6 ND messages (such as NS/NA) using their
      (H)HITs and/or Temporary ULAs as source and destination addresses.<a href="#section-22-3" class="pilcrow">¶</a></p>
<p id="section-22-4">Lastly, when Clients are within the coverage range of OMNI link
      infrastructure a case could be made for injecting (H)HITs and/or
      Temporary ULAs into the global MS routing system. For example, when the
      Client sends an RS to an FHS Proxy/Server it could include a request to
      inject the (H)HIT / Temporary ULA into the routing system instead of
      requesting an MNP prefix delegation. This would potentially enable OMNI
      link-wide communications using only (H)HITs or Temporary ULAs, and not
      MNPs. This document notes the opportunity, but makes no
      recommendation.<a href="#section-22-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="addrsel">
<section id="section-23">
      <h2 id="name-address-selection">
<a href="#section-23" class="section-number selfRef">23. </a><a href="#name-address-selection" class="section-name selfRef">Address Selection</a>
      </h2>
<p id="section-23-1">Clients use LLAs only for link-scoped communications on the OMNI
      link. Typically, Clients use LLAs as source/destination IPv6 addresses
      of IPv6 ND messages, but may also use them for addressing ordinary
      original IP packets exchanged with an OMNI link neighbor.<a href="#section-23-1" class="pilcrow">¶</a></p>
<p id="section-23-2">Clients use MNP-ULAs as source/destination IPv6 addresses in the
      encapsulation headers of OAL packets. Clients use Temporary ULAs for OAL
      addressing when an MNP-ULA is not available, or as source/destination
      IPv6 addresses for communications within a MANET/VANET local area.
      Clients can also use (H)HITs instead of Temporary ULAs when operation
      outside the context of a specific ULA domain and/or source address
      attestation is necessary.<a href="#section-23-2" class="pilcrow">¶</a></p>
<p id="section-23-3">Clients use MNP-based GUAs as original IP packet source and
      destination addresses for communications with Internet destinations when
      they are within range of OMNI link supporting infrastructure that can
      inject the MNP into the routing system.<a href="#section-23-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="icmperr">
<section id="section-24">
      <h2 id="name-error-messages">
<a href="#section-24" class="section-number selfRef">24. </a><a href="#name-error-messages" class="section-name selfRef">Error Messages</a>
      </h2>
<p id="section-24-1">An OAL destination or intermediate node may need to return
      ICMPv6-like error messages (e.g., Destination Unreachable, Packet Too
      Big, Time Exceeded, etc.) <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span> to an OAL source.
      Since ICMPv6 error messages do not themselves include authentication
      codes, OAL nodes can return error messages as an OMNI ICMPv6 Error
      sub-option in a secured IPv6 ND uNA message.<a href="#section-24-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-25">
      <h2 id="name-iana-considerations">
<a href="#section-25" class="section-number selfRef">25. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-25-1">The following IANA actions are requested in accordance with <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span> and <span>[<a href="#RFC8726" class="xref">RFC8726</a>]</span>:<a href="#section-25-1" class="pilcrow">¶</a></p>
<div id="iana0.25">
<section id="section-25.1">
        <h3 id="name-protocol-numbers-registry">
<a href="#section-25.1" class="section-number selfRef">25.1. </a><a href="#name-protocol-numbers-registry" class="section-name selfRef">"Protocol Numbers" Registry</a>
        </h3>
<p id="section-25.1-1">The IANA is instructed to allocate an Internet Protocol number TBD1
        from the 'protocol numbers' registry for the Overlay Multilink Network
        Interface (OMNI) protocol. Guidance is found in <span>[<a href="#RFC5237" class="xref">RFC5237</a>]</span> (registration procedure is IESG Approval or
        Standards Action).<a href="#section-25.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana0.5">
<section id="section-25.2">
        <h3 id="name-ieee-802-numbers-registry">
<a href="#section-25.2" class="section-number selfRef">25.2. </a><a href="#name-ieee-802-numbers-registry" class="section-name selfRef">"IEEE 802 Numbers" Registry</a>
        </h3>
<p id="section-25.2-1">During final publication stages, the IESG will be requested to
        procure an IEEE EtherType value TBD2 for OMNI according to the
        statement found at
        https://www.ietf.org/about/groups/iesg/statements/ethertypes/.<a href="#section-25.2-1" class="pilcrow">¶</a></p>
<p id="section-25.2-2">Following IESG procurement, the IANA is instructed to register the
        value TBD2 in the 'ieee-802-numbers' registry for Overlay Multilink
        Network Interface (OMNI) encapsulation on Ethernet networks. Guidance
        is found in <span>[<a href="#RFC7042" class="xref">RFC7042</a>]</span> (registration procedure is Expert
        Review).<a href="#section-25.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana0.6">
<section id="section-25.3">
        <h3 id="name-ipv4-special-purpose-addres">
<a href="#section-25.3" class="section-number selfRef">25.3. </a><a href="#name-ipv4-special-purpose-addres" class="section-name selfRef">"IPv4 Special-Purpose Address" Registry</a>
        </h3>
<p id="section-25.3-1">The IANA is instructed to assign TBD3/N as an "OMNI IPv4 anycast"
        address/prefix in the "IPv4 Special-Purpose Address" registry. This
        specification recommends assigning the address 192.88.99.100/24 as the
        "OMNI IPv4 anycast" address/prefix, since the former use of the
        address/prefix 192.88.99.1/24 is deprecated by <span>[<a href="#RFC7526" class="xref">RFC7526</a>]</span>. In the event that conflicts with the former use
        are deemed irreconcilable, the IANA is instructed to work with authors
        to determine an alternate TBD3/N address/prefix.<a href="#section-25.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana1">
<section id="section-25.4">
        <h3 id="name-ipv6-neighbor-discovery-opt">
<a href="#section-25.4" class="section-number selfRef">25.4. </a><a href="#name-ipv6-neighbor-discovery-opt" class="section-name selfRef">"IPv6 Neighbor Discovery Option Formats" Registry</a>
        </h3>
<p id="section-25.4-1">The IANA is instructed to allocate an official Type number TBD4
        from the "IPv6 Neighbor Discovery Option Formats" registry for the
        OMNI option (registration procedure is RFC required). Implementations
        set Type to 253 as an interim value <span>[<a href="#RFC4727" class="xref">RFC4727</a>]</span>.<a href="#section-25.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana2">
<section id="section-25.5">
        <h3 id="name-ethernet-numbers-registry">
<a href="#section-25.5" class="section-number selfRef">25.5. </a><a href="#name-ethernet-numbers-registry" class="section-name selfRef">"Ethernet Numbers" Registry</a>
        </h3>
<p id="section-25.5-1">The IANA is instructed to allocate one Ethernet unicast address
        TBD5 (suggested value '00-52-14') in the 'ethernet-numbers' registry
        under "IANA Unicast 48-bit MAC Addresses" (registration procedure is
        Expert Review). The registration should appear as follows:<a href="#section-25.5-1" class="pilcrow">¶</a></p>
<span id="name-iana-unicast-48-bit-mac-add"></span><div id="ether-addr">
<figure id="figure-32">
          <div class="artwork art-text alignLeft" id="section-25.5-2.1">
<pre>   Addresses      Usage                                         Reference
   ---------      -----                                         ---------
   00-52-14       Overlay Multilink Network (OMNI) Interface    [RFCXXXX]
</pre>
</div>
<figcaption><a href="#figure-32" class="selfRef">Figure 32</a>:
<a href="#name-iana-unicast-48-bit-mac-add" class="selfRef">IANA Unicast 48-bit MAC Addresses</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="iana3">
<section id="section-25.6">
        <h3 id="name-icmpv6-code-fields-type-2-p">
<a href="#section-25.6" class="section-number selfRef">25.6. </a><a href="#name-icmpv6-code-fields-type-2-p" class="section-name selfRef">"ICMPv6 Code Fields: Type 2 - Packet Too Big" Registry</a>
        </h3>
<p id="section-25.6-1">The IANA is instructed to assign two new Code values in the "ICMPv6
        Code Fields: Type 2 - Packet Too Big" registry (registration procedure
        is Standards Action or IESG Approval). The registry should appear as
        follows:<a href="#section-25.6-1" class="pilcrow">¶</a></p>
<span id="name-icmpv6-code-fields-type-2-pa"></span><div id="omni-pmtu-code">
<figure id="figure-33">
          <div class="artwork art-text alignLeft" id="section-25.6-2.1">
<pre>   Code      Name                         Reference
   ---       ----                         ---------
   0         PTB Hard Error               [RFC4443]
   1         PTB Soft Error (loss)        [RFCXXXX]
   2         PTB Soft Error (no loss)     [RFCXXXX]
</pre>
</div>
<figcaption><a href="#figure-33" class="selfRef">Figure 33</a>:
<a href="#name-icmpv6-code-fields-type-2-pa" class="selfRef">ICMPv6 Code Fields: Type 2 - Packet Too Big Values</a>
          </figcaption></figure>
</div>
<p id="section-25.6-3">(Note: this registry also to be used to define values for
        setting the "unused" field of ICMPv4 "Destination Unreachable -
        Fragmentation Needed" messages.)<a href="#section-25.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana4">
<section id="section-25.7">
        <h3 id="name-omni-option-sub-type-values">
<a href="#section-25.7" class="section-number selfRef">25.7. </a><a href="#name-omni-option-sub-type-values" class="section-name selfRef">"OMNI Option Sub-Type Values" (New Registry)</a>
        </h3>
<p id="section-25.7-1">The OMNI option defines a 5-bit Sub-Type field, for which IANA is
        instructed to create and maintain a new registry entitled "OMNI Option
        Sub-Type Values". Initial values are given below (registration
        procedure is RFC required):<a href="#section-25.7-1" class="pilcrow">¶</a></p>
<span id="name-omni-option-sub-type-values-2"></span><div id="omni-iana">
<figure id="figure-34">
          <div class="artwork art-text alignLeft" id="section-25.7-2.1">
<pre>   Value    Sub-Type name                  Reference
   -----    -------------                  ----------
   0        Pad1                           [RFCXXXX]
   1        PadN                           [RFCXXXX]
   2        Multilink Fwding Parameters    [RFCXXXX]
   3        Interface Attributes           [RFCXXXX]
   4        Traffic Selector               [RFCXXXX]
   5        Geo Coordinates                [RFCXXXX]
   6        DHCPv6 Message                 [RFCXXXX]
   7        HIP Message                    [RFCXXXX]
   8        PIM-SM Message                 [RFCXXXX]
   9        Reassembly Limit               [RFCXXXX]
   10       Fragmentation Report           [RFCXXXX]
   11       Node Identification            [RFCXXXX]
   12       ICMPv6 Error                   [RFCXXXX]
   13-29    Unassigned
   30       Sub-Type Extension             [RFCXXXX]
   31       Reserved by IANA               [RFCXXXX]
</pre>
</div>
<figcaption><a href="#figure-34" class="selfRef">Figure 34</a>:
<a href="#name-omni-option-sub-type-values-2" class="selfRef">OMNI Option Sub-Type Values</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="iana99">
<section id="section-25.8">
        <h3 id="name-omni-geo-coordinates-type-v">
<a href="#section-25.8" class="section-number selfRef">25.8. </a><a href="#name-omni-geo-coordinates-type-v" class="section-name selfRef">"OMNI Geo Coordinates Type Values" (New Registry)</a>
        </h3>
<p id="section-25.8-1">The OMNI Geo Coordinates sub-option (see: <a href="#sub7" class="xref">Section 12.2.6</a>)
        contains an 8-bit Type field, for which IANA is instructed to create
        and maintain a new registry entitled "OMNI Geo Coordinates Type
        Values". Initial values are given below (registration procedure is RFC
        required):<a href="#section-25.8-1" class="pilcrow">¶</a></p>
<span id="name-omni-geo-coordinates-type"></span><div id="omni-geo-type">
<figure id="figure-35">
          <div class="artwork art-text alignLeft" id="section-25.8-2.1">
<pre>   Value    Sub-Type name                  Reference
   -----    -------------                  ----------
   0        NULL                           [RFCXXXX]
   255      Reserved by IANA               [RFCXXXX]
</pre>
</div>
<figcaption><a href="#figure-35" class="selfRef">Figure 35</a>:
<a href="#name-omni-geo-coordinates-type" class="selfRef">OMNI Geo Coordinates Type</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="iana8">
<section id="section-25.9">
        <h3 id="name-omni-node-identification-id">
<a href="#section-25.9" class="section-number selfRef">25.9. </a><a href="#name-omni-node-identification-id" class="section-name selfRef">"OMNI Node Identification ID-Type Values" (New Registry)</a>
        </h3>
<p id="section-25.9-1">The OMNI Node Identification sub-option (see: <a href="#sub10" class="xref">Section 12.2.12</a>) contains an 8-bit ID-Type field, for which IANA is
        instructed to create and maintain a new registry entitled "OMNI Node
        Identification ID-Type Values". Initial values are given below
        (registration procedure is RFC required):<a href="#section-25.9-1" class="pilcrow">¶</a></p>
<span id="name-omni-node-identification-id-"></span><div id="omni-duid-en">
<figure id="figure-36">
          <div class="artwork art-text alignLeft" id="section-25.9-2.1">
<pre>   Value    Sub-Type name                  Reference
   -----    -------------                  ----------
   0        UUID                           [RFCXXXX]
   1        HIT                            [RFCXXXX]
   2        HHIT                           [RFCXXXX]
   3        Network Access Identifier      [RFCXXXX]
   4        FQDN                           [RFCXXXX]
   5        IPv6 Address                   [RFCXXXX]
   6-252    Unassigned                     [RFCXXXX]
   253-254  Reserved for Experimentation   [RFCXXXX]
   255      Reserved by IANA               [RFCXXXX]
</pre>
</div>
<figcaption><a href="#figure-36" class="selfRef">Figure 36</a>:
<a href="#name-omni-node-identification-id-" class="selfRef">OMNI Node Identification ID-Type Values</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="iana5">
<section id="section-25.10">
        <h3 id="name-omni-option-sub-type-extens">
<a href="#section-25.10" class="section-number selfRef">25.10. </a><a href="#name-omni-option-sub-type-extens" class="section-name selfRef">"OMNI Option Sub-Type Extension Values" (New Registry)</a>
        </h3>
<p id="section-25.10-1">The OMNI option defines an 8-bit Extension-Type field for Sub-Type
        30 (Sub-Type Extension), for which IANA is instructed to create and
        maintain a new registry entitled "OMNI Option Sub-Type Extension
        Values". Initial values are given below (registration procedure is RFC
        required):<a href="#section-25.10-1" class="pilcrow">¶</a></p>
<span id="name-omni-option-sub-type-extensi"></span><div id="omni-extensions">
<figure id="figure-37">
          <div class="artwork art-text alignLeft" id="section-25.10-2.1">
<pre>   Value    Sub-Type name                  Reference
   -----    -------------                  ----------
   0        RFC4380 UDP/IP Header Option   [RFCXXXX]
   1        RFC6081 UDP/IP Trailer Option  [RFCXXXX]
   2-252    Unassigned
   253-254  Reserved for Experimentation   [RFCXXXX]
   255      Reserved by IANA               [RFCXXXX]
</pre>
</div>
<figcaption><a href="#figure-37" class="selfRef">Figure 37</a>:
<a href="#name-omni-option-sub-type-extensi" class="selfRef">OMNI Option Sub-Type Extension Values</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="iana6">
<section id="section-25.11">
        <h3 id="name-omni-rfc4380-udp-ip-header-">
<a href="#section-25.11" class="section-number selfRef">25.11. </a><a href="#name-omni-rfc4380-udp-ip-header-" class="section-name selfRef">"OMNI RFC4380 UDP/IP Header Option" (New Registry)</a>
        </h3>
<p id="section-25.11-1">The OMNI Sub-Type Extension "RFC4380 UDP/IP Header Option" defines
        an 8-bit Header Type field, for which IANA is instructed to create and
        maintain a new registry entitled "OMNI RFC4380 UDP/IP Header Option".
        Initial registry values are given below (registration procedure is RFC
        required):<a href="#section-25.11-1" class="pilcrow">¶</a></p>
<span id="name-omni-rfc4380-udp-ip-header-o"></span><div id="rfc4380-header">
<figure id="figure-38">
          <div class="artwork art-text alignLeft" id="section-25.11-2.1">
<pre>   Value    Sub-Type name                  Reference
   -----    -------------                  ----------
   0        Origin Indication (IPv4)       [RFC4380]
   1        Authentication Encapsulation   [RFC4380]
   2        Origin Indication (IPv6)       [RFCXXXX]
   3-252    Unassigned
   253-254  Reserved for Experimentation   [RFCXXXX]
   255      Reserved by IANA               [RFCXXXX]
</pre>
</div>
<figcaption><a href="#figure-38" class="selfRef">Figure 38</a>:
<a href="#name-omni-rfc4380-udp-ip-header-o" class="selfRef">OMNI RFC4380 UDP/IP Header Option</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="iana7">
<section id="section-25.12">
        <h3 id="name-omni-rfc6081-udp-ip-trailer">
<a href="#section-25.12" class="section-number selfRef">25.12. </a><a href="#name-omni-rfc6081-udp-ip-trailer" class="section-name selfRef">"OMNI RFC6081 UDP/IP Trailer Option" (New Registry)</a>
        </h3>
<p id="section-25.12-1">The OMNI Sub-Type Extension for "RFC6081 UDP/IP Trailer Option"
        defines an 8-bit Trailer Type field, for which IANA is instructed to
        create and maintain a new registry entitled "OMNI RFC6081 UDP/IP
        Trailer Option". Initial registry values are given below (registration
        procedure is RFC required):<a href="#section-25.12-1" class="pilcrow">¶</a></p>
<span id="name-omni-rfc6081-trailer-option"></span><div id="rfc6081-trailer">
<figure id="figure-39">
          <div class="artwork art-text alignLeft" id="section-25.12-2.1">
<pre>   Value    Sub-Type name                  Reference
   -----    -------------                  ----------
   0        Unassigned
   1        Nonce                          [RFC6081]
   2        Unassigned
   3        Alternate Address (IPv4)       [RFC6081]
   4        Neighbor Discovery Option      [RFC6081]
   5        Random Port                    [RFC6081]
   6        Alternate Address (IPv6)       [RFCXXXX]
   7-252    Unassigned
   253-254  Reserved for Experimentation   [RFCXXXX]
   255      Reserved by IANA               [RFCXXXX]</pre>
</div>
<figcaption><a href="#figure-39" class="selfRef">Figure 39</a>:
<a href="#name-omni-rfc6081-trailer-option" class="selfRef">OMNI RFC6081 Trailer Option</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="iana9">
<section id="section-25.13">
        <h3 id="name-additional-considerations">
<a href="#section-25.13" class="section-number selfRef">25.13. </a><a href="#name-additional-considerations" class="section-name selfRef">Additional Considerations</a>
        </h3>
<p id="section-25.13-1">The IANA has assigned the UDP port number "8060" for an earlier
        experimental version of AERO <span>[<a href="#RFC6706" class="xref">RFC6706</a>]</span>. This document
        together with <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span> reclaims the UDP
        port number "8060" for 'aero' as the service port for UDP/IP
        encapsulation. (Note that, although <span>[<a href="#RFC6706" class="xref">RFC6706</a>]</span> was not
        widely implemented or deployed, any messages coded to that
        specification can be easily distinguished and ignored since they use
        an invalid ICMPv6 message type number '0'.) The IANA is therefore
        instructed to update the reference for UDP port number "8060" from
        "RFC6706" to "RFCXXXX" (i.e., this document).<a href="#section-25.13-1" class="pilcrow">¶</a></p>
<p id="section-25.13-2">The IANA has assigned a 4 octet Private Enterprise Number (PEN)
        code "45282" in the "enterprise-numbers" registry. This document is
        the normative reference for using this code in DHCP Unique IDentifiers
        based on Enterprise Numbers ("DUID-EN for OMNI Interfaces") (see:
        <a href="#node-id" class="xref">Section 11</a>). The IANA is therefore instructed to change
        the enterprise designation for PEN code "45282" from "LinkUp Networks"
        to "Overlay Multilink Network Interface (OMNI)".<a href="#section-25.13-2" class="pilcrow">¶</a></p>
<p id="section-25.13-3">The IANA has assigned the ifType code "301 - omni - Overlay
        Multilink Network Interface (OMNI)" in accordance with Section 6 of
        <span>[<a href="#RFC8892" class="xref">RFC8892</a>]</span>. The registration appears under the IANA
        "Structure of Management Information (SMI) Numbers (MIB Module
        Registrations) - Interface Types (ifType)" registry.<a href="#section-25.13-3" class="pilcrow">¶</a></p>
<p id="section-25.13-4">No further IANA actions are required.<a href="#section-25.13-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="secure">
<section id="section-26">
      <h2 id="name-security-considerations">
<a href="#section-26" class="section-number selfRef">26. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-26-1">Security considerations for IPv4 <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span>, IPv6 <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> and IPv6 Neighbor Discovery <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>
      apply. OMNI interface IPv6 ND messages SHOULD include Nonce and
      Timestamp options <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> when transaction confirmation
      and/or time synchronization is needed. (Note however that when OAL
      encapsulation is used the (echoed) OAL Identification value can provide
      sufficient transaction confirmation.)<a href="#section-26-1" class="pilcrow">¶</a></p>
<p id="section-26-2">Client OMNI interfaces configured over secured ANET interfaces
      inherit the physical and/or link-layer security properties (i.e.,
      "protected spectrum") of the connected ANETs. Client OMNI interfaces
      configured over open INET interfaces can use symmetric securing services
      such as VPNs or can by some other means establish a direct link. When a
      VPN or direct link may be impractical, however, the security services
      specified in <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span> and/or <span>[<a href="#RFC4380" class="xref">RFC4380</a>]</span>
      can be employed. While the OMNI link protects control plane messaging,
      applications must still employ end-to-end transport- or higher-layer
      security services to protect the data plane.<a href="#section-26-2" class="pilcrow">¶</a></p>
<p id="section-26-3">Strong network layer security for control plane messages and
      forwarding path integrity for data plane messages between Proxy/Servers
      MUST be supported. In one example, the AERO service <span>[<a href="#I-D.templin-6man-aero" class="xref">I-D.templin-6man-aero</a>]</span> constructs an SRT spanning tree with
      Proxy/Serves as leaf nodes and secures the spanning tree links with
      network layer security mechanisms such as IPsec <span>[<a href="#RFC4301" class="xref">RFC4301</a>]</span>
      or WireGuard. Secured control plane messages are then constrained to
      travel only over the secured spanning tree paths and are therefore
      protected from attack or eavesdropping. Other control and data plane
      messages can travel over route optimized paths that do not strictly
      follow the secured spanning tree, therefore end-to-end sessions should
      employ transport- or higher-layer security services. Additionally, the
      OAL Identification value can provide a first level of data origin
      authentication to mitigate off-path spoofing in some environments.<a href="#section-26-3" class="pilcrow">¶</a></p>
<p id="section-26-4">Identity-based key verification infrastructure services such as iPSK
      may be necessary for verifying the identities claimed by Clients. This
      requirement should be harmonized with the manner in which (H)HITs are
      attested in a given operational environment.<a href="#section-26-4" class="pilcrow">¶</a></p>
<p id="section-26-5">Security considerations for specific access network interface types
      are covered under the corresponding IP-over-(foo) specification (e.g.,
      <span>[<a href="#RFC2464" class="xref">RFC2464</a>]</span>, <span>[<a href="#RFC2492" class="xref">RFC2492</a>]</span>, etc.).<a href="#section-26-5" class="pilcrow">¶</a></p>
<p id="section-26-6">Security considerations for IPv6 fragmentation and reassembly are
      discussed in <a href="#fragsec" class="xref">Section 6.10</a>. In environments where spoofing is
      considered a threat, OMNI nodes SHOULD employ Identification window
      synchronization and OAL destinations SHOULD configure an
      (end-system-based) firewall.<a href="#section-26-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="imp">
<section id="section-27">
      <h2 id="name-implementation-status">
<a href="#section-27" class="section-number selfRef">27. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-27-1">AERO/OMNI Release-3.2 was tagged on March 30, 2021, and is undergoing
      internal testing. Additional internal releases expected within the
      coming months, with first public release expected end of 1H2021.<a href="#section-27-1" class="pilcrow">¶</a></p>
<p id="section-27-2">Many AERO/OMNI functions are implemented and undergoing final
      integration. OAL fragmentation/reassembly buffer management code has
      been cleared for public release and will be presented at the June 2021
      ICAO mobility subgroup meeting.<a href="#section-27-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="updates">
<section id="section-28">
      <h2 id="name-document-updates">
<a href="#section-28" class="section-number selfRef">28. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="section-28-1">This document does not itself update other RFCs, but suggests that
      the following could be updated through future IETF initiatives:<a href="#section-28-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-28-2.1">
          <span>[<a href="#RFC1191" class="xref">RFC1191</a>]</span><a href="#section-28-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-28-2.2">
          <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span><a href="#section-28-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-28-2.3">
          <span>[<a href="#RFC8201" class="xref">RFC8201</a>]</span><a href="#section-28-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-28-2.4">
          <span>[<a href="#RFC7526" class="xref">RFC7526</a>]</span><a href="#section-28-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-28-3">Updates can be through, e.g., standards action, the errata
      process, etc. as appropriate.<a href="#section-28-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ack">
<section id="section-29">
      <h2 id="name-acknowledgements">
<a href="#section-29" class="section-number selfRef">29. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-29-1">The first version of this document was prepared per the consensus
      decision at the 7th Conference of the International Civil Aviation
      Organization (ICAO) Working Group-I Mobility Subgroup on March 22, 2019.
      Consensus to take the document forward to the IETF was reached at the
      9th Conference of the Mobility Subgroup on November 22, 2019. Attendees
      and contributors included: Guray Acar, Danny Bharj, Francois
      D'Humieres, Pavel Drasil, Nikos Fistas, Giovanni Garofolo,
      Bernhard Haindl, Vaughn Maiolla, Tom McParland, Victor Moreno, Madhu
      Niraula, Brent Phillips, Liviu Popescu, Jacky Pouzet, Aloke Roy, Greg
      Saccone, Robert Segers, Michal Skorepa, Michel Solery, Stephane Tamalet,
      Fred Templin, Jean-Marc Vacher, Bela Varkonyi, Tony Whyman, Fryderyk
      Wrobel and Dongsong Zeng.<a href="#section-29-1" class="pilcrow">¶</a></p>
<p id="section-29-2">The following individuals are acknowledged for their useful comments:
      Stuart Card, Donald Eastlake, Michael Matyas, Robert Moskowitz, Madhu
      Niraula, Greg Saccone, Stephane Tamalet, Eduard Vasilenko, Eric Vyncke.
      Pavel Drasil, Zdenek Jaron and Michal Skorepa are especially recognized
      for their many helpful ideas and suggestions. Madhuri Madhava Badgandi,
      Sean Dickson, Don Dillenburg, Joe Dudkowski, Vijayasarathy Rajagopalan,
      Ron Sackman and Katherine Tran are acknowledged for their hard work on
      the implementation and technical insights that led to improvements for
      the spec.<a href="#section-29-2" class="pilcrow">¶</a></p>
<p id="section-29-3">Discussions on the IETF 6man and atn mailing lists during the fall of
      2020 suggested additional points to consider. The authors gratefully
      acknowledge the list members who contributed valuable insights through
      those discussions. Eric Vyncke and Erik Kline were the intarea ADs,
      while Bob Hinden and Ole Troan were the 6man WG chairs at the time the
      document was developed; they are all gratefully acknowledged for their
      many helpful insights. Many of the ideas in this document have further
      built on IETF experiences beginning in the 1990s, with insights from
      colleagues including Ron Bonica, Brian Carpenter, Ralph Droms, Christian
      Huitema, Thomas Narten, Dave Thaler, Joe Touch, and many others who
      deserve recognition.<a href="#section-29-3" class="pilcrow">¶</a></p>
<p id="section-29-4">Early observations on IP fragmentation performance implications were
      noted in the 1986 Digital Equipment Corporation (DEC) "qe reset"
      investigation, where fragment bursts from NFS UDP traffic triggered
      hardware resets resulting in communication failures. Jeff Chase, Fred
      Glover and Chet Juzsczak of the Ultrix Engineering Group led the
      investigation, and determined that setting a smaller NFS mount block
      size reduced the amount of fragmentation and suppressed the resets.
      Early observations on L2 media MTU issues were noted in the 1988 DEC
      FDDI investigation, where Raj Jain, KK Ramakrishnan and Kathy Wilde
      represented architectural considerations for FDDI networking in general
      including FDDI/Ethernet bridging. Jeff Mogul (who led the IETF Path MTU
      Discovery working group) and other DEC colleagues who supported these
      early investigations are also acknowledged.<a href="#section-29-4" class="pilcrow">¶</a></p>
<p id="section-29-5">Throughout the 1990's and into the 2000's, many colleagues supported
      and encouraged continuation of the work. Beginning with the DEC Project
      Sequoia effort at the University of California, Berkeley, then moving to
      the DEC research lab offices in Palo Alto CA, then to Sterling Software
      at the NASA Ames Research Center, then to SRI in Menlo Park, CA, then to
      Nokia in Mountain View, CA and finally to the Boeing Company in 2005 the
      work saw continuous advancement through the encouragement of many. Those
      who offered their support and encouragement are gratefully
      acknowledged.<a href="#section-29-5" class="pilcrow">¶</a></p>
<p id="section-29-6">This work is aligned with the NASA Safe Autonomous Systems Operation
      (SASO) program under NASA contract number NNA16BD84C.<a href="#section-29-6" class="pilcrow">¶</a></p>
<p id="section-29-7">This work is aligned with the FAA as per the SE2025 contract number
      DTFAWA-15-D-00030.<a href="#section-29-7" class="pilcrow">¶</a></p>
<p id="section-29-8">This work is aligned with the Boeing Information Technology (BIT)
      Mobility Vision Lab (MVL) program.<a href="#section-29-8" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-30">
      <h2 id="name-references">
<a href="#section-30" class="section-number selfRef">30. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-30.1">
        <h3 id="name-normative-references">
<a href="#section-30.1" class="section-number selfRef">30.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC0791">[RFC0791]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 791</span>, <span class="seriesInfo">DOI 10.17487/RFC0791</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2474">[RFC2474]</dt>
        <dd>
<span class="refAuthor">Nichols, K.</span>, <span class="refAuthor">Blake, S.</span>, <span class="refAuthor">Baker, F.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers"</span>, <span class="seriesInfo">RFC 2474</span>, <span class="seriesInfo">DOI 10.17487/RFC2474</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2474">https://www.rfc-editor.org/info/rfc2474</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3971">[RFC3971]</dt>
        <dd>
<span class="refAuthor">Arkko, J., Ed.</span>, <span class="refAuthor">Kempf, J.</span>, <span class="refAuthor">Zill, B.</span>, and <span class="refAuthor">P. Nikander</span>, <span class="refTitle">"SEcure Neighbor Discovery (SEND)"</span>, <span class="seriesInfo">RFC 3971</span>, <span class="seriesInfo">DOI 10.17487/RFC3971</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3971">https://www.rfc-editor.org/info/rfc3971</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4191">[RFC4191]</dt>
        <dd>
<span class="refAuthor">Draves, R.</span> and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Default Router Preferences and More-Specific Routes"</span>, <span class="seriesInfo">RFC 4191</span>, <span class="seriesInfo">DOI 10.17487/RFC4191</span>, <time datetime="2005-11" class="refDate">November 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4191">https://www.rfc-editor.org/info/rfc4191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4193">[RFC4193]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">B. Haberman</span>, <span class="refTitle">"Unique Local IPv6 Unicast Addresses"</span>, <span class="seriesInfo">RFC 4193</span>, <span class="seriesInfo">DOI 10.17487/RFC4193</span>, <time datetime="2005-10" class="refDate">October 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4193">https://www.rfc-editor.org/info/rfc4193</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
        <dd>
<span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span class="seriesInfo">DOI 10.17487/RFC4443</span>, <time datetime="2006-03" class="refDate">March 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4727">[RFC4727]</dt>
        <dd>
<span class="refAuthor">Fenner, B.</span>, <span class="refTitle">"Experimental Values In IPv4, IPv6, ICMPv4, ICMPv6, UDP, and TCP Headers"</span>, <span class="seriesInfo">RFC 4727</span>, <span class="seriesInfo">DOI 10.17487/RFC4727</span>, <time datetime="2006-11" class="refDate">November 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4727">https://www.rfc-editor.org/info/rfc4727</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4861">[RFC4861]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6088">[RFC6088]</dt>
        <dd>
<span class="refAuthor">Tsirtsis, G.</span>, <span class="refAuthor">Giarreta, G.</span>, <span class="refAuthor">Soliman, H.</span>, and <span class="refAuthor">N. Montavont</span>, <span class="refTitle">"Traffic Selectors for Flow Bindings"</span>, <span class="seriesInfo">RFC 6088</span>, <span class="seriesInfo">DOI 10.17487/RFC6088</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6088">https://www.rfc-editor.org/info/rfc6088</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8028">[RFC8028]</dt>
        <dd>
<span class="refAuthor">Baker, F.</span> and <span class="refAuthor">B. Carpenter</span>, <span class="refTitle">"First-Hop Router Selection by Hosts in a Multi-Prefix Network"</span>, <span class="seriesInfo">RFC 8028</span>, <span class="seriesInfo">DOI 10.17487/RFC8028</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8028">https://www.rfc-editor.org/info/rfc8028</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8201">[RFC8201]</dt>
        <dd>
<span class="refAuthor">McCann, J.</span>, <span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Mogul, J.</span>, and <span class="refAuthor">R. Hinden, Ed.</span>, <span class="refTitle">"Path MTU Discovery for IP version 6"</span>, <span class="seriesInfo">STD 87</span>, <span class="seriesInfo">RFC 8201</span>, <span class="seriesInfo">DOI 10.17487/RFC8201</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8201">https://www.rfc-editor.org/info/rfc8201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8415">[RFC8415]</dt>
      <dd>
<span class="refAuthor">Mrugalski, T.</span>, <span class="refAuthor">Siodelski, M.</span>, <span class="refAuthor">Volz, B.</span>, <span class="refAuthor">Yourtchenko, A.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Jiang, S.</span>, <span class="refAuthor">Lemon, T.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 8415</span>, <span class="seriesInfo">DOI 10.17487/RFC8415</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8415">https://www.rfc-editor.org/info/rfc8415</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-30.2">
        <h3 id="name-informative-references">
<a href="#section-30.2" class="section-number selfRef">30.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ATN">[ATN]</dt>
        <dd>
<span class="refAuthor">Maiolla, V.</span>, <span class="refTitle">"The OMNI Interface - An IPv6 Air/Ground Interface for Civil Aviation, IETF Liaison Statement #1676, https://datatracker.ietf.org/liaison/1676/"</span>, <time datetime="2020-03-03" class="refDate">3 March 2020</time>. </dd>
<dd class="break"></dd>
<dt id="ATN-IPS">[ATN-IPS]</dt>
        <dd>
<span class="refAuthor">WG-I, ICAO.</span>, <span class="refTitle">"ICAO Document 9896 (Manual on the Aeronautical Telecommunication Network (ATN) using Internet Protocol Suite (IPS) Standards and Protocol), Draft Edition 3 (work-in-progress)"</span>, <time datetime="2020-12-10" class="refDate">10 December 2020</time>. </dd>
<dd class="break"></dd>
<dt id="CKSUM">[CKSUM]</dt>
        <dd>
<span class="refAuthor">Stone, J.</span>, <span class="refAuthor">Greenwald, M.</span>, <span class="refAuthor">Partridge, C.</span>, and <span class="refAuthor">J. Hughes</span>, <span class="refTitle">"Performance of Checksums and CRC's Over Real Data, IEEE/ACM Transactions on Networking, Vol. 6, No. 5"</span>, <time datetime="1998-10" class="refDate">October 1998</time>. </dd>
<dd class="break"></dd>
<dt id="CRC">[CRC]</dt>
        <dd>
<span class="refAuthor">Jain, R.</span>, <span class="refTitle">"Error Characteristics of Fiber Distributed Data Interface (FDDI), IEEE Transactions on Communications"</span>, <time datetime="1990-08" class="refDate">August 1990</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-drip-rid">[I-D.ietf-drip-rid]</dt>
        <dd>
<span class="refAuthor">Moskowitz, R.</span>, <span class="refAuthor">Card, S. W.</span>, <span class="refAuthor">Wiethuechter, A.</span>, and <span class="refAuthor">A. Gurtov</span>, <span class="refTitle">"Unmanned Aircraft System Remote Identification (UAS RID)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-drip-rid-08</span>, <time datetime="2021-07-25" class="refDate">25 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-drip-rid-08.txt">https://www.ietf.org/archive/id/draft-ietf-drip-rid-08.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-intarea-tunnels">[I-D.ietf-intarea-tunnels]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span> and <span class="refAuthor">M. Townsley</span>, <span class="refTitle">"IP Tunnels in the Internet Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-intarea-tunnels-10</span>, <time datetime="2019-09-12" class="refDate">12 September 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-intarea-tunnels-10.txt">https://www.ietf.org/archive/id/draft-ietf-intarea-tunnels-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ipwave-vehicular-networking">[I-D.ietf-ipwave-vehicular-networking]</dt>
        <dd>
<span class="refAuthor">(editor), J. (. J.</span>, <span class="refTitle">"IPv6 Wireless Access in Vehicular Environments (IPWAVE): Problem Statement and Use Cases"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ipwave-vehicular-networking-20</span>, <time datetime="2021-03-18" class="refDate">18 March 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ipwave-vehicular-networking-20.txt">https://www.ietf.org/archive/id/draft-ietf-ipwave-vehicular-networking-20.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tsvwg-udp-options">[I-D.ietf-tsvwg-udp-options]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Transport Options for UDP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tsvwg-udp-options-13</span>, <time datetime="2021-06-19" class="refDate">19 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-tsvwg-udp-options-13.txt">https://www.ietf.org/archive/id/draft-ietf-tsvwg-udp-options-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.templin-6man-aero">[I-D.templin-6man-aero]</dt>
        <dd>
<span class="refAuthor">Templin, F. L.</span>, <span class="refTitle">"Automatic Extended Route Optimization (AERO)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-templin-6man-aero-22</span>, <time datetime="2021-07-02" class="refDate">2 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-templin-6man-aero-22.txt">https://www.ietf.org/archive/id/draft-templin-6man-aero-22.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.templin-6man-lla-type">[I-D.templin-6man-lla-type]</dt>
        <dd>
<span class="refAuthor">Templin, F. L.</span>, <span class="refTitle">"The IPv6 Link-Local Address Type Field"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-templin-6man-lla-type-02</span>, <time datetime="2020-11-23" class="refDate">23 November 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-templin-6man-lla-type-02.txt">https://www.ietf.org/archive/id/draft-templin-6man-lla-type-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.templin-6man-omni-interface">[I-D.templin-6man-omni-interface]</dt>
        <dd>
<span class="refAuthor">Templin, F. L.</span> and <span class="refAuthor">T. Whyman</span>, <span class="refTitle">"Transmission of IP Packets over Overlay Multilink Network (OMNI) Interfaces"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-templin-6man-omni-interface-99</span>, <time datetime="2021-03-24" class="refDate">24 March 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-templin-6man-omni-interface-99.txt">https://www.ietf.org/archive/id/draft-templin-6man-omni-interface-99.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IPV4-GUA">[IPV4-GUA]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"IPv4 Address Space Registry, https://www.iana.org/assignments/ipv4-address-space/ipv4-address-space.xhtml"</span>, <time datetime="2020-12-14" class="refDate">14 December 2020</time>. </dd>
<dd class="break"></dd>
<dt id="IPV6-GUA">[IPV6-GUA]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"IPv6 Global Unicast Address Assignments, https://www.iana.org/assignments/ipv6-unicast-address-assignments/ipv6-unicast-address-assignments.xhtml"</span>, <time datetime="2020-12-14" class="refDate">14 December 2020</time>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1122">[RFC1122]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1122">https://www.rfc-editor.org/info/rfc1122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1146">[RFC1146]</dt>
        <dd>
<span class="refAuthor">Zweig, J.</span> and <span class="refAuthor">C. Partridge</span>, <span class="refTitle">"TCP alternate checksum options"</span>, <span class="seriesInfo">RFC 1146</span>, <span class="seriesInfo">DOI 10.17487/RFC1146</span>, <time datetime="1990-03" class="refDate">March 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1146">https://www.rfc-editor.org/info/rfc1146</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1191">[RFC1191]</dt>
        <dd>
<span class="refAuthor">Mogul, J.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Path MTU discovery"</span>, <span class="seriesInfo">RFC 1191</span>, <span class="seriesInfo">DOI 10.17487/RFC1191</span>, <time datetime="1990-11" class="refDate">November 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1191">https://www.rfc-editor.org/info/rfc1191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1256">[RFC1256]</dt>
        <dd>
<span class="refAuthor">Deering, S., Ed.</span>, <span class="refTitle">"ICMP Router Discovery Messages"</span>, <span class="seriesInfo">RFC 1256</span>, <span class="seriesInfo">DOI 10.17487/RFC1256</span>, <time datetime="1991-09" class="refDate">September 1991</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1256">https://www.rfc-editor.org/info/rfc1256</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2131">[RFC2131]</dt>
        <dd>
<span class="refAuthor">Droms, R.</span>, <span class="refTitle">"Dynamic Host Configuration Protocol"</span>, <span class="seriesInfo">RFC 2131</span>, <span class="seriesInfo">DOI 10.17487/RFC2131</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2131">https://www.rfc-editor.org/info/rfc2131</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2225">[RFC2225]</dt>
        <dd>
<span class="refAuthor">Laubach, M.</span> and <span class="refAuthor">J. Halpern</span>, <span class="refTitle">"Classical IP and ARP over ATM"</span>, <span class="seriesInfo">RFC 2225</span>, <span class="seriesInfo">DOI 10.17487/RFC2225</span>, <time datetime="1998-04" class="refDate">April 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2225">https://www.rfc-editor.org/info/rfc2225</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2464">[RFC2464]</dt>
        <dd>
<span class="refAuthor">Crawford, M.</span>, <span class="refTitle">"Transmission of IPv6 Packets over Ethernet Networks"</span>, <span class="seriesInfo">RFC 2464</span>, <span class="seriesInfo">DOI 10.17487/RFC2464</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2464">https://www.rfc-editor.org/info/rfc2464</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2473">[RFC2473]</dt>
        <dd>
<span class="refAuthor">Conta, A.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Generic Packet Tunneling in IPv6 Specification"</span>, <span class="seriesInfo">RFC 2473</span>, <span class="seriesInfo">DOI 10.17487/RFC2473</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2473">https://www.rfc-editor.org/info/rfc2473</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2492">[RFC2492]</dt>
        <dd>
<span class="refAuthor">Armitage, G.</span>, <span class="refAuthor">Schulter, P.</span>, and <span class="refAuthor">M. Jork</span>, <span class="refTitle">"IPv6 over ATM Networks"</span>, <span class="seriesInfo">RFC 2492</span>, <span class="seriesInfo">DOI 10.17487/RFC2492</span>, <time datetime="1999-01" class="refDate">January 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2492">https://www.rfc-editor.org/info/rfc2492</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2526">[RFC2526]</dt>
        <dd>
<span class="refAuthor">Johnson, D.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Reserved IPv6 Subnet Anycast Addresses"</span>, <span class="seriesInfo">RFC 2526</span>, <span class="seriesInfo">DOI 10.17487/RFC2526</span>, <time datetime="1999-03" class="refDate">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2526">https://www.rfc-editor.org/info/rfc2526</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2529">[RFC2529]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">C. Jung</span>, <span class="refTitle">"Transmission of IPv6 over IPv4 Domains without Explicit Tunnels"</span>, <span class="seriesInfo">RFC 2529</span>, <span class="seriesInfo">DOI 10.17487/RFC2529</span>, <time datetime="1999-03" class="refDate">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2529">https://www.rfc-editor.org/info/rfc2529</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2863">[RFC2863]</dt>
        <dd>
<span class="refAuthor">McCloghrie, K.</span> and <span class="refAuthor">F. Kastenholz</span>, <span class="refTitle">"The Interfaces Group MIB"</span>, <span class="seriesInfo">RFC 2863</span>, <span class="seriesInfo">DOI 10.17487/RFC2863</span>, <time datetime="2000-06" class="refDate">June 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2863">https://www.rfc-editor.org/info/rfc2863</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2923">[RFC2923]</dt>
        <dd>
<span class="refAuthor">Lahey, K.</span>, <span class="refTitle">"TCP Problems with Path MTU Discovery"</span>, <span class="seriesInfo">RFC 2923</span>, <span class="seriesInfo">DOI 10.17487/RFC2923</span>, <time datetime="2000-09" class="refDate">September 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2923">https://www.rfc-editor.org/info/rfc2923</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2983">[RFC2983]</dt>
        <dd>
<span class="refAuthor">Black, D.</span>, <span class="refTitle">"Differentiated Services and Tunnels"</span>, <span class="seriesInfo">RFC 2983</span>, <span class="seriesInfo">DOI 10.17487/RFC2983</span>, <time datetime="2000-10" class="refDate">October 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2983">https://www.rfc-editor.org/info/rfc2983</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3056">[RFC3056]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">K. Moore</span>, <span class="refTitle">"Connection of IPv6 Domains via IPv4 Clouds"</span>, <span class="seriesInfo">RFC 3056</span>, <span class="seriesInfo">DOI 10.17487/RFC3056</span>, <time datetime="2001-02" class="refDate">February 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3056">https://www.rfc-editor.org/info/rfc3056</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3168">[RFC3168]</dt>
        <dd>
<span class="refAuthor">Ramakrishnan, K.</span>, <span class="refAuthor">Floyd, S.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"The Addition of Explicit Congestion Notification (ECN) to IP"</span>, <span class="seriesInfo">RFC 3168</span>, <span class="seriesInfo">DOI 10.17487/RFC3168</span>, <time datetime="2001-09" class="refDate">September 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3168">https://www.rfc-editor.org/info/rfc3168</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3330">[RFC3330]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Special-Use IPv4 Addresses"</span>, <span class="seriesInfo">RFC 3330</span>, <span class="seriesInfo">DOI 10.17487/RFC3330</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3330">https://www.rfc-editor.org/info/rfc3330</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3366">[RFC3366]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span> and <span class="refAuthor">L. Wood</span>, <span class="refTitle">"Advice to link designers on link Automatic Repeat reQuest (ARQ)"</span>, <span class="seriesInfo">BCP 62</span>, <span class="seriesInfo">RFC 3366</span>, <span class="seriesInfo">DOI 10.17487/RFC3366</span>, <time datetime="2002-08" class="refDate">August 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3366">https://www.rfc-editor.org/info/rfc3366</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3692">[RFC3692]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refTitle">"Assigning Experimental and Testing Numbers Considered Useful"</span>, <span class="seriesInfo">BCP 82</span>, <span class="seriesInfo">RFC 3692</span>, <span class="seriesInfo">DOI 10.17487/RFC3692</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3692">https://www.rfc-editor.org/info/rfc3692</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3810">[RFC3810]</dt>
        <dd>
<span class="refAuthor">Vida, R., Ed.</span> and <span class="refAuthor">L. Costa, Ed.</span>, <span class="refTitle">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</span>, <span class="seriesInfo">RFC 3810</span>, <span class="seriesInfo">DOI 10.17487/RFC3810</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3810">https://www.rfc-editor.org/info/rfc3810</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3819">[RFC3819]</dt>
        <dd>
<span class="refAuthor">Karn, P., Ed.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Fairhurst, G.</span>, <span class="refAuthor">Grossman, D.</span>, <span class="refAuthor">Ludwig, R.</span>, <span class="refAuthor">Mahdavi, J.</span>, <span class="refAuthor">Montenegro, G.</span>, <span class="refAuthor">Touch, J.</span>, and <span class="refAuthor">L. Wood</span>, <span class="refTitle">"Advice for Internet Subnetwork Designers"</span>, <span class="seriesInfo">BCP 89</span>, <span class="seriesInfo">RFC 3819</span>, <span class="seriesInfo">DOI 10.17487/RFC3819</span>, <time datetime="2004-07" class="refDate">July 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3819">https://www.rfc-editor.org/info/rfc3819</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3879">[RFC3879]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span> and <span class="refAuthor">B. Carpenter</span>, <span class="refTitle">"Deprecating Site Local Addresses"</span>, <span class="seriesInfo">RFC 3879</span>, <span class="seriesInfo">DOI 10.17487/RFC3879</span>, <time datetime="2004-09" class="refDate">September 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3879">https://www.rfc-editor.org/info/rfc3879</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4122">[RFC4122]</dt>
        <dd>
<span class="refAuthor">Leach, P.</span>, <span class="refAuthor">Mealling, M.</span>, and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"A Universally Unique IDentifier (UUID) URN Namespace"</span>, <span class="seriesInfo">RFC 4122</span>, <span class="seriesInfo">DOI 10.17487/RFC4122</span>, <time datetime="2005-07" class="refDate">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4122">https://www.rfc-editor.org/info/rfc4122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4301">[RFC4301]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4380">[RFC4380]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refTitle">"Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs)"</span>, <span class="seriesInfo">RFC 4380</span>, <span class="seriesInfo">DOI 10.17487/RFC4380</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4380">https://www.rfc-editor.org/info/rfc4380</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4389">[RFC4389]</dt>
        <dd>
<span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Talwar, M.</span>, and <span class="refAuthor">C. Patel</span>, <span class="refTitle">"Neighbor Discovery Proxies (ND Proxy)"</span>, <span class="seriesInfo">RFC 4389</span>, <span class="seriesInfo">DOI 10.17487/RFC4389</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4389">https://www.rfc-editor.org/info/rfc4389</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4429">[RFC4429]</dt>
        <dd>
<span class="refAuthor">Moore, N.</span>, <span class="refTitle">"Optimistic Duplicate Address Detection (DAD) for IPv6"</span>, <span class="seriesInfo">RFC 4429</span>, <span class="seriesInfo">DOI 10.17487/RFC4429</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4429">https://www.rfc-editor.org/info/rfc4429</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4541">[RFC4541]</dt>
        <dd>
<span class="refAuthor">Christensen, M.</span>, <span class="refAuthor">Kimball, K.</span>, and <span class="refAuthor">F. Solensky</span>, <span class="refTitle">"Considerations for Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) Snooping Switches"</span>, <span class="seriesInfo">RFC 4541</span>, <span class="seriesInfo">DOI 10.17487/RFC4541</span>, <time datetime="2006-05" class="refDate">May 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4541">https://www.rfc-editor.org/info/rfc4541</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4605">[RFC4605]</dt>
        <dd>
<span class="refAuthor">Fenner, B.</span>, <span class="refAuthor">He, H.</span>, <span class="refAuthor">Haberman, B.</span>, and <span class="refAuthor">H. Sandick</span>, <span class="refTitle">"Internet Group Management Protocol (IGMP) / Multicast Listener Discovery (MLD)-Based Multicast Forwarding ("IGMP/MLD Proxying")"</span>, <span class="seriesInfo">RFC 4605</span>, <span class="seriesInfo">DOI 10.17487/RFC4605</span>, <time datetime="2006-08" class="refDate">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4605">https://www.rfc-editor.org/info/rfc4605</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4821">[RFC4821]</dt>
        <dd>
<span class="refAuthor">Mathis, M.</span> and <span class="refAuthor">J. Heffner</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery"</span>, <span class="seriesInfo">RFC 4821</span>, <span class="seriesInfo">DOI 10.17487/RFC4821</span>, <time datetime="2007-03" class="refDate">March 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4821">https://www.rfc-editor.org/info/rfc4821</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4963">[RFC4963]</dt>
        <dd>
<span class="refAuthor">Heffner, J.</span>, <span class="refAuthor">Mathis, M.</span>, and <span class="refAuthor">B. Chandler</span>, <span class="refTitle">"IPv4 Reassembly Errors at High Data Rates"</span>, <span class="seriesInfo">RFC 4963</span>, <span class="seriesInfo">DOI 10.17487/RFC4963</span>, <time datetime="2007-07" class="refDate">July 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4963">https://www.rfc-editor.org/info/rfc4963</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5175">[RFC5175]</dt>
        <dd>
<span class="refAuthor">Haberman, B., Ed.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"IPv6 Router Advertisement Flags Option"</span>, <span class="seriesInfo">RFC 5175</span>, <span class="seriesInfo">DOI 10.17487/RFC5175</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5175">https://www.rfc-editor.org/info/rfc5175</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5213">[RFC5213]</dt>
        <dd>
<span class="refAuthor">Gundavelli, S., Ed.</span>, <span class="refAuthor">Leung, K.</span>, <span class="refAuthor">Devarapalli, V.</span>, <span class="refAuthor">Chowdhury, K.</span>, and <span class="refAuthor">B. Patil</span>, <span class="refTitle">"Proxy Mobile IPv6"</span>, <span class="seriesInfo">RFC 5213</span>, <span class="seriesInfo">DOI 10.17487/RFC5213</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5213">https://www.rfc-editor.org/info/rfc5213</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5214">[RFC5214]</dt>
        <dd>
<span class="refAuthor">Templin, F.</span>, <span class="refAuthor">Gleeson, T.</span>, and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)"</span>, <span class="seriesInfo">RFC 5214</span>, <span class="seriesInfo">DOI 10.17487/RFC5214</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5214">https://www.rfc-editor.org/info/rfc5214</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5237">[RFC5237]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span> and <span class="refAuthor">S. Bradner</span>, <span class="refTitle">"IANA Allocation Guidelines for the Protocol Field"</span>, <span class="seriesInfo">BCP 37</span>, <span class="seriesInfo">RFC 5237</span>, <span class="seriesInfo">DOI 10.17487/RFC5237</span>, <time datetime="2008-02" class="refDate">February 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5237">https://www.rfc-editor.org/info/rfc5237</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5558">[RFC5558]</dt>
        <dd>
<span class="refAuthor">Templin, F., Ed.</span>, <span class="refTitle">"Virtual Enterprise Traversal (VET)"</span>, <span class="seriesInfo">RFC 5558</span>, <span class="seriesInfo">DOI 10.17487/RFC5558</span>, <time datetime="2010-02" class="refDate">February 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5558">https://www.rfc-editor.org/info/rfc5558</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5798">[RFC5798]</dt>
        <dd>
<span class="refAuthor">Nadas, S., Ed.</span>, <span class="refTitle">"Virtual Router Redundancy Protocol (VRRP) Version 3 for IPv4 and IPv6"</span>, <span class="seriesInfo">RFC 5798</span>, <span class="seriesInfo">DOI 10.17487/RFC5798</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5798">https://www.rfc-editor.org/info/rfc5798</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5880">[RFC5880]</dt>
        <dd>
<span class="refAuthor">Katz, D.</span> and <span class="refAuthor">D. Ward</span>, <span class="refTitle">"Bidirectional Forwarding Detection (BFD)"</span>, <span class="seriesInfo">RFC 5880</span>, <span class="seriesInfo">DOI 10.17487/RFC5880</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5880">https://www.rfc-editor.org/info/rfc5880</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6081">[RFC6081]</dt>
        <dd>
<span class="refAuthor">Thaler, D.</span>, <span class="refTitle">"Teredo Extensions"</span>, <span class="seriesInfo">RFC 6081</span>, <span class="seriesInfo">DOI 10.17487/RFC6081</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6081">https://www.rfc-editor.org/info/rfc6081</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6221">[RFC6221]</dt>
        <dd>
<span class="refAuthor">Miles, D., Ed.</span>, <span class="refAuthor">Ooghe, S.</span>, <span class="refAuthor">Dec, W.</span>, <span class="refAuthor">Krishnan, S.</span>, and <span class="refAuthor">A. Kavanagh</span>, <span class="refTitle">"Lightweight DHCPv6 Relay Agent"</span>, <span class="seriesInfo">RFC 6221</span>, <span class="seriesInfo">DOI 10.17487/RFC6221</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6221">https://www.rfc-editor.org/info/rfc6221</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6247">[RFC6247]</dt>
        <dd>
<span class="refAuthor">Eggert, L.</span>, <span class="refTitle">"Moving the Undeployed TCP Extensions RFC 1072, RFC 1106, RFC 1110, RFC 1145, RFC 1146, RFC 1379, RFC 1644, and RFC 1693 to Historic Status"</span>, <span class="seriesInfo">RFC 6247</span>, <span class="seriesInfo">DOI 10.17487/RFC6247</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6247">https://www.rfc-editor.org/info/rfc6247</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6355">[RFC6355]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span> and <span class="refAuthor">J. Johnson</span>, <span class="refTitle">"Definition of the UUID-Based DHCPv6 Unique Identifier (DUID-UUID)"</span>, <span class="seriesInfo">RFC 6355</span>, <span class="seriesInfo">DOI 10.17487/RFC6355</span>, <time datetime="2011-08" class="refDate">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6355">https://www.rfc-editor.org/info/rfc6355</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6438">[RFC6438]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">S. Amante</span>, <span class="refTitle">"Using the IPv6 Flow Label for Equal Cost Multipath Routing and Link Aggregation in Tunnels"</span>, <span class="seriesInfo">RFC 6438</span>, <span class="seriesInfo">DOI 10.17487/RFC6438</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6438">https://www.rfc-editor.org/info/rfc6438</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6543">[RFC6543]</dt>
        <dd>
<span class="refAuthor">Gundavelli, S.</span>, <span class="refTitle">"Reserved IPv6 Interface Identifier for Proxy Mobile IPv6"</span>, <span class="seriesInfo">RFC 6543</span>, <span class="seriesInfo">DOI 10.17487/RFC6543</span>, <time datetime="2012-05" class="refDate">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6543">https://www.rfc-editor.org/info/rfc6543</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6706">[RFC6706]</dt>
        <dd>
<span class="refAuthor">Templin, F., Ed.</span>, <span class="refTitle">"Asymmetric Extended Route Optimization (AERO)"</span>, <span class="seriesInfo">RFC 6706</span>, <span class="seriesInfo">DOI 10.17487/RFC6706</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6706">https://www.rfc-editor.org/info/rfc6706</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6935">[RFC6935]</dt>
        <dd>
<span class="refAuthor">Eubanks, M.</span>, <span class="refAuthor">Chimento, P.</span>, and <span class="refAuthor">M. Westerlund</span>, <span class="refTitle">"IPv6 and UDP Checksums for Tunneled Packets"</span>, <span class="seriesInfo">RFC 6935</span>, <span class="seriesInfo">DOI 10.17487/RFC6935</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6935">https://www.rfc-editor.org/info/rfc6935</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6936">[RFC6936]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span> and <span class="refAuthor">M. Westerlund</span>, <span class="refTitle">"Applicability Statement for the Use of IPv6 UDP Datagrams with Zero Checksums"</span>, <span class="seriesInfo">RFC 6936</span>, <span class="seriesInfo">DOI 10.17487/RFC6936</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6936">https://www.rfc-editor.org/info/rfc6936</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6980">[RFC6980]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Security Implications of IPv6 Fragmentation with IPv6 Neighbor Discovery"</span>, <span class="seriesInfo">RFC 6980</span>, <span class="seriesInfo">DOI 10.17487/RFC6980</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6980">https://www.rfc-editor.org/info/rfc6980</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7042">[RFC7042]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">J. Abley</span>, <span class="refTitle">"IANA Considerations and IETF Protocol and Documentation Usage for IEEE 802 Parameters"</span>, <span class="seriesInfo">BCP 141</span>, <span class="seriesInfo">RFC 7042</span>, <span class="seriesInfo">DOI 10.17487/RFC7042</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7042">https://www.rfc-editor.org/info/rfc7042</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7084">[RFC7084]</dt>
        <dd>
<span class="refAuthor">Singh, H.</span>, <span class="refAuthor">Beebee, W.</span>, <span class="refAuthor">Donley, C.</span>, and <span class="refAuthor">B. Stark</span>, <span class="refTitle">"Basic Requirements for IPv6 Customer Edge Routers"</span>, <span class="seriesInfo">RFC 7084</span>, <span class="seriesInfo">DOI 10.17487/RFC7084</span>, <time datetime="2013-11" class="refDate">November 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7084">https://www.rfc-editor.org/info/rfc7084</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7094">[RFC7094]</dt>
        <dd>
<span class="refAuthor">McPherson, D.</span>, <span class="refAuthor">Oran, D.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">E. Osterweil</span>, <span class="refTitle">"Architectural Considerations of IP Anycast"</span>, <span class="seriesInfo">RFC 7094</span>, <span class="seriesInfo">DOI 10.17487/RFC7094</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7094">https://www.rfc-editor.org/info/rfc7094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7323">[RFC7323]</dt>
        <dd>
<span class="refAuthor">Borman, D.</span>, <span class="refAuthor">Braden, B.</span>, <span class="refAuthor">Jacobson, V.</span>, and <span class="refAuthor">R. Scheffenegger, Ed.</span>, <span class="refTitle">"TCP Extensions for High Performance"</span>, <span class="seriesInfo">RFC 7323</span>, <span class="seriesInfo">DOI 10.17487/RFC7323</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7323">https://www.rfc-editor.org/info/rfc7323</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7401">[RFC7401]</dt>
        <dd>
<span class="refAuthor">Moskowitz, R., Ed.</span>, <span class="refAuthor">Heer, T.</span>, <span class="refAuthor">Jokela, P.</span>, and <span class="refAuthor">T. Henderson</span>, <span class="refTitle">"Host Identity Protocol Version 2 (HIPv2)"</span>, <span class="seriesInfo">RFC 7401</span>, <span class="seriesInfo">DOI 10.17487/RFC7401</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7401">https://www.rfc-editor.org/info/rfc7401</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7421">[RFC7421]</dt>
        <dd>
<span class="refAuthor">Carpenter, B., Ed.</span>, <span class="refAuthor">Chown, T.</span>, <span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Jiang, S.</span>, <span class="refAuthor">Petrescu, A.</span>, and <span class="refAuthor">A. Yourtchenko</span>, <span class="refTitle">"Analysis of the 64-bit Boundary in IPv6 Addressing"</span>, <span class="seriesInfo">RFC 7421</span>, <span class="seriesInfo">DOI 10.17487/RFC7421</span>, <time datetime="2015-01" class="refDate">January 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7421">https://www.rfc-editor.org/info/rfc7421</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7526">[RFC7526]</dt>
        <dd>
<span class="refAuthor">Troan, O.</span> and <span class="refAuthor">B. Carpenter, Ed.</span>, <span class="refTitle">"Deprecating the Anycast Prefix for 6to4 Relay Routers"</span>, <span class="seriesInfo">BCP 196</span>, <span class="seriesInfo">RFC 7526</span>, <span class="seriesInfo">DOI 10.17487/RFC7526</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7526">https://www.rfc-editor.org/info/rfc7526</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7542">[RFC7542]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"The Network Access Identifier"</span>, <span class="seriesInfo">RFC 7542</span>, <span class="seriesInfo">DOI 10.17487/RFC7542</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7542">https://www.rfc-editor.org/info/rfc7542</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7739">[RFC7739]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Security Implications of Predictable Fragment Identification Values"</span>, <span class="seriesInfo">RFC 7739</span>, <span class="seriesInfo">DOI 10.17487/RFC7739</span>, <time datetime="2016-02" class="refDate">February 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7739">https://www.rfc-editor.org/info/rfc7739</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7761">[RFC7761]</dt>
        <dd>
<span class="refAuthor">Fenner, B.</span>, <span class="refAuthor">Handley, M.</span>, <span class="refAuthor">Holbrook, H.</span>, <span class="refAuthor">Kouvelas, I.</span>, <span class="refAuthor">Parekh, R.</span>, <span class="refAuthor">Zhang, Z.</span>, and <span class="refAuthor">L. Zheng</span>, <span class="refTitle">"Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)"</span>, <span class="seriesInfo">STD 83</span>, <span class="seriesInfo">RFC 7761</span>, <span class="seriesInfo">DOI 10.17487/RFC7761</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7761">https://www.rfc-editor.org/info/rfc7761</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7847">[RFC7847]</dt>
        <dd>
<span class="refAuthor">Melia, T., Ed.</span> and <span class="refAuthor">S. Gundavelli, Ed.</span>, <span class="refTitle">"Logical-Interface Support for IP Hosts with Multi-Access Support"</span>, <span class="seriesInfo">RFC 7847</span>, <span class="seriesInfo">DOI 10.17487/RFC7847</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7847">https://www.rfc-editor.org/info/rfc7847</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8402">[RFC8402]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Ginsberg, L.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing Architecture"</span>, <span class="seriesInfo">RFC 8402</span>, <span class="seriesInfo">DOI 10.17487/RFC8402</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8402">https://www.rfc-editor.org/info/rfc8402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8726">[RFC8726]</dt>
        <dd>
<span class="refAuthor">Farrel, A.</span>, <span class="refTitle">"How Requests for IANA Action Will Be Handled on the Independent Stream"</span>, <span class="seriesInfo">RFC 8726</span>, <span class="seriesInfo">DOI 10.17487/RFC8726</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8726">https://www.rfc-editor.org/info/rfc8726</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8754">[RFC8754]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Dukes, D., Ed.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">D. Voyer</span>, <span class="refTitle">"IPv6 Segment Routing Header (SRH)"</span>, <span class="seriesInfo">RFC 8754</span>, <span class="seriesInfo">DOI 10.17487/RFC8754</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8754">https://www.rfc-editor.org/info/rfc8754</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8892">[RFC8892]</dt>
        <dd>
<span class="refAuthor">Thaler, D.</span> and <span class="refAuthor">D. Romascanu</span>, <span class="refTitle">"Guidelines and Registration Procedures for Interface Types and Tunnel Types"</span>, <span class="seriesInfo">RFC 8892</span>, <span class="seriesInfo">DOI 10.17487/RFC8892</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8892">https://www.rfc-editor.org/info/rfc8892</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8899">[RFC8899]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span>, <span class="refAuthor">Jones, T.</span>, <span class="refAuthor">Tüxen, M.</span>, <span class="refAuthor">Rüngeler, I.</span>, and <span class="refAuthor">T. Völker</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery for Datagram Transports"</span>, <span class="seriesInfo">RFC 8899</span>, <span class="seriesInfo">DOI 10.17487/RFC8899</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8899">https://www.rfc-editor.org/info/rfc8899</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8900">[RFC8900]</dt>
        <dd>
<span class="refAuthor">Bonica, R.</span>, <span class="refAuthor">Baker, F.</span>, <span class="refAuthor">Huston, G.</span>, <span class="refAuthor">Hinden, R.</span>, <span class="refAuthor">Troan, O.</span>, and <span class="refAuthor">F. Gont</span>, <span class="refTitle">"IP Fragmentation Considered Fragile"</span>, <span class="seriesInfo">BCP 230</span>, <span class="seriesInfo">RFC 8900</span>, <span class="seriesInfo">DOI 10.17487/RFC8900</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8900">https://www.rfc-editor.org/info/rfc8900</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8981">[RFC8981]</dt>
      <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Krishnan, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">R. Draves</span>, <span class="refTitle">"Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6"</span>, <span class="seriesInfo">RFC 8981</span>, <span class="seriesInfo">DOI 10.17487/RFC8981</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8981">https://www.rfc-editor.org/info/rfc8981</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="fletcher">
<section id="appendix-A">
      <h2 id="name-oal-checksum-algorithm">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-oal-checksum-algorithm" class="section-name selfRef">OAL Checksum Algorithm</a>
      </h2>
<p id="appendix-A-1">The OAL Checksum Algorithm adopts the 8-bit Fletcher algorithm
      specified in Appendix I of <span>[<a href="#RFC1146" class="xref">RFC1146</a>]</span> as also analyzed in
      <span>[<a href="#CKSUM" class="xref">CKSUM</a>]</span>. <span>[<a href="#RFC6247" class="xref">RFC6247</a>]</span> declared <span>[<a href="#RFC1146" class="xref">RFC1146</a>]</span> historic for the reason that the algorithms had never
      seen widespread use with TCP, however this document adopts the 8-bit
      Fletcher algorithm for a different purpose. Quoting from Appendix I of
      <span>[<a href="#RFC1146" class="xref">RFC1146</a>]</span>, the OAL Checksum Algorithm proceeds as
      follows:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1">"The 8-bit Fletcher Checksum Algorithm is calculated over a
          sequence of data octets (call them D[1] through D[N]) by maintaining
          2 unsigned 1's-complement 8-bit accumulators A and B whose contents
          are initially zero, and performing the following loop where i ranges
          from 1 to N:<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A-2.1.2.1">A := A + D[i]<a href="#appendix-A-2.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A-2.1.2.2">B := B + A<a href="#appendix-A-2.1.2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A-2.1.3">It can be shown that at the end of the loop A will contain
          the 8-bit 1's complement sum of all octets in the datagram, and that
          B will contain (N)D[1] + (N-1)D[2] + ... + D[N]."<a href="#appendix-A-2.1.3" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-3">To calculate the OAL checksum, the above algorithm is applied over
      the N-octet concatenation of the OAL pseudo-header, the encapsulated IP
      packet and the two-octet trailing checksum field initialized to 0.
      Specifically, the algorithm is first applied over the 40 octets of the
      OAL pseudo-header as data octets D[1] through D[40], then continues over
      the entire length of the original IP packet as data octets D[41] through
      D[N-2] and finally concludes with the two trailing 0 octets as data
      octets D[N-1] and D[N].<a href="#appendix-A-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="integrity">
<section id="appendix-B">
      <h2 id="name-ipv6-nd-message-authenticat">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-ipv6-nd-message-authenticat" class="section-name selfRef">IPv6 ND Message Authentication and Integrity</a>
      </h2>
<p id="appendix-B-1">OMNI interface IPv6 ND messages are subject to authentication and
      integrity checks at multiple levels. However, OMNI interfaces omit
      unnecessarily redundant checks to improve performance and minimize
      complexity.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">When an OMNI interface sends an IPv6 ND message over an INET
      interface, it includes an authentication sub-option with a valid
      signature but does not include an IPv6 ND message checksum. The OMNI
      interface that receives the message verifies the OAL checksum as a
      first-level integrity check, then verifies the authentication signature
      (while ignoring the IPv6 ND message checksum) to ensure IPv6 ND message
      authentication and integrity.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">When an OMNI interface sends an IPv6 ND message over an ANET
      interface, it need not include an authentication sub-option but instead
      calculates/includes an IPv6 ND message checksum. The OMNI interface that
      receives the message applies any lower-layer ANET authentication and
      integrity checks, then verifies the OAL checksum (if present) followed
      by the IPv6 ND message checksum.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">When an OMNI interface sends NS/NA(NUD) messages that do not traverse
      the secured spanning tree, it includes an authentication option only if
      authentication is necessary; otherwise, it calculates/includes the IPv6
      ND message checksum.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<p id="appendix-B-5">When a FHS Proxy/Server forwards a proxyed IPv6 ND message into the
      secured spanning tree, it omits both the authentication sub-option and
      IPv6 ND message checksum (i.e., even if it alters the IPv6 ND message
      contents before forwarding) since the secured spanning tree assures
      authentication and integrity through lower-layer security services. The
      OMNI interface that receives the message has assurance that
      authentication and integrity are protected by lower layers.<a href="#appendix-B-5" class="pilcrow">¶</a></p>
<p id="appendix-B-6">OAL destinations discard carrier packets with unacceptable
      Identifications and submit the encapsulated fragments in others for
      reassembly. The reassembly algorithm rejects any fragments with
      unacceptable sizes, offsets, etc. and reassembles all others. Following
      reassembly, the OAL checksum algorithm provides an integrity assurance
      layer that compliments any integrity checks already applied by lower
      layers as well as a first-pass filter for any checks that will be
      applied later by upper layers.<a href="#appendix-B-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vdlm2">
<section id="appendix-C">
      <h2 id="name-vdl-mode-2-considerations">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-vdl-mode-2-considerations" class="section-name selfRef">VDL Mode 2 Considerations</a>
      </h2>
<p id="appendix-C-1">ICAO Doc 9776 is the "Technical Manual for VHF Data Link Mode 2"
      (VDLM2) that specifies an essential radio frequency data link service
      for aircraft and ground stations in worldwide civil aviation air traffic
      management. The VDLM2 link type is "multicast capable" <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>, but with considerable differences from common
      multicast links such as Ethernet and IEEE 802.11.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">First, the VDLM2 link data rate is only 31.5Kbps - multiple orders of
      magnitude less than most modern wireless networking gear. Second, due to
      the low available link bandwidth only VDLM2 ground stations (i.e., and
      not aircraft) are permitted to send broadcasts, and even so only as
      compact layer 2 "beacons". Third, aircraft employ the services of ground
      stations by performing unicast RS/RA exchanges upon receipt of beacons
      instead of listening for multicast RA messages and/or sending multicast
      RS messages.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">This beacon-oriented unicast RS/RA approach is necessary to conserve
      the already-scarce available link bandwidth. Moreover, since the numbers
      of beaconing ground stations operating within a given spatial range must
      be kept as sparse as possible, it would not be feasible to have
      different classes of ground stations within the same region observing
      different protocols. It is therefore highly desirable that all ground
      stations observe a common language of RS/RA as specified in this
      document.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">Note that links of this nature may benefit from compression
      techniques that reduce the bandwidth necessary for conveying the same
      amount of data. The IETF lpwan working group is considering possible
      alternatives: [https://datatracker.ietf.org/wg/lpwan/documents].<a href="#appendix-C-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ipv6ndmap">
<section id="appendix-D">
      <h2 id="name-client-proxy-server-isolati">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-client-proxy-server-isolati" class="section-name selfRef">Client-Proxy/Server Isolation Through L2 Address Mapping</a>
      </h2>
<p id="appendix-D-1">Per <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>, IPv6 ND messages may be sent to either
      a multicast or unicast link-scoped IPv6 destination address. However,
      IPv6 ND messaging should be coordinated between the Client and
      Proxy/Server only without invoking other nodes on the *NET. This implies
      that Client-Proxy/Server control messaging should be isolated and not
      overheard by other nodes on the link.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">To support Client-Proxy/Server isolation on some *NET links,
      Proxy/Servers can maintain an OMNI-specific unicast L2 address
      ("MSADDR"). For Ethernet-compatible *NETs, this specification reserves
      one Ethernet unicast address TBD5 (see: <a href="#iana" class="xref">Section 25</a>). For
      non-Ethernet statically-addressed *NETs, MSADDR is reserved per the
      assigned numbers authority for the *NET addressing space. For still
      other *NETs, MSADDR may be dynamically discovered through other means,
      e.g., L2 beacons.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">Clients map the L3 addresses of all IPv6 ND messages they send (i.e.,
      both multicast and unicast) to MSADDR instead of to an ordinary unicast
      or multicast L2 address. In this way, all of the Client's IPv6 ND
      messages will be received by Proxy/Servers that are configured to accept
      packets destined to MSADDR. Note that multiple Proxy/Servers on the link
      could be configured to accept packets destined to MSADDR, e.g., as a
      basis for supporting redundancy.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">Therefore, Proxy/Servers must accept and process packets destined to
      MSADDR, while all other devices must not process packets destined to
      MSADDR. This model has well-established operational experience in Proxy
      Mobile IPv6 (PMIP) <span>[<a href="#RFC5213" class="xref">RFC5213</a>]</span><span>[<a href="#RFC6543" class="xref">RFC6543</a>]</span>.<a href="#appendix-D-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes">
<section id="appendix-E">
      <h2 id="name-change-log">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-E-1">&lt;&lt; RFC Editor - remove prior to publication &gt;&gt;<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">Differences from draft-templin-6man-omni-32 to
      draft-templin-6man-omni-33:<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-3.1">That's it, folks.<a href="#appendix-E-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-4">Differences from draft-templin-6man-omni-31 to
      draft-templin-6man-omni-32:<a href="#appendix-E-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-5.1">Only one FHS Proxy/Server is elected as the Hub, and only the Hub
          provides designated router and mobility anchor point services.<a href="#appendix-E-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-5.2">Re-adjusted OMNI sub-options to separate Interface Attributes
          from Traffic Selectors.<a href="#appendix-E-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-5.3">Removed MS-Register/Release.<a href="#appendix-E-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-5.4">Anycast.<a href="#appendix-E-5.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-6">Differences from draft-templin-6man-omni-30 to
      draft-templin-6man-omni-31:<a href="#appendix-E-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-7.1">Major changes, especially in Sections 6.2, 6.4, 6.5, 12.2.15 and
          others.<a href="#appendix-E-7.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-8">Differences from draft-templin-6man-omni-29 to
      draft-templin-6man-omni-30:<a href="#appendix-E-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-9.1">Major revision update for review.<a href="#appendix-E-9.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-10">Differences from draft-templin-6man-omni-28 to
      draft-templin-6man-omni-29:<a href="#appendix-E-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-11.1">Interim version with extensive new text - cleanup planned for
          next release.<a href="#appendix-E-11.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-12">Differences from draft-templin-6man-omni-27 to
      draft-templin-6man-omni-28:<a href="#appendix-E-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-13.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-13.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-14">Differences from draft-templin-6man-omni-26 to
      draft-templin-6man-omni-27:<a href="#appendix-E-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-15.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-15.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-16">Differences from draft-templin-6man-omni-25 to
      draft-templin-6man-omni-26:<a href="#appendix-E-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-17.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-17.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-18">Differences from draft-templin-6man-omni-24 to
      draft-templin-6man-omni-25:<a href="#appendix-E-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-19.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-19.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-20">Differences from draft-templin-6man-omni-23 to
      draft-templin-6man-omni-24:<a href="#appendix-E-20" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-21.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-21.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-22">Differences from draft-templin-6man-omni-22 to
      draft-templin-6man-omni-23:<a href="#appendix-E-22" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-23.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-23.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-24">Differences from draft-templin-6man-omni-21 to
      draft-templin-6man-omni-22:<a href="#appendix-E-24" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-25.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-25.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-26">Differences from draft-templin-6man-omni-20 to
      draft-templin-6man-omni-21:<a href="#appendix-E-26" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-27.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-27.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-28">Differences from draft-templin-6man-omni-19 to
      draft-templin-6man-omni-20:<a href="#appendix-E-28" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-29.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-29.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-30">Differences from draft-templin-6man-omni-18 to
      draft-templin-6man-omni-19:<a href="#appendix-E-30" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-31.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-31.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-32">Differences from draft-templin-6man-omni-17 to
      draft-templin-6man-omni-18:<a href="#appendix-E-32" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-33.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-33.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-34">Differences from draft-templin-6man-omni-16 to
      draft-templin-6man-omni-17:<a href="#appendix-E-34" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-35.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval (with reference to rfcdiff
          from previous version).<a href="#appendix-E-35.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-36">Differences from draft-templin-6man-omni-15 to
      draft-templin-6man-omni-16:<a href="#appendix-E-36" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-37.1">Final editorial review pass resulting in multiple changes.
          Document now submit for final approval.<a href="#appendix-E-37.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-38">Differences from draft-templin-6man-omni-14 to
      draft-templin-6man-omni-15:<a href="#appendix-E-38" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-39.1">Text restructuring to remove ambiguities, eliminate extraneous
          text and improve readability.<a href="#appendix-E-39.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-39.2">Clarified that the OMNI link model is NBMA and that link-scoped
          multicast is through iterative unicast.<a href="#appendix-E-39.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-40">Differences from draft-templin-6man-omni-13 to
      draft-templin-6man-omni-14:<a href="#appendix-E-40" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-41.1">Brought back the optional two-message exchange feature.<a href="#appendix-E-41.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-41.2">Added TCP RST flag and new (OPT, PNG) flags to the OMNI option
          header.<a href="#appendix-E-41.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-41.3">Require the OAL node that initiates the symmetric connection to
          include its (future) receive window size in the initial SYN.<a href="#appendix-E-41.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-41.4">Require OAL nodes to select new ISS values that are outside of
          the current SND.WND.<a href="#appendix-E-41.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-41.5">Text clarifications for improved readability.<a href="#appendix-E-41.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-42">Differences from draft-templin-6man-omni-12 to
      draft-templin-6man-omni-13:<a href="#appendix-E-42" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-43.1">Complete revision of OAL Identification Window Maintenance
          section to incorporate well-known protocol conventions and
          terminology.<a href="#appendix-E-43.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-44">Differences from draft-templin-6man-omni-11 to
      draft-templin-6man-omni-12:<a href="#appendix-E-44" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-45.1">Expanded on details of symmetric window synchronization.<a href="#appendix-E-45.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-46">Differences from draft-templin-6man-omni-10 to
      draft-templin-6man-omni-11:<a href="#appendix-E-46" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-47.1">Included an Ordinal Number field in the Compressed Header format
          for non-final fragments<a href="#appendix-E-47.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-47.2">Clarified that the window coordination protocol is based on the
          IPv6 ND connectionless protocol using TCP constructs, and not based
          on the TCP connection-oriented protocol.<a href="#appendix-E-47.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-47.3">Removed unneeded fields from the OMNI option header.<a href="#appendix-E-47.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-48">Differences from draft-templin-6man-omni-09 to
      draft-templin-6man-omni-10:<a href="#appendix-E-48" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-49.1">Fixed sizing considerations for OMNI option fields.<a href="#appendix-E-49.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-49.2">Updated handling of multiple OMNI options in the same IPv6 ND
          message. Only the first option includes the header, while all other
          options include only sub-options.<a href="#appendix-E-49.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-50">Differences from draft-templin-6man-omni-08 to
      draft-templin-6man-omni-09:<a href="#appendix-E-50" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-51.1">Included reference to RFC3366 and updated section on Fragment
          Retransmission.<a href="#appendix-E-51.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-51.2">Added "ordinal number" marking in Fragment Header reserved
          field.<a href="#appendix-E-51.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-52">Differences from draft-templin-6man-omni-07 to
      draft-templin-6man-omni-08:<a href="#appendix-E-52" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-53.1">Included TCP state variables; window scale<a href="#appendix-E-53.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-54">Differences from draft-templin-6man-omni-06 to
      draft-templin-6man-omni-07:<a href="#appendix-E-54" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-55.1">Moved Interface Attributes, Type 1 and Type 2 to historic
          status.<a href="#appendix-E-55.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-55.2">Incorporated Traffic Selector into Interface Attributes, Type
          4.<a href="#appendix-E-55.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-56">Differences from draft-templin-6man-omni-05 to
      draft-templin-6man-omni-06:<a href="#appendix-E-56" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-57.1">Adopted TCP as an OAL packet-based connection-oriented
          protocol.<a href="#appendix-E-57.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-57.2">Three-Way handshake for establishing symmetric send/receive
          windows<a href="#appendix-E-57.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-57.3">Window length specified, plus "current" and "previous"
          windows<a href="#appendix-E-57.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-57.4">New appendix on checksum algorithm, with citations changed<a href="#appendix-E-57.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-57.5">Security architecture considerations.<a href="#appendix-E-57.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-57.6">More details on HIP message signatures.<a href="#appendix-E-57.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-57.7">Require firewalls at OAL destinations.<a href="#appendix-E-57.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-57.8">Removed "equal-length" requirement for OAL non-final
          fragments.<a href="#appendix-E-57.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-58">Differences from draft-templin-6man-omni-04 to
      draft-templin-6man-omni-05:<a href="#appendix-E-58" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-59.1">Change to S/T-omIndex definition.<a href="#appendix-E-59.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-60">Differences from draft-templin-6man-omni-03 to
      draft-templin-6man-omni-04:<a href="#appendix-E-60" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-61.1">Changed reference citations to "draft-templin-6man-aero".<a href="#appendix-E-61.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-61.2">Included introductory description of the "6M's".<a href="#appendix-E-61.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-61.3">Included new OMNI sub-option for PIM-SM.<a href="#appendix-E-61.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-62">Differences from draft-templin-6man-omni-02 to
      draft-templin-6man-omni-03:<a href="#appendix-E-62" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-63.1">Added citation of RFC8726.<a href="#appendix-E-63.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-64">Differences from draft-templin-6man-omni-01 to
      draft-templin-6man-omni-02:<a href="#appendix-E-64" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-65.1">Updated IANA registration policies for OMNI registries.<a href="#appendix-E-65.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-66">Differences from draft-templin-6man-omni-00 to
      draft-templin-6man-omni-01:<a href="#appendix-E-66" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-67.1">Changed intended document status to Informational, and removed
          documents from "updates" category.<a href="#appendix-E-67.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-67.2">Updated implementation status.<a href="#appendix-E-67.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-67.3">Minor edits to HIP message specifications.<a href="#appendix-E-67.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-67.4">Clarified OAL and *NET IP header field settings during
          encapsulation and re-encapsulation.<a href="#appendix-E-67.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-68">Differences from earlier versions to
      draft-templin-6man-omni-00:<a href="#appendix-E-68" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-69.1">Established working baseline reference.<a href="#appendix-E-69.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Fred L. Templin (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">The Boeing Company</span></div>
<div dir="auto" class="left"><span class="street-address">P.O. Box 3707</span></div>
<div dir="auto" class="left">
<span class="locality">Seattle</span>, <span class="region">WA</span> <span class="postal-code">98124</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fltemplin@acm.org" class="email">fltemplin@acm.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tony Whyman</span></div>
<div dir="auto" class="left"><span class="org">MWA Ltd c/o Inmarsat Global Ltd</span></div>
<div dir="auto" class="left"><span class="street-address">99 City Road</span></div>
<div dir="auto" class="left"><span class="locality">London</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tony.whyman@mccallumwhyman.com" class="email">tony.whyman@mccallumwhyman.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
