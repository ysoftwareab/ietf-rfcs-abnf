

Network Mobility                                              P. Thubert
Internet-Draft                                             Cisco Systems
Expires: April 14, 2004                                      R. Wakikawa
                                                         Keio University
                                                          V. Devarapalli
                                                                   Nokia
                                                        October 15, 2003


                      Examples of basic Nemo usage
                   draft-thubert-nemo-basic-usages-00

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at http://
   www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 14, 2004.

Copyright Notice

   Copyright (C) The Internet Society (2003). All Rights Reserved.

Abstract

   This paper documents some practical scenarios and the associated
   issues when deploying Mobile Routers, conforming the Nemo Basic
   Support draft [6].

   The aim here is specifically to provide some examples of organization
   of the Home Network, as they were discussed in the Nemo and Nemo
   Design mailing lists.





Thubert, et al.          Expires April 14, 2004                 [Page 1]

Internet-Draft                Nemo usages                   October 2003


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology and concepts . . . . . . . . . . . . . . . . . . .  4
   3.  General Expectations . . . . . . . . . . . . . . . . . . . . .  5
   4.  Extended Home Network  . . . . . . . . . . . . . . . . . . . .  6
   4.1 Returning Home . . . . . . . . . . . . . . . . . . . . . . . .  7
   5.  Aggregated Home  . . . . . . . . . . . . . . . . . . . . . . .  8
   5.1 Returning Home . . . . . . . . . . . . . . . . . . . . . . . .  8
   6.  Virtual Home Network . . . . . . . . . . . . . . . . . . . . . 10
   7.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 11
       References . . . . . . . . . . . . . . . . . . . . . . . . . . 11
       Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . 12
   A.  Returning Home in the virtual case . . . . . . . . . . . . . . 13
       Intellectual Property and Copyright Statements . . . . . . . . 14




































Thubert, et al.          Expires April 14, 2004                 [Page 2]

Internet-Draft                Nemo usages                   October 2003


1. Introduction

   This document assumes that the reader is familiar with Mobile IPv6 as
   defined in [5], and with the concept of Mobile Router defined in the
   Nemo terminology document [8].

   Three different organizations of the Home Network are documented:

   Extended Home Network: In this disposition, the Home Network is but
      one subnet of a larger aggregation that encompasses the Mobile
      Networks, called extended Home Network. When at Home, a Mobile
      Router performs normal routing between the Home Link and the
      Mobile Networks.

   Aggregated Home Network: In this disposition, the Home Network
      actually overlaps with the Mobile Networks. When at Home, a Mobile
      Router acts as a bridge between the Home Link and the Mobile
      Networks.

   Virtual Home Network: In this disposition, there is no physical Home
      Link at all for the Mobile Routers to come back Home to.

   In all three cases, the Home Agents collectively advertise only the
   aggregation of the Mobile Networks.  The dichotomy is kept within the
   Home Agents and the Mobile Routers, as opposed to advertised by means
   of routing protocols to other parties.

   Also, it is valid for a Mobile Router to register using an address
   from one of its own Mobile Network Prefixes in all three cases.

   The examples provided hereafter aim at illustrating the Nemo Basic
   Support draft [6] but are by no mean at limiting its scope of
   application.


















Thubert, et al.          Expires April 14, 2004                 [Page 3]

Internet-Draft                Nemo usages                   October 2003


2. Terminology and concepts

   This draft uses the following additional terminology:

   Home Link: The link attached to the interface at the Home Agent on
      which the Home Prefix is configured. The interface can be a
      virtual interface, in which case the Home Link is a virtual Home
      Link.

   Home Network: The Network formed by the application of the Home
      Prefix on the Home Link. With Nemo, the concept of Home Network is
      extended as explained below.

   Home Address: With Mobile IPv6, a Home Address is derived from the
      Home Network prefix.  This is generalized in Nemo, with some
      limitations: A Home Address can be either derived from the Home
      Network or from one of the Mobile Router's Mobile Network
      prefixes.

   MRHA Tunnel: The bi-directional tunnel between a Mobile Router and
      its Home Agent

   Mobile Aggregated Prefix: An aggregation of Mobile Network Prefixes.

   Aggregated Home Network: The Home Network associated with a Mobile
      Aggregated Prefix. This Aggregation is advertised as a subnet on
      the Home Link, and thus used as Home Network for Nemo purposes.

   Extended Home Network: The network associated with the aggregation of
      one or more Home Network(s) and Mobile Network(s). As opposed to
      the Mobile IPv6 Home Network that is a subnet, the extended Home
      Network is an aggregation and is further subnetted.

   Virtual Home Network: The Home Network associated with a Virtual
      Network. The Extended Home Network and the Aggregated Home Network
      can be configured as Virtual Home Network.















Thubert, et al.          Expires April 14, 2004                 [Page 4]

Internet-Draft                Nemo usages                   October 2003


3. General Expectations

   With  Mobile IPv6, the Home Network is generally a physical network
   interconnecting the Home Agents, and the Mobile Nodes that are at
   Home.  Nemo extends the concept of Home so that it is not only a flat
   subnet composed of Home Addresses but an aggregation that is itself
   subnetted in mobile and Home Networks. This aggregation is still
   referred to as Home.

   As an example, say that the aggregation has a global routing prefix
   of m = 48 bits (A:B:C::/48), with subnet ID size of n = 16 bits ( n +
   m = 64).

   Say that a Mobile Router, MR1, owns the Mobile Network Prefix
   A:B:C:1::/64: With basic Nemo, and depending on the deployment, MR1
   may register using a Home Address from the Home network, A:B:C:0::1,
   say, or a Home Address, A:B:C:1::1, say, from one of its Mobile
   Network Prefixes.

   In a given deployment, one subnet may be reserved for the Home Link
   (say A:B:C:0::/64) while the others are attributed to Mobile Routers
   as Mobile Networks (as A:B:C:1::/64 for MR1). Another approach could
   be to configure the Aggregation of Mobile Networks as the subnet on
   the Home Link, and let the Mobile Routers manage the overlapping
   networks. Finally, the aggregation could be configured on a virtual
   network, with no physical Home Link at all, in which case Home means
   topologically and administratively close to the Home Agent that owns
   the virtual network.

   The following sections provide additional information on these forms
   of Home Network:




















Thubert, et al.          Expires April 14, 2004                 [Page 5]

Internet-Draft                Nemo usages                   October 2003


4. Extended Home Network

   One simple approach can be to reserve one or several subnets from an
   aggregation for the Home Link, and to use the other subnets as Mobile
   Network Prefixes. In that case, the Home Network and the Mobile
   Networks do not overlap. The aggregation is called an extended Home
   Network.


                    |
          route     v  /48                        A:B:C::/48

                    HA
                    | /64                         A:B:C:0::/64
         --+-----+--+- . -+- . -+--
           |     |        |     |
           MR1   MR2      MRi   MRN
           /64   /64      /64   /64               A:B:C:i::/64  0 < i <= N


                         extended Home Network


   In that configuration:

   o  There is one physical Home Network and multiple Mobile Networks

   o  The Home and the Mobile Network prefixes are tailored to allow for
      IPv6 Stateless Address Autoconfiguration with typical interface
      identifier length for the type of interface (can be for example /
      64).

   o  The prefix length of the extended Home Network is shorter than
      that of the Home Network and the Mobile Network prefixes, since it
      is an aggregation (can be for example /48).

   o  The Mobile Routers are assigned individually a Home Address from
      the Home Network and use is to register their Mobile Network
      Prefix(es). In that case, the Home Agent performs DAD in the Home
      Network as prescribed by Mobile IPv6 for the Home Addresses.

   o  Alternatively, a Mobile Router could also form a Home Address from
      one of its prefixes and use it to register, performing its own DAD
      on its ingress network.







Thubert, et al.          Expires April 14, 2004                 [Page 6]

Internet-Draft                Nemo usages                   October 2003


4.1 Returning Home

   In the extended Home Network model, the Home Network is configured on
   a physical interface of the Home Agent, the Home Link.

   A Mobile Router returns Home by connecting directly to the Home Link,
   and dropping the MRHA tunnel.

   If the Home Address of the Mobile Router is derived from one of its
   Mobile Networks, then the MR may connect to the Home Link using an
   egress interface and autoconfigure an address on the Home Link. The
   MR recognizes the prefix of its Home Agent in order to decide that it
   is Home. Note that in that case the Home Address does not match the
   Home Prefix.

   When at Home, the Mobile Router ensures the connectivity of the
   Mobile Network using standard router operations.

   In particular, if the HA has the necessary information to continue
   routing to the Mobile Network Prefixes in the absence of
   registration, for instance if the Home Address of the Mobile Router
   is derived from the Home Network, and if the HA uses a static route
   to the Mobile Network Prefix(es) via that address, then the
   participation of the MR to the Home IGP is not required.

   But in the general case, when the MR is at Home, it resumes IGP
   operations on the Home Link in order to advertise its Mobile
   Networks.

   Alternate procedures for ensuring the connectivity of the Mobile
   Networks when at Home are described in Section 6. In Particular, it
   is



















Thubert, et al.          Expires April 14, 2004                 [Page 7]

Internet-Draft                Nemo usages                   October 2003


5. Aggregated Home

   One other approach is to consider that the Aggregation of all the
   mobile network prefixes is used plainly as the Home Network, refered
   to as the Aggregated Home Network. This means that the Mobile
   Aggregated Prefix is configured on the Home Link and advertised by
   the Home Agent as a subnet.


                     HA
   		 | /56                       Aggreg /56
         --+-----+--+- . -+- . -+--
           |     |        |     |
           MR1   MR2      MRi   MRN
        ------  ------  ------ ------
           /64   /64     /64   /64               Aggreg|i /64  0 < i <= N


                         Aggregated Home

   Note: a Mobile Router coming Home sees overlapping prefixes between
   the ingress and the egress interface and some specific support may be
   needed.

   A node on the Home Link will compute that the Aggregated Home Network
   is actually a subnet on the Home Link and may use it for
   autoconfiguration purposes. Such a node may also install a connected
   route to the Aggregated Home Network over the Home Link.

   As a result, unless the node has a better (longest match) route to a
   given Mobile Network Prefix, it will lookup all MNNs using Neighbour
   Discovery over the Home Link.

   Thus, the Home Agent MUST intercept all the packets to the MNNs on
   the registered prefixes. In order to do so, the Home Agent MAY
   perform ND proxying for all addresses in all registered Mobile
   Network Prefixes, and protect the Mobile Network Prefix space from
   autoconfiguration by uncontrolled visitors on the Home Link.

   Alternatives based on a routing protocol or ICMP redirect may apply
   in some cases.

5.1 Returning Home

   The Aggregated Home Prefix is configured on a physical interface of
   the Home Agent, the Home Link. As a consequence, the Home Agent has a
   connected route to the Aggregated Home Network over the Home Link.




Thubert, et al.          Expires April 14, 2004                 [Page 8]

Internet-Draft                Nemo usages                   October 2003


   A Mobile Router returns Home by connecting directly to the Home Link,
   and dropping the MRHA tunnel.

   The Mobile Router recognizes its Home Link by a prefix match with its
   Home Agent. Note that it must expect a shorter prefix than that of
   its Mobile Networks, even if its Home Address is formed out of one of
   its Mobile Network Prefixes, but that the Home Address matches the
   Home Network Prefix.

   When a Mobile Router connects to the Home Link using its egress
   interface, it MAY set up a bridge between its ingress interface(s)
   and the Home Link. Alternatively, the Mobile Router MAY perform ND
   proxying for all addresses in its Mobile Network Prefixes, between
   the egress and the related ingress interface. Since the prefixes on
   the egress and ingress interfaces are overlapping, routing is
   disallowed.


                    HA
                    | /56                         Aggreg /56
         --+-----+--+- . -+- . -+--
           |     |        |     |
          MR1   MR2      MRi   MRN
        ------  ------  ------ ------
           /64   /64     /64    /64               Aggreg|i /64  0 < i <= N


                         Bridging between egress and ingress


   Alternatively, if the MR has a single ingress Interface, the Mobile
   Router may use the Mobile Link to connect to the Home Link, merging
   the two links in a single consistent network.


                    HA
                    | /56                         Aggreg /56
          --+-----+--+- . -+- . -+--
           /64   /64     /64    /64               Aggreg|i /64  0 < i <= N
        ------  ------  ------ ------
           MR1   MR2      MRi   MRN
            |     |        |     |

                         Merging the Home and the Mobile Networks


   This fits the connected route model, since the Aggregated Home is
   truly located on that network.



Thubert, et al.          Expires April 14, 2004                 [Page 9]

Internet-Draft                Nemo usages                   October 2003


6. Virtual Home Network

   The Home Link can be configured on the Home Agent on a virtual link,
   in which case there's no physical Home Link for Mobile Routers to
   return Home or for Home Agents to discover each others and perform
   the ND level interactions as described in Mobile IPv6. [5]


                    /48                       eg: A:B:C::/48
                    HA
                    | /64                         A:C:C:E::/64
         --+-----+--+- . -+- . -+--
           |     |        |     |
           MR1   MR2      MRi   MRN
           /64   /64      /64   /64               A:B:C:i::/64  0 < i <= N



                        Virtual Home Network


   The Extended Home network and the Aggregated Home network models can
   be adapted for virtual links. There is no change in the way Home
   Addresses are allocated. As in the case of a physical link, the Home
   Address of a Mobile router is constructed based on the the Home
   Prefix or one of the prefixes of its Mobile Network(s).

   There are certain advantages to making the Home Link a virtual link:

      A virtual link may not experience any disruption related to
      physical maintenance or to hardware problems, so it is more
      available than a physical link. The high availability of the Home
      Link is critical for the mobility service.

      The Home Agent does not have to defend the Mobile Router's Home
      Address through Proxy Neighbor Discovery. The Home Agent does not
      also have to perform Duplicate Address Detection (DAD) for the
      Mobile Router's Home Address when it receives a Binding Update
      from the Mobile Router.

      The Mobile Router does not have to implement the Returning Home
      procedure (section 11.5.4 of Mobile IPv6. [5]).

   In order for a Mobile Router to emulate returning Home, it can
   connect to one or more access link(s) configured for that purpose on
   the Home Agent. The Mobile Router, after connecting to the access
   link, SHOULD not send any routing protocol updates on the egress
   interface because the routing information from the Mobile Router



Thubert, et al.          Expires April 14, 2004                [Page 10]

Internet-Draft                Nemo usages                   October 2003


   might adversely affect IPv6 route aggregation on the Home Network.
   However, the Mobile Router must register its binding as if it was
   accessing a foreign link.

   There are also some drawbacks to the virtual Home Link approach:

      There can be only one Home Agent since Mobile IPv6 relies on
      Neighbor Discovery on the Home Link for other HA discovery and for
      Duplicate Address Detection.

      The Home Agent must maintain a Binding Cache entry for a Mobile
      Router and forwarding state for its Mobile Network even when the
      Mobile Router is directly connected to it. All traffic to and from
      the Mobile Network is sent through the bi-directional tunnel
      regardless of the Mobile Router location. This results in a
      tunneling overhead even though the Mobile Router is connected to
      the Home Network.

   Some solutions can be proposed in order to perform an equivalent of
   returning Home on a virtual Home Network. One such approach is
   sketched in appendix as an illustration.

7. Acknowledgements

   The authors wish to thank:

   Erik Nordmark, Kent Leung, Thierry Ernst, TJ Kniveton and Alexandru
   Petrescu for their contributions.

References

   [1]  Deering, S. and R. Hinden, "Internet Protocol, Version 6 (IPv6)
        Specification", RFC 2460, December 1998.

   [2]  Narten, T., Nordmark, E. and W. Simpson, "Neighbor Discovery for
        IP Version 6 (IPv6)", RFC 2461, December 1998.

   [3]  Thomson, S. and T. Narten, "IPv6 Stateless Address
        Autoconfiguration", RFC 2462, December 1998.

   [4]  Hinden, R. and S. Deering, "Internet Protocol Version 6 (IPv6)
        Addressing Architecture", RFC 3513, April 2003.

   [5]  Johnson, D., Perkins, C. and J. Arkko, "Mobility Support in
        IPv6", draft-ietf-mobileip-ipv6-24 (work in progress), July
        2003.

   [6]  Devarapalli, V., "Nemo Basic Support Protocol",



Thubert, et al.          Expires April 14, 2004                [Page 11]

Internet-Draft                Nemo usages                   October 2003


        draft-ietf-nemo-basic-support-01 (work in progress), September
        2003.

   [7]  Ernst, T., "Network Mobility Support Goals and Requirements",
        draft-ietf-nemo-requirements-01 (work in progress), May 2003.

   [8]  Ernst, T. and H. Lach, "Network Mobility Support Terminology",
        draft-ietf-nemo-terminology-00 (work in progress), May 2003.


Authors' Addresses

   Pascal Thubert
   Cisco Systems Technology Center
   Village d'Entreprises Green Side
   400, Avenue Roumanille
   Biot - Sophia Antipolis  06410
   FRANCE

   EMail: pthubert@cisco.com


   Ryuji Wakikawa
   Keio University and WIDE
   5322 Endo Fujisawa Kanagawa
   252-8520
   JAPAN

   EMail: ryuji@sfc.wide.ad.jp


   Vijay Devarapalli
   Nokia Research Center
   313 Fairchild Drive
   Mountain View, CA  94043
   USA

   EMail: vijay.devarapalli@nokia.com













Thubert, et al.          Expires April 14, 2004                [Page 12]

Internet-Draft                Nemo usages                   October 2003


Appendix A. Returning Home in the virtual case

   When a Home Link is virtual, all traffic to and from the Mobile
   Network is sent through the bi-directional tunnel even at the Home
   Link.  This section describes one possible mechanism that extends
   basic Nemo to eliminate this tunneling overhead.

   Although the Home Link is virtual, the Home Agent has at least one
   physical link to communicate with the external world. One or several
   of such links, called the virtual Home Access Links, are conceptually
   associated with the virtual Home Link and considered as part of Home.

   When accessing one of its virtual Home Access Links, a Mobile Router
   autoconfigures a Care-of Address from a Router Advertisement as it
   would do on any visited link, in order to perform the next binding
   flow.

   If the Mobile Router is configured to recognize the virtual Home
   Access Links as part of Home, it deregisters by sending a Binding
   update with null lifetime sourced at the CareOf. Alternatively, the
   Home Agent may indicate that the MR is Home as a negative status in
   the binding acknowledgement. This is achieved by a prefix
   comparison(s) between the care-of address and the prefix(es) on the
   virtual Home Access Link(s).

   With both approaches, the result of the binding flow is a
   deregistration. Consequently, both the Mobile Router and the Home
   Agent disable the bi-directional tunnel.  At that point, the Home
   Agent configures its forwarding in order to reach the Mobile Router
   and its mobile networks at Home. For instance, this may take the form
   of a route to the Mobile Network prefixes via the MR Home Address,
   and a connected host route to the MR Home Address via the virtual
   Home Access link.

   After successful binding de-registration, the Mobile Router MUST
   receive packets meant to the Mobile Router's Home Address at the
   Virtual Home Link. How to intercept packets addressed to the Home
   Address depends on implementations of the Mobile Router.  If the Home
   Address is not configured at the egress interface, the Mobile Router
   MUST use proxy Neighbor Discovery to intercept all packets addressed
   to the Home Address on the virtual Home Link.  Otherwise, the Mobile
   Router does not have to perform any special operation at the virtual
   Home Link.

   After all procedures are done successfully, all IPv6 traffic to and
   from the Mobile Network are routed without a bi-directonal tunnel
   between the Mobile Router and the Home Agent.




Thubert, et al.          Expires April 14, 2004                [Page 13]

Internet-Draft                Nemo usages                   October 2003


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights. Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in BCP-11. Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard. Please address the information to the IETF Executive
   Director.


Full Copyright Statement

   Copyright (C) The Internet Society (2003). All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION



Thubert, et al.          Expires April 14, 2004                [Page 14]

Internet-Draft                Nemo usages                   October 2003


   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.











































Thubert, et al.          Expires April 14, 2004                [Page 15]

