<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>PATCH Method for HTTP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="PATCH Method for HTTP">
<meta name="keywords" content="I-D, webdav, http, simple, patch, deltav, delta, instance">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Individual Submission</td><td class="header">L. Dusseault</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">OSAF</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Snell</td></tr>
<tr><td class="header">Expires: July 6, 2008</td><td class="header">January 03, 2008</td></tr>
</table></td></tr></table>
<h1><br />PATCH Method for HTTP<br />draft-dusseault-http-patch-11</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 6, 2008.</p>

<h3>Abstract</h3>

<p>Several applications extending HTTP require a feature to do 
      partial resource modification.  Existing HTTP functionality only allows 
      a complete replacement of a document. This proposal adds a new HTTP 
      method, PATCH, to modify an existing HTTP resource.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#patch">2.</a>&nbsp;
The PATCH Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">2.1.</a>&nbsp;
A simple PATCH example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">2.2.</a>&nbsp;
Error handling<br />
<a href="#adv">3.</a>&nbsp;
Advertising Support in OPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#accept-patch">3.1.</a>&nbsp;
The Accept-Patch Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.2.</a>&nbsp;
An example OPTIONS request and response<br />
<a href="#anchor4">4.</a>&nbsp;
209 Content Returned<br />
<a href="#anchor5">5.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.1.</a>&nbsp;
The 'Accept-Patch' Response Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.2.</a>&nbsp;
HTTP Status codes<br />
<a href="#anchor8">6.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#anchor11">Appendix&nbsp;A.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor12">Appendix&nbsp;B.</a>&nbsp;
Changes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">B.1.</a>&nbsp;
Changes from -00<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">B.2.</a>&nbsp;
Changes from -01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">B.3.</a>&nbsp;
Changes from -02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">B.4.</a>&nbsp;
Changes from -03<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">B.5.</a>&nbsp;
Changes from -04<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">B.6.</a>&nbsp;
Changes from -05<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">B.7.</a>&nbsp;
Changes from -06<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">B.8.</a>&nbsp;
Changes from -07<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">B.9.</a>&nbsp;
Changes from -08<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">B.10.</a>&nbsp;
Changes from -09<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">B.11.</a>&nbsp;
Changes from -10<br />
<a href="#anchor24">Appendix&nbsp;C.</a>&nbsp;
Notes to RFC Editor<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This specification defines the new HTTP 1.1 <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> method 
      PATCH that is used to apply partial modifications to a resource.
</p>
<p>A new method is necessary to improve interoperability and prevent errors.  
      The PUT method is already defined to overwrite a resource with a complete 
      new body, and can not be reused to do partial changes. Otherwise, proxies 
      and caches and even clients and servers may get confused as to the result 
      of the operation.
</p>
<p>In this document, the key words "MUST", "MUST NOT", "REQUIRED", "SHALL", 
      "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" 
      are to be  interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="patch"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
The PATCH Method</h3>

<p>The PATCH method requests that a set of changes described in 
         the request entity be applied to the resource identified by the Request-URI.
         The set of changes is represented in a format called a "patch document"
         identified by a media type. PATCH is neither safe or idempotent as defined 
         by <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> Section 9.1. If the Request-URI does not 
         point to an existing resource, and that URI is capable of being defined 
         as a new resource by the requesting user agent, the origin server can 
         create the resource with that URI.
</p>
<p>The difference between the PUT and PATCH requests is reflected in the
         way the server processes the enclosed entity to modify the resource 
         identified by the Request-URI.  In a PUT request, the enclosed entity
         is considered to be a modified version of the resource stored on the 
         origin server and the client is requesting that the stored version be replaced.
         With PATCH, however, the enclosed entity contains a set of instructions 
         describing how a resource currently residing on the origin server should
         be modified to produce a new version.  The changes described by the 
         entity MAY result in the creation of one or more new resources on the 
         server, however it is not intended that the body of the PATCH request 
         be used as the content of such resources.
</p>
<p>The server MUST apply the entire set of changes atomically and never
         provide (e.g. in response to a GET during this operation) a partially-modified 
         representation.  If the entire patch document cannot be successfully applied 
         then the server MUST fail the entire request, applying none of the changes. 
         The determination of what constitutes a successful PATCH can vary depending 
         on the patch document and the type of resource being modified. The actual 
         method for determining how to apply the patch document to the resource is 
         defined entirely by the origin server. See Error Handling in section 2.2 
         for details on status codes and possible error conditions.
</p>
<p>If the request passes through a cache and the Request-URI identifies
         one or more currently cached entities, those entries SHOULD be
         treated as stale. Responses to this method are not cacheable, unless
         the response includes appropriate Cache-Control or Expires header fields
         or the response uses the 209 Content Returned status code as defined in 
         Section 4. The 303 (See Other) response can be used to direct the user 
         agent to retrieve a cacheable resource.
</p>
<p>Collisions from multiple requests are more dangerous than PUT collisions, 
         because a patch document that is not operating from a known base point may 
         corrupt the resource.  Clients wishing to apply a patch document to a known 
         entity can first acquire the strong ETag of the resource to be modified, 
         and use that Etag in the If-Match header on the PATCH request to verify 
         that the resource is still unchanged.  If a strong ETag is not available 
         for a given resource, the client can use If-Unmodified-Since as a 
         less-reliable safeguard.
</p>
<p>It is RECOMMENDED that servers return a 501 (Not Implemented) response
         if a PATCH request contains any entity-headers the server does not 
         understand.  Unexpected or unintended results can occur if a server 
         ignores known or unknown entity headers included in the request. All 
         entity-headers contained in the request apply only to the contained 
         patch document and MUST NOT be applied to the resource being modified.
</p>
<p>There is no guarantee that a resource can be modified with PATCH. 
         Further, it is expected that different patch document formats will be 
         appropriate for different types of resources and that no single format 
         will be appropriate for all types of resources. Therefore, there is no single 
         default patch document format that implementations are required to support. 
         Servers MUST ensure that a received patch document is appropriate for the type
         of resource identified by the Request-URI.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
A simple PATCH example</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    PATCH /file.txt HTTP/1.1
    Host: www.example.com
    Content-type: application/example
    If-Match: "e0023aa4e"
    Content-Length: 100

    [description of changes]
</pre></div>
<p>This example illustrates use of a hypothetical patch document on an existing resource.
</p>
<p>Successful PATCH response to existing text file
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    HTTP/1.1 204 No Content
    ETag: "e0023aa4f"
    Content-MD5: Q2hlY2sgSW50ZWdyaXR5IQ==
</pre></div>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Error handling</h3>

<p>There are several known conditions under which a PATCH request can fail.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Malformed patch document:</dt>
<dd>  Can be specified using a 
          400 Bad Request when the server finds that the patch document provided 
          by the client was not properly formatted.  The definition of badly formatted 
          depends on the patch document chosen, but generally if the server finds it 
          cannot handle the patch due to the serialization of the patch document, 
          this response ought to be appropriate.
</dd>
<dt>Unsupported patch document:</dt>
<dd>  Can be Specified using a 415 Unsupported
          Media Type when the client sends a patch document format that the server
          does not support for the resource identified by the Request-URI. 
          Such a response SHOULD include an Accept-Patch response header as 
          described in Section 3.1 to notify the client what patch document formats 
          are supported.
</dd>
<dt>Unprocessable request:</dt>
<dd> Can be specified with a 422 Unprocessable
          Entity <a class='info' href='#RFC4918'>[RFC4918]<span> (</span><span class='info'>Dusseault, L., &ldquo;HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV),&rdquo; June&nbsp;2007.</span><span>)</span></a> when the server understands the patch 
          document and the syntax of the patch document appears valid, but the server 
          is incapable of processing the request. There are a number of situations that 
          could lead to such a result, for example:
            
          
<ul class="text">
<li>The client attempted to apply a patch document to an empty 
            or non-existent resource, but the patch document chosen cannot be 
            applied to an empty or non-existent resource. 
</li>
<li>The client attempted to apply a structural modification and 
            the structures assumed to exist did not exist (e.g. a patch  
            which specifies changing element 'foo' to element 'bar' but 
            element 'foo' doesn't exist).
</li>
<li>The client attempted to modify a resource in a way that would
            cause the resource to become invalid. For instance, a modification 
            to a well-formed XML document that would cause it to no longer 
            be well-formed.
</li>
<li>The client attempted to modify a resource that has multiple 
            representations but the server was unable to choose which 
            representation to modify.
</li>
</ul>
          
</dd>
<dt>Conflicting modification:</dt>
<dd> Specified with a 
          412 Precondition Failed when a client uses either the If-Match or
          If-Unmodified-Since request headers and attempts to apply a patch 
          document to a resource whose state has changed since the patch 
          was created. If the server detects a possible conflicting 
          modification and neither the If-Match or If-Unmodified-Since request
          headers are used, the server can return a 409 Conflict response.
</dd>
<dt>Concurrent modification:</dt>
<dd> When a server receives multiple
          concurrent requests to modify a resource, those requests SHOULD be
          queued and processed in the order in which they are received. If
          a server is incapable of queuing concurrent requests, all subsequent 
          requests SHOULD be rejected with a 409 Conflict until the first 
          modification request is complete.
</dd>
</dl></blockquote>

<p>Other HTTP status codes can also be used under the appropriate circumstances. 
</p>
<p>The entity body of error responses SHOULD contain enough information
          to communicate the nature of the error to the client. The content-type 
          of the response entity can vary across implementations.
</p>
<a name="adv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Advertising Support in OPTIONS</h3>

<p>A server can advertise its support for the PATCH method by adding
        it to the listing of allowed methods in the "Allow" OPTIONS response 
        header defined in HTTP/1.1.
</p>
<a name="accept-patch"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
The Accept-Patch Header</h3>

<p>Clients also need to know whether the server supports specific patch document
        formats, so this specification introduces a new response header "Accept-Patch"
        used to specify the patch document formats accepted by the server.
        "Accept-Patch" MUST appear in the OPTIONS response for any resource 
        that supports the use of the PATCH method.  The presence of the "Accept-Patch"
        header in response to any method is an implicit indication that PATCH is allowed 
        on the resource identified by the Request-URI.
</p>
<p>Accept-Patch = "Accept-Patch" ":" "*" | #( media-type )
</p>
<p>The Accept-Patch header specifies a comma separated listing of media-types
        as defined by <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>, Section 3.7. The asterisk 
        character "*" MAY be used to indicate that any patch format is accepted.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
An example OPTIONS request and response</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    [request]

    OPTIONS /example/buddies.xml HTTP/1.1
    Host: www.example.com

    [response]

    HTTP/1.1 200 OK
    Allow: GET, PUT, POST, OPTIONS, HEAD, DELETE, PATCH
    Accept-Patch: application/example, text/example

</pre></div>
<p>The examples show a server that supports PATCH generally using two 
        hypothetical patch document formats.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
209 Content Returned</h3>

<p>The 209 "Content Returned" status code can be used to indicate
      that a response is equivalent to what would have been returned
      with a 200 status code response to a GET sent to the URI immediately 
      following the successful completion of the request.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
The 'Accept-Patch' Response Header</h3>

<p>The 'Accept-Patch' response header should be added to the permanent 
        registry (see <a class='info' href='#RFC3864'>[RFC3864]<span> (</span><span class='info'>Klyne, G., Nottingham, M., and J. Mogul, &ldquo;Registration Procedures for Message Header Fields,&rdquo; September&nbsp;2004.</span><span>)</span></a>).
</p>
<p></p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Header field name: Accept-Patch

    Applicable Protocol: HTTP

    Status: standard

    Author/Change controller: IETF

    Specification document: this specification
</pre></div><p>

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
HTTP Status codes</h3>

<p>This specification defines the 209 Content Returned status code (Section 3) 
      to be updated in the registry at &lt;http://www.iana.org/assignments/http-status-codes&gt;.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>The security considerations for PATCH are nearly identical to the 
      security considerations for PUT.  In addition, one might be concerned that 
      a document that is patched might be more likely to be corrupted, but that 
      concern can be addressed through the use of mechanisms such as conditional
      requests using ETags and the If-Match request header.
</p>
<p>Sometimes an HTTP intermediary might try to detect viruses being sent via HTTP by 
      checking the body of the PUT/POST request or GET response.  The PATCH method 
      complicates such watch-keeping because neither the source document nor the patch
      document might be a virus, yet the result could be. This security consideration is
      not materially different from those already introduced by byte-range downloads, 
      downloading patch documents, uploading zipped (compressed) files and so on.
</p>
<p>Individual patch documents will have their own specific security considerations
      that will likely vary depending on the types of resources being patched.
      The considerations for patched binary resources, for instance, will be different 
      than those for patched XML documents.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3864">[RFC3864]</a></td>
<td class="author-text">Klyne, G., Nottingham, M., and J. Mogul, &ldquo;<a href="http://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>,&rdquo; BCP&nbsp;90, RFC&nbsp;3864, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3864.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4918">[RFC4918]</a></td>
<td class="author-text">Dusseault, L., &ldquo;<a href="http://tools.ietf.org/html/rfc4918">HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV)</a>,&rdquo; RFC&nbsp;4918, June&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4918.txt">TXT</a>).</td></tr>
</table>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgements</h3>

<p>PATCH is not a new concept, it first appeared in HTTP in drafts of 
      version 1.1 written by Roy Fielding and Henrik Frystyk.
</p>
<p>Thanks to Adam Roach, Chris Sharp, Julian Reschke, Geoff Clemm,
      Scott Lawrence, Jeffrey Mogul, Roy Fielding, Greg Stein, Jim Luther, 
      Alex Rousskov, Jamie Lokier, Joe Hildebrand, Mark Nottingham and 
        Michael Balloni
      for review and advice on this document.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Changes</h3>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
Changes from -00</h3>

<p>OPTIONS support: removed "Patch" header definition and used
        Allow and new "Accept-Patch" headers instead.  
</p>
<p>Supported delta encodings: removed vcdiff and diffe as these
        do not have defined MIME types and did not seem to be strongly 
        desired.
</p>
<p>PATCH method definition: Clarified cache behavior.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
Changes from -01</h3>

<p>Removed references to XCAP - not yet a RFC.
</p>
<p>Fixed use of MIME types (this "fix" now obsolete) 
</p>
<p>Explained how to use MOVE or COPY in conjunction with PATCH,
        to create a new resource based on an existing resource
        in a different location. 
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3"></a><h3>B.3.&nbsp;
Changes from -02</h3>

<p>Clarified that MOVE and COPY are really independent of PATCH.
</p>
<p>Clarified when an ETag must change, and when Last-Modified must be used.
</p>
<p>Clarified what server should do if both Content-Type and IM headers appear 
        in PATCH request.
</p>
<p>Filled in missing reference to DeltaV and ACL RFCs.
</p>
<p>Stopped using 501 Unsupported for unsupported delta encodings.
</p>
<p>Clarified what a static resource is.
</p>
<p>Refixed use of MIME types for patch formats.
</p>
<p>Limited the scope of some restrictions to apply only to usage
        of required diff format.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.4"></a><h3>B.4.&nbsp;
Changes from -03</h3>

<p>Various typographical, terminology consistency, and other minor
        clarifications or fixes.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.5"></a><h3>B.5.&nbsp;
Changes from -04</h3>

<p>Moved paragraphs on ACL and RFC3229 interoperability to new section.
</p>
<p>Added security considerations.
</p>
<p>Added IANA considerations, registration of new namespace, and discontinued use
        of "DAV:" namespace for new elements. 
</p>
<p>Added example of error response.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.6"></a><h3>B.6.&nbsp;
Changes from -05</h3>

<p>Due to various concerns it didn't seem likely the application/gdiff
          registration could go through so switching to vcdiff as required 
        diff format, and to RFC3229's approach to specifying diff formats, including
        use of the IM header.
</p>
<p>Clarified what header server MUST use to return MD5 hash.
</p>
<p>Reverted to  using 501 Unsupported for unsupported delta encodings.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.7"></a><h3>B.7.&nbsp;
Changes from -06</h3>

<p>The reliance on RFC 3229 defined patch documents has been factored
        out in favor of delta encodings identified by MIME media type.
</p>
<p>The required use of DeltaV-based error reporting has been removed
        in favor of using basic HTTP status codes to report error conditions.
</p>
<p>The Accept-Patch response header has been redefined as a listing of
        media-ranges, similar to the Accept request header.
</p>
<p>Added James Snell as a co-author.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.8"></a><h3>B.8.&nbsp;
Changes from -07</h3>

<p>Terminology change from "delta encoding" to "patch document"
</p>
<p>Added clarification on the safety and idempotency of PATCH
</p>
<p>Updated the caching rules of PATCH responses
</p>
<p>200 responses MUST include a representation of the modified resource. 
        204 responses are used to indicate successful response without returning a representation.
</p>
<p>Suggest using 422 Unprocessable Entity to indicate that a properly formatted patch document cannot be processed
</p>
<p>Clarify the use of 412 and 409 to indicate concurrent and conflicting resource modifications.
</p>
<p>Added registration for the Accept-Patch header.
</p>
<p>Relaxed the requirements for the use of If-Match and If-Unmodified-Since.
</p>
<p>Add language that clarifies the difference between PUT and PATCH.
</p>
<p>Add language that clarifies the issues with PATCH and Content Negotiation.
</p>
<p>Use of Accept-Patch on any response implies that PATCH is supported.
</p>
<p>Add language advising caution when pipelining PATCH requests.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.9"></a><h3>B.9.&nbsp;
Changes from -08</h3>

<p>Addition of the 209 Content Returned status code
</p>
<p>Addition of the Prefer header field mechanism
</p>
<p>Removed the paragraph discussing the use of 200+Content-Location. This 
        is replaced by the 209 Content Returned status code.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.10"></a><h3>B.10.&nbsp;
Changes from -09</h3>

<p>Move the prefer header to a separate document
</p>
<p>Restructure the document sections.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.11"></a><h3>B.11.&nbsp;
Changes from -10</h3>

<p>Remove paragraph about pipelined requests. This is covered adequately by RFC2616.
</p>
<p>Remove paragraph about content negotiation. This is covered adequately by RFC2616.
</p>
<p>Explicitly indicate that PATCH can be used to create new resources.
</p>
<p>Remove recommendation for servers to provide strong etags. This is recommendation is implied and does
        not need to be explicitly.
</p>
<p>Change Allow-Patch to a listing of media-type and not media-range.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Notes to RFC Editor</h3>

<p>The RFC Editor should remove this section and the Changes section.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lisa Dusseault</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Open Source Application Foundation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2064 Edgewood Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Palo Alto, CA  94303</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:lisa@osafoundation.org">lisa@osafoundation.org</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">James M Snell</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jasnell@gmail.com">jasnell@gmail.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.snellspace.com">http://www.snellspace.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
