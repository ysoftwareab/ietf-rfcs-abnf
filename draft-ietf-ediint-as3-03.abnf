AS3-text = "!" /           ; printable ASCII characters
                  %d35-91 /       ; except double-quote (%d34)
                  %d93-126        ; or backslash (%d92)
                
AS3-qtext = AS3-text / SP  ; allow space only in quoted text

AS3-quoted-pair = "\" DQUOTE /  ; \" or
                         "\" "\"       ; \\
                                           
AS3-quoted-name = DQUOTE 1*128( AS3-qtext / 
                         AS3-quoted-pair) DQUOTE

AS3-atomic-name = 1*128AS3-text

AS3-name = AS3-atomic-name / AS3-quoted-name

protocol = "application/pkcs7-signature"

MDN-request-header = "Disposition-notification-to" ":" ftp-url

signed-receipt-protocol=optional, pkcs7-signature;    
signed-receipt-micalg=optional, sha1, md5

Disposition-notification-options =
          "Disposition-Notification-Options" ":" 
           disposition-notification-parameters 

disposition-notification-parameters =
               parameter *(";" parameter)

parameter = attribute "=" importance ", " 1#value"

importance = "required" | "optional"

signed-receipt-protocol=optional, <protocol symbol>;
signed-receipt-micalg=optional, <micalg1>, <micalg2>,...;
        
AS3-MDN = *(( MIME-message-headers | entity-headers )CRLF)
                CRLF
                AS3-MDN-body

AS3-MDN-body =
                AS3-signed-MDN-body | AS3-unsigned-MDN-body

AS3-disposition-notification-content =
               [ reporting-ua-field CRLF ]
               [ mdn-gateway-field CRLF ]
               [ original-recipient-field CRLF ]
               final-recipient-field CRLF
               [ original-message-id-field CRLF ]
               AS3-disposition-field CRLF
               *( failure-field CRLF )
               *( error-field CRLF )
               *( warning-field CRLF )
               *( extension-field CRLF )
               [ AS3-received-content-MIC-field CRLF ]
      
AS3-disposition-field = "Disposition" ":" disposition-mode ";"
                    AS3-disposition-type [ '/' AS3-disposition-modifier ]

disposition-mode = action-mode "/" sending-mode

action-mode = "manual-action" | "automatic-action"

sending-mode = "MDN-sent-manually" | "MDN-sent-automatically"

AS3-disposition-type = "processed" | "failed"

AS3-disposition-modifier = ( "error" | "warning" ) | 
                                AS3-disposition-modifier-extension

AS3-disposition-modifier-extension =
                "error: authentication-failed" |
                "error: decompression-failed" |
                "error: decryption-failed" |
                "error: insufficient-message-security" |
                "error: integrity-check-failed" |
                "error: unexpected-processing-error" |
                "warning: " AS3-MDN-warning-description |
                "failure: " AS3-MDN-failure-description

AS3-MDN-warning-description = *( TEXT )

AS3-MDN-failure-description = *( TEXT )

AS3-received-content-MIC-field =
                 "Received-content-MIC" ":" encoded-message-digest 
                 "," digest-alg-id CRLF

encoded-message-digest =
                1*( 'A'-Z' | 'a'-'z' | '0'-'9' | '/' | '+' ) 0*3( '=' )
                ( i.e. base64( message-digest ) )

digest-alg-id = "sha1" | "md5"

protocol=optional,pkcs7-signature; 
signed-receipt-micalg=optional,sha1
protocol="application/pkcs7-signature"; micalg=sha1
protocol="application/pkcs7-signature"; 
boundary="----=_Part_57_648441049.1028122454671"
