Internet Engineering Task Force                                 MAGMA WG
INTERNET-DRAFT                                     Isidor Kouvelas/Cisco
draft-ietf-magma-mrdssm-03.txt                              17 June 2003
                                                  Expires: December 2003


              Multicast Router Discovery SSM Range Option



Status of this Document

This document is an Internet-Draft and is in full conformance with all
provisions of Section 10 of RFC2026.

Internet-Drafts are working documents of the Internet Engineering Task
Force (IETF), its areas, and its working groups.  Note that other groups
may also distribute working documents as Internet-Drafts.

Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use Internet- Drafts as reference material
or to cite them other than as "work in progress."

The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt

The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.

This document is a product of the IETF MAGMA WG.  Comments should be
addressed to the authors, or the WG's mailing list at magma@ietf.org.

                                Abstract


     This document defines the Multicast Router Discovery protocol
     option for advertising the configured IPv4 Source Specific
     Multicast destination address range.









Kouvelas                                                        [Page 1]

INTERNET-DRAFT           Expires: December 2003                June 2003


1.  Introduction

     With current multicast deployment in the Internet, different
multicast routing protocols coexist and operate under separate parts of
the multicast address space [1]. Multicast routers are consistently
configured with information that maps specific multicast destination
address ranges to multicast routing protocols. Part of this
configuration describes the subset of the address space that is used by
source-specific multicast (SSM) [3]. Under current deployment, the
ability to extend the IPv4 SSM destination address range is used to
define SSM destination addresses that operate within administratively
scoped boundaries.  Note that the SSM range for IPv6 is well defined for
all valid scopes [4] and a mechanism to allow additional ranges to
operate in SSM mode on a per-link bases is not required.

     There are currently two requirements for a router to advertise its
configured SSM range on its attached links:

o On links with multiple multicast routers, advertisement of the
  configured SSM range by each router can be used to discover
  misconfigurations.

o IP systems with multicast sources or receivers can use the
  advertisements to learn the SSM group range with which the network is
  configured.


     This document defines an optional extension for the IPv4 Multicast
Router Discovery protocol [2] that can be used by a router to advertise
the configured SSM address range.


2.  SSM Range Discovery Option Format

     The SSM Range Discovery option SHOULD be included in all Multicast
Router Advertisement messages [2]. It contains the list of multicast
destination address ranges that are configured to operate under Source
Specific Multicast on this router.  The format of the option is as
follows:












Kouvelas                                            Section 2.  [Page 2]

INTERNET-DRAFT           Expires: December 2003                June 2003


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Type=X     |   Length=var  |  Mask-Len-1   |    Prefix-1 ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Mask-Len-2   |   Prefix-2 ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            ...                                |



Type The type value of the Multicast Router Advertisement SSM Range
     Discovery option is X (TBD by IANA).


Length
     The length of the option in octets excluding the type and length
     fields. The length of the SSM Range Discovery option is variable
     and depends on the number of destination ranges present in the
     option as well as the sizes of the ranges.


Mask-Len-n
     The mask length in bits for the nth address range.


Prefix-n
     The multicast destination address prefix for the nth range present
     in this option. The size of the prefix field is variable and
     depends on the number of significant bits in the prefix (specified
     in the corresponding Mask-Len field). The field is padded by enough
     trailing bits to make the end of the field fall on an octet
     boundary. The value of the trailing bits must be sent as zero and
     ignored on receipt. For example a prefix with a mask length field
     holding the value 16 would have a prefix field that takes up two
     octets and requires no padding.  A prefix with a mask length of 17
     would have a prefix field that takes up three octets and includes 7
     trailing padding bits.


3.  Notes on Option Processing

     Routers originating Multicast Router Advertisement messages SHOULD
NOT include more than one SSM Range Discovery option in each message.
Systems with a multicast capable IP host stack that receive a Multicast
Router Advertisement message with more than one SSM Range Discovery
options MUST only use the prefixes from the last SSM Range Discovery
option in the message as the active SSM range.



Kouvelas                                            Section 3.  [Page 3]

INTERNET-DRAFT           Expires: December 2003                June 2003


     The SSM range specified by routers originating Multicast Router
Advertisement messages with the SSM Range Discovery option MUST not
include any part of the link-local multicast range 224.0.0/24.  Systems
with a multicast capable IP host stack that receive a Multicast Router
Advertisement message with a SSM Range Discovery option that includes
destination addresses in the link-local multicast range 224.0.0/24 MUST
use as the active SSM range the contents of the option excluding any
addresses in the range 224.0.0/24.

     A router receiving a Multicast Router Advertisement message with an
SSM Range Discovery option MUST compare the contents of the option with
the multicast address ranges in the local SSM configuration and signal
any differences to the administrator in a rate-limited manner.
Signaling of range differences may be accomplished by a mechanism as
simple as an entry in the router log containing the address of the
router with the mismatch in configuration.


4.  Security Considerations

     Multicast Router Advertisement messages are IGMP messages sent to
the All-Systems multicast group (224.0.0.1) which is not forwarded by
routers. Only rogue systems on a connected link can masquerade as
multicast routers. Such rogue systems can include the SSM Range
Discovery option in their messages and cause the SSM range mapping to be
incorrectly set by hosts on the link. The next Multicast Router
Advertisement from a real valid router on the link will restore the
correct mapping. This spec mandates that routers log the reception of
inconsistent range advertisements which makes it easier to detect rogue
systems.


5.  IANA Considerations

     This document introduces the new SSM Range Discovery option for the
Multicast Router Discovery protocol. This option requires a new MRD type
value to be assigned by IANA.


6.  Acknowledgments

The author would like to thank Bill Fenner and Dave Thaler for their
contribution to this document.








Kouvelas                                            Section 7.  [Page 4]

INTERNET-DRAFT           Expires: December 2003                June 2003


7.  Authors' Addresses

     Isidor Kouvelas
     Cisco Systems
     170 W. Tasman Drive
     San Jose, CA 95134
     kouvelas@cisco.com



8.  Normative References

[1] Z. Albanna, K. Almeroth, D. Meyer, M. Schipper, "IANA Guidelines for
     IPv4 Multicast Address Assignments", RFC 3171 (BCP 51), August
     2001.

[2] S. Biswas, B. Haberman, "IGMP Multicast Router Discovery", Work In
     Progress, <draft-ietf-idmr-igmp-mrdisc-??.txt>, 2002.


9.  Informative References

[3] H. Holbrook, B. Cain, "Source-Specific Multicast for IP", work in
     progress, <draft-ietf-ssm-arch-00.txt>, 21 November 2001.

[4] B. Haberman, D. Thaler, "Unicast-Prefix-based IPv6 Multicast
     Addresses", RFC 3306, August 2002.
























Kouvelas                                            Section 9.  [Page 5]

INTERNET-DRAFT           Expires: December 2003                June 2003





















































Kouvelas                                            Section 9.  [Page 6]
