aad = concat(encode(1, keyID),
                encode(2, kdfID),
                encode(2, aeadID))
ct = context.Seal(aad, request)
enc_request = concat(aad, enc, ct)

aad = concat(encode(1, keyID),
                encode(2, kdfID),
                encode(2, aeadID))
context = SetupBaseR(enc, skR, "request")
secret = context.Export("response", Nk)
response_nonce = random(max(Nn, Nk))
salt = concat(enc, response_nonce)
prk = Extract(salt, secret)
aead_key = Expand(secret, "key", Nk)
aead_nonce = Expand(secret, "nonce", Nn)
ct = Seal(aead_key, aead_nonce, "", response)
enc_response = concat(response_nonce, ct)

