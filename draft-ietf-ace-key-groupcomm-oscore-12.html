<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Key Management for OSCORE Groups in ACE</title>
<meta content="Marco Tiloca" name="author">
<meta content="Jiye Park" name="author">
<meta content="Francesca Palombini" name="author">
<meta content="
       This document defines an application profile of the ACE framework for Authentication and Authorization, to request and provision keying material in group communication scenarios that are based on CoAP and secured with Group Object Security for Constrained RESTful Environments (OSCORE). This application profile delegates the authentication and authorization of Clients that join an OSCORE group through a Resource Server acting as Group Manager for that group. This application profile leverages protocol-specific transport profiles of ACE to achieve communication security, server authentication and proof-of-possession for a key owned by the Client and bound to an OAuth 2.0 Access Token. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-ace-key-groupcomm-oscore-12" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-ace-key-groupcomm-oscore-12-va_6ptz2.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Key Management for OSCORE Groups in ACE</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tiloca, et al.</td>
<td class="center">Expires 28 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ace-key-groupcomm-oscore-12</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-25" class="published">25 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-28">28 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">J. Park</div>
<div class="org">Universitaet Duisburg-Essen</div>
</div>
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Key Management for OSCORE Groups in ACE</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines an application profile of the ACE framework for Authentication and Authorization, to request and provision keying material in group communication scenarios that are based on CoAP and secured with Group Object Security for Constrained RESTful Environments (OSCORE). This application profile delegates the authentication and authorization of Clients that join an OSCORE group through a Resource Server acting as Group Manager for that group. This application profile leverages protocol-specific transport profiles of ACE to achieve communication security, server authentication and proof-of-possession for a key owned by the Client and bound to an OAuth 2.0 Access Token.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-protocol-overview" class="xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-overview-of-the-joining-pro" class="xref">Overview of the Joining Process</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-overview-of-the-group-rekey" class="xref">Overview of the Group Rekeying Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-stale-oscore-sender-ids" class="xref">Stale OSCORE Sender IDs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-format-of-scope" class="xref">Format of Scope</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-joining-node-to-authorizati" class="xref">Joining Node to Authorization Server</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-authorization-request" class="xref">Authorization Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-authorization-response" class="xref">Authorization Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-interface-at-the-group-mana" class="xref">Interface at the Group Manager</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-ace-group-groupname-active" class="xref">ace-group/GROUPNAME/active</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-get-handler" class="xref">GET Handler</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-ace-group-groupname-verif-d" class="xref">ace-group/GROUPNAME/verif-data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-get-handler-2" class="xref">GET Handler</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-ace-group-groupname-stale-s" class="xref">ace-group/GROUPNAME/stale-sids</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-fetch-handler" class="xref">FETCH Handler</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-admitted-methods" class="xref">Admitted Methods</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-operations-supported-by-cli" class="xref">Operations Supported by Clients</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-token-transferring-and-grou" class="xref">Token Transferring and Group Joining</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-token-transferring" class="xref">Token Transferring</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-ecdh_info-parameter" class="xref">'ecdh_info' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-gm_dh_pub_keys-parameter" class="xref">'gm_dh_pub_keys' Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-send-the-joining-request" class="xref">Send the Joining Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-value-of-the-n_s-challenge" class="xref">Value of the N_S Challenge</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-receive-the-joining-request" class="xref">Receive the Joining Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-send-the-joining-response" class="xref">Send the Joining Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-receive-the-joining-respons" class="xref">Receive the Joining Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-public-keys-of-joining-node" class="xref">Public Keys of Joining Nodes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-retrieve-of-updated-keying-" class="xref">Retrieve of Updated Keying Material</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-retrieve-of-group-keying-ma" class="xref">Retrieve of Group Keying Material</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-retrieve-of-group-keying-mat" class="xref">Retrieve of Group Keying Material and OSCORE Sender ID</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-request-to-change-individua" class="xref">Request to Change Individual Keying Material</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-retrieve-public-keys-of-gro" class="xref">Retrieve Public Keys of Group Members</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-upload-a-new-public-key" class="xref">Upload a New Public Key</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-retrieve-the-group-managers" class="xref">Retrieve the Group Manager's Public Key</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-retrieve-signature-verifica" class="xref">Retrieve Signature Verification Data</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-retrieve-the-group-policies" class="xref">Retrieve the Group Policies</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-retrieve-the-keying-materia" class="xref">Retrieve the Keying Material Version</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-retrieve-the-group-status" class="xref">Retrieve the Group Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="xref">17</a>. <a href="#name-retrieve-group-names" class="xref">Retrieve Group Names</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="xref">18</a>. <a href="#name-leave-the-group" class="xref">Leave the Group</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-19" class="xref">19</a>. <a href="#name-removal-of-a-group-member" class="xref">Removal of a Group Member</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#section-20" class="xref">20</a>. <a href="#name-group-rekeying-process" class="xref">Group Rekeying Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a href="#section-20.1" class="xref">20.1</a>.  <a href="#name-sending-rekeying-messages" class="xref">Sending Rekeying Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a href="#section-20.2" class="xref">20.2</a>.  <a href="#name-receiving-rekeying-messages" class="xref">Receiving Rekeying Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.3">
                <p id="section-toc.1-1.20.2.3.1"><a href="#section-20.3" class="xref">20.3</a>.  <a href="#name-missed-rekeying-instances" class="xref">Missed Rekeying Instances</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.3.2.1">
                    <p id="section-toc.1-1.20.2.3.2.1.1"><a href="#section-20.3.1" class="xref">20.3.1</a>.  <a href="#name-retrieval-of-stale-sender-i" class="xref">Retrieval of Stale Sender IDs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#section-21" class="xref">21</a>. <a href="#name-ace-groupcomm-parameters" class="xref">ACE Groupcomm Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#section-22" class="xref">22</a>. <a href="#name-ace-groupcomm-error-identif" class="xref">ACE Groupcomm Error Identifiers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#section-23" class="xref">23</a>. <a href="#name-default-values-for-group-co" class="xref">Default Values for Group Configuration Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23.2.1">
                <p id="section-toc.1-1.23.2.1.1"><a href="#section-23.1" class="xref">23.1</a>.  <a href="#name-common" class="xref">Common</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23.2.2">
                <p id="section-toc.1-1.23.2.2.1"><a href="#section-23.2" class="xref">23.2</a>.  <a href="#name-group-mode" class="xref">Group Mode</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23.2.3">
                <p id="section-toc.1-1.23.2.3.1"><a href="#section-23.3" class="xref">23.3</a>.  <a href="#name-pairwise-mode" class="xref">Pairwise Mode</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24">
            <p id="section-toc.1-1.24.1"><a href="#section-24" class="xref">24</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1">
                <p id="section-toc.1-1.24.2.1.1"><a href="#section-24.1" class="xref">24.1</a>.  <a href="#name-management-of-oscore-groups" class="xref">Management of OSCORE Groups</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2">
                <p id="section-toc.1-1.24.2.2.1"><a href="#section-24.2" class="xref">24.2</a>.  <a href="#name-size-of-nonces-as-proof-of-" class="xref">Size of Nonces as Proof-of-Possesion Challenge</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.3">
                <p id="section-toc.1-1.24.2.3.1"><a href="#section-24.3" class="xref">24.3</a>.  <a href="#name-reusage-of-nonces-for-proof" class="xref">Reusage of Nonces for Proof-of-Possession Input</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25">
            <p id="section-toc.1-1.25.1"><a href="#section-25" class="xref">25</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.1">
                <p id="section-toc.1-1.25.2.1.1"><a href="#section-25.1" class="xref">25.1</a>.  <a href="#name-oauth-parameters" class="xref">OAuth Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.2">
                <p id="section-toc.1-1.25.2.2.1"><a href="#section-25.2" class="xref">25.2</a>.  <a href="#name-oauth-parameters-cbor-mappi" class="xref">OAuth Parameters CBOR Mappings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.3">
                <p id="section-toc.1-1.25.2.3.1"><a href="#section-25.3" class="xref">25.3</a>.  <a href="#name-ace-groupcomm-parameters-2" class="xref">ACE Groupcomm Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.4">
                <p id="section-toc.1-1.25.2.4.1"><a href="#section-25.4" class="xref">25.4</a>.  <a href="#name-ace-groupcomm-key-types" class="xref">ACE Groupcomm Key Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.5">
                <p id="section-toc.1-1.25.2.5.1"><a href="#section-25.5" class="xref">25.5</a>.  <a href="#name-ace-groupcomm-profiles" class="xref">ACE Groupcomm Profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.6">
                <p id="section-toc.1-1.25.2.6.1"><a href="#section-25.6" class="xref">25.6</a>.  <a href="#name-oscore-security-context-par" class="xref">OSCORE Security Context Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.7">
                <p id="section-toc.1-1.25.2.7.1"><a href="#section-25.7" class="xref">25.7</a>.  <a href="#name-tls-exporter-labels" class="xref">TLS Exporter Labels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.8">
                <p id="section-toc.1-1.25.2.8.1"><a href="#section-25.8" class="xref">25.8</a>.  <a href="#name-aif" class="xref">AIF</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.9">
                <p id="section-toc.1-1.25.2.9.1"><a href="#section-25.9" class="xref">25.9</a>.  <a href="#name-media-type-registrations" class="xref">Media Type Registrations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.10">
                <p id="section-toc.1-1.25.2.10.1"><a href="#section-25.10" class="xref">25.10</a>. <a href="#name-coap-content-format" class="xref">CoAP Content-Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.11">
                <p id="section-toc.1-1.25.2.11.1"><a href="#section-25.11" class="xref">25.11</a>. <a href="#name-group-oscore-roles" class="xref">Group OSCORE Roles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.12">
                <p id="section-toc.1-1.25.2.12.1"><a href="#section-25.12" class="xref">25.12</a>. <a href="#name-core-resource-type" class="xref">CoRE Resource Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.13">
                <p id="section-toc.1-1.25.2.13.1"><a href="#section-25.13" class="xref">25.13</a>. <a href="#name-ace-scope-semantics" class="xref">ACE Scope Semantics</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.14">
                <p id="section-toc.1-1.25.2.14.1"><a href="#section-25.14" class="xref">25.14</a>. <a href="#name-ace-groupcomm-errors" class="xref">ACE Groupcomm Errors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.15">
                <p id="section-toc.1-1.25.2.15.1"><a href="#section-25.15" class="xref">25.15</a>. <a href="#name-expert-review-instructions" class="xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26">
            <p id="section-toc.1-1.26.1"><a href="#section-26" class="xref">26</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.1">
                <p id="section-toc.1-1.26.2.1.1"><a href="#section-26.1" class="xref">26.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.2">
                <p id="section-toc.1-1.26.2.2.1"><a href="#section-26.2" class="xref">26.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.27">
            <p id="section-toc.1-1.27.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-profile-requirements" class="xref">Profile Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.27.2.1">
                <p id="section-toc.1-1.27.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-mandatory-to-address-requir" class="xref">Mandatory-to-Address Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.27.2.2">
                <p id="section-toc.1-1.27.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-optional-to-address-require" class="xref">Optional-to-Address Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.28">
            <p id="section-toc.1-1.28.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-extensibility-for-future-co" class="xref">Extensibility for Future COSE Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.28.2.1">
                <p id="section-toc.1-1.28.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-format-of-ecdh_info_entry" class="xref">Format of 'ecdh_info_entry'</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.28.2.2">
                <p id="section-toc.1-1.28.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-format-of-key" class="xref">Format of 'key'</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29">
            <p id="section-toc.1-1.29.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-document-updates" class="xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.1">
                <p id="section-toc.1-1.29.2.1.1"><a href="#appendix-C.1" class="xref">C.1</a>.  <a href="#name-version-11-to-12" class="xref">Version -11 to -12</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.2">
                <p id="section-toc.1-1.29.2.2.1"><a href="#appendix-C.2" class="xref">C.2</a>.  <a href="#name-version-10-to-11" class="xref">Version -10 to -11</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.3">
                <p id="section-toc.1-1.29.2.3.1"><a href="#appendix-C.3" class="xref">C.3</a>.  <a href="#name-version-09-to-10" class="xref">Version -09 to -10</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.4">
                <p id="section-toc.1-1.29.2.4.1"><a href="#appendix-C.4" class="xref">C.4</a>.  <a href="#name-version-08-to-09" class="xref">Version -08 to -09</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.5">
                <p id="section-toc.1-1.29.2.5.1"><a href="#appendix-C.5" class="xref">C.5</a>.  <a href="#name-version-07-to-08" class="xref">Version -07 to -08</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.6">
                <p id="section-toc.1-1.29.2.6.1"><a href="#appendix-C.6" class="xref">C.6</a>.  <a href="#name-version-06-to-07" class="xref">Version -06 to -07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.7">
                <p id="section-toc.1-1.29.2.7.1"><a href="#appendix-C.7" class="xref">C.7</a>.  <a href="#name-version-05-to-06" class="xref">Version -05 to -06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.8">
                <p id="section-toc.1-1.29.2.8.1"><a href="#appendix-C.8" class="xref">C.8</a>.  <a href="#name-version-04-to-05" class="xref">Version -04 to -05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.9">
                <p id="section-toc.1-1.29.2.9.1"><a href="#appendix-C.9" class="xref">C.9</a>.  <a href="#name-version-03-to-04" class="xref">Version -03 to -04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.10">
                <p id="section-toc.1-1.29.2.10.1"><a href="#appendix-C.10" class="xref">C.10</a>. <a href="#name-version-02-to-03" class="xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.11">
                <p id="section-toc.1-1.29.2.11.1"><a href="#appendix-C.11" class="xref">C.11</a>. <a href="#name-version-01-to-02" class="xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29.2.12">
                <p id="section-toc.1-1.29.2.12.1"><a href="#appendix-C.12" class="xref">C.12</a>. <a href="#name-version-00-to-01" class="xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.30">
            <p id="section-toc.1-1.30.1"><a href="#appendix-D" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.31">
            <p id="section-toc.1-1.31.1"><a href="#appendix-E" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec-introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> is a method for application-layer protection of the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, using CBOR Object Signing and Encryption (COSE) <span>[<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span><span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span> and enabling end-to-end security of CoAP payload and options.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">As described in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, Group OSCORE is used to protect CoAP group communication over IP multicast <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>. This relies on a Group Manager, which is responsible for managing an OSCORE group and enables the group members to exchange CoAP messages secured with Group OSCORE. The Group Manager can be responsible for multiple groups, coordinates the joining process of new group members, and is entrusted with the distribution and renewal of group keying material.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document is an application profile of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, which itself builds on the ACE framework for Authentication and Authorization <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. Message exchanges among the participants as well as message formats and processing follow what specified in <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> for provisioning and renewing keying material in group communication scenarios, where Group OSCORE is used to protect CoAP group communication over IP multicast.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="ssec-terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span><span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">The terms and concepts described in the ACE framework for authentication and authorization <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and in the Authorization Information Format (AIF) <span>[<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span> to express authorization information. The terminology for entities in the considered architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>. In particular, this includes Client (C), Resource Server (RS), and Authorization Server (AS).<a href="#section-1.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-3.2">The terms and concept related to the message formats and processing specified in <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, for provisioning and renewing keying material in group communication scenarios.<a href="#section-1.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-3.3">The terms and concepts described in CBOR <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span> and COSE <span>[<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span><span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>.<a href="#section-1.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-3.4">The terms and concepts described in CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> and group communication for CoAP <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>. Unless otherwise indicated, the term "endpoint" is used here following its OAuth definition, aimed at denoting resources such as /token and /introspect at the AS, and /authz-info at the RS. This document does not use the CoAP definition of "endpoint", which is "An entity participating in the CoAP protocol".<a href="#section-1.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-3.5">The terms and concepts for protection and processing of CoAP messages through OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and through Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> in group communication scenarios. These include the concept of Group Manager, as the entity responsible for a set of groups where communications are secured with Group OSCORE. In this document, the Group Manager acts as Resource Server.<a href="#section-1.1-3.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-4">Additionally, this document makes use of the following terminology.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-5.1">Requester: member of an OSCORE group that sends request messages to other members of the group.<a href="#section-1.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.2">Responder: member of an OSCORE group that receives request messages from other members of the group. A responder may reply back, by sending a response message to the requester which has sent the request message.<a href="#section-1.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.3">Monitor: member of an OSCORE group that is configured as responder and never replies back to requesters after receiving request messages. This corresponds to the term "silent server" used in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-1.1-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.4">Signature verifier: entity external to the OSCORE group and intended to verify the signature of messages exchanged in the group (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.1" class="relref">3.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-8.5" class="relref">8.5</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). An authorized signature verifier does not join the OSCORE group as an actual member, yet it can retrieve the public keys of the current group members from the Group Manager.<a href="#section-1.1-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.5">Signature-only group: an OSCORE group that uses only the group mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-1.1-5.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.6">Pairwise-only group: an OSCORE group that uses only the pairwise mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-9" class="relref">Section 9</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-1.1-5.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-protocol-overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">Group communication for CoAP over IP multicast has been enabled in <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span> and can be secured with Group Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> as described in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. A network node joins an OSCORE group by interacting with the responsible Group Manager. Once registered in the group, the new node can securely exchange messages with other group members.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document describes how to use <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> and <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> to perform a number of authentication, authorization and key distribution actions, as overviewed in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, when the considered group is specifically an OSCORE group.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">With reference to <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>:<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1">The node wishing to join the OSCORE group, i.e., the joining node, is the Client.<a href="#section-2-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-4.2">The Group Manager is the Key Distribution Center (KDC), acting as a Resource Server.<a href="#section-2-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-4.3">The Authorization Server associated to the Group Manager is the AS.<a href="#section-2-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-5">All communications between the involved entities MUST be secured.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">In particular, communications between the Client and the Group Manager leverage protocol-specific transport profiles of ACE to achieve communication security, proof-of-possession and server authentication. It is expected that, in the commonly referred base-case of this document, the transport profile to use is pre-configured and well-known to nodes participating in constrained applications.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7"><a href="#profile-req" class="xref">Appendix A</a> lists the specifications on this application profile of ACE, based on the requirements defined in Appendix A of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-2-7" class="pilcrow">¶</a></p>
<div id="ssec-overview-join-process">
<section id="section-2.1">
        <h3 id="name-overview-of-the-joining-pro">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-overview-of-the-joining-pro" class="section-name selfRef">Overview of the Joining Process</a>
        </h3>
<p id="section-2.1-1">A node performs the steps described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1.1" class="relref">Section 4.3.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> in order to join an OSCORE group. The format and processing of messages exchanged among the participants are further specified in <a href="#sec-joining-node-to-AS" class="xref">Section 4</a> and <a href="#sec-joining-node-to-GM" class="xref">Section 6</a> of this document.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-overview-group-rekeying-process">
<section id="section-2.2">
        <h3 id="name-overview-of-the-group-rekey">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-overview-of-the-group-rekey" class="section-name selfRef">Overview of the Group Rekeying Process</a>
        </h3>
<p id="section-2.2-1">In a number of cases, the Group Manager has to generate new keying material and distribute it to the group (rekeying), as also discussed in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">To this end the Group Manager MUST support the Group Rekeying Process described in <a href="#sec-group-rekeying-process" class="xref">Section 20</a> of this document, as an instance of the "Point-to-Point" rekeying scheme defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-6.1" class="relref">Section 6.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> and registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.14" class="relref">Section 11.14</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. Future documents may define the use of alternative group rekeying schemes for this application profile, together with the corresponding rekeying message formats. The resulting group rekeying process MUST comply with the functional steps defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">Upon generating the new group keying material and before starting its distribution, the Group Manager MUST increment the version number of the group keying material. When rekeying a group, the Group Manager MUST preserve the current value of the OSCORE Sender ID of each member in that group.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">The data distributed to a group through a rekeying MUST include:<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-5.1">The new version number of the group keying material for the group.<a href="#section-2.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-5.2">
            <p id="section-2.2-5.2.1">A new Group Identifier (Gid) for the group as introduced in <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, used as ID Context parameter of the Group OSCORE Common Security Context of that group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-2.2-5.2.1" class="pilcrow">¶</a></p>
<p id="section-2.2-5.2.2">
Note that the Gid differs from the group name also introduced in <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, which is a plain, stable and invariant identifier, with no cryptographic relevance and meaning.<a href="#section-2.2-5.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-5.3">A new value for the Master Secret parameter of the Group OSCORE Common Security Context of the group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-2.2-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-5.4">A set of stale Sender IDs, which allows each rekeyed node to purge public keys and Recipient Contexts used in the group and associated to those Sender IDs. This in turn allows every group member to rely on owned public keys to confidently assert the group membership of other sender nodes, when receiving protected messages in the group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). More details on the maintenance of stale Sender IDs are provided in <a href="#sssec-stale-sender-ids" class="xref">Section 2.2.1</a>.<a href="#section-2.2-5.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-6">Also, the data distributed through a group rekeying MAY include a new value for the Master Salt parameter of the Group OSCORE Common Security Context of that group.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2-7">The Group Manager MUST rekeying the group in the following cases.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-8.1">The application requires backward security - In this case, the group is rekeyed when a node joins the group as a new member. Therefore, a joining node cannot access communications in the group prior its joining.<a href="#section-2.2-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-8.2">
            <p id="section-2.2-8.2.1">One or more nodes leave the group - That is, the group is rekeyed when one or more current members spontaneously request to leave the group (see <a href="#sec-leave-req" class="xref">Section 18</a>), or when the Group Manager forcibly evicts them from the group, e.g., due to expired or revoked authorization (see <a href="#sec-leaving" class="xref">Section 19</a>). Therefore, a leaving node cannot access communications in the group after its leaving, thus ensuring forward security in the group.<a href="#section-2.2-8.2.1" class="pilcrow">¶</a></p>
<p id="section-2.2-8.2.2">
Due to the set of stale Sender IDs distributed through the rekeying, this ensures that a node owning the latest group keying material does not store the public keys of former group members (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2" class="relref">3.2</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-10.1" class="relref">10.1</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-2.2-8.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-8.3">Extension of group lifetime - That is, the group is rekeyed when the expiration time for the group keying material approaches or has passed, if it is appropriate to extend the group operation beyond that.<a href="#section-2.2-8.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-9">The Group Manager MAY rekey the group for other reasons, e.g., according to an application-dependent rekeying period or scheduling.<a href="#section-2.2-9" class="pilcrow">¶</a></p>
<div id="sssec-stale-sender-ids">
<section id="section-2.2.1">
          <h4 id="name-stale-oscore-sender-ids">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-stale-oscore-sender-ids" class="section-name selfRef">Stale OSCORE Sender IDs</a>
          </h4>
<p id="section-2.2.1-1">Throughout the lifetime of every group, the Group Manager MUST maintain a collection of stale Sender IDs for that group.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">The collection associated to a group MUST include up to N &gt; 1 ordered sets of stale OSCORE Sender IDs. It is up to the application to specify the value of N, possibly on a per-group basis.<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1-3">The N-th set includes the Sender IDs that have become "stale" under the current version V of the group keying material. The (N-1)-th set refers to the immediately previous version (V - 1) of the group keying material, and so on.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1-4">In the following cases, the Group Manager MUST add a new element to the most recent set X, i.e., the set associated to the current version V of the group keying material.<a href="#section-2.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-5.1">When a current group member obtains a new Sender ID, its old Sender ID is added to X. This happens when the Group Manager assigns a new Sender ID upon request from the group member (see <a href="#sec-new-key" class="xref">Section 9</a>), or in case the group member re-joins the group (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a> and <a href="#ssec-join-resp" class="xref">Section 6.4</a>), thus also obtaining a new Sender ID.<a href="#section-2.2.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.1-5.2">When a current group member leaves the group, its current Sender ID is added to X. This happens when a group member requests to leave the group (see <a href="#sec-leave-req" class="xref">Section 18</a>) or is forcibly evicted from the group (see <a href="#sec-leaving" class="xref">Section 19</a>).<a href="#section-2.2.1-5.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.1-6">The value of N can change throughout the lifetime of the group. If the new value N' is smaller than N, the Group Manager MUST preserve the (up to) N' most recent sets in the collection and MUST delete any possible older set from the collection.<a href="#section-2.2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.2.1-7">Finally, the Group Manager MUST perform the following actions, when the group is rekeyed and the group shifts to the next version V' = (V + 1) of the group keying material.<a href="#section-2.2.1-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.1-8">
<li id="section-2.2.1-8.1">The Group Manager rekeys the group. This includes also distributing the set of stale Sender IDs X associated to the old group keying material with version V (see <a href="#ssec-overview-group-rekeying-process" class="xref">Section 2.2</a>).<a href="#section-2.2.1-8.1" class="pilcrow">¶</a>
</li>
            <li id="section-2.2.1-8.2">After completing the group rekeying, the Group Manager creates a new empty set X' associated to the new version V' of the newly established group keying material, i.e., V' = (V + 1).<a href="#section-2.2.1-8.2" class="pilcrow">¶</a>
</li>
            <li id="section-2.2.1-8.3">If the current collection of stale Sender IDs has size N, the Group Manager deletes the oldest set in the collection.<a href="#section-2.2.1-8.3" class="pilcrow">¶</a>
</li>
            <li id="section-2.2.1-8.4">The Group Manager adds the new set X' to the collection of stale Sender IDs, as the most recent set.<a href="#section-2.2.1-8.4" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-format-scope">
<section id="section-3">
      <h2 id="name-format-of-scope">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-format-of-scope" class="section-name selfRef">Format of Scope</a>
      </h2>
<p id="section-3-1">Building on <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, this section defines the exact format and encoding of scope to use.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">To this end, this profile uses the Authorization Information Format (AIF) <span>[<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span>, and defines the following AIF specific data model AIF-OSCORE-GROUPCOMM.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">With reference to the generic AIF model<a href="#section-3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-4">
<pre>
   AIF-Generic&lt;Toid, Tperm&gt; = [* [Toid, Tperm]]
</pre><a href="#section-3-4" class="pilcrow">¶</a>
</div>
<p id="section-3-5">the value of the CBOR byte string used as scope encodes the CBOR array [* [Toid, Tperm]], where each [Toid, Tperm] element corresponds to one scope entry.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Then, for each scope entry:<a href="#section-3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-7.1">the object identifier ("Toid") is specialized as a CBOR text string, specifying the group name for the scope entry;<a href="#section-3-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-7.2">
          <p id="section-3-7.2.1">the permission set ("Tperm") is specialized as a CBOR unsigned integer with value R, specifying the role(s) that the client wishes to take in the group (REQ1). The value R is computed as follows:<a href="#section-3-7.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-7.2.2.1">each role in the permission set is converted into the corresponding numeric identifier X from the "Value" column of the table in <a href="#fig-role-values" class="xref">Figure 1</a>.<a href="#section-3-7.2.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3-7.2.2.2">the set of N numbers is converted into the single value R, by taking each numeric identifier X_1, X_2, ..., X_N to the power of two, and then computing the inclusive OR of the binary representations of all the power values.<a href="#section-3-7.2.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<span id="name-numeric-identifier-of-roles"></span><div id="fig-role-values">
<figure id="figure-1">
        <div class="alignCenter art-text artwork" id="section-3-8.1">
<pre>
+-----------+-------+-------------------------------------------------+
| Name      | Value | Description                                     |
+===========+=======+=================================================+
| Reserved  | 0     | This value is reserved                          |
|-----------+-------+-------------------------------------------------+
| Requester | 1     | Send requests; receive responses                |
|-----------+-------+-------------------------------------------------+
| Responder | 2     | Send responses; receive requests                |
+-----------+-------+-------------------------------------------------+
| Monitor   | 3     | Receive requests; never send requests/responses |
|-----------+-------+-------------------------------------------------|
| Verifier  | 4     | Verify signature of intercepted messages        |
+-----------+-------+-------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-numeric-identifier-of-roles" class="selfRef">Numeric identifier of roles in the OSCORE group</a>
        </figcaption></figure>
</div>
<p id="section-3-9">The CDDL <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> definition of the AIF-OSCORE-GROUPCOMM data model is as follows:<a href="#section-3-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-10">
<pre>
   AIF-OSCORE-GROUPCOMM = AIF_Generic&lt;path, permissions&gt;

   path = tstr  ; Group name
   permissions = uint . bits roles
   roles = &amp;(
      Requester: 1,
      Responder: 2,
      Monitor: 3,
      Verifier: 4
   )
</pre><a href="#section-3-10" class="pilcrow">¶</a>
</div>
<p id="section-3-11">Future specifications that define new roles MUST register a corresponding numeric identifier in the "Group OSCORE Roles" registry defined in <a href="#ssec-iana-group-oscore-roles-registry" class="xref">Section 25.11</a> of this document.<a href="#section-3-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-joining-node-to-AS">
<section id="section-4">
      <h2 id="name-joining-node-to-authorizati">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-joining-node-to-authorizati" class="section-name selfRef">Joining Node to Authorization Server</a>
      </h2>
<p id="section-4-1">This section describes how the joining node interacts with the AS in order to be authorized to join an OSCORE group under a given Group Manager. In particular, it considers a joining node that intends to contact that Group Manager for the first time.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The message exchange between the joining node and the AS consists of the messages Authorization Request and Authorization Response defined in Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.1" class="relref">3.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.2" class="relref">3.2</a> of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. Note that what is defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> applies, and only additions or modifications to that specification are defined here.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="ssec-auth-req">
<section id="section-4.1">
        <h3 id="name-authorization-request">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-4.1-1">The Authorization Request message is as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the following additions.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">If the 'scope' parameter is present:<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1.2.1">
                <p id="section-4.1-2.1.2.1.1">The value of the CBOR byte string encodes a CBOR array, whose format MUST follow the data model AIF-OSCORE-GROUPCOMM defined in <a href="#sec-format-scope" class="xref">Section 3</a>. In particular, for each OSCORE group to join:<a href="#section-4.1-2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1.2.1.2.1">The group name is encoded as a CBOR text string.<a href="#section-4.1-2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.1-2.1.2.1.2.2">The set of requested roles is expressed as a single CBOR unsigned integer, computed as defined in <a href="#sec-format-scope" class="xref">Section 3</a> from the numerical abbreviations defined in <a href="#fig-role-values" class="xref">Figure 1</a> for each requested role (REQ1).<a href="#section-4.1-2.1.2.1.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ssec-auth-resp">
<section id="section-4.2">
        <h3 id="name-authorization-response">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-authorization-response" class="section-name selfRef">Authorization Response</a>
        </h3>
<p id="section-4.2-1">The Authorization Response message is as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the following additions:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">The AS MUST include the 'expires_in' parameter. Other means for the AS to specify the lifetime of Access Tokens are out of the scope of this document.<a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.2">The AS MUST include the 'scope' parameter, when the value included in the Access Token differs from the one specified by the joining node in the request. In such a case, the second element of each scope entry MUST be present, and specifies the set of roles that the joining node is actually authorized to take in the OSCORE group for that scope entry, encoded as specified in <a href="#ssec-auth-req" class="xref">Section 4.1</a>.<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-3">Furthermore, if the AS uses the extended format of scope defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-7" class="relref">Section 7</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> for the 'scope' claim of the Access Token, the first element of the CBOR sequence <span>[<a href="#RFC8742" class="xref">RFC8742</a>]</span> MUST be the CBOR integer with value SEM_ID_TBD, defined in <a href="#iana-scope-semantics" class="xref">Section 25.13</a> of this document (REQ28). This indicates that the second element of the CBOR sequence, as conveying the actual access control information, follows the scope semantics defined for this application profile in <a href="#sec-format-scope" class="xref">Section 3</a> of this document.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-interface-GM">
<section id="section-5">
      <h2 id="name-interface-at-the-group-mana">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-interface-at-the-group-mana" class="section-name selfRef">Interface at the Group Manager</a>
      </h2>
<p id="section-5-1">The Group Manager provides the interface defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1" class="relref">Section 4.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the additional sub-resources defined from <a href="#ssec-resource-active" class="xref">Section 5.1</a> to <a href="#ssec-resource-stale-sids" class="xref">Section 5.3</a> of this document.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Furthermore, <a href="#ssec-admitted-methods" class="xref">Section 5.4</a> provides a summary of the CoAP methods admitted to access different resources at the Group Manager, for nodes with different roles in the group or as non members (REQ11).<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The GROUPNAME segment of the URI path MUST match with the group name specified in the scope entry of the Access Token scope (i.e., 'gname' in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>) (REQ7).<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The Resource Type (rt=) Link Target Attribute value "core.osc.gm" is registered in <a href="#iana-rt" class="xref">Section 25.12</a> (REQ10), and can be used to describe group-membership resources and its sub-resources at a Group Manager, e.g., by using a link-format document <span>[<a href="#RFC6690" class="xref">RFC6690</a>]</span>.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Applications can use this common resource type to discover links to group-membership resources for joining OSCORE groups, e.g., by using the approach described in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="xref">I-D.tiloca-core-oscore-discovery</a>]</span>.<a href="#section-5-5" class="pilcrow">¶</a></p>
<div id="ssec-resource-active">
<section id="section-5.1">
        <h3 id="name-ace-group-groupname-active">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-ace-group-groupname-active" class="section-name selfRef">ace-group/GROUPNAME/active</a>
        </h3>
<p id="section-5.1-1">This resource implements a GET handler.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="active-get">
<section id="section-5.1.1">
          <h4 id="name-get-handler">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-get-handler" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-5.1.1-1">The handler expects a GET request.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">In addition to what is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, the handler verifies that the requesting client is a current member of the group. If the verification fails, the KDC MUST reply with a 4.03 (Forbidden) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 0 ("Operation permitted only to group members").<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">If all verifications succeed, the handler replies with a 2.05 (Content) response, specifying the current status of the group, i.e., active or inactive. The payload of the response is formatted as defined in <a href="#sec-status" class="xref">Section 16</a>.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">The method to set the current group status is out of the scope of this document, and is defined for the administrator interface of the Group Manager specified in <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="xref">I-D.ietf-ace-oscore-gm-admin</a>]</span>.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-resource-verif-data">
<section id="section-5.2">
        <h3 id="name-ace-group-groupname-verif-d">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-ace-group-groupname-verif-d" class="section-name selfRef">ace-group/GROUPNAME/verif-data</a>
        </h3>
<p id="section-5.2-1">This resource implements a GET handler.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="verif-data-get">
<section id="section-5.2.1">
          <h4 id="name-get-handler-2">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-get-handler-2" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-5.2.1-1">The handler expects a GET request.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">In addition to what is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, the Group Manager performs the following checks.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">If the requesting client is a current group member, the Group Manager MUST reply with a 4.03 (Forbidden) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 8 ("Operation permitted only to signature verifiers").<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">If GROUPNAME denotes a pairwise-only group, the Group Manager MUST reply with a 4.00 (Bad Request) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 7 ("Signatures not used in the group").<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1-5">If all verifications succeed, the handler replies with a 2.05 (Content) response, specifying data that allows also a signature verifier to verify signatures of messages protected with the group mode and sent to the group (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.1" class="relref">3.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-8.5" class="relref">8.5</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). The response MUST have Content-Format set to application/ace-groupcomm+cbor. The payload of the response is a CBOR map, which is formatted as defined in <a href="#sec-verif-data" class="xref">Section 13</a>.<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-resource-stale-sids">
<section id="section-5.3">
        <h3 id="name-ace-group-groupname-stale-s">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-ace-group-groupname-stale-s" class="section-name selfRef">ace-group/GROUPNAME/stale-sids</a>
        </h3>
<p id="section-5.3-1">This resource implements a FETCH handler.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="stale-sids-fetch">
<section id="section-5.3.1">
          <h4 id="name-fetch-handler">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-fetch-handler" class="section-name selfRef">FETCH Handler</a>
          </h4>
<p id="section-5.3.1-1">The handler expects a FETCH request, whose payload specifies a version number of the group keying material, encoded as an unsigned CBOR integer.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">In addition to what is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, the handler verifies that the requesting client is a current member of the group. If the verification fails, the Group Manager MUST reply with a 4.03 (Forbidden) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 0 ("Operation permitted only to group members").<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<p id="section-5.3.1-3">If all verifications succeed, the handler replies with a 2.05 (Content) response, specifying data that allows the requesting client to delete the Recipient Contexts and public keys associated to former members of the group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. The payload of the response is formatted as defined in <a href="#sec-retrieve-stale-sids" class="xref">Section 20.3.1</a>.<a href="#section-5.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-admitted-methods">
<section id="section-5.4">
        <h3 id="name-admitted-methods">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-admitted-methods" class="section-name selfRef">Admitted Methods</a>
        </h3>
<p id="section-5.4-1">The table in <a href="#method-table" class="xref">Figure 2</a> summarizes the CoAP methods admitted to access different resources at the Group Manager, for (non-)members of a group with group name GROUPNAME, and considering different roles. The last two rows of the table apply to a node with node name NODENAME.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<span id="name-admitted-coap-methods-on-th"></span><div id="method-table">
<figure id="figure-2">
          <div class="alignCenter art-text artwork" id="section-5.4-2.1">
<pre>
+---------------------------------+--------+-------+-------+-------+
|   Resource                      | Type1  | Type2 | Type3 | Type4 |
+---------------------------------+--------+-------+-------+-------+
| ace-group/                      | F      | F     | F     | F     |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/            | G Po   | G Po  | Po *  | Po    |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/active      | G      | G     | -     | -     |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/verif-data  | -      | -     | G     | -     |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/pub-key     | G F    | G F   | G F   | -     |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/kdc-pub-key | G      | G     | G     | -     |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/stale-sids  | F      | F     | -     | -     |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/policies    | G      | G     | -     | -     |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/num         | G      | G     | -     | -     |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/nodes/      | G Pu D | G D   | -     | -     |
|           NODENAME              |        |       |       |       |
+---------------------------------+--------+-------+-------+-------+
| ace-group/GROUPNAME/nodes/      | Po     | -     | -     | -     |
|           NODENAME/pub-key      |        |       |       |       |
+---------------------------------+--------+-------+-------+-------+

Type1 = Member as Requester and/or Responder        |  G  = GET
Type2 = Member as Monitor                           |  F  = FETCH
Type3 = Non-member (authorized to be Verifier)      |  Po = POST
        (*) = cannot join the group as Verifier     |  Pu = PUT
Type4 = Non-member (not authorized to be Verifier)  |  D  = DELETE
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-admitted-coap-methods-on-th" class="selfRef">Admitted CoAP Methods on the Group Manager Resources</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="client-operations">
<section id="section-5.5">
        <h3 id="name-operations-supported-by-cli">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-operations-supported-by-cli" class="section-name selfRef">Operations Supported by Clients</a>
        </h3>
<p id="section-5.5-1">Building on what is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, and with reference to the resources at the Group Manager newly defined earlier in <a href="#sec-interface-GM" class="xref">Section 5</a> of this document, it is expected that a Client minimally supports also the following set of operations and corresponding interactions with the Group (REQ12).<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-2.1">GET request to ace-group/GROUPNAME/active , in order to check the current status of the group.<a href="#section-5.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.2">GET request to ace-group/GROUPNAME/verif-data , in order for a signature verifier to retrieve data required to verify signatures of messages protected with the group mode of Group OSCORE and sent to a group (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.1" class="relref">3.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-8.5" class="relref">8.5</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). Note that this operation is relevant to support only to signature verifiers.<a href="#section-5.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.3">FETCH request to ace-group/GROUPNAME/stale-sids , in order to retrieve from the Group Manager the data required to delete some of the stored group members' public
keys and Recipient Contexts (see <a href="#stale-sids-fetch" class="xref">Section 5.3.1</a>). This data is provided as an aggregated set of stale Sender IDs, which are used as specified in <a href="#missed-rekeying" class="xref">Section 20.3</a>.<a href="#section-5.5-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-joining-node-to-GM">
<section id="section-6">
      <h2 id="name-token-transferring-and-grou">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-token-transferring-and-grou" class="section-name selfRef">Token Transferring and Group Joining</a>
      </h2>
<p id="section-6-1">The rest of this section describes the interactions between the joining node and the Group Manager, i.e., the transferring of the Access Token to the Group Manager and the Request-Response exchange to join the OSCORE group. The message exchange between the joining node and the Group Manager consists of the messages defined in Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.3" class="relref">3.3</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1.1" class="relref">4.3.1.1</a> of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. Note that what is defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> applies, and only additions or modifications to that specification are defined here.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Just like any candidate group member, a signature verifier provides the Group Manager with an Access Token, as described in <a href="#ssec-token-post" class="xref">Section 6.1</a>. However, unlike candidate group members, it does not join any OSCORE group, i.e., it does not perform the joining process defined in <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">After successfully transferring an Access Token to the Group Manager, a signature verifier is allowed to perform only some operations as non-member of a group, and only for the OSCORE groups specified in the validated Access Token. These are the operations specified in <a href="#sec-pub-keys" class="xref">Section 10</a>, <a href="#sec-gm-pub-key" class="xref">Section 12</a>, <a href="#sec-verif-data" class="xref">Section 13</a> and <a href="#sec-retrieve-gnames" class="xref">Section 17</a>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Consistently, in case a node is non-member of the group with group name GROUPNAME and is authorized to be only signature verifier for that group, the Group Manager MUST reply with a 4.03 (Forbidden) error response if that node attempts to access any other endpoint than: /ace-group/GROUPNAME/pub-key; ace-group/GROUPNAME/gm-pub-key; ace-group/GROUPNAME/verif-data; and /ace-group.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="ssec-token-post">
<section id="section-6.1">
        <h3 id="name-token-transferring">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-token-transferring" class="section-name selfRef">Token Transferring</a>
        </h3>
<p id="section-6.1-1">The exchange of Token Transfer Request and Response is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.3" class="relref">Section 3.3</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In addition to that, the following applies.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">The Token Transfer Request MAY additionally contain the following parameters, which, if included, MUST have the corresponding values (OPT2):<a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1.2.1">'ecdh_info' defined in <a href="#ecdh-info" class="xref">Section 6.1.1</a> of this document, with value the CBOR simple value 'null' (0xf6) to request information about the ECDH algorithm, the ECDH algorithm parameters, the ECDH key parameters and about the exact encoding of public keys used in the groups that the client has been authorized to join. This is relevant in case the joining node supports the pairwise mode of Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-6.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.2">'gm_dh_pub_keys' defined in <a href="#gm-dh-info" class="xref">Section 6.1.2</a> of this document, with value the CBOR simple value 'null' (0xf6) to request the Diffie-Hellman public keys of the Group Manager in the groups that the client has been authorized to join. This is relevant in case the joining node supports the pairwise mode of Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-6.1-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-6.1-2.1.3">
Alternatively, the joining node may retrieve this information by other means.<a href="#section-6.1-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.2">
            <p id="section-6.1-2.2.1">The 'kdcchallenge' parameter contains a dedicated nonce N_S generated by the Group Manager. For the N_S value, it is RECOMMENDED to use a 8-byte long random nonce. The joining node can use this nonce in order to prove the possession of its own private key, upon joining the group (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>).<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1-2.2.2">
The 'kdcchallenge' parameter MAY be omitted from the Token Transfer Response, if the 'scope' of the Access Token specifies only the role "monitor" or only the role "verifier" or only a combination of the two, for each and every of the specified groups.<a href="#section-6.1-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.3">
            <p id="section-6.1-2.3.1">If the 'sign_info' parameter is present in the response, the following applies for each element 'sign_info_entry'.<a href="#section-6.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.3.2.1">'id' MUST NOT refer to OSCORE groups that are pairwise-only groups.<a href="#section-6.1-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.3.2.2">'sign_alg' takes value from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-6.1-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.3.2.3">'sign_parameters' is a CBOR array. Its format and value are the same of the COSE capabilities array for the algorithm indicated in 'sign_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span> (REQ4).<a href="#section-6.1-2.3.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.3.2.4">'sign_key_parameters' is a CBOR array. Its format and value are the same of the COSE capabilities array for the COSE key type of the keys used with the algorithm indicated in 'sign_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span> (REQ5).<a href="#section-6.1-2.3.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.3.2.5">
                <p id="section-6.1-2.3.2.5.1">'pub_key_enc' takes value from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="xref">COSE.Header.Parameters</a>]</span> (REQ6). Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2.3" class="relref">Section 2.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, acceptable values denote an encoding that MUST explicitly provide the full set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-6.1-2.3.2.5.1" class="pilcrow">¶</a></p>
<p id="section-6.1-2.3.2.5.2">
At the time of writing this specification, acceptable public key encodings are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span> and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Further encodings may be available in the future, and would be acceptable to use as long as they comply with the criteria defined above.<a href="#section-6.1-2.3.2.5.2" class="pilcrow">¶</a></p>
<p id="section-6.1-2.3.2.5.3">
[ As to CWTs and CCSs, the COSE Header Parameters 'kcwt' and 'kccs' are under pending registration requested by draft-ietf-lake-edhoc. ]<a href="#section-6.1-2.3.2.5.3" class="pilcrow">¶</a></p>
<p id="section-6.1-2.3.2.5.4">
[ As to C509 certificates, the COSE Header Parameters 'c5b' and 'c5c' are under pending registration requested by draft-ietf-cose-cbor-encoded-cert. ]<a href="#section-6.1-2.3.2.5.4" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-6.1-2.3.3">
This format is consistent with every signature algorithm currently considered in <span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>, i.e., with algorithms that have only the COSE key type as their COSE capability. Appendix B of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> describes how the format of each 'sign_info_entry' can be generalized for possible future registered algorithms having a different set of COSE capabilities.<a href="#section-6.1-2.3.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.4">
            <p id="section-6.1-2.4.1">If 'ecdh_info' is included in the Token Transfer Request, the Group Manager SHOULD include the 'ecdh_info' parameter in the Token Transfer Response, as per the format defined in <a href="#ecdh-info" class="xref">Section 6.1.1</a>. Note that the field 'id' of each 'ecdh_info_entry' specifies the name, or array of group names, for which that 'ecdh_info_entry' applies to.<a href="#section-6.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-6.1-2.4.2">
As an exception, the KDC MAY NOT include the 'ecdh_info' parameter in the Token Transfer Response even if 'ecdh_info' is included in the Token Transfer Request, in case all the groups that the Client is authorized to join are signature-only groups.<a href="#section-6.1-2.4.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.5">If 'gm_dh_pub_keys' is included in the Token Transfer Request and any of the groups that the client has been authorized to join is a pairwise-only group, then the Group Manager MUST include the 'gm_dh_pub_keys' parameter in the Token Transfer Response, as per the format defined in <a href="#gm-dh-info" class="xref">Section 6.1.2</a>. Otherwise, if 'gm_dh_pub_keys' is included in the Token Transfer Request, the Group Manager MAY include the 'gm_dh_pub_keys' parameter in the Token Transfer Response. Note that the field 'id' specifies the group name, or array of group names, for which the corresponding 'gm_dh_pub_keys' applies to.<a href="#section-6.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-3">Note that, other than through the above parameters as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.3" class="relref">Section 3.3</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, the joining node may have obtained such information by alternative means. For example, information conveyed in the 'sign_info' and 'ecdh_info' parameters may have been pre-configured, or the joining node MAY early retrieve it by using the approach described in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="xref">I-D.tiloca-core-oscore-discovery</a>]</span>, to discover the OSCORE group and the link to the associated group-membership resource at the Group Manager (OPT3).<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<div id="ecdh-info">
<section id="section-6.1.1">
          <h4 id="name-ecdh_info-parameter">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-ecdh_info-parameter" class="section-name selfRef">'ecdh_info' Parameter</a>
          </h4>
<p id="section-6.1.1-1">The 'ecdh_info' parameter is an OPTIONAL parameter of the request and response messages exchanged between the client and the authz-info endpoint at the RS (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.10.1." class="relref">Section 5.10.1.</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">This parameter allows the client and the RS to exchange information about an ECDH algorithm and about public keys to accordingly use for deriving Diffie-Hellman secrets. Its exact semantics and content are application specific.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">In this application profile, this parameter is used to exchange information about the ECDH algorithm and about public keys to be used with it, in the groups indicated by the transferred Acces Token as per its 'scope' claim (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>).<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1.1-4">When used in the Token Transfer Request sent to the Group Manager, the 'ecdh_info' parameter has value the CBOR simple value 'null' (0xf6). This is done to ask for information about the ECDH algorithm and about the public keys to be used to compute static-static Diffie-Hellman shared secrets <span>[<a href="#NIST-800-56A" class="xref">NIST-800-56A</a>]</span>, in the OSCORE groups that the client has been authorized to join and that use the pairwise mode of Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-6.1.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1.1-5">When used in the following Token Transfer Response from the Group Manager, the 'ecdh_info' parameter is a CBOR array of one or more elements. The number of elements is at most the number of OSCORE groups that the client has been authorized to join.<a href="#section-6.1.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1.1-6">Each element contains information about ECDH parameters and about public keys, for one or more OSCORE groups that use the pairwise mode of Group OSCORE and that the client has been authorized to join. Each element is formatted as follows.<a href="#section-6.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-7.1">The first element 'id' is the group name of the OSCORE group or an array of group names for the OSCORE groups for which the specified information applies. In particular 'id' MUST NOT refer to OSCORE groups that are signature-only groups.<a href="#section-6.1.1-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.1-7.2">The second element 'ecdh_alg' is a CBOR integer or a CBOR text string indicating the ECDH algorithm used in the OSCORE group identified by 'gname'. Values are taken from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-6.1.1-7.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.1-7.3">The third element 'ecdh_parameters' is a CBOR array indicating the parameters of the ECDH algorithm used in the OSCORE group identified by 'gname'. Its format and value are the same of the COSE capabilities array for the algorithm indicated in 'ecdh_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-6.1.1-7.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.1-7.4">The fourth element 'ecdh_key_parameters' is a CBOR array indicating the parameters of the keys used with the ECDH algorithm in the OSCORE group identified by 'gname'. Its content depends on the value of 'ecdh_alg'. In particular, its format and value are the same of the COSE capabilities array for the COSE key type of the keys used with the algorithm indicated in 'ecdh_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span>.<a href="#section-6.1.1-7.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.1-7.5">The fifth element 'pub_key_enc' is a CBOR integer indicating the encoding of public keys used in the OSCORE group identified by 'gname'. It takes value from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="xref">COSE.Header.Parameters</a>]</span> (REQ6). Acceptable values denote an encoding that MUST explicitly provide the full set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable). The same considerations and guidelines for the 'pub_key_enc' element of 'sign_info' (see <a href="#ssec-token-post" class="xref">Section 6.1</a>) apply.<a href="#section-6.1.1-7.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.1.1-8">The CDDL notation <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> of the 'ecdh_info' parameter is given below.<a href="#section-6.1.1-8" class="pilcrow">¶</a></p>
<div id="section-6.1.1-9">
<pre class="lang-CDDL sourcecode">
ecdh_info = ecdh_info_req / ecdh_info_resp

ecdh_info_req = nil                   ; in the Token Transfer
                                      ; Request to the KDC

ecdh_info_res = [ + ecdh_info_entry ] ; in the Token Transfer
                                      ; Response from the KDC

ecdh_info_entry =
[
  id : gname / [ + gname ],
  ecdh_alg : int / tstr,
  ecdh_parameters : [ any ],
  ecdh_key_parameters : [ any ],
  pub_key_enc = int
]

gname = tstr
</pre><a href="#section-6.1.1-9" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1-10">This format is consistent with every ECDH algorithm currently defined in <span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>, i.e., with algorithms that have only the COSE key type as their COSE capability. <a href="#sec-future-cose-algs" class="xref">Appendix B</a> of this document describes how the format of each 'ecdh_info_entry' can be generalized for possible future registered algorithms having a different set of COSE capabilities.<a href="#section-6.1.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gm-dh-info">
<section id="section-6.1.2">
          <h4 id="name-gm_dh_pub_keys-parameter">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-gm_dh_pub_keys-parameter" class="section-name selfRef">'gm_dh_pub_keys' Parameter</a>
          </h4>
<p id="section-6.1.2-1">The 'gm_dh_pub_keys' parameter is an OPTIONAL parameter of the request and response messages exchanged between the Client and the authz-info endpoint at the RS (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.10.1." class="relref">Section 5.10.1.</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">This parameter allows the client to request and retrieve the Diffie-Hellman public keys of the RS.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.2-3">In this application profile, this parameter is used to request and retrieve from the Group Manager its Diffie-Hellman public keys to use, in the OSCORE groups that the client has been authorized to join. The Group Manager has specifically a Diffie-Hellman public key in an OSCORE group, if and only if the group is a pairwise-only group. In this case, the early retrieval of the Group Manager's public key is necessary in order for the joining node to prove the possession of its own private key, upon joining the group (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>).<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<p id="section-6.1.2-4">When used in the Token Transfer Request sent to the Group Manager, the 'gm_dh_pub_keys' parameter has value the CBOR simple value 'null' (0xf6). This is done to ask for the Diffie-Hellman public keys that the Group Manager uses in the OSCORE groups that the client has been authorized to join.<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
<p id="section-6.1.2-5">When used in the following Token Transfer Response from the Group Manager, the 'gm_dh_pub_keys' parameter is a CBOR array of one or more elements. The number of elements is at most the number of OSCORE groups that the client has been authorized to join.<a href="#section-6.1.2-5" class="pilcrow">¶</a></p>
<p id="section-6.1.2-6">Each element 'gm_dh_pub_keys_entry' contains information about the Group Manager's Diffie-Hellman public keys, for one or more OSCORE groups that are pairwise-only groups and that the client has been authorized to join. Each element is formatted as follows.<a href="#section-6.1.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-7.1">The first element 'id' is the group name of the OSCORE group or an array of group names for the OSCORE groups for which the specified information applies. In particular 'id' MUST refer exclusively to OSCORE groups that are pairwise-only groups.<a href="#section-6.1.2-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.2-7.2">The second element 'pub_key_enc' is a CBOR integer indicating the encoding of public keys used in the OSCORE group identified by 'gname'. It takes value from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="xref">COSE.Header.Parameters</a>]</span> (REQ6). Acceptable values denote an encoding that MUST explicitly provide the full set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable). The same considerations and guidelines for the 'pub_key_enc' element of 'sign_info' (see <a href="#ssec-token-post" class="xref">Section 6.1</a>) apply.<a href="#section-6.1.2-7.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.2-7.3">The third element 'pub_key' is a CBOR byte string, which encodes the Group Manager's Diffie-Hellman public key in its original binary representation made available to other endpoints in the group. In particular, the original binary representation complies with the encoding specified by the 'pub_key_enc' parameter. Note that the public key provides the full set of information related to its public key algorithm, i.e., the ECDH algorithm used in the OSCORE group as pairwise key agreement algorithm.<a href="#section-6.1.2-7.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.1.2-8">The CDDL notation <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> of the 'gm_dh_pub_keys' parameter is given below.<a href="#section-6.1.2-8" class="pilcrow">¶</a></p>
<div id="section-6.1.2-9">
<pre class="lang-CDDL sourcecode">
gm_dh_pub_keys = gm_dh_pub_keys_req / gm_dh_pub_keys_resp

gm_dh_pub_keys_req = nil                        ; in the Token
                                                ; Transfer Request to
                                                ; the Group Manager

gm_dh_pub_keys_res = [ + gm_dh_pub_keys_entry ] ; in the Token
                                                ; Transfer Response
                                                ; from the Group
                                                ; Manager

gm_dh_pub_keys_entry =
[
  id : gname / [ + gname ],
  pub_key_enc = int,
  pub_key = bstr
]

gname = tstr
</pre><a href="#section-6.1.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ssec-join-req-sending">
<section id="section-6.2">
        <h3 id="name-send-the-joining-request">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-send-the-joining-request" class="section-name selfRef">Send the Joining Request</a>
        </h3>
<p id="section-6.2-1">The joining node requests to join the OSCORE group by sending a Joining Request message to the related group-membership resource at the Group Manager, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1.1" class="relref">Section 4.3.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Additionally to what defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, the following applies.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">The 'scope' parameter MUST be included. Its value encodes one scope entry with the format defined in <a href="#sec-format-scope" class="xref">Section 3</a>, indicating the group name and the role(s) that the joining node wants to take in the group.<a href="#section-6.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-3.2">
            <p id="section-6.2-3.2.1">The 'get_pub_keys' parameter is present only if the joining node wants to retrieve the public keys of the group members from the Group Manager during the joining process (see <a href="#sec-public-keys-of-joining-nodes" class="xref">Section 7</a>). Otherwise, this parameter MUST NOT be present.<a href="#section-6.2-3.2.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.2.2">
If this parameter is present and its value is non-null, each element of the inner CBOR array 'role_filter' is encoded as a CBOR unsigned integer, with the same value of a permission set ("Tperm") indicating that role or combination of roles in a scope entry, as defined in <a href="#sec-format-scope" class="xref">Section 3</a>.<a href="#section-6.2-3.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-3.3">'cnonce' contains a dedicated nonce N_C generated by the joining node. For the N_C value, it is RECOMMENDED to use a 8-byte long random nonce.<a href="#section-6.2-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-3.4">
            <p id="section-6.2-3.4.1">The proof-of-possession (PoP) evidence included in 'client_cred_verify' is computed as defined below (REQ14). In either case, the N_S used to build the PoP input is as defined in <a href="#sssec-challenge-value" class="xref">Section 6.2.1</a>.<a href="#section-6.2-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.4.2.1">If the group is not a pairwise-only group, the PoP evidence MUST be a signature. The joining node computes the signature by using the same private key and signature algorithm it intends to use for signing messages in the OSCORE group.<a href="#section-6.2-3.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-3.4.2.2">
                <p id="section-6.2-3.4.2.2.1">If the group is a pairwise-only group, the PoP evidence MUST be a MAC computed as follows, by using the HKDF Algorithm HKDF SHA-256, which consists of composing the HKDF-Extract and HKDF-Expand steps <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>.<a href="#section-6.2-3.4.2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.4.2.2.2">
MAC = HKDF(salt, IKM, info, L)<a href="#section-6.2-3.4.2.2.2" class="pilcrow">¶</a></p>
<p id="section-6.2-3.4.2.2.3">
The input parameters of HKDF are as follows.<a href="#section-6.2-3.4.2.2.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.4.2.2.4.1">salt takes as value the empty byte string.<a href="#section-6.2-3.4.2.2.4.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.2-3.4.2.2.4.2">IKM is computed as a cofactor Diffie-Hellman shared secret, see Section 5.7.1.2 of <span>[<a href="#NIST-800-56A" class="xref">NIST-800-56A</a>]</span>, using the ECDH algorithm used in the OSCORE group. The joining node uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the Group Manager. For X25519 and X448, the procedure is described in <span><a href="https://rfc-editor.org/rfc/rfc7748#section-5" class="relref">Section 5</a> of [<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-6.2-3.4.2.2.4.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.2-3.4.2.2.4.3">info takes as value the PoP input.<a href="#section-6.2-3.4.2.2.4.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.2-3.4.2.2.4.4">L is equal to 8, i.e., the size of the MAC, in bytes.<a href="#section-6.2-3.4.2.2.4.4" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<div id="sssec-challenge-value">
<section id="section-6.2.1">
          <h4 id="name-value-of-the-n_s-challenge">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-value-of-the-n_s-challenge" class="section-name selfRef">Value of the N_S Challenge</a>
          </h4>
<p id="section-6.2.1-1">The value of the N_S challenge is determined as follows.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.1-2">
<li id="section-6.2.1-2.1">If the joining node has provided the Access Token to the Group Manager by means of a Token Transfer Request to the /authz-info endpoint as in <a href="#ssec-token-post" class="xref">Section 6.1</a>, then N_S takes the same value of the most recent 'kdcchallenge' parameter received by the joining node from the Group Manager. This can be either the one specified in the Token Transfer Response, or the one possibly specified in a 4.00 (Bad Request) error response to a following Joining Request (see <a href="#ssec-join-req-processing" class="xref">Section 6.3</a>).<a href="#section-6.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.2.1-2.2">If the provisioning of the Access Token to the Group Manager has relied on the DTLS profile of ACE <span>[<a href="#I-D.ietf-ace-dtls-authorize" class="xref">I-D.ietf-ace-dtls-authorize</a>]</span> with the Access Token as content of the "psk_identity" field of the ClientKeyExchange message <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>, N_S is an exporter value computed as defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-7.5" class="relref">Section 7.5</a> of [<a href="#RFC8446" class="xref">RFC8446</a>]</span>. Specifically, N_S is exported from the DTLS session between the joining node and the Group Manager, using an empty 'context_value', 32 bytes as 'key_length', and the exporter label "EXPORTER-ACE-Sign-Challenge-coap-group-oscore-app" defined in <a href="#ssec-iana-tls-esporter-label-registry" class="xref">Section 25.7</a> of this document.<a href="#section-6.2.1-2.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-6.2.1-3">It is up to applications to define how N_S is computed in further alternative settings.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<p id="section-6.2.1-4"><a href="#ssec-security-considerations-reusage-nonces" class="xref">Section 24.3</a> provides security considerations on the reusage of the N_S challenge.<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-join-req-processing">
<section id="section-6.3">
        <h3 id="name-receive-the-joining-request">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-receive-the-joining-request" class="section-name selfRef">Receive the Joining Request</a>
        </h3>
<p id="section-6.3-1">The Group Manager processes the Joining Request as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the following additions.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1">The Group Manager MUST return a 5.03 (Service Unavailable) response in case the OSCORE group that the joining node has been trying to join is currently inactive (see <a href="#ssec-resource-active" class="xref">Section 5.1</a>). The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 9 ("Group currently not active").<a href="#section-6.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-2.2">In case the joining node is not going to join the group exclusively as monitor, the Group Manager MUST return a 5.03 (Service Unavailable) response if there are currently no OSCORE Sender IDs available to assign in the OSCORE group. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 4 ("No available node identifiers").<a href="#section-6.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-2.3">In case the joining node is not going to join the group exclusively as monitor and the Joining Request does not include the 'client_cred' parameter, the joining process fails if the Group Manager either: i) does not store a public key with an accepted format for the joining node; or ii) stores multiple public keys with an accepted format for the joining node.<a href="#section-6.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-2.4">
            <p id="section-6.3-2.4.1">In order to verify the PoP evidence contained in 'client_cred_verify', the Group Manager proceeds as follows.<a href="#section-6.3-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.4.2.1">As PoP input, the Group Manager uses the value of the 'scope' parameter from the Joining Request as a CBOR byte string, concatenated with N_S encoded as a CBOR byte string, concatenated with N_C encoded as a CBOR byte string. In particular, N_S is determined as described in <a href="#sssec-challenge-value" class="xref">Section 6.2.1</a>, while N_C is the nonce provided in the 'cnonce' parameter of the Joining Request;<a href="#section-6.3-2.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.4.2.2">As public key of the joining node, the Group Manager uses either the one retrieved from the 'client_cred' parameter of the Joining Request, or the one already stored as acquired from previous interactions with the joining node.<a href="#section-6.3-2.4.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.4.2.3">
                <p id="section-6.3-2.4.2.3.1">The Group Manager verifies the PoP evidence as defined below.<a href="#section-6.3-2.4.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.4.2.3.2.1">If the group is not a pairwise-only group, the PoP evidence is a signature. The Group Manager verifies it by using the public key of the joining node, as well as the signature algorithm used in the OSCORE group and possible corresponding parameters.<a href="#section-6.3-2.4.2.3.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.3-2.4.2.3.2.2">If the group is a pairwise-only group, the PoP evidence is a MAC. The Group Manager recomputes the MAC through the same process taken by the joining node when preparing the value of the 'client_cred_verify' parameter for the Joining Request (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>), with the difference that the Group Manager uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the joining node. The verification succeeds if and only if the recomputed MAC is equal to the MAC conveyed as PoP evidence in the Joining Request.<a href="#section-6.3-2.4.2.3.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.3-2.5">
            <p id="section-6.3-2.5.1">A 4.00 (Bad Request) error response from the Group Manager to the joining node MUST have content format application/ace-groupcomm+cbor. The response payload is a CBOR map formatted as follows.<a href="#section-6.3-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.5.2.1">If the group uses (also) the group mode of Group OSCORE, the CBOR map MUST contain the 'sign_info' parameter, whose CBOR label is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. This parameter has the same format of 'sign_info_res' defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.3.1" class="relref">Section 3.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, it includes a single element 'sign_info_entry' pertaining to the OSCORE group that the joining node has tried to join with the Joining Request.<a href="#section-6.3-2.5.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.5.2.2">If the group uses (also) the pairwise mode of Group OSCORE, the CBOR map MUST contain the 'ecdh_info' parameter, whose CBOR label is defined in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="xref">Section 25.3</a>. This parameter has the same format of 'ecdh_info_res' defined in <a href="#ecdh-info" class="xref">Section 6.1.1</a>. In particular, it includes a single element 'ecdh_info_entry' pertaining to the OSCORE group that the joining node has tried to join with the Joining Request.<a href="#section-6.3-2.5.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.5.2.3">If the group is a pairwise-only group, the CBOR map MUST contain the 'gm_dh_pub_keys' parameter, whose CBOR label is defined in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="xref">Section 25.3</a>. This parameter has the same format of 'gm_dh_pub_keys_res' defined in <a href="#gm-dh-info" class="xref">Section 6.1.2</a>. In particular, it includes a single element 'gm_dh_pub_keys_entry' pertaining to the OSCORE group that the joining node has tried to join with the Joining Request.<a href="#section-6.3-2.5.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.5.2.4">The CBOR map MAY include the 'kdcchallenge' parameter, whose CBOR label is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. If present, this parameter is a CBOR byte string, which encodes a newly generated 'kdcchallenge' value that the Client can use when preparing a Joining Request (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>). In such a case the Group Manager MUST store the newly generated value as the 'kdcchallenge' value associated to the joining node, possibly replacing the currently stored value.<a href="#section-6.3-2.5.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.3-2.6">The Group Manager MUST reply with a 4.00 (Bad Request) error response in case the 'scope' parameter is not present in the Joining Request, or if it is present and specifies any set of roles not included in the following list: "requester", "responder", "monitor", ("requester", "responder"). Future specifications that define a new role MUST define possible sets of roles including the new one and existing ones, that are acceptable to specify in the 'scope' parameter of a Joining Request.<a href="#section-6.3-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-2.7">The Group Manager MUST reply with a 4.00 (Bad Request) error response in case the Joining Request includes the 'client_cred' parameter but does not include both the 'cnonce' and 'client_cred_verify' parameters.<a href="#section-6.3-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-2.8">The Group Manager MUST reply with a 4.00 (Bad Request) error response in case an eligible public key for the joining node is neither present in the 'client_cred' parameter nor already stored.<a href="#section-6.3-2.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-2.9">
            <p id="section-6.3-2.9.1">The Group Manager MAY reply with a 4.00 (Bad Request) error response in case all the following conditions hold.<a href="#section-6.3-2.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.9.2.1">The OSCORE group uses the pairwise mode of Group OSCORE.<a href="#section-6.3-2.9.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.9.2.2">The OSCORE group uses EdDSA public keys <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-6.3-2.9.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.9.2.3">
                <p id="section-6.3-2.9.2.3.1">The public key of the joining node from the 'client_cred' parameter:<a href="#section-6.3-2.9.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.9.2.3.2.1">Is for the elliptic curve Ed25519 and has its Y coordinate equal to -1 or 1 (mod p), with p = (2^255 - 19), see <span><a href="https://rfc-editor.org/rfc/rfc7748#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC7748" class="xref">RFC7748</a>]</span>; or<a href="#section-6.3-2.9.2.3.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.3-2.9.2.3.2.2">Is for the elliptic curve Ed448 and has its Y coordinate equal to -1 or 1 (mod p), with p =  (2^448 - 2^224 - 1), see <span><a href="https://rfc-editor.org/rfc/rfc7748#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-6.3-2.9.2.3.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="section-6.3-2.9.3">
This prevents the acceptance of Ed25519 and Ed448 public keys that cannot be successfully converted to Montgomery coordinates, and thus cannot be used for the derivation of pairwise keys (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2.4.1" class="relref">Section 2.4.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-6.3-2.9.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-2.10">
            <p id="section-6.3-2.10.1">When receiving a 4.00 (Bad Request) error response, the joining node SHOULD send a new Joining Request to the Group Manager, where:<a href="#section-6.3-2.10.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.10.2.1">The 'cnonce' parameter MUST include a new dedicated nonce N_C generated by the joining node.<a href="#section-6.3-2.10.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.10.2.2">The 'client_cred' parameter MUST include a public key compatible with the encoding, signature or ECDH algorithm, and possible associated parameters indicated by the Group Manager.<a href="#section-6.3-2.10.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.10.2.3">The 'client_cred_verify' parameter MUST include a PoP evidence computed as described in <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>, by using the public key indicated in the current 'client_cred' parameter, with the signature or ECDH algorithm, and possible associated parameters indicated by the Group Manager. If the error response from the Group Manager includes the 'kdcchallenge' parameter, the joining node MUST use its content as new N_S challenge to compute the PoP evidence.<a href="#section-6.3-2.10.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ssec-join-resp">
<section id="section-6.4">
        <h3 id="name-send-the-joining-response">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-send-the-joining-response" class="section-name selfRef">Send the Joining Response</a>
        </h3>
<p id="section-6.4-1">If the processing of the Joining Request described in <a href="#ssec-join-req-processing" class="xref">Section 6.3</a> is successful, the Group Manager updates the group membership by registering the joining node NODENAME as a new member of the OSCORE group GROUPNAME, as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">If the joining node has not taken exclusively the role of monitor, the Group Manager performs also the following actions.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-3.1">
            <p id="section-6.4-3.1.1">The Group Manager selects an available OSCORE Sender ID in the OSCORE group, and exclusively assigns it to the joining node. The Group Manager MUST NOT assign an OSCORE Sender ID to the joining node if this joins the group exclusively with the role of monitor, according to what specified in the Access Token (see <a href="#ssec-auth-resp" class="xref">Section 4.2</a>).<a href="#section-6.4-3.1.1" class="pilcrow">¶</a></p>
<p id="section-6.4-3.1.2">
Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the Group Manager MUST assign an OSCORE Sender ID that has not been used in the OSCORE group since the latest time when the current Gid value was assigned to the group.<a href="#section-6.4-3.1.2" class="pilcrow">¶</a></p>
<p id="section-6.4-3.1.3">
If the joining node is recognized as a current group member, e.g., through the ongoing secure communication association, the following also applies.<a href="#section-6.4-3.1.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-3.1.4.1">The Group Manager MUST assign a new OSCORE Sender ID different than the one currently used by the joining node in the OSCORE group.<a href="#section-6.4-3.1.4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-3.1.4.2">The Group Manager MUST add the old, relinquished OSCORE Sender ID of the joining node to the most recent set of stale Sender IDs, in the collection associated to the group (see <a href="#sssec-stale-sender-ids" class="xref">Section 2.2.1</a>).<a href="#section-6.4-3.1.4.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.4-3.2">The Group Manager stores the association between i) the public key of the joining node; and ii) the Group Identifier (Gid), i.e., the OSCORE ID Context, associated to the OSCORE group together with the OSCORE Sender ID assigned to the joining node in the group. The Group Manager MUST keep this association updated over time.<a href="#section-6.4-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.4-4">Then, the Group Manager replies to the joining node, providing the updated security parameters and keying meterial necessary to participate in the group communication. This success Joining Response is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the following additions:<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-5.1">The 'gkty' parameter identifies a key of type "Group_OSCORE_Input_Material object", defined in <a href="#ssec-iana-groupcomm-keys-registry" class="xref">Section 25.4</a> of this document.<a href="#section-6.4-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-5.2">
            <p id="section-6.4-5.2.1">The 'key' parameter includes what the joining node needs in order to set up the Group OSCORE Security Context as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-6.4-5.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4-5.2.2">
This parameter has as value a Group_OSCORE_Input_Material object, which is defined in this document and extends the OSCORE_Input_Material object encoded in CBOR as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>. In particular, it contains the additional parameters 'group_senderId', 'pub_key_enc', 'sign_enc_alg', 'sign_alg', 'sign_params', 'ecdh_alg' and 'ecdh_params' defined in <a href="#ssec-iana-security-context-parameter-registry" class="xref">Section 25.6</a> of this document.<a href="#section-6.4-5.2.2" class="pilcrow">¶</a></p>
<p id="section-6.4-5.2.3">
More specifically, the 'key' parameter is composed as follows.<a href="#section-6.4-5.2.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-5.2.4.1">The 'hkdf' parameter, if present, has as value the HKDF Algorithm used in the OSCORE group. This parameter MAY be omitted, if the HKDF Algorithm used in the group is HKDF SHA-256. Otherwise, this parameter MUST be present.<a href="#section-6.4-5.2.4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.2.4.2">The 'salt' parameter, if present, has as value the OSCORE Master Salt used in the OSCORE group. This parameter MAY be omitted, if the Master Salt used in the group is the empty byte string. Otherwise, this parameter MUST be present.<a href="#section-6.4-5.2.4.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.2.4.3">The 'ms' parameter includes the OSCORE Master Secret value used in the OSCORE group. This parameter MUST be present.<a href="#section-6.4-5.2.4.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.2.4.4">The 'contextId' parameter MUST be present and has as value the Group Identifier (Gid), i.e., the OSCORE ID Context of the OSCORE group. This parameter MUST be present.<a href="#section-6.4-5.2.4.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.2.4.5">The 'group_senderId' parameter, if present, has as value the OSCORE Sender ID assigned to the joining node by the Group Manager, as described above. This parameter MUST NOT be present if the node joins the OSCORE group exclusively with the role of monitor, according to what specified in the Access Token (see <a href="#ssec-auth-resp" class="xref">Section 4.2</a>). In any other case, this parameter MUST be present.<a href="#section-6.4-5.2.4.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.2.4.6">
                <p id="section-6.4-5.2.4.6.1">The 'pub_key_enc' parameter MUST be present and specifies the encoding of public keys used in the OSCORE group. It takes value from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="xref">COSE.Header.Parameters</a>]</span> (REQ6). Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2.3" class="relref">Section 2.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, acceptable values denote an encoding that MUST explicitly provide the full set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-6.4-5.2.4.6.1" class="pilcrow">¶</a></p>
<p id="section-6.4-5.2.4.6.2">
At the time of writing this specification, acceptable public key encodings are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span> and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Further encodings may be available in the future, and would be acceptable to use as long as they comply with the criteria defined above.<a href="#section-6.4-5.2.4.6.2" class="pilcrow">¶</a></p>
<p id="section-6.4-5.2.4.6.3">
[ As to CWTs and CCSs, the COSE Header Parameters 'kcwt' and 'kccs' are under pending registration requested by draft-ietf-lake-edhoc. ]<a href="#section-6.4-5.2.4.6.3" class="pilcrow">¶</a></p>
<p id="section-6.4-5.2.4.6.4">
[ As to C509 certificates, the COSE Header Parameters 'c5b' and 'c5c' are under pending registration requested by draft-ietf-cose-cbor-encoded-cert. ]<a href="#section-6.4-5.2.4.6.4" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.4-5.2.4.7">The 'sign_enc_alg' parameter MUST NOT be present if the OSCORE group is a pairwise-only group. Otherwise, it MUST be present and specifies the Signature Encryption Algorithm used in the OSCORE group to encrypt messages protected with the group mode. This parameter takes values from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-6.4-5.2.4.7" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.2.4.8">The 'sign_alg' parameter MUST NOT be present if the OSCORE group is a pairwise-only group. Otherwise, it MUST be present and specifies the Signature Algorithm used to sign messages in the OSCORE group. This parameter takes values from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-6.4-5.2.4.8" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.2.4.9">
                <p id="section-6.4-5.2.4.9.1">The 'sign_params' parameter MUST NOT be present if the OSCORE group is a pairwise-only group. Otherwise, it MUST be present and specifies the parameters of the Signature Algorithm. This parameter is a CBOR array, which includes the following two elements:<a href="#section-6.4-5.2.4.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-5.2.4.9.2.1">'sign_alg_capab': a CBOR array, with the same format and value of the COSE capabilities array for the Signature Algorithm indicated in 'sign_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-6.4-5.2.4.9.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.4-5.2.4.9.2.2">'sign_key_type_capab': a CBOR array, with the same format and value of the COSE capabilities array for the COSE key type of the keys used with the Signature Algorithm indicated in 'sign_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span>.<a href="#section-6.4-5.2.4.9.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-6.4-5.2.4.10">The 'alg' parameter MUST NOT be present if the OSCORE group is a signature-only group. Otherwise, it MUST be present and specifies the AEAD Algorithm used in the OSCORE group to encrypt messages protected with the pairwise mode.<a href="#section-6.4-5.2.4.10" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.2.4.11">The 'ecdh_alg' parameter MUST NOT be present if the OSCORE group is a signature-only group. Otherwise, it MUST be present and specifies the Pairwise Key Agreement Algorithm used in the OSCORE group. This parameter takes values from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-6.4-5.2.4.11" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.2.4.12">
                <p id="section-6.4-5.2.4.12.1">The 'ecdh_params' parameter MUST NOT be present if the OSCORE group is a signature-only group. Otherwise, it MUST be present and specifies the parameters of the Pairwise Key Agreement Algorithm. This parameter is a CBOR array, which includes the following two elements:<a href="#section-6.4-5.2.4.12.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-5.2.4.12.2.1">'ecdh_alg_capab': a CBOR array, with the same format and value of the COSE capabilities array for the algorithm indicated in 'ecdh_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-6.4-5.2.4.12.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.4-5.2.4.12.2.2">'ecdh_key_type_capab': a CBOR array, with the same format and value of the COSE capabilities array for the COSE key type of the keys used with the algorithm indicated in 'ecdh_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span>.<a href="#section-6.4-5.2.4.12.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="section-6.4-5.2.5">
The format of 'key' defined above is consistent with every signature algorithm and ECDH algorithm currently considered in <span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>, i.e., with algorithms that have only the COSE key type as their COSE capability. <a href="#sec-future-cose-algs" class="xref">Appendix B</a> of this document describes how the format of the 'key' parameter can be generalized for possible future registered algorithms having a different set of COSE capabilities.<a href="#section-6.4-5.2.5" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-5.3">The 'exp' parameter MUST be present.<a href="#section-6.4-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-5.4">The 'ace-groupcomm-profile' parameter MUST be present and has value coap_group_oscore_app (PROFILE_TBD), which is defined in <a href="#ssec-iana-groupcomm-profile-registry" class="xref">Section 25.5</a> of this document.<a href="#section-6.4-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-5.5">
            <p id="section-6.4-5.5.1">The 'pub_keys' parameter, if present, includes the public keys requested by the joining node by means of the 'get_pub_keys' parameter in the Joining Request.<a href="#section-6.4-5.5.1" class="pilcrow">¶</a></p>
<p id="section-6.4-5.5.2">
If the joining node has asked for the public keys of all the group members, i.e., 'get_pub_keys' had value the CBOR simple value 'null' (0xf6) in the Joining Request, then the Group Manager provides only the public keys of the group members that are relevant to the joining node. That is, in such a case, 'pub_keys' includes only: i) the public keys of the responders currently in the OSCORE group, in case the joining node is configured (also) as requester; and ii) the public keys of the requesters currently in the OSCORE group, in case the joining node is configured (also) as responder or monitor.<a href="#section-6.4-5.5.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-5.6">The 'peer_identifiers' parameter includes the OSCORE Sender ID of each group member whose public key is specified in the 'pub_keys' parameter. That is, a group member's Sender ID is used as identifier for that group member (REQ25).<a href="#section-6.4-5.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-5.7">
            <p id="section-6.4-5.7.1">The 'group_policies' parameter SHOULD be present, and SHOULD include the following elements:<a href="#section-6.4-5.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-5.7.2.1">"Key Update Check Interval" defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with default value 3600;<a href="#section-6.4-5.7.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.7.2.2">"Expiration Delta" defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with default value 0.<a href="#section-6.4-5.7.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.4-5.8">The 'kdc_cred' parameter MUST be present, specifying the Group Manager's public key in its original binary representation (REQ8). The Group Manager's public key MUST be compatible with the encoding, signature or ECDH algorithm, and possible associated parameters used in the OSCORE group.<a href="#section-6.4-5.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-5.9">The 'kdc_nonce' parameter MUST be present, specifying the dedicated nonce N_KDC generated by the Group Manager. For N_KDC, it is RECOMMENDED to use a 8-byte long random nonce.<a href="#section-6.4-5.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-5.10">
            <p id="section-6.4-5.10.1">The 'kdc_cred_verify' parameter MUST be present, specifying the proof-of-possession (PoP) evidence computed by the Group Manager. The PoP evidence is computed over the nonce N_KDC, which is specified in the 'kdc_nonce' parameter and taken as PoP input. The PoP evidence is computed as defined below (REQ21).<a href="#section-6.4-5.10.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-5.10.2.1">If the group is not a pairwise-only group, the PoP evidence MUST be a signature. The Group Manager computes the signature by using the signature algorithm used in the OSCORE group, as well as its own private key associated to the public key specified in the 'kdc_cred' parameter.<a href="#section-6.4-5.10.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-5.10.2.2">
                <p id="section-6.4-5.10.2.2.1">If the group is a pairwise-only group, the PoP evidence MUST be a MAC computed as follows, by using the HKDF Algorithm HKDF SHA-256, which consists of composing the HKDF-Extract and HKDF-Expand steps <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>.<a href="#section-6.4-5.10.2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4-5.10.2.2.2">
MAC = HKDF(salt, IKM, info, L)<a href="#section-6.4-5.10.2.2.2" class="pilcrow">¶</a></p>
<p id="section-6.4-5.10.2.2.3">
The input parameters of HKDF are as follows.<a href="#section-6.4-5.10.2.2.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-5.10.2.2.4.1">salt takes as value the empty byte string.<a href="#section-6.4-5.10.2.2.4.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.4-5.10.2.2.4.2">IKM is computed as a cofactor Diffie-Hellman shared secret, see Section 5.7.1.2 of <span>[<a href="#NIST-800-56A" class="xref">NIST-800-56A</a>]</span>, using the ECDH algorithm used in the OSCORE group. The Group Manager uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the joining node. For X25519 and X448, the procedure is described in <span><a href="https://rfc-editor.org/rfc/rfc7748#section-5" class="relref">Section 5</a> of [<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-6.4-5.10.2.2.4.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.4-5.10.2.2.4.3">info takes as value the PoP input.<a href="#section-6.4-5.10.2.2.4.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.4-5.10.2.2.4.4">L is equal to 8, i.e., the size of the MAC, in bytes.<a href="#section-6.4-5.10.2.2.4.4" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.4-5.11">The 'group_rekeying' parameter MAY be omitted, if the Group Manager uses the "Point-to-Point" group rekeying scheme registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.14" class="relref">Section 11.14</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> as rekeying scheme in the OSCORE group (OPT9). Its detailed use for this profile is defined in <a href="#sec-group-rekeying-process" class="xref">Section 20</a> of this document. In any other case, the 'group_rekeying' parameter MUST be included.<a href="#section-6.4-5.11" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.4-6">As a last action, the Group Manager MUST store the Gid specified in the 'contextId' parameter of the 'key' parameter, as the Birth Gid of the joining node in the joined group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). This applies also in case the node is in fact re-joining the group; in such a case, the newly determined Birth Gid overwrites the one currently stored.<a href="#section-6.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-join-resp-processing">
<section id="section-6.5">
        <h3 id="name-receive-the-joining-respons">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-receive-the-joining-respons" class="section-name selfRef">Receive the Joining Response</a>
        </h3>
<p id="section-6.5-1">Upon receiving the Joining Response, the joining node retrieves the Group Manager's public key from the 'kdc_cred' parameter. The joining node MUST verify the proof-of-possession (PoP) evidence specified in the 'kdc_cred_verify' parameter of the Joining Response as defined below (REQ21).<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-2.1">If the group is not a pairwise-only group, the PoP evidence is a signature. The joining node verifies it by using the public key of the Group Manager, as well as the signature algorithm used in the OSCORE group and possible corresponding parameters.<a href="#section-6.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.5-2.2">If the group is a pairwise-only group, the PoP evidence is a MAC. The joining node recomputes the MAC through the same process taken by the Group Manager when computing the value of the 'kdc_cred_verify' parameter (see <a href="#ssec-join-resp" class="xref">Section 6.4</a>), with the difference that the joining node uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the Group Manager. The verification succeeds if and only if the recomputed MAC is equal to the MAC conveyed as PoP evidence in the Joining Response.<a href="#section-6.5-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.5-3">In case of failed verification of the PoP evidence, the joining node MUST stop processing the Joining Response and MAY send a new Joining Request to the Group Manager (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>).<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<p id="section-6.5-4">In case of successful verification of the PoP evidence, the joining node uses the information received in the Joining Response to set up the Group OSCORE Security Context, as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. If the following parameters were not included in the 'key' parameter of the Joining Response, the joining node considers the following default values, consistently with <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-6.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-5.1">Absent the 'hkdf' parameter, the joining node considers HKDF SHA-256 as HKDF Algorithm to use in the OSCORE group.<a href="#section-6.5-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.5-5.2">Absent the 'salt' parameter, the joining node considers the empty byte string as Master Salt to use in the OSCORE group.<a href="#section-6.5-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.5-5.3">Absent the 'group_rekeying' parameter, the joining node considers the "Point-to-Point" group rekeying scheme registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.14" class="relref">Section 11.14</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> as the rekeying scheme used in the group (OPT9). Its detailed use for this profile is defined in <a href="#sec-group-rekeying-process" class="xref">Section 20</a> of this document.<a href="#section-6.5-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.5-6">In addition, the joining node maintains an association between each public key retrieved from the 'pub_keys' parameter and the role(s) that the corresponding group member has in the OSCORE group.<a href="#section-6.5-6" class="pilcrow">¶</a></p>
<p id="section-6.5-7">From then on, the joining node can exchange group messages secured with Group OSCORE as described in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. When doing so:<a href="#section-6.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-8.1">The joining node MUST NOT process an incoming request message, if protected by a group member whose public key is not associated to the role "Requester".<a href="#section-6.5-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.5-8.2">The joining node MUST NOT process an incoming response message, if protected by a group member whose public key is not associated to the role "Responder".<a href="#section-6.5-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.5-8.3">The joining node MUST NOT use the pairwise mode of Group OSCORE to process messages in the group, if the Joining Response did not include the 'ecdh_alg' parameter.<a href="#section-6.5-8.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.5-9">If the application requires backward security, the Group Manager MUST generate updated security parameters and group keying material, and provide it to the current group members upon the new node's joining (see <a href="#sec-group-rekeying-process" class="xref">Section 20</a>). As a consequence, the joining node is not able to access secure communication in the OSCORE group occurred prior its joining.<a href="#section-6.5-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-public-keys-of-joining-nodes">
<section id="section-7">
      <h2 id="name-public-keys-of-joining-node">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-public-keys-of-joining-node" class="section-name selfRef">Public Keys of Joining Nodes</a>
      </h2>
<p id="section-7-1">Source authentication of a message sent within the group and protected with Group OSCORE is ensured by means of a digital signature embedded in the message (in group mode), or by integrity-protecting the message with pairwise keying material derived from the asymmetric keys of sender and recipient (in pairwise mode).<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Therefore, group members must be able to retrieve each other's public key from a trusted key repository, in order to verify source authenticity of incoming group messages.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">As also discussed in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the Group Manager acts as trusted repository of the public keys of the group members, and provides those public keys to group members if requested to. Upon joining an OSCORE group, a joining node is thus expected to provide its own public key to the Group Manager.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">In particular, one of the following four cases can occur when a new node joins an OSCORE group.<a href="#section-7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-5.1">The joining node is going to join the group exclusively as monitor, i.e., it is not going to send messages to the group. In this case, the joining node is not required to provide its own public key to the Group Manager, which thus does not have to perform any check related to the public key encoding, to a signature or ECDH algorithm, and to possible associated parameters. In case that joining node still provides a public key in the 'client_cred' parameter of the Joining Request (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>), the Group Manager silently ignores that parameter, as well as the related parameters 'cnonce' and 'client_cred_verify'.<a href="#section-7-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-5.2">The Group Manager already acquired the public key of the joining node during a past joining process. In this case, the joining node MAY choose not to provide again its own public key to the Group Manager, in order to limit the size of the Joining Request. The joining node MUST provide its own public key again if it has provided the Group Manager with multiple public keys during past joining processes, intended for different OSCORE groups. If the joining node provides its own public key, the Group Manager performs consistency checks as per <a href="#ssec-join-req-processing" class="xref">Section 6.3</a> and, in case of success, considers it as the public key associated to the joining node in the OSCORE group.<a href="#section-7-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-5.3">
          <p id="section-7-5.3.1">The joining node and the Group Manager use an asymmetric proof-of-possession key to establish a secure communication association. Then, two cases can occur.<a href="#section-7-5.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-5.3.2">
<li id="section-7-5.3.2.1">The proof-of-possession key is compatible with the encoding, as well as with the signature or ECDH algorithm, and with possible associated parameters used in the OSCORE group. Then, the Group Manager considers the proof-of-possession key as the public key associated to the joining node in the OSCORE group. If the joining node is aware that the proof-of-possession key is also valid for the OSCORE group, it MAY not provide it again as its own public key to the Group Manager. The joining node MUST provide its own public key again if it has provided the Group Manager with multiple public keys during past joining processes, intended for different OSCORE groups. If the joining node provides its own public key in the 'client_cred' parameter of the Joining Request (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>), the Group Manager performs consistency checks as per <a href="#ssec-join-req-processing" class="xref">Section 6.3</a> and, in case of success, considers it as the public key associated to the joining node in the OSCORE group.<a href="#section-7-5.3.2.1" class="pilcrow">¶</a>
</li>
            <li id="section-7-5.3.2.2">The proof-of-possession key is not compatible with the encoding, or with the signature or algorithm, and with possible associated parameters used in the OSCORE group. In this case, the joining node MUST provide a different compatible public key to the Group Manager in the 'client_cred' parameter of the Joining Request (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>). Then, the Group Manager performs consistency checks on this latest provided public key as per <a href="#ssec-join-req-processing" class="xref">Section 6.3</a> and, in case of success, considers it as the public key associated to the joining node in the OSCORE group.<a href="#section-7-5.3.2.2" class="pilcrow">¶</a>
</li>
          </ol>
</li>
        <li class="normal" id="section-7-5.4">The joining node and the Group Manager use a symmetric proof-of-possession key to establish a secure communication association. In this case, upon performing a joining process with that Group Manager for the first time, the joining node specifies its own public key in the 'client_cred' parameter of the Joining Request targeting the group-membership endpoint (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>).<a href="#section-7-5.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="sec-updated-key">
<section id="section-8">
      <h2 id="name-retrieve-of-updated-keying-">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-retrieve-of-updated-keying-" class="section-name selfRef">Retrieve of Updated Keying Material</a>
      </h2>
<p id="section-8-1">At some point, a group member considers the Group OSCORE Security Context invalid and to be renewed. This happens, for instance, after a number of unsuccessful security processing of incoming messages from other group members, or when the Security Context expires as specified by the 'exp' parameter of the Joining Response.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">When this happens, the group member retrieves updated security parameters and group keying material. This can occur in the two different ways described below.<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="ssec-updated-key-only">
<section id="section-8.1">
        <h3 id="name-retrieve-of-group-keying-ma">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-retrieve-of-group-keying-ma" class="section-name selfRef">Retrieve of Group Keying Material</a>
        </h3>
<p id="section-8.1-1">If the group member wants to retrieve only the latest group keying material, it sends a Key Distribution Request to the Group Manager.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">In particular, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME at the Group Manager.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">The Group Manager processes the Key Distribution Request according to <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.2" class="relref">Section 4.3.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The Key Distribution Response is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.2" class="relref">Section 4.3.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the following additions.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-4.1">The 'key' parameter is formatted as defined in <a href="#ssec-join-resp" class="xref">Section 6.4</a> of this document, with the difference that it does not include the 'group_SenderId' parameter.<a href="#section-8.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-4.2">The 'exp' parameter MUST be present.<a href="#section-8.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-4.3">The 'ace-groupcomm-profile' parameter MUST be present and has value coap_group_oscore_app.<a href="#section-8.1-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.1-5">Upon receiving the Key Distribution Response, the group member retrieves the updated security parameters and group keying material, and, if they differ from the current ones, uses them to set up the new Group OSCORE Security Context as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-updated-and-individual-key">
<section id="section-8.2">
        <h3 id="name-retrieve-of-group-keying-mat">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-retrieve-of-group-keying-mat" class="section-name selfRef">Retrieve of Group Keying Material and OSCORE Sender ID</a>
        </h3>
<p id="section-8.2-1">If the group member wants to retrieve the latest group keying material as well as the OSCORE Sender ID that it has in the OSCORE group, it sends a Key Distribution Request to the Group Manager.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">In particular, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the Group Manager.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">The Group Manager processes the Key Distribution Request according to <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.8.1" class="relref">Section 4.8.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The Key Distribution Response is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.8.1" class="relref">Section 4.8.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the following additions.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-4.1">
            <p id="section-8.2-4.1.1">The 'key' parameter is formatted as defined in <a href="#ssec-join-resp" class="xref">Section 6.4</a> of this document. In particular, if the requesting group member has exclusively the role of monitor, no 'group_SenderId' is specified within the 'key' parameter.<a href="#section-8.2-4.1.1" class="pilcrow">¶</a></p>
<p id="section-8.2-4.1.2">
Note that, in any other case, the current Sender ID of the group member is not specified as a separate parameter, but rather specified as 'group_SenderId' within the 'key' parameter.<a href="#section-8.2-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-4.2">The 'exp' parameter MUST be present.<a href="#section-8.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.2-5">Upon receiving the Key Distribution Response, the group member retrieves the updated security parameters, group keying material and Sender ID, and, if they differ from the current ones, uses them to set up the new Group OSCORE Security Context as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-new-key">
<section id="section-9">
      <h2 id="name-request-to-change-individua">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-request-to-change-individua" class="section-name selfRef">Request to Change Individual Keying Material</a>
      </h2>
<p id="section-9-1">As discussed in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2.5.2" class="relref">Section 2.5.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, a group member may at some point exhaust its Sender Sequence Numbers in the OSCORE group.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">When this happens, the group member MUST send a Key Renewal Request message to the Group Manager, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.8.2.1" class="relref">Section 4.8.2.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, it sends a CoAP PUT request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the Group Manager.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Upon receiving the Key Renewal Request, the Group Manager processes it as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the following additions.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">The Group Manager MUST return a 5.03 (Service Unavailable) response in case the OSCORE group identified by GROUPNAME is currently inactive (see <a href="#ssec-resource-active" class="xref">Section 5.1</a>). The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 9 ("Group currently not active").<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">Otherwise, the Group Manager performs one of the following actions.<a href="#section-9-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9-6">
<li id="section-9-6.1">If the requesting group member has exclusively the role of monitor, the Group Manager replies with a 4.03 (Forbidden) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 1 ("Request inconsistent with the current roles").<a href="#section-9-6.1" class="pilcrow">¶</a>
</li>
        <li id="section-9-6.2">
          <p id="section-9-6.2.1">Otherwise, the Group Manager takes one of the following actions.<a href="#section-9-6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-6.2.2.1">
              <p id="section-9-6.2.2.1.1">The Group Manager rekeys the OSCORE group. That is, the Group Manager generates new group keying material for that group (see <a href="#sec-group-rekeying-process" class="xref">Section 20</a>), and replies to the group member with a group rekeying message as defined in <a href="#sec-group-rekeying-process" class="xref">Section 20</a>, providing the new group keying material. Then, the Group Manager rekeys the rest of the OSCORE group, as discussed in <a href="#sec-group-rekeying-process" class="xref">Section 20</a>.<a href="#section-9-6.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-9-6.2.2.1.2">
The Group Manager SHOULD perform a group rekeying only if already scheduled to  occur shortly, e.g., according to an application-dependent rekeying period or scheduling, or as a reaction to a recent change in the group membership. In any other case, the Group Manager SHOULD NOT rekey the OSCORE group when receiving a Key Renewal Request (OPT12).<a href="#section-9-6.2.2.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9-6.2.2.2">
              <p id="section-9-6.2.2.2.1">The Group Manager determines and assigns a new OSCORE Sender ID for that group member, and replies with a Key Renewal Response formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, the CBOR Map in the response payload includes a single parameter 'group_SenderId' defined in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="xref">Section 25.3</a> of this document, specifying the new Sender ID of the group member encoded as a CBOR byte string.<a href="#section-9-6.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-9-6.2.2.2.2">
Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2.5.3.1" class="relref">Section 2.5.3.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the Group Manager MUST assign a new Sender ID that has not been used in the OSCORE group since the latest time when the current Gid value was assigned to the group.<a href="#section-9-6.2.2.2.2" class="pilcrow">¶</a></p>
<p id="section-9-6.2.2.2.3">
Furthermore, the Group Manager MUST add the old, relinquished Sender ID of the group member to the most recent set of stale Sender IDs, in the collection associated to the group (see <a href="#sssec-stale-sender-ids" class="xref">Section 2.2.1</a>).<a href="#section-9-6.2.2.2.3" class="pilcrow">¶</a></p>
<p id="section-9-6.2.2.2.4">
The Group Manager MUST return a 5.03 (Service Unavailable) response in case there are currently no Sender IDs available to assign in the OSCORE group. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 4 ("No available node identifiers").<a href="#section-9-6.2.2.2.4" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ol>
</section>
</div>
<div id="sec-pub-keys">
<section id="section-10">
      <h2 id="name-retrieve-public-keys-of-gro">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-retrieve-public-keys-of-gro" class="section-name selfRef">Retrieve Public Keys of Group Members</a>
      </h2>
<p id="section-10-1">A group member or a signature verifier may need to retrieve the public keys of (other) group members. To this end, the group member or signature verifier sends a Public Key Request message to the Group Manager, as per Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.4.1.1" class="relref">4.4.1.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.4.2.1" class="relref">4.4.2.1</a> of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, it sends the request to the endpoint /ace-group/GROUPNAME/pub-key at the Group Manager.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">If the Public Key Request uses the method FETCH, the Public Key Request is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.4.1" class="relref">Section 4.4.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular:<a href="#section-10-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-3.1">Each element (if any) of the inner CBOR array 'role_filter' is formatted as in the inner CBOR array 'role_filter' of the 'get_pub_keys' parameter of the Joining Request when the parameter value is non-null (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>).<a href="#section-10-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-3.2">Each element (if any) of the inner CBOR array 'id_filter' is a CBOR byte string, which encodes the OSCORE Sender ID of the group member for which the associated public key is requested (REQ25).<a href="#section-10-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-10-4">Upon receiving the Public Key Request, the Group Manager processes it as per Section 4.4.1 or Section 4.4.2 of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, depending on the request method being FETCH or GET, respectively. Additionally, if the Public Key Request uses the method FETCH, the Group Manager silently ignores node identifiers included in the 'get_pub_keys' parameter of the request that are not associated to any current group member (REQ26).<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">The success Public Key Response is formatted as defined in Section 4.4.1 or Section 4.4.2 of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, depending on the request method being FETCH or GET, respectively.<a href="#section-10-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-update-pub-key">
<section id="section-11">
      <h2 id="name-upload-a-new-public-key">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-upload-a-new-public-key" class="section-name selfRef">Upload a New Public Key</a>
      </h2>
<p id="section-11-1">A group member may need to provide the Group Manager with its new public key to use in the group from then on, hence replacing the current one. This can be the case, for instance, if the signature or ECDH algorithm, and possible associated parameters used in the OSCORE group have been changed, and the current public key is not compatible with them.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">To this end, the group member sends a Public Key Update Request message to the Group Manager, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.9.1.1" class="relref">Section 4.9.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the following addition.<a href="#section-11-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-3.1">The group member computes the proof-of-possession (PoP) evidence included in 'client_cred_verify' in the same way taken when preparing a Joining Request for the OSCORE group in question, as defined in <a href="#ssec-join-req-sending" class="xref">Section 6.2</a> (REQ14).<a href="#section-11-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-4">In particular, the group member sends a CoAP POST request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME/pub-key at the Group Manager.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">Upon receiving the Public Key Update Request, the Group Manager processes it as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.9.1" class="relref">Section 4.9.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, with the following additions.<a href="#section-11-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-6.1">The N_S challenge used to build the proof-of-possession input is computed as per point (1) in <a href="#sssec-challenge-value" class="xref">Section 6.2.1</a> (REQ15).<a href="#section-11-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-6.2">The Group Manager verifies the PoP challenge included in 'client_cred_verify' in the same way taken when processing a Joining Request for the OSCORE group in question, as defined in <a href="#ssec-join-req-processing" class="xref">Section 6.3</a> (REQ14).<a href="#section-11-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-6.3">The Group Manager MUST return a 5.03 (Service Unavailable) response in case the OSCORE group identified by GROUPNAME is currently inactive (see <a href="#ssec-resource-active" class="xref">Section 5.1</a>). The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 9 ("Group currently not active").<a href="#section-11-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-6.4">If the requesting group member has exclusively the role of monitor, the Group Manager replies with a 4.00 (Bad request) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 1 ("Request inconsistent with the current roles").<a href="#section-11-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-6.5">If the request is successfully processed, the Group Manager stores the association between i) the new public key of the group member; and ii) the Group Identifier (Gid), i.e., the OSCORE ID Context, associated to the OSCORE group together with the OSCORE Sender ID assigned to the group member in the group. The Group Manager MUST keep this association updated over time.<a href="#section-11-6.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="sec-gm-pub-key">
<section id="section-12">
      <h2 id="name-retrieve-the-group-managers">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-retrieve-the-group-managers" class="section-name selfRef">Retrieve the Group Manager's Public Key</a>
      </h2>
<p id="section-12-1">A group member or a signature verifier may need to retrieve the public key of the Group Manager. To this end, the requesting client sends a KDC Public Key Request message to the Group Manager.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">In particular, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/kdc-pub-key at the Group Manager defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.5.1.1" class="relref">Section 4.5.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, where GROUPNAME is the name of the OSCORE group.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">In addition to what is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, the Group Manager MUST respond with a 4.00 (Bad Request) error response, if the requesting client is not a current group member and GROUPNAME denotes a pairwise-only group. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in Section <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The value of the 'error' field MUST be set to 7 ("Signatures not used in the group").<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">The payload of the 2.05 (Content) KDC Public Key Response is a CBOR map, which is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, the Group Manager specifies the parameters 'kdc_cred', 'kdc_nonce' and 'kdc_challenge' as defined for the Joining Response in <a href="#ssec-join-resp" class="xref">Section 6.4</a> of this document. This especially applies to the computing of the proof-of-possession (PoP) evidence included in 'kdc_cred_verify' (REQ21).<a href="#section-12-4" class="pilcrow">¶</a></p>
<p id="section-12-5">Upon receiving a 2.05 (Content) KDC Public Key Response, the requesting client retrieves the Group Manager's public key from the 'kdc_cred' parameter, and proceeds as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.5.1.1" class="relref">Section 4.5.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, the requesting client verifies the PoP evidence included in 'kdc_cred_verify' by means of the same method used when processing the Joining Response, as defined in <a href="#ssec-join-resp" class="xref">Section 6.4</a> of this document (REQ21).<a href="#section-12-5" class="pilcrow">¶</a></p>
<p id="section-12-6">Note that a signature verifier would not receive a successful response from the Group Manager, in case GROUPNAME denotes a pairwise-only group.<a href="#section-12-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-verif-data">
<section id="section-13">
      <h2 id="name-retrieve-signature-verifica">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-retrieve-signature-verifica" class="section-name selfRef">Retrieve Signature Verification Data</a>
      </h2>
<p id="section-13-1">A signature verifier may need to retrieve data required to verify signatures of messages protected with the group mode and sent to a group (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.1" class="relref">3.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-8.5" class="relref">8.5</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). To this end, the signature verifier sends a Signature Verification Data Request message to the Group Manager.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">In particular, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/verif-data at the Group Manager defined in <a href="#ssec-resource-verif-data" class="xref">Section 5.2</a> of this document, where GROUPNAME is the name of the OSCORE group.<a href="#section-13-2" class="pilcrow">¶</a></p>
<p id="section-13-3">The payload of the 2.05 (Content) Signature Verification Data Response is a CBOR map, which has the format used for the Joining Response message in <a href="#ssec-join-resp" class="xref">Section 6.4</a>, with the following differences.<a href="#section-13-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-4.1">
          <p id="section-13-4.1.1">From the Joining Response message, only the parameters 'gkty', 'key', 'num', 'exp' and 'ace-groupcomm-profile' are present. In particular, the 'key' parameter includes only the following data.<a href="#section-13-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-4.1.2.1">The parameters 'hkdf', 'contextId', 'pub_key_enc', 'sign_enc_alg', 'sign_alg', 'sign_params'. These parameters MUST be present.<a href="#section-13-4.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-13-4.1.2.2">The parameters 'alg' and 'ecdh_alg'. These parameter MUST NOT be present if the group is a signature-only group. Otherwise, they MUST be present.<a href="#section-13-4.1.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-13-4.2">The parameter 'group_enc_key' is also included, with CBOR label defined in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="xref">Section 25.3</a>. This parameter specifies the Group Encryption Key of the OSCORE Group, encoded as a CBOR byte string. The Group Manager derives the Group Encryption Key from the group keying material, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-2.1.6" class="relref">Section 2.1.6</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. This parameter MUST be present.<a href="#section-13-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-13-5">In order to verify signatures in the group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-8.5" class="relref">Section 8.5</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>), the signature verifier relies on: the data retrieved from the 2.05 (Content) Signature Verification Data Response; the public keys of the group members signing the messages to verify, that can be retrieved as defined in <a href="#sec-pub-keys" class="xref">Section 10</a>; and the public key of the Group Manager, which can be retrieved as defined in <a href="#sec-gm-pub-key" class="xref">Section 12</a>.<a href="#section-13-5" class="pilcrow">¶</a></p>
<p id="section-13-6"><a href="#fig-verif-data-req-resp" class="xref">Figure 3</a> gives an overview of the exchange described above,  while <a href="#fig-verif-data-req-resp-ex" class="xref">Figure 4</a> shows an example.<a href="#section-13-6" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-signature-v"></span><div id="fig-verif-data-req-resp">
<figure id="figure-3">
        <div class="alignCenter art-text artwork" id="section-13-7.1">
<pre>
Signature                                                     Group
Verifier                                                     Manager
  |                                                             |
  |              Signature Verification Data Request            |
  |------------------------------------------------------------&gt;|
  |              GET ace-group/GROUPNAME/verif-data             |
  |                                                             |
  |&lt;--- Signature Verification Data Response: 2.05 (Content) ---|
  |                                                             |
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-message-flow-of-signature-v" class="selfRef">Message Flow of Signature Verification Data Request-Response</a>
        </figcaption></figure>
</div>
<span id="name-example-of-signature-verifi"></span><div id="fig-verif-data-req-resp-ex">
<figure id="figure-4">
        <div class="alignLeft art-text artwork" id="section-13-8.1">
<pre>
   Request:

   Header: GET (Code=0.01)
   Uri-Host: "kdc.example.com"
   Uri-Path: "ace-group"
   Uri-Path: "g1"
   Uri-Path: "verif-data"
   Payload: -

   Response:

   Header: Content (Code=2.05)
   Content-Format: "application/ace-groupcomm+cbor"
   Payload (in CBOR diagnostic notation, with GROUPCOMM_KEY_TBD
            and PROFILE_TBD being CBOR integers, while GROUP_ENC_KEY
            being a CBOR byte string):
    {
      "gkty": GROUPCOMM_KEY_TBD,
      "key": {
        'hkdf': -10,                   ; HKDF SHA-256
        'contextId': h'37fc',
        'pub_key_enc': 33,             ; x5chain
        'sign_enc_alg': 10,            ; AES-CCM-16-64-128
        'sign_alg': -8,                ; EdDSA
        'sign_params': [[1], [1, 6]]   ; [[OKP], [OKP, Ed25519]]
      },
      "num": 12,
      "exp": 1609459200,
      "ace_groupcomm_profile": PROFILE_TBD,
      "group_enc_key": GROUP_ENC_KEY
    }
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-signature-verifi" class="selfRef">Example of Signature Verification Data Request-Response</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-policies">
<section id="section-14">
      <h2 id="name-retrieve-the-group-policies">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-retrieve-the-group-policies" class="section-name selfRef">Retrieve the Group Policies</a>
      </h2>
<p id="section-14-1">A group member may request the current policies used in the OSCORE group. To this end, the group member sends a Policies Request, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.6.1.1" class="relref">Section 4.6.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/policies at the Group Manager, where GROUPNAME is the name of the OSCORE group.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">Upon receiving the Policies Request, the Group Manager processes it as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.6.1" class="relref">Section 4.6.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The success Policies Response is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.6.1" class="relref">Section 4.6.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-14-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-version">
<section id="section-15">
      <h2 id="name-retrieve-the-keying-materia">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-retrieve-the-keying-materia" class="section-name selfRef">Retrieve the Keying Material Version</a>
      </h2>
<p id="section-15-1">A group member may request the current version of the keying material used in the OSCORE group. To this end, the group member sends a Version Request, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.7.1.1" class="relref">Section 4.7.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/num at the Group Manager, where GROUPNAME is the name of the OSCORE group.<a href="#section-15-1" class="pilcrow">¶</a></p>
<p id="section-15-2">Upon receiving the Version Request, the Group Manager processes it as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.7.1" class="relref">Section 4.7.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The success Version Response is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.7.1" class="relref">Section 4.7.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-15-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-status">
<section id="section-16">
      <h2 id="name-retrieve-the-group-status">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-retrieve-the-group-status" class="section-name selfRef">Retrieve the Group Status</a>
      </h2>
<p id="section-16-1">A group member may request the current status of the the OSCORE group, i.e., active or inactive. To this end, the group member sends a Group Status Request to the Group Manager.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">In particular, the group member sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/active at the Group Manager defined in <a href="#ssec-resource-active" class="xref">Section 5.1</a> of this document, where GROUPNAME is the name of the OSCORE group.<a href="#section-16-2" class="pilcrow">¶</a></p>
<p id="section-16-3">The payload of the 2.05 (Content) Group Status Response includes the CBOR simple value True if the group is currently active, or the CBOR simple value False otherwise. The group is considered active if it is set to allow new members to join, and if communication within the group is fine to happen.<a href="#section-16-3" class="pilcrow">¶</a></p>
<p id="section-16-4">Upon learning from a 2.05 (Content) response that the group is currently inactive, the group member SHOULD stop taking part in communications within the group, until it becomes active again.<a href="#section-16-4" class="pilcrow">¶</a></p>
<p id="section-16-5">Upon learning from a 2.05 (Content) response that the group has become active again, the group member can resume taking part in communications within the group.<a href="#section-16-5" class="pilcrow">¶</a></p>
<p id="section-16-6"><a href="#fig-key-status-req-resp" class="xref">Figure 5</a> gives an overview of the exchange described above, while <a href="#fig-key-status-req-resp-ex" class="xref">Figure 6</a> shows an example.<a href="#section-16-6" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-group-statu"></span><div id="fig-key-status-req-resp">
<figure id="figure-5">
        <div class="alignCenter art-text artwork" id="section-16-7.1">
<pre>
Group                                                         Group
Member                                                       Manager
  |                                                             |
  |--- Group Status Request: GET ace-group/GROUPNAME/active ---&gt;|
  |                                                             |
  |&lt;---------- Group Status Response: 2.05 (Content) -----------|
  |                                                             |
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-message-flow-of-group-statu" class="selfRef">Message Flow of Group Status Request-Response</a>
        </figcaption></figure>
</div>
<span id="name-example-of-group-status-req"></span><div id="fig-key-status-req-resp-ex">
<figure id="figure-6">
        <div class="alignLeft art-text artwork" id="section-16-8.1">
<pre>
   Request:

   Header: GET (Code=0.01)
   Uri-Host: "kdc.example.com"
   Uri-Path: "ace-group"
   Uri-Path: "g1"
   Uri-Path: "active"
   Payload: -

   Response:

   Header: Content (Code=2.05)
   Payload (in CBOR diagnostic notation):
     true
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-of-group-status-req" class="selfRef">Example of Group Status Request-Response</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-retrieve-gnames">
<section id="section-17">
      <h2 id="name-retrieve-group-names">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-retrieve-group-names" class="section-name selfRef">Retrieve Group Names</a>
      </h2>
<p id="section-17-1">A node may want to retrieve from the Group Manager the group name and the URI of the group-membership resource of a group. This is relevant in the following cases.<a href="#section-17-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17-2.1">Before joining a group, a joining node may know only the current Group Identifier (Gid) of that group, but not the group name and the URI to the group-membership resource.<a href="#section-17-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-17-2.2">
          <p id="section-17-2.2.1">As current group member in several groups, the node has missed a previous group rekeying in one of them (see <a href="#sec-group-rekeying-process" class="xref">Section 20</a>). Hence, it retains stale keying material and fails to decrypt received messages exchanged in that group.<a href="#section-17-2.2.1" class="pilcrow">¶</a></p>
<p id="section-17-2.2.2">
Such messages do not provide a direct hint to the correct group name, that the node would need in order to retrieve the latest keying material and public keys from the Group Manager (see <a href="#ssec-updated-key-only" class="xref">Section 8.1</a>, <a href="#ssec-updated-and-individual-key" class="xref">Section 8.2</a> and <a href="#sec-pub-keys" class="xref">Section 10</a>). However, such messages may specify the current Gid of the group, as value of the 'kid_context' field of the OSCORE CoAP option (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span> and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-4.2" class="relref">Section 4.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-17-2.2.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-17-2.3">
          <p id="section-17-2.3.1">As signature verifier, the node also refers to a group name for retrieving the required public keys from the Group Manager (see <a href="#sec-pub-keys" class="xref">Section 10</a>). As discussed above, intercepted messages do not provide a direct hint to the correct group name, while they may specify the current Gid of the group, as value of the 'kid_context' field of the OSCORE CoAP option. In such a case, upon intercepting a message in the group, the node requires to correctly map the Gid currently used in the group with the invariant group name.<a href="#section-17-2.3.1" class="pilcrow">¶</a></p>
<p id="section-17-2.3.2">
Furthermore, since it is not a group member, the node does not take part to a possible group rekeying. Thus, following a group rekeying and the consequent change of Gid in a group, the node would retain the old Gid value and cannot correctly associate intercepted messages to the right group, especially if acting as signature verifier in several groups. This in turn prevents the efficient verification of signatures, and especially the retrieval of required, new public keys from the Group Manager.<a href="#section-17-2.3.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-17-3">In either case, the node only knows the current Gid of the group, as learned from received or intercepted messages exchanged in the group. As detailed below, the node can contact the Group Manager, and request the group name and URI to the group-membership resource corresponding to that Gid. Then, it can use that information to either join the group as a candidate group member, get the latest keying material as a current group member, or retrieve public keys used in the group as a signature verifier. To this end, the node sends a Group Name and URI Retrieval Request, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.2.1.1" class="relref">Section 4.2.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-17-3" class="pilcrow">¶</a></p>
<p id="section-17-4">In particular, the node sends a CoAP FETCH request to the endpoint /ace-group at the Group Manager formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. Each element of the CBOR array 'gid' is a CBOR byte string (REQ13), which encodes the Gid of the group for which the group name and the URI to the group-membership resource are requested.<a href="#section-17-4" class="pilcrow">¶</a></p>
<p id="section-17-5">Upon receiving the Group Name and URI Retrieval Request, the Group Manager processes it as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. The success Group Name and URI Retrieval Response is formatted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, each element of the CBOR array 'gid' is a CBOR byte string (REQ13), which encodes the Gid of the group for which the group name and the URI to the group-membership resource are provided.<a href="#section-17-5" class="pilcrow">¶</a></p>
<p id="section-17-6">For each of its groups, the Group Manager maintains an association between the group name and the URI to the group-membership resource on one hand, and only the current Gid for that group on the other hand. That is, the Group Manager MUST NOT maintain an association between the former pair and any other Gid for that group than the current, most recent one.<a href="#section-17-6" class="pilcrow">¶</a></p>
<p id="section-17-7"><a href="#fig-group-names-req-resp" class="xref">Figure 7</a> gives an overview of the exchanges described above, while <a href="#fig-group-names-req-resp-ex" class="xref">Figure 8</a> shows an example.<a href="#section-17-7" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-group-name-"></span><div id="fig-group-names-req-resp">
<figure id="figure-7">
        <div class="alignCenter art-text artwork" id="section-17-8.1">
<pre>
                                                                Group
Node                                                           Manager
 |                                                                |
 |---- Group Name and URI Retrieval Request: FETCH ace-group/ ---&gt;|
 |                                                                |
 |&lt;--- Group Name and URI Retrieval Response: 2.05 (Content) -----|
 |                                                                |
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-message-flow-of-group-name-" class="selfRef">Message Flow of Group Name and URI Retrieval Request-Response</a>
        </figcaption></figure>
</div>
<span id="name-example-of-group-name-and-u"></span><div id="fig-group-names-req-resp-ex">
<figure id="figure-8">
        <div class="alignLeft art-text artwork" id="section-17-9.1">
<pre>
   Request:

   Header: FETCH (Code=0.05)
   Uri-Host: "kdc.example.com"
   Uri-Path: "ace-group"
   Content-Format: "application/ace-groupcomm+cbor"
   Payload (in CBOR diagnostic notation):
     {
       "gid": [h'37fc', h'84bd']
     }

   Response:

   Header: Content (Code=2.05)
   Content-Format: "application/ace-groupcomm+cbor"
   Payload (in CBOR diagnostic notation):
     {
       "gid": [h'37fc', h'84bd'],
       "gname": ["g1", "g2"],
       "guri": ["ace-group/g1", "ace-group/g2"]
     }
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-example-of-group-name-and-u" class="selfRef">Example of Group Name and URI Retrieval Request-Response</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-leave-req">
<section id="section-18">
      <h2 id="name-leave-the-group">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-leave-the-group" class="section-name selfRef">Leave the Group</a>
      </h2>
<p id="section-18-1">A group member may request to leave the OSCORE group. To this end, the group member sends a Group Leaving Request, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.8.3.1" class="relref">Section 4.8.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, it sends a CoAP DELETE request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the Group Manager.<a href="#section-18-1" class="pilcrow">¶</a></p>
<p id="section-18-2">Upon receiving the Group Leaving Request, the Group Manager processes it as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.8.3" class="relref">Section 4.8.3</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. Then, the Group Manager performs the follow-up actions defined in <a href="#sec-leaving" class="xref">Section 19</a>.<a href="#section-18-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-leaving">
<section id="section-19">
      <h2 id="name-removal-of-a-group-member">
<a href="#section-19" class="section-number selfRef">19. </a><a href="#name-removal-of-a-group-member" class="section-name selfRef">Removal of a Group Member</a>
      </h2>
<p id="section-19-1">Other than after a spontaneous request to the Group Manager as described in <a href="#sec-leave-req" class="xref">Section 18</a>, a node may be forcibly removed from the OSCORE group, e.g., due to expired or revoked authorization.<a href="#section-19-1" class="pilcrow">¶</a></p>
<p id="section-19-2">In either case, the Group Manager "forgets" the Birth Gid currently associated to the leaving node in the OSCORE group. This was stored following the Joining Response sent to that node, after its latest (re-)joining of the OSCORE group (see <a href="#ssec-join-resp" class="xref">Section 6.4</a>).<a href="#section-19-2" class="pilcrow">¶</a></p>
<p id="section-19-3">If any of the two conditions below holds, the Group Manager MUST inform the leaving node of its eviction as follows. If both conditions hold, the Group Manager MUST inform the leaving node only once, using either of the corresponding methods.<a href="#section-19-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-19-4.1">If, upon joining the group (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>), the leaving node specified a URI in the 'control_uri' parameter defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, the Group Manager sends a DELETE request targeting the URI specified in the 'control_uri' parameter (OPT7).<a href="#section-19-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-19-4.2">If, when sending Joining Responses to nodes joining the group (see <a href="#ssec-join-resp" class="xref">Section 6.4</a>) the Group Manager specifies a URI in the 'control_group_uri' parameter defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, the Group Manager sends a DELETE request targeting the URI specified in the 'control_group_uri' parameter (OPT10).<a href="#section-19-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-19-4.3">If the leaving node has been observing the associated resource at ace-group/GROUPNAME/nodes/NODENAME, the Group Manager sends an unsolicited 4.04 (Not Found) error response to the leaving node, as specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.2" class="relref">Section 4.3.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-19-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-19-5">If the leaving node has not exclusively the role of monitor, the Group Manager performs the following actions.<a href="#section-19-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-19-6.1">The Group Manager frees the OSCORE Sender ID value of the leaving node. This value MUST NOT become available for possible upcoming joining nodes in the same group, until the group has been rekeyed and assigned a new Group Identifier (Gid).<a href="#section-19-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-19-6.2">The Group Manager MUST add the relinquished Sender ID of the leaving node to the most recent set of stale Sender IDs, in the collection associated to the group (see <a href="#sssec-stale-sender-ids" class="xref">Section 2.2.1</a>).<a href="#section-19-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-19-6.3">The Group Manager cancels the association between, on one hand, the public key of the leaving node and, on the other hand, the Gid associated to the OSCORE group together with the freed Sender ID value. The Group Manager deletes the public key of the leaving node, if that public key has no remaining association with any pair (Gid, Sender ID).<a href="#section-19-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-19-7">Then, the Group Manager MUST generate updated security parameters and group keying material, and provide it to the remaining group members (see <a href="#sec-group-rekeying-process" class="xref">Section 20</a>). As a consequence, the leaving node is not able to acquire the new security parameters and group keying material distributed after its leaving.<a href="#section-19-7" class="pilcrow">¶</a></p>
<p id="section-19-8">The same considerations from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> apply here as well, considering the Group Manager acting as KDC.<a href="#section-19-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-group-rekeying-process">
<section id="section-20">
      <h2 id="name-group-rekeying-process">
<a href="#section-20" class="section-number selfRef">20. </a><a href="#name-group-rekeying-process" class="section-name selfRef">Group Rekeying Process</a>
      </h2>
<p id="section-20-1">In order to rekey the OSCORE group, the Group Manager distributes a new Group Identifier (Gid), i.e., a new OSCORE ID Context; a new OSCORE Master Secret; and, optionally, a new OSCORE Master Salt for that group. When doing so, the Group Manager MUST increment the version number of the group keying material, before starting its distribution.<a href="#section-20-1" class="pilcrow">¶</a></p>
<p id="section-20-2">Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>:<a href="#section-20-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-20-3.1">The Group Manager can reassign a Gid to the same group over that group's lifetime, e.g., once the whole space of Gid values has been used for the group in question.<a href="#section-20-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-20-3.2">
          <p id="section-20-3.2.1">Before rekeying the group, the Group Manager MUST check if the new Gid to be distributed coincides with the Birth Gid of any of the current group members (see <a href="#ssec-join-resp" class="xref">Section 6.4</a>). If any of such "elder members" is found in the group, the Group Manager MUST evict them from the group. That is, the Group Manager MUST terminate their membership and MUST rekey the group in such a way that the new keying material is not provided to those evicted elder members. This also includes adding their relinquished Sender IDs to the most recent set of stale Sender IDs, in the collection associated to the group (see <a href="#sssec-stale-sender-ids" class="xref">Section 2.2.1</a>), before rekeying the group.<a href="#section-20-3.2.1" class="pilcrow">¶</a></p>
<p id="section-20-3.2.2">
Until a further following group rekeying, the Group Manager MUST store the list of those latest-evicted elder members. If any of those nodes re-joins the group before a further following group rekeying occurs, the Group Manager MUST NOT rekey the group upon their re-joining. When one of those nodes re-joins the group, the Group Manager can rely, e.g., on the ongoing secure communication association to recognize the node as included in the stored list.<a href="#section-20-3.2.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-20-4">Across the rekeying execution, the Group Manager MUST preserve the same unchanged OSCORE Sender IDs for all group members intended to remain in the group. This avoids affecting the retrieval of public keys from the Group Manager and the verification of group messages.<a href="#section-20-4" class="pilcrow">¶</a></p>
<p id="section-20-5">The Group Manager MUST support the "Point-to-Point" group rekeying scheme registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.14" class="relref">Section 11.14</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, as per the detailed use defined in <a href="#sending-rekeying-msg" class="xref">Section 20.1</a> of this document. Future specifications may define how this application profile can use alternative group rekeying schemes, which MUST comply with the functional steps defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. The Group Manager MUST indicate the use of such an alternative group rekeying scheme to joining nodes, by means of the 'group_rekeying' parameter included in Joining Response messages (see <a href="#ssec-join-resp" class="xref">Section 6.4</a>).<a href="#section-20-5" class="pilcrow">¶</a></p>
<p id="section-20-6">It is RECOMMENDED that the Group Manager gets confirmation of successful distribution from the group members, and admits a maximum number of individual retransmissions to non-confirming group members. Once completed the group rekeying process, the Group Manager creates a new empty set X' of stale Sender IDs associated to the version of the newly distributed group keying material. Then, the Group Manager MUST add the set X' to the collection of stale Sender IDs associated to the group (see <a href="#sssec-stale-sender-ids" class="xref">Section 2.2.1</a>).<a href="#section-20-6" class="pilcrow">¶</a></p>
<p id="section-20-7">In case the rekeying terminates and some group members have not received the new keying material, they will not be able to correctly process following secured messages exchanged in the group. These group members will eventually contact the Group Manager, in order to retrieve the current keying material and its version.<a href="#section-20-7" class="pilcrow">¶</a></p>
<p id="section-20-8">Some of these group members may be in multiple groups, each associated to a different Group Manager. When failing to correctly process messages secured with the new keying material, these group members may not have sufficient information to determine which exact Group Manager they should contact, in order to retrieve the current keying material they are missing.<a href="#section-20-8" class="pilcrow">¶</a></p>
<p id="section-20-9">If the Gid is formatted as described in Appendix C of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the Group Prefix can be used as a hint to determine the right Group Manager, as long as no collisions among Group Prefixes are experienced. Otherwise, a group member needs to contact the Group Manager of each group, e.g., by first requesting only the version of the current group keying material (see <a href="#sec-version" class="xref">Section 15</a>) and then possibly requesting the current keying material (see <a href="#ssec-updated-key-only" class="xref">Section 8.1</a>).<a href="#section-20-9" class="pilcrow">¶</a></p>
<p id="section-20-10">Furthermore, some of these group members can be in multiple groups, all of which associated to the same Group Manager. In this case, these group members may also not have sufficient information to determine which exact group they should refer to, when contacting the right Group Manager. Hence, they need to contact a Group Manager multiple times, i.e., separately for each group they belong to and associated to that Group Manager.<a href="#section-20-10" class="pilcrow">¶</a></p>
<p id="section-20-11">Finally, <a href="#missed-rekeying" class="xref">Section 20.3</a> discusses how a group member can realize that it has missed one or more rekeying instances, and the actions it is accordingly required to take.<a href="#section-20-11" class="pilcrow">¶</a></p>
<div id="sending-rekeying-msg">
<section id="section-20.1">
        <h3 id="name-sending-rekeying-messages">
<a href="#section-20.1" class="section-number selfRef">20.1. </a><a href="#name-sending-rekeying-messages" class="section-name selfRef">Sending Rekeying Messages</a>
        </h3>
<p id="section-20.1-1">The group rekeying messages MUST have Content-Format set to application/ace-groupcomm+cbor and have the same format used for the Joining Response message in <a href="#ssec-join-resp" class="xref">Section 6.4</a>, with the following differences. Note that this extends the minimal content of a rekeying message as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-6" class="relref">Section 6</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> (OPT14).<a href="#section-20.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-20.1-2.1">
            <p id="section-20.1-2.1.1">From the Joining Response, only the parameters 'gkty', 'key', 'num', 'exp', and 'ace-groupcomm-profile' are present. In particular, the 'key' parameter includes only the following data.<a href="#section-20.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-20.1-2.1.2.1">The 'ms' parameter, specifying the new OSCORE Master Secret value. This parameter MUST be present.<a href="#section-20.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-20.1-2.1.2.2">The 'contextId' parameter, specifying the new Gid to use as OSCORE ID Context value. This parameter MUST be present.<a href="#section-20.1-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-20.1-2.1.2.3">The 'salt' value, specifying the new OSCORE Master Salt value. This parameter MAY be present.<a href="#section-20.1-2.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-20.1-2.2">
            <p id="section-20.1-2.2.1">The parameter 'stale_node_ids' MUST also be included, with CBOR label defined in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="xref">Section 25.3</a>. This parameter is encoded as a CBOR array, where each element is encoded as a CBOR byte string. The CBOR array has to be intended as a set, i.e., the order of its elements is irrelevant. The parameter is populated as follows.<a href="#section-20.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-20.1-2.2.2.1">The Group Manager creates an empty CBOR array ARRAY.<a href="#section-20.1-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-20.1-2.2.2.2">The Group Manager considers the collection of stale Sender IDs associated to the group (see <a href="#sssec-stale-sender-ids" class="xref">Section 2.2.1</a>), and takes the most recent set X, i.e., the set associated to the current version of the group keying material about to be relinquished.<a href="#section-20.1-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-20.1-2.2.2.3">For each Sender ID in X, the Group Manager encodes it as a CBOR byte string and adds the result to ARRAY.<a href="#section-20.1-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-20.1-2.2.2.4">The parameter 'stale_node_ids' takes ARRAY as value.<a href="#section-20.1-2.2.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-20.1-2.3">The parameters 'pub_keys', 'peer_roles' and 'peer_identifiers' SHOULD be present, if the group rekeying is performed due to one or multiple Clients that have requested join the group. Following the same semantics used in the Joining Response message (see <a href="#ssec-join-resp" class="xref">Section 6.4</a>), the three parameters specify the public key, roles in the group and node identifier of each of the Clients that have requested to join the group. The Group Manager MUST NOT include a non-empty subset of these three parameters.<a href="#section-20.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-20.1-3">The Group Manager separately sends a group rekeying message formatted as defined above to each group member to be rekeyed.<a href="#section-20.1-3" class="pilcrow">¶</a></p>
<p id="section-20.1-4">Each rekeying message MUST be secured with the pairwise secure communication channel between the Group Manager and the group member used during the joining process. In particular, each rekeying message can target the 'control_uri' URI path defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> (OPT7), if provided by the intended recipient upon joining the group (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>).<a href="#section-20.1-4" class="pilcrow">¶</a></p>
<p id="section-20.1-5">This distribution approach requires group members to act (also) as servers, in order to correctly handle unsolicited group rekeying messages from the Group Manager. In particular, if a group member and the Group Manager use OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> to secure their pairwise communications, the group member MUST create a Replay Window in its own Recipient Context upon establishing the OSCORE Security Context with the Group Manager, e.g., by means of the OSCORE profile of ACE <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>.<a href="#section-20.1-5" class="pilcrow">¶</a></p>
<p id="section-20.1-6">Group members and the Group Manager SHOULD additionally support alternative distribution approaches that do not require group members to act (also) as servers. A number of such approaches are defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-6" class="relref">Section 6</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>. In particular, a group member may use CoAP Observe <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span> and subscribe for updates to the group-membership resource of the group, at the endpoint /ace-group/GROUPNAME/ of the Group Manager (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-6.1" class="relref">Section 6.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>). Alternatively, a full-fledged Pub-Sub model can be considered <span>[<a href="#I-D.ietf-core-coap-pubsub" class="xref">I-D.ietf-core-coap-pubsub</a>]</span>, where the Group Manager publishes to a rekeying topic hosted at a Broker, while the group members subscribe to such topic (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-6.2" class="relref">Section 6.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>).<a href="#section-20.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="receiving-rekeying-msg">
<section id="section-20.2">
        <h3 id="name-receiving-rekeying-messages">
<a href="#section-20.2" class="section-number selfRef">20.2. </a><a href="#name-receiving-rekeying-messages" class="section-name selfRef">Receiving Rekeying Messages</a>
        </h3>
<p id="section-20.2-1">Once received the new group keying material, a group member proceeds as follows.<a href="#section-20.2-1" class="pilcrow">¶</a></p>
<p id="section-20.2-2">The group member considers the stale Sender IDs received from the Group Manager. If the group rekeying scheme defined in <a href="#sending-rekeying-msg" class="xref">Section 20.1</a> is used, the stale Sender IDs are specified by the 'stale_node_ids' parameter.<a href="#section-20.2-2" class="pilcrow">¶</a></p>
<p id="section-20.2-3">After that, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the group member MUST remove every public key associated to a stale Sender ID from its list of group members' public keys used in the group, and MUST delete each of its Recipient Contexts used in the group whose corresponding Recipient ID is a stale Sender ID.<a href="#section-20.2-3" class="pilcrow">¶</a></p>
<p id="section-20.2-4">Then, the following cases can occur, based on the version number V' of the new group keying material distributed through the rekeying process. If the group rekeying scheme defined in <a href="#sending-rekeying-msg" class="xref">Section 20.1</a> is used, this information is specified by the 'num' parameter.<a href="#section-20.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-20.2-5.1">The group member has not missed any group rekeying. That is, the old keying material owned by the group member has version number V, while the received new keying material has version number V' = (V + 1). In such a case, the group member simply installs the new keying material and derives the corresponding new Security Context.<a href="#section-20.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-20.2-5.2">The group member has missed one or more group rekeying instances. That is, the old keying material owned by the group member has version number V, while the received new keying material has version number V' &gt; (V + 1). In such a case, the group member MUST proceed as defined in <a href="#missed-rekeying" class="xref">Section 20.3</a>.<a href="#section-20.2-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-20.2-5.3">The group member has received keying material not newer than the stored one. That is, the stored keying material owned by the group member has version number V, while the received keying material has version number V' &lt; (V + 1). In such a case, the group member MUST ignore the received rekeying messages and MUST NOT install the received keying material.<a href="#section-20.2-5.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="missed-rekeying">
<section id="section-20.3">
        <h3 id="name-missed-rekeying-instances">
<a href="#section-20.3" class="section-number selfRef">20.3. </a><a href="#name-missed-rekeying-instances" class="section-name selfRef">Missed Rekeying Instances</a>
        </h3>
<p id="section-20.3-1">A group member can realize to have missed one or more rekeying instances in one of the ways discussed below. In the following, V denotes the version number of the old keying material stored by the group member, while V' denotes the version number of the latest, possibly just distributed, keying material.<a href="#section-20.3-1" class="pilcrow">¶</a></p>
<p id="section-20.3-2">a. The group member has participated to a rekeying process that has distributed new keying material with version number V' &gt; (V + 1), as discussed in <a href="#receiving-rekeying-msg" class="xref">Section 20.2</a>.<a href="#section-20.3-2" class="pilcrow">¶</a></p>
<p id="section-20.3-3">b. The group member has obtained the latest keying material from the Group Manager, as a response to a Key Distribution Request (see <a href="#ssec-updated-key-only" class="xref">Section 8.1</a>) or to a Joining Request when re-joining the group (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>). In particular, V is different than V' specified by the 'num' parameter in the response.<a href="#section-20.3-3" class="pilcrow">¶</a></p>
<p id="section-20.3-4">c. The group member has obtained the public keys of other group members, through a Public Key Request-Response exchange with the Group Manager (see <a href="#sec-pub-keys" class="xref">Section 10</a>). In particular, V is different than V' specified by the 'num' parameter in the response.<a href="#section-20.3-4" class="pilcrow">¶</a></p>
<p id="section-20.3-5">d. The group member has performed a Version Request-Response exchange with the Group Manager (see <a href="#sec-version" class="xref">Section 15</a>). In particular, V is different than V' specified by the 'num' parameter in the response.<a href="#section-20.3-5" class="pilcrow">¶</a></p>
<p id="section-20.3-6">In either case, the group member MUST delete the stored keying material with version number V.<a href="#section-20.3-6" class="pilcrow">¶</a></p>
<p id="section-20.3-7">If case (a) or case (b) applies, the group member MUST perform the following actions.<a href="#section-20.3-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-20.3-8">
<li id="section-20.3-8.1">The group member MUST NOT install the latest keying material yet, in case that was already obtained.<a href="#section-20.3-8.1" class="pilcrow">¶</a>
</li>
          <li id="section-20.3-8.2">
            <p id="section-20.3-8.2.1">The group member sends a Stale Sender IDs Request to the Group Manager (see <a href="#sec-retrieve-stale-sids" class="xref">Section 20.3.1</a>), specifying the version number V as payload of the request.<a href="#section-20.3-8.2.1" class="pilcrow">¶</a></p>
<p id="section-20.3-8.2.2">
If the Stale Sender IDs Response from the Group Manager has no payload, the group member MUST remove all the public keys from its list of group members' public keys used in the group, and MUST delete all its Recipient Contexts used in the group.<a href="#section-20.3-8.2.2" class="pilcrow">¶</a></p>
<p id="section-20.3-8.2.3">
Otherwise, the group member considers the stale Sender IDs specified in the Stale Sender IDs Response from the Group Manager. Then, the group member MUST remove every public key associated to a stale Sender ID from its list of group members' public keys used in the group, and MUST delete each of its Recipient Contexts used in the group whose corresponding Recipient ID is a stale Sender ID.<a href="#section-20.3-8.2.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-20.3-8.3">The group member installs the latest keying material with version number V' and derives the corresponding new Security Context.<a href="#section-20.3-8.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-20.3-9">If case (c) or case (d) applies, the group member SHOULD perform the following actions.<a href="#section-20.3-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-20.3-10">
<li id="section-20.3-10.1">
            <p id="section-20.3-10.1.1">The group member sends a Stale Sender IDs Request to the Group Manager (see <a href="#sec-retrieve-stale-sids" class="xref">Section 20.3.1</a>), specifying the version number V as payload of the request.<a href="#section-20.3-10.1.1" class="pilcrow">¶</a></p>
<p id="section-20.3-10.1.2">
If the Stale Sender IDs Response from the Group Manager has no payload, the group member MUST remove all the public keys from its list of group members' public keys used in the group, and MUST delete all its Recipient Contexts used in the group.<a href="#section-20.3-10.1.2" class="pilcrow">¶</a></p>
<p id="section-20.3-10.1.3">
Otherwise, the group member considers the stale Sender IDs specified in the Stale Sender IDs Response from the Group Manager. Then, the group member MUST remove every public key associated to a stale Sender ID from its list of group members' public keys used in the group, and MUST delete each of its Recipient Contexts used in the group whose corresponding Recipient ID is a stale Sender ID.<a href="#section-20.3-10.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-20.3-10.2">The group member obtains the latest keying material with version number V' from the Group Manager. This can happen by sending a Key Distribution Request to the Group Manager (see <a href="#ssec-updated-key-only" class="xref">Section 8.1</a>), or by re-joining the group (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>).<a href="#section-20.3-10.2" class="pilcrow">¶</a>
</li>
          <li id="section-20.3-10.3">The group member installs the latest keying material with version number V' and derives the corresponding new Security Context.<a href="#section-20.3-10.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-20.3-11">If case (c) or case (d) applies, the group member can alternatively perform the following actions.<a href="#section-20.3-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-20.3-12">
<li id="section-20.3-12.1">The group member re-joins the group (see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>). When doing so, the group member MUST re-join with the same roles it currently has in the group, and MUST request the Group Manager for the public keys of all the current group members. That is, the 'get_pub_keys' parameter of the Joining Request MUST be present and MUST be set to the CBOR simple value 'null' (0xf6).<a href="#section-20.3-12.1" class="pilcrow">¶</a>
</li>
          <li id="section-20.3-12.2">
            <p id="section-20.3-12.2.1">When receiving the Joining Response (see <a href="#ssec-join-resp-processing" class="xref">Section 6.5</a> and <a href="#ssec-join-resp-processing" class="xref">Section 6.5</a>), the group member retrieves the set Z of public keys specified in the 'pub_keys' parameter.<a href="#section-20.3-12.2.1" class="pilcrow">¶</a></p>
<p id="section-20.3-12.2.2">
Then, the group member MUST remove every public key which is not in Z from its list of group members' public keys used in the group, and MUST delete each of its Recipient Contexts used in the group that does not include any of the public keys in Z.<a href="#section-20.3-12.2.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-20.3-12.3">The group member installs the latest keying material with version number V' and derives the corresponding new Security Context.<a href="#section-20.3-12.3" class="pilcrow">¶</a>
</li>
        </ol>
<div id="sec-retrieve-stale-sids">
<section id="section-20.3.1">
          <h4 id="name-retrieval-of-stale-sender-i">
<a href="#section-20.3.1" class="section-number selfRef">20.3.1. </a><a href="#name-retrieval-of-stale-sender-i" class="section-name selfRef">Retrieval of Stale Sender IDs</a>
          </h4>
<p id="section-20.3.1-1">When realizing to have missed one or more group rekeying instances (see <a href="#missed-rekeying" class="xref">Section 20.3</a>), a node needs to retrieve from the Group Manager the data required to delete some of its stored group members' public keys and Recipient Contexts (see <a href="#stale-sids-fetch" class="xref">Section 5.3.1</a>). This data is provided as an aggregated set of stale Sender IDs, which are used as specified in <a href="#missed-rekeying" class="xref">Section 20.3</a>.<a href="#section-20.3.1-1" class="pilcrow">¶</a></p>
<p id="section-20.3.1-2">In particular, the node sends a CoAP FETCH request to the endpoint /ace-group/GROUPNAME/stale-sids at the Group Manager defined in <a href="#ssec-resource-stale-sids" class="xref">Section 5.3</a> of this document, where GROUPNAME is the name of the OSCORE group.<a href="#section-20.3.1-2" class="pilcrow">¶</a></p>
<p id="section-20.3.1-3">The payload of the Stale Sender IDs Request MUST include a CBOR unsigned integer. This encodes the version number V of the most recent group keying material owned and installed by the requesting client, which is older than the latest, possibly just distributed, keying material with version number V'.<a href="#section-20.3.1-3" class="pilcrow">¶</a></p>
<p id="section-20.3.1-4">The handler MUST reply with a 4.00 (Bad Request) error response, if the request is not formatted correctly. Also, the handler MUST respond with a 4.00 (Bad Request) error response, if the specified version number V is greater or equal than the version number V' associated to the latest keying material in the group, i.e., if V &gt;= V'.<a href="#section-20.3.1-4" class="pilcrow">¶</a></p>
<p id="section-20.3.1-5">Otherwise, the handler responds with a 2.05 (Content) Stale Sender IDs Response. The payload of the response is formatted as defined below, where SKEW = (V' - V + 1).<a href="#section-20.3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-20.3.1-6.1">The Group Manager considers ITEMS as the current number of sets stored in the collection of stale Sender IDs associated to the group (see <a href="#sssec-stale-sender-ids" class="xref">Section 2.2.1</a>).<a href="#section-20.3.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-20.3.1-6.2">If SKEW &gt; ITEMS, the Stale Sender IDs Response MUST NOT have a payload.<a href="#section-20.3.1-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-20.3.1-6.3">
              <p id="section-20.3.1-6.3.1">Otherwise, the payload of the Stale Sender IDs Response MUST include a CBOR array, where each element is encoded as a CBOR byte string. The CBOR array has to be intended as a set, i.e., the order of its elements is irrelevant. The Group Manager populates the CBOR array as follows.<a href="#section-20.3.1-6.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-20.3.1-6.3.2.1">The Group Manager creates an empty CBOR array ARRAY and an empty set X.<a href="#section-20.3.1-6.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-20.3.1-6.3.2.2">The Group Manager considers the SKEW most recent sets stored in the collection of stale Sender IDs associated to the group. Note that the most recent set is the one associate to the latest version of the group keying material.<a href="#section-20.3.1-6.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-20.3.1-6.3.2.3">The Group Manager copies all the Sender IDs from the selected sets into X. When doing so, the Group Manager MUST discard duplicates. That is, the same Sender ID MUST NOT be present more than once in the final content of X.<a href="#section-20.3.1-6.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-20.3.1-6.3.2.4">For each Sender ID in X, the Group Manager encodes it as a CBOR byte string and adds the result to ARRAY.<a href="#section-20.3.1-6.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-20.3.1-6.3.2.5">Finally, ARRAY is specified as payload of the Stale Sender IDs Response. Note that ARRAY might result in the empty CBOR array.<a href="#section-20.3.1-6.3.2.5" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-20.3.1-7"><a href="#fig-stale-ids-req-resp" class="xref">Figure 9</a> gives an overview of the exchange described above,  while <a href="#fig-stale-ids-req-resp-ex" class="xref">Figure 10</a> shows an example.<a href="#section-20.3.1-7" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-stale-sende"></span><div id="fig-stale-ids-req-resp">
<figure id="figure-9">
            <div class="alignCenter art-text artwork" id="section-20.3.1-8.1">
<pre>
                                                              Group
Node                                                         Manager
  |                                                             |
  |                   Stale Sender IDs Request                  |
  |------------------------------------------------------------&gt;|
  |             FETCH ace-group/GROUPNAME/stale-sids            |
  |                                                             |
  |&lt;---------- Stale Sender IDs Response: 2.05 (Content) -------|
  |                                                             |
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-message-flow-of-stale-sende" class="selfRef">Message Flow of Stale Sender IDs Request-Response</a>
            </figcaption></figure>
</div>
<span id="name-example-of-stale-sender-ids"></span><div id="fig-stale-ids-req-resp-ex">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-20.3.1-9.1">
<pre>
   Request:

   Header: FETCH (Code=0.05)
   Uri-Host: "kdc.example.com"
   Uri-Path: "ace-group"
   Uri-Path: "g1"
   Uri-Path: "stale-sids"
   Payload (in CBOR diagnostic notation):
     42

   Response:

   Header: Content (Code=2.05)
   Payload (in CBOR diagnostic notation):
     [h'01', h'fc', h'12ab', h'de44', h'ff']
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-example-of-stale-sender-ids" class="selfRef">Example of Stale Sender IDs Request-Response</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupcomm-params">
<section id="section-21">
      <h2 id="name-ace-groupcomm-parameters">
<a href="#section-21" class="section-number selfRef">21. </a><a href="#name-ace-groupcomm-parameters" class="section-name selfRef">ACE Groupcomm Parameters</a>
      </h2>
<p id="section-21-1">Clients are required to support the new parameters defined in this application profile as specified below (REQ29).<a href="#section-21-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-21-2.1">'group_senderId' MUST be supported by a Client that intends to join an OSCORE group with the role of Requester and/or Responder.<a href="#section-21-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-2.2">'ecdh_info' MUST be supported by a Client that intends to join a group which uses the pairwise mode of Group OSCORE.<a href="#section-21-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-2.3">'gm_dh_pub_keys' MUST be supported by a Client that intends to join a group which uses the pairwise mode of Group OSCORE and that does not plan to or cannot rely on an early retrieval of the Group Manager's Diffie-Hellman public key.<a href="#section-21-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-2.4">'group_enc_key' MUST be supported by a Client that intends to join a group which uses the group mode of Group OSCORE or to be signature verifier for that group.<a href="#section-21-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-2.5">'stale_node_ids' MUST be supported.<a href="#section-21-2.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-21-3">When the conditional parameters defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> are used with this application profile, Clients must, should or may support them as specified below (REQ30).<a href="#section-21-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-21-4.1">'client_cred', 'cnonce', 'client_cred_verify'. A Client that has a public key to use in a group MUST support these parameters.<a href="#section-21-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-4.2">'kdcchallenge'. A Client that has a public key to use in a group and that provides the Access Token to the Group Manager through a Token Transfer Request (see <a href="#ssec-token-post" class="xref">Section 6.1</a>) MUST support this parameter.<a href="#section-21-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-4.3">'pub_keys_repo'. This parameter is not relevant for this application profile, since the Group Manager always acts as repository of the group members' public keys.<a href="#section-21-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-4.4">'group_policies'. A Client that is interested in the specific policies used in a group, but that does not know them or cannot become aware of them before joining that group SHOULD support this parameter.<a href="#section-21-4.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-4.5">'peer_roles'. A Client MUST support this parameter, since in this application profile it is relevant for Clients to know the roles of the group member associated to each public key.<a href="#section-21-4.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-4.6">'kdc_nonce', 'kdc_cred' and 'kdc_cred_verify'. A Client MUST support these parameters, since the Group Manager's public key is required to process messages protected with Group OSCORE (see Section 4.3 of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-21-4.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-4.7">'mgt_key_material'. A Client that supports an advanced rekeying scheme possibly used in the group, such as based on one-to-many rekeying messages sent over IP multicast, MUST support this parameter.<a href="#section-21-4.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-21-4.8">'control_group_uri'. A Client that support the hosting of local resources each associated to a group (hence acting as CoAP server) and the reception of one-to-many requests sent to those resources by the Group Manager (e.g., over IP
multicast) MUST support this parameter.<a href="#section-21-4.8" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="error-types">
<section id="section-22">
      <h2 id="name-ace-groupcomm-error-identif">
<a href="#section-22" class="section-number selfRef">22. </a><a href="#name-ace-groupcomm-error-identif" class="section-name selfRef">ACE Groupcomm Error Identifiers</a>
      </h2>
<p id="section-22-1">In addition to what is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-9" class="relref">Section 9</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, this application profile defines new values that the Group Manager can include as error identifiers, in the 'error' field of an error response with Content-Format application/ace-groupcomm+cbor.<a href="#section-22-1" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-error-identifi"></span><div id="fig-ACE-Groupcomm-Error">
<figure id="figure-11">
        <div class="alignCenter art-text artwork" id="section-22-2.1">
<pre>
+-------+-------------------------------------------------+
| Value |                   Description                   |
+-------+-------------------------------------------------+
|   7   | Signatures not used in the group                |
+-------+-------------------------------------------------+
|   8   | Operation permitted only to signature verifiers |
+-------+-------------------------------------------------+
|   9   | Group currently not active                      |
+-------+-------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-ace-groupcomm-error-identifi" class="selfRef">ACE Groupcomm Error Identifiers</a>
        </figcaption></figure>
</div>
<p id="section-22-3">A Client supporting the 'error' parameter (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1.2" class="relref">4.1.2</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-8" class="relref">8</a> of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>) and able to understand the specified error may use that information to determine what actions to take next. If it is included in the error response and supported by the Client, the 'error_description' parameter may provide additional context. In particular, the following guidelines apply.<a href="#section-22-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-22-4.1">In case of error 7, the Client should stop sending the request in question to the Group Manager. In this application profile, this error is relevant only for a signature verifiers, in case it tries to access resources related to a pairwise-only group.<a href="#section-22-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-22-4.2">In case of error 8, the Client should stop sending the request in question to the Group Manager.<a href="#section-22-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-22-4.3">In case of error 9, the Client should wait for a certain (pre-configured) amount of time, before trying re-sending its request to the Group Manager.<a href="#section-22-4.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="default-values-for-group-configuration-parameters">
<section id="section-23">
      <h2 id="name-default-values-for-group-co">
<a href="#section-23" class="section-number selfRef">23. </a><a href="#name-default-values-for-group-co" class="section-name selfRef">Default Values for Group Configuration Parameters</a>
      </h2>
<p id="section-23-1">This section defines the default values that the Group Manager assumes for the configuration parameters of an OSCORE group, unless differently specified when creating and configuring the group. This can be achieved as specified in <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="xref">I-D.ietf-ace-oscore-gm-admin</a>]</span>.<a href="#section-23-1" class="pilcrow">¶</a></p>
<div id="common">
<section id="section-23.1">
        <h3 id="name-common">
<a href="#section-23.1" class="section-number selfRef">23.1. </a><a href="#name-common" class="section-name selfRef">Common</a>
        </h3>
<p id="section-23.1-1">This section always applies, as related to common configuration parameters.<a href="#section-23.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-23.1-2.1">For the HKDF Algorithm 'hkdf', the Group Manager SHOULD use the same default value defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>, i.e., HKDF SHA-256 (COSE algorithm encoding: -10).<a href="#section-23.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-23.1-2.2">
            <p id="section-23.1-2.2.1">For the format 'pub_key_enc' used to encode the public keys in the group, the Group Manager SHOULD use CBOR Web Token (CWT) or CWT Claims Set (CCS) <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>, i.e., the COSE Header Parameter 'kcwt' and 'kccs', respectively.<a href="#section-23.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-23.1-2.2.2">
[
    These COSE Header Parameters are under pending registration requested by draft-ietf-lake-edhoc.
 ]<a href="#section-23.1-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-23.1-2.3">For 'max_stale_sets', the Group Manager SHOULD consider N = 3 as the maximum number of stored sets of stale Sender IDs in the collection associated to the group (see <a href="#sssec-stale-sender-ids" class="xref">Section 2.2.1</a>).<a href="#section-23.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="group-mode">
<section id="section-23.2">
        <h3 id="name-group-mode">
<a href="#section-23.2" class="section-number selfRef">23.2. </a><a href="#name-group-mode" class="section-name selfRef">Group Mode</a>
        </h3>
<p id="section-23.2-1">This section applies if the group uses (also) the group mode of Group OSCORE.<a href="#section-23.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-23.2-2.1">For the Signature Encryption Algorithm 'sign_enc_alg' used to encrypted messages protected with the group mode, the Group Manager SHOULD use AES-CCM-16-64-128 (COSE algorithm encoding: 10) as default value.<a href="#section-23.2-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-23.2-3">The Group Manager SHOULD use the following default values for the Signature Algorithm 'sign_alg' and related parameters 'sign_params', consistently with the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>, the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span> and the "COSE Elliptic Curves" registry <span>[<a href="#COSE.Elliptic.Curves" class="xref">COSE.Elliptic.Curves</a>]</span>.<a href="#section-23.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-23.2-4.1">For the Signature Algorithm 'sign_alg' used to sign messages protected with the group mode, the signature algorithm EdDSA <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-23.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-23.2-4.2">
            <p id="section-23.2-4.2.1">For the parameters 'sign_params' of the Signature Algorithm:<a href="#section-23.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-23.2-4.2.2.1">The array [[OKP], [OKP, Ed25519]], in case EdDSA is assumed or specified for 'sign_alg'. In particular, this indicates to use the COSE key type OKP and the elliptic curve Ed25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-23.2-4.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-23.2-4.2.2.2">The array [[EC2], [EC2, P-256]], in case ES256 <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span> is specified for 'sign_alg'. In particular, this indicates to use the COSE key type EC2 and the elliptic curve P-256.<a href="#section-23.2-4.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-23.2-4.2.2.3">The array [[EC2], [EC2, P-384]], in case ES384 <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span> is specified for 'sign_alg'. In particular, this indicates to use the COSE key type EC2 and the elliptic curve P-384.<a href="#section-23.2-4.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-23.2-4.2.2.4">The array [[EC2], [EC2, P-521]], in case ES512 <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span> is specified for 'sign_alg'. In particular, this indicates to use the COSE key type EC2 and the elliptic curve P-521.<a href="#section-23.2-4.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-23.2-4.2.2.5">The array [[RSA], [RSA]], in case PS256, PS384 or PS512 <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> is specified for 'sign_alg'. In particular, this indicates to use the COSE key type RSA.<a href="#section-23.2-4.2.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="pairwise-mode">
<section id="section-23.3">
        <h3 id="name-pairwise-mode">
<a href="#section-23.3" class="section-number selfRef">23.3. </a><a href="#name-pairwise-mode" class="section-name selfRef">Pairwise Mode</a>
        </h3>
<p id="section-23.3-1">This section applies if the group uses (also) the pairwise mode of Group OSCORE.<a href="#section-23.3-1" class="pilcrow">¶</a></p>
<p id="section-23.3-2">For the AEAD Algorithm 'alg' used to encrypt messages protected with the pairwise mode, the Group Manager SHOULD use the same default value defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>, i.e., AES-CCM-16-64-128 (COSE algorithm encoding: 10).<a href="#section-23.3-2" class="pilcrow">¶</a></p>
<p id="section-23.3-3">For the Pairwise Key Agreement Algorithm 'ecdh_alg' and related parameters 'ecdh_params', the Group Manager SHOULD use the following default values, consistently with the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>, the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span> and the "COSE Elliptic Curves" registry <span>[<a href="#COSE.Elliptic.Curves" class="xref">COSE.Elliptic.Curves</a>]</span>.<a href="#section-23.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-23.3-4.1">For the Pairwise Key Agreement Algorithm 'ecdh_alg' used to compute static-static Diffie-Hellman shared secrets, the ECDH algorithm ECDH-SS + HKDF-256 specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12#section-6.3.1" class="relref">Section 6.3.1</a> of [<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>.<a href="#section-23.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-23.3-4.2">
            <p id="section-23.3-4.2.1">For the parameters 'ecdh_params' of the Pairwise Key Agreement Algorithm:<a href="#section-23.3-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-23.3-4.2.2.1">The array [[OKP], [OKP, X25519]], in case EdDSA is assumed or specified for 'sign_alg'. In particular, this indicates to use the COSE key type OKP and the elliptic curve X25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-23.3-4.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-23.3-4.2.2.2">The array [[EC2], [EC2, P-256]], in case ES256 <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span> is specified for 'sign_alg'. In particular, this indicates to use the COSE key type EC2 and the elliptic curve P-256.<a href="#section-23.3-4.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-23.3-4.2.2.3">The array [[EC2], [EC2, P-384]], in case ES384 <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span> is specified for 'sign_alg'. In particular, this indicates to use the COSE key type EC2 and the elliptic curve P-384.<a href="#section-23.3-4.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-23.3-4.2.2.4">The array [[EC2], [EC2, P-521]], in case ES512 <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span> is specified for 'sign_alg'. In particular, this indicates to use the COSE key type EC2 and the elliptic curve P-521.<a href="#section-23.3-4.2.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-security-considerations">
<section id="section-24">
      <h2 id="name-security-considerations">
<a href="#section-24" class="section-number selfRef">24. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-24-1">Security considerations for this profile are inherited from <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, the ACE framework for Authentication and Authorization <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, and the specific transport profile of ACE signalled by the AS, such as <span>[<a href="#I-D.ietf-ace-dtls-authorize" class="xref">I-D.ietf-ace-dtls-authorize</a>]</span> and <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>.<a href="#section-24-1" class="pilcrow">¶</a></p>
<p id="section-24-2">The following security considerations also apply for this profile.<a href="#section-24-2" class="pilcrow">¶</a></p>
<div id="ssec-security-considerations-management">
<section id="section-24.1">
        <h3 id="name-management-of-oscore-groups">
<a href="#section-24.1" class="section-number selfRef">24.1. </a><a href="#name-management-of-oscore-groups" class="section-name selfRef">Management of OSCORE Groups</a>
        </h3>
<p id="section-24.1-1">This profile leverages the following management aspects related to OSCORE groups and discussed in the sections of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> referred below.<a href="#section-24.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-24.1-2.1">Management of group keying material (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). The Group Manager is responsible for the renewal and re-distribution of the keying material in the groups of its competence (rekeying). According to the specific application requirements, this can include rekeying the group upon changes in its membership. In particular, renewing the group keying material is required upon a new node's joining or a current node's leaving, in case backward security and forward security have to be preserved, respectively.<a href="#section-24.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-24.1-2.2">Provisioning and retrieval of public keys (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). The Group Manager acts as key repository of public keys of group members, and provides them upon request.<a href="#section-24.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-24.1-2.3">Synchronization of sequence numbers (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#section-6.3" class="relref">Section 6.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). This concerns how a responder node that has just joined an OSCORE group can synchronize with the sequence number of requesters in the same group.<a href="#section-24.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-24.1-3">Before sending the Joining Response, the Group Manager MUST verify that the joining node actually owns the associated private key. To this end, the Group Manager can rely on the proof-of-possession challenge-response defined in <a href="#sec-joining-node-to-GM" class="xref">Section 6</a>. Alternatively, the joining node can use its own public key as asymmetric proof-of-possession key to establish a secure channel with the Group Manager, e.g., as in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-dtls-authorize-18#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#I-D.ietf-ace-dtls-authorize" class="xref">I-D.ietf-ace-dtls-authorize</a>]</span>. However, this requires such proof-of-possession key to be compatible with the encoding, as well as with the signature algorithm, and possible associated parameters used in the OSCORE group.<a href="#section-24.1-3" class="pilcrow">¶</a></p>
<p id="section-24.1-4">A node may have joined multiple OSCORE groups under different non-synchronized Group Managers. Therefore, it can happen that those OSCORE groups have the same Group Identifier (Gid). It follows that, upon receiving a Group OSCORE message addressed to one of those groups, the node would have multiple Security Contexts matching with the Gid in the incoming message. It is up to the application to decide how to handle such collisions of Group Identifiers, e.g., by trying to process the incoming message using one Security Context at the time until the right one is found.<a href="#section-24.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-security-considerations-challenges">
<section id="section-24.2">
        <h3 id="name-size-of-nonces-as-proof-of-">
<a href="#section-24.2" class="section-number selfRef">24.2. </a><a href="#name-size-of-nonces-as-proof-of-" class="section-name selfRef">Size of Nonces as Proof-of-Possesion Challenge</a>
        </h3>
<p id="section-24.2-1">With reference to the Joining Request message in <a href="#ssec-join-req-sending" class="xref">Section 6.2</a>, the proof-of-possession (PoP) evidence included in 'client_cred_verify' is computed over an input including also N_C | N_S, where | denotes concatenation.<a href="#section-24.2-1" class="pilcrow">¶</a></p>
<p id="section-24.2-2">For the N_C challenge, it is RECOMMENDED to use a 8-byte long random nonce. Furthermore, N_C is always conveyed in the 'cnonce' parameter of the Joining Request, which is always sent over the secure communication channel between the joining node and the Group Manager.<a href="#section-24.2-2" class="pilcrow">¶</a></p>
<p id="section-24.2-3">As defined in <a href="#sssec-challenge-value" class="xref">Section 6.2.1</a>, the way the N_S value is computed depends on the particular way the joining node provides the Group Manager with the Access Token, as well as on following interactions between the two.<a href="#section-24.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-24.2-4.1">If the Access Token has not been provided to the Group Manager by means of a Token Transfer Request to the /authz-info endpoint as in <a href="#ssec-token-post" class="xref">Section 6.1</a>, then N_S is computed as a 32-byte long challenge. For an example, see point (2) of <a href="#sssec-challenge-value" class="xref">Section 6.2.1</a>.<a href="#section-24.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-24.2-4.2">If the Access Token has been provided to the Group Manager by means of a Token Transfer Request to the /authz-info endpoint as in <a href="#ssec-token-post" class="xref">Section 6.1</a>, then N_S takes the most recent value provided to the client by the Group Manager in the 'kdcchallenge' parameter, as specified in point (1) of <a href="#sssec-challenge-value" class="xref">Section 6.2.1</a>. This is provided either in the Token Transfer Response (see <a href="#ssec-token-post" class="xref">Section 6.1</a>), or in a 4.00 (Bad Request) error response to a following Joining Request (see <a href="#ssec-join-req-processing" class="xref">Section 6.3</a>). In either case, it is RECOMMENDED to use a 8-byte long random challenge as value for N_S.<a href="#section-24.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-24.2-5">If we consider both N_C and N_S to take 8-byte long values, the following considerations hold.<a href="#section-24.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-24.2-6.1">Let us consider both N_C and N_S as taking random values, and the Group Manager to never change the value of the N_S provided to a Client during the lifetime of an Access Token. Then, as per the birthday paradox, the average collision for N_S will happen after 2^32 new transferred Access Tokens, while the average collision for N_C will happen after 2^32 new Joining Requests. This amounts to considerably more token provisionings than the expected new joinings of OSCORE groups under a same Group Manager, as well as to considerably more requests to join OSCORE groups from a same Client using a same Access Token under a same Group Manager.<a href="#section-24.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-24.2-6.2">
            <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-7" class="relref">Section 7</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span> as well <span><a href="https://rfc-editor.org/rfc/rfc8613#appendix-B.2" class="relref">Appendix B.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span> recommend the use of 8-byte random values as well. Unlike in those cases, the values of N_C and N_S considered in this document are not used for as sensitive operations as the derivation of a Security Context, and thus do not have possible implications in the security of AEAD ciphers.<a href="#section-24.2-6.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-security-considerations-reusage-nonces">
<section id="section-24.3">
        <h3 id="name-reusage-of-nonces-for-proof">
<a href="#section-24.3" class="section-number selfRef">24.3. </a><a href="#name-reusage-of-nonces-for-proof" class="section-name selfRef">Reusage of Nonces for Proof-of-Possession Input</a>
        </h3>
<p id="section-24.3-1">As long as the Group Manager preserves the same N_S value currently associated to an Access Token, i.e., the latest value provided to a Client in a 'kdcchallenge' parameter, the Client is able to successfully reuse the same proof-of-possession (PoP) input for multiple Joining Requests to that Group Manager.<a href="#section-24.3-1" class="pilcrow">¶</a></p>
<p id="section-24.3-2">In particular, the Client can reuse the same N_C value for every Joining Request to the Group Manager, and combine it with the same unchanged N_S value. This results in reusing the same PoP input for producing the PoP evidence to include in the 'client_cred_verify' parameter of the Joining Requests.<a href="#section-24.3-2" class="pilcrow">¶</a></p>
<p id="section-24.3-3">Unless the Group Manager maintains a list of N_C values already used by that Client since the latest update to the N_S value associated to the Access Token, the Group Manager can be forced to falsely believe that the Client possesses its own private key at that point in time, upon verifying the PoP evidence in the 'client_cred_verify' parameter.<a href="#section-24.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-iana">
<section id="section-25">
      <h2 id="name-iana-considerations">
<a href="#section-25" class="section-number selfRef">25. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-25-1">Note to RFC Editor: Please replace all occurrences of "[[This document]]" with the RFC number of this specification and delete this paragraph.<a href="#section-25-1" class="pilcrow">¶</a></p>
<p id="section-25-2">This document has the following actions for IANA.<a href="#section-25-2" class="pilcrow">¶</a></p>
<div id="iana-kinfo">
<section id="section-25.1">
        <h3 id="name-oauth-parameters">
<a href="#section-25.1" class="section-number selfRef">25.1. </a><a href="#name-oauth-parameters" class="section-name selfRef">OAuth Parameters</a>
        </h3>
<p id="section-25.1-1">IANA is asked to register the following entries to the "OAuth Parameters" registry, as per the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-11.2" class="relref">Section 11.2</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-25.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.1-2.1">Parameter name: ecdh_info<a href="#section-25.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.1-2.2">Parameter usage location: client-rs request, rs-client response<a href="#section-25.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.1-2.3">Change Controller: IESG<a href="#section-25.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.1-2.4">Specification Document(s): [[This specification]]<a href="#section-25.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.1-3"></p>
<ul class="normal">
<li class="normal" id="section-25.1-4.1">Parameter name: gm_dh_pub_keys<a href="#section-25.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.1-4.2">Parameter usage location: client-rs request, rs-client response<a href="#section-25.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.1-4.3">Change Controller: IESG<a href="#section-25.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.1-4.4">Specification Document(s): [[This specification]]<a href="#section-25.1-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-kinfo-map">
<section id="section-25.2">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-25.2" class="section-number selfRef">25.2. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings</a>
        </h3>
<p id="section-25.2-1">IANA is asked to register the following entries to the "OAuth Parameters CBOR Mappings" registry, as per the procedure specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-8.10" class="relref">Section 8.10</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-25.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.2-2.1">Name: ecdh_info<a href="#section-25.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.2-2.2">CBOR Key: TBD (range -256 to 255)<a href="#section-25.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.2-2.3">Value Type: Simple value null / array<a href="#section-25.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.2-2.4">Reference: [[This specification]]<a href="#section-25.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.2-3"></p>
<ul class="normal">
<li class="normal" id="section-25.2-4.1">Name: gm_dh_pub_keys<a href="#section-25.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.2-4.2">CBOR Key: TBD (range -256 to 255)<a href="#section-25.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.2-4.3">Value Type: Simple value null / array<a href="#section-25.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.2-4.4">Reference: [[This specification]]<a href="#section-25.2-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-ace-groupcomm-parameters-registry">
<section id="section-25.3">
        <h3 id="name-ace-groupcomm-parameters-2">
<a href="#section-25.3" class="section-number selfRef">25.3. </a><a href="#name-ace-groupcomm-parameters-2" class="section-name selfRef">ACE Groupcomm Parameters</a>
        </h3>
<p id="section-25.3-1">IANA is asked to register the following entry to the "ACE Groupcomm Parameters" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.7" class="relref">Section 11.7</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-25.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.3-2.1">Name: group_senderId<a href="#section-25.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-2.2">CBOR Key: TBD<a href="#section-25.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-2.3">CBOR Type: Byte string<a href="#section-25.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-2.4">Reference: [[This document]] (<a href="#sec-new-key" class="xref">Section 9</a>)<a href="#section-25.3-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.3-3"></p>
<ul class="normal">
<li class="normal" id="section-25.3-4.1">Name: ecdh_info<a href="#section-25.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-4.2">CBOR Key: TBD<a href="#section-25.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-4.3">CBOR Type: Array<a href="#section-25.3-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-4.4">Reference: [[This document]] (<a href="#ssec-join-req-processing" class="xref">Section 6.3</a>)<a href="#section-25.3-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.3-5"></p>
<ul class="normal">
<li class="normal" id="section-25.3-6.1">Name: gm_dh_pub_keys<a href="#section-25.3-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-6.2">CBOR Key: TBD<a href="#section-25.3-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-6.3">CBOR Type: Array<a href="#section-25.3-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-6.4">Reference: [[This document]] (<a href="#ssec-join-req-processing" class="xref">Section 6.3</a>)<a href="#section-25.3-6.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.3-7"></p>
<ul class="normal">
<li class="normal" id="section-25.3-8.1">Name: group_enc_key<a href="#section-25.3-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-8.2">CBOR Key: TBD<a href="#section-25.3-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-8.3">CBOR Type: Byte String<a href="#section-25.3-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-8.4">Reference: [[This document]] (<a href="#verif-data-get" class="xref">Section 5.2.1</a>)<a href="#section-25.3-8.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.3-9"></p>
<ul class="normal">
<li class="normal" id="section-25.3-10.1">Name: stale_node_ids<a href="#section-25.3-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-10.2">CBOR Key: TBD<a href="#section-25.3-10.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-10.3">CBOR Type: Array<a href="#section-25.3-10.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.3-10.4">Reference: [[This document]] (<a href="#sec-group-rekeying-process" class="xref">Section 20</a>)<a href="#section-25.3-10.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-groupcomm-keys-registry">
<section id="section-25.4">
        <h3 id="name-ace-groupcomm-key-types">
<a href="#section-25.4" class="section-number selfRef">25.4. </a><a href="#name-ace-groupcomm-key-types" class="section-name selfRef">ACE Groupcomm Key Types</a>
        </h3>
<p id="section-25.4-1">IANA is asked to register the following entry to the "ACE Groupcomm Key Types" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.8" class="relref">Section 11.8</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-25.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.4-2.1">Name: Group_OSCORE_Input_Material object<a href="#section-25.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.4-2.2">Key Type Value: GROUPCOMM_KEY_TBD<a href="#section-25.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.4-2.3">Profile: "coap_group_oscore_app", defined in <a href="#ssec-iana-groupcomm-profile-registry" class="xref">Section 25.5</a> of this document.<a href="#section-25.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.4-2.4">Description: A Group_OSCORE_Input_Material object encoded as described in <a href="#ssec-join-resp" class="xref">Section 6.4</a> of this document.<a href="#section-25.4-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.4-2.5">Reference: [[This document]] (<a href="#ssec-join-resp" class="xref">Section 6.4</a>)<a href="#section-25.4-2.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-groupcomm-profile-registry">
<section id="section-25.5">
        <h3 id="name-ace-groupcomm-profiles">
<a href="#section-25.5" class="section-number selfRef">25.5. </a><a href="#name-ace-groupcomm-profiles" class="section-name selfRef">ACE Groupcomm Profiles</a>
        </h3>
<p id="section-25.5-1">IANA is asked to register the following entry to the "ACE Groupcomm Profiles" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.9" class="relref">Section 11.9</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-25.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.5-2.1">Name: coap_group_oscore_app<a href="#section-25.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.5-2.2">Description: Application profile to provision keying material for participating in group communication protected with Group OSCORE as per <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-25.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.5-2.3">CBOR Value: PROFILE_TBD<a href="#section-25.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.5-2.4">Reference: [[This document]] (<a href="#ssec-join-resp" class="xref">Section 6.4</a>)<a href="#section-25.5-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-security-context-parameter-registry">
<section id="section-25.6">
        <h3 id="name-oscore-security-context-par">
<a href="#section-25.6" class="section-number selfRef">25.6. </a><a href="#name-oscore-security-context-par" class="section-name selfRef">OSCORE Security Context Parameters</a>
        </h3>
<p id="section-25.6-1">IANA is asked to register the following entries in the "OSCORE Security Context Parameters" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-9.4" class="relref">Section 9.4</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>.<a href="#section-25.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.6-2.1">Name: group_SenderId<a href="#section-25.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-2.2">CBOR Label: TBD<a href="#section-25.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-2.3">CBOR Type: bstr<a href="#section-25.6-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-2.4">Registry: -<a href="#section-25.6-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-2.5">Description: OSCORE Sender ID assigned to a member of an OSCORE group<a href="#section-25.6-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-2.6">Reference: [[This document]] (<a href="#ssec-join-resp" class="xref">Section 6.4</a>)<a href="#section-25.6-2.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.6-3"></p>
<ul class="normal">
<li class="normal" id="section-25.6-4.1">Name: pub_key_enc<a href="#section-25.6-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-4.2">CBOR Label: TBD<a href="#section-25.6-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-4.3">CBOR Type: integer<a href="#section-25.6-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-4.4">Registry: COSE Header Parameters<a href="#section-25.6-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-4.5">Description: Encoding of Public Keys to be used in the OSCORE group<a href="#section-25.6-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-4.6">Reference: [[This document]] (<a href="#ssec-join-resp" class="xref">Section 6.4</a>)<a href="#section-25.6-4.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.6-5"></p>
<ul class="normal">
<li class="normal" id="section-25.6-6.1">Name: sign_enc_alg<a href="#section-25.6-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-6.2">CBOR Label: TBD<a href="#section-25.6-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-6.3">CBOR Type: tstr / int<a href="#section-25.6-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-6.4">Registry: COSE Algorithms<a href="#section-25.6-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-6.5">Description: OSCORE Signature Encryption Algorithm Value<a href="#section-25.6-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-6.6">Reference: [[This document]] (<a href="#ssec-join-resp" class="xref">Section 6.4</a>)<a href="#section-25.6-6.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.6-7"></p>
<ul class="normal">
<li class="normal" id="section-25.6-8.1">Name: sign_alg<a href="#section-25.6-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-8.2">CBOR Label: TBD<a href="#section-25.6-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-8.3">CBOR Type: tstr / int<a href="#section-25.6-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-8.4">Registry: COSE Algorithms<a href="#section-25.6-8.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-8.5">Description: OSCORE Signature Algorithm Value<a href="#section-25.6-8.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-8.6">Reference: [[This document]] (<a href="#ssec-join-resp" class="xref">Section 6.4</a>)<a href="#section-25.6-8.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.6-9"></p>
<ul class="normal">
<li class="normal" id="section-25.6-10.1">Name: sign_params<a href="#section-25.6-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-10.2">CBOR Label: TBD<a href="#section-25.6-10.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-10.3">CBOR Type: array<a href="#section-25.6-10.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-10.4">Registry: COSE Algorithms, COSE Key Types, COSE Elliptic Curves<a href="#section-25.6-10.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-10.5">Description: OSCORE Signature Algorithm Parameters<a href="#section-25.6-10.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-10.6">Reference: [[This document]] (<a href="#ssec-join-resp" class="xref">Section 6.4</a>)<a href="#section-25.6-10.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.6-11"></p>
<ul class="normal">
<li class="normal" id="section-25.6-12.1">Name: ecdh_alg<a href="#section-25.6-12.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-12.2">CBOR Label: TBD<a href="#section-25.6-12.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-12.3">CBOR Type: tstr / int<a href="#section-25.6-12.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-12.4">Registry: COSE Algorithms<a href="#section-25.6-12.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-12.5">Description: OSCORE Pairwise Key Agreement Algorithm Value<a href="#section-25.6-12.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-12.6">Reference: [[This document]] (<a href="#ssec-join-resp" class="xref">Section 6.4</a>)<a href="#section-25.6-12.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.6-13"></p>
<ul class="normal">
<li class="normal" id="section-25.6-14.1">Name: ecdh_params<a href="#section-25.6-14.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-14.2">CBOR Label: TBD<a href="#section-25.6-14.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-14.3">CBOR Type: array<a href="#section-25.6-14.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-14.4">Registry: COSE Algorithms, COSE Key Types, COSE Elliptic Curves<a href="#section-25.6-14.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-14.5">Description: OSCORE Pairwise Key Agreement Algorithm Parameters<a href="#section-25.6-14.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.6-14.6">Reference: [[This document]] (<a href="#ssec-join-resp" class="xref">Section 6.4</a>)<a href="#section-25.6-14.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-tls-esporter-label-registry">
<section id="section-25.7">
        <h3 id="name-tls-exporter-labels">
<a href="#section-25.7" class="section-number selfRef">25.7. </a><a href="#name-tls-exporter-labels" class="section-name selfRef">TLS Exporter Labels</a>
        </h3>
<p id="section-25.7-1">IANA is asked to register the following entry to the "TLS Exporter Labels" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc5705#section-6" class="relref">Section 6</a> of [<a href="#RFC5705" class="xref">RFC5705</a>]</span> and updated in <span><a href="https://rfc-editor.org/rfc/rfc8447#section-12" class="relref">Section 12</a> of [<a href="#RFC8447" class="xref">RFC8447</a>]</span>.<a href="#section-25.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.7-2.1">Value: EXPORTER-ACE-Sign-Challenge-coap-group-oscore-app<a href="#section-25.7-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.7-2.2">DTLS-OK: Y<a href="#section-25.7-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.7-2.3">Recommended: N<a href="#section-25.7-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.7-2.4">Reference: [[This document]] (<a href="#sssec-challenge-value" class="xref">Section 6.2.1</a>)<a href="#section-25.7-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-AIF-registry">
<section id="section-25.8">
        <h3 id="name-aif">
<a href="#section-25.8" class="section-number selfRef">25.8. </a><a href="#name-aif" class="section-name selfRef">AIF</a>
        </h3>
<p id="section-25.8-1">IANA is asked to register the following entry to the "Toid" registry within the "AIF" registry group defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-aif-03#section-5.2" class="relref">Section 5.2</a> of [<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span>.<a href="#section-25.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.8-2.1">Name: oscore-group-name<a href="#section-25.8-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.8-2.2">Description/Specification: group name of the OSCORE group, as specified in [[This document]].<a href="#section-25.8-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.8-3">IANA is asked to register the following entry to the "Tperm" registry within the "AIF" registry group defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-aif-03#section-5.2" class="relref">Section 5.2</a> of [<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span>.<a href="#section-25.8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.8-4.1">Name: oscore-group-roles<a href="#section-25.8-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.8-4.2">Description/Specification: role(s) of the member of the OSCORE group, as specified in [[This document]].<a href="#section-25.8-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-media-types">
<section id="section-25.9">
        <h3 id="name-media-type-registrations">
<a href="#section-25.9" class="section-number selfRef">25.9. </a><a href="#name-media-type-registrations" class="section-name selfRef">Media Type Registrations</a>
        </h3>
<p id="section-25.9-1">This document registers the 'application/aif-groupcomm-oscore+cbor' media type for the AIF specific data model AIF-OSCORE-GROUPCOMM defined in <a href="#sec-format-scope" class="xref">Section 3</a> of [[This document]]. This registration follows the procedures specified in <span>[<a href="#RFC6838" class="xref">RFC6838</a>]</span>.<a href="#section-25.9-1" class="pilcrow">¶</a></p>
<p id="section-25.9-2">These media type has parameters for specifying the object identifier ("Toid") and set of permissions ("Tperm") defined for the AIF-generic model in <span>[<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span>; default values are the values "oscore-group-name" for "Toid" and "oscore-group-roles" for "Tperm".<a href="#section-25.9-2" class="pilcrow">¶</a></p>
<p id="section-25.9-3">Type name: application<a href="#section-25.9-3" class="pilcrow">¶</a></p>
<p id="section-25.9-4">Subtype name: aif-groupcomm-oscore+cbor<a href="#section-25.9-4" class="pilcrow">¶</a></p>
<p id="section-25.9-5">Required parameters: "Toid", "Tperm"<a href="#section-25.9-5" class="pilcrow">¶</a></p>
<p id="section-25.9-6">Optional parameters: N/A<a href="#section-25.9-6" class="pilcrow">¶</a></p>
<p id="section-25.9-7">Encoding considerations: Must be encoded as a CBOR array, each element of which is an array [Toid, Tperm] as defined in <a href="#sec-format-scope" class="xref">Section 3</a> of [[This document]].<a href="#section-25.9-7" class="pilcrow">¶</a></p>
<p id="section-25.9-8">Security considerations: See <a href="#sec-security-considerations" class="xref">Section 24</a> of [[This document]].<a href="#section-25.9-8" class="pilcrow">¶</a></p>
<p id="section-25.9-9">Interoperability considerations: N/A<a href="#section-25.9-9" class="pilcrow">¶</a></p>
<p id="section-25.9-10">Published specification: [[This document]]<a href="#section-25.9-10" class="pilcrow">¶</a></p>
<p id="section-25.9-11">Applications that use this media type: The type is used by applications that want to express authorization information about joining OSCORE groups, as specified in [[This document]].<a href="#section-25.9-11" class="pilcrow">¶</a></p>
<p id="section-25.9-12">Fragment identifier considerations: N/A<a href="#section-25.9-12" class="pilcrow">¶</a></p>
<p id="section-25.9-13">Additional information: N/A<a href="#section-25.9-13" class="pilcrow">¶</a></p>
<p id="section-25.9-14">Person &amp; email address to contact for further information: <a href="mailto:iesg@ietf.org">iesg@ietf.org</a><a href="#section-25.9-14" class="pilcrow">¶</a></p>
<p id="section-25.9-15">Intended usage: COMMON<a href="#section-25.9-15" class="pilcrow">¶</a></p>
<p id="section-25.9-16">Restrictions on usage: None<a href="#section-25.9-16" class="pilcrow">¶</a></p>
<p id="section-25.9-17">Author: Marco Tiloca <a href="mailto:marco.tiloca@ri.se">marco.tiloca@ri.se</a><a href="#section-25.9-17" class="pilcrow">¶</a></p>
<p id="section-25.9-18">Change controller: IESG<a href="#section-25.9-18" class="pilcrow">¶</a></p>
<p id="section-25.9-19">Provisional registration?  No<a href="#section-25.9-19" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-iana-coap-content-format-registry">
<section id="section-25.10">
        <h3 id="name-coap-content-format">
<a href="#section-25.10" class="section-number selfRef">25.10. </a><a href="#name-coap-content-format" class="section-name selfRef">CoAP Content-Format</a>
        </h3>
<p id="section-25.10-1">IANA is asked to register the following entry to the "CoAP Content-Formats" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group:<a href="#section-25.10-1" class="pilcrow">¶</a></p>
<p id="section-25.10-2">Media Type: application/aif-groupcomm-oscore+cbor;Toid="oscore-group-name",Tperm"oscore-group-roles"<a href="#section-25.10-2" class="pilcrow">¶</a></p>
<p id="section-25.10-3">Encoding: -<a href="#section-25.10-3" class="pilcrow">¶</a></p>
<p id="section-25.10-4">ID: TBD<a href="#section-25.10-4" class="pilcrow">¶</a></p>
<p id="section-25.10-5">Reference: [[This document]]<a href="#section-25.10-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-iana-group-oscore-roles-registry">
<section id="section-25.11">
        <h3 id="name-group-oscore-roles">
<a href="#section-25.11" class="section-number selfRef">25.11. </a><a href="#name-group-oscore-roles" class="section-name selfRef">Group OSCORE Roles</a>
        </h3>
<p id="section-25.11-1">This document establishes the IANA "Group OSCORE Roles" registry. The registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#ssec-iana-expert-review" class="xref">Section 25.15</a>.<a href="#section-25.11-1" class="pilcrow">¶</a></p>
<p id="section-25.11-2">This registry includes the possible roles that nodes can take in an OSCORE group, each in combination with a numeric identifier. These numeric identifiers are used to express authorization information about joining OSCORE groups, as specified in <a href="#sec-format-scope" class="xref">Section 3</a> of [[This document]].<a href="#section-25.11-2" class="pilcrow">¶</a></p>
<p id="section-25.11-3">The columns of this registry are:<a href="#section-25.11-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.11-4.1">Name: A value that can be used in documents for easier comprehension, to identify a possible role that nodes can take in an OSCORE group.<a href="#section-25.11-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.11-4.2">Value: The numeric identifier for this role. Integer values greater than 65535 are marked as "Private Use", all other values use the registration policy "Expert Review" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-25.11-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.11-4.3">Description: This field contains a brief description of the role.<a href="#section-25.11-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.11-4.4">Reference: This contains a pointer to the public specification for the role.<a href="#section-25.11-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.11-5">This registry will be initially populated by the values in <a href="#fig-role-values" class="xref">Figure 1</a>.<a href="#section-25.11-5" class="pilcrow">¶</a></p>
<p id="section-25.11-6">The Reference column for all of these entries will be [[This document]].<a href="#section-25.11-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-rt">
<section id="section-25.12">
        <h3 id="name-core-resource-type">
<a href="#section-25.12" class="section-number selfRef">25.12. </a><a href="#name-core-resource-type" class="section-name selfRef">CoRE Resource Type</a>
        </h3>
<p id="section-25.12-1">IANA is asked to register the following entry in the "Resource Type (rt=) Link Target Attribute Values" registry within the "Constrained Restful Environments (CoRE) Parameters" registry group.<a href="#section-25.12-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.12-2.1">Value: "core.osc.gm"<a href="#section-25.12-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.12-2.2">Description: Group-membership resource of an OSCORE Group Manager.<a href="#section-25.12-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.12-2.3">Reference: [[This document]]<a href="#section-25.12-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.12-3">Client applications can use this resource type to discover a group membership resource at an OSCORE Group Manager, where to send a request for joining the corresponding OSCORE group.<a href="#section-25.12-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-scope-semantics">
<section id="section-25.13">
        <h3 id="name-ace-scope-semantics">
<a href="#section-25.13" class="section-number selfRef">25.13. </a><a href="#name-ace-scope-semantics" class="section-name selfRef">ACE Scope Semantics</a>
        </h3>
<p id="section-25.13-1">IANA is asked to register the following entry in the "ACE Scope Semantics" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.12" class="relref">Section 11.12</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-25.13-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.13-2.1">Value: SEM_ID_TBD<a href="#section-25.13-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.13-2.2">Description: Access to OSCORE groups through the ACE Group Manager.<a href="#section-25.13-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.13-2.3">Reference: [[This document]]<a href="#section-25.13-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-ace-groupcomm-errors">
<section id="section-25.14">
        <h3 id="name-ace-groupcomm-errors">
<a href="#section-25.14" class="section-number selfRef">25.14. </a><a href="#name-ace-groupcomm-errors" class="section-name selfRef">ACE Groupcomm Errors</a>
        </h3>
<p id="section-25.14-1">IANA is asked to register the following entry in the "ACE Groupcomm Errors" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.13" class="relref">Section 11.13</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-25.14-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.14-2.1">Value: 7<a href="#section-25.14-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.14-2.2">Description: Signatures not used in the group.<a href="#section-25.14-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.14-2.3">Reference: [[This document]]<a href="#section-25.14-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.14-3"></p>
<ul class="normal">
<li class="normal" id="section-25.14-4.1">Value: 8<a href="#section-25.14-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.14-4.2">Description: Operation permitted only to signature verifiers.<a href="#section-25.14-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.14-4.3">Reference: [[This document]]<a href="#section-25.14-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-25.14-5"></p>
<ul class="normal">
<li class="normal" id="section-25.14-6.1">Value: 9<a href="#section-25.14-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.14-6.2">Description: Group currently not active.<a href="#section-25.14-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.14-6.3">Reference: [[This document]]<a href="#section-25.14-6.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-expert-review">
<section id="section-25.15">
        <h3 id="name-expert-review-instructions">
<a href="#section-25.15" class="section-number selfRef">25.15. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-25.15-1">The IANA registry established in this document is defined as "Expert Review".  This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a href="#section-25.15-1" class="pilcrow">¶</a></p>
<p id="section-25.15-2">Expert reviewers should take into consideration the following points:<a href="#section-25.15-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-25.15-3.1">
            <p id="section-25.15-3.1.1">Clarity and correctness of registrations. Experts are expected to check the clarity of purpose and use of the requested entries. Experts should inspect the entry for the considered role, to verify the correctness of its description against the role as intended in the specification that defined it. Expert should consider requesting an opinion on the correctness of registered parameters from the Authentication and Authorization for Constrained Environments (ACE) Working Group and the Constrained RESTful Environments (CoRE) Working Group.<a href="#section-25.15-3.1.1" class="pilcrow">¶</a></p>
<p id="section-25.15-3.1.2">
Entries that do not meet these objective of clarity and completeness should not be registered.<a href="#section-25.15-3.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-25.15-3.2">Duplicated registration and point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments.<a href="#section-25.15-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.15-3.3">Experts should take into account the expected usage of roles when approving point assignment. Given a 'Value' V as code point, the length of the encoding of (2^(V+1) - 1) should be weighed against the usage of the entry, considering the resources and capabilities of devices it will be used on. Additionally, given a 'Value' V as code point, the length of the encoding of (2^(V+1) - 1) should be weighed against how many code points resulting in that encoding length are left, and the resources and capabilities of devices it will be used on.<a href="#section-25.15-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-25.15-3.4">Specifications are recommended. When specifications are not provided, the description provided needs to have sufficient information to verify the points above.<a href="#section-25.15-3.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-26">
      <h2 id="name-references">
<a href="#section-26" class="section-number selfRef">26. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-26.1">
        <h3 id="name-normative-references">
<a href="#section-26.1" class="section-number selfRef">26.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Algorithms">[COSE.Algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms">https://www.iana.org/assignments/cose/cose.xhtml#algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Elliptic.Curves">[COSE.Elliptic.Curves]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Elliptic Curves"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#elliptic-curves">https://www.iana.org/assignments/cose/cose.xhtml#elliptic-curves</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Key.Types">[COSE.Key.Types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Key Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#key-type">https://www.iana.org/assignments/cose/cose.xhtml#key-type</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-aif">[I-D.ietf-ace-aif]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"An Authorization Information Format (AIF) for ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-aif-03</span>, <time datetime="2021-06-24" class="refDate">24 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-aif-03.txt">https://www.ietf.org/archive/id/draft-ietf-ace-aif-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-key-groupcomm">[I-D.ietf-ace-key-groupcomm]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Provisioning for Group Communication using ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-key-groupcomm-14</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-14.txt">https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-14.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-45</span>, <time datetime="2021-08-29" class="refDate">29 August 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-45.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-45.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oscore-profile">[I-D.ietf-ace-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"OSCORE Profile of the Authentication and Authorization for Constrained Environments Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-profile-19</span>, <time datetime="2021-05-06" class="refDate">6 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oscore-profile-19.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oscore-profile-19.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">J. Park</span>, <span class="refTitle">"Group OSCORE - Secure Group Communication for CoAP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-13</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-13.txt">https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-algs">[I-D.ietf-cose-rfc8152bis-algs]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-algs-12</span>, <time datetime="2020-09-24" class="refDate">24 September 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-struct">[I-D.ietf-cose-rfc8152bis-struct]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-struct-15</span>, <time datetime="2021-02-01" class="refDate">1 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-800-56A">[NIST-800-56A]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography - NIST Special Publication 800-56A, Revision 3"</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5705">https://www.rfc-editor.org/info/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
        <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6979">https://www.rfc-editor.org/info/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8447">[RFC8447]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="seriesInfo">RFC 8447</span>, <span class="seriesInfo">DOI 10.17487/RFC8447</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8447">https://www.rfc-editor.org/info/rfc8447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8742">https://www.rfc-editor.org/info/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-26.2">
        <h3 id="name-informative-references">
<a href="#section-26.2" class="section-number selfRef">26.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-dtls-authorize">[I-D.ietf-ace-dtls-authorize]</dt>
        <dd>
<span class="refAuthor">Gerdes, S.</span>, <span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-dtls-authorize-18</span>, <time datetime="2021-06-04" class="refDate">4 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-dtls-authorize-18.txt">https://www.ietf.org/archive/id/draft-ietf-ace-dtls-authorize-18.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oscore-gm-admin">[I-D.ietf-ace-oscore-gm-admin]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Höglund, R.</span>, <span class="refAuthor">Stok, P. V. D.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Admin Interface for the OSCORE Group Manager"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-gm-admin-04</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oscore-gm-admin-04.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oscore-gm-admin-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coap-pubsub">[I-D.ietf-core-coap-pubsub]</dt>
        <dd>
<span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Keranen, A.</span>, and <span class="refAuthor">J. Jimenez</span>, <span class="refTitle">"Publish-Subscribe Broker for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coap-pubsub-09</span>, <time datetime="2019-09-30" class="refDate">30 September 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-coap-pubsub-09.txt">https://www.ietf.org/archive/id/draft-ietf-core-coap-pubsub-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-05</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-05.txt">https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-02</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-02.txt">https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-oscore-discovery">[I-D.tiloca-core-oscore-discovery]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Amsuess, C.</span>, and <span class="refAuthor">P. V. D. Stok</span>, <span class="refTitle">"Discovery of OSCORE Groups with the CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-oscore-discovery-10</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-10.txt">https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6690">https://www.rfc-editor.org/info/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7641">https://www.rfc-editor.org/info/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7925">[RFC7925]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7925">https://www.rfc-editor.org/info/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="profile-req">
<section id="appendix-A">
      <h2 id="name-profile-requirements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-profile-requirements" class="section-name selfRef">Profile Requirements</a>
      </h2>
<p id="appendix-A-1">This section lists how this application profile of ACE addresses the requirements defined in Appendix A of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="mandatory-to-address-requirements">
<section id="appendix-A.1">
        <h3 id="name-mandatory-to-address-requir">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-mandatory-to-address-requir" class="section-name selfRef">Mandatory-to-Address Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.1-1.1">REQ1 - Specify the format and encoding of 'scope'. This includes defining the set of possible roles and their identifiers, as well as the corresponding encoding to use in the scope entries according to the used scope format: see <a href="#sec-format-scope" class="xref">Section 3</a> and <a href="#ssec-auth-req" class="xref">Section 4.1</a>.<a href="#appendix-A.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.2">REQ2 - If the AIF format of 'scope' is used, register its specific instance of "Toid" and "Tperm", as well as the corresponding Media Type and Content-Format, as per the guidelines in <span>[<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span>: see <a href="#ssec-iana-AIF-registry" class="xref">Section 25.8</a>, <a href="#ssec-iana-media-types" class="xref">Section 25.9</a> and <a href="#ssec-iana-coap-content-format-registry" class="xref">Section 25.10</a>.<a href="#appendix-A.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.3">REQ3 - if used, specify the acceptable values for 'sign_alg': values from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#appendix-A.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.4">REQ4 - If used, specify the acceptable values for 'sign_parameters': format and values from the COSE algorithm capabilities as specified in the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#appendix-A.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.5">REQ5 - If used, specify the acceptable values for 'sign_key_parameters': format and values from the COSE key type capabilities as specified in the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span>.<a href="#appendix-A.1-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.6">REQ6 - Specify the acceptable formats for encoding public keys and, if used, the acceptable values for 'pub_key_enc': acceptable formats explicitly provide the full set of information related to the public key algorithm (see <a href="#ssec-token-post" class="xref">Section 6.1</a> and <a href="#ssec-join-resp" class="xref">Section 6.4</a>). Consistent acceptable values for 'pub_key_enc' are taken from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="xref">COSE.Header.Parameters</a>]</span>.<a href="#appendix-A.1-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.7">REQ7 - If the value of the GROUPNAME URI path and the group name in the Access Token scope (gname in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>) are not required to coincide, specify the mechanism to map the GROUPNAME value in the URI to the group name: not applicable, since a perfect matching is required.<a href="#appendix-A.1-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.8">REQ8 - Define whether the KDC has a public key and if this has to be provided through the 'kdc_cred' parameter, see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1" class="relref">Section 4.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>: yes, as required by the Group OSCORE protocol <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, see <a href="#ssec-join-resp" class="xref">Section 6.4</a> of this document.<a href="#appendix-A.1-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.9">REQ9 - Specify if any part of the KDC interface as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1" class="relref">Section 4.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> is not supported by the KDC: not applicable.<a href="#appendix-A.1-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.10">REQ10 - Register a Resource Type for the root url-path, which is used to discover the correct url to access at the KDC (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.1" class="relref">Section 4.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>): the Resource Type (rt=) Link Target Attribute value "core.osc.gm" is registered in <a href="#iana-rt" class="xref">Section 25.12</a>.<a href="#appendix-A.1-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.11">REQ11 - Define what specific actions (e.g., CoAP methods) are allowed on each resource provided by the KDC interface, depending on whether the Client is a current group member; the roles that a Client is authorized to take as per the obtained access token; and the roles that the Client has as current group member: see <a href="#ssec-admitted-methods" class="xref">Section 5.4</a>.<a href="#appendix-A.1-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.12">REQ12 - Categorize possible newly defined operations for Clients into primary operations expected to be minimally supported and secondary operations, and provide accompanying considerations (see <a href="#client-operations" class="xref">Section 5.5</a>).<a href="#appendix-A.1-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.13">REQ13 - Specify the encoding of group identifier (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>): CBOR byte string (see <a href="#sec-retrieve-gnames" class="xref">Section 17</a>).<a href="#appendix-A.1-1.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.14">REQ14 - Specify the approaches used to compute and verify the PoP evidence to include in 'client_cred_verify', and which of those approaches is used in which case: see <a href="#ssec-join-req-sending" class="xref">Section 6.2</a> and <a href="#ssec-join-req-processing" class="xref">Section 6.3</a>.<a href="#appendix-A.1-1.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.15">REQ15 - Specify how the nonce N_S is generated, if the token is not provided to the KDC through the Token Transfer Request to the authz-info endpoint (e.g., if it is used directly to validate TLS instead): see <a href="#sssec-challenge-value" class="xref">Section 6.2.1</a>.<a href="#appendix-A.1-1.15" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.16">REQ16 - Define the initial value of the 'num' parameter: The initial value MUST be set to 0 when creating the OSCORE group, e.g., as in <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="xref">I-D.ietf-ace-oscore-gm-admin</a>]</span>.<a href="#appendix-A.1-1.16" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.17">REQ17 - Specify the format of the 'key' parameter: see <a href="#ssec-join-resp" class="xref">Section 6.4</a>.<a href="#appendix-A.1-1.17" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.18">REQ18 - Specify acceptable values of the 'gkty' parameter: Group_OSCORE_Input_Material object (see <a href="#ssec-join-resp" class="xref">Section 6.4</a>).<a href="#appendix-A.1-1.18" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.19">REQ19 - Specify and register the application profile identifier: coap_group_oscore_app (see <a href="#ssec-iana-groupcomm-profile-registry" class="xref">Section 25.5</a>).<a href="#appendix-A.1-1.19" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.20">REQ20 - If used, specify the format and content of 'group_policies' and its entries: see <a href="#ssec-join-resp" class="xref">Section 6.4</a>.<a href="#appendix-A.1-1.20" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.21">REQ21 - Specify the approaches used to compute and verify the PoP evidence to include in 'kdc_cred_verify', and which of those approaches is used in which case: see <a href="#ssec-join-resp" class="xref">Section 6.4</a>, <a href="#ssec-join-resp-processing" class="xref">Section 6.5</a> and <a href="#sec-gm-pub-key" class="xref">Section 12</a>.<a href="#appendix-A.1-1.21" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.22">REQ22 - Specify the communication protocol that the members of the group must use: CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, possibly over IP multicast <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>.<a href="#appendix-A.1-1.22" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.23">REQ23 - Specify the security protocols that the group members must use to protect their communication: Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#appendix-A.1-1.23" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.24">REQ24 - Specify how the communication is secured between the Client and KDC: by means of any transport profile of ACE <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> between Client and Group Manager that complies with the requirements in Appendix C of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#appendix-A.1-1.24" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.25">REQ25 - Specify the format of the identifiers of group members: the Sender ID used in the OSCORE group (see <a href="#ssec-join-resp" class="xref">Section 6.4</a> and <a href="#sec-pub-keys" class="xref">Section 10</a>).<a href="#appendix-A.1-1.25" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.26">REQ26 - Specify policies at the KDC to handle member ids that are not included in 'get_pub_keys': see <a href="#sec-pub-keys" class="xref">Section 10</a>.<a href="#appendix-A.1-1.26" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.27">REQ27 - Specify the format of newly-generated individual keying material for group members, or of the information to derive it, and corresponding CBOR label: see <a href="#sec-new-key" class="xref">Section 9</a>.<a href="#appendix-A.1-1.27" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.28">REQ28 - Specify and register the identifier of newly defined semantics for binary scopes: see <a href="#iana-scope-semantics" class="xref">Section 25.13</a>.<a href="#appendix-A.1-1.28" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.29">REQ29 - Categorize newly defined parameters according to the same criteria of <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>: see <a href="#ace-groupcomm-params" class="xref">Section 21</a>.<a href="#appendix-A.1-1.29" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.30">REQ30 - Define whether Clients must, should or may support the conditional parameters defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, and under which circumstances: see <a href="#ace-groupcomm-params" class="xref">Section 21</a>.<a href="#appendix-A.1-1.30" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="optional-to-address-requirements">
<section id="appendix-A.2">
        <h3 id="name-optional-to-address-require">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-optional-to-address-require" class="section-name selfRef">Optional-to-Address Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.1">OPT1 (Optional) - If the textual format of 'scope' is used, specify CBOR values to use for abbreviating the role identifiers in the group: not applicable.<a href="#appendix-A.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.2">
            <p id="appendix-A.2-1.2.1">OPT2 (Optional) - Specify additional parameters used in the exchange of Token Transfer Request and Response:<a href="#appendix-A.2-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.2.2.1">'ecdh_info', to negotiate the ECDH algorithm, ECDH algorithm parameters, ECDH key parameters and exact encoding of public keys used in the group, in case the joining node supports the pairwise mode of Group OSCORE (see <a href="#ssec-token-post" class="xref">Section 6.1</a>).<a href="#appendix-A.2-1.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="appendix-A.2-1.2.2.2">'gm_dh_pub_keys', to ask for and retrieve the Group Manager's Diffie-Hellman public keys, in case the the joining node supports the pairwise mode of Group OSCORE and the Access Token authorizes to join parwise-only groups (see <a href="#ssec-token-post" class="xref">Section 6.1</a>).<a href="#appendix-A.2-1.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-A.2-1.3">OPT3 (Optional) - Specify the negotiation of parameter values for signature algorithm and signature keys, if 'sign_info' is not used: possible early discovery by using the approach based on the CoRE Resource Directory described in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="xref">I-D.tiloca-core-oscore-discovery</a>]</span>.<a href="#appendix-A.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.4">OPT4 (Optional) - Specify possible or required payload formats for specific error cases: send a 4.00 (Bad Request) error response to a Joining Request (see <a href="#ssec-join-req-processing" class="xref">Section 6.3</a>).<a href="#appendix-A.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.5">OPT5 (Optional) - Specify additional identifiers of error types, as values of the 'error' field in an error response from the KDC: see <a href="#iana-ace-groupcomm-errors" class="xref">Section 25.14</a>.<a href="#appendix-A.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.6">OPT6 (Optional) - Specify the encoding of 'pub_keys_repos' if the default is not used: no.<a href="#appendix-A.2-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.7">OPT7 (Optional) - Specify the functionalities implemented at the 'control_uri' resource hosted at the Client, including message exchange encoding and other details (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>): see <a href="#sec-leaving" class="xref">Section 19</a> for the eviction of a group member; see <a href="#sec-group-rekeying-process" class="xref">Section 20</a> for the group rekeying process.<a href="#appendix-A.2-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.8">OPT8 (Optional) - Specify the behavior of the handler in case of failure to retrieve a public key for the specific node: send a 4.00 (Bad Request) error response to a Joining Request (see <a href="#ssec-join-req-processing" class="xref">Section 6.3</a>).<a href="#appendix-A.2-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.9">OPT9 (Optional) - Define a default group rekeying scheme, to refer to in case the 'rekeying_scheme' parameter is not included in the Joining Response (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1.1" class="relref">Section 4.3.1.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>): the "Point-to-Point" rekeying scheme registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-11.14" class="relref">Section 11.14</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>, whose detailed use for this profile is defined in <a href="#sec-group-rekeying-process" class="xref">Section 20</a> of this document.<a href="#appendix-A.2-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.10">OPT10 (Optional) - Specify the functionalities implemented at the 'control_group_uri' resource hosted at the Client, including message exchange encoding and other details (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>): see <a href="#sec-leaving" class="xref">Section 19</a> for the eviction of multiple group members.<a href="#appendix-A.2-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.11">OPT11 (Optional) - Specify policies that instruct clients to retain unsuccessfully decrypted messages and for how long, so that they can be decrypted after getting updated keying material: no.<a href="#appendix-A.2-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.12">OPT12 (Optional) - Specify for the KDC to perform group rekeying (together or instead of renewing individual keying material) when receiving a Key Renewal Request: the Group Manager SHOULD NOT perform a group rekeying, unless already scheduled to occur shortly (see <a href="#sec-new-key" class="xref">Section 9</a>).<a href="#appendix-A.2-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.13">OPT13 (Optional) - Specify how the identifier of a group members's public key is included in requests sent to other group members: no.<a href="#appendix-A.2-1.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.14">OPT14 (Optional) - Specify additional information to include in rekeying messages for the "Point-to-Point" group rekeying scheme (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-6.1" class="relref">Section 6.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>): see <a href="#sending-rekeying-msg" class="xref">Section 20.1</a>.<a href="#appendix-A.2-1.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.15">OPT15 (Optional) - Specify if Clients must or should support any of the parameters defined as optional in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>: no.<a href="#appendix-A.2-1.15" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-future-cose-algs">
<section id="appendix-B">
      <h2 id="name-extensibility-for-future-co">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-extensibility-for-future-co" class="section-name selfRef">Extensibility for Future COSE Algorithms</a>
      </h2>
<p id="appendix-B-1">As defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12#section-8.1" class="relref">Section 8.1</a> of [<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>, future algorithms can be registered in the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span> as specifying none or multiple COSE capabilities.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">To enable the seamless use of such future registered algorithms, this section defines a general, agile format for:<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">Each 'ecdh_info_entry' of the 'ecdh_info' parameter in the Token Transfer Response, see <a href="#ssec-token-post" class="xref">Section 6.1</a> and <a href="#ecdh-info" class="xref">Section 6.1.1</a>;<a href="#appendix-B-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-3.2">The 'sign_params' and 'ecdh_params' parameters within the 'key' parameter, see <a href="#ssec-join-resp" class="xref">Section 6.4</a>, as part of the response payloads used in <a href="#ssec-join-resp" class="xref">Section 6.4</a>, <a href="#ssec-updated-key-only" class="xref">Section 8.1</a>, <a href="#ssec-updated-and-individual-key" class="xref">Section 8.2</a> and <a href="#sec-group-rekeying-process" class="xref">Section 20</a>.<a href="#appendix-B-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-4">Appendix B of <span>[<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span> describes the analogous general format for 'sign_info_entry' of the 'sign_info' parameter in the Token Transfer Response, see <a href="#ssec-token-post" class="xref">Section 6.1</a>.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<p id="appendix-B-5">If any of the currently registered COSE algorithms is considered, using this general format yields the same structure defined in this document for the items above, thus ensuring retro-compatibility.<a href="#appendix-B-5" class="pilcrow">¶</a></p>
<div id="sec-future-cose-algs-ecdh-info-entry">
<section id="appendix-B.1">
        <h3 id="name-format-of-ecdh_info_entry">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-format-of-ecdh_info_entry" class="section-name selfRef">Format of 'ecdh_info_entry'</a>
        </h3>
<p id="appendix-B.1-1">The format of each 'ecdh_info_entry' (see <a href="#ssec-token-post" class="xref">Section 6.1</a> and <a href="#ecdh-info" class="xref">Section 6.1.1</a>) is generalized as follows. Given N the number of elements of the 'ecdh_parameters' array, i.e., the number of COSE capabilities of the ECDH algorithm, then:<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-2.1">'ecdh_key_parameters' is replaced by N elements 'ecdh_capab_i', each of which is a CBOR array.<a href="#appendix-B.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-2.2">The i-th array following 'ecdh_parameters', i.e., 'ecdh_capab_i' (i = 0, ..., N-1), is the array of COSE capabilities for the algorithm capability specified in 'ecdh_parameters'[i].<a href="#appendix-B.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-ecdh_info_entry-with-genera"></span><div id="fig-ecdh-info-entry-general">
<figure id="figure-12">
          <div id="appendix-B.1-3.1">
<pre class="lang-CDDL sourcecode">
ecdh_info_entry =
[
  id : gname / [ + gname ],
  ecdh_alg : int / tstr,
  ecdh_parameters : [ alg_capab_1 : any,
                      alg_capab_2 : any,
                      ...,
                      alg_capab_N : any],
  ecdh_capab_1 : [ any ],
  ecdh_capab_2 : [ any ],
  ...,
  ecdh_capab_N : [ any ],
  pub_key_enc = int / nil
]

gname = tstr
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-ecdh_info_entry-with-genera" class="selfRef">'ecdh_info_entry' with general format</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-future-cose-algs-key">
<section id="appendix-B.2">
        <h3 id="name-format-of-key">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-format-of-key" class="section-name selfRef">Format of 'key'</a>
        </h3>
<p id="appendix-B.2-1">The format of 'key' (see <a href="#ssec-join-resp" class="xref">Section 6.4</a>) is generalized as follows.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.1">
            <p id="appendix-B.2-2.1.1">The 'sign_params' array includes N+1 elements, whose exact structure and value depend on the value of the signature algorithm specified in 'sign_alg'.<a href="#appendix-B.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.1.2.1">The first element, i.e., 'sign_params'[0], is the array of the N COSE capabilities for the signature algorithm, as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span> (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12#section-8.1" class="relref">Section 8.1</a> of [<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>).<a href="#appendix-B.2-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="appendix-B.2-2.1.2.2">Each following element 'sign_params'[i], i.e., with index i &gt; 0, is the array of COSE capabilities for the algorithm capability specified in 'sign_params'[0][i-1].<a href="#appendix-B.2-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="appendix-B.2-2.1.3">
For example, if 'sign_params'[0][0] specifies the key type as capability of the algorithm, then 'sign_params'[1] is the array of COSE capabilities for the COSE key type associated to the signature algorithm, as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span> (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12#section-8.2" class="relref">Section 8.2</a> of [<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>).<a href="#appendix-B.2-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.2">
            <p id="appendix-B.2-2.2.1">The 'ecdh_params' array includes M+1 elements, whose exact structure and value depend on the value of the ECDH algorithm specified in 'ecdh_alg'.<a href="#appendix-B.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.2.2.1">The first element, i.e., 'ecdh_params'[0], is the array of the M COSE capabilities for the ECDH algorithm, as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span> (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12#section-8.1" class="relref">Section 8.1</a> of [<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>).<a href="#appendix-B.2-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="appendix-B.2-2.2.2.2">Each following element 'ecdh_params'[i], i.e., with index i &gt; 0, is the array of COSE capabilities for the algorithm capability specified in 'ecdh_params'[0][i-1].<a href="#appendix-B.2-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="appendix-B.2-2.2.3">
For example, if 'ecdh_params'[0][0] specifies the key type as capability of the algorithm, then 'ecdh_params'[1] is the array of COSE capabilities for the COSE key type associated to the ECDH algorithm, as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span> (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12#section-8.2" class="relref">Section 8.2</a> of [<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>).<a href="#appendix-B.2-2.2.3" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-C">
      <h2 id="name-document-updates">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-C-1">RFC EDITOR: PLEASE REMOVE THIS SECTION.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="sec-11-12">
<section id="appendix-C.1">
        <h3 id="name-version-11-to-12">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-version-11-to-12" class="section-name selfRef">Version -11 to -12</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1">Clarified semantics of 'ecdh_info' and 'gm_dh_pub_keys'.<a href="#appendix-C.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.2">Definition of /ace-group/GROUPNAME/kdc-pub-key moved to draft-ietf-ace-key-groupcomm.<a href="#appendix-C.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.3">ace-group/ accessible also to non-members that are not Verifiers.<a href="#appendix-C.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.4">Clarified what resources are accessible to Verifiers.<a href="#appendix-C.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.5">Revised error handling for the newly defined resources.<a href="#appendix-C.1-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.6">Revised use of CoAP error codes.<a href="#appendix-C.1-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.7">Use of "Token Tranfer Request" and "Token Transfer Response".<a href="#appendix-C.1-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.8">New parameter 'rekeying_scheme'.<a href="#appendix-C.1-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.9">Categorization of new parameters and inherited conditional parameters.<a href="#appendix-C.1-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.10">Clarifications on what to do in case of enhanced error responses.<a href="#appendix-C.1-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.11">Changed UCCS to CCS.<a href="#appendix-C.1-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.12">Public keys of just joined Clients can be in rekeying messages.<a href="#appendix-C.1-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.13">Revised names of new IANA registries.<a href="#appendix-C.1-1.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.14">Clarified meaning of registered CoRE resource type.<a href="#appendix-C.1-1.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.15">Alignment to new requirements from draft-ietf-ace-key-groupcomm.<a href="#appendix-C.1-1.15" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.16">Fixes and editorial improvements.<a href="#appendix-C.1-1.16" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-10-11">
<section id="appendix-C.2">
        <h3 id="name-version-10-to-11">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-version-10-to-11" class="section-name selfRef">Version -10 to -11</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1">Removed redundancy of key type capabilities, from 'sign_info', 'ecdh_info' and 'key'.<a href="#appendix-C.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.2">New resource to retrieve the Group Manager's public key.<a href="#appendix-C.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.3">New resource to retrieve material for Signature Verifiers.<a href="#appendix-C.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.4">New parameter 'sign_enc_alg' related to the group mode.<a href="#appendix-C.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.5">'pub_key_enc' takes value from the COSE Header Parameters registry.<a href="#appendix-C.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.6">Improved alignment of the Joining Response payload with the Group OSCORE Security Context parameters.<a href="#appendix-C.2-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.7">Recycling Group IDs by tracking "Birth GIDs".<a href="#appendix-C.2-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.8">Error handling in case of non available Sender IDs upon joining.<a href="#appendix-C.2-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.9">Error handling in case EdDSA public keys with invalid Y coordinate when the pairwise mode of Group OSCORE is supported.<a href="#appendix-C.2-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.10">Generalized proof-of-possession (PoP) for the joining node's private key; defined Diffie-Hellman based PoP for OSCORE groups using only the pairwise mode.<a href="#appendix-C.2-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.11">Proof-of-possession of the Group Manager's private key in the Joining Response.<a href="#appendix-C.2-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.12">Always use 'peer_identifiers' to convey Sender IDs as node identifiers.<a href="#appendix-C.2-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.13">Stale Sender IDs provided when rekeying the group.<a href="#appendix-C.2-1.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.14">New resource for late retrieval of stale Sender IDs.<a href="#appendix-C.2-1.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.15">Added examples of message exchanges.<a href="#appendix-C.2-1.15" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.16">Revised default values of group configuration parameters.<a href="#appendix-C.2-1.16" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.17">Fixes to IANA registrations.<a href="#appendix-C.2-1.17" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.18">General format of parameters related to COSE capabilities, supporting future registered COSE algorithms (new Appendix).<a href="#appendix-C.2-1.18" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-09-10">
<section id="appendix-C.3">
        <h3 id="name-version-09-to-10">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-version-09-to-10" class="section-name selfRef">Version -09 to -10</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">Updated non-recycling policy of Sender IDs.<a href="#appendix-C.3-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.2">Removed policies about Sender Sequence Number synchronization.<a href="#appendix-C.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.3">'control_path' renamed to 'control_uri'.<a href="#appendix-C.3-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.4">Format of 'get_pub_keys' aligned with draft-ietf-ace-key-groupcomm.<a href="#appendix-C.3-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.5">Additional way to inform of group eviction.<a href="#appendix-C.3-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.6">Registered semantics identifier for extended scope format.<a href="#appendix-C.3-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.7">Extended error handling, with error type specified in some error responses.<a href="#appendix-C.3-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.8">Renumbered requirements.<a href="#appendix-C.3-1.8" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-08-09">
<section id="appendix-C.4">
        <h3 id="name-version-08-to-09">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-version-08-to-09" class="section-name selfRef">Version -08 to -09</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.4-1.1">The url-path "ace-group" is used.<a href="#appendix-C.4-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.2">Added overview of admitted methods on the Group Manager resources.<a href="#appendix-C.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.3">Added exchange of parameters relevant for the pairwise mode of Group OSCORE.<a href="#appendix-C.4-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.4">The signed value for 'client_cred_verify' includes also the scope.<a href="#appendix-C.4-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.5">Renamed the key material object as Group_OSCORE_Input_Material object.<a href="#appendix-C.4-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.6">Replaced 'clientId' with 'group_SenderId'.<a href="#appendix-C.4-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.7">Added message exchange for Group Names request-response.<a href="#appendix-C.4-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.8">No reassignment of Sender ID and Gid in the same OSCORE group.<a href="#appendix-C.4-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.9">Updates on group rekeying contextual with request of new Sender ID.<a href="#appendix-C.4-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.10">Signature verifiers can also retrieve Group Names and URIs.<a href="#appendix-C.4-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.11">Removed group policy about supporting Group OSCORE in pairwise mode.<a href="#appendix-C.4-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.12">Registration of the resource type rt="core.osc.gm".<a href="#appendix-C.4-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.13">Update list of requirements.<a href="#appendix-C.4-1.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.14">Clarifications and editorial revision.<a href="#appendix-C.4-1.14" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-07-08">
<section id="appendix-C.5">
        <h3 id="name-version-07-to-08">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-version-07-to-08" class="section-name selfRef">Version -07 to -08</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.5-1.1">AIF specific data model to express scope entries.<a href="#appendix-C.5-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.2">A set of roles is checked as valid when processing the Joining Request.<a href="#appendix-C.5-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.3">Updated format of 'get_pub_keys' in the Joining Request.<a href="#appendix-C.5-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.4">Payload format and default values of group policies in the Joining Response.<a href="#appendix-C.5-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.5">Updated payload format of the FETCH request to retrieve public keys.<a href="#appendix-C.5-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.6">Default values for group configuration parameters.<a href="#appendix-C.5-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.7">IANA registrations to support the AIF specific data model.<a href="#appendix-C.5-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-06-07">
<section id="appendix-C.6">
        <h3 id="name-version-06-to-07">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-version-06-to-07" class="section-name selfRef">Version -06 to -07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.6-1.1">Alignments with draft-ietf-core-oscore-groupcomm.<a href="#appendix-C.6-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.2">New format of 'sign_info', using the COSE capabilities.<a href="#appendix-C.6-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.3">New format of Joining Response parameters, using the COSE capabilities.<a href="#appendix-C.6-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.4">Considerations on group rekeying.<a href="#appendix-C.6-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.5">Editorial revision.<a href="#appendix-C.6-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-05-06">
<section id="appendix-C.7">
        <h3 id="name-version-05-to-06">
<a href="#appendix-C.7" class="section-number selfRef">C.7. </a><a href="#name-version-05-to-06" class="section-name selfRef">Version -05 to -06</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.7-1.1">Added role of external signature verifier.<a href="#appendix-C.7-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.2">Parameter 'rsnonce' renamed to 'kdcchallenge'.<a href="#appendix-C.7-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.3">Parameter 'kdcchallenge' may be omitted in some cases.<a href="#appendix-C.7-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.4">Clarified difference between group name and OSCORE Gid.<a href="#appendix-C.7-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.5">Removed the role combination ["requester", "monitor"].<a href="#appendix-C.7-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.6">Admit implicit scope and audience in the Authorization Request.<a href="#appendix-C.7-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.7">New format for the 'sign_info' parameter.<a href="#appendix-C.7-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.8">Scope not mandatory to include in the Joining Request.<a href="#appendix-C.7-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.9">Group policy about supporting Group OSCORE in pairwise mode.<a href="#appendix-C.7-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.10">Possible individual rekeying of a single requesting node combined with a group rekeying.<a href="#appendix-C.7-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.11">Security considerations on reusage of signature challenges.<a href="#appendix-C.7-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.12">Addressing optional requirement OPT12 from draft-ietf-ace-key-groupcomm<a href="#appendix-C.7-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.13">Editorial improvements.<a href="#appendix-C.7-1.13" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-04-05">
<section id="appendix-C.8">
        <h3 id="name-version-04-to-05">
<a href="#appendix-C.8" class="section-number selfRef">C.8. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.8-1.1">Nonce N_S also in error responses to the Joining Requests.<a href="#appendix-C.8-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.2">Supporting single Access Token for multiple groups/topics.<a href="#appendix-C.8-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.3">Supporting legal requesters/responders using the 'peer_roles' parameter.<a href="#appendix-C.8-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.4">Registered and used dedicated label for TLS Exporter.<a href="#appendix-C.8-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.5">Added method for uploading a new public key to the Group Manager.<a href="#appendix-C.8-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.6">Added resource and method for retrieving the current group status.<a href="#appendix-C.8-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.7">Fixed inconsistency in retrieving group keying material only.<a href="#appendix-C.8-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.8">Clarified retrieval of keying material for monitor-only members.<a href="#appendix-C.8-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.9">Clarification on incrementing version number when rekeying the group.<a href="#appendix-C.8-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.10">Clarification on what is re-distributed with the group rekeying.<a href="#appendix-C.8-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.11">Security considerations on the size of the nonces used for the signature challenge.<a href="#appendix-C.8-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.8-1.12">Added CBOR values to abbreviate role identifiers in the group.<a href="#appendix-C.8-1.12" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-03-04">
<section id="appendix-C.9">
        <h3 id="name-version-03-to-04">
<a href="#appendix-C.9" class="section-number selfRef">C.9. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.9-1.1">New abstract.<a href="#appendix-C.9-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.9-1.2">Moved general content to draft-ietf-ace-key-groupcomm<a href="#appendix-C.9-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.9-1.3">Terminology: node name; node resource.<a href="#appendix-C.9-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.9-1.4">Creation and pointing at node resource.<a href="#appendix-C.9-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.9-1.5">Updated Group Manager API (REST methods and offered services).<a href="#appendix-C.9-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.9-1.6">Size of challenges 'cnonce' and 'rsnonce'.<a href="#appendix-C.9-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.9-1.7">Value of 'rsnonce' for reused or non-traditionally-posted tokens.<a href="#appendix-C.9-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.9-1.8">Removed reference to RFC 7390.<a href="#appendix-C.9-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.9-1.9">New requirements from draft-ietf-ace-key-groupcomm<a href="#appendix-C.9-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.9-1.10">Editorial improvements.<a href="#appendix-C.9-1.10" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-C.10">
        <h3 id="name-version-02-to-03">
<a href="#appendix-C.10" class="section-number selfRef">C.10. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.10-1.1">New sections, aligned with the interface of ace-key-groupcomm .<a href="#appendix-C.10-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.10-1.2">Exchange of information on the signature algorithm and related parameters, during the Token POST (Section 4.1).<a href="#appendix-C.10-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.10-1.3">Nonce 'rsnonce' from the Group Manager to the Client (Section 4.1).<a href="#appendix-C.10-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.10-1.4">Client PoP signature in the Key Distribution Request upon joining (Section 4.2).<a href="#appendix-C.10-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.10-1.5">Local actions on the Group Manager, upon a new node's joining (Section 4.2).<a href="#appendix-C.10-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.10-1.6">Local actions on the Group Manager, upon a node's leaving (Section 12).<a href="#appendix-C.10-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.10-1.7">IANA registration in ACE Groupcomm Parameters registry.<a href="#appendix-C.10-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.10-1.8">More fulfilled profile requirements (Appendix A).<a href="#appendix-C.10-1.8" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-C.11">
        <h3 id="name-version-01-to-02">
<a href="#appendix-C.11" class="section-number selfRef">C.11. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.11-1.1">Editorial fixes.<a href="#appendix-C.11-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.2">Changed: "listener" to "responder"; "pure listener" to "monitor".<a href="#appendix-C.11-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.3">Changed profile name to "coap_group_oscore_app", to reflect it is an application profile.<a href="#appendix-C.11-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.4">Added the 'type' parameter for all requests to a Join Resource.<a href="#appendix-C.11-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.5">Added parameters to indicate the encoding of public keys.<a href="#appendix-C.11-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.6">Challenge-response for proof-of-possession of signature keys (Section 4).<a href="#appendix-C.11-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.7">Renamed 'key_info' parameter to 'sign_info'; updated its format; extended to include also parameters of the signature key (Section 4.1).<a href="#appendix-C.11-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.8">Code 4.00 (Bad request), in responses to joining nodes providing an invalid public key (Section 4.3).<a href="#appendix-C.11-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.9">Clarifications on provisioning and checking of public keys (Sections 4 and 6).<a href="#appendix-C.11-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.10">Extended discussion on group rekeying and possible different approaches (Section 7).<a href="#appendix-C.11-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.11">Extended security considerations: proof-of-possession of signature keys; collision of OSCORE Group Identifiers (Section 8).<a href="#appendix-C.11-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.12">Registered three entries in the IANA registry "Sequence Number Synchronization Method" (Section 9).<a href="#appendix-C.11-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.11-1.13">Registered one public key encoding in the "ACE Public Key Encoding" IANA registry (Section 9).<a href="#appendix-C.11-1.13" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-C.12">
        <h3 id="name-version-00-to-01">
<a href="#appendix-C.12" class="section-number selfRef">C.12. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.12-1.1">Changed name of 'req_aud' to 'audience' in the Authorization Request (Section 3.1).<a href="#appendix-C.12-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.12-1.2">Added negotiation of signature algorithm/parameters between Client and Group Manager (Section 4).<a href="#appendix-C.12-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.12-1.3">Updated format of the Key Distribution Response as a whole (Section 4.3).<a href="#appendix-C.12-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.12-1.4">Added parameter 'cs_params' in the 'key' parameter of the Key Distribution Response (Section 4.3).<a href="#appendix-C.12-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.12-1.5">New IANA registrations in the "ACE Authorization Server Request Creation Hints" registry, "ACE Groupcomm Key" registry, "OSCORE Security Context Parameters" registry and "ACE Groupcomm Profile" registry (Section 9).<a href="#appendix-C.12-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">The authors sincerely thank Christian Amsuess, Santiago Aragon, Stefan Beck, Carsten Bormann, Martin Gunnarsson, Rikard Hoeglund, Watson Ladd, Daniel Migault, Jim Schaad, Ludwig Seitz, Goeran Selander and Peter van der Stok for their comments and feedback.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; by the H2020 project SIFIS-Home (Grant agreement 952652); and by the EIT-Digital High Impact Initiative ACTIVE.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">164 29 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jiye Park</span></div>
<div dir="auto" class="left"><span class="org">Universitaet Duisburg-Essen</span></div>
<div dir="auto" class="left"><span class="street-address">Schuetzenbahn 70</span></div>
<div dir="auto" class="left">
<span class="postal-code">45127</span> <span class="locality">Essen</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ji-ye.park@uni-due.de" class="email">ji-ye.park@uni-due.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
