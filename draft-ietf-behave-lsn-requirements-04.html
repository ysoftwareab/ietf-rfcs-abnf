<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Common requirements for Carrier Grade NAT (CGN)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Requirements for CGNs">
<link href="#rfc.section.4" rel="Chapter" title="4 Logging">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Destination Logging">
<link href="#rfc.section.5" rel="Chapter" title="5 Bulk Port Allocation">
<link href="#rfc.section.6" rel="Chapter" title="6 Deployment Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative Reference">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Change Log (to be removed by RFC Editor prior to      publication)">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Changed in -04">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Changed in -03">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 Changed in -02">
<link href="#rfc.appendix.Appendix%20A.4" rel="Chapter" title="Appendix A.4 Changed in -01">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document defines common requirements for Carrier-Grade NAT (CGN)." />
  <meta name="description" content="This document defines common requirements for Carrier-Grade NAT (CGN)." />
  <meta name="keywords" content="CGN, NAT" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">S. Perreault, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Viag&#233;nie</td>
</tr>
<tr>
<td class="left">Intended status: Best Current Practice</td>
<td class="right">I. Yamagata</td>
</tr>
<tr>
<td class="left">Expires: April 26, 2012</td>
<td class="right">S. Miyakawa</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">NTT Communications</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A. Nakagawa</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Japan Internet Exchange (JPIX)</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">H. Ashida</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">IS Consulting G.K.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 24, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Common requirements for Carrier Grade NAT (CGN)<br />
  <span class="filename">draft-ietf-behave-lsn-requirements-04</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines common requirements for Carrier-Grade NAT (CGN).</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 26, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Requirements for CGNs</a>
</li>
<li>4.   <a href="#rfc.section.4">Logging</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Destination Logging</a>
</li>
<li>5.   <a href="#rfc.section.5">Bulk Port Allocation</a>
</li>
<li>6.   <a href="#rfc.section.6">Deployment Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgements</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative Reference</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Change Log (to be removed by RFC Editor prior to      publication)</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Changed in -04</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Changed in -03</a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">Changed in -02</a>
</li>
<li>Appendix A.4.   <a href="#rfc.appendix.Appendix%20A.4">Changed in -01</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">With the shortage of IPv4 addresses, it is expected that more ISPs may want to provide a service where a public IPv4 address would be shared by many subscribers.  Each subscriber is assigned a private address, and a NAT situated in the ISP's network translates between private and public addresses. This is known as NAT444 <a href="#I-D.shirasaki-nat444-isp-shared-addr">[I-D.shirasaki-nat444-isp-shared-addr]</a> when the CPE includes a NAT function.</p>
<p id="rfc.section.1.p.2">This is not to be considered a solution to the shortage of IPv4 addresses. It is a service that can conceivably be offered alongside others, such as IPv6 services or regular, un-NATed IPv4 service. Some ISPs started offering such a service long before there was a shortage of IPv4 addresses, showing that there are driving forces other than the shortage of IPv4 addresses.</p>
<p id="rfc.section.1.p.3">This document describes behavioral requirements that are to be expected of those ISP-controlled NAT. Meeting this set of requirements will greatly increase the likelihood that subscribers' applications will function properly.</p>
<p id="rfc.section.1.p.4">Readers should be aware of potential issues that may arise when sharing a public address between many subscribers. See <a href="#RFC6269">[RFC6269]</a> for details.</p>
<p id="rfc.section.1.p.5">This document builds upon previous works describing requirements for generic NATs <a href="#RFC4787">[RFC4787]</a><a href="#RFC5382">[RFC5382]</a><a href="#RFC5508">[RFC5508]</a>. These documents, and their updates if any, still apply in this context. What follows are additional requirements, to be satisfied on top of previous ones.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.2.p.2">Readers are expected to be familiar with <a href="#RFC4787">[RFC4787]</a> and the terms defined there. The following additional term is used in this document: </p>

<dl>
<dt>Carrier-Grade NAT (CGN):</dt>
<dd style="margin-left: 8">A NAT-based <a href="#RFC2663">[RFC2663]</a> functional element operated by an administrative entity (e.g. operator) to share the same address among several subscribers. A CGN is managed by the administrative entity, not the subscribers.  <ul class="empty"><li>Note that the term "carrier-grade" has nothing to do with the quality of the NAT; that is left to discretion of implementers.  Rather, it is to be understood as a topological qualifier: the NAT is placed in an ISP's network and translates the traffic of potentially many subscribers. Subscribers have limited or no control over the CGN, whereas they typically have full control over a NAT placed on their premises.</li></ul>
<p> </p>
</dd>
</dl>

<p> </p>
<p><a href="#topology">Figure 1</a> summarizes a common network topology in which a CGN operates.</p>
<div id="#rfc.figure.1"></div>
<div id="#topology"></div>
<pre>
                .
                :
                |       Internet     
............... | ...................
                |       ISP network
                |
                |
            ++------++  External realm
........... |  CGN   |...............
            ++------++  Internal realm            
              |    |               
              |    |
              |    |    ISP network
............. | .. | ................
              |    |  Customer premises
      ++------++  ++------++
      |  CPE1  |  |  CPE2  |  etc.
      ++------++  ++------++
</pre>
<p id="rfc.section.2.p.4">Another possible topology is one for hotspots, where there is no customer premise or CPE, but where a CGN serves a bunch of customers who don't trust each other and hence fairness is an issue. One important difference with the previous topology is the absence of NAT444. This, however, has no impact on CGN requirements since they are driven by fairness and robustness in the service provided to customers, which applies in both cases.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Requirements for CGNs</h1>
<p id="rfc.section.3.p.1">What follows is a list of requirements for CGNs. They are in addition to those found in other documents such as <a href="#RFC4787">[RFC4787]</a>, <a href="#RFC5382">[RFC5382]</a>, and <a href="#RFC5508">[RFC5508]</a>.</p>
<p></p>

<dl>
<dt>REQ-14 :</dt>
<dd>A CGN MUST support at least the following transport protocols: TCP (MUST support <a href="#RFC5382">[RFC5382]</a>), UDP (MUST support <a href="#RFC4787">[RFC4787]</a>), and ICMP (MUST support <a href="#RFC5508">[RFC5508]</a>).  Support for additional transport protocols is OPTIONAL.</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">These protocols are the ones that NATs traditionally support. The IETF has documented the best current practices for them.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-15 :</dt>
<dd>A CGN MUST have a default "IP address pooling" behavior of "Paired".  The CGN administrator MAY change this behavior on an application protocol basis.  <ul><li>When multiple overlapping internal address ranges share the same external address pool (e.g. DS-Lite <a href="#RFC6333">[RFC6333]</a>), external addresses are paired with subscribers rather than internal addresses.</li></ul>
<p> </p>
</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">This stronger form of REQ-2 from <a href="#RFC4787">[RFC4787]</a> is justified by the stronger need for not breaking applications that depend on the external address remaining constant.</dd>
<dt></dt>
<dd style="margin-left: 8">Note that this requirement applies regardless of the transport protocol. In other words, a CGN must use the same external IP address mapping for all sessions associated with the same internal IP address, be they TCP, UDP, ICMP, something else, or a mix of different protocols.</dd>
<dt></dt>
<dd style="margin-left: 8">The justification for allowing other behaviors is to allow the administrator to save external addresses and ports for application protocols that are known to work fine with other behaviors in practice.  However, the default behavior MUST be "Paired".</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-16 :</dt>
<dd>The CGN function SHOULD NOT have any pre-requisite on the size neither the contiguity of the external address pool.  <ul><li>In particular, the CGN function SHOULD be able to be configured with contiguous and non-contiguous external IPv4 addresses.</li></ul>
<p> </p>
</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">Given the increasing rarity of IPv4 addresses, it is becoming harder for an operator to provide large contiguous address pools to CGNs. Additionally, operational flexibility may require non-contiguous addresss pools for ressons such as differentiated services, routing management, etc.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-17 :</dt>
<dd>A CGN SHOULD support limiting the number of external ports (or, equivalently, "identifiers" for ICMP) that are assigned per subscriber.  <ol style="list-style-type: lower-alpha">
<li>Limits SHOULD be configurable by the CGN administrator.</li>
<li>Limits MAY be configured and applied independently per transport protocol.</li>
<li>Additionally, it is RECOMMENDED that the CGN include administrator-adjustable thresholds to prevent a single subscriber from consuming excessive CPU resources from the CGN (e.g. rate limit the subscriber's creation of new mappings).</li>
</ol>
<p> </p>
</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">A CGN can be considered a network resource that is shared by competing subscribers. Limiting the number of external ports assigned to each subscriber mitigates the DoS attack that a subscriber could launch against other subscribers through the CGN in order to get a larger share of the resource. It ensures fairness among subscribers. Limiting the rate of allocation mitigates a similar attack where the CPU is the resource being targeted instead of port numbers.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-18 :</dt>
<dd>A CGN SHOULD support limiting the amount of state memory allocated per mapping and per subscriber. This may include limiting the number of TCP sessions, the number of filters, etc., depending on the NAT implementation.  <ol style="list-style-type: lower-alpha">
<li>Limits SHOULD be configurable by the CGN administrator.</li>
<li>Additionally, it SHOULD be possible to limit the rate at which memory-consuming state elements are allocated.</li>
</ol>
<p> </p>
</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">A NAT needs to keep track of TCP sessions associated to each mapping. This state consumes resources for which, in the case of a CGN, subscribers may compete. It is necessary to ensure that each subscriber has access to a fair share of the CGN's resources.  Limiting TCP sessions per subscriber and per time unit is an effective mitigation against inter-subscriber DoS attacks. Limiting the rate of allocation is intended to prevent against CPU resource exhaustion.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-19 :</dt>
<dd>It SHOULD be possible to administratively turn off translation for specific destination addresses and/or ports.</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">It is common for a CGN administrator to provide access for subscribers to servers installed in the ISP's network, in the external realm. When such a server is able to reach the internal realm via normal routing (which is entirely controlled by the ISP), translation is unneeded. In that case, the CGN may forward packets without modification, thus acting like a plain router.  This may represent an important efficiency gain.</dd>
<dt></dt>
<dd style="margin-left: 8">
<a href="#passthrough">Figure 2</a> illustrates this use-case.</dd>
</dl>

<p> </p>
<div id="#rfc.figure.2"></div>
<div id="#passthrough"></div>
<pre> 
X1:x1            X1':x1'            X2:x2    
+---+from X1:x1  +---+from X1:x1    +---+
|   |  to X2:x2  |   |  to X2:x2    | S |
| C |&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;| C |&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;| e |
| P |            | G |              | r |
| E |&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;| N |&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;| v |
|   |from X2:x2  |   |from X2:x2    | e |
|   |  to X1:x1  |   |  to X1:x1    | r |
+---+            +---+              +---+
</pre>
<p></p>

<dl>
<dt>REQ-20 :</dt>
<dd>It is RECOMMENDED that a CGN have an "Endpoint-Independent Filtering" behavior UNLESS it is known that "Address-Independent Filtering" does not cause the application-layer protocol to break.</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">This is a stronger form of REQ-8 from <a href="#RFC4787">[RFC4787]</a>. This is based on the observation that some games and peer-to-peer applications require EIF for the NAT traversal to work.  In the context of a CGN it is important to minimize application breakage.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-21 :</dt>
<dd>When a CGN loses state (due to a crash, reboot, failover to a cold standby, etc.), it MUST NOT reuse the same external address+port pairs for new dynamic mappings for at least 120 seconds, except for the following cases: <ol style="list-style-type: lower-alpha">
<li>If the CGN tracks TCP sessions (e.g. with a state machine, as in <a href="#RFC6146">[RFC6146]</a> section 3.5.2.2), TCP ports MAY be reused immediately.</li>
<li>If the allocated external ports used address-dependent or address-and-port-dependent filtering before state loss, they MAY be reused immediately.</li>
</ol>
<p> </p>
</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">This is necessary in order to prevent collisions between old and new mappings and sessions. It ensures that all established sessions are broken instead of redirected to a different peer.</dd>
<dt></dt>
<dd style="margin-left: 8">The exceptions are for cases where reusing a port immediately does not create a possibility that packets would be redirected to the wrong peer.</dd>
<dt></dt>
<dd style="margin-left: 8">The 120 seconds value corresponds to the Maximum Segment Lifetime (MSL) from <a href="#RFC0793">[RFC0793]</a>.</dd>
<dt></dt>
<dd style="margin-left: 8">One way that this requirement could be satisfied would be have two distinct address pools: one dormant and one active. When rebooting, the CGN would swap the dormant pool with the active pool. Another way would be simply to wait 120 seconds before resuming NAT activity.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-22 :</dt>
<dd>Once an external port is deallocated, it SHOULD NOT be reallocated to a new mapping until at least 120 seconds have passed. The length of time and the maximum number of ports in this state SHOULD be configurable by the CGN administrator. The following exceptions apply: <ol style="list-style-type: lower-alpha">
<li>If the CGN tracks TCP sessions (e.g. with a state machine, as in <a href="#RFC6146">[RFC6146]</a> section 3.5.2.2), TCP ports MAY be reused immediately.</li>
<li>If the allocated external ports used address-dependent or address-and-port-dependent filtering before state loss, they MAY be reused immediately.</li>
</ol>
<p> </p>
</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">This is to prevent users from receiving unwanted traffic. It also helps prevent against clock skew when mappings are logged.</dd>
<dt></dt>
<dd style="margin-left: 8">The exceptions are for cases where reusing a port immediately does not create a possibility that packets would be redirected to the wrong peer.</dd>
<dt></dt>
<dd style="margin-left: 8">The 120 seconds value corresponds to the Maximum Segment Lifetime (MSL) from <a href="#RFC0793">[RFC0793]</a>.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-23 :</dt>
<dd>A CGN SHOULD include a Port Control Protocol server <a href="#I-D.ietf-pcp-base">[I-D.ietf-pcp-base]</a>.</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">Allowing subscribers to manipulate the NAT state table with PCP greatly increases the likelihood that applications will function properly.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-24 :</dt>
<dd>A CGN SHOULD support <a href="#RFC4008">[RFC4008]</a>.</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">It is anticipated that CGNs will be primarily deployed in ISP networks where the need for management is critical.</dd>
<dt></dt>
<dd style="margin-left: 8">Note also that there are efforts within the IETF toward creating a MIB specifically for CGNs <a href="#I-D.jpdionne-behave-cgn-mib">[I-D.jpdionne-behave-cgn-mib]</a>.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-25 :</dt>
<dd>When packets pass from one side to the other, the DSCP values MUST be preserved. If the CGN also includes diffserv classifier and marker functionality it MAY change the DSCP values.</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">See <a href="#RFC2983">[RFC2983]</a>, in particular section 6.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-26 :</dt>
<dd>When a CGN is unable to create a mapping due to resource constraints or administrative restrictions (i.e. quotas)...  <ol style="list-style-type: lower-alpha">
<li>it MUST drop the original packet;</li>
<li>it SHOULD send an ICMP Destination Unreachable message with code 3 (Port Unreachable) to the session initiator;</li>
<li>it SHOULD send a notification (e.g.  SNMP trap) towards a management system (if configured to do so);</li>
<li>and it SHOULD NOT delete existing mappings in order to "make room" for the new one. (This only applies to normal CGN behavior, not to manual operator intervention.)</li>
</ol>
<p> </p>
</dd>
</dl>

<p> </p>

<dl>
<dt>Justification:</dt>
<dd style="margin-left: 8">This is a slightly different form of REQ-8 from <a href="#RFC5508">[RFC5508]</a>. Code 3 is preferred to code 13 because it is listed as a "soft error" in <a href="#RFC5461">[RFC5461]</a>, which is important because we don't want TCP stacks to abort the connection attempt in this case. Sending an ICMP error may be rate-limited for security reasons, which is why requirement B is a SHOULD, not a MUST.</dd>
<dt></dt>
<dd style="margin-left: 8">Applications generally handle connection establishment failure better than established connection failure. This is why dropping the packet initiating the new connection is to preferred to deleting existing mappings. See also the rationale in <a href="#RFC5508">[RFC5508]</a> section 6.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Logging</h1>
<p id="rfc.section.4.p.1">It may be necessary for CGN administrators to be able to identify a subscriber based on external IPv4 address, port, and timestamp in order to deal with abuse and lawful intercept requests. When multiple subscribers share a single external address, the source address and port that are visible at the destination host have been translated from the ones originated by the subscriber.</p>
<p id="rfc.section.4.p.2">In order to be able to do this, the CGN would need to log the following information for each mapping created: </p>

<ul>
<li>subscriber identifier (e.g. internal source address or tunnel endpoint identifier)</li>
<li>external source address</li>
<li>external source port</li>
<li>timestamp</li>
</ul>

<p> </p>
<p id="rfc.section.4.p.3">By "subscriber identifier" we mean information that uniquely identifies a subscriber. For example, in a traditional NAT scenario, the internal source address would be sufficient. In the case of DS-Lite, many subscribers share the same internal address and the subscriber identifier is the tunnel endpoint identifier (i.e. the B4's IPv6 address).</p>
<p id="rfc.section.4.p.4">A disadvantage of logging mappings is that CGNs under heavy usage may produce large amounts of logs, which may require large storage volume.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Destination Logging</h1>
<p id="rfc.section.4.1.p.1">Readers should be aware of logging recommendations for Internet-facing servers <a href="#RFC6302">[RFC6302]</a>.  With compliant servers, the destination address and port do not need to be logged by the CGN. This can help reduce the amount of logging. Furthermore, given that destination logging at the CGN creates privacy issues, CGNs SHOULD NOT log destinations.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Bulk Port Allocation</h1>
<p id="rfc.section.5.p.1">So far we have assumed that a CGN allocates one external port for every outgoing connection. In this section, the impacts of allocating multiple external ports at a time are discussed.</p>
<p id="rfc.section.5.p.2">There is a range of things a CGN can do: </p>

<dl>
<dt>Traditional:</dt>
<dd style="margin-left: 8">For every outgoing connection, allocate one external port.</dd>
<dt>Scattered port set:</dt>
<dd style="margin-left: 8">For an outgoing connection, create a set of several non-consecutive external ports. Subsequent outgoing connections will use ports from the set.  When the set is exhausted, a new connection causes a new set to be created.  A set is smaller or equal to the user's maximum port limit.</dd>
<dt>Consecutive port set:</dt>
<dd style="margin-left: 8">Same as the scattered port set, but the ports allocated to a set are consecutive.</dd>
</dl>

<p> </p>
<p id="rfc.section.5.p.3">Note that this list is not exhaustive. There is a continuum of behavior that a CGN may choose to implement. For example, a CGN could use scattered port sets of consecutive port sets.</p>
<p id="rfc.section.5.p.4">The impacts of bulk port allocation are as follows.  </p>

<dl>
<dt>Port Utilization:</dt>
<dd style="margin-left: 8">The mechanisms at the top of the list are very efficient in their port utilization.  In that sense, they have good scaling properties (nothing is wasted).  The mechanisms at the bottom of the list will waste ports.  The number of wasted ports is proportional to size of the "bin".</dd>
<dt>Logging:</dt>
<dd style="margin-left: 8">Traditional allocation creates a lot of log entries as compared to allocation by port sets create much fewer entries.  Scattered and consecutive port sets generate the same number of log entries. In the case of consecutive port sets, entries can be expressed very compactly by indicating a range (e.g.  "12000-12009"). Some scattered port set allocation schemes can also generate small log entries containing the parameters and algorithm used for the port set generation (see e.g. <a href="#I-D.boucadair-pppext-portrange-option">[I-D.boucadair-pppext-portrange-option]</a>).</dd>
<dt></dt>
<dd style="margin-left: 8">With large set sizes, the logging frequency for scattered and consecutive port sets can approach that of DHCP servers.</dd>
<dt></dt>
<dd style="margin-left: 8">Logging destination addresses and ports can only be done on a per-session basis. This means that destination logging for a CGN implementing bulk port allocation would create one log entry per session containing the destination address and port. Other information could still be logged in one entry per port set.</dd>
<dt>Security:</dt>
<dd style="margin-left: 8">Traditional and scattered port sets provide very good security in that ports numbers are not easily guessed.  Easily guessed port numbers put subscribers at risk of the attacks described in <a href="#RFC6056">[RFC6056]</a>.  Consecutive port sets provides poor security to subscribers, especially if the set size is small.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Deployment Considerations</h1>
<p id="rfc.section.6.p.1">Several issues are encountered when CGNs are used <a href="#RFC6269">[RFC6269]</a>. There is current work in the IETF toward alleviating some of these issues. For example, see <a href="#I-D.boucadair-intarea-nat-reveal-analysis">[I-D.boucadair-intarea-nat-reveal-analysis]</a>.</p>
<p id="rfc.section.6.p.2">The address sharing ratio is the ratio between the number of external addresses and the number of internal addresses that a CGN is configured to handle. See <a href="#RFC6269">[RFC6269]</a> section 26.2 for guidance on picking an appropriate ratio.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.7.p.1">There are no IANA considerations.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.8.p.1">If a malicious subscriber can spoof another subscriber's CPE, it may cause a DoS to that subscriber by creating mappings up to the allowed limit. Therefore, the CGN administrator SHOULD ensure that spoofing is impossible. This can be accomplished with ingress filtering, as described in <a href="#RFC2827">[RFC2827]</a>.</p>
<p id="rfc.section.8.p.2">Endpoint-Independent Filtering has security considerations which are discussed in <a href="#RFC4787">[RFC4787]</a>.</p>
<p id="rfc.section.8.p.3">NATs sometimes perform fragment reassembly. CGNs would do so at presumably high data rates. Therefore, the reader should be familiar with the potential security issues described in <a href="#RFC4963">[RFC4963]</a>.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Acknowledgements</h1>
<p id="rfc.section.9.p.1">Thanks for the input and review by Arifumi Matsumoto, Benson Schliesser, Dai Kuwabara, Dan Wing, Dave Thaler, Francis Dupont, Joe Touch, Lars Eggert, Kousuke Shishikura, Mohamed Boucadair, Nejc Skoberne, Reinaldo Penno, Senthil Sivakumar, Takanori Mizuguchi, Takeshi Tomochika, Tomohiro Fujisaki, Tomohiro Nishitani, Tomoya Yoshida, and Yasuhiro Shirasaki.  Dan Wing also contributed much of section 5.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4008">[RFC4008]</b></td>
<td class="top">
<a>Rohit, R.</a>, <a>Srisuresh, P.</a>, <a>Raghunarayan, R.</a>, <a>Pai, N.</a> and <a>C. Wang</a>, "<a href="http://tools.ietf.org/html/rfc4008">Definitions of Managed Objects for Network Address Translators (NAT)</a>", RFC 4008, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4787">[RFC4787]</b></td>
<td class="top">
<a>Audet, F.</a> and <a>C. Jennings</a>, "<a href="http://tools.ietf.org/html/rfc4787">Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</a>", BCP 127, RFC 4787, January 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5382">[RFC5382]</b></td>
<td class="top">
<a>Guha, S.</a>, <a>Biswas, K.</a>, <a>Ford, B.</a>, <a>Sivakumar, S.</a> and <a>P. Srisuresh</a>, "<a href="http://tools.ietf.org/html/rfc5382">NAT Behavioral Requirements for TCP</a>", BCP 142, RFC 5382, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5508">[RFC5508]</b></td>
<td class="top">
<a>Srisuresh, P.</a>, <a>Ford, B.</a>, <a>Sivakumar, S.</a> and <a>S. Guha</a>, "<a href="http://tools.ietf.org/html/rfc5508">NAT Behavioral Requirements for ICMP</a>", BCP 148, RFC 5508, April 2009.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-pcp-base">[I-D.ietf-pcp-base]</b></td>
<td class="top">
<a>Wing, D</a>, <a>Cheshire, S</a>, <a>Boucadair, M</a>, <a>Penno, R</a> and <a>P Selkirk</a>, "<a href="http://tools.ietf.org/html/draft-ietf-pcp-base-17">Port Control Protocol (PCP)</a>", Internet-Draft draft-ietf-pcp-base-17, October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative Reference</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC0793">[RFC0793]</b></td>
<td class="top">
<a title="University of Southern California (USC)/Information Sciences Institute">Postel, J.</a>, "<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>", STD 7, RFC 793, September 1981.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2663">[RFC2663]</b></td>
<td class="top">
<a href="mailto:srisuresh@lucent.com" title="Lucent Technologies">Srisuresh, P.</a> and <a href="mailto:holdrege@lucent.com" title="Lucent Technologiesv">M. Holdrege</a>, "<a href="http://tools.ietf.org/html/rfc2663">IP Network Address Translator (NAT) Terminology and Considerations</a>", RFC 2663, August 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2827">[RFC2827]</b></td>
<td class="top">
<a>Ferguson, P.</a> and <a>D. Senie</a>, "<a href="http://tools.ietf.org/html/rfc2827">Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing</a>", BCP 38, RFC 2827, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2983">[RFC2983]</b></td>
<td class="top">
<a>Black, D.</a>, "<a href="http://tools.ietf.org/html/rfc2983">Differentiated Services and Tunnels</a>", RFC 2983, October 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4963">[RFC4963]</b></td>
<td class="top">
<a>Heffner, J.</a>, <a>Mathis, M.</a> and <a>B. Chandler</a>, "<a href="http://tools.ietf.org/html/rfc4963">IPv4 Reassembly Errors at High Data Rates</a>", RFC 4963, July 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5461">[RFC5461]</b></td>
<td class="top">
<a>Gont, F.</a>, "<a href="http://tools.ietf.org/html/rfc5461">TCP's Reaction to Soft Errors</a>", RFC 5461, February 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6056">[RFC6056]</b></td>
<td class="top">
<a>Larsen, M.</a> and <a>F. Gont</a>, "<a href="http://tools.ietf.org/html/rfc6056">Recommendations for Transport-Protocol Port Randomization</a>", BCP 156, RFC 6056, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6146">[RFC6146]</b></td>
<td class="top">
<a>Bagnulo, M.</a>, <a>Matthews, P.</a> and <a>I. van Beijnum</a>, "<a href="http://tools.ietf.org/html/rfc6146">Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers</a>", RFC 6146, April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6269">[RFC6269]</b></td>
<td class="top">
<a>Ford, M.</a>, <a>Boucadair, M.</a>, <a>Durand, A.</a>, <a>Levis, P.</a> and <a>P. Roberts</a>, "<a href="http://tools.ietf.org/html/rfc6269">Issues with IP Address Sharing</a>", RFC 6269, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6302">[RFC6302]</b></td>
<td class="top">
<a>Durand, A.</a>, <a>Gashinsky, I.</a>, <a>Lee, D.</a> and <a>S. Sheppard</a>, "<a href="http://tools.ietf.org/html/rfc6302">Logging Recommendations for Internet-Facing Servers</a>", BCP 162, RFC 6302, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6333">[RFC6333]</b></td>
<td class="top">
<a>Durand, A.</a>, <a>Droms, R.</a>, <a>Woodyatt, J.</a> and <a>Y. Lee</a>, "<a href="http://tools.ietf.org/html/rfc6333">Dual-Stack Lite Broadband Deployments Following IPv4 Exhaustion</a>", RFC 6333, August 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.boucadair-intarea-nat-reveal-analysis">[I-D.boucadair-intarea-nat-reveal-analysis]</b></td>
<td class="top">
<a>Boucadair, M</a>, <a>Touch, J</a>, <a>Levis, P</a> and <a>R Penno</a>, "<a href="http://tools.ietf.org/html/draft-boucadair-intarea-nat-reveal-analysis-04">Analysis of Solution Candidates to Reveal a Host Identifier in Shared Address Deployments</a>", Internet-Draft draft-boucadair-intarea-nat-reveal-analysis-04, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.boucadair-pppext-portrange-option">[I-D.boucadair-pppext-portrange-option]</b></td>
<td class="top">
<a>Boucadair, M</a>, <a>Levis, P</a>, <a>Bajko, G</a>, <a>Savolainen, T</a> and <a>T Tsou</a>, "<a href="http://tools.ietf.org/html/draft-boucadair-pppext-portrange-option-09">Huawei Port Range Configuration Options for PPP IPCP</a>", Internet-Draft draft-boucadair-pppext-portrange-option-09, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.jpdionne-behave-cgn-mib">[I-D.jpdionne-behave-cgn-mib]</b></td>
<td class="top">
<a>Dionne, J</a> and <a>M Blanchet</a>, "<a href="http://tools.ietf.org/html/draft-jpdionne-behave-cgn-mib-00">CGN Management Information Base (MIB)</a>", Internet-Draft draft-jpdionne-behave-cgn-mib-00, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.shirasaki-nat444-isp-shared-addr">[I-D.shirasaki-nat444-isp-shared-addr]</b></td>
<td class="top">
<a>Yamaguchi, J</a>, <a>Shirasaki, Y</a>, <a>Miyakawa, S</a>, <a>Nakagawa, A</a> and <a>H Ashida</a>, "<a href="http://tools.ietf.org/html/draft-shirasaki-nat444-isp-shared-addr-06">NAT444 addressing models</a>", Internet-Draft draft-shirasaki-nat444-isp-shared-addr-06, July 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Change Log (to be removed by RFC Editor prior to      publication)</h1>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> Changed in -04</h1>
<p></p>

<ul>
<li>Fixed nits, spelling, updated references.</li>
<li>CGNs SHOULD NOT log destinations.</li>
<li>Allow address-dependent filtering when it does not cause the application protocol to break.</li>
<li>Refer to RFC4787 security considerations on EIF.</li>
<li>Clarify REQ-12 point D (it does not apply to operator intervention).</li>
<li>Changed "CGNs SHOULD limit ..." to "SHOULD support limiting" to make it clear that the operator is in control.</li>
<li>Added reference to RFC 4963.</li>
<li>Added requirement for non-contiguous external address pools.</li>
</ul>

<p> </p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Changed in -03</h1>
<p></p>

<ul>
<li>Added exceptions for which it is not necessary to wait 120 seconds before reusing a port.</li>
<li>Renamed "random port set" to "scattered port set", which is more accurate.</li>
<li>Log "subscriber identifier" instead of internal address+port to allow for overlapping internal address ranges (DS-Lite).</li>
<li>Adjusted logging text and added reference to I-D.boucadair-pppext-portrange-option.</li>
<li>Adjusted destination logging text for bulk port allocation schemes.</li>
<li>Removed requirement for I-D.ietf-intarea-ipv4-id-update.</li>
<li>Made PCP support a SHOULD-level requirement.</li>
<li>Lowered the level of requirement for not dropping existing mappings in order to "make room" to SHOULD level, and added rationale.</li>
</ul>

<p> </p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> Changed in -02</h1>
<p></p>

<ul>
<li>CGNs MUST support at least TCP, UDP, and ICMP.</li>
<li>Add requirement from I-D.ietf-intarea-ipv4-id-update.</li>
<li>Add informative reference to <a href="#RFC6269">[RFC6269]</a>.</li>
<li>Add requirement (SHOULD level) for a port forwarding protocol.</li>
<li>Allow any pooling behavior on a per-application protocol basis.</li>
<li>Adjust wording for external port allocation rate limiting.</li>
<li>Add requirement for RFC4008 support (SHOULD level).</li>
<li>Adjust wording for swapping address pools when rebooting.</li>
<li>Add DSCP requirement (stolen from draft-jennings-behave-nat6).</li>
<li>Add informative reference to draft-boucadair-intarea-nat-reveal-analysis.</li>
<li>Add requirement for hold-down pool.</li>
<li>Change definition of CGN.</li>
<li>Avoid usage of "device" loaded word throughout the document.</li>
<li>Add requirement about resource exhaustion.</li>
<li>Change title.</li>
<li>Describe additional CGN topology where there is no NAT444.</li>
<li>Better justification for "Paired" pool behavior.</li>
<li>Make it clear that rate limiting allocation is for preserving CPU resources</li>
<li>Generalize the requirement for limiting the number of TCP sessions per mapping so that it applies to all memory-consuming state elements.</li>
<li>Change CPE to subscriber where it applies throughout the text.</li>
<li>Better terminology for bulk port allocation mechanisms.</li>
<li>Explain how external address pairing works with DS-Lite.</li>
</ul>

<p> </p>
<h1 id="rfc.appendix.Appendix A.4">
<a href="#rfc.appendix.Appendix%20A.4">Appendix A.4.</a> Changed in -01</h1>
<p></p>

<ul>
<li>Terminology: LSN is now CGN.</li>
<li>Imported all requirements from RFCs 4787, 5382, and 5508. This allowed us to eliminate some duplication.</li>
<li>Added references to draft-ietf-intarea-server-logging-recommendations and draft-ford-shared-addressing-issues.</li>
<li>Incorporated a requirement from draft-xu-behave-stateful-nat-standby-06.</li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Simon Perreault</span> editor
	  <span class="n hidden">
		<span class="family-name">Perreault</span>
	  </span>
	</span>
	<span class="org vcardline">Viagénie</span>
	<span class="adr">
	  <span>2875 boul. Laurier, suite D2-630</span>

	  <span class="vcardline">
		<span class="locality">Québec</span>,  
		<span class="region">QC</span> 
		<span class="code">G1V 2M2</span>
	  </span>
	  <span class="country-name vcardline">Canada</span>
	</span>
	<span class="vcardline">Phone: +1 418 656 9254</span>

<span class="vcardline">EMail: <a href="mailto:simon.perreault@viagenie.ca">simon.perreault@viagenie.ca</a></span>

<span class="vcardline">URI: <a href="http://www.viagenie.ca">http://www.viagenie.ca</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ikuhei Yamagata</span> 
	  <span class="n hidden">
		<span class="family-name">Yamagata</span>
	  </span>
	</span>
	<span class="org vcardline">NTT Communications Corporation</span>
	<span class="adr">
	  <span>Gran Park Tower 17F, 3-4-1 Shibaura, Minato-ku</span>

	  <span class="vcardline">
		<span class="locality">Tokyo</span>,  
		<span class="region"></span>
		<span class="code">108-8118</span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">Phone: +81 50 3812 4704</span>

<span class="vcardline">EMail: <a href="mailto:ikuhei@nttv6.jp">ikuhei@nttv6.jp</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Shin Miyakawa</span> 
	  <span class="n hidden">
		<span class="family-name">Miyakawa</span>
	  </span>
	</span>
	<span class="org vcardline">NTT Communications Corporation</span>
	<span class="adr">
	  <span>Gran Park Tower 17F, 3-4-1 Shibaura, Minato-ku</span>

	  <span class="vcardline">
		<span class="locality">Tokyo</span>,  
		<span class="region"></span>
		<span class="code">108-8118</span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">Phone: +81 50 3812 4695</span>

<span class="vcardline">EMail: <a href="mailto:miyakawa@nttv6.jp">miyakawa@nttv6.jp</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Akira Nakagawa</span> 
	  <span class="n hidden">
		<span class="family-name">Nakagawa</span>
	  </span>
	</span>
	<span class="org vcardline">Japan Internet Exchange Co., Ltd. (JPIX)</span>
	<span class="adr">
	  <span>Otemachi Building 21F, 1-8-1 Otemachi, Chiyoda-ku</span>

	  <span class="vcardline">
		<span class="locality">Tokyo</span>,  
		<span class="region"></span>
		<span class="code">100-0004</span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">Phone: +81 90 9242 2717</span>

<span class="vcardline">EMail: <a href="mailto:a-nakagawa@jpix.ad.jp">a-nakagawa@jpix.ad.jp</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hiroyuki Ashida</span> 
	  <span class="n hidden">
		<span class="family-name">Ashida</span>
	  </span>
	</span>
	<span class="org vcardline">IS Consulting G.K.</span>
	<span class="adr">
	  <span>12-17 Odenma-cho Nihonbashi Chuo-ku</span>

	  <span class="vcardline">
		<span class="locality">Tokyo</span>,  
		<span class="region"></span>
		<span class="code">103-0011</span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:assie@hir.jp">assie@hir.jp</a></span>

  </address>
</div>

</body>
</html>