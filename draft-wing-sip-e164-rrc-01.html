<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>SIP E.164 Return Routability Check (RRC)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="SIP E.164 Return Routability Check (RRC)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Wing</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco</td></tr>
<tr><td class="header">Intended status:  Standards Track</td><td class="header">February 09, 2008</td></tr>
<tr><td class="header">Expires:  August 12, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />SIP E.164 Return Routability Check (RRC)<br />draft-wing-sip-e164-rrc-01</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 12, 2008.</p>

<h3>Abstract</h3>

<p>SIP lacks a mechanism to determine which domain can claim ownership
      of a certain telephone number. Due to this, it is impossible to
      establish meaningful identity or to authenticate endpoints that use
      telephone number URIs and domain names in their From address. This document proposes a
      solution to this problem using a return routability test.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Notational Conventions<br />
<a href="#anchor3">3.</a>&nbsp;
Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-verifier-operation">3.1.</a>&nbsp;
Verifier Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-authentication-operation">3.2.</a>&nbsp;
Authentication Service or Calling Endpoint Operation<br />
<a href="#anchor4">4.</a>&nbsp;
Performance Considerations<br />
<a href="#anchor5">5.</a>&nbsp;
Deployment Considerations<br />
<a href="#sec-security-considerations">6.</a>&nbsp;
Security Considerations<br />
<a href="#examples">7.</a>&nbsp;
Examples<br />
<a href="#anchor6">8.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-event-package">8.1.</a>&nbsp;
Reverse-Route Event Package<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">8.2.</a>&nbsp;
The &quot;application/return-routability-nonce&quot; Media Type<br />
<a href="#anchor8">9.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informational References<br />
<a href="#anchor11">Appendix&nbsp;A.</a>&nbsp;
Changes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">A.1.</a>&nbsp;
Changes from -00 to -01<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p><a class='info' href='#RFC3261'>SIP<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261] allows using both email-style
      addresses (user@domain) and telephone-style addresses (1234@domain). The
      latter is most often used with <a class='info' href='#ITU.E164.1991'>E.164<span> (</span><span class='info'>International Telecommunications Union, &ldquo;The International Public Telecommunication Numbering Plan,&rdquo; 1991.</span><span>)</span></a> [ITU.E164.1991]
      numbers (designated with ";user=phone") especially between different administrative domains.
</p>
<p>

SIP's use of
      E.164 numbers poses several problems. This draft provides a solution to
      one of the problems: determining if a domain name rightfully 'owns' an
      E.164 phone number. In order to do this, a new SIP request is routed
      towards that E.164 and, if it is received by the same domain, that
      domain is deemed to 'own' that E.164 number. This is termed a 'return
      routability check' (RRC).
</p>
<p>The return routability check relies on SIP routing to ascertain which
      domain 'owns' a certain E.164 number.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Notational Conventions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Operation</h3>

<p>In order to check if a domain actually 'owns' the E.164 number it
      claims to own, a new SIP request is sent towards that E.164. Upon
      receipt of a SIP request conaining an E.164 number in the From address,
      the verifying agent in the receiving domain sends a new, out-of-dialog
      request (a SUBSCRIBE) towards that E.164 using the verifiering domain's
      normal routing rules. This SUBSCRIBE contains a body (with a nonce) that
      the verifying domains wants the owner of the E.164 to sign. That SIP
      SUBSCRIBE request is routed to the 'owner' of that E.164. Upon receipt
      of the SUBSCRIBE, the owner of that E.164 number generates a NOTIFY
      request. This is signed, using RFC4474, and sent to the verifying
      domain. The verifing domain verifies the signature on the NOTIFY. If it
      verified, and if the same public key was used in the original SIP
      request and in this NOTIFY, the verifying domain has now verified the
      remote domain 'owns' that E.164 number. If a different public key was
      used in the original SIP request and in this NOTIFY, the verifying
      domain has no verified the remote domain does not own that E.164
      number.
</p>
<a name="sec-verifier-operation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Verifier Operation</h3>

<p>Upon receipt of an INVITE where the From: address contains a SIP
        URI with an E.164, a Verifier (as defined in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>) needs to verify if the signer is authorized
        to sign for that domain. To do this, the Verifier has an additional
        task: it sends an out of dialog SIP SUBSCRIBE request containing a
        random nonce to that E.164, using the Verifier's default SIP routing
        rules for routing an E.164 address. The domain that owns the E.164
        will sign the nonce and send a NOTIFY request back.
</p>
<p>The steps the Verifier uses to perform this operation are:</p>
<ol class="text">
<li>Strip the domain name of the From: of the incoming INVITE. This
            results in a TEL URI. For example, "sip:+14085551234@example.com;user=phone"
            is rewritten to "tel:+14085551212".
</li>
<li>Rewrite the TEL URI to a SIP URI, following the Verifier's
            default routing rules. For example, if outgoing calls are
sent to the service provider example.net, then "tel:+14085551212" is
            rewritten to "sip:+14085551212@example.net;user=phone".
</li>
<li>Generate a random nonce.
</li>
<li>Using the SIP URI constructed in step (2), construct a SIP
            SUBSCRIBE message with Request-URI and To headers that use that
            SIP URI, and an "Expires" header of 0. The SUBSCRIBE contains the
            random nonce in its body as Content-Type
            application/return-routability-nonce.
</li>
<li>Send the SUBSCRIBE message. This will cause the calling party
            to send a NOTIFY.
</li>
</ol><p>Upon receipt of the NOTIFY message, the Verifier performs the
        following steps:</p>
<ol class="text">
<li>Validate the <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> signature of the
            NOTIFY.
</li>
<li>Extract the application/return-routability-nonce from the
            NOTIFY, and compare it to the nonce that was sent in the
            SUBSCRIBE.
</li>
<li>Compare the certificate used to sign the NOTIFY is the same
            certificate used to sign the original SIP request that it is
            attempting to validate with this procedure.
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>If they match, the E.164 return routability test has
                succeeded.
</dd>
<dt>B.</dt>
<dd>If they do not match, the E.164 return routability test has
                failed.
</dd>
</dl></blockquote>
</li>
</ol>

<a name="sec-authentication-operation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Authentication Service or Calling Endpoint Operation</h3>

<p>The steps described in this section can be performed by the
        authentication service or by the calling endpoint.
</p>
<p>The authentication service or the calling endpoint, upon receiving
        a SUBSCRIBE for the return-routability event package, performs the
        following steps:</p>
<ol class="text">
<li>The SUBSCRIBE should be immediately acknowledged with a 200 Ok
            message.
</li>
<li>A NOTIFY should be immediately created, containing the same
            application/return-routability-nonce copied from the SUBSCRIBE.
            This NOTIFY contains a To and Request-URI which match the From of
            the SUBSCRIBE.
</li>
<li>This NOTIFY is sent.
</li>
<li>The RFC4474 authentication service, operating at the domain,
            will create a signature over the NOTIFY. This is used by the
            remote domain's verification service (see <a class='info' href='#sec-verifier-operation'>Section&nbsp;3.1<span> (</span><span class='info'>Verifier Operation</span><span>)</span></a>).
</li>
</ol>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Performance Considerations</h3>

<p>To reduce SUBSCRIBE/NOTIFY traffic, a verifier SHOULD cache
      successful and failed return routability checks. Successful checks will
      only become unsuccessful if SIP E.164 routing is changed to a different
      terminating domain. This only occurs when a domain relinquishes an
      E.164, so it is RECOMMENDED that the result of ssuccessful tests be
      cached for 24 hours. However, unsuccessful tests could be a result of
      misconfiguration and it is useful to re-verify such failures in the
      event the misconfiguration is fixed. Thus, it is RECOMMENDED that the
      result of unsuccessful tests be cached for 1 hour.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Deployment Considerations</h3>

<p>Intermediate SIP elements (proxies, SBCs, B2BUAs) MUST all forward
      the application/return-routability-nonce Content-Type.
</p>
<a name="sec-security-considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>An attacker could cause a domain to perform public key operations by
      sending a bunch of bogus SUBSCRIBE messages. This can be thwarted by
      only responding with NOTIFYs if there is an active INVITE dialog.
      However, that could disclose information about active calls, and also
      restricts the usefulness of this feature to INVITEs. More evaluation of
      countermeasures against such an attack is needed.
</p>
<p>[[This section will be completed in a later version of this
      document.]]
</p>
<a name="examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Examples</h3>

<p>
</p><br /><hr class="insert" />
<a name="fig-successful-messge-flow"></a>

<p>Example message flow for a successful return routability
        check.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Calling    Auth.                            Called
  UA      Service    proxies    Verifier      UA
-------   -------    --------   --------    ------ --------
  |          |          |          |          |     ^
  | INVITE   |          |          |          |     |
  |---------&gt;|          |          |          |     |
  |          |          |          |          |     |
  |    (signs request)  |          |          |     |
  |          |          |          |          |     |
  |100       | INVITE   |          |          |     | steps which
  |&lt;---------|---------&gt;|          |          |     | are part of
  |          |          |          |          |     | normal RFC4474
  |          |100       | INVITE   |          |     |
  |          |&lt;---------|---------&gt;|          |     |
  |          |          |          |          |     |
  |          |          |100       |          |     |
  |          |          |&lt;---------|          |     |
  |          |          |          |          |     |
  |          |          |    (validates       |     |
  |          |          |     signature)      |     V
  |          |          |          |          |    ----------
  |          |          |SUBSCRIBE |          |
  |          |          |(containing nonce)   |
  |          |SUBSCRIBE |&lt;---------|          |
  |          |&lt;---------|          |          |
  |          |          |          |          |
  |          |200 Ok    |          |          |
  |          |---------&gt;|200 Ok    |          |
  |          |          |---------&gt;|          |
  |   NOTIFY |          |          |          |
  |  (containing nonce) |          |          |
  |     +----|          |          |          |
  |     |    |          |          |          |
  |     +---&gt;|          |          |          |
  |          |          |          |          |
  |    (signs NOTIFY)   |          |          |
  |          |          |          |          |
  |          |NOTIFY    |          |          |
  |          |---------&gt;|NOTIFY    |          |
  |          |          |---------&gt;|          |
  |          |          |          |          |
  |          |          |200 Ok    |          |
  |          |200 Ok    |&lt;---------|          |
  |          |&lt;---------|          |          |
  |          |          |          |          |
  |          |          |  (validates NOTIFY  |
  |          |          |    signature, and   |
  |          |          |  checks that same   |
  |          |          |  cert. signed both  |
  |          |          |   the INVITE and    |
  |          |          |     the NOTIFY)     |
  |          |          |          |          |
  |          |          |          | INVITE   |
  |          |          |          |---------&gt;|
  |          |          |          |          |
  |          |          |          |          |display e.164
  |          |          |          |          |------------&gt;
  |          |          |          |          |

</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Message Flow -- Return Routability Check Success&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="fig-failed-messge-flow"></a>

<p>Example message flow for an unsuccessful return routability
        check, where the NOTIFY is signed by a different RFC4474
        authentication service:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>          Calling     E.164
           User's    Owner's
Calling    Auth.      Auth.                            Called
  UA      Service    Service     proxies   Verifier      UA
-------   -------    -------     -------   --------    ------
  |          |          |          |          |          |
  | INVITE   |          |          |          |          |
  |---------&gt;|          |          |          |          |
  |          |          |          |          |          |
  |    (signs request)  |          |          |          |
  |          |          |          |          |          |
  |100       | INVITE   |          |          |          |
  |&lt;---------|--------------------&gt;|          |          |
  |          |          |          |          |          |
  |          |100       |          | INVITE   |          |
  |          |&lt;--------------------|---------&gt;|          |
  |          |          |          |          |          |
  |          |          |          |100       |          |
  |          |          |          |&lt;---------|          |
  |          |          |          |          |          |
  |          |          |          |    (validates       |
  |          |          |          |     signature)      |
  |          |          |          |          |          |
  |          |          |          |SUBSCRIBE |          |
  |          |          |SUBSCRIBE |(containing nonce)   |
  |          |          |&lt;---------|          |          |
  |          |          |200 Ok    |          |          |
  |          |          |---------&gt;|200 Ok    |          |
  |          |   NOTIFY |          |---------&gt;|          |
  |          |  (containing nonce) |          |          |
  |          |     +----|          |          |          |
  |          |     |    |          |          |          |
  |          |     +---&gt;|          |          |          |
  |          |          |          |          |          |
  |          |    (signs NOTIFY)   |          |          |
  |          |          |          |          |          |
  |          |          |NOTIFY    |          |          |
  |          |          |---------&gt;|NOTIFY    |          |
  |          |          |          |---------&gt;|          |
  |          |          |          |          |          |
  |          |          |          |200 Ok    |          |
  |          |          |200 Ok    |&lt;---------|          |
  |          |          |&lt;---------|          |          |
  |          |          |          |          |          |
  |          |          |          | (NOTIFY validates;  |
  |          |          |          |  however, different |
  |          |          |          |  cert. was used for |
  |          |          |          |  INVITE)            |
  |          |          |          |          |          |
  |          |          |          |          |          |
  |          |          |          |          | INVITE   |
  |          |          |          |          |---------&gt;|
  |          |          |          |          |          |
  |          |          |          |          |          |display
  |          |          |          |          |          |e.164
  |          |          |          |          |          |------&gt;
  |          |          |          |          |          |

</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Message Flow -- Return Routability Check Failure&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>IANA is requested to register the following new event package and one
      new media type.
</p>
<a name="sec-event-package"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Reverse-Route Event Package</h3>

<p>This specification registers an event package, based on the
        registration procedures defined in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>. The
        following is the information required for such a registration:
</p>
<p>Package Name: reverse-route
</p>
<p>Package or Package-Template: This is a package.
</p>
<p>Published Specification: &lt;this document&gt;.
</p>
<p>Person to Contact: Dan Wing, &lt;dwing@cisco.com&gt;
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
The &quot;application/return-routability-nonce&quot; Media Type</h3>

<p>Type name: application 
</p>
<p>Subtype name: return-routability-nonce
</p>
<p>Required parameters: None. 
</p>
<p>Optional parameters: None. 
</p>
<p>Encoding considerations: The nonce is primarily binary content.
</p>
<p>Security considerations: See <a class='info' href='#sec-security-considerations'>Section&nbsp;6<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> of &lt;this
        document&gt;.
</p>
<p>Interoperability considerations: See &lt;this document&gt;.
</p>
<p>Published specification: &lt;this document&gt;
</p>
<p>Applications which use this media type: SIP.
</p>
<p>Additional information: 
</p>
<p>Magic number(s): None. 
</p>
<p>File extension(s): None.
</p>
<p>Macintosh File Type Code(s): none.
</p>
<p>Person &amp; email address to contact for further information: Dan
        Wing &lt;dwing@cisco.com&gt;
</p>
<p>Intended Usage: COMMON
</p>
<p>Author/Change Controller: Dan Wing &lt;dwing@cisco.com&gt;
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>Thanks to Paul Kyzivat and Hannes Tschofenig for their review and
comments on this document.  Thanks to Joel Halpern for pointing out
the missing ";user=phone" parameter.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[RFC4474]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3265">[RFC3265]</a></td>
<td class="author-text">Roach, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3265">Session Initiation Protocol (SIP)-Specific Event Notification</a>,&rdquo; RFC&nbsp;3265, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3265.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informational References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ITU.E164.1991">[ITU.E164.1991]</a></td>
<td class="author-text">International Telecommunications Union, &ldquo;The International Public Telecommunication Numbering Plan,&rdquo; ITU-T&nbsp;Recommendation E.164, 1991.</td></tr>
</table>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Changes</h3>

<p>[[RFC Editor: Please remove this section prior to publication.]]
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Changes from -00 to -01</h3>

<p></p>
<ul class="text">
<li>Added ";user=phone" to identify E.164 number.
</li>
</ul><p>

</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dan Wing</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 West Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dwing@cisco.com">dwing@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
