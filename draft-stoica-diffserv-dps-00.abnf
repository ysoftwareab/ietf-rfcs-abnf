C = min(r_1(t), alpha(t)) + min(r_1(t), alpha(t)) + ...  (1)
                    min(r_1(t), alpha(t)).

P = max(0, 1 - alpha(t)/r_i(t))                (2)

i = get_flow(p);
r = estimate_flow_rate(p,i);
alpha = estimate_fair_rate();
P = max(1 - alpha/r, 0);
i = get_flow(p);
e = crt_time + g + delta; /* see Eq. (3) */
d = e + l(p)/r;

R_bound = R_bound + r

i = get_flow(p);
L = L + b;                    |    if (R_bound + r <= C)
                                          |      Ra = Ra + r;
R_est = L / T_W;              |    else
R_bound = min(R_bound,        |      deny(r);
                      R_est/(1 - f) + Ra);|
Ra = 0;                       |
tmp = mantissa | (1 << m);
