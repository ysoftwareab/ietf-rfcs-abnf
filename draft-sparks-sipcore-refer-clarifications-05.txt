



Network Working Group                                          R. Sparks
Internet-Draft                                                    Oracle
Updates: 3515 (if approved)                                     A. Roach
Intended status: Standards Track                                 Mozilla
Expires: April 30, 2015                                 October 27, 2014


            Clarifications for the use of REFER with RFC6665
              draft-sparks-sipcore-refer-clarifications-05

Abstract

   An accepted SIP REFER method creates an implicit subscription using
   the SIP-Specific Event Notification Framework.  That framework was
   revised by RFC6665.  This document highlights the implications of the
   requirement changes in RFC6665, and updates the definition of the
   REFER method, RFC3515, to clarify and disambiguate the impact of
   those changes.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 30, 2015.

Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of



Sparks & Roach           Expires April 30, 2015                 [Page 1]

Internet-Draft            Refer Clarifications              October 2014


   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Conventions and Definitions . . . . . . . . . . . . . . . . .   2
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Use of GRUU is mandatory  . . . . . . . . . . . . . . . . . .   2
   4.  Dialog reuse is prohibited  . . . . . . . . . . . . . . . . .   3
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   3
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   4
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .   4
     7.2.  Informative References  . . . . . . . . . . . . . . . . .   4
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   5

1.  Conventions and Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

2.  Introduction

   An accepted SIP REFER method creates an implicit subscription using
   the SIP-Specific Event Notification Framework.  That framework was
   revised by [RFC6665].  This document highlights the implications of
   the requirement changes in RFC6665, and updates [RFC3515] to clarify
   and disambiguate the impact of those changes.

3.  Use of GRUU is mandatory

   Section 4.5.1 of [RFC6665] makes GRUU [RFC5627] mandatory to
   implement and use as the local target in the subscription created by
   the REFER request.

   A user agent constructing any REFER that can result in an implicit
   subscription MUST populate its Contact header field with a GRUU.

   As RFC6665 details, this is necessary to ensure that NOTIFY requests
   sent in the implicitly created subscription arrive at this user agent
   without creating a second usage inside an existing dialog.  Using the
   "norefersub" option tag [RFC4488] does not change this requirement,
   even if used in a "Require" header field.  Even if the recipient
   supports the "norefersub" mechanism, and accepts the request with the
   option tag in the "Require" header field, it is allowed to return a
   "Refer-Sub" header field with a value of "true" in the response, and
   create an implicit subscription.



Sparks & Roach           Expires April 30, 2015                 [Page 2]

Internet-Draft            Refer Clarifications              October 2014


   A UA that will accept a REFER request needs to include a GRUU in the
   Contact header field of all INVITE requests.  This ensures that out-
   of-dialog REFER requests corresponding to any resulting INVITE
   dialogs arrive at this UA.  Future extensions (such as
   [I-D.sparks-sipcore-refer-explicit-subscription]) might relax this
   requirement by defining a REFER request that cannot create an
   implicit subscription.

4.  Dialog reuse is prohibited

   If a peer in an existing dialog has provided a GRUU as its Contact,
   sending a REFER that might result in an additional dialog usage
   within that dialog is prohibited.  This is a direct consequence of
   [RFC6665] requiring the use of GRUU, and the requirements in section
   4.5.2 of that document.

   A user agent constructing a REFER request that could result in an
   implicit subscription MUST build it as an out-of-dialog message as
   defined in [RFC3261].  Thus, the REFER request will have no tag
   parameter in its To: header field.

   A user agent wishing to identify an existing dialog (such as for call
   transfer as defined in [RFC5589] MUST use the "Target-Dialog"
   extension defined in [RFC4538] to do so, and user agents accepting
   REFER MUST be able to process that extension in requests they
   receive.

   If a user agent can be certain that no implicit subscription will be
   created as a result of sending a REFER request (such as by requiring
   an extension that disallows any such subscription), the REFER request
   MAY be sent within an existing dialog.  Such a REFER will be
   constructed with its Contact header field populated with the dialog's
   Local URI as specified in section 12 of [RFC3261].

   As described in section 4.5.2 of [RFC6665], there are cases where a
   user agent may fall back to sharing existing dialogs for backwards-
   compatibility purposes.  This applies to REFER only when the peer has
   not provided a GRUU as its Contact in the existing dialog (i.e. when
   the peer is a pre-RFC6665 implementation).

5.  Security Considerations

   This document introduces no new security considerations directly.
   The updated considerations in [RFC6665] apply to the implicit
   subscription created by an accepted REFER request.






Sparks & Roach           Expires April 30, 2015                 [Page 3]

Internet-Draft            Refer Clarifications              October 2014


6.  IANA Considerations

   This document has no actions for IANA.

7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC3261]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", RFC 3261,
              June 2002.

   [RFC3515]  Sparks, R., "The Session Initiation Protocol (SIP) Refer
              Method", RFC 3515, April 2003.

   [RFC4538]  Rosenberg, J., "Request Authorization through Dialog
              Identification in the Session Initiation Protocol (SIP)",
              RFC 4538, June 2006.

   [RFC5627]  Rosenberg, J., "Obtaining and Using Globally Routable User
              Agent URIs (GRUUs) in the Session Initiation Protocol
              (SIP)", RFC 5627, October 2009.

   [RFC6665]  Roach, A., "SIP-Specific Event Notification", RFC 6665,
              July 2012.

7.2.  Informative References

   [I-D.sparks-sipcore-refer-explicit-subscription]
              Sparks, R., "Explicit Subscriptions for the REFER Method",
              draft-sparks-sipcore-refer-explicit-subscription-00 (work
              in progress), June 2014.

   [RFC4488]  Levin, O., "Suppression of Session Initiation Protocol
              (SIP) REFER Method Implicit Subscription", RFC 4488, May
              2006.

   [RFC5589]  Sparks, R., Johnston, A., and D. Petrie, "Session
              Initiation Protocol (SIP) Call Control - Transfer", BCP
              149, RFC 5589, June 2009.







Sparks & Roach           Expires April 30, 2015                 [Page 4]

Internet-Draft            Refer Clarifications              October 2014


Authors' Addresses

   Robert Sparks
   Oracle
   7460 Warren Parkway
   Suite 300
   Frisco, Texas  75034
   US

   Email: rjsparks@nostrum.com


   Adam Roach
   Mozilla
   Dallas, TX
   US

   Phone: +1 650 903 0800 x863
   Email: adam@nostrum.com
































Sparks & Roach           Expires April 30, 2015                 [Page 5]
