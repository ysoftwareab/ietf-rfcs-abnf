<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>DMARC Aggregate Reporting</title>
<meta content="Alex Brotman" name="author">
<meta content="
       DMARC allows for domain holders to request aggregate reports from receivers.
This report is an XML document, and contains extensible elements that allow for
other types of data to be specified later.  The aggregate reports can be
submitted to the domain holder's specified destination as supported by the
receiver. 
       This document (along with others) obsoletes RFC7489. 
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="draft-ietf-dmarc-aggregate-reporting-04" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.4
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.26.0
    setuptools 59.5.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-dmarc-aggregate-reporting-04-87w5gtkr.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DMARC Aggregate Reporting</td>
<td class="right">December 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Brotman (ed)</td>
<td class="center">Expires 16 June 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">DMARC</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-dmarc-aggregate-reporting-04</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc7489" class="eref">7489</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-12-13" class="published">13 December 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-06-16">16 June 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Brotman (ed)</div>
<div class="org">Comcast, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">DMARC Aggregate Reporting</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">DMARC allows for domain holders to request aggregate reports from receivers.
This report is an XML document, and contains extensible elements that allow for
other types of data to be specified later.  The aggregate reports can be
submitted to the domain holder's specified destination as supported by the
receiver.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document (along with others) obsoletes RFC7489.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 16 June 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-dmarc-feedback" class="xref">DMARC Feedback</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-aggregate-reports" class="xref">Aggregate Reports</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="xref">2.1.1</a>.  <a href="#name-handling-domains-in-reports" class="xref">Handling Domains in Reports</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="xref">2.1.2</a>.  <a href="#name-dkim-signatures-in-aggregat" class="xref">DKIM Signatures in Aggregate Report</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="xref">2.1.3</a>.  <a href="#name-unique-identifiers-in-aggre" class="xref">Unique Identifiers in Aggregate Reporting</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-extensions" class="xref">Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-changes-in-policy-during-re" class="xref">Changes in Policy During Reporting Period</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-recommended-reporting-perio" class="xref">Recommended Reporting Periods</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-report-request-discovery" class="xref">Report Request Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-transport" class="xref">Transport</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6.2.1">
                    <p id="section-toc.1-1.2.2.6.2.1.1"><a href="#section-2.6.1" class="xref">2.6.1</a>.  <a href="#name-email" class="xref">Email</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6.2.2">
                    <p id="section-toc.1-1.2.2.6.2.2.1"><a href="#section-2.6.2" class="xref">2.6.2</a>.  <a href="#name-other-methods" class="xref">Other Methods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6.2.3">
                    <p id="section-toc.1-1.2.2.6.2.3.1"><a href="#section-2.6.3" class="xref">2.6.3</a>.  <a href="#name-handling-of-duplicates" class="xref">Handling of Duplicates</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-verifying-external-destinat" class="xref">Verifying External Destinations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-extensible-reporting" class="xref">Extensible Reporting</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-data-exposure-consideration" class="xref">Data Exposure Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-report-recipients" class="xref">Report Recipients</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-data-contained-within-repor" class="xref">Data Contained Within Reports (Tkt64)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-appendix-a-dmarc-xml-schema" class="xref">Appendix A. DMARC XML Schema</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-appendix-b-sample-report" class="xref">Appendix B. Sample Report</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A key component of DMARC is the ability for domain holders to request that
receivers provide various types of reports.  These reports allow domain holders
to have insight into which IP addresses are sending on their behalf, and some
insight into whether or not the volume may be legitimate.  These reports expose
information relating to the DMARC policy, as well as the outcome of
SPF <span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span> &amp; DKIM <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span> validation.<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">In many IETF documents, several words, when they are in all capitals
as shown below, are used to signify the requirements in the
specification.  These capitalized words can bring significant clarity
and consistency to documents because their meanings are well defined.
This document defines how those words are interpreted in IETF
documents when the words are in all capitals.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
            <p id="section-1.1-2.1.1">These words can be used as defined here, but using them is not
required.  Specifically, normative text does not require the use
of these key words.  They are used for clarity and consistency
when that is what's wanted, but a lot of normative text does not
use them and is still normative.<a href="#section-1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">The words have the meanings specified herein only when they are in
all capitals.<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.3">
            <p id="section-1.1-2.3.1">When these words are not capitalized, they have their normal
English meanings and are not affected by this document.<a href="#section-1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-3">Authors who follow these guidelines should incorporate this phrase
near the beginning of their document:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.1-4">
<pre>   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
   NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
   "MAY", and "OPTIONAL" in this document are to be interpreted as
   described in BCP 14 [RFC2119] [RFC8174] when, and only when, they
   appear in all capitals, as shown here.
</pre><a href="#section-1.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="dmarc-feedback">
<section id="section-2">
      <h2 id="name-dmarc-feedback">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-dmarc-feedback" class="section-name selfRef">DMARC Feedback</a>
      </h2>
<p id="section-2-1">Providing Domain Owners with visibility into how Mail Receivers implement
and enforce the DMARC mechanism in the form of feedback is critical to
establishing and maintaining accurate authentication deployments.  When
Domain Owners can see what effect their policies and practices are having,
they are better willing and able to use quarantine and reject policies.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="aggregate-reports">
<section id="section-2.1">
        <h3 id="name-aggregate-reports">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-aggregate-reports" class="section-name selfRef">Aggregate Reports</a>
        </h3>
<p id="section-2.1-1">The DMARC aggregate feedback report is designed to provide Domain
Owners with precise insight into:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">authentication results,<a href="#section-2.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-2.2">corrective action that needs to be taken by Domain Owners, and<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-2.3">the effect of Domain Owner DMARC policy on email streams processed
by Mail Receivers.<a href="#section-2.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-3">Aggregate DMARC feedback provides visibility into real-world email
streams that Domain Owners need to make informed decisions regarding
the publication of DMARC policy.  When Domain Owners know what
legitimate mail they are sending, what the authentication results are
on that mail, and what forged mail receivers are getting, they can
make better decisions about the policies they need and the steps they
need to take to enable those policies.  When Domain Owners set
policies appropriately and understand their effects, Mail Receivers
can act on them confidently.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Visibility comes in the form of daily (or more frequent) Mail
Receiver-originated feedback reports that contain aggregate data on
message streams relevant to the Domain Owner.  This information
includes data about messages that passed DMARC authentication as well
as those that did not.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">The report may include the following data:<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-6.1">The DMARC policy discovered and applied, if any<a href="#section-2.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.2">The selected message disposition<a href="#section-2.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.3">The identifier evaluated by SPF and the SPF result, if any<a href="#section-2.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.4">The identifier evaluated by DKIM and the DKIM result, if any<a href="#section-2.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.5">For both DKIM and SPF, an indication of whether the identifier was
in alignment<a href="#section-2.1-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.6">A separate report should be generated for each Policy Domain encountered during
the reporting period.  If there are multiple 5322.From domains that are included, those
should result in distinct records within the report. See below for further
explanation in "Handling Domains in Reports".<a href="#section-2.1-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.7">Sending and receiving domains<a href="#section-2.1-6.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.8">The policy requested by the Domain Owner and the policy actually
applied (if different)<a href="#section-2.1-6.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.9">The number of successful authentications<a href="#section-2.1-6.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.10">The counts of messages based on all messages received, even if
their delivery is ultimately blocked by other filtering agents.<a href="#section-2.1-6.10" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-7">The format for these reports is defined in Appendix A.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8">DMARC Aggregate Reports MUST contain two primary sections; one consisting
of descriptive information and the other a set of IP-focused row-based data.
Each report MUST contain data for only one Author Domain. A single report
MUST contain data for one policy configuration. If multiple configurations
were observed during a single reporting period, a reporting entity MAY choose
to send multiple reports, otherwise the reporting entity SHOULD note only the
final configuration observed during the period. See below for further information.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">The informative section MUST contain two sub-sections.  One will be the metadata
section which MUST contain the fields related to <code>org_name</code>, <code>email</code>,
<code>report_id</code>, and <code>date_range</code>. Optional fields MAY include
<code>extra_contact_info</code>, an <code>error</code> field, and an optional <code>version</code> field.  The
version field, if present, MUST contain a <code>1.0</code> [!@RFC7489] or <code>2.0</code> [RefNeeded],
noting to which version of the aggregate reporting specification the report
adheres. The <code>date_range</code> section which will note <code>begin</code> and <code>end</code> values as epoch
timestamps. The other sub-section will be the <code>policy_published</code>, and record
the policy configuration observed by the receiving system.  Mandatory
fields are <code>domain</code>, <code>p</code>, <code>sp</code>. Optional fields are <code>fo</code>,
<code>adkim</code>, <code>aspf</code>, and <code>testing</code>.  There MAY be an optional third section
for <code>extensions</code>.<a href="#section-2.1-9" class="pilcrow">¶</a></p>
<p id="section-2.1-10">Within the data section, the report will contain row(s) of data stating which
IPs were seen to have delivered messages for the Author Domain to the receiving
system.  For each IP that is being reported, there will be at least one <code>record</code> element,
which will then have each of a <code>row</code>, <code>identifiers</code>, and <code>auth_results</code>
sub-element.  Within the <code>row</code> element, there MUST be <code>source_ip</code> and <code>count</code>.
There MUST also exist a <code>policy_evaluated</code>, with subelements of <code>disposition</code>,
<code>dkim</code>, and <code>spf</code>.  There MAY be an element for <code>reason</code>, meant to include
any notes the reporter might want to include as to why the <code>disposition</code> policy
does not match the <code>policy_published</code>, such as a Local Policy override (possible
values listed in Appendix A).  The <code>dkim</code> and <code>spf</code> elements MUST be the
evaluated values as they relate to DMARC, not the values the receiver may
have used when overriding the policy. Within the <code>identifiers</code> element,
there MUST exist the data that was used to apply policy for the given IP. In most
cases, this will be a <code>header_from</code> element, which will contain the 5322.From domain
from the message.<a href="#section-2.1-10" class="pilcrow">¶</a></p>
<p id="section-2.1-11">There MUST be an <code>auth_results</code> element within the 'record' element.  This will
contain the data related to authenticating the messages associated with this sending
IP. The <code>dkim</code> subelement is optional as not all messages are signed, while there
MUST be one <code>spf</code> subelement. These elements MUST have a <code>domain</code> that was
used during validation, as well as <code>result</code>. The <code>dkim</code> element MUST
include a <code>selector</code> element that was observed during validation. For the <code>spf</code>
element, the <code>result</code> element MUST contain a lower-case string where the value
is one of none/neutral/pass/fail/softfail/temperror/permerror.  The <code>dkim</code> result
MUST contain a lower-case string where the value is one of
none/pass/fail/policy/neutral/temperror/permerror. Both the <code>spf</code> and <code>dkim</code> results
may optionally include a <code>human_readable</code> field meant for the report to convey
more descriptive information back to the domain holder relating to evaluation
failures. There MAY exist an optional section for <code>extensions</code>.<a href="#section-2.1-11" class="pilcrow">¶</a></p>
<div id="handling-domains-in-reports">
<section id="section-2.1.1">
          <h4 id="name-handling-domains-in-reports">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-handling-domains-in-reports" class="section-name selfRef">Handling Domains in Reports</a>
          </h4>
<p id="section-2.1.1-1">In the same report, there MUST be a single Policy Domain, though there could be
multiple 5322.From Domains.  Each 5322.From domain will create its own <code>record</code>
within the report.  Consider the case where there are three domains with traffic
volume to report: example.com, foo.example.com, and bar.example.com.  There will be
explicit DMARC records for example.com and bar.example.com, with distinct policies.  There
is no explicit DMARC record for foo.example.com, so it will be reliant on the
policy described for example.com.  For a report period, there would now be two reports.<br>
The first will be for bar.example.com, and contain only one <code>record</code>, for
bar.example.com.  The second report would be for example comain contain multiple
<code>record</code> elements, one for example.com and one for foo.example.com (and extensibly,
other <code>record</code> elements for subdomains which likewise did not have an explicit
DMARC policy declared).<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dkim-signatures-in-aggregate-report">
<section id="section-2.1.2">
          <h4 id="name-dkim-signatures-in-aggregat">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-dkim-signatures-in-aggregat" class="section-name selfRef">DKIM Signatures in Aggregate Report</a>
          </h4>
<p id="section-2.1.2-1">Within a single message, the possibility exists that there could be multiple DKIM
signatures. When validation of the message occurs, some signatures may pass,
while some may not.  As these pertain to DMARC, and especially to aggregate
reporting, reporters may not find it clear which DKIM signatures they should include
in a report. Signatures, regardless of outcome, could help the report ingester
determine the source of a message. However, there is a preference as to which
signatures are included.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1.2-2">
<li id="section-2.1.2-2.1">A signature that passes DKIM, in strict alignment with the 5322.From domain<a href="#section-2.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-2.1.2-2.2">A signature that passes DKIM, in relaxed alignment with the 5322.From domain<a href="#section-2.1.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-2.1.2-2.3">Any other DKIM signatures that pass<a href="#section-2.1.2-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-2.1.2-2.4">DKIM signatures that do not pass<a href="#section-2.1.2-2.4" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-2.1.2-3">A report SHOULD contain no more than 100 signatures for a given <code>row</code>, in
decreasing priority.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unique-identifiers-in-aggregate-reporting">
<section id="section-2.1.3">
          <h4 id="name-unique-identifiers-in-aggre">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-unique-identifiers-in-aggre" class="section-name selfRef">Unique Identifiers in Aggregate Reporting</a>
          </h4>
<p id="section-2.1.3-1">There are a few places where a unique identifier is specified as part of the
body of the report, the subject, and so on.  These unique identifiers should be
consistent per each report.  Specified below, the reader will see a <code>msg-id</code>,
<code>Report-ID</code>, <code>unique-id</code>.  These are the fields that MUST be identical when used.<a href="#section-2.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="extensions">
<section id="section-2.2">
        <h3 id="name-extensions">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-extensions" class="section-name selfRef">Extensions</a>
        </h3>
<p id="section-2.2-1">There MAY be optional sections for extensions within the document.
The absence or existence of this section SHOULD NOT create an error when
processing reports. This will be covered in a separate section.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-in-policy-during-reporting-period">
<section id="section-2.3">
        <h3 id="name-changes-in-policy-during-re">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-changes-in-policy-during-re" class="section-name selfRef">Changes in Policy During Reporting Period</a>
        </h3>
<p id="section-2.3-1">Note that Domain Owners or their agents may change the published
DMARC policy for a domain or subdomain at any time.  From a Mail
Receiver's perspective, this will occur during a reporting period and
may be noticed during that period, at the end of that period when
reports are generated, or during a subsequent reporting period, all
depending on the Mail Receiver's implementation.  Under these
conditions, it is possible that a Mail Receiver could do any of the
following:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">generate for such a reporting period a single aggregate report
that includes message dispositions based on the old policy, or a
mix of the two policies, even though the report only contains a
single "policy_published" element;<a href="#section-2.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-2.2">generate multiple reports for the same period, one for each
published policy occurring during the reporting period;<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-2.3">generate a report whose end time occurs when the updated policy
was detected, regardless of any requested report interval.<a href="#section-2.3-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.3-3">Such policy changes are expected to be infrequent for any given
domain, whereas more stringent policy monitoring requirements on the
Mail Receiver would produce a very large burden at Internet scale.
Therefore, it is the responsibility of report consumers and Domain
Owners to be aware of this situation and allow for such mixed reports
during the propagation of the new policy to Mail Receivers.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="recommended-reporting-periods">
<section id="section-2.4">
        <h3 id="name-recommended-reporting-perio">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-recommended-reporting-perio" class="section-name selfRef">Recommended Reporting Periods</a>
        </h3>
<p id="section-2.4-1">Aggregate reports are most useful when they all cover a common time
period.  By contrast, correlation of these reports from multiple
generators when they cover incongruent time periods is difficult or
impossible.  Report generators SHOULD, wherever possible, adhere to
hour boundaries for the reporting period they are using.  For
example, starting a per-day report at 00:00; starting per-hour
reports at 00:00, 01:00, 02:00; etc.  Report generators using a
24-hour report period are strongly encouraged to begin that period at
00:00 UTC, regardless of local timezone or time of report production,
in order to facilitate correlation.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="report-request-discovery">
<section id="section-2.5">
        <h3 id="name-report-request-discovery">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-report-request-discovery" class="section-name selfRef">Report Request Discovery</a>
        </h3>
<p id="section-2.5-1">A Mail Receiver discovers reporting requests when it looks up a DMARC
policy record that corresponds to an RFC5322.From domain on received
mail.  The presence of the "rua" tag specifies where to send
feedback.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transport">
<section id="section-2.6">
        <h3 id="name-transport">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-transport" class="section-name selfRef">Transport</a>
        </h3>
<p id="section-2.6-1">Where the URI specified in a "rua" tag does not specify otherwise, a
   Mail Receiver generating a feedback report SHOULD employ a secure
   transport mechanism.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">The Mail Receiver, after preparing a report, MUST evaluate the
   provided reporting URIs in the order given.  Any reporting URI that
   includes a size limitation exceeded by the generated report (after
   compression and after any encoding required by the particular
   transport mechanism) MUST NOT be used.  An attempt MUST be made to
   deliver an aggregate report to every remaining URI, up to the
   Receiver's limits on supported URIs.<a href="#section-2.6-2" class="pilcrow">¶</a></p>
<p id="section-2.6-3">If transport is not possible because the services advertised by the
   published URIs are not able to accept reports (e.g., the URI refers
   to a service that is unreachable, or all provided URIs specify size
   limits exceeded by the generated record), the Mail Receiver MAY
   send a short report (see Section 7.2.2) indicating that a report is
   available but could not be sent.  The Mail Receiver MAY cache that
   data and try again later, or MAY discard data that could not be sent.<a href="#section-2.6-3" class="pilcrow">¶</a></p>
<div id="email">
<section id="section-2.6.1">
          <h4 id="name-email">
<a href="#section-2.6.1" class="section-number selfRef">2.6.1. </a><a href="#name-email" class="section-name selfRef">Email</a>
          </h4>
<p id="section-2.6.1-1">The message generated by the Mail Receiver MUST be a [MAIL] message
   formatted per [MIME].  The aggregate report itself MUST be included
   in one of the parts of the message.  A human-readable portion MAY be
   included as a MIME part (such as a text/plain part).<a href="#section-2.6.1-1" class="pilcrow">¶</a></p>
<p id="section-2.6.1-2">The aggregate data MUST be an XML file that SHOULD be subjected to
   GZIP compression.  Declining to apply compression can cause the
   report to be too large for a receiver to process (a commonly observed
   receiver limit is ten megabytes); doing the compression increases the
   chances of acceptance of the report at some compute cost.  The
   aggregate data MUST be present using the media type "application/
   gzip" if compressed (see [GZIP]), and "text/xml" otherwise.  The
   filename MUST be constructed using the following ABNF:<a href="#section-2.6.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.6.1-3">
<pre> filename = receiver "!" policy-domain "!" begin-timestamp
            "!" end-timestamp [ "!" unique-id ] "." extension

 receiver = domain
            ; imported from [MAIL]

 policy-domain   = domain

 begin-timestamp = 1*DIGIT
                   ; seconds since 00:00:00 UTC January 1, 1970
                   ; indicating start of the time range contained
                   ; in the report

 end-timestamp = 1*DIGIT
                 ; seconds since 00:00:00 UTC January 1, 1970
                 ; indicating end of the time range contained
                 ; in the report

 unique-id = 1*(ALPHA / DIGIT)

 extension = "xml" / "xml.gz"
</pre><a href="#section-2.6.1-3" class="pilcrow">¶</a>
</div>
<p id="section-2.6.1-4">The extension MUST be "xml" for a plain XML file, or "xml.gz" for an
   XML file compressed using GZIP.<a href="#section-2.6.1-4" class="pilcrow">¶</a></p>
<p id="section-2.6.1-5">"unique-id" allows an optional unique ID generated by the Mail
   Receiver to distinguish among multiple reports generated
   simultaneously by different sources within the same Domain Owner.<a href="#section-2.6.1-5" class="pilcrow">¶</a></p>
<p id="section-2.6.1-6">If a report generator needs to re-send a report, the system MUST
   use the same filename as the original report.  This would
   allow the receiver to overwrite the data from the original, or discard
   second instance of the report.<a href="#section-2.6.1-6" class="pilcrow">¶</a></p>
<p id="section-2.6.1-7">For example, this is a sample filename for the gzip file of a
   report to the Domain Owner "example.com" from the Mail Receiver
   "mail.receiver.example":<a href="#section-2.6.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.6.1-8">
<pre> mail.receiver.example!example.com!1013662812!1013749130.gz
</pre><a href="#section-2.6.1-8" class="pilcrow">¶</a>
</div>
<p id="section-2.6.1-9">No specific MIME message structure is required.  It is presumed that
   the aggregate reporting address will be equipped to extract MIME
   parts with the prescribed media type and filename and ignore the
   rest.<a href="#section-2.6.1-9" class="pilcrow">¶</a></p>
<p id="section-2.6.1-10">Email streams carrying DMARC feedback data MUST conform to the DMARC
   mechanism, thereby resulting in an aligned "pass" (see Section 3.1).
   This practice minimizes the risk of report consumers processing
   fraudulent reports.<a href="#section-2.6.1-10" class="pilcrow">¶</a></p>
<p id="section-2.6.1-11">The RFC5322.Subject field for individual report submissions MUST
   conform to the following ABNF:<a href="#section-2.6.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.6.1-12">
<pre> dmarc-subject = %x52.65.70.6f.72.74 1*FWS       ; "Report"
                 %x44.6f.6d.61.69.6e.3a 1*FWS    ; "Domain:"
                 domain-name 1*FWS               ; from RFC 6376
                 %x53.75.62.6d.69.74.74.65.72.3a ; "Submitter:"
                 1*FWS domain-name 1*FWS
                 %x52.65.70.6f.72.74.2d.49.44.3a ; "Report-ID:"
                 msg-id                          ; from RFC 5322
</pre><a href="#section-2.6.1-12" class="pilcrow">¶</a>
</div>
<p id="section-2.6.1-13">The first domain-name indicates the DNS domain name about which the
   report was generated.  The second domain-name indicates the DNS
   domain name representing the Mail Receiver generating the report.
   The purpose of the Report-ID: portion of the field is to enable the
   Domain Owner to identify and ignore duplicate reports that might be
   sent by a Mail Receiver.<a href="#section-2.6.1-13" class="pilcrow">¶</a></p>
<p id="section-2.6.1-14">For instance, this is a possible Subject field for a report to the
   Domain Owner "example.com" from the Mail Receiver
   "mail.receiver.example".  It is line-wrapped as allowed by [MAIL]:<a href="#section-2.6.1-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.6.1-15">
<pre> Subject: Report Domain: example.com
     Submitter: mail.receiver.example
     Report-ID: &lt;2002.02.15.1&gt;
</pre><a href="#section-2.6.1-15" class="pilcrow">¶</a>
</div>
<p id="section-2.6.1-16">This transport mechanism potentially encounters a problem when
   feedback data size exceeds maximum allowable attachment sizes for
   either the generator or the consumer.  See Section 7.2.2 for further
   discussion.<a href="#section-2.6.1-16" class="pilcrow">¶</a></p>
<p id="section-2.6.1-17">Optionally, the report sender MAY choose to use the same <code>msg-id</code>
   as a part or whole of the 5322.Message-Id header included with the report.
   Doing so may help receivers distinguish when a message is a re-transmission
   or duplicate report.<a href="#section-2.6.1-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-methods">
<section id="section-2.6.2">
          <h4 id="name-other-methods">
<a href="#section-2.6.2" class="section-number selfRef">2.6.2. </a><a href="#name-other-methods" class="section-name selfRef">Other Methods</a>
          </h4>
<p id="section-2.6.2-1">The specification as written allows for the addition of other
registered URI schemes to be supported in later versions.<a href="#section-2.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handling-of-duplicates">
<section id="section-2.6.3">
          <h4 id="name-handling-of-duplicates">
<a href="#section-2.6.3" class="section-number selfRef">2.6.3. </a><a href="#name-handling-of-duplicates" class="section-name selfRef">Handling of Duplicates</a>
          </h4>
<p id="section-2.6.3-1">There may be a situation where the report generator attempts to deliver
duplicate information to the receiver.  This may manifest as an exact
duplicate of the report, or as duplicate information between two reports.
In these situations, the decision of how to handle the duplicate data
lies with the receiver.  As noted above, the sender MUST use the same
unique identifiers when sending the report.  This allows the receiver to
better understand when duplicates happen.  A few options on how to
handle that duplicate information:<a href="#section-2.6.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.6.3-2.1">Reject back to sender, ideally with a permfail error noting
the duplicate receipt<a href="#section-2.6.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.6.3-2.2">Discard upon receipt<a href="#section-2.6.3-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.6.3-2.3">Inspect the contents to evaluate the timestamps and reported data,
act as appropriate<a href="#section-2.6.3-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.6.3-2.4">Accept the duplicate data<a href="#section-2.6.3-2.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.6.3-3">When accepting the data, that's likely in a situation where it's not
yet noticed, or a one-off experience.  Long term, duplicate data
is not ideal.  In the situation of a partial timeframe overlap, there is
no clear way to distinguish the impact of the overlap.  The receiver would
need to accept or reject the duplicate data in whole.<a href="#section-2.6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="verifying-external-destinations">
<section id="section-3">
      <h2 id="name-verifying-external-destinat">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-verifying-external-destinat" class="section-name selfRef">Verifying External Destinations</a>
      </h2>
<p id="section-3-1">It is possible to specify destinations for the different reports that
are outside the authority of the Domain Owner making the request.
This allows domains that do not operate mail servers to request
reports and have them go someplace that is able to receive and
process them.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Without checks, this would allow a bad actor to publish a DMARC
policy record that requests that reports be sent to a victim address,
and then send a large volume of mail that will fail both DKIM and SPF
checks to a wide variety of destinations; the victim will in turn be
flooded with unwanted reports.  Therefore, a verification mechanism
is included.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">When a Mail Receiver discovers a DMARC policy in the DNS, and the
Organizational Domain at which that record was discovered is not
identical to the Organizational Domain of the host part of the
authority component of a [URI] specified in the "rua" or "ruf" tag,
the following verification steps MUST be taken:<a href="#section-3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-4">
<li id="section-3-4.1">
          <p id="section-3-4.1.1">Extract the host portion of the authority component of the URI.
Call this the "destination host", as it refers to a Report
Receiver.<a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.2">
          <p id="section-3-4.2.1">Prepend the string "<em>report.</em>dmarc".<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.3">
          <p id="section-3-4.3.1">Prepend the domain name from which the policy was retrieved,
after conversion to an A-label if needed.<a href="#section-3-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.4">
          <p id="section-3-4.4.1">Query the DNS for a TXT record at the constructed name.  If the
result of this request is a temporary DNS error of some kind
(e.g., a timeout), the Mail Receiver MAY elect to temporarily
fail the delivery so the verification test can be repeated later.<a href="#section-3-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.5">
          <p id="section-3-4.5.1">For each record returned, parse the result as a series of
"tag=value" pairs, i.e., the same overall format as the policy
record (see Section 6.4).  In particular, the "v=DMARC1" tag is
mandatory and MUST appear first in the list.  Discard any that do
not pass this test.<a href="#section-3-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.6">
          <p id="section-3-4.6.1">If the result includes no TXT resource records that pass basic
parsing, a positive determination of the external reporting
relationship cannot be made; stop.<a href="#section-3-4.6.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.7">
          <p id="section-3-4.7.1">If at least one TXT resource record remains in the set after
parsing, then the external reporting arrangement was authorized
by the Report Receiver.<a href="#section-3-4.7.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.8">
          <p id="section-3-4.8.1">If a "rua" or "ruf" tag is thus discovered, replace the
corresponding value extracted from the domain's DMARC policy
record with the one found in this record.  This permits the
Report Receiver to override the report destination.  However, to
prevent loops or indirect abuse, the overriding URI MUST use the
same destination host from the first step.<a href="#section-3-4.8.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-3-5">For example, if a DMARC policy query for "blue.example.com" contained
"rua=mailto:reports@red.example.net", the host extracted from the
latter ("red.example.net") does not match "blue.example.com", so this
procedure is enacted.  A TXT query for
"blue.example.com.<em>report.</em>dmarc.red.example.net" is issued.  If a
single reply comes back containing a tag of "v=DMARC1", then the
relationship between the two is confirmed.  Moreover,
"red.example.net" has the opportunity to override the report
destination requested by "blue.example.com" if needed.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Where the above algorithm fails to confirm that the external
reporting was authorized by the Report Receiver, the URI MUST be
ignored by the Mail Receiver generating the report.  Further, if the
confirming record includes a URI whose host is again different than
the domain publishing that override, the Mail Receiver generating the
report MUST NOT generate a report to either the original or the
override URI.
A Report Receiver publishes such a record in its DNS if it wishes to
receive reports for other domains.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">A Report Receiver that is willing to receive reports for any domain
can use a wildcard DNS record.  For example, a TXT resource record at
"*.<em>report.</em>dmarc.example.com" containing at least "v=DMARC1"
confirms that example.com is willing to receive DMARC reports for any
domain.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">If the Report Receiver is overcome by volume, it can simply remove
the confirming DNS record.  However, due to positive caching, the
change could take as long as the time-to-live (TTL) on the record to
go into effect.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">A Mail Receiver might decide not to enact this procedure if, for
example, it relies on a local list of domains for which external
reporting addresses are permitted.<a href="#section-3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extensible-reporting">
<section id="section-4">
      <h2 id="name-extensible-reporting">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-extensible-reporting" class="section-name selfRef">Extensible Reporting</a>
      </h2>
<p id="section-4-1">A DMARC report should allow for some extensibility, as defined by
future documents that utilize DMARC as a foundation.  These extensions
MUST be properly formatted XML and meant to exist within the structure
of a DMARC report.  They MUST NOT alter the existing DMARC structure,
but instead exist self-contained within an <code>&lt;extensions&gt;</code> element. This
element MUST be a child of the <code>&lt;feedback&gt;</code> element.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">A DMARC report should allow for some extensibility, as defined by
future documents that utilize DMARC as a foundation.  These extensions
MUST be properly formatted XML and meant to exist within the structure
of a DMARC report.  Extensions MAY exist in one of two places; within
the <code>record</code> element, or in a separate <code>extensions</code> element under the
<code>feedback</code> element.  In either case, the extensions MUST contain a
URI to the definition of the extension so that the receiver understands
how to interpret the data.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">Within the <code>record</code> element:<a href="#section-4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-4">
<pre>...
  &lt;record&gt;
    &lt;row&gt;
    &lt;source_ip&gt;192.168.1.1&lt;/source_ip&gt;
    &lt;count&gt;15&lt;/count&gt;
    ...
    &lt;extensions&gt;
      &lt;extensionName definition="https://path/to/spec"&gt;
      ...
      &lt;/extensionName&gt;
    &lt;/extensions&gt;
  &lt;/record&gt;
...
</pre><a href="#section-4-4" class="pilcrow">¶</a>
</div>
<p id="section-4-5">Within the <code>feedback</code> element:<a href="#section-4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-6">
<pre>&lt;feedback&gt;
  ...
  &lt;extensions&gt;
    &lt;extensionName definition="https://path/to/spec"&gt;
      &lt;data&gt;...&lt;/data&gt;
    &lt;/extensionName&gt;
  &lt;/extensions&gt;
&lt;/feedback&gt;
</pre><a href="#section-4-6" class="pilcrow">¶</a>
</div>
<p id="section-4-7">In both cases "extensionName" should be replaced with an appropriate
single-word title.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">A DMARC report receiver SHOULD NOT generate a processing error when this
<code>&lt;extensions&gt;</code> element is absent or empty.  Furthermore, if a processor
is unable to handle an extension in a report, it SHOULD ignore the data,
and continue to the next extension.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">TBD<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-6">
      <h2 id="name-privacy-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-6-1">This section will discuss exposure related to DMARC aggregate reporting.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="data-exposure-considerations">
<section id="section-6.1">
        <h3 id="name-data-exposure-consideration">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-data-exposure-consideration" class="section-name selfRef">Data Exposure Considerations</a>
        </h3>
<p id="section-6.1-1">Aggregate reports are limited in scope to DMARC policy and
disposition results, to information pertaining to the underlying
authentication mechanisms, and to the identifiers involved in DMARC
validation.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Aggregate report may expose sender and recipient identifiers,
specifically the RFC5322.From addresses.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Domain Owners requesting reports will receive information about mail
claiming to be from them, which includes mail that was not, in fact,
from them.  Information about the final destination of mail where it
might otherwise be obscured by intermediate systems will therefore be
exposed.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">When message-forwarding arrangements exist, Domain Owners requesting
reports will also receive information about mail forwarded to domains
that were not originally part of their messages' recipient lists.
This means that destination domains previously unknown to the Domain
Owner may now become visible.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Disclosure of information about the messages is being requested by
the entity generating the email in the first place, i.e., the Domain
Owner and not the Mail Receiver, so this may not fit squarely within
existing privacy policy provisions.  For some providers, aggregate
reporting is viewed as a function similar to complaint reporting
about spamming or phishing and are treated similarly under the
privacy policy.  Report generators (i.e., Mail Receivers) are
encouraged to review their reporting limitations under such policies
before enabling DMARC reporting.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="report-recipients">
<section id="section-6.2">
        <h3 id="name-report-recipients">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-report-recipients" class="section-name selfRef">Report Recipients</a>
        </h3>
<p id="section-6.2-1">A DMARC record can specify that reports should be sent to an
intermediary operating on behalf of the Domain Owner.  This is done
when the Domain Owner contracts with an entity to monitor mail
streams for abuse and performance issues.  Receipt by third parties
of such data may or may not be permitted by the Mail Receiver's
privacy policy, terms of use, or other similar governing document.
Domain Owners and Mail Receivers should both review and understand if
their own internal policies constrain the use and transmission of
DMARC reporting.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Some potential exists for report recipients to perform traffic
analysis, making it possible to obtain metadata about the Receiver's
traffic.  In addition to verifying compliance with policies,
Receivers need to consider that before sending reports to a third
party.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-contained-within-reports-tkt64">
<section id="section-6.3">
        <h3 id="name-data-contained-within-repor">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-data-contained-within-repor" class="section-name selfRef">Data Contained Within Reports (Tkt64)</a>
        </h3>
<p id="section-6.3-1">Aggregate feedback reports contain aggregated data relating to
messages purportedly originating from the Domain Owner. The data
does not contain any identifying characteristics about individual
users. No personal information such as individual email addresses,
IP addresses of individuals, or the content of any messages, is
included in reports.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Mail Receivers should have no concerns in sending reports as they
do not contain personal information. In all cases, the data within
the reports relates to the domain-level authentication information
provided by mail servers sending messages on behalf of the Domain
Owner. This information is necessary to assist Domain Owners in
implementing and maintaining DMARC.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">Domain Owners should have no concerns in receiving reports as
they do not contain personal information. The reports only contain
aggregated data related to the domain-level authentication details
of messages claiming to originate from their domain. This information
is essential for the proper implementation and operation of DMARC.
Domain Owners who are unable to receive reports for organizational
reasons, can choose to exclusively direct the reports to an
external processor.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">TBD<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="appendix-a-dmarc-xml-schema">
<section id="section-8">
      <h2 id="name-appendix-a-dmarc-xml-schema">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-appendix-a-dmarc-xml-schema" class="section-name selfRef">Appendix A. DMARC XML Schema</a>
      </h2>
<div id="section-8-1">
<pre class="lang-xsd sourcecode">&lt;?xml version="1.0"?&gt;
&lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
  targetNamespace="http://dmarc.org/dmarc-xml/0.2"&gt;

&lt;!-- The time range in UTC covered by messages in this report,
     specified in seconds since epoch. --&gt;
&lt;xs:complexType name="DateRangeType"&gt;
  &lt;xs:all&gt;
    &lt;xs:element name="begin" type="xs:integer"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;xs:element name="end" type="xs:integer"
                minOccurs="1" maxOccurs="1"/&gt;
  &lt;/xs:all&gt;
&lt;/xs:complexType&gt;


&lt;!-- Report generator metadata. --&gt;
&lt;!--
  org_name: Reporting Organization
  email: Contact to be used when contacting
         the Reporting Organization
  extra_contact_info: Additional contact details
  report_id: UUID, specified elsewhere
  date_range: Timestamps used when forming report data
  error: ?
--&gt;
&lt;xs:complexType name="ReportMetadataType"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="org_name" type="xs:string"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;xs:element name="email" type="xs:string"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;xs:element name="extra_contact_info" type="xs:string"
                minOccurs="0" maxOccurs="1"/&gt;
    &lt;xs:element name="report_id" type="xs:string"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;xs:element name="date_range" type="DateRangeType"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;xs:element name="error" type="xs:string"
                minOccurs="0" maxOccurs="unbounded"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;

&lt;!-- Alignment mode (relaxed or strict) for DKIM and SPF. --&gt;
&lt;xs:simpleType name="AlignmentType"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:enumeration value="r"/&gt;
    &lt;xs:enumeration value="s"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;!-- The policy actions specified by p and sp in the
     DMARC record. --&gt;
&lt;xs:simpleType name="DispositionType"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:enumeration value="none"/&gt;
    &lt;xs:enumeration value="quarantine"/&gt;
    &lt;xs:enumeration value="reject"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;!-- The policy actions utilized on messages for this record. --&gt;
&lt;!--
     "none": No action taken
     "pass": No action, passing DMARC w/enforcing policy
     "quarantine": Failed DMARC, message marked for quarantine
     "reject": Failed DMARC, marked as reject
--&gt;
&lt;xs:simpleType name="ActionDispositionType"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:enumeration value="none"/&gt;
    &lt;xs:enumeration value="pass"/&gt;
    &lt;xs:enumeration value="quarantine"/&gt;
    &lt;xs:enumeration value="reject"/&gt;
  &lt;/xs:restriction&gt;

&lt;!-- The DMARC policy that is published by the sending domain
  in this report. --&gt;
&lt;xs:complexType name="PolicyPublishedType"&gt;
  &lt;xs:all&gt;
    &lt;!-- The domain at which the DMARC record was found. --&gt;
    &lt;xs:element name="domain" type="xs:string"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- The version declared in the DMARC record found. --&gt;
    &lt;xs:element name="version_published" type="xs:decimal"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- The DKIM alignment mode. --&gt;
    &lt;xs:element name="adkim" type="AlignmentType"
                minOccurs="0" maxOccurs="1"/&gt;
    &lt;!-- The SPF alignment mode. --&gt;
    &lt;xs:element name="aspf" type="AlignmentType"
                minOccurs="0" maxOccurs="1"/&gt;
    &lt;!-- The policy published for messages from the domain. --&gt;
    &lt;xs:element name="p" type="DispositionType"
                minOccurs="0" maxOccurs="1"/&gt;
    &lt;!-- The policy published for messages from subdomains. --&gt;
    &lt;xs:element name="sp" type="DispositionType"
                minOccurs="0" maxOccurs="1"/&gt;
    &lt;!-- The percent declared in the DMARC record --&gt;
    &lt;xs:element name="testing" type="TestingType"
                minOccurs="0" maxOccurs="1"/&gt;
    &lt;!-- Failure reporting options in effect. --&gt;
    &lt;xs:element name="fo" type="xs:string"
                minOccurs="0" maxOccurs="1"/&gt;
  &lt;/xs:all&gt;
&lt;/xs:complexType&gt;

&lt;!-- Values for Testing mode attached to Policy --&gt;
&lt;xs:simpleType name="TestingType"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:enumeration value="n"/&gt;
    &lt;xs:enumeration value="y"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;!-- The DMARC-aligned authentication result. --&gt;
&lt;xs:simpleType name="DMARCResultType"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:enumeration value="pass"/&gt;
    &lt;xs:enumeration value="fail"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;!-- Reasons that may affect DMARC disposition or execution
     thereof. --&gt;
&lt;xs:simpleType name="PolicyOverrideType"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:enumeration value="forwarded"/&gt;
    &lt;xs:enumeration value="sampled_out"/&gt;
    &lt;xs:enumeration value="trusted_forwarder"/&gt;
    &lt;xs:enumeration value="mailing_list"/&gt;
    &lt;xs:enumeration value="local_policy"/&gt;
    &lt;xs:enumeration value="other"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;!-- How do we allow report generators to include new
     classes of override reasons if they want to be more
     specific than "other"? --&gt;
&lt;xs:complexType name="PolicyOverrideReason"&gt;
  &lt;xs:all&gt;
    &lt;xs:element name="type" type="PolicyOverrideType"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;xs:element name="comment" type="xs:string"
                minOccurs="0" maxOccurs="1"/&gt;
  &lt;/xs:all&gt;
&lt;/xs:complexType&gt;

&lt;!-- Taking into account everything else in the record,
  the results of applying DMARC. If alignment fails
  and the policy applied does not match the domain's
  configured policy, the reason element MUST be specified  --&gt;

&lt;xs:complexType name="PolicyEvaluatedType"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="disposition" type="ActionDispositionType"/&gt;
    &lt;xs:element name="dkim" type="DMARCResultType"/&gt;
    &lt;xs:element name="spf" type="DMARCResultType"/&gt;
    &lt;xs:element name="reason" type="PolicyOverrideReason"
                minOccurs="0" maxOccurs="unbounded"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;

&lt;!-- Credit to Roger L. Costello for IPv4 regex
     http://mailman.ic.ac.uk/pipermail/xml-dev/1999-December/
          018018.html --&gt;
&lt;!-- Credit to java2s.com for IPv6 regex
     http://www.java2s.com/Code/XML/XML-Schema/
          IPv6addressesareeasiertodescribeusingasimpleregex.htm --&gt;
&lt;xs:simpleType name="IPAddress"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:pattern value="((1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]).){3}
                (1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])|
                ([A-Fa-f0-9]{1,4}:){7}[A-Fa-f0-9]{1,4}"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;xs:complexType name="RowType"&gt;
  &lt;xs:all&gt;
    &lt;!-- The connecting IP. --&gt;
    &lt;xs:element name="source_ip" type="IPAddress"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- The number of messages for which the
    PolicyEvaluatedType was applied. --&gt;
    &lt;xs:element name="count" type="xs:integer"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- The DMARC disposition applied to matching
         messages. --&gt;
    &lt;xs:element name="policy_evaluated"
                type="PolicyEvaluatedType"
                minOccurs="1" maxOccurs="1"/&gt;
  &lt;/xs:all&gt;
&lt;/xs:complexType&gt;

&lt;xs:complexType name="IdentifierType"&gt;
  &lt;xs:all&gt;
    &lt;!-- The envelope recipient domain. --&gt;
    &lt;xs:element name="envelope_to" type="xs:string"
                minOccurs="0"/&gt;
    &lt;!-- The RFC5321.MailFrom domain. --&gt;
    &lt;xs:element name="envelope_from" type="xs:string"
                minOccurs="1"/&gt;
    &lt;!-- The RFC5322.From domain. --&gt;
    &lt;xs:element name="header_from" type="xs:string"
                minOccurs="1"/&gt;
  &lt;/xs:all&gt;
&lt;/xs:complexType&gt;

&lt;!-- DKIM verification result, according to RFC 7001
     Section 2.6.1. --&gt;
&lt;xs:simpleType name="DKIMResultType"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:enumeration value="none"/&gt;
    &lt;xs:enumeration value="pass"/&gt;
    &lt;xs:enumeration value="fail"/&gt;
    &lt;xs:enumeration value="policy"/&gt;
    &lt;xs:enumeration value="neutral"/&gt;
    &lt;xs:enumeration value="temperror"/&gt;
    &lt;xs:enumeration value="permerror"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;xs:complexType name="DKIMAuthResultType"&gt;
  &lt;xs:all&gt;
    &lt;!-- The "d=" parameter in the signature. --&gt;
    &lt;xs:element name="domain" type="xs:string"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- The "s=" parameter in the signature. --&gt;
    &lt;xs:element name="selector" type="xs:string"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- The DKIM verification result. --&gt;
    &lt;xs:element name="result" type="DKIMResultType"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- Any extra information (e.g., from
         Authentication-Results). --&gt;
    &lt;xs:element name="human_result" type="xs:string"
                minOccurs="0" maxOccurs="1"/&gt;
  &lt;/xs:all&gt;
&lt;/xs:complexType&gt;

&lt;!-- SPF domain scope. --&gt;
&lt;xs:simpleType name="SPFDomainScope"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:enumeration value="helo"/&gt;
    &lt;xs:enumeration value="mfrom"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;!-- SPF result. --&gt;
&lt;xs:simpleType name="SPFResultType"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;xs:enumeration value="none"/&gt;
    &lt;xs:enumeration value="neutral"/&gt;
    &lt;xs:enumeration value="pass"/&gt;
    &lt;xs:enumeration value="fail"/&gt;
    &lt;xs:enumeration value="softfail"/&gt;
    &lt;!-- "TempError" commonly implemented as "unknown". --&gt;
    &lt;xs:enumeration value="temperror"/&gt;
    &lt;!-- "PermError" commonly implemented as "error". --&gt;
    &lt;xs:enumeration value="permerror"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;xs:complexType name="SPFAuthResultType"&gt;
  &lt;xs:all&gt;
    &lt;!-- The checked domain. --&gt;
    &lt;xs:element name="domain" type="xs:string"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- The scope of the checked domain. --&gt;
    &lt;xs:element name="scope" type="SPFDomainScope"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- The SPF verification result. --&gt;
    &lt;xs:element name="result" type="SPFResultType"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;!-- Any extra information
       (e.g., from Authentication-Results).
    The information in the field below should be for a
      person to be provided with additional information
      that may be useful when debugging SPF authentication
      issues.  This could include broken records, invalid
      DNS responses, etc.
    --&gt;
    &lt;xs:element name="human_result" type="xs:string"
                minOccurs="0" maxOccurs="1"/&gt;
  &lt;/xs:all&gt;
&lt;/xs:complexType&gt;

&lt;!-- This element contains DKIM and SPF results, uninterpreted
     with respect to DMARC. --&gt;
&lt;xs:complexType name="AuthResultType"&gt;
  &lt;xs:sequence&gt;
    &lt;!-- There may be no DKIM signatures, or multiple DKIM
         signatures. --&gt;
    &lt;xs:element name="dkim" type="DKIMAuthResultType"
                minOccurs="0" maxOccurs="unbounded"/&gt;
    &lt;!-- There will always be at least one SPF result. --&gt;
    &lt;xs:element name="spf" type="SPFAuthResultType" minOccurs="1"
                maxOccurs="unbounded"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;

&lt;!-- This element contains all the authentication results that
     were evaluated by the receiving system for the given set of
     messages. --&gt;
&lt;xs:complexType name="RecordType"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="row" type="RowType"/&gt;
    &lt;xs:element name="identifiers" type="IdentifierType"
                minOccurs="1" maxOccurs="1"/&gt;
    &lt;xs:element name="auth_results" type="AuthResultType"
                minOccurs="1" maxOccurs="1"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;


&lt;!--
version: Version of the report format
--&gt;
&lt;!-- Parent --&gt;
&lt;xs:element name="feedback"&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element name="version"
                  minOccurs="0" maxOccurs="1" type="xs:decimal"/&gt;
      &lt;xs:element name="report_metadata"
                  minOccurs="1" maxOccurs="1"
                  type="ReportMetadataType"/&gt;
      &lt;xs:element name="policy_published"
                  minOccurs="1" maxOccurs="1"
                  type="PolicyPublishedType"/&gt;
      &lt;xs:element name="record" type="RecordType"
                  minOccurs="1" maxOccurs="unbounded"/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;
&lt;/xs:schema&gt;
</pre><a href="#section-8-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="appendix-b-sample-report">
<section id="section-9">
      <h2 id="name-appendix-b-sample-report">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-appendix-b-sample-report" class="section-name selfRef">Appendix B. Sample Report</a>
      </h2>
<div class="alignLeft art-text artwork" id="section-9-1">
<pre>&lt;feedback&gt;
  &lt;report_metadata&gt;
    &lt;version&gt;2.0&lt;/version&gt;
    &lt;org_name&gt;Sample Reporter&lt;/org_name&gt;
    &lt;email&gt;report_sender@example-reporter.com&lt;/email&gt;
    &lt;extra_contact_info&gt;...&lt;/export_contact_info&gt;
    &lt;report_id&gt;3v98abbp8ya9n3va8yr8oa3ya&lt;/report_id&gt;
    &lt;date_range&gt;
      &lt;begin&gt;161212415&lt;/begin&gt;
      &lt;end&gt;161221511&lt;/end&gt;
    &lt;/date_range&gt;
  &lt;/report_metadata&gt;
  &lt;policy_published&gt;
    &lt;domain&gt;example.com&lt;/domain&gt;
    &lt;p&gt;quarantine&lt;/p&gt;
    &lt;sp&gt;none&lt;/sp&gt;
    &lt;testing&gt;n&lt;/testing&gt;
  &lt;/policy_published&gt;
  &lt;record&gt;
    &lt;row&gt;
      &lt;source_ip&gt;192.168.4.4&lt;/source_ip&gt;
      &lt;count&gt;123&lt;/count&gt;
      &lt;policy_evaluated&gt;
        &lt;disposition&gt;quarantine&lt;/disposition&gt;
        &lt;dkim&gt;pass&lt;/dkim&gt;
        &lt;spf&gt;fail&lt;/spf&gt;
      &lt;/policy_evaluated&gt;
    &lt;/row&gt;
    &lt;identifiers&gt;
      &lt;header_from&gt;example.com&lt;/header_from&gt;
    &lt;/identifiers&gt;
    &lt;auth_results&gt;
      &lt;dkim&gt;
        &lt;domain&gt;example.com&lt;/domain&gt;
        &lt;result&gt;pass&lt;/result&gt;
        &lt;selector&gt;abc123&lt;/selector&gt;
      &lt;/dkim&gt;
      &lt;spf&gt;
        &lt;domain&gt;example.com&gt;
        &lt;result&gt;fail&lt;/result&gt;
      &lt;/spf&gt;
    &lt;/auth_results&gt;
    &lt;extensions&gt;
    &lt;/extensions&gt;
  &lt;/record&gt;
  &lt;extensions&gt;
  &lt;/extensions&gt;
&lt;/feedback&gt;

</pre><a href="#section-9-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC6376">[RFC6376]</dt>
      <dd>
<span class="refAuthor">Crocker, D., Ed.</span>, <span class="refAuthor">Hansen, T., Ed.</span>, and <span class="refAuthor">M. Kucherawy, Ed.</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) Signatures"</span>, <span class="seriesInfo">STD 76</span>, <span class="seriesInfo">RFC 6376</span>, <span class="seriesInfo">DOI 10.17487/RFC6376</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6376">https://www.rfc-editor.org/info/rfc6376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7208">[RFC7208]</dt>
    <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1"</span>, <span class="seriesInfo">RFC 7208</span>, <span class="seriesInfo">DOI 10.17487/RFC7208</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7208">https://www.rfc-editor.org/info/rfc7208</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alex Brotman</span></div>
<div dir="auto" class="left"><span class="org">Comcast, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:alex_brotman@comcast.com" class="email">alex_brotman@comcast.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
