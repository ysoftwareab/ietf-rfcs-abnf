V = M(s, H(p))

P = H(p) XOR M(s + SV + Us + AZ + AU + Uc, V)

client-msg-1     = [authorize-id] NUL authenticate-id NUL client-nonce

server-msg-1     = salt server-id NUL server-nonce

client-msg-2     = proof

server-msg-2     = mutual-auth

passphrase       = 8*UTF8-SAFE
                        ;; At least 64 octets MUST be supported


authorize-id     = *UTF8-PRINT
                        ;; No more than 255 octets

authenticate-id  = *UTF8-PRINT
                        ;; No more than 255 octets

server-id        = service-name "." server-domain
                        "@" [ server-ext-data ]
                        ;; No more that 511 octets total

service-name     = *USASCII-PRINT
                        ;; a GSSAPI service name

server-domain    = *USASCII-PRINT
                        ;; an internet domain name

server-ext-data  = *UTF8-SAFE
                        ;; extension data

server-id        = *UTF8-PRINT
                        ;; No more than 511 octets
client-nonce     = 8*256OCTET

server-nonce     = 8*32OCTET

salt             = 8OCTET

proof            = 20OCTET

mutual-auth      = 20OCTET

NUL              = %x00  ;; US-ASCII NUL character

US-ASCII-SAFE    = %x01-09 / %x0B-0C / %x0E-7F
                       ;; US-ASCII except CR, LF, NUL

US-ASCII-PRINT   = %x20-7E
                       ;; printable US-ASCII including SPACE

UTF8-SAFE        = US-ASCII-SAFE / UTF8-1 / UTF8-2 / UTF8-3
                          / UTF8-4 / UTF8-5

UTF8-PRINT      = US-ASCII-PRINT / UTF8-1 / UTF8-2 / UTF8-3
                          / UTF8-4 / UTF8-5

UTF8-CONT        = %x80..BF

UTF8-1           = %xC0..DF UTF8-CONT

UTF8-2           = %xE0..EF 2UTF8-CONT

UTF8-3           = %xF0..F7 3UTF8-CONT

UTF8-4           = %xF8..FB 4UTF8-CONT

UTF8-5           = %xFC..FD 5UTF8-CONT


