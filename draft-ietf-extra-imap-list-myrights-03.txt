



EXTRA                                                       K. Murchison
Internet-Draft                                               B. Gondwana
Intended status: Standards Track                                FastMail
Expires: October 19, 2018                                 April 17, 2018


  IMAP4 Extension for Returning MYRIGHTS Information in Extended LIST
                 draft-ietf-extra-imap-list-myrights-03

Abstract

   This document defines an extension to the to IMAP LIST command that
   allows the client to request the set of rights that the logged-in
   user has been granted on mailboxes, along with other information
   typically returned by the LIST command.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on October 19, 2018.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




Murchison & Gondwana    Expires October 19, 2018                [Page 1]

Internet-Draft             IMAP LIST-MYRIGHTS                 April 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions Used in This Document . . . . . . . . . . . . . .   2
   3.  MYRIGHTS Return Option to LIST Command  . . . . . . . . . . .   2
   4.  Examples  . . . . . . . . . . . . . . . . . . . . . . . . . .   3
   5.  Formal Syntax . . . . . . . . . . . . . . . . . . . . . . . .   4
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   4
   7.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .   4
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
     8.1.  Registration of IMAP capability LIST-MYRIGHTS . . . . . .   4
     8.2.  Registration of LIST-EXTENDED option MYRIGHTS . . . . . .   4
   9.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   5
   10. Normative References  . . . . . . . . . . . . . . . . . . . .   5
   Appendix A.  Change History (To be removed by RFC Editor before
                publication) . . . . . . . . . . . . . . . . . . . .   6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   6

1.  Introduction

   IMAP clients typically fetch the set of rights granted on mailboxes
   so they can expose the allowed functionality to the logged-in user.
   In order to do that, the client is forced to issue a LIST or LSUB
   command to list all available mailboxes, followed by a MYRIGHTS
   command for each mailbox found.  This document defines an extension
   to the to IMAP LIST command that is identified by the capability
   string "LIST-MYRIGHTS".  The LIST-MYRIGHTS extension allows the
   client to request the set of rights that the logged-in user has been
   granted on mailboxes, along with other information typically returned
   by the LIST command.

2.  Conventions Used in This Document

   In examples, "C:" indicates lines sent by a client that is connected
   to a server.  "S:" indicates lines sent by the server to the client.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [RFC2119].

3.  MYRIGHTS Return Option to LIST Command

   [RFC4314] defines the MYRIGHTS command which is used by an IMAP
   client to determine the set of rights that the logged-in user has
   been granted on a given mailbox.  Frequently, a client will have to
   look up the rights for some or all of the mailboxes returned by the
   LIST command.  Doing so in multiple MYRIGHTS commands wastes



Murchison & Gondwana    Expires October 19, 2018                [Page 2]

Internet-Draft             IMAP LIST-MYRIGHTS                 April 2018


   bandwidth and can degrade performance if the client does not pipeline
   the requests.

   This document extends the LIST command with a new return option,
   "MYRIGHTS", which allows the client to request all of the desired
   information in a single command.  For each listable mailbox matching
   the list pattern and selection options, the server MUST return an
   untagged LIST response and SHOULD also return an untagged MYRIGHTS
   response containing the set of rights granted to the logged-in user.
   The ordering of the responses is significant only in that the server
   MUST NOT send a MYRIGHTS response for a given mailbox before it sends
   the LIST response for that mailbox.

   If the server is unable to look up the set of rights for a given
   mailbox, it does not send the MYRIGHTS reply for that mailbox.

   Client authors ought to note that generating the MYRIGHTS responses
   for a large number of mailboxes may be an expensive operation for the
   server.  Clients SHOULD use a suitable match pattern and/or selection
   option to limit the set of mailboxes returned to only those whose
   rights in which they are interested.

4.  Examples

   In this example the "bar" mailbox doesn't exist, so it has no
   MYRIGHTS reply.

   C: A01 LIST "" % RETURN (MYRIGHTS)
   S: * LIST () "." "INBOX"
   S: * MYRIGHTS "INBOX" lrswipkxtecda
   S: * LIST () "." "foo"
   S: * MYRIGHTS "foo" lrs
   S: * LIST (\NonExistent) "." "bar"
   S: A01 OK List completed.

   In this example the LIST reply for the "foo" mailbox is returned
   because it has matching children, but no MYRIGHTS reply is returned
   because "foo" itself doesn't match the selection criteria.

   C: A02 LIST (SUBSCRIBED RECURSIVEMATCH) "" % RETURN (MYRIGHTS)
   S: * LIST (\Subscribed) "." "INBOX"
   S: * MYRIGHTS "INBOX" lrswipkxtecda
   S: * LIST () "." "foo" (CHILDINFO ("SUBSCRIBED"))
   S: A02 OK List completed.







Murchison & Gondwana    Expires October 19, 2018                [Page 3]

Internet-Draft             IMAP LIST-MYRIGHTS                 April 2018


5.  Formal Syntax

   The following syntax specification uses the augmented Backus-Naur
   Form (BNF) as described in [RFC5234].  Terms not defined here are
   taken from [RFC5258].

   return-option =/ "MYRIGHTS"

6.  Security Considerations

   This extension makes it a bit easier for clients to overload the
   server by requesting MYRIGHTS information for a large number of
   mailboxes.  However, as already noted in the introduction, existing
   clients already try to do that by generating a large number of
   MYRIGHTS commands for each mailbox in which they are interested.
   While performing MYRIGHTS information retrieval for big lists of
   mailboxes, a server implementation needs to make sure that it can
   still serve other IMAP connections and yield execution to other
   connections, when necessary.

7.  Privacy Considerations

   This specification does not introduce any additional privacy concerns
   beyond those described in [RFC4314].

8.  IANA Considerations

8.1.  Registration of IMAP capability LIST-MYRIGHTS

   This document defines the "LIST-MYRIGHTS" IMAP capability to be added
   to the "IMAP Capabilities" registry:
   <https://www.iana.org/assignments/imap-capabilities/imap-
   capabilities.xhtml#imap-capabilities-1>.

8.2.  Registration of LIST-EXTENDED option MYRIGHTS

   This section registers the "MYRIGHTS" option to be added to the
   "LIST-EXTENDED options" registry: <https://www.iana.org/assignments/
   imap-list-extended/imap-list-extended.xhtml#imap-list-extended-1>.

   LIST-EXTENDED option name:  MYRIGHTS

   LIST-EXTENDED option type:  RETURN

   LIST-EXTENDED option description:  Causes the LIST command to return
      MYRIGHTS responses in addition to LIST responses.

   Published specification:  RFC XXXX, Section 3



Murchison & Gondwana    Expires October 19, 2018                [Page 4]

Internet-Draft             IMAP LIST-MYRIGHTS                 April 2018


   Security considerations:  RFC XXXX, Section 6

   Intended usage:  COMMON

   Person and email address to contact for further
                           information:
      Kenneth Murchison <murch@fastmail.com>

   Owner/Change controller:  IESG <iesg@ietf.org>

9.  Acknowledgments

   This document is based largely on RFC5819.  The authors would like to
   thank the authors of that document for providing both inspiration and
   some borrowed text for this document.  The authors would also like to
   thank the following individuals for contributing their ideas and
   support for writing this specification: Barry Leiba.

10.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC3501]  Crispin, M., "INTERNET MESSAGE ACCESS PROTOCOL - VERSION
              4rev1", RFC 3501, DOI 10.17487/RFC3501, March 2003,
              <https://www.rfc-editor.org/info/rfc3501>.

   [RFC4314]  Melnikov, A., "IMAP4 Access Control List (ACL) Extension",
              RFC 4314, DOI 10.17487/RFC4314, December 2005,
              <https://www.rfc-editor.org/info/rfc4314>.

   [RFC5234]  Crocker, D., Ed. and P. Overell, "Augmented BNF for Syntax
              Specifications: ABNF", STD 68, RFC 5234,
              DOI 10.17487/RFC5234, January 2008,
              <https://www.rfc-editor.org/info/rfc5234>.

   [RFC5258]  Leiba, B. and A. Melnikov, "Internet Message Access
              Protocol version 4 - LIST Command Extensions", RFC 5258,
              DOI 10.17487/RFC5258, June 2008,
              <https://www.rfc-editor.org/info/rfc5258>.









Murchison & Gondwana    Expires October 19, 2018                [Page 5]

Internet-Draft             IMAP LIST-MYRIGHTS                 April 2018


Appendix A.  Change History (To be removed by RFC Editor before
             publication)

   Changes from draft-ietf-extra-imap-list-myrights-02:

   o  WGLC editorial changes from Barry Leiba.

   Changes from draft-ietf-extra-imap-list-myrights-01:

   o  Removed 'n' right from example.

   o  Added advice to client authors regarding expense of calculating
      MYRIGHTS.

   o  Replicated Security Considerations section from RFC 5819.

   Changes from draft-ietf-extra-imap-list-myrights-00:

   o  Corrected contact email address in IANA registration.

   o  Fixed typos (extra SP) in examples.

   Changes from draft-murchison-imap-list-myrights-01:

   o  Renamed document to be a work product of the EXTRA WG.

   o  Updated authors' addresses.

   Changes from draft-murchison-imap-list-myrights-00:

   o  Augmented Introduction with mention of "LIST-MYRIGHTS" capability
      string.

   o  Minor editorial changes.

Authors' Addresses

   Kenneth Murchison
   FastMail Pty Ltd
   Level 2, 114 William Street
   Melbourne, VIC  3000
   Australia

   Email: murch@fastmailteam.com







Murchison & Gondwana    Expires October 19, 2018                [Page 6]

Internet-Draft             IMAP LIST-MYRIGHTS                 April 2018


   Bron Gondwana
   FastMail Pty Ltd
   Level 2, 114 William Street
   Melbourne, VIC  3000
   Australia

   Email: brong@fastmailteam.com












































Murchison & Gondwana    Expires October 19, 2018                [Page 7]
