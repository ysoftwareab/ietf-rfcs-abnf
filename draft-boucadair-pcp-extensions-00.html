<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Some Extensions to Port Control Protocol (PCP)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 DESCRIPTION">
<link href="#rfc.section.3" rel="Chapter" title="3 DSCP_POLICY">
<link href="#rfc.section.4" rel="Chapter" title="4 CAPABILITY">
<link href="#rfc.section.5" rel="Chapter" title="5 PERCEIVED_ADDRESS">
<link href="#rfc.section.6" rel="Chapter" title="6 SCOPE">
<link href="#rfc.section.7" rel="Chapter" title="7 REPORT">
<link href="#rfc.section.8" rel="Chapter" title="8 CLIENT_IDENTIFIER">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 IANA Considerations">
<link href="#rfc.section.11" rel="Chapter" title="11 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="12 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document extends Port Control Protocol (PCP) with some useful features." />
  <meta name="description" content="This document extends Port Control Protocol (PCP) with some useful features." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">M. Boucadair</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">France Telecom</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">R. Penno</td>
</tr>
<tr>
<td class="left">Expires: November 20, 2011</td>
<td class="right">Juniper Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. Wing</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">May 19, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Some Extensions to Port Control Protocol (PCP)<br />
  <span class="filename">draft-boucadair-pcp-extensions-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document extends Port Control Protocol (PCP) with some useful features.</p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on November 20, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">DESCRIPTION</a>
</li>
<li>3.   <a href="#rfc.section.3">DSCP_POLICY</a>
</li>
<li>4.   <a href="#rfc.section.4">CAPABILITY</a>
</li>
<li>5.   <a href="#rfc.section.5">PERCEIVED_ADDRESS</a>
</li>
<li>6.   <a href="#rfc.section.6">SCOPE</a>
</li>
<li>7.   <a href="#rfc.section.7">REPORT</a>
</li>
<li>8.   <a href="#rfc.section.8">CLIENT_IDENTIFIER</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">IANA Considerations</a>
</li>
<li>11.   <a href="#rfc.section.11">Acknowledgements</a>
</li>
<li>12.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This document extends the <a href="#I-D.ietf-pcp-base">base PCP protocol</a> <cite title="NONE">[I-D.ietf-pcp-base]</cite> with various PCP Options.</p>
<p id="rfc.section.1.p.2">Some of these options may be defined as new PCP OpCodes. </p>
<p id="rfc.section.1.p.3">The main goal of this document is to kick-off discussions on the need to define some useful PCP options which are not part of base PCP.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> DESCRIPTION</h1>
<p id="rfc.section.2.p.1">This option (Code TBA, <a href="#desc">Figure 1</a>) MAY be included in a PCP MAPx request to include a description associated with a requested mapping. This option is optional to be supported by PCP Servers and PCP Clients. The maximum length SHOULD be a configurable option in the PCP Server. If a PCP Client includes a Description PCP option with a length exceeding the maximum length supported by the PCP Server, only the portion of the Description field fitting that maximum length is stored by the PCP Server.</p>
<p id="rfc.section.2.p.2">This option can be used by a user to indicate a description associated with a given mapping such as "My mapping for my FTP server" or "My remote access to my CP router", etc. In addition, in the some deployment scenarios, this field can be used for troubleshooting purposes and can be used to convey values as the ones listed hereafter:</p>

<ul>
<li>"This is the mapping for my specific IPsec implementation"</li>
<li>"This is the mapping for subscriber bob@example.com"</li>
<li>"This is the mapping for special subscriber adsl-line-1234@example.com"</li>
<li>"This is the mapping that failed before due to XYZ"</li>
</ul>
<p id="rfc.section.2.p.3">Issues related to the usage of this field for troubleshooting or for any further usage are out of scope of this document.</p>
<div id="#rfc.figure.1"></div>
<div id="#desc"></div>
<p></p>

<p></p>
<pre>      
     This Option:

         Name: Description Option (DESCRIPTION)

         Number: TBA (IANA)

         Purpose: Used to associate a text description with a mapping 

         is valid for OpCodes: MAP4, MAP6

         Length: Variable (multiple of 4)

         May appear in: both request and response

         Maximum occurrences: 1

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | DESCRIPTION   |  Reserved     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Description                         |
   :                                                               :
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p></p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> DSCP_POLICY</h1>
<p id="rfc.section.3.p.1">In some scenarios, the DSCP marking in the internal interface (i.e., customer-facing interface) and the external one (i.e., Internet-facing interface) of the PCP-controlled device may be distinct. A Service Provider MAY allow its customers to configure their DSCP marking policies in an upstream device. Distinct DSCP marking policies can be implemented in the internal and external sides of the PCP-controlled device. A PCP Client MAY issue a PCP MAPx request indicating its internal DS code point and the external DSCP value. Instructed forwarding policies are applied only for packets marked with a given DSCP value.</p>
<p id="rfc.section.3.p.2">A Service Provider may not support DSCP re-marking feature and adopt a transparent scheme to QoS policy enforcement, that is, not controllable by subscribers. Generic QoS enforcement policies can be enforced for all customers: such as leave DSCP field values unchanged.</p>
<p id="rfc.section.3.p.3">This option (Code TBA, <a href="#dscp">Figure 2</a>) allows to:</p>

<ul>
<li>Re-write any DSCP value to a specific value;</li>
<li>Re-write a specific DSCP value to another specific value.</li>
</ul>
<div id="#rfc.figure.2"></div>
<div id="#dscp"></div>
<p></p>

<p></p>
<pre>         
      This Option:

         Name: PCP DSCP Marking Policy Option (DSCP_POLICY)

         Number: TBA (IANA)

         Purpose: Associated a DSCP re-marking policy with a mapping 

         is valid for OpCodes: MAP4, MAP6

         Length: 0x04

         May appear in: both request and response

         Maximum occurrences: none

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  DSCP_POLICY  |  Reserved     |            0x04               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |DIR| Int DSCP  | Ext DSCP  |         00...00                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

     DIR     : Indicates the direction: 
               0  for Inbound
               1  for Outbound
               2  for Both
     Int DSCP: Indicates the DSCP value in the customer-faced interface.
               0x3F is used to indicate ANY value. 
     Ext DSCP: Indicates the DSCP value in the Internet-faced interface.
               0x3F is used to indicate ANY value.

</pre>
<p></p>
<p></p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#capability_ie" id="capability_ie">CAPABILITY</a>
</h1>
<p id="rfc.section.4.p.1">The CAPABILITY option (Code: TBA, <a href="#capability">Figure 3</a>) is used by a PCP Server to indicate to a requesting PCP Client the capabilities it supports with regards to port forwarding operations.  Several Capability options MAY be conveyed in the same PCP response message if several functions are co-located in the same PCP-controlled device (e.g., NAT44 and NAT64, NAT44 and ports set assignment capability, etc.).</p>
<p id="rfc.section.4.p.2">This option, when received from a PCP Server, is used by a PCP Client to constraint the content of its requests and therefore avoid errors.  </p>
<div id="#rfc.figure.3"></div>
<div id="#capability"></div>
<p></p>

<p></p>
<pre>         
      This Option:

         Name: PCP Capabilities Option (CAPABILITY)

         Number: TBA (IANA)

         Purpose: Retrieve the capabilities of a PCP-controlled device 

         is valid for OpCodes: can be returned in a error message

         Length: 0x04

         May appear in: both request and response

         Maximum occurrences: None

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | CAPABILITY    |  Reserved     |            0x04               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |F T P A S C I O|              00...00                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre>
<p></p>
<p id="rfc.section.4.p.4">Below is provided a description of the F, T, P, A, S, C, I and O bits:</p>
<div id="#rfc.table.1"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="center">Name</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">F</td>
<td class="left">This bit indicates the address family of the source address issued by internal hosts</td>
</tr>
<tr>
<td class="center">T</td>
<td class="left">This bit indicates the address family of the source address of the packets forwarded in the external side of the PCP-controlled device</td>
</tr>
<tr>
<td class="center">P</td>
<td class="left">This bit indicates whether the source port number is translated or not.</td>
</tr>
<tr>
<td class="center">A</td>
<td class="left">This bit indicates whether the source IP address is translated or not.</td>
</tr>
<tr>
<td class="center">S</td>
<td class="left">This bit indicates whether the controlled device supports the ability to assign a set or ports</td>
</tr>
<tr>
<td class="center">C</td>
<td class="left">This bit indicates whether the PCP-controlled devices inspects the received packets and if it can block them</td>
</tr>
<tr>
<td class="center">I</td>
<td class="left">This bit indicates whether incoming packets are rejected unless an explicit rule is enforced in the PCP-controlled device</td>
</tr>
<tr>
<td class="center">O</td>
<td class="left">This bit indicates whether outbound packets are inspected or not before being granted to leave the internal realm.</td>
</tr>
</tbody>
</table>
<p id="rfc.section.4.p.5">The value of the F, T, P, A, S, C, I and O bits are as follows:</p>
<div id="#rfc.table.2"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="center">Position</th>
<th class="left">Name</th>
<th class="left">Meaning</th>
</tr></thead>
<tbody>
<tr>
<td class="center">1</td>
<td class="left">From (F)</td>
<td class="left">0=from IPv4, 1=from IPv6</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">To (T)</td>
<td class="left">0=to IPv4, 1=to IPv6</td>
</tr>
<tr>
<td class="center">3</td>
<td class="left">Port-Xlate (P)</td>
<td class="left">1=translated, 0=not translated</td>
</tr>
<tr>
<td class="center">4</td>
<td class="left">Addr-Xlate (A)</td>
<td class="left">1=translated, 0=not translated</td>
</tr>
<tr>
<td class="center">5</td>
<td class="left">Port-Set (S)</td>
<td class="left">1=enabled, 0=not supported</td>
</tr>
<tr>
<td class="center">6</td>
<td class="left">Packet-Control (C)</td>
<td class="left">1=enabled, 0=not supported</td>
</tr>
<tr>
<td class="center">7</td>
<td class="left">Direction-Out (I)</td>
<td class="left">1=enabled, 0=disabled</td>
</tr>
<tr>
<td class="center">8</td>
<td class="left">Direction-In (O)</td>
<td class="left">1=enabled, 0=disabled</td>
</tr>
</tbody>
</table>
<p></p>
<div id="#rfc.figure.4"></div>
<p id="rfc.section.4.p.7">A stateless NAT64 <a href="#RFC6145">[RFC6145]</a> would have the following values:</p>

<p></p>
<pre>  From=0 (IPv4)
  To=1 (IPv6)
  Port-Xlate=0 (No)
  Addr-Xlate=1 (Yes)
  Port-Set=0  (No)
  Packet-control=0 (No)
  Direction-out (0) (No)
  Direction-In=0 (No) 

</pre>
<p></p>
<div id="#rfc.figure.5"></div>
<p></p>

<p></p>
<pre>  From=0 (IPv4)
  To=1 (IPv6)
  Port-Xlate=1 (Yes)
  Addr-Xlate=1 (Yes)
  Port-Set=0  (No)
  Packet-control=0 (No)
  Direction-out (0) (No)
  Direction-In=0 (No)

</pre>
<p></p>
<p id="rfc.section.4.p.9">A NAT44 would be characterized as follows:</p>
<div id="#rfc.figure.6"></div>
<p></p>

<p></p>
<pre>  From=0 (IPv4)
  To=0 (IPv4)
  Port-Xlate=1 (Yes)
  Addr-Xlate=1 (Yes)
  Port-Set=0  (No)
  Packet-control=0 (No)
  Direction-out (0) (No)
  Direction-In=0 (No) 

</pre>
<p></p>
<p></p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> PERCEIVED_ADDRESS</h1>
<p id="rfc.section.5.p.1">This option (Code TBA, <a href="#perceived">Figure 7</a>) is used by a PCP Server to indicate in a PCP Response the perceived IPv6/IPv4 address and port of PCP messages received from a PCP Client. A PCP Client uses this information to detect whether a NAT is present in the path to reach its PCP Server. </p>
<p id="rfc.section.5.p.2">A PCP Client MAY include this option to learn the IP address and port as perceived by the PCP Server. When this option is received by the PCP Server, it uses the source IP address and port of the received PCP request to set the Perceived Port and Perceived IP Address. </p>
<div id="#rfc.figure.7"></div>
<div id="#perceived"></div>
<p></p>

<p></p>
<pre>         
      This Option:

         Name: PCP Perceived IP address/port Option (PERCEIVED_ADDR )

         Number: TBA (IANA)

         Purpose: Detect the presence of a NAT in the path 

         is valid for OpCodes: MAP4, MAP6

         Length: 0x08

         May appear in: both request and response

         Maximum occurrences: 1

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |PERCEIVED_ADDR |  Reserved     |            0x08               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Perceived Port |Address Family |       00...00                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Perceived IPv4/IPv6 Address                                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   
   Perceived Port: The source port number of a PCP request as seen 
      by the PCP Server.   
   Address Family: The Address Family of the perceived IP address.
   Perceived IPv4/IPv6 Address: If the Address Family is IPv4,
      an IPv4 address followed by 96 zero bits. If the Address Family
      is IPv6, an IPv6 address. This field includes the source IP
      address of a PCP request as seen by the PCP Server.      


</pre>
<p></p>
<p id="rfc.section.5.p.4">An example of the use of this option is illustrated in the following figure where there is a NAT in the path between the PCP Client and the PCP Server. </p>
<div id="#rfc.figure.8"></div>
<p></p>

<p></p>
<pre>     webcam-------+
                  |
  +----------+    |    +----+         +----------+
  |PCP Client|====+====|NAT1|=========|PCP Server|
  +----------+         +----+         +----------+
                                         NAT2</pre>
<p></p>
<ul>
<li>NAT1 is detected in the path between the PCP Client and the PCP Server owing to the use of the PERCEIVED_ADDR Option;</li>
<li>After learning about that NAT, the PCP Client uses UPnP IGD (or NAT-PMP) to interact with NAT1 and open the necessary port on NAT1 (e.g., IP address= IPx, port=X);</li>
<li>The PCP Client then sends PCP message to the PCP Server, indicating IPx and X as the internal IP address and port. The PCP Server opens pinhole towards IPx and X.</li>
</ul>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> SCOPE</h1>
<p id="rfc.section.6.p.1">The Scope Option (Code TBA, <a href="#scope">Figure 9</a>) is used by a PCP Client to indicate to the PCP Server the scope of the flows that will use a given mapping. This object is meant to be used in the context of cascaded PCP Servers/NAT levels. Two values are defined:</p>
<div id="#rfc.table.3"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="center">Value</th>
<th class="left">Meaning</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0x00</td>
<td class="left">Internet</td>
</tr>
<tr>
<td class="center">0x01</td>
<td class="left">Internal</td>
</tr>
</tbody>
</table>
<p id="rfc.section.6.p.2">When 0x00 value is used, the PCP Proxy MUST propagate the mapping request to its upstream PCP Server. When 0x01 value is used, the mapping is to be instantiated only in the first PCP-controlled device; no mapping is instantiated in the upstream PCP-controlled device.</p>
<p id="rfc.section.6.p.3">When no Scope Option is included in a PCP message, this is equivalent to including a Scope Option with a scope value of "Internet".</p>
<div id="#rfc.figure.9"></div>
<div id="#scope"></div>
<p></p>

<p></p>
<pre>         
      This Option:

         Name: PCP Scope Policy Option (SCOPE)

         Number: TBA (IANA)

         Purpose: Restrict the scope of PCP requests 

         is valid for OpCodes: MAP4, MAP6

         Length: 0x04

         May appear in: both request and response

         Maximum occurrences: 1

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   SCOPE       |  Reserved     |            0x04               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Scope      |                 00...00                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p></p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> REPORT</h1>
<p id="rfc.section.7.p.1">The Report PCP Option (Code TBA, <a href="#report">Figure 10</a>) is used by a PCP Client to report a set of useful information to the PCP Server. Several Report Options with distinct Report Sub-Code values MAY be conveyed in the same PCP message. Only report data associated with the PCP Server to which this option is sent MUST be included in a Report Option. </p>
<p id="rfc.section.7.p.2">This option can be used for troubleshooting or diagnose purposes.</p>
<div id="#rfc.figure.10"></div>
<div id="#report"></div>
<p></p>

<p></p>
<pre>
      This Option:

         Name: PCP Report Option (REPORT)

         Number: TBA (IANA)

         Purpose: Send a set of report data 

         is valid for OpCodes: MAP4, MAP6

         Length: Variable

         May appear in: both request and response

         Maximum occurrences: Multiple

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   SCOPE       |  Reserved     |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Report Sub-Code            |          00...00              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Report Data                         |
   :                                                               :
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p></p>
<p id="rfc.section.7.p.4">The following Report Sub-Code values are defined:</p>
<div id="#rfc.table.4"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="center">Position</th>
<th class="left">Meaning</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0x00</td>
<td class="left">Time since last reboot/boot</td>
</tr>
<tr>
<td class="center">0x01</td>
<td class="left">Count of transmitted PCP messages to the PCP Server since last boot</td>
</tr>
<tr>
<td class="center">0x02</td>
<td class="left">Count of retransmitted PCP messages to the PCP Server since last boot</td>
</tr>
<tr>
<td class="center">0x03</td>
<td class="left">Count of received PCP Error messages from the PCP Server</td>
</tr>
</tbody>
</table>
<p></p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#id" id="id">CLIENT_IDENTIFIER</a>
</h1>
<p id="rfc.section.8.p.1">PCP CLIENT_ID (Code TBA, <a href="#client_id">Figure 11</a>) is a token randomly <a href="#RFC4086">[RFC4086]</a> generated by the PCP Client.  Only one CLIENT_ID Option MUST be present in a PCP message. The PCP Client and PCP Server MUST store the value included in this Option in a PCP MAPx request.</p>
<p></p>

<ul>
<li>The CLIENT_ID MUST be generated by the PCP Client and not the PCP Server;</li>
<li>Upon change of the IP address of the PCP Client (or a third party on behalf of which a mapping has been created), the CLIENT_ID is used to update related mappings (e.g., PCP MAP delete request and PCP MAP create request);</li>
<li>The same CLIENT_ID MUST be used for all requested mappings, unless a new CLIENT_ID is generated by the PCP Client (e.g., reboot, OS crash, etc.);</li>
<li>The CLIENT_ID is stored by the PCP Server for all mappings (persistent storage);</li>
</ul>
<div id="#rfc.figure.11"></div>
<div id="#client_id"></div>
<p></p>

<p></p>
<pre>
      This Option:

         Name: PCP Client Identifier Option (CLIENT_ID)

         Number: TBA (IANA)

         Purpose: Associate an identifier with the mappings 

         is valid for OpCodes: MAP4, MAP6

         Length: Variable

         May appear in: both request and response

         Maximum occurrences: 1

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | CLIENT_ID     |  Reserved     |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Client Identifier                    |
   :                                                               :
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p></p>
<p id="rfc.section.8.p.4">The length of the CLIENT_ID is encoded in the Length field in bytes.  The length of the CLIENT_ID MUST be at least 4 bytes and MUST NOT exceed 16 bytes. </p>
<p id="rfc.section.8.p.5">The RECOMMENDED value is 16 bytes so as to have a robust random CLIENT_ID. If a CLIENT_ID longer than 16 bytes or shorter than 4 bytes is received, the PCP Server MUST issue a PCP Error message with an error cause equal to "Invalid Client-ID".</p>
<p id="rfc.section.8.p.6">For sanity checks, a PCP Server maintains the same CLIENT_ID value (which is used in the latest PCP request) for a given PCP Client for all mappings associated with the same internal IP address belonging to the same subscriber. Indeed, the PCP Server maintains an additional identifier denoted as subscriber-Id. A subscriber-is can be an IP address, IPv6 prefix or a subscriber identifier configured locally. </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.9.p.1">Security considerations discussed in <a href="#I-D.ietf-pcp-base">[I-D.ietf-pcp-base]</a> must be considered. The use of CLIENT_ID option allows to soften issues related to stale mappings.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.10.p.1">The following PCP Option Code are to be allocated:</p>

<ul class="empty">
<li>DESCRIPTION</li>
<li>DSCP_POLICY</li>
<li>CAPABILITY</li>
<li>PERCEIVED_ADDRESS</li>
<li>SCOPE</li>
<li>REPORT</li>
<li>CLIENT_IDENTIFIER</li>
</ul>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> Acknowledgements</h1>
<p id="rfc.section.11.p.1">TBC.</p>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4086">[RFC4086]</b></td>
<td class="top">
<a>Eastlake, D.</a>, <a>Schiller, J.</a> and <a>S. Crocker</a>, "<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>", BCP 106, RFC 4086, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-pcp-base">[I-D.ietf-pcp-base]</b></td>
<td class="top">
<a>Wing, D</a>, <a>Cheshire, S</a>, <a>Boucadair, M</a>, <a>Penno, R</a> and <a>P Selkirk</a>, "<a href="http://tools.ietf.org/html/draft-ietf-pcp-base-17">Port Control Protocol (PCP)</a>", Internet-Draft draft-ietf-pcp-base-17, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6145">[RFC6145]</b></td>
<td class="top">
<a>Li, X.</a>, <a>Bao, C.</a> and <a>F. Baker</a>, "<a href="http://tools.ietf.org/html/rfc6145">IP/ICMP Translation Algorithm</a>", RFC 6145, April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6146">[RFC6146]</b></td>
<td class="top">
<a>Bagnulo, M.</a>, <a>Matthews, P.</a> and <a>I. van Beijnum</a>, "<a href="http://tools.ietf.org/html/rfc6146">Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers</a>", RFC 6146, April 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mohamed Boucadair</span> 
	  <span class="n hidden">
		<span class="family-name">Boucadair</span>
	  </span>
	</span>
	<span class="org vcardline">France Telecom</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Rennes</span>,  
		<span class="region"></span>
		<span class="code">35000</span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mohamed.boucadair@orange-ftgroup.com">mohamed.boucadair@orange-ftgroup.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Reinaldo Penno</span> 
	  <span class="n hidden">
		<span class="family-name">Penno</span>
	  </span>
	</span>
	<span class="org vcardline">Juniper Networks</span>
	<span class="adr">
	  <span>1194 N Mathilda Avenue</span>

	  <span class="vcardline">
		<span class="locality">Sunnyvale</span>,  
		<span class="region">California</span> 
		<span class="code">94089</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:rpenno@juniper.net">rpenno@juniper.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dan Wing</span> 
	  <span class="n hidden">
		<span class="family-name">Wing</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>170 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">California</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dwing@cisco.com">dwing@cisco.com</a></span>

  </address>
</div>

</body>
</html>