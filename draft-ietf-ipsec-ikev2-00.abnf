SKEYSEED = prf(Ni | Nr, g^ir)
SKEYSEED_d = prf(SKEYSEED, g^ir | CKY-I | CKY-R | 0)
SKEYSEED_a = prf(SKEYSEED, SKEYSEED_d | g^ir | CKY-I | CKY-R | 1)
SKEYSEED_e = prf(SKEYSEED, SKEYSEED_a | g^ir | CKY-I | CKY-R | 2)

KEYMAT = prf(SKEYSEED_d, protocol | SPId | Ns | Nd )

KEYMAT = prf(SKEYSEED_d, g(p2)^ir | protocol | SPId | Ns | Nd )

KEYMAT = K1 | K2 | K3 | ...
K1 = prf(SKEYSEED_d, [ g(p2)^ir | ] protocol | SPId | Ns | Nd)
K2 = prf(SKEYSEED_d, K1 | [ g(p2)^ir | ] protocol | SPId | Ns | Nd)
K3 = prf(SKEYSEED_d, K2 | [ g(p2)^ir | ] protocol | SPId | Ns | Nd)
SKEYSEED = prf(SKEYSEED_d (old), g(p2)^ir | 0 | CKY-I | CKY-R
                                                 | Ni | Nr)

Ka = K1 | K2 | K3

K1 = prf(SKEYSEED_e, 0)
K2 = prf(SKEYSEED_e, K1)
K3 = prf(SKEYSEED_e, K2)

