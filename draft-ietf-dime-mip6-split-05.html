<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Diameter Mobile IPv6: Support for Home Agent
      to Diameter Server Interaction</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Diameter Mobile IPv6: Support for Home Agent
      to Diameter Server Interaction">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Diameter Maintenance and</td><td class="header">J. Korhonen, Ed.</td></tr>
<tr><td class="header">Extensions (DIME)</td><td class="header">TeliaSonera</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">Expires: April 1, 2008</td><td class="header">J. Bournelle</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">France Telecom R&amp;D</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">G. Giaretta</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Qualcomm</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Nakhjiri</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Motorola</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">September 29, 2007</td></tr>
</table></td></tr></table>
<h1><br />Diameter Mobile IPv6: Support for Home Agent
      to Diameter Server Interaction<br />draft-ietf-dime-mip6-split-05.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 1, 2008.</p>

<h3>Abstract</h3>

<p>Mobile IPv6 deployments may want to bootstrap their operations dynamically based on an
        interaction between the Home Agent and the Diameter server of the Mobile Service Provider
        (MSP). This document specifies the interaction between a Mobile IP Home Agent and the
        Diameter server.
</p>
<p>Several different mechanisms for authenticating a Mobile Node are supported. The usage of
        the Internet Key Exchange v2 (IKEv2) protocol allows different mechanisms, such as the
        Extensible Authentication Protocol (EAP), certificates and pre-shared secrets in IKEv2 to be
        used. Furthermore, another method makes use of the Mobile IPv6 Authentication protocol. In
        addition to authentication authorization, the configuration of Mobile IPv6 specific
        parameters and accounting is specified in this document.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#anchor1">3.</a>&nbsp;
Advertising Application Support<br />
<a href="#anchor2">4.</a>&nbsp;
Protocol Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">4.1.</a>&nbsp;
Support for Mobile IPv6 with IKEv2 and EAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.2.</a>&nbsp;
Support for Mobile IPv6 with IKEv2 and Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.3.</a>&nbsp;
Support for Mobile IPv6 with IKEv2 and Pre-Shared Secrets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.4.</a>&nbsp;
Support for the Mobile IPv6 Authentication Protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.5.</a>&nbsp;
Mobile IPv6 Session Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.5.1.</a>&nbsp;
Session-Termination-Request Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.5.2.</a>&nbsp;
Session-Termination-Answer Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.5.3.</a>&nbsp;
Abort-Session-Request Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.5.4.</a>&nbsp;
Abort-Session-Answer Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.6.</a>&nbsp;
Accounting for Mobile IPv6 services<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.6.1.</a>&nbsp;
Accounting-Request Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.6.2.</a>&nbsp;
Accounting-Answer Command<br />
<a href="#Command-Code-Values">5.</a>&nbsp;
Command Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.1.</a>&nbsp;
Command Code for Mobile IPv6 with IKEv2 and EAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.1.1.</a>&nbsp;
Diameter-EAP-Request (DER)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.1.2.</a>&nbsp;
Diameter-EAP-Answer (DEA)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.2.</a>&nbsp;
Command Code for Mobile IPv6 with IKEv2 and Certificate- and PSK-based Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.2.1.</a>&nbsp;
AA-Request (AAR)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.2.2.</a>&nbsp;
AA-Answer (AAA)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">5.3.</a>&nbsp;
Command Codes for MIPv6 Auth. Protocol Support<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">5.3.1.</a>&nbsp;
MIP6-Request-Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">5.3.2.</a>&nbsp;
MIP6-Answer-Message<br />
<a href="#avps">6.</a>&nbsp;
AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">6.1.</a>&nbsp;
User-Name AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">6.2.</a>&nbsp;
MIP-MN-AAA-SPI AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">6.3.</a>&nbsp;
MIP-Mobile-Node-Address AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">6.4.</a>&nbsp;
MIP-Home-Agent-Address AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">6.5.</a>&nbsp;
MIP-Careof-Address AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">6.6.</a>&nbsp;
MIP-Authenticator AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">6.7.</a>&nbsp;
MIP-MAC-Mobility-Data AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mip-session-key">6.8.</a>&nbsp;
MIP-Session-Key AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">6.9.</a>&nbsp;
MIP-MSA-Lifetime AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">6.10.</a>&nbsp;
MIP-MN-to-HA-MSA AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">6.11.</a>&nbsp;
MIP-Algorithm-Type AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">6.12.</a>&nbsp;
MIP-Replay-Mode AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mip-nonce">6.13.</a>&nbsp;
MIP-nonce AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">6.14.</a>&nbsp;
MIP6-Feature-Vector AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">6.15.</a>&nbsp;
MIP-Timestamp AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">6.16.</a>&nbsp;
QoS-Capability AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">6.17.</a>&nbsp;
QoS-Resources AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#accounting">6.18.</a>&nbsp;
Accounting AVPs<br />
<a href="#result">7.</a>&nbsp;
Result-Code AVP Values<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">7.1.</a>&nbsp;
Transient Failures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">7.2.</a>&nbsp;
Permanent Failures<br />
<a href="#anchor41">8.</a>&nbsp;
AVP Occurence Tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">8.1.</a>&nbsp;
AAR, AAA, DER, DEA, MRM and MAM AVP/Command-Code Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">8.2.</a>&nbsp;
Accounting AVP Table<br />
<a href="#anchor44">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">9.1.</a>&nbsp;
Command Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">9.2.</a>&nbsp;
AVP Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">9.3.</a>&nbsp;
Result-Code AVP Values<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">9.4.</a>&nbsp;
Application Identifier<br />
<a href="#SecurityConsiderations">10.</a>&nbsp;
Security Considerations<br />
<a href="#anchor49">11.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Performing the Mobile IPv6 protocol <a class='info' href='#RFC3775'>[1]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>, requires the Mobile Node (MN)
        to own a Home Address (HoA) and assignment of a Home Agent (HA) to the MN. The MN needs to
        register with the HA in order facilitate its reachability and mobility, when away from home.
        The registration process itself requires establishment of IPsec security associations (SA)
        and cryptographic material between the MN and HA. Providing the collection of home address,
        HA address and keying material is generally referred to as the Mobile IPv6 bootstrapping
        problem <a class='info' href='#RFC4640'>[2]<span> (</span><span class='info'>Patel, A. and G. Giaretta, &ldquo;Problem Statement for bootstrapping Mobile IPv6 (MIPv6),&rdquo; September&nbsp;2006.</span><span>)</span></a>. The purpose of this specification is to provide Diameter
        support for the interaction between the HA and the AAA server, as it is required for
        bootstrapping in the split scenario <a class='info' href='#I-D.ietf-mip6-bootstrapping-split'>[13]<span> (</span><span class='info'>Giaretta, G., &ldquo;Mobile IPv6 bootstrapping in split scenario,&rdquo; July&nbsp;2007.</span><span>)</span></a> and
        in the integrated scenario <a class='info' href='#I-D.ietf-mip6-bootstrapping-integrated-dhc'>[14]<span> (</span><span class='info'>Chowdhury, K. and A. Yegin, &ldquo;MIP6-bootstrapping for the Integrated Scenario,&rdquo; April&nbsp;2008.</span><span>)</span></a> in a
        manner that satisfies the requirements defined in <a class='info' href='#I-D.ietf-mip6-aaa-ha-goals'>[15]<span> (</span><span class='info'>Giaretta, G., &ldquo;AAA Goals for Mobile IPv6,&rdquo; September&nbsp;2006.</span><span>)</span></a>.
</p>
<p>From an operator (mobility service provider, MSP) perspective, it is important to verify
        that the MN is authenticated and authorized to utilize Mobile IPv6 service and that such
        services are accounted for. Only when the MN is authenticated and authorized, the MSP allows
        the boostrapping of Mobile IPv6 parameters. Thus, prior to processing the Mobile IPv6
        service requests, the HA, participates in the authentication of the MN to verify the MN's
        identity. The HA also participates in the Mobile IPv6 authorization process involving the
        Diameter infrastrucure. The HA due to its role in traffic forwarding, also may also perform
        accounting for the Mobile IPv6 service provided to the MN.
</p>
<p>This document enables the following functionality:
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>Authentication:</dt>
<dd>Asserting or helping in asserting of the correctness of the
            MN identity. As a Diameter client supporting the new Diameter Mobile IPv6 application,
            the HA may need to support more than one authentication type depending on the
            environment. Although the authentication is performed by the AAA server there is an
            impact for the HA as different set of command codes are needed for the respective
            authentication procedures. <br />

          
</dd>
<dt>Authorization:</dt>
<dd>The HA must verify that the user is authorized to use the
            Mobile IPv6 service using the assistance of the MSP Diameter servers. This is
            accomplised through the use of new Diameter commands specifically designed for
            performing Mobile IPv6 authorization decisions. This document defines these commands and
            requires the HA to support them and to participate in this authorization
              signaling.<br />

          
</dd>
<dt>Accounting:</dt>
<dd> For accounting purposes and capacity planning, it is required
            of the HA to provide accounting report to the Diameter infrastructure and thus to
            support the related Diameter accounting procedures.<br />

          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        <a class='info' href='#arch-mip6'>Figure&nbsp;1<span> (</span><span class='info'>Architecture Overview</span><span>)</span></a> depicts the architecture.
</p><br /><hr class="insert" />
<a name="arch-mip6"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                          +--------+
                                          |Diameter|
                                          |Server  |
                                          +--------+
                                              ^
                                     Back-End | Diameter MIPv6
                                     Protocol | HA&lt;-&gt;AAA Server
                                     Support  | Interaction
                                              | (this document)
                                              v
 +---------+                           +--------------+
 | Mobile  |    Front-End Protocol     |Home Agent /  |
 | Node    |&lt;--------------------------|Diemter Client|
 +---------+    IKEv2 or RFC 4285      +--------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Architecture Overview&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Mobile IPv6 signaling between the MN and the HA can protected using two different
        mechanisms, namely using IPsec and via the MIPv6 Auth. Protocol. Note that the actual
        mechanism to protect the MIPv6 signaling messages is only indirectly relevant to this
        document. The important aspect is, however, that for these two approaches several different
        authentication and key exchange solutions are available. To establish IPsec security
        associations for protection of Mobile IPv6 signaling messages IKEv2 is used, see <a class='info' href='#RFC4877'>[3]<span> (</span><span class='info'>Devarapalli, V. and F. Dupont, &ldquo;Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a>. IKEv2 supports EAP-based authentication, certificates and pre-shared
        secrets. For protecting using the MIPv6 Auth. Protocol <a class='info' href='#I-D.ietf-mip6-rfc4285bis'>[4]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; July&nbsp;2008.</span><span>)</span></a> a mechanism has been designed that is very similar to
        the one used by Mobile IPv4. 
</p>
<p> The ability to use different credentials has an impact on the interaction between the HA
        (acting as a Diameter client) and the Diameter Server. For that reason this document
        illustrates the usage of these authentication mechanisms with different subsections for
          </p>
<ul class="text">
<li>IKEv2 usage with EAP
</li>
<li>IKEv2 usage with certificates and pre-shared secrets
</li>
<li>MIPv6 Auth. Protocol
</li>
</ul><p>
      
</p>
<p>For accounting of Mobile IPv6 services provided to the MN, this specification uses the
        accounting application defined in <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p> The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
        NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
        described in RFC 2119 <a class='info' href='#RFC2119'>[6]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>. 
</p>
<p>The MIPv6 bootstrapping terminology is taken from <a class='info' href='#RFC4640'>[2]<span> (</span><span class='info'>Patel, A. and G. Giaretta, &ldquo;Problem Statement for bootstrapping Mobile IPv6 (MIPv6),&rdquo; September&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Advertising Application Support</h3>

<p>Diameter nodes conforming to this specification MUST advertise support by including the
        Diameter Mobile IPv6 Application ID value of [TO BE ASSIGNED BY IANA] in the
        Auth-Application-Id AVP of the Capabilities-Exchange-Request and
        Capabilities-Exchange-Answer command <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. The Acct-Application-id AVP
        needs to include the Diameter Base Accounting Application ID value of 3 (to support the
        split accounting model <a class='info' href='#I-D.ietf-dime-app-design-guide'>[16]<span> (</span><span class='info'>Fajardo, V., Tschofenig, H., and L. Morand, &ldquo;Diameter Applications Design Guidelines,&rdquo; March&nbsp;2010.</span><span>)</span></a>). 
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Description</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Support for Mobile IPv6 with IKEv2 and EAP</h3>

<p>The use of IKEv2 with EAP between the MN and the HA allows the AAA to authenticate the
          MN. When EAP is used with IKEv2, the Diameter EAP application, as defined in <a class='info' href='#RFC4072'>[7]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, is re-used. EAP methods that do not establish a shared key SHOULD
          NOT be used, as they are subject to a number of man-in-the-middle attacks as stated in
          Section 2.16 and Section 5 of RFC 4306 <a class='info' href='#RFC4306'>[8]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. AVPs specific to Mobile
          IPv6 bootstrapping are added to the EAP application commands. 
</p>
<p>
          <a class='info' href='#fig-ikev2-diameter-msg'>Figure&nbsp;2<span> (</span><span class='info'>Mobile IPv6 with IKEv2 and EAP</span><span>)</span></a> shows the message flow involved during the
          authentication phase when EAP is used.
</p><br /><hr class="insert" />
<a name="fig-ikev2-diameter-msg"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 Mobile                           Home                      Diameter
 Node                             Agent                     Server
  |                                 |                          |
  | HDR, SAi1, KEi, Ni  (1)         |                          |
  |--------------------------------&gt;|                          |
  |                                 |                          |
  | HDR, SAr1, KEr, Nr, [CERTREQ](2)|                          |
  |&lt;-------------------------------&gt;|                          |
  |                                 |                          |
  | HDR, SK{IDi,[CERTREQ,] [IDr,]   |                          |
  | [CP(CFG_REQUEST),]              |                          |
  | SAi2, TSi, TSr} (3)             |                          |
  |--------------------------------&gt;| DER (EAP-Response) (4)   |
  |                                 |-------------------------&gt;|
  |                                 |                          |
  |                                 | DEA (EAP-Request) (5)    |
  | HDR, SK{IDr, [CERT,] AUTH, EAP} |&lt;-------------------------|
  |&lt;------------------------------- |                          |
  |                                 |                          |
  | HDR, SK{EAP}                    |                          |
  |--------------------------------&gt;| DER (EAP-Response)       |
  |                                 |-------------------------&gt;|
  |                                 |                          |
  |                                 | DEA (EAP-Request)        |
  | HDR, SK{EAP-Request}            |&lt;-------------------------|
  |&lt;------------------------------- |                          |
  |                                 |                          |
  | HDR, SK{EAP-Response}           |                          |
  |--------------------------------&gt;| DER (EAP-Response)       |
  |                                 |-------------------------&gt;|
  |               ...               |          ...             |
  |                                 |                          |
  |                                 | DEA (EAP-Success)        |
  |                                 |&lt;-------------------------|
  | HDR, SK{EAP-Success}            |                          |
  |&lt;------------------------------- |                          |
  |                                 |                          |
  | HDR, SK{AUTH}                   |                          |
  |-------------------------------&gt; |                          |
  |                                 |                          |
  | HDR, SK{AUTH, [CP(CFG_REPLY,]   |                          |
  | SAr2, TSi, TSr}                 |                          |
  |&lt;------------------------------- |                          |
  |                                 |                          |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Mobile IPv6 with IKEv2 and EAP&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The MN and the HA start the interaction with an IKE_SA_INIT exchange. In this phase
          cryptographic algorithms are negotiated, nonces and Diffie-Hellman parameters are
          exchanged. Message (3) starts the IKE_AUTH phase. This second phase authenticates the
          previous messages, exchanges identities and certificates and establishes the first
          CHILD_SA. It is used to mutually authenticate the MN (acting as an IKEv2 Initiator) and
          the HA (acting as an IKEv2 Responder). The identity of the user/MN is provided in the IDi
          field. The MN indicates its willingness to be authenticated via EAP by omitting the AUTH
          field in message (3) (see Section 2.16 of <a class='info' href='#RFC4306'>[8]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>). 
</p>
<p>As part of the authentication process, the MN MAY request a Home-Address, a Home Prefix
          or suggests one, see <a class='info' href='#RFC4877'>[3]<span> (</span><span class='info'>Devarapalli, V. and F. Dupont, &ldquo;Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a>, using a CFG_REQUEST payload in the message
          (3).
</p>
<p>The HA extracts the IDi field from the message (3) and sends a Diameter-EAP-Request (DER)
          message (4) towards the authenticating Diameter server. The EAP-Payload AVP contains a
          EAP-Response/Identity with the identity extracted from the IDi field. 
</p>
<p>This message is routed to the MNs Diameter server/EAP server. The Diameter server selects
          the EAP method and replies with the DEA Message. Depending on the type of EAP method
          chosen, a number of DER and DEA messages carry the method specific exchanges between the
          MN and the Diameter server/EAP server. 
</p>
<p>At the end of the EAP authentication phase, the Diameter server indicates the result of
          the authentication in the Result-Code AVP and provides the corresponding EAP packet (EAP
          Success or EAP Failure). The last IKEv2 message sent by the HA contains the Home Address
          or the Home Prefix. In the latter case, a CREATE_CHILD_SA exchange is necessary to setup
          IPsec SAs for Mobile IPv6 signalling.
</p>
<p>In some deployment scenario, the HA may also acts as a IKEv2 Responder for IPsec VPN
          access. A problem in this case is that the IKEv2 responder may not know if IKEv2 is used
          for MIP6 service or for IPsec VPN access. A network operator needs to be aware of this
          limitation.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Support for Mobile IPv6 with IKEv2 and Certificates</h3>

<p>When IKEv2 is used with certificate-based authentication, the Diameter NASREQ application
            <a class='info' href='#RFC4005'>[9]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> is used to authorize the MN for the Mobile IPv6 service. The
          IDi payload extracted from the IKE_AUTH message MUST correspond to the identity in the
          MN's certificate. This identity is then used by the Home Agent to populate the User-Name
          AVP in the succeeding AA-Request message. Further PKI-related procedures such as
          certificate revocation checking are out of scope of this document. 
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Support for Mobile IPv6 with IKEv2 and Pre-Shared Secrets</h3>

<p>When IKEv2 is used with PSK-based initiator authentication, the Diameter NASREQ
          application <a class='info' href='#RFC4005'>[9]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> isused to authorize the MN for the Mobile IPv6
          service. The IDi payload extracted from the IKE_AUTH message has to contain an identity
          that is meaningful for the Diameter infrastructure, such as a Network Access Identifier
          (NAI), and is then used by the Home Agent to populate the User-Name AVP is the succeeding
          AA-Request message. 
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Support for the Mobile IPv6 Authentication Protocol</h3>

<p>
          <a class='info' href='#rfc4285-flow'>Figure&nbsp;3<span> (</span><span class='info'>MIPv6 Bootstrapping using the MIPv6 Auth. Protocol</span><span>)</span></a> describes the sequence of messages sent and received between
          the MN, the HA and the Diameter server during the registration when MIPv6 Auth. Protocol
          is used. Binding Update (BU) and Binding Acknowledgement (BA) messages are used in the
          registration process. This exchange triggers the Diameter interaction. 
</p>
<p>According to <a class='info' href='#I-D.ietf-mip6-rfc4285bis'>[4]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; July&nbsp;2008.</span><span>)</span></a> the MN uses the Mobile Node
          Identifier Option, specifically the MN-NAI mobility option (as defined in <a class='info' href='#RFC4283'>[17]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Mobile Node Identifier Option for Mobile IPv6 (MIPv6),&rdquo; November&nbsp;2005.</span><span>)</span></a>) to identify itself. 
</p>
<p> The BU initiates a MIP6-Request-Message to the Diameter server and the corresponding
          response is carried in a MIP6-Answer-Message. The Home Agent also provides the assigned
          Home Address to the Diameter server in the MIP-Mobile-Node-Address AVP. 
</p>
<p>
          <br /><hr class="insert" />
<a name="rfc4285-flow"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Mobile                                Home                 Diameter
  Node                                  Agent                 Server
    |                                     |                     |
    |                                     |                     |
    |       Binding Update                |MIP6-Request-Message |
    |------------------------------------&gt;|--------------------&gt;|
    | (Mobile Node Identifier Option,     |                     |
    |  Mobility Message Replay Protection |                     |
    |  Option, Authentication Option)     |                     |
    |                                     |                     |
    |                                     |                     |
    |       Binding Acknowledgement       |MIP6-Answer-Message  |
    |&lt;------------------------------------|&lt;--------------------|
    | (Mobile Node Identifier Option      |                     |
    |  Mobility Message Replay Protection |                     |
    |  Option, Authentication Option)     |                     |
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: MIPv6 Bootstrapping using the MIPv6 Auth. Protocol&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Mobile IPv6 Session Management</h3>

<p>The Diameter server may maintain state or may be stateless. This is indicated in the
          Auth-Session-State AVP (or its absence). The HA MUST support the Authorization Session
          State Machine defined in <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. Moreover, the following four commands
          may be exchanged between the HA and the Diameter server. 
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
Session-Termination-Request Command</h3>

<p>The Session-Termination-Request (STR) message <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the
            HA to inform the Diameter server that an authorized session is being terminated. 
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.2"></a><h3>4.5.2.&nbsp;
Session-Termination-Answer Command</h3>

<p>The Session-Termination-Answer (STA) message <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the
            Diameter server to acknowledge the notification that the session has been
          terminated.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.3"></a><h3>4.5.3.&nbsp;
Abort-Session-Request Command</h3>

<p>The Abort-Session-Request (ASR) message <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the
            Diameter server to terminates the session. This fulfills one of the requirement
            described in <a class='info' href='#I-D.ietf-mip6-aaa-ha-goals'>[15]<span> (</span><span class='info'>Giaretta, G., &ldquo;AAA Goals for Mobile IPv6,&rdquo; September&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.4"></a><h3>4.5.4.&nbsp;
Abort-Session-Answer Command</h3>

<p>The Abort-Session-Answer (ASA) message <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the Home
            Agent in response to an ASR message.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Accounting for Mobile IPv6 services</h3>

<p>The HA MUST be able act as a Diameter client collecting accounting records needed for
          service control and charging. The HA MUST support the accounting procedures (specifically
          the command codes mentioned below) and the Accounting Session State Machine as defined in
            <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. The command codes, exchanged between the HA and Diameter
          server for accounting purposes, are provided in the following subsections.
</p>
<p>The Diameter application design guideline <a class='info' href='#I-D.ietf-dime-app-design-guide'>[16]<span> (</span><span class='info'>Fajardo, V., Tschofenig, H., and L. Morand, &ldquo;Diameter Applications Design Guidelines,&rdquo; March&nbsp;2010.</span><span>)</span></a>
          defines two separate models for accounting:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Split accounting model:</dt>
<dd><br />
 According to this model,
              the accounting messages use the Diameter base accounting application ID (value of 3).
              Since accounting is treated as an independent application, accounting commands may be
              routed separately from the rest of application messages and thus the accounting
              messages generally end up in a central accounting server. Since Diameter Mobile IPv6
              application does not define its own unique accounting commands, this is the prefered
              choice, since it permits use of centralized accounting for several
                applications.<br />
<br />

</dd>
<dt>Coupled accounting model:</dt>
<dd><br />
 In this model, the
              accounting messages will use the application ID of the Mobile IPv6 application. This
              means that accounting messages will be routed like any other Mobile IPv6 application
              messages. This requires the Diameter server in charge of Mobile IPv6 application to
              handle the accounting records (e.g., sends them to a proper accounting server).
</dd>
</dl></blockquote><p>
        
</p>
<p>As mentioned above, the prefered choice is to use the split accounting model and thus to
          choose Diameter base accounting application ID (value of 3) for accounting messages.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.1"></a><h3>4.6.1.&nbsp;
Accounting-Request Command</h3>

<p>The Accounting-Request command <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the HA to the
            Diameter server to exchange accounting information regarding the MN with the Diameter
            server.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.2"></a><h3>4.6.2.&nbsp;
Accounting-Answer Command</h3>

<p>The Accounting-Answer command <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the Diameter server
            to the HA to acknowledge receiving an Accounting-Request.
</p>
<a name="Command-Code-Values"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Command Codes</h3>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Command Code for Mobile IPv6 with IKEv2 and EAP</h3>

<p>For usage of Mobile IPv6 with IKEv2 and EAP this document re-uses the Diameter EAP
          application <a class='info' href='#RFC4072'>[7]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> commands. The following commands are used to carry
          MIPv6 related bootstrapping AVPs.
</p>
<p>
          <br /><hr class="insert" />
<a name="cmd-eap"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Command-Name             Abbrev.   Code     Reference  Application
------------------------------------------------------------------
Diameter-EAP-Request      DER       268      RFC 4072   EAP
Diameter-EAP-Answer       DEA       268      RFC 4072   EAP
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Command Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Diameter-EAP-Request (DER)</h3>

<p> The Diameter-EAP-Request (DER) message <a class='info' href='#RFC4072'>[7]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, indicated by the
            Command-Code field set to 268 and the 'R' bit set in the Command Flags field, is sent by
            the HA to the Diameter server to initiate a Mobile IPv6 service authentication and
            authorization procedure. The DER message format is the same as defined in <a class='info' href='#RFC4072'>[7]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>. The Application-ID field of the Diameter Header MUST be set to the
            Diameter Mobile IPv6 Application ID [TO BE ASSIGNED TO IANA].
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  &lt;Diameter-EAP-Request&gt; ::= &lt; Diameter Header: 268, REQ, PXY &gt;
                             &lt; Session-Id &gt;
                             { Auth-Application-Id }
                             { Origin-Host }
                             { Origin-Realm }
                             { Destination-Realm }
                             { Auth-Request-Type }
                             [ Destination-Host ]
                             [ NAS-Identifier ]
                             [ NAS-IP-Address ]
                             [ NAS-IPv6-Address ]
                             [ NAS-Port-Type ]
                             [ User-Name ]
                             { EAP-Payload }

                             [ MIP6-Feature-Vector ]
                             [ MIP-Home-Agent-Address ]
                             { MIP-Mobile-Node-Address }
                             ...
                           * [ AVP ]
</pre></div><p>

          
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Diameter-EAP-Answer (DEA)</h3>

<p>The Diameter-EAP-Answer (DEA) message defined in <a class='info' href='#RFC4072'>[7]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, indicated by
            the Command-Code field set to 268 and 'R' bit cleared in the Command Flags field, is
            sent in response to the Diameter-EAP-Request message (DER). If the Mobile IPv6
            authentication procedure was successful then the response MAY include any set of
            bootstrapping AVPs. 
</p>
<p>The DEA message format is the same as defined in <a class='info' href='#RFC4072'>[7]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>. The
            Application-Id field in the Diameter header MUST be set to the Diameter Mobile IPv6
            Application-Id [TO BE ASSIGNED BY IANA].
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  &lt;Diameter-EAP-Answer&gt; ::= &lt; Diameter Header: 268, PXY &gt;
                            &lt; Session-Id &gt;
                            { Auth-Application-Id }
                            { Auth-Request-Type }
                            { Result-Code }
                            { Origin-Host }
                            { Origin-Realm }

                            [ User-Name ]
                            { EAP-Payload }
                            [ Authorization-Lifetime ]

                            [ MIP-Mobile-Node-Address ]
                            [ MIP6-Feature-Vector ]
                            ...
                          * [ AVP ]
</pre></div><p>

          
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Command Code for Mobile IPv6 with IKEv2 and Certificate- and PSK-based Authentication</h3>

<p>This document re-uses the Diameter NASREQ application commands. The following commands
          are used to carry MIPv6 related bootstrapping AVPs. 
</p>
<p>
          <br /><hr class="insert" />
<a name="cmd-nas"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Command-Name             Abbrev.   Code     Reference  Application
------------------------------------------------------------------
AA-Request               AAR       265      RFC 4005   NASREQ
AA-Answer                AAA       265      RFC 4005   NASREQ
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Command Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
AA-Request (AAR)</h3>

<p> The AA-Request (AAR) message <a class='info' href='#RFC4005'>[9]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, indicated by the Command-Code
            field set to 265 and the 'R' bit set in the Command Flags field, is sent by the HA to
            the Diameter server to initiate a Mobile IPv6 service authentication and authorization
            procedure. The AAR message format is the same as defined in <a class='info' href='#RFC4005'>[9]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
            The Application-ID field of the Diameter Header MUST be set to the Diameter Mobile IPv6
            Application ID [TO BE ASSIGNED TO IANA].
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  &lt;AA-Request&gt; ::= &lt; Diameter Header: 265, REQ, PXY &gt;
                   &lt; Session-Id &gt;
                   { Auth-Application-Id }
                   { Origin-Host }
                   { Origin-Realm }
                   { Destination-Realm }
                   { Auth-Request-Type }
                   [ Destination-Host ]
                   [ NAS-Identifier ]
                   [ NAS-IP-Address ]
                   [ NAS-IPv6-Address ]
                   [ NAS-Port-Type ]
                   [ User-Name ]

                   [ MIP6-Feature-Vector ]
                   [ MIP-Home-Agent-Address ]
                   { MIP-Mobile-Node-Address }
                   ...
                 * [ AVP ]
</pre></div><p>

          
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
AA-Answer (AAA)</h3>

<p>The AA-Answer (AAA) message defined in <a class='info' href='#RFC4005'>[9]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, indicated by the
            Command-Code field set to 265 and 'R' bit cleared in the Command Flags field, is sent in
            response to the AA-Request message (AAR). If the Mobile IPv6 authentication procedure
            was successful then the response MAY include any set of bootstrapping AVPs. 
</p>
<p>The AAA message format is the same as defined in <a class='info' href='#RFC4005'>[9]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>. The
            Application-Id field in the Diameter header MUST be set to the Diameter Mobile IPv6
            Application-Id [TO BE ASSIGNED BY IANA].
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  &lt;AA-Answer&gt; ::= &lt; Diameter Header: 265, PXY &gt;
                  &lt; Session-Id &gt;
                  { Auth-Application-Id }
                  { Auth-Request-Type }
                  { Result-Code }
                  { Origin-Host }
                  { Origin-Realm }

                  [ User-Name ]
                  [ Authorization-Lifetime ]

                  [ MIP-Mobile-Node-Address ]
                  [ MIP6-Feature-Vector ]
                  ...
                * [ AVP ]
</pre></div><p>

          
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Command Codes for MIPv6 Auth. Protocol Support</h3>

<p> This section defines the commands that are used for support with the MIPv6 Auth.
          Protocol.
</p>
<p>
          <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Command-Name             Abbreviation    Code           Section
    ------------------------------------------------------------------
    MIP6-Request-Message         MRM         TBD         Section 6.2.1
    MIP6-Answer-Message          MAM         TBD         Section 6.2.2
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Command Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
MIP6-Request-Message</h3>

<p>The MIP6-Request-Message (MRM), indicated by the Command-Code field set to TBD and the
            'R' bit set in the Command Flags field, is sent by the HA, acting as a Diameter client,
            in order to request the authentication and authorization of a MN. The HA uses
            information found in the Binding Update to construct the following AVPs, to be included
            as part of the MRM:
</p>
<p>
            </p>
<ul class="text">
<li>Home Address (MIP-Mobile-Node-Address AVP)
</li>
<li>Mobile Node NAI (User-Name AVP <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>) 
</li>
<li>MN-AAA Authentication Option (MIP-MN-AAA-Auth AVP)
</li>
<li>Care-of Address (MIP-Careof-Address AVP)
</li>
<li>Mobility message replay protection Option using
                 timestamps (MIP-Timestamp AVP)
</li>
</ul><p>
          
</p>
<p>The message format is shown below.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        &lt;MIP6-Request-Message&gt; ::= &lt; Diameter Header: XXX, REQ, PXY &gt;
          &lt; Session-ID &gt;
          { Auth-Application-Id }
          { User-Name }
          { Destination-Realm }
          { Origin-Host }
          { Origin-Realm }
          [ Acct-Multi-Session-Id ]
          [ Destination-Host ]
          [ Origin-State-Id ]
          [ NAS-Identifier ]
          [ NAS-IP-Address ]
          [ NAS-IPv6-Address ]
          [ NAS-Port-Type ]

          [ MIP6-Feature-Vector ]
          { MIP-MN-AAA-SPI }
          { MIP-Mobile-Node-Address ]
          { MIP-Home-Agent-Address }
          { MIP-Careof-Address }
          { MIP-Authenticator }
          { MIP-MAC-Mobility-Data }
          [ MIP-Timestamp ]
          [ QoS-Capability ]
        * [ QoS-Resources ]

          [ Authorization-Lifetime ]
          [ Auth-Session-State ]
        * [ Proxy-Info ]
        * [ Route-Record ]
        * [ AVP ]
</pre></div><p>

          
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
MIP6-Answer-Message</h3>

<p> The MIP6-Answer-Message (MAM) message, indicated by the Command-Code field set to TBD
            and the 'R' bit cleared in the Command Flags field, is sent by the Diameter server in
            response to the MIP6-Request-Message message. The User-Name MAY be included in the MAM
            if it is present in the MRM. The Result-Code AVP MAY contain one of the values defined
            in <a class='info' href='#result'>Section&nbsp;7<span> (</span><span class='info'>Result-Code AVP Values</span><span>)</span></a>, in addition to the values defined in RFC 3588 <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
</p>
<p>An MAM message with the Result-Code AVP set to DIAMETER_SUCCESS MUST include the
            MIP-Mobile-Node-Address AVP.
</p>
<p> The message format is shown below.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   &lt;MIP6-Answer-Message&gt; ::= &lt; Diameter Header: XXX, PXY &gt;
            &lt; Session-Id &gt;
            { Auth-Application-Id }
            { Result-Code }
            { Origin-Host }
            { Origin-Realm }
            [ Acct-Multi-Session-Id ]
            [ User-Name ]
            [ Authorization-Lifetime ]
            [ Auth-Session-State ]
            [ Error-Message ]
            [ Error-Reporting-Host ]
            [ Re-Auth-Request-Type ]

            [ MIP6-Feature-Vector ]
            [ MIP-Home-Agent-Address ]
            { MIP-Mobile-Node-Address }
            { MIP-Session-Key }
            { MIP-MSA-Lifetime }
            { MIP-MN-to-HA-MSA }
          * [ QoS-Resources ]

            [ Origin-State-Id ]
          * [ Proxy-Info ]
          * [ AVP ]
</pre></div><p>

          
</p>
<p>The QoS-Resources AVP is defined in <a class='info' href='#I-D.ietf-dime-qos-attributes'>[10]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;Traffic Classification and Quality of Service Attributes for Diameter,&rdquo; December&nbsp;2009.</span><span>)</span></a>. 
</p>
<a name="avps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
AVPs</h3>

<p>To provide support for RFC 4285 <a class='info' href='#I-D.ietf-mip6-rfc4285bis'>[4]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; July&nbsp;2008.</span><span>)</span></a> and for RFC 4877
          <a class='info' href='#RFC4877'>[3]<span> (</span><span class='info'>Devarapalli, V. and F. Dupont, &ldquo;Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a> the AVPs in the following subsections are needed. RFC 3588, RFC
        4004 and RFC 4005 defined AVPs are reused whenever possible without violating the existing
        semantics of those AVPs. 
</p>
<p>
        <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                          +--------------------------+
                                          |    AVP Flag rules        |
                                          +----+-----+----+-----+----+
                 AVP  Defined             |    |     |SHLD| MUST|MAY |
 Attribute Name  Code in       Value Type |MUST| MAY | NOT|  NOT|Encr|
+-----------------------------------------+----+-----+----+-----+----+
|MIP6-Feature-   TBD  Note 1   Unsigned64 |    |  P  |    | M,V | Y  |
|  Vector                                 |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-Mobile-                              |    | M,P |    |  V  | Y  |
|Node-Address    334  RFC4004  Address    |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-Home-       334  RFC4004  Address    |    | M,P |    |  V  | Y  |
|  Agent-Address                          |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AVPs for Mobile IPv6 with IKEv2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<p>Note 1: The MIP6-Feature-Vector is defined in Section 4.7.4 of <a class='info' href='#I-D.ietf-dime-mip6-integrated'>[11]<span> (</span><span class='info'>Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C., and K. Chowdhury, &ldquo;Diameter Mobile IPv6: Support for Network Access Server to Diameter Server  Interaction,&rdquo; January&nbsp;2009.</span><span>)</span></a>.
</p>
<p>
        <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                          +--------------------------+
                                          |    AVP Flag rules        |
                                          +----+-----+----+-----+----+
                 AVP  Section             |    |     |SHLD| MUST|MAY |
 Attribute Name  Code Defined  Value Type |MUST| MAY | NOT|  NOT|Encr|
+-----------------------------------------+----+-----+----+-----+----+
|MIP6-Feature-   TBD  Note 1   Unsigned64 |    |  P  |    | M,V | Y  |
|  Vector                                 |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-Mobile-     333  RFC4004  Address    |    | M,P |    |  V  | Y  |
|  Node-Address                           |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-Home-       334  RFC4004  Address    |    | M,P |    |  V  | Y  |
|  Agent-Address                          |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-MN-AAA-SPI  341  RFC4004  Unsigned32 | M  |  P  |    |  V  | Y  |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-Careof-     TBD  5.4.5    Address    | M  |  P  |    |  V  | Y  |
|  Address                                |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-            TBD  5.4.6    OctetString| M  |  P  |    |  V  | Y  |
|  Authenticator                          |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-MAC-        TBD  5.4.7    OctetString| M  |  P  |    |  V  | Y  |
|  Mobility-Data                          |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-Timestamp   TBD  TBD      Time       |    | M,P |    |  V  | Y  |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-Session-Key 343  RFC4004  OctetString| M  |  P  |    |  V  | Y  |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-MSA-        367  RFC4004  Unsigned32 | M  |  P  |    |  V  | Y  |
|  Lifetime                               |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|MIP-MN-to-      331  RFC4004  Grouped    | M  |  P  |    |  V  | Y  |
|  HA-MSA                                 |    |     |    |     |    |
+-----------------------------------------+----+-----+----+-----+----+
|QoS-Capability  TBD  Note 2   Groupe     |    | M,P |    |  V  | Y  |
+-----------------------------------------+----+-----+----+-----+----+
|QoS-Resources   TBD  Note 2   Grouped    |    | M,P |    |  V  | Y  |
+-----------------------------------------+----+-----+----+-----+----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AVPs for the Mobile IPv6 Authentication Protocol&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<p>Note 1: The MIP6-Feature-Vector is defined in Section 4.7.4 of <a class='info' href='#I-D.ietf-dime-mip6-integrated'>[11]<span> (</span><span class='info'>Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C., and K. Chowdhury, &ldquo;Diameter Mobile IPv6: Support for Network Access Server to Diameter Server  Interaction,&rdquo; January&nbsp;2009.</span><span>)</span></a>.
      
</p>
<p>Note 2: The QoS-Capability and QoS-Resource AVPs are defined
          in Sections 4.1 and 4.3 of <a class='info' href='#I-D.ietf-dime-qos-attributes'>[10]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;Traffic Classification and Quality of Service Attributes for Diameter,&rdquo; December&nbsp;2009.</span><span>)</span></a>.
      
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
User-Name AVP</h3>

<p>The User-Name AVP (AVP Code 2) is of type UTF8String and contains an NAI extracted from
          the MN-NAI mobility option included in the received BU message. Alternatively, the NAI can
          be extracted from the IKEv2 IDi payload included in the IKE_SA_INIT message. 
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
MIP-MN-AAA-SPI AVP</h3>

<p>The MIP-MN-AAA-SPI AVP (AVP Code 341) is of type Unsigned32 and contains an SPI code
          extracted from the Mobility Message Authentication Option included in the received BU
          message. 
</p>
<p> This AVP is re-used from <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
MIP-Mobile-Node-Address AVP</h3>

<p>The MIP-Mobile-Node-Address AVP (AVP Code 333) is of type Address and contains the Home
          Agent assigned IPv6 Home Address of the Mobile Node. 
</p>
<p> If the MIP-Mobile-Node-Address AVP contains unspecified IPv6 address (0::0) in a request
          message, then the Home Agent expects the Diameter server to assign the Home Address in a
          subsequent reply message. In case the Diameter server assigns only a prefix to the Mobile
          Node the lower 64 bits of the MIP-Mobile-Node-Address AVP provided address are set to
          zero.
</p>
<p> This AVP is re-used from <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
MIP-Home-Agent-Address AVP</h3>

<p>The MIP-Home-Agent-Address AVP (AVP Code 334) is of type Address and contains the IPv6
          address of the Home Agent. This AVP is re-used from <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
MIP-Careof-Address AVP</h3>

<p>The MIP-Careof-Address AVP (AVP Code TBD) is of type Address and contains the IPv6
          Care-of Address of the Mobile Node. The Home Agent extracts this IP address from the
          received BU message. 
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
MIP-Authenticator AVP</h3>

<p>The MIP-Authenticator AVP (AVP Code TBD) is of type OctetString and contains the
          Authenticator Data from the received BU message. The Home Agent extracts this data from
          the MN-AAA Mobility Message Authentication Option included in the received BU message.
        
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
MIP-MAC-Mobility-Data AVP</h3>

<p>The MIP-MAC-Mobility-Data AVP (AVP Code TBD) is of type OctetString and contains the
          calculated MAC_Mobility_Data, as defined in <a class='info' href='#I-D.ietf-mip6-rfc4285bis'>[4]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; July&nbsp;2008.</span><span>)</span></a>.
        
</p>
<a name="mip-session-key"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.8"></a><h3>6.8.&nbsp;
MIP-Session-Key AVP</h3>

<p>The AVP (AVP Code 343) is of type OctetString and contains the MN-HA shared secret (i.e.,
          the session key) for the associated Mobile IPv6 MH-HA authentication option. When the
          Diameter server computes the session key it is placed in this AVP. 
</p>
<p> This AVP is re-used from <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.9"></a><h3>6.9.&nbsp;
MIP-MSA-Lifetime AVP</h3>

<p>The AVP (AVP Code 367) is of type Unsigned32 and represents the period of time (in
          seconds) for which the session key (see <a class='info' href='#mip-session-key'>Section&nbsp;6.8<span> (</span><span class='info'>MIP-Session-Key AVP</span><span>)</span></a>) or nonce (see
            <a class='info' href='#mip-nonce'>Section&nbsp;6.13<span> (</span><span class='info'>MIP-nonce AVP</span><span>)</span></a>) is valid. The associated session key or nonce MUST NOT be
          used if the lifetime has expired. 
</p>
<p> This AVP is re-used from <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.10"></a><h3>6.10.&nbsp;
MIP-MN-to-HA-MSA AVP</h3>

<p>The AVP (AVP Code 331) is of type Grouped and contains the session related information
          for use with the MIPv6 Auth. Protocol.
</p>
<p>
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
MIP-MN-to-HA-MSA ::= &lt; AVP Header: 331 &gt;
                     { MIP-Algorithm-Type }
                     { MIP-Replay-Mode }
                     { MIP-nonce }
                   * [ AVP ]
</pre></div><p>

        
</p>
<p> This AVP is re-used from <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.11"></a><h3>6.11.&nbsp;
MIP-Algorithm-Type AVP</h3>

<p>The AVP (AVP Code 345) is of type Enumerated and contains Algorithm identifier for the
          associated Mobile IPv6 MN-HA Authentication Option. The Diameter server selects the
          algorithm type. Existing algorithm types are defined in RFC 4004 that also fulfill current
          RFC 4285 requirements. This AVP is re-used from <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.12"></a><h3>6.12.&nbsp;
MIP-Replay-Mode AVP</h3>

<p>The AVP (AVP Code 346) is of type Enumerated and contains the replay mode the Home Agent
          for authenticating the mobile node. The replay modes, defined in RFC 4004 <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, are supported. This AVP is re-used from <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="mip-nonce"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.13"></a><h3>6.13.&nbsp;
MIP-nonce AVP</h3>

<p>The AVP (AVP Code 335) is of type OctetString and contains the nonce sent to the Mobile
          Node. This AVP is re-used from <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>. At the time of writing the MIPv6
          Auth. Protocol does not require use of nonces for replay protection between the MN and the
          Diameter server. Thus, the Home Agent is allowed to ignore the returned MIP-Nonce AVP.
        
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.14"></a><h3>6.14.&nbsp;
MIP6-Feature-Vector AVP</h3>

<p>This AVP is defined in <a class='info' href='#I-D.ietf-dime-mip6-integrated'>[11]<span> (</span><span class='info'>Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C., and K. Chowdhury, &ldquo;Diameter Mobile IPv6: Support for Network Access Server to Diameter Server  Interaction,&rdquo; January&nbsp;2009.</span><span>)</span></a>. 
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.15"></a><h3>6.15.&nbsp;
MIP-Timestamp AVP</h3>

<p>The MIP-Timestamp AVP (AVP Code TBD) is of type Time and may contain the timestamp value
          from the Mobility message replay protection option, defined in <a class='info' href='#I-D.ietf-mip6-rfc4285bis'>[4]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; July&nbsp;2008.</span><span>)</span></a>. The Home Agent extracts this value from the
          received BU message, if available.
</p>
<p>The support for replay protection is an optional feature in <a class='info' href='#I-D.ietf-mip6-rfc4285bis'>[4]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; July&nbsp;2008.</span><span>)</span></a>. When the Diameter server checks the timestamp
          provided by the MN via the HA and recognizes a clock-drift (outside a locally defined
          replay protection window) then it MUST initiate the re-synchronization procedure by
          returning a MIP6-Answer-Message with Result-Code set to MIP6-TIMESTAMP-MISMATCH and
          attaches the MIP-Timestamp AVP including it's current time back to the HA. 
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.16"></a><h3>6.16.&nbsp;
QoS-Capability AVP</h3>

<p>The QoS-Capability AVP is defined in <a class='info' href='#I-D.ietf-dime-qos-attributes'>[10]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;Traffic Classification and Quality of Service Attributes for Diameter,&rdquo; December&nbsp;2009.</span><span>)</span></a> and
          contains a list of supported Quality of Service profiles.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.17"></a><h3>6.17.&nbsp;
QoS-Resources AVP</h3>

<p>The QoS-Resources AVP is defined in <a class='info' href='#I-D.ietf-dime-qos-attributes'>[10]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;Traffic Classification and Quality of Service Attributes for Diameter,&rdquo; December&nbsp;2009.</span><span>)</span></a> and
          provides QoS and packet filtering capabilities. 
</p>
<a name="accounting"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.18"></a><h3>6.18.&nbsp;
Accounting AVPs</h3>

<p>This document reuses the accounting AVPs defined in Diameter Mobile IPv4 application
            <a class='info' href='#RFC4004'>[12]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, namely:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Accounting-Input-Octets:</dt>
<dd><br />
 Number of octets in IP
              packets received from the user<br />
<br />

</dd>
<dt>Accounting-Output-Octets:</dt>
<dd><br />
 Number of octets in IP
              packets sent by the user<br />
<br />

</dd>
<dt>Accounting-Input-Packets:</dt>
<dd><br />
Number of IP packets
              received from the user<br />
<br />

</dd>
<dt>Accounting-Output-Packets:</dt>
<dd><br />
 Number of IP packets
              sent by the user.
</dd>
</dl></blockquote><p>
        
</p>
<a name="result"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Result-Code AVP Values</h3>

<p>This section defines new Result-Code <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> values that MUST be supported
        by all Diameter implementations that conform to this specification.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Transient Failures</h3>

<p> Errors in the transient failures category are used to inform a peer that the request
          could not be satisfied at the time it was received, but that it may be able to satisfy the
          request in the future. 
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>MIP6-TIMESTAMP-MISMATCH    TBD</dt>
<dd><br />
 This error code is
              used by the home agent to indicate to the HA that the timestamp value provided as part
              of the MN-AAA option has an inacceptable clock-drift. 
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Permanent Failures</h3>

<p>Errors that fall within the permanent failures category are used to inform the peer that
          the request failed and SHOULD NOT be attempted again. 
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>DIAMETER_ERROR_END_TO_END_MIP6_KEY_ENCRYPTION     TBD</dt>
<dd><br />
 This error is used by the Diameter server to inform the peer that
              the requested Mobile IPv6 session keys could not be delivered via a security
              association.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
AVP Occurence Tables</h3>

<p>The following tables present the AVPs defined in this document and their occurrences in
        Diameter messages. Note that AVPs that can only be present within a Grouped AVP are not
        represented in this table.
</p>
<p>The table uses the following symbols:
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>0:</dt>
<dd><br />
The AVP MUST NOT be present in the
              message.<br />
<br />

</dd>
<dt>0+:</dt>
<dd><br />
Zero or more instances of the AVP MAY be present
            in the message.<br />
<br />

</dd>
<dt>0-1:</dt>
<dd><br />
Zero or one instance of the AVP MAY be present
            in the message.<br />
<br />

</dd>
<dt>1:</dt>
<dd><br />
One instance of the AVP MUST be present in the
            message. 
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
AAR, AAA, DER, DEA, MRM and MAM AVP/Command-Code Table</h3>

<p>
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                  +-----------------------------------+
                                  |           Command-Code            |
                                  |-----+-----+-----+-----+-----+-----+
   AVP Name                       | AAR | AAA | DER | DEA | MRM | MAM |
   -------------------------------|-----+-----|-----+-----+-----+-----+
   MIP6-Feature-Vector            | 0-1 | 0-1 | 0-1 | 0-1 | 0-1 | 0-1 |
   MIP-Mobile-Node-Address        |  1  | 0-1 |  1  | 0-1 |  1  | 0-1 |
   MIP-MN-AAA-SPI                 |  0  |  0  |  0  |  0  |  1  |  0  |
   MIP-Home-Agent-Address         | 0-1 |  0  | 0-1 |  0  |  1  |  0  |
   MIP-Careof-Address             |  0  |  0  |  0  |  0  |  1  |  0  |
   MIP-Authenticator              |  0  |  0  |  0  |  0  |  1  |  0  |
   MIP-MAC-Mobility-Data          |  0  |  0  |  0  |  0  |  1  |  0  |
   MIP-Session-Key                |  0  |  0  |  0  |  0  |  0  |  1  |
   MIP-MSA-Lifetime               |  0  |  0  |  0  |  0  |  0  |  1  |
   MIP-MN-to-HA-MSA               |  0  |  0  |  0  |  0  |  0  |  1  |
   MIP-Timestamp                  |  0  |  0  |  0  |  0  | 0-1 | 0-1 |
   QoS-Resources  (1)             |  0  |  0  |  0  |  0  |  *0 | *0  |
   QoS-Capability (1)             |  0  |  0  |  0  |  0  | 0-1 |  0  |
                                  +-----+-----+-----+-----+-----+-----+
</pre></div><p>

        
</p>
<p>Note (1): The QoS-Capability and QoS-Resources AVPs usage with Diameter EAP and Diameter NASREQ is
           already defined in <a class='info' href='#I-D.ietf-dime-qos-attributes'>[10]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;Traffic Classification and Quality of Service Attributes for Diameter,&rdquo; December&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Accounting AVP Table</h3>

<p> The table in this section is used to represent which AVPs defined in this document are
          to be present in the Accounting messages, as defined in <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
</p>
<p>
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                           +-------------+
                                           | Command-Code|
                                           |------+------+
      Attribute Name                       |  ACR |  ACA |
      -------------------------------------|------+------+
      Accounting-Input-Octets              |  1   |  0-1 |
      Accounting-Input-Packets             |  1   |  0-1 |
      Accounting-Output-Octets             |  1   |  0-1 |
      Accounting-Output-Packets            |  1   |  0-1 |
      Acct-Multi-Session-Id                |  1   |  0-1 |
      Acct-Session-Time                    |  1   |  0-1 |
      MIP6-Feature-Vector                  |  1   |  0-1 |
      MIP-Home-Agent-Address               |  1   |  0-1 |
      MIP-Mobile-Node-Address              |  1   |  0-1 |
      Event-Timestamp                      | 0-1  |   0  |
      -------------------------------------|------+------+
</pre></div><p>

        
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This section contains the namespaces that have either been created in this specification or
        had their values assigned to existing namespaces managed by IANA.
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Command Codes</h3>

<p> IANA is requested to allocate a command code value for the MIP6-Request-Message (MRM)
          and for the MIP6-Answer-Message (MAM) from the Command Code namespace defined in <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. See <a class='info' href='#Command-Code-Values'>Section&nbsp;5<span> (</span><span class='info'>Command Codes</span><span>)</span></a> for the assignment of the
          namespace in this specification. 
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
AVP Codes</h3>

<p> This specification requires IANA to register the following new AVPs from the AVP Code
          namespace defined in <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. </p>
<ul class="text">
<li>MIP-Careof-Address
</li>
<li>MIP-Authenticator
</li>
<li>MIP-MAC-Mobility-Data
</li>
<li>MIP-Timestamp
</li>
</ul><p> The AVPs are defined in <a class='info' href='#avps'>Section&nbsp;6<span> (</span><span class='info'>AVPs</span><span>)</span></a>. 
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Result-Code AVP Values</h3>

<p> This specification requests IANA to allocate new values to the Result-Code AVP (AVP Code
          268) namespace defined in <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. See <a class='info' href='#result'>Section&nbsp;7<span> (</span><span class='info'>Result-Code AVP Values</span><span>)</span></a> for the
          assignment of the namespace in this specification. 
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
Application Identifier</h3>

<p> This specification requires IANA to allocate a new value for "Diameter Mobile IPv6" from
          the Application Identifier namespace defined in <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. 
</p>
<a name="SecurityConsiderations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p> The security considerations for the Diameter interaction required to accomplish the split
        scenario are described in in <a class='info' href='#I-D.ietf-mip6-bootstrapping-split'>[13]<span> (</span><span class='info'>Giaretta, G., &ldquo;Mobile IPv6 bootstrapping in split scenario,&rdquo; July&nbsp;2007.</span><span>)</span></a>.
        Additionally, the security considerations of the Diameter Base protocol <a class='info' href='#RFC3588'>[5]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>, Diameter EAP application <a class='info' href='#RFC4072'>[7]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> are applicable to
        this document. This document does not introduce new security vulnerabilities. 
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thanks Jari Arkko, Tolga Asversen, Pasi Eronen, Santiago Zapata
        Hernandez, Anders Kristensen, Avi Lior, John Loughney, Ahmad Muhanna, Behcet Sarikaya,
        Basavaraj Patil, Vijay Devarapalli, Lionel Morand and Yoshihiro Ohba for all the useful
        discussions. Ahmad Muhanna provided a detailed review of the
        document in August 2007.
</p>
<p>We would also like to thank our Area Director, Dan Romascanu, for his support.
</p>
<p>Hannes Tschofenig would like to thank the European Commission support in the co-funding of
        the ENABLE project, where this work is partly being developed.
</p>
<p>Julien Bournelle would like to thank GEN/INT since he began this work while he was under
        their employ.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3775">[1]</a></td>
<td class="author-text">Johnson, D., Perkins, C., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3775">Mobility Support in IPv6</a>,&rdquo; RFC&nbsp;3775, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3775.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4640">[2]</a></td>
<td class="author-text">Patel, A. and G. Giaretta, &ldquo;<a href="http://tools.ietf.org/html/rfc4640">Problem Statement for bootstrapping Mobile IPv6 (MIPv6)</a>,&rdquo; RFC&nbsp;4640, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4640.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4877">[3]</a></td>
<td class="author-text">Devarapalli, V. and F. Dupont, &ldquo;<a href="http://tools.ietf.org/html/rfc4877">Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture</a>,&rdquo; RFC&nbsp;4877, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4877.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip6-rfc4285bis">[4]</a></td>
<td class="author-text">Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-rfc4285bis-03.txt">Authentication Protocol for Mobile IPv6</a>,&rdquo; draft-ietf-mip6-rfc4285bis-03 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-rfc4285bis-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3588">[5]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[6]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4072">[7]</a></td>
<td class="author-text">Eronen, P., Hiller, T., and G. Zorn, &ldquo;<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>,&rdquo; RFC&nbsp;4072, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4072.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[8]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4005">[9]</a></td>
<td class="author-text">Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;<a href="http://tools.ietf.org/html/rfc4005">Diameter Network Access Server Application</a>,&rdquo; RFC&nbsp;4005, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4005.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dime-qos-attributes">[10]</a></td>
<td class="author-text">Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-qos-attributes-15.txt">Traffic Classification and Quality of Service Attributes for Diameter</a>,&rdquo; draft-ietf-dime-qos-attributes-15 (work in progress), December&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-qos-attributes-15.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dime-mip6-integrated">[11]</a></td>
<td class="author-text">Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C., and K. Chowdhury, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-mip6-integrated-12.txt">Diameter Mobile IPv6: Support for Network Access Server to Diameter Server  Interaction</a>,&rdquo; draft-ietf-dime-mip6-integrated-12 (work in progress), January&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-mip6-integrated-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4004">[12]</a></td>
<td class="author-text">Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;<a href="http://tools.ietf.org/html/rfc4004">Diameter Mobile IPv4 Application</a>,&rdquo; RFC&nbsp;4004, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4004.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip6-bootstrapping-split">[13]</a></td>
<td class="author-text">Giaretta, G., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-bootstrapping-split-07.txt">Mobile IPv6 bootstrapping in split scenario</a>,&rdquo; draft-ietf-mip6-bootstrapping-split-07 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-bootstrapping-split-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip6-bootstrapping-integrated-dhc">[14]</a></td>
<td class="author-text">Chowdhury, K. and A. Yegin, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-bootstrapping-integrated-dhc-06.txt">MIP6-bootstrapping for the Integrated Scenario</a>,&rdquo; draft-ietf-mip6-bootstrapping-integrated-dhc-06 (work in progress), April&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-bootstrapping-integrated-dhc-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip6-aaa-ha-goals">[15]</a></td>
<td class="author-text">Giaretta, G., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-aaa-ha-goals-03.txt">AAA Goals for Mobile IPv6</a>,&rdquo; draft-ietf-mip6-aaa-ha-goals-03 (work in progress), September&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-aaa-ha-goals-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dime-app-design-guide">[16]</a></td>
<td class="author-text">Fajardo, V., Tschofenig, H., and L. Morand, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-app-design-guide-11.txt">Diameter Applications Design Guidelines</a>,&rdquo; draft-ietf-dime-app-design-guide-11 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-app-design-guide-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4283">[17]</a></td>
<td class="author-text">Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;<a href="http://tools.ietf.org/html/rfc4283">Mobile Node Identifier Option for Mobile IPv6 (MIPv6)</a>,&rdquo; RFC&nbsp;4283, November&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4283.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jouni Korhonen (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">TeliaSonera</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Teollisuuskatu 13</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sonera  FIN-00051</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jouni.korhonen@teliasonera.com">jouni.korhonen@teliasonera.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Otto-Hahn-Ring 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Munich, Bavaria  81739</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@nsn.com">Hannes.Tschofenig@nsn.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.com">http://www.tschofenig.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Julien Bournelle</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France Telecom R&amp;D</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">38-4O rue du general Leclerc</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Issy-Les-Moulineaux  92794</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:julien.bournelle@orange-ftgroup.com">julien.bournelle@orange-ftgroup.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gerardo Giaretta</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Qualcomm</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gerardo.giaretta@gmail.com">gerardo.giaretta@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Madjid Nakhjiri</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Motorola</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:madjid.nakhjiri@motorola.com">madjid.nakhjiri@motorola.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
