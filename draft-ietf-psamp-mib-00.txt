
Internet Draft                                                  T. Dietz
Document: draft-ietf-psamp-mib-00.txt                    NEC Europe Ltd.
Expires: December 2003                                      D. Romascanu
                                                              Avaya Inc.
                                                               B. Claise
                                                      Cisco Systems Inc.

                                                               June 2003


           Definitions of Managed Objects for Packet Sampling
                     <draft-ietf-psamp-mib-00.txt>

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC 2026.  Internet-Drafts are
   working documents of the Internet Engineering Task Force (IETF), its
   areas, and its working groups.  Note that other groups may also
   distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   Distribution of this document is unlimited.


Abstract

   This memo defines managed objects for packet sampling.  These objects
   provide information about managed nodes supporting packet sampling,
   including packet sampling capabilities, configuration and statistics.
   They also allow to configure packet sampling concerning the IP
   interface at which packets are sampled, the packet selections methods
   used for sampling, and the collector to which packet samples are
   exported.







Dietz et al.          draft-ietf-psamp-mib-00.txt               [Page 1]

Internet-Draft                 PSAMP MIB                       June 2003


Table of Contents

   1 Introduction .................................................    2
   2 The Internet-Standard Management Framework ...................    2
   3 Structure of the PSAMP MIB module ............................    3
   3.1 The Methods Group ..........................................    3
   3.1.1 Selecting All Packets ....................................    3
   3.1.2 Count-based Systematic Sampling ..........................    3
   3.1.3 Time-based Systematic Sampling ...........................    4
   3.1.4 n-out-of-N Random Sampling ...............................    4
   3.1.5 Probabilistic Sampling ...................................    5
   3.2 The Reporting Group ........................................    5
   3.3 The Instance Group .........................................    5
   4 Definitions ..................................................    6
   5 Security Considerations ......................................   19
   6 Open Issues ..................................................   20
   7 Acknowledgments ..............................................   20
   8 Normative References .........................................   20
   9 Informative References .......................................   20
   10 Authors' Addresses ..........................................   20
   11 IPR Notices .................................................   21
   12 Full Copyright Statement ....................................   22


1.  Introduction

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

   This document is a product of the Packet Sampling (PSAMP) working
   group. Its purpose is to define standards-based MIB modules for
   monitoring and configuring managed nodes performaing packet sampling.

   It is assumed that packet sampling is performed according to the
   framework defined in [PS-FMWK].  Packet selection methods considered
   in the MIB module are specified in [PS-PSEL]. Configuration of the
   export of samples to a collector is modeled according to [PS-TRSP].

   Section 2 describes the structure of the PSAMP MIB module and Section
   3 contains the formal definition. Security issues are discussed in
   Section 5.


2.  The Internet-Standard Management Framework

   For a detailed overview of the documents that describe the current
   Internet-Standard Management Framework, please refer to section 7 of
   RFC 3410 [RFC3410].


Dietz et al.          draft-ietf-psamp-mib-00.txt               [Page 2]

Internet-Draft                 PSAMP MIB                       June 2003


   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  MIB objects are generally
   accessed through the Simple Network Management Protocol (SNMP).
   Objects in the MIB are defined using the mechanisms defined in the
   Structure of Management Information (SMI).  This memo specifies a MIB
   module that is compliant to the SMIv2, which is described in STD 58,
   RFC 2578 [RFC2578], STD 58, RFC 2579 [RFC2579] and STD 58, RFC 2580
   [RFC2580].


3.  Structure of the PSAMP MIB module

   This first draft does not contain a complete PSAMP MIB module
   definition, but some essential components of it sketching the
   structure of the complete module.  The sketch serves as input to a
   discussion of the MIB module structure, particular of the modelling
   of capabilities and configured packet sampling instances. Please find
   a (not complete) list of open issues at the end of the document.

   The PSAMP-MIB module defined below contains three groups of objects:
   the methods group, the reporting group, and the instances group.

3.1.  The Methods Group

   The first group of objects contains information about sampling
   methods.  Each sampling method is covered by an indovidual sub-tree
   of this group.  For each method, the following objects are defined: a
   single object indicating the availability of the method, a sub-group
   of objects indicating specific capabilities and limits of the method,
   and a sub-group specifying sets of parameters. Each parameter set
   uniquely specifies all paramerters of a packet sampling instance of
   the method.

   Methods and parameters of methods are specified in draft-ietf-psamp-
   sample-tech-01.txt. So far, objects for four methodss defined in this
   Internet drafts are contained in the PSAMP MIB module plus an
   additional trivial method.  Further methods need to be added later.
   The five methods are selecting all, count-based systematic sampling,
   time-based systematic sampling, n-out-of-N random sampling and
   probabilistic sampling.

3.1.1.  Selecting All Packets

   This trivial packet selection method is alway available.  If it is
   applied, all packets will be selected.

3.1.2.  Count-based Systematic Sampling

   Count-based systematic sampling is specified in Sections 4 and 5 of
   draft-ietf-psamp-sample-tech-01.txt. The first object in this group


Dietz et al.          draft-ietf-psamp-mib-00.txt               [Page 3]

Internet-Draft                 PSAMP MIB                       June 2003


   is psampSystematicCountBasedSamplingAvailability indicating the
   availability of this method.

   It is followed by a sub-group of objects specifying capabilities.
   psampSystematicCountBasedSamplingMaxInterval indicates the maximum
   sampling interval in packets supported by the implementation,
   psampSystematicCountBasedSamplingMaxSpacing indicates the maximum
   spacing in packets supported by the implementation.

   Finally psampSystematicCountBasedSamplingParameterSetTable contains a
   parameter set in each of its entries that completely specifies a
   configuration of an instance of the packet sampling method.  These
   parameter sets are not necessarily instantiated at the managed node,
   but for each instanciated paramter set of this method, there MUST be
   an entry in this table. The parameter set contains two parameters:
   the sampling interval length and the spacing specified in numbers of
   packets.

3.1.3.  Time-based Systematic Sampling

   Time-based systematic sampling is specified in Sections 4 and 5 of
   draft-ietf-psamp-sample-tech-01.txt. The first object in this group
   is psampSystematicTimeBasedSamplingAvailability indicating the
   availability of this method.

   It is followed by a sub-group of objects specifying capabilities.
   psampSystematicTimeBasedSamplingMaxInterval indicates the maximum
   sampling interval in microseconds supported by the implementation,
   psampSystematicTimeBasedSamplingMaxSpacing indicates the maximum
   spacing in microseconds supported by the implementation.

   Finally psampSystematicTimeBasedSamplingParameterSetTable contains a
   parameter set in each of its entries that completely specifies a
   configuration of an instance of the packet sampling method.  These
   parameter sets are not necessarily instantiated at the managed node,
   but for each instanciated paramter set of this method, there MUST be
   an entry in this table. The parameter set contains two parameters:
   the sampling interval length and the spacing specified in
   microseconds.

3.1.4.  n-out-of-N Random Sampling

   n-out-of-N Random sampling is specified in Sections 4 and 5 of
   draft-ietf-psamp-sample-tech-01.txt. The first object in this group
   is psampRandomOutOfNSamplingAvailability indicating the availability
   of this method.

   So far, the sub-group of objects specifying capabilities is empty for
   this method.


Dietz et al.          draft-ietf-psamp-mib-00.txt               [Page 4]

Internet-Draft                 PSAMP MIB                       June 2003


   The psampRandomOutOfNSamplingParameterSetTable contains a parameter
   set in each of its entries that completely specifies a configuration
   of an instance of the packet sampling method.  These parameter sets
   are not necessarily instantiated at the managed node, but for each
   instanciated paramter set of this method, there MUST be an entry in
   this table. The parameter set contains a single parameter only, the
   sampling rate.

3.1.5.  Probabilistic Sampling

   Probabilistic sampling is specified in Sections 4 and 5 of draft-
   ietf-psamp-sample-tech-01.txt. The first object in this group is
   psampRandomProbabilisticSamplingAvailability indicating the
   availability of this method.

   So far, the sub-group of objects specifying capabilities is empty for
   this method.

   The psampRandomProbabilisticSamplingParameterSetTable contains a
   parameter set in each of its entries that completely specifies a
   configuration of an instance of the packet sampling method.  These
   parameter sets are not necessarily instantiated at the managed node,
   but for each instanciated paramter set of this method, there MUST be
   an entry in this table. The parameter set contains a single parameter
   only, the sampling rate.


3.2.  The Reporting Group

   The reporting group of managed objects provides information on
   collectors to which sampled packets are exported and they allow to
   configure collectors.

   The group contains a single table, the psampCollectorTable.  Each
   entry of this table specifies a collector by its IP address, used
   transport protocol and port number.  Also it contains the number of
   reports sent to this collector.


3.3.  The Instance Group

   The instance group of managed objects provides information about
   active packet sampling instances at the managed node.  It also allows
   to create new instances and to terminate them.

   The group contains a single table, the psampInstanceTable.  Each
   entry of this table describes an instance by the IP interface it is
   acting at, by the two packet selection methods it is sequentially
   executing, and by the collector to which reports on sampled packets
   are sent.


Dietz et al.          draft-ietf-psamp-mib-00.txt               [Page 5]

Internet-Draft                 PSAMP MIB                       June 2003


   Each instance can use up to two packet selection methods. The first
   one is applied to the packet stream at the IP interface, the second
   one is applied to the stream of sampled packets produced by the first
   method.  Each method is specified by a reference to a method-specific
   parameter set. Collectors are specified by an index of the
   psampCollectorTable.

   The following statistics is available for each instance: number of
   packets observed by method 1 before sampling, number of packets
   observed by method 2 before sampling (this is the number of packets
   sampled by method 1), and the number of reports on sampled packets
   sent to the collector.


4.  Definitions

   PSAMP-MIB DEFINITIONS ::= BEGIN

   IMPORTS
       MODULE-IDENTITY, OBJECT-TYPE, Integer32, mib-2
           FROM SNMPv2-SMI                  -- RFC2578
       TEXTUAL-CONVENTION
           FROM SNMPv2-TC                   -- RFC2579
       MODULE-COMPLIANCE, OBJECT-GROUP
           FROM SNMPv2-CONF                 -- RFC2580
       InterfaceIndex                       -- RFC2863
           FROM IF-MIB
       InetAddressType, InetAddress
           FROM INET-ADDRESS-MIB;           -- RFC3291

   psampMIB MODULE-IDENTITY
       LAST-UPDATED "200306222314Z"         -- 22 June 2003
       ORGANIZATION "IETF Packet Sampling Working Group"
       CONTACT-INFO
           "Thomas Dietz
           NEC Europe Ltd.
           Network Laboratories
           Kurfuersten-Anlage 36
           69115 Heidelberg
           Germany
           Phone: +49 6221 90511-28
           Email: quittek@ccrle.nec.de"
       DESCRIPTION
           "The PSAMP MIB defines managed objects for packet sampling.
           These objects provide information about managed nodes
           supporting packet sampling, including packet sampling
           capabilities, configuration and statistics.  They also allow
           to configure packet sampling concerning the IP interface at
           which packets are sampled, the packet selections methods used
           for sampling, and the collector to which packet samples are


Dietz et al.          draft-ietf-psamp-mib-00.txt               [Page 6]

Internet-Draft                 PSAMP MIB                       June 2003


           exported."

        --  Revision history

        REVISION     "200306222314Z"         -- 22 June 2003
        DESCRIPTION
            "Initial version."

       ::= { mib-2 333 }
   -- XXX to be assigned by IANA.

   -- Textual Conventions

   PsampMethodAvailability ::= TEXTUAL-CONVENTION
       STATUS  current
       DESCRIPTION
           "Used to report the availability of a packet selection method:

            available(1) - the method is supported and can be used
            notAvailable(2) - the mothos is not available"
       SYNTAX      INTEGER {
                       available(1),
                       notAvailable(2)
                   }

   -- Top level structure of the MIB

   psampObjects       OBJECT IDENTIFIER ::= { psampMIB 1 }
   psampConformance   OBJECT IDENTIFIER ::= { psampMIB 2 }

   -- Packet selection methods group of objects

   psampMethods        OBJECT IDENTIFIER ::= { psampObjects 1 }

   -- Method 0: Selecting All Packets

   psampSelectingAll OBJECT IDENTIFIER ::= { psampMethods 0 }

   psampSelectingAllAvailability OBJECT-TYPE
       SYNTAX      PsampMethodAvailability
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
          "When retrieved, this object indicates the availability
          of the trivial method of selecting all packets."
       DEFVAL { available }
       ::= { psampSelectingAll 1 }

   -- Method 1: Systematic Count-based Sampling


Dietz et al.          draft-ietf-psamp-mib-00.txt               [Page 7]

Internet-Draft                 PSAMP MIB                       June 2003


   psampSystematicCountBasedSampling OBJECT IDENTIFIER ::= { psampMethods 1 }

   psampSystematicCountBasedSamplingAvailability OBJECT-TYPE
       SYNTAX      PsampMethodAvailability
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
          "When retrieved, this object indicates the availability
          of systematic count-based sampling at the managed node."
       DEFVAL { notAvailable }
       ::= { psampSystematicCountBasedSampling 1 }

   psampSystematicCountBasedSamplingCapabilities OBJECT IDENTIFIER
       ::= { psampSystematicCountBasedSampling 2 }

   psampSystematicCountBasedSamplingMaxInterval OBJECT-TYPE
       SYNTAX      Integer32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
          "When retrieved, this object indicates the the maximum
          number that can be specified for the sampling interval."
       ::= { psampSystematicCountBasedSamplingCapabilities 1 }

   psampSystematicCountBasedSamplingMaxSpacing OBJECT-TYPE
       SYNTAX      Integer32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
          "When retrieved, this object indicates the the maximum
          number that can be specified for the sampling spacing."
       ::= { psampSystematicCountBasedSamplingCapabilities 2 }

   psampSystematicCountBasedSamplingParameterSetTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF
                   PsampSystematicCountBasedSamplingParameterSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "This table lists configurations of systematic count-
           based packet sampling.  A parameter set describing a
           configuration contains two parameters: the sampling
           interval length and the spacing."
       ::= { psampSystematicCountBasedSampling 3 }

   psampSystematicCountBasedSamplingParameterSetEntry OBJECT-TYPE
       SYNTAX      PsampSystematicCountBasedSamplingParameterSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION


Dietz et al.          draft-ietf-psamp-mib-00.txt               [Page 8]

Internet-Draft                 PSAMP MIB                       June 2003


           "Defines an entry in the
           psampSystematicCountBasedSamplingParameterSetTable."
       INDEX { psampSystematicCountBasedSamplingIndex }
       ::= { psampSystematicCountBasedSamplingParameterSetTable 1 }

   PsampSystematicCountBasedSamplingParameterSetEntry ::=
       SEQUENCE {
           psampSystematicCountBasedSamplingIndex     Integer32,
           psampSystematicCountBasedSamplingInterval  Integer32,
           psampSystematicCountBasedSamplingSpacing   Integer32
       }

   psampSystematicCountBasedSamplingIndex OBJECT-TYPE
       SYNTAX      Integer32 (1..2147483647)
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The index of this parameter set in the
          psampSystematicCountBasedSamplingParameterSetTable.
          It is used in entries of the psampInstanceTable as
          reference to this parameter set."
       ::= { psampSystematicCountBasedSamplingParameterSetEntry 1 }

   psampSystematicCountBasedSamplingInterval OBJECT-TYPE
       SYNTAX      Integer32
       UNITS       "number of packets"
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
          "When retrieved, this object specifies the sampling
          interval for systematic count-based sampling."
       REFERENCE
           "draft-ietf-psamp-sample-tech-01.txt, Section 5.1"
       ::= { psampSystematicCountBasedSamplingParameterSetEntry 2 }

   psampSystematicCountBasedSamplingSpacing OBJECT-TYPE
       SYNTAX      Integer32
       UNITS       "number of packets"
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
          "When retrieved, this object specifies the sampling
          spacing for systematic count-based sampling."
       REFERENCE
           "draft-ietf-psamp-sample-tech-01.txt, Section 5.1"
       ::= { psampSystematicCountBasedSamplingParameterSetEntry 3 }

   -- Method 2: Systematic Time-based Sampling

   psampSystematicTimeBasedSampling OBJECT IDENTIFIER ::= { psampMethods 2 }


Dietz et al.          draft-ietf-psamp-mib-00.txt               [Page 9]

Internet-Draft                 PSAMP MIB                       June 2003


   psampSystematicTimeBasedSamplingAvailability OBJECT-TYPE
       SYNTAX      PsampMethodAvailability
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
          "When retrieved, this object indicates the availability
          of systematic time-based sampling at the managed node."
       DEFVAL { notAvailable }
       ::= { psampSystematicTimeBasedSampling 1 }

   psampSystematicTimeBasedSamplingCapabilities OBJECT IDENTIFIER
       ::= { psampSystematicTimeBasedSampling 2 }

   psampSystematicTimeBasedSamplingMaxInterval OBJECT-TYPE
       SYNTAX      Integer32
       UNITS       "microseconds"
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
          "When retrieved, this object indicates the the maximum
          number that can be specified for the sampling interval."
       ::= { psampSystematicTimeBasedSamplingCapabilities 1 }

   psampSystematicTimeBasedSamplingMaxSpacing OBJECT-TYPE
       SYNTAX      Integer32
       UNITS       "microseconds"
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
          "When retrieved, this object indicates the the maximum
          number that can be specified for the sampling spacing."
       ::= { psampSystematicTimeBasedSamplingCapabilities 2 }

   psampSystematicTimeBasedSamplingParameterSetTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF
                   PsampSystematicTimeBasedSamplingParameterSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "This table lists configurations of systematic time-
           based packet sampling.  A parameter set describing a
           configuration contains two parameters: the sampling
           interval length and the spacing."
       ::= { psampSystematicTimeBasedSampling 3 }

   psampSystematicTimeBasedSamplingParameterSetEntry OBJECT-TYPE
       SYNTAX      PsampSystematicTimeBasedSamplingParameterSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 10]

Internet-Draft                 PSAMP MIB                       June 2003


           "Defines an entry in the
           psampSystematicTimeBasedSamplingParameterSetTable."
       INDEX { psampSystematicTimeBasedSamplingIndex }
       ::= { psampSystematicTimeBasedSamplingParameterSetTable 1 }

   PsampSystematicTimeBasedSamplingParameterSetEntry ::=
       SEQUENCE {
           psampSystematicTimeBasedSamplingIndex     Integer32,
           psampSystematicTimeBasedSamplingInterval  Integer32,
           psampSystematicTimeBasedSamplingSpacing   Integer32
       }

   psampSystematicTimeBasedSamplingIndex OBJECT-TYPE
       SYNTAX      Integer32 (1..2147483647)
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The index of this parameter set in the
          psampSystematicTimeBasedSamplingParameterSetTable.
          It is used in entries of the psampInstanceTable as
          reference to this parameter set."
       ::= { psampSystematicTimeBasedSamplingParameterSetEntry 1 }

   psampSystematicTimeBasedSamplingInterval OBJECT-TYPE
       SYNTAX      Integer32
       UNITS       "microseconds"        -- might still be too coarse grained
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
          "When retrieved, this object specifies a sampling
          interval for systematic time-based sampling."
       REFERENCE
           "draft-ietf-psamp-sample-tech-01.txt, Section 5.1"
       ::= { psampSystematicTimeBasedSamplingParameterSetEntry 2 }

   psampSystematicTimeBasedSamplingSpacing OBJECT-TYPE
       SYNTAX      Integer32
       UNITS       "microseconds"        -- might still be too coarse grained
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
          "When retrieved, this object specifies a sampling
          spacing for systematic time-based sampling."
       REFERENCE
           "draft-ietf-psamp-sample-tech-01.txt, Section 5.1"
       ::= { psampSystematicTimeBasedSamplingParameterSetEntry 3 }

   -- Method 3: Random n-out-of-N Sampling

   psampRandomOutOfNSampling OBJECT IDENTIFIER ::= { psampMethods 3 }


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 11]

Internet-Draft                 PSAMP MIB                       June 2003


   psampRandomOutOfNSamplingAvailability OBJECT-TYPE
       SYNTAX      PsampMethodAvailability
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
          "When retrieved, this object indicates the availability
          of random n-out-of-N sampling at the managed node."
       DEFVAL { notAvailable }
       ::= { psampRandomOutOfNSampling 1 }

   psampRandomOutOfNSamplingCapabilities OBJECT IDENTIFIER
       ::= { psampRandomOutOfNSampling 2 }

   -- No capabilities defined, yet.

   psampRandomOutOfNSamplingParameterSetTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF
                   PsampRandomOutOfNSamplingParameterSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "This table lists configurations of random n-out-of-N
           sampling.  A parameter set describing a configuration
           contains a single parameter only: the sampling rate."
       ::= { psampRandomOutOfNSampling 3 }

   psampRandomOutOfNSamplingParameterSetEntry OBJECT-TYPE
       SYNTAX      PsampRandomOutOfNSamplingParameterSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "Defines an entry in the
           psampRandomOutOfNSamplingParameterSetTable."
       INDEX { psampRandomOutOfNSamplingIndex }
       ::= { psampRandomOutOfNSamplingParameterSetTable 1 }

   PsampRandomOutOfNSamplingParameterSetEntry ::=
       SEQUENCE {
           psampRandomOutOfNSamplingIndex     Integer32,
           psampRandomOutOfNSamplingRate      Integer32
       }

   psampRandomOutOfNSamplingIndex OBJECT-TYPE
       SYNTAX      Integer32 (1..2147483647)
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The index of this parameter set in the
          psampRandomOutOfNSamplingParameterSetTable.
          It is used in entries of the psampInstanceTable as


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 12]

Internet-Draft                 PSAMP MIB                       June 2003


          reference to this parameter set."
       ::= { psampRandomOutOfNSamplingParameterSetEntry 1 }

   psampRandomOutOfNSamplingRate OBJECT-TYPE
       SYNTAX      Integer32
       UNITS       "1/1000000"
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
          "When retrieved, this object specifies a sampling
          rate for random n-out-of-N sampling."
       REFERENCE
           "draft-ietf-psamp-sample-tech-01.txt, Section 5.2"
       ::= { psampRandomOutOfNSamplingParameterSetEntry 2 }

   -- Method 4: Random Probabilistic Sampling

   psampRandomProbabilisticSampling OBJECT IDENTIFIER ::= { psampMethods 4 }

   psampRandomProbabilisticSamplingAvailability OBJECT-TYPE
       SYNTAX      PsampMethodAvailability
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
          "When retrieved, this object indicates the availability
          of random probabilisticf sampling at the managed node."
       DEFVAL { notAvailable }
       ::= { psampRandomProbabilisticSampling 1 }

   psampRandomProbabilisticSamplingCapabilities OBJECT IDENTIFIER
       ::= { psampRandomProbabilisticSampling 2 }

   -- No capabilities defined, yet.

   psampRandomProbabilisticSamplingParameterSetTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF
                   PsampRandomProbabilisticSamplingParameterSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "This table lists configurations of random probabilistic
           sampling.  A parameter set describing a configuration
           contains a single parameter only: the sampling rate."
       ::= { psampRandomProbabilisticSampling 3 }

   psampRandomProbabilisticSamplingParameterSetEntry OBJECT-TYPE
       SYNTAX      PsampRandomProbabilisticSamplingParameterSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 13]

Internet-Draft                 PSAMP MIB                       June 2003


           "Defines an entry in the
           psampRandomProbabilisticSamplingParameterSetTable."
       INDEX { psampRandomProbabilisticSamplingIndex }
       ::= { psampRandomProbabilisticSamplingParameterSetTable 1 }

   PsampRandomProbabilisticSamplingParameterSetEntry ::=
       SEQUENCE {
           psampRandomProbabilisticSamplingIndex     Integer32,
           psampRandomProbabilisticSamplingRate      Integer32
       }

   psampRandomProbabilisticSamplingIndex OBJECT-TYPE
       SYNTAX      Integer32 (1..2147483647)
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The index of this parameter set in the
          psampRandomProbabilisticSamplingParameterSetTable.
          It is used in entries of the psampInstanceTable as
          reference to this parameter set."
       ::= { psampRandomProbabilisticSamplingParameterSetEntry 1 }

   psampRandomProbabilisticSamplingRate OBJECT-TYPE
       SYNTAX      Integer32
       UNITS       "1/1000000"
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
          "When retrieved, this object specifies a sampling
          rate for random probabilistic sampling."
       REFERENCE
           "draft-ietf-psamp-sample-tech-01.txt, Section 5.2"
       ::= { psampRandomProbabilisticSamplingParameterSetEntry 2 }

   -- Reporting Group

   psampReporting        OBJECT IDENTIFIER ::= { psampObjects 2 }

   psampCollectorTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF PsampCollectorEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "This table lists collectors to which sampled packets are
           exported."
       ::= { psampReporting 1 }

   psampCollectorEntry OBJECT-TYPE
       SYNTAX      PsampCollectorEntry
       MAX-ACCESS  not-accessible


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 14]

Internet-Draft                 PSAMP MIB                       June 2003


       STATUS      current
       DESCRIPTION
           "Defines an entry in the psampCollectorTable."
       INDEX { psampCollectorIndex }
       ::= { psampCollectorTable 1 }

   PsampCollectorEntry ::= SEQUENCE {
           psampCollectorIndex                Integer32,
           psampCollectorTargetIpAddressType  InetAddressType,
           psampCollectorTargetIpAddress      InetAddress,
           psampCollectorTargetProtocol       Integer32,
           psampCollectorTargetPort           Integer32,
           psampCollectorReportsSent          Integer32
       }

   psampCollectorIndex OBJECT-TYPE
       SYNTAX      Integer32 (1..2147483647)
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "The locally arbitrary, but unique identifier of
           a collector.

           The value is expected to remain constant at least from one
           re-initialization of the entity's network management system
           to the next re-initialization."
       ::= { psampCollectorEntry 1 }

   psampCollectorTargetIpAddressType OBJECT-TYPE
       SYNTAX      InetAddressType
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The IP address type of the collector."
       ::= { psampCollectorEntry 2 }

   psampCollectorTargetIpAddress OBJECT-TYPE
       SYNTAX      InetAddress
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The IP address of the collector."
       ::= { psampCollectorEntry 3 }

   psampCollectorTargetProtocol OBJECT-TYPE
       SYNTAX      Integer32
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The transport protocol used for exporting sampled


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 15]

Internet-Draft                 PSAMP MIB                       June 2003


           packets to the collector. Allowed values are ... "
       ::= { psampCollectorEntry 4 }

   psampCollectorTargetPort OBJECT-TYPE
       SYNTAX      Integer32
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The port number of the collector."
       ::= { psampCollectorEntry 5 }

   psampCollectorReportsSent OBJECT-TYPE
       SYNTAX      Integer32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The number of reports sent to the collector."
       ::= { psampCollectorEntry 6 }

   -- Instance Group

   psampInstances        OBJECT IDENTIFIER ::= { psampObjects 3 }

   psampInstanceTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF PsampInstanceEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "This table lists active instances of packet sampling at
           the managed node."
       ::= { psampInstances 1 }

   psampInstanceEntry OBJECT-TYPE
       SYNTAX      PsampInstanceEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "Defines an entry in the psampInstanceTable."
       INDEX { psampInstanceIndex }
       ::= { psampInstanceTable 1 }

   PsampInstanceEntry ::= SEQUENCE {
           psampInstanceIndex              Integer32,
           psampInstanceIfIndex            InterfaceIndex,
           psampInstanceParameterSet1      OBJECT IDENTIFIER,
           psampInstanceParameterSet2      OBJECT IDENTIFIER,
           psampInstanceCollectorIndex     Integer32,
           psampInstancePacketsObserved1   Integer32,
           psampInstancePacketsObserved2   Integer32,
           psampInstanceReportsSent        Integer32


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 16]

Internet-Draft                 PSAMP MIB                       June 2003


       }

   psampInstanceIndex OBJECT-TYPE
       SYNTAX      Integer32 (1..2147483647)
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "The locally arbitrary, but unique identifier of
           an instance.

           The value is expected to remain constant at least from one
           re-initialization of the entity's network management system
           to the next re-initialization."
       ::= { psampInstanceEntry 1 }

   psampInstanceIfIndex OBJECT-TYPE
       SYNTAX      InterfaceIndex
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "Index of the IP interface at which the packet stream
           is observed by packet selection method 1."
       ::= { psampInstanceEntry 2 }

   psampInstanceParameterSet1 OBJECT-TYPE
       SYNTAX      OBJECT IDENTIFIER
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The OID of a parameter set in one of the method-specific
           tables in the Methods group.

           The identified method is applied to the stream of packets
           observed at the interface."
       ::= { psampInstanceEntry 3 }

   psampInstanceParameterSet2 OBJECT-TYPE
       SYNTAX      OBJECT IDENTIFIER
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The OID of a parameter set in one of the method-specific
           tables in the Methods group.

           The identified method is applied to the stream of packets
           sampled by the method identified by parameter set 1."
       ::= { psampInstanceEntry 4 }

   psampInstanceCollectorIndex OBJECT-TYPE
       SYNTAX      Integer32


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 17]

Internet-Draft                 PSAMP MIB                       June 2003


       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The index of the collector to which packet reports are sent."
       ::= { psampInstanceEntry 5 }

   psampInstancePacketsObserved1 OBJECT-TYPE
       SYNTAX      Integer32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The number of packets observed by method 1 before selecting
           packets."
       ::= { psampInstanceEntry 6 }

   psampInstancePacketsObserved2 OBJECT-TYPE
       SYNTAX      Integer32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The number of packets observed by method 2 before selecting
           packets.  This is the number of packets sampled by method 1."
       ::= { psampInstanceEntry 7 }

   psampInstanceReportsSent OBJECT-TYPE
       SYNTAX      Integer32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The number of reports on sampled packets sent to the
           collector."
       ::= { psampInstanceEntry 8 }

    -- Conformance information
    -- Compliance statements

    psampCompliances OBJECT IDENTIFIER ::= { psampConformance 1 }
    psampGroups      OBJECT IDENTIFIER ::= { psampConformance 2 }

    -- Compliance statements

    psampCompliance MODULE-COMPLIANCE
       STATUS  current
       DESCRIPTION
               "The compliance statement for the PSAMP-MIB."
       MODULE  -- this module
           MANDATORY-GROUPS { psampGroup }
       ::= { psampCompliances 1 }

    -- MIB groupings


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 18]

Internet-Draft                 PSAMP MIB                       June 2003


    psampGroup OBJECT-GROUP
      OBJECTS {
                psampSelectingAllAvailability,
                psampSystematicCountBasedSamplingAvailability,
                psampSystematicCountBasedSamplingMaxInterval,
                psampSystematicCountBasedSamplingMaxSpacing,
                psampSystematicCountBasedSamplingInterval,
                psampSystematicCountBasedSamplingSpacing,
                psampSystematicTimeBasedSamplingAvailability,
                psampSystematicTimeBasedSamplingMaxInterval,
                psampSystematicTimeBasedSamplingMaxSpacing,
                psampSystematicTimeBasedSamplingInterval,
                psampSystematicTimeBasedSamplingInterval,
                psampSystematicTimeBasedSamplingSpacing,
                psampRandomOutOfNSamplingAvailability,
                psampRandomOutOfNSamplingRate,
                psampRandomProbabilisticSamplingAvailability,
                psampRandomProbabilisticSamplingRate,
                psampCollectorTargetIpAddressType,
                psampCollectorTargetIpAddress,
                psampCollectorTargetProtocol,
                psampCollectorTargetPort,
                psampCollectorReportsSent,
                psampInstanceIfIndex,
                psampInstanceParameterSet1,
                psampInstanceParameterSet2,
                psampInstanceCollectorIndex,
                psampInstancePacketsObserved1,
                psampInstancePacketsObserved2,
                psampInstanceReportsSent
              }
      STATUS  current
      DESCRIPTION
          "The group of all accessible objects of the PSAMP MIB."
       ::= { psampGroups 1 }

   END


5.  Security Considerations

   There are a number of management objects defined in this MIB module
   with a MAX-ACCESS clause of read-write and/or read-create.  Such
   objects may be considered sensitive or vulnerable in some network
   environments.  The support for SET operations in a non-secure
   environment without proper protection can have a negative effect on
   network operations.  These are the tables and objects and their
   sensitivity/vulnerability:

   To be done.


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 19]

Internet-Draft                 PSAMP MIB                       June 2003


6.  Open Issues

      - add row status objects to writable tables
      - add support for reporting from a single instance to multiple collectors
      - elaborate conformance statements
      - complete security considerations
      - ...


7.  Acknowledgments

   This document is a product of the PSAMP working group.


8.  Normative References

[RFC2578]   McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
            Rose, M. and S. Waldbusser, "Structure of Management
            Information Version 2 (SMIv2)", STD 58, RFC 2578, April
            1999.

[RFC2579]   McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
            Rose, M. and S. Waldbusser, "Textual Conventions for SMIv2",
            STD 58, RFC 2579, April 1999.

[RFC2580]   McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
            Rose, M. and S. Waldbusser, "Conformance Statements for
            SMIv2", STD 58, RFC 2580, April 1999.


9.  Informative References

[RFC2119]   S. Bradner "Key words for use in RFCs to Indicate
            Requirement Levels", RFC 2119, March 1997.

[RFC3410]   Case, J., Mundy, R., Partain, D. and B. Stewart,
            "Introduction and Applicability Statements for Internet-
            Standard Management Framework", RFC 3410, December 2002.


10.  Authors' Addresses

     Thomas Dietz
     NEC Europe Ltd.
     Network Laboratories
     Kurfuersten-Anlage 34
     69115 Heidelberg
     Germany
     Phone: +49 6221 90511-28
     EMail: quittek@ccrle.nec.de


Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 20]

Internet-Draft                 PSAMP MIB                       June 2003


     Dan Romascanu
     Avaya Inc.
     Atidim Technology Park
     Bldg. #3
     Tel Aviv, 61131
     Israel
     Phone: +972-3-545-8414
     Email: dromasca@avaya.com

     Benoit Claise
     Cisco Systems
     De Kleetlaan 6a b1
     1831 Degem
     Belgium
     Phone: +32 2 704 5622
     Email: bclaise@cisco.com


11.  IPR Notices

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights.  Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in BCP-11.  Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.












Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 21]

Internet-Draft                 PSAMP MIB                       June 2003


12.  Full Copyright Statement

   Copyright (C) The Internet Society (2003). All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implmentation may be prepared, copied, published and
   distributed, in whole or in part, without restriction of any kind,
   provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the  purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
























Dietz et al.          draft-ietf-psamp-mib-00.txt              [Page 22]
