<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>TLS Origin-Bound Certificates</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Extension Dependencies">
<link href="#rfc.section.2" rel="Chapter" title="2 Origin-Bound Certificates">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Certificate Creation">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Origin-Bound Certificate Extension">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Certificate and Key Rotation">
<link href="#rfc.section.3" rel="Chapter" title="3 Changes to The Handshake Message Contents">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Extension Definition">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Client Hello">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Server Hello">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Certificate Request">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Client Certificate">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Third-Party Tracking">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Server Tracking">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Cookie Hardening">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Key Lengths">
<link href="#rfc.references" rel="Chapter" title="5 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document specifies a Transport Layer Security (TLS) extension and associated semantics that allow clients and servers to negotiate the use of origin-bound, self-signed certificates for TLS client authentication." />
  <meta name="description" content="This document specifies a Transport Layer Security (TLS) extension and associated semantics that allow clients and servers to negotiate the use of origin-bound, self-signed certificates for TLS client authentication." />
  <meta name="keywords" content="TLS, PKI" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">D.B. Balfanz, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">D.S. Smetters</td>
</tr>
<tr>
<td class="left">Expires: May 17, 2012</td>
<td class="right">M.U. Upadhyay</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A.B. Barth</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Google Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">November 14, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">TLS Origin-Bound Certificates<br />
  <span class="filename">draft-balfanz-tls-obc-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document specifies a Transport Layer Security (TLS) extension and associated semantics that allow clients and servers to negotiate the use of origin-bound, self-signed certificates for TLS client authentication.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 17, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Extension Dependencies</a>
</li>
<li>2.   <a href="#rfc.section.2">Origin-Bound Certificates</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Certificate Creation</a>
</li>
<li>2.1.1.   <a href="#rfc.section.2.1.1">Origin-Bound Certificate Extension</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Certificate and Key Rotation</a>
</li>
<li>3.   <a href="#rfc.section.3">Changes to The Handshake Message Contents</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Extension Definition</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Client Hello</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Server Hello</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Certificate Request</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Client Certificate</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Third-Party Tracking</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Server Tracking</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Cookie Hardening</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Key Lengths</a>
</li>
<li>5.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">Transport Layer Security (<a href="#RFC5246">TLS</a> <cite title="NONE">[RFC5246]</cite>) allows clients to authenticate themselves using Client Certificates. In practice, clients tend to ask for user consent before using Client Certificates. This is to allay privacy concerns about user-identifying information in the Client Certificate, and also to let the user choose among possibly many certificates that can be used by the client for the TLS session.</p>
<p id="rfc.section.1.p.2">The user experience of obtaining this consent, along with that of obtaining the certificates in the first place, has traditionally presented a hurdle to user adoption. Additionally, operational constraints on the server side can make it difficult for service providers to switch from a cookie-based authentication scheme to certificate-based TLS client authentication.</p>
<p id="rfc.section.1.p.3">The TLS Origin-Bound Certificates extension (TLS-OBC) is a <a href="#RFC6066">TLS extension</a> <cite title="NONE">[RFC6066]</cite> that allows clients to use certificate-based client authentication without having to obtain user consent before using certificates. A client creates at most one (self-signed) certificate of any given type (e.g., rsa_sign or ecdsa_sign) per <a href="#WebOrigin">web origin</a> <cite title="NONE">[WebOrigin]</cite>, and does not include user-identifying information into such origin-bound certificates, thus making user consent and user-assisted certificate selection unnecessary.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Extension Dependencies</h1>
<p id="rfc.section.1.2.p.1">The client SHOULD use TLS-OBC during a TLS session only if it also uses the <a href="#EncryptedClientCerts">TLS Encrypted Client Certificates</a> <cite title="NONE">[EncryptedClientCerts]</cite> extension during that TLS session.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Origin-Bound Certificates</h1>
<p id="rfc.section.2.p.1">An origin-bound certificate is a self-issued certificate that the client uses for TLS client authentication for a particular <a href="#WebOrigin">web origin</a> <cite title="NONE">[WebOrigin]</cite>. Origin-bound certificates MUST be self-signed, i.e., a private key corresponding to the certified public key MUST be used to sign the certificate.</p>
<p id="rfc.section.2.p.2">Clients MUST NOT re-use the same origin-bound certificate for more than one web origin.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Certificate Creation</h1>
<p id="rfc.section.2.1.p.1">Clients create origin-bound certificates when asked to perform TLS client authentication after negotiating the <samp>ob_cert</samp> extension with a server from that origin (see <a href="#ClientCertificateMessage">Section 3.5</a>), and they do not already have a valid origin-bound certificate for that origin available for use.</p>
<p id="rfc.section.2.1.p.2">Clients SHOULD NOT re-use the same key pair for more than one origin-bound certificate. To do so would violate the privacy properties required by origin-bound certificates.</p>
<p id="rfc.section.2.1.p.3">When creating an origin-bound certificate, it is RECOMMENDED that clients use the PrintableString representation of "anonymous.invalid" as the common name component of the Distinguished Name of both the certificate's Issuer and Subject, with no other name components present.</p>
<p id="rfc.section.2.1.p.4">It is RECOMMENDED that clients pick a lifetime for the new certificate between one month and one year (perhaps depending on an assessment of how well the private key is protected on the host platform). The client SHALL use the notBefore and notAfter fields in the new certificate to record the lifetime of the new certificate.</p>
<h1 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> <a href="#x509extension" id="x509extension">Origin-Bound Certificate Extension</a>
</h1>
<p id="rfc.section.2.1.1.p.1">Origin-bound certificates MUST be X.509 v3 certificates, and MUST include the origin-bound certificate extension (OID 1.3.6.1.4.1.11129.2.1.6), shown below.  This extension MUST be marked critical.</p>
<p id="rfc.section.2.1.1.p.2">The data of the extension, <samp>OriginBoundCertificate</samp>, will be the ASCII Serialization of the certificate's <a href="#WebOrigin">web origin</a> <cite title="NONE">[WebOrigin]</cite> as an IA5String.</p>
<div id="#rfc.figure.1"></div>
<div id="#figure_extension"></div>
<pre>
 id-ce-originBoundCertificate OBJECT IDENTIFIER ::=
         { enterprises Google 2 1 6 }

 OriginBoundCertificate ::= 
         IA5String
	    </pre>
<p id="rfc.section.2.1.1.p.3">The server MAY reject the origin-bound certificate if it determines that the web origin included in the <samp>OriginBoundCertificate</samp> extension does not match the server's origin (for example, if it doesn't match the host name specified in the Server Name Indication TLS extension). It is, however, RECOMMENDED that the server merely report the value of the web origin to the upper layers in the protocol stack, and leave it up to those layers to make use of the web origin value (e.g., to assist developers in debugging the feature).</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Certificate and Key Rotation</h1>
<p id="rfc.section.2.2.p.1">After a client has created an origin-bound certificate for a certain web origin, the client SHOULD re-use the certificate for a period of time, and then discard it.</p>
<p id="rfc.section.2.2.p.2">The client MUST discard existing origin-bound certificate at or before the notAfter time indicated in each certificate.</p>
<p id="rfc.section.2.2.p.3">The client MAY opt to discard an existing origin-bound certificate at any time of its choosing prior to the notAfter time indicated in the certificate. In particular, the client may delete an existing origin-bound certificate in response to a user request to clear privacy-sensitive state from their user-agent, ensuring that a fresh certificate will be generated the next time a user visits that origin.</p>
<p id="rfc.section.2.2.p.4">The client SHOULD use a new key pair when it generates a new origin-bound certificate.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Changes to The Handshake Message Contents</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Extension Definition</h1>
<p id="rfc.section.3.1.p.1">This document defines a new TLS extension, <samp>ob_cert</samp> (with tentative extension type 13175, or 0x3377), which indicates that client and server agree to allow the client to use an origin-bound certificate to authenticate itself to the server.</p>
<p id="rfc.section.3.1.p.2">To indicate support for origin-bound certificates, the client includes an extension of type <samp>ob_cert</samp> in the Extended Client Hello message. To indicate that a subsequent CertificateRequest message requests an origin-bound certificate, the server includes the same extension in its Extended Server Hello message.</p>
<p id="rfc.section.3.1.p.3">The <samp>ob_cert</samp> TLS extension will be assigned a value from the TLS ExtensionType registry, and will contain zero length <samp>extension_data</samp>. For testing, we will use the extension type value of 0x3377. For this type value, the entire encoding of the extension will be 33 77 00 00.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Client Hello</h1>
<p id="rfc.section.3.2.p.1">A client wishing to indicate support for origin-bound client certificates MUST include the <samp>ob_cert</samp> in the extended Client Hello message to a server from a particular web origin.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Server Hello</h1>
<p id="rfc.section.3.3.p.1">A server that receives a Client Hello message containing the <samp>ob_cert</samp> extension MAY choose to include the same extension in the extended Server Hello message. If it does, the client and server are considered to have negotiated origin-bound client certificates for the session.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Certificate Request</h1>
<p id="rfc.section.3.4.p.1">A server MAY choose to send a Certificate Request message to the client. If the session uses origin-bound client certificates, the server SHOULD use an empty <samp>certificate_authorities</samp> list.</p>
<p id="rfc.section.3.4.p.2">A client that receives a Certificate Request during a session for which origin-bound client certificates were negotiated MUST ignore the <samp>certificate_authorities</samp> list.</p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#ClientCertificateMessage" id="ClientCertificateMessage">Client Certificate</a>
</h1>
<p><a href="#RFC5246">TLS</a> <cite title="NONE">[RFC5246]</cite> requires that a client that receives a Certificate Request message must send a Client Certificate message in response (which may or may not include client certificates). If client and server negotiated origin-bound client certificates, then the client SHOULD include an origin-bound certificate in the Client Certificate message.</p>
<p id="rfc.section.3.5.p.2">If a client includes an origin-bound certificate in the Client Certificate message during a session for which origin-bound client certificates were negotiated, the included certificate MUST </p>

<ul>
<li>be an origin-bound certificate for the web origin of the server, and </li>
<li>match a certificate type requested by the server in the Certificate Request message.</li>
</ul>
<p id="rfc.section.3.5.p.3">If a client doesn't possess a certificate meeting the above requirements, it SHOULD self-issue a certificate of a type requested by the server in the Certificate Request message and include the newly-generated certificate in the Client Certificate message. Only if the client is not capable of providing a certificate of the requested type SHOULD it include an empty <samp>certificate_list</samp> in the Client Certificate message.</p>
<p id="rfc.section.3.5.p.4">A server verifying a Client Certificate message in a handshake that negotiated origin-bound client certificates MUST verify that the certificate is self-signed, rather than being signed by any particular CA. The server MUST verify that the public key in the certificate corresponds to the key used to authenticate the client in the handshake. The server SHOULD ignore the Issuer and Subject in the presented certificate. The server MUST ignore the notBefore and notAfter fields in the certificate.</p>
<p id="rfc.section.3.5.p.5">Finally, the server MUST verify that the certificate contains the origin-bound extension, and MAY verify that the origin identified in that certificate matches the server (see <a href="#x509extension">Section 2.1.1</a>).</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Security Considerations</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Third-Party Tracking</h1>
<p id="rfc.section.4.1.p.1">A third party might be able to track a client across multiple sessions by observing the use of the same origin-bound certificate. To alleviate this concern, clients SHOULD also implement the <a href="#EncryptedClientCerts">Encrypted Client Certificates Extension</a> <cite title="NONE">[EncryptedClientCerts]</cite>, and use it concurrently with TLS-OBC. The <a href="#EncryptedClientCerts">Encrypted Client Certificates Extension</a> <cite title="NONE">[EncryptedClientCerts]</cite> ensures that the origin-bound certificate is sent after TLS established secrecy on the channel between client and server.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Server Tracking</h1>
<p id="rfc.section.4.2.p.1">A client can prevent server tacking by deleting the origin-bound certificate for the server's Web origin. This could happen, for example, when the user elects to remove all cookies for that origin.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Cookie Hardening</h1>
<p id="rfc.section.4.3.p.1">One way TLS-OBC can be used to strengthen cookie-based authentication is by "binding" cookies to an origin-bound certificate. The server, when issuing a cookie for an HTTP session, would associate the client's origin-bound certificate with the session (either by encoding information about the certificate unforgeably in the cookie, or by associating the certificate with the cookie's session through some other means). That way, if and when a cookie gets stolen from a client, it cannot be used over a TLS connection initiated by a different client - the cookie thief would also have to steal the private key associated with the client's origin-bound certificate, a task considerably harder especially when we assume the existence of a Trusted Platform Module or other Secure Element that can store the origin-bound-certificate's private key.</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> Key Lengths</h1>
<p id="rfc.section.4.4.p.1">If the client uses RSA key pairs, the key length should be at least 1024 bits. For longer-lived origin-bound certificates, the key length should be 2048 bits.</p>
<p id="rfc.section.4.4.p.2">If the client uses ECDSA key pairs, the key length should be at least 160 bits.</p>
<h1 id="rfc.references">
<a href="#rfc.references">5.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6066">[RFC6066]</b></td>
<td class="top">
<a>Eastlake, D.</a>, "<a href="http://tools.ietf.org/html/rfc6066">Transport Layer Security (TLS) Extensions: Extension Definitions</a>", RFC 6066, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="WebOrigin">[WebOrigin]</b></td>
<td class="top">
<a>Barth, A.B.</a>, "<a>The Web Origin Concept</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="EncryptedClientCerts">[EncryptedClientCerts]</b></td>
<td class="top">
<a>Langley, A.L.</a>, "<a>TLS Encrypted Client Certificates</a>", .</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dirk Balfanz</span> editor
	  <span class="n hidden">
		<span class="family-name">Balfanz</span>
	  </span>
	</span>
	<span class="org vcardline">Google Inc.</span>
	<span class="adr">
	  <span>1600 Ampitheatre Parkway</span>

	  <span class="vcardline">
		<span class="locality">Mountain View</span>,  
		<span class="region">CA</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:balfanz@google.com">balfanz@google.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">D K Smetters</span> 
	  <span class="n hidden">
		<span class="family-name">Smetters</span>
	  </span>
	</span>
	<span class="org vcardline">Google Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	
  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mayank Upadhyay</span> 
	  <span class="n hidden">
		<span class="family-name">Upadhyay</span>
	  </span>
	</span>
	<span class="org vcardline">Google Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	
  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Adam Barth</span> 
	  <span class="n hidden">
		<span class="family-name">Barth</span>
	  </span>
	</span>
	<span class="org vcardline">Google Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	
  </address>
</div>

</body>
</html>