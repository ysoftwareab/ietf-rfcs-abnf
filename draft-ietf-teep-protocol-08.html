<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Trusted Execution Environment Provisioning (TEEP) Protocol</title>
<meta content="Hannes Tschofenig" name="author">
<meta content="Mingliang Pei" name="author">
<meta content="David Wheeler" name="author">
<meta content="Dave Thaler" name="author">
<meta content="Akira Tsukamoto" name="author">
<meta content="
       This document specifies a protocol that installs, updates, and deletes
Trusted Components in a device with a Trusted Execution
Environment (TEE).  This specification defines an interoperable
protocol for managing the lifecycle of Trusted Components. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="Trusted Execution Environment" name="keyword">
<meta content="draft-ietf-teep-protocol-08" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-teep-protocol-08-xvjb8m7j.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TEEP Protocol</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tschofenig, et al.</td>
<td class="center">Expires 8 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TEEP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-teep-protocol-08</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-07" class="published">7 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-08">8 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">Arm Ltd.</div>
</div>
<div class="author">
      <div class="author-name">M. Pei</div>
<div class="org">Broadcom</div>
</div>
<div class="author">
      <div class="author-name">D. Wheeler</div>
<div class="org">Amazon</div>
</div>
<div class="author">
      <div class="author-name">D. Thaler</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">A. Tsukamoto</div>
<div class="org">AIST</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Trusted Execution Environment Provisioning (TEEP) Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a protocol that installs, updates, and deletes
Trusted Components in a device with a Trusted Execution
Environment (TEE).  This specification defines an interoperable
protocol for managing the lifecycle of Trusted Components.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-12">
<a href="#name-status-of-this-memo-12" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-12">
<a href="#name-copyright-notice-12" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-12">
<a href="#name-table-of-contents-12" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-11" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology-7" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-message-overview" class="xref">Message Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-detailed-messages-specifica" class="xref">Detailed Messages Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-creating-and-validating-tee" class="xref">Creating and Validating TEEP Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-creating-a-teep-message" class="xref">Creating a TEEP message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-validating-a-teep-message" class="xref">Validating a TEEP Message</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-queryrequest-message" class="xref">QueryRequest Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-queryresponse-message" class="xref">QueryResponse Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-evidence-and-attestation-re" class="xref">Evidence and Attestation Results</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-update-message" class="xref">Update Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.  <a href="#name-example-1-having-one-suit-m" class="xref">Example 1: Having one SUIT Manifest pointing to a URI of a Trusted Component Binary</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.  <a href="#name-example-2-having-a-suit-man" class="xref">Example 2: Having a SUIT Manifest include the Trusted Component Binary</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="xref">4.4.3</a>.  <a href="#name-example-3-supplying-persona" class="xref">Example 3: Supplying Personalization Data for the Trusted Component Binary</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="xref">4.4.4</a>.  <a href="#name-example-4-unlinking-trusted" class="xref">Example 4: Unlinking Trusted Component</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-success-message" class="xref">Success Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-error-message" class="xref">Error Message</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-eat-profile" class="xref">EAT Profile</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-mapping-of-teep-message-par" class="xref">Mapping of TEEP Message Parameters to CBOR Labels</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-behavior-specification" class="xref">Behavior Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-tam-behavior" class="xref">TAM Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-teep-agent-behavior" class="xref">TEEP Agent Behavior</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-ciphersuites" class="xref">Ciphersuites</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-freshness-mechanisms" class="xref">Freshness Mechanisms</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations-12" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-iana-considerations-12" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-media-type-registration" class="xref">Media Type Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-freshness-mechanism-registr" class="xref">Freshness Mechanism Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-references-10" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-normative-references-12" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-informative-references-10" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="xref"></a><a href="#name-a-contributors" class="xref">A. Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="xref"></a><a href="#name-b-acknowledgements" class="xref">B. Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="xref"></a><a href="#name-c-complete-cddl" class="xref">C. Complete CDDL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="xref"></a><a href="#name-d-examples-of-diagnostic-no" class="xref">D. Examples of Diagnostic Notation and Binary Representation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#appendix-D.1" class="xref"></a><a href="#name-d1-queryrequest-message" class="xref">D.1. QueryRequest Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1.2.1">
                    <p id="section-toc.1-1.16.2.1.2.1.1"><a href="#appendix-D.1.1" class="xref"></a><a href="#name-d11-cbor-diagnostic-notatio" class="xref">D.1.1. CBOR Diagnostic Notation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1.2.2">
                    <p id="section-toc.1-1.16.2.1.2.2.1"><a href="#appendix-D.1.2" class="xref"></a><a href="#name-d12-cbor-binary-representat" class="xref">D.1.2. CBOR Binary Representation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#appendix-D.2" class="xref"></a><a href="#name-d2-entity-attestation-token" class="xref">D.2. Entity Attestation Token</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2.2.1">
                    <p id="section-toc.1-1.16.2.2.2.1.1"><a href="#appendix-D.2.1" class="xref"></a><a href="#name-d21-cbor-diagnostic-notatio" class="xref">D.2.1. CBOR Diagnostic Notation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.3">
                <p id="section-toc.1-1.16.2.3.1"><a href="#appendix-D.3" class="xref"></a><a href="#name-d3-queryresponse-message" class="xref">D.3. QueryResponse Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.3.2.1">
                    <p id="section-toc.1-1.16.2.3.2.1.1"><a href="#appendix-D.3.1" class="xref"></a><a href="#name-d31-cbor-diagnostic-notatio" class="xref">D.3.1. CBOR Diagnostic Notation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.3.2.2">
                    <p id="section-toc.1-1.16.2.3.2.2.1"><a href="#appendix-D.3.2" class="xref"></a><a href="#name-d32-cbor-binary-representat" class="xref">D.3.2. CBOR Binary Representation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.4">
                <p id="section-toc.1-1.16.2.4.1"><a href="#appendix-D.4" class="xref"></a><a href="#name-d4-update-message" class="xref">D.4. Update Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.4.2.1">
                    <p id="section-toc.1-1.16.2.4.2.1.1"><a href="#appendix-D.4.1" class="xref"></a><a href="#name-d41-cbor-diagnostic-notatio" class="xref">D.4.1. CBOR Diagnostic Notation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.4.2.2">
                    <p id="section-toc.1-1.16.2.4.2.2.1"><a href="#appendix-D.4.2" class="xref"></a><a href="#name-d42-cbor-binary-representat" class="xref">D.4.2. CBOR Binary Representation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.5">
                <p id="section-toc.1-1.16.2.5.1"><a href="#appendix-D.5" class="xref"></a><a href="#name-d5-success-message" class="xref">D.5. Success Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.5.2.1">
                    <p id="section-toc.1-1.16.2.5.2.1.1"><a href="#appendix-D.5.1" class="xref"></a><a href="#name-d51-cbor-diagnostic-notatio" class="xref">D.5.1. CBOR Diagnostic Notation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.5.2.2">
                    <p id="section-toc.1-1.16.2.5.2.2.1"><a href="#appendix-D.5.2" class="xref"></a><a href="#name-d52-cbor-binary-representat" class="xref">D.5.2. CBOR Binary Representation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.6">
                <p id="section-toc.1-1.16.2.6.1"><a href="#appendix-D.6" class="xref"></a><a href="#name-d6-error-message" class="xref">D.6. Error Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.6.2.1">
                    <p id="section-toc.1-1.16.2.6.2.1.1"><a href="#appendix-D.6.1" class="xref"></a><a href="#name-d61-cbor-diagnostic-notatio" class="xref">D.6.1. CBOR Diagnostic Notation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.6.2.2">
                    <p id="section-toc.1-1.16.2.6.2.2.1"><a href="#appendix-D.6.2" class="xref"></a><a href="#name-d62-cbor-binary-representat" class="xref">D.6.2. CBOR binary Representation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-E" class="xref"></a><a href="#name-e-examples-of-suit-manifest" class="xref">E. Examples of SUIT Manifests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#appendix-E.1" class="xref"></a><a href="#name-example-1-suit-manifest-poi" class="xref">Example 1: SUIT Manifest pointing to URI of the Trusted Component Binary</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.1">
                    <p id="section-toc.1-1.17.2.1.2.1.1"><a href="#appendix-E.1.1" class="xref"></a><a href="#name-cbor-diagnostic-notation-of" class="xref">CBOR Diagnostic Notation of SUIT Manifest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.2">
                    <p id="section-toc.1-1.17.2.1.2.2.1"><a href="#appendix-E.1.2" class="xref"></a><a href="#name-cbor-binary-representation" class="xref">CBOR Binary Representation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.3">
                    <p id="section-toc.1-1.17.2.1.2.3.1"><a href="#appendix-E.1.3" class="xref"></a><a href="#name-cbor-binary-in-hex" class="xref">CBOR Binary in Hex</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#appendix-E.2" class="xref"></a><a href="#name-example-2-suit-manifest-inc" class="xref">Example 2: SUIT Manifest including the Trusted Component Binary</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.1">
                    <p id="section-toc.1-1.17.2.2.2.1.1"><a href="#appendix-E.2.1" class="xref"></a><a href="#name-cbor-diagnostic-notation-of-" class="xref">CBOR Diagnostic Notation of SUIT Manifest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.2">
                    <p id="section-toc.1-1.17.2.2.2.2.1"><a href="#appendix-E.2.2" class="xref"></a><a href="#name-cbor-binary-representation-2" class="xref">CBOR Binary Representation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.3">
                    <p id="section-toc.1-1.17.2.2.2.3.1"><a href="#appendix-E.2.3" class="xref"></a><a href="#name-cbor-binary-in-hex-2" class="xref">CBOR Binary in Hex</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#appendix-E.3" class="xref"></a><a href="#name-example-3-supplying-personal" class="xref">Example 3: Supplying Personalization Data for Trusted Component Binary</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.1">
                    <p id="section-toc.1-1.17.2.3.2.1.1"><a href="#appendix-E.3.1" class="xref"></a><a href="#name-cbor-diagnostic-notation-of-s" class="xref">CBOR Diagnostic Notation of SUIT Manifest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.2">
                    <p id="section-toc.1-1.17.2.3.2.2.1"><a href="#appendix-E.3.2" class="xref"></a><a href="#name-cbor-binary-represenation" class="xref">CBOR Binary Represenation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.3">
                    <p id="section-toc.1-1.17.2.3.2.3.1"><a href="#appendix-E.3.3" class="xref"></a><a href="#name-cbor-binary-in-hex-3" class="xref">CBOR Binary in Hex</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4">
                <p id="section-toc.1-1.17.2.4.1"><a href="#appendix-E.4" class="xref"></a><a href="#name-e4-example-4-unlink-a-trust" class="xref">E.4. Example 4: Unlink a Trusted Component</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4.2.1">
                    <p id="section-toc.1-1.17.2.4.2.1.1"><a href="#appendix-E.4.1" class="xref"></a><a href="#name-cbor-diagnostic-notation-of-su" class="xref">CBOR Diagnostic Notation of SUIT Manifest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4.2.2">
                    <p id="section-toc.1-1.17.2.4.2.2.1"><a href="#appendix-E.4.2" class="xref"></a><a href="#name-cbor-binary-representation-3" class="xref">CBOR Binary Representation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4.2.3">
                    <p id="section-toc.1-1.17.2.4.2.3.1"><a href="#appendix-E.4.3" class="xref"></a><a href="#name-cbor-binary-in-hex-4" class="xref">CBOR Binary in Hex</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-F" class="xref"></a><a href="#name-f-examples-of-suit-reports" class="xref">F. Examples of SUIT Reports</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-F.1" class="xref"></a><a href="#name-f1-example-1-success" class="xref">F.1. Example 1: Success</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-F.2" class="xref"></a><a href="#name-f2-example-2-faiure" class="xref">F.2. Example 2: Faiure</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-G" class="xref"></a><a href="#name-authors-addresses-11" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction-11">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-11" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Trusted Execution Environment (TEE) concept has been designed to
separate a regular operating system, also referred as a Rich Execution
Environment (REE), from security-sensitive applications. In a TEE
ecosystem, device vendors may use different operating systems in the
REE and may use different types of TEEs. When Trusted Component Developers or
Device Administrators use Trusted Application Managers (TAMs) to
install, update, and delete Trusted Applications and their dependencies on a wide range
of devices with potentially different TEEs then an interoperability
need arises.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document specifies the protocol for communicating between a TAM
and a TEEP Agent.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The Trusted Execution Environment Provisioning (TEEP) architecture
document <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span> provides design
guidance and introduces the
necessary terminology.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology-7">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology-7" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This specification re-uses the terminology defined in <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">As explained in Section 4.4 of that document, the TEEP protocol treats
each Trusted Application (TA), any dependencies the TA has, and personalization data as separate
components that are expressed in SUIT manifests, and a SUIT manifest
might contain or reference multiple binaries (see <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>
for more details).<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">As such, the term Trusted Component (TC) in this document refers to a
set of binaries expressed in a SUIT manifest, to be installed in
a TEE.  Note that a Trusted Component may include one or more TAs
and/or configuration data and keys needed by a TA to operate correctly.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Each Trusted Component is uniquely identified by a SUIT Component Identifier
(see <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span> Section 8.7.2.2).<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="messages">
<section id="section-3">
      <h2 id="name-message-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-message-overview" class="section-name selfRef">Message Overview</a>
      </h2>
<p id="section-3-1">The TEEP protocol consists of messages exchanged between a TAM
and a TEEP Agent.
The messages are encoded in CBOR and designed to provide end-to-end security.
TEEP protocol messages are signed by the endpoints, i.e., the TAM and the
TEEP Agent, but Trusted
Applications may also be encrypted and signed by a Trusted Component Developer or
Device Administrator.
The TEEP protocol not only uses
CBOR but also the respective security wrapper, namely COSE <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>. Furthermore, for software updates the SUIT
manifest format <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span> is used, and
for attestation the Entity Attestation Token (EAT) <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span>
format is supported although other attestation formats are also permitted.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">This specification defines five messages: QueryRequest, QueryResponse,
Update, Success, and Error.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">A TAM queries a device's current state with a QueryRequest message.
A TEEP Agent will, after authenticating and authorizing the request, report
attestation information, list all Trusted Components, and provide information about supported
algorithms and extensions in a QueryResponse message. An error message is
returned if the request
could not be processed. A TAM will process the QueryResponse message and
determine
whether to initiate subsequent message exchanges to install, update, or delete Trusted
Applications.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-4">
<pre>
  +------------+           +-------------+
  | TAM        |           |TEEP Agent   |
  +------------+           +-------------+

    QueryRequest -------&gt;

                           QueryResponse

                 &lt;-------     or

                             Error
</pre><a href="#section-3-4" class="pilcrow">¶</a>
</div>
<p id="section-3-5">With the Update message a TAM can instruct a TEEP Agent to install and/or
delete one or more Trusted Components.
The TEEP Agent will process the message, determine whether the TAM is authorized
and whether the
Trusted Component has been signed by an authorized Trusted Component Signer.
A Success message is returned when the operation has been completed successfully,
or an Error message
otherwise.<a href="#section-3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-6">
<pre>
 +------------+           +-------------+
 | TAM        |           |TEEP Agent   |
 +------------+           +-------------+

             Update  ----&gt;

                            Success

                    &lt;----    or

                            Error
</pre><a href="#section-3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="detailmsg">
<section id="section-4">
      <h2 id="name-detailed-messages-specifica">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-detailed-messages-specifica" class="section-name selfRef">Detailed Messages Specification</a>
      </h2>
<p id="section-4-1">TEEP messages are protected by the COSE_Sign1 structure.
The TEEP protocol messages are described in CDDL format <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> below.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-2">
<pre>
{
    teep-message                =&gt; (query-request /
                                    query-response /
                                    update /
                                    teep-success /
                                    teep-error ),
}
</pre><a href="#section-4-2" class="pilcrow">¶</a>
</div>
<div id="creating-and-validating-teep-messages">
<section id="section-4.1">
        <h3 id="name-creating-and-validating-tee">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-creating-and-validating-tee" class="section-name selfRef">Creating and Validating TEEP Messages</a>
        </h3>
<div id="creating-a-teep-message">
<section id="section-4.1.1">
          <h4 id="name-creating-a-teep-message">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-creating-a-teep-message" class="section-name selfRef">Creating a TEEP message</a>
          </h4>
<p id="section-4.1.1-1">To create a TEEP message, the following steps are performed.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1-2">
<li id="section-4.1.1-2.1">Create a TEEP message according to the description below and populate
  it with the respective content.  TEEP messages sent by TAMs (QueryRequest
  and Update) can include a "token".
  The TAM can decide, in any implementation-specific way, whether to include a token
  in a message.  The first usage of a token
  generated by a TAM MUST be randomly created.
  Subsequent token values MUST be different for each subsequent message
  created by a TAM.<a href="#section-4.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-2.2">Create a COSE Header containing the desired set of Header
  Parameters.  The COSE Header MUST be valid per the <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span> specification.<a href="#section-4.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-2.3">Create a COSE_Sign1 object
  using the TEEP message as the COSE_Sign1 Payload; all
  steps specified in <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span> for creating a
  COSE_Sign1 object MUST be followed.<a href="#section-4.1.1-2.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="validation">
<section id="section-4.1.2">
          <h4 id="name-validating-a-teep-message">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-validating-a-teep-message" class="section-name selfRef">Validating a TEEP Message</a>
          </h4>
<p id="section-4.1.2-1">When TEEP message is received (see the ProcessTeepMessage conceptual API
defined in <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span> section 6.2.1),
the following validation steps are performed. If any of
the listed steps fail, then the TEEP message MUST be rejected.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.2-2">
<li id="section-4.1.2-2.1">Verify that the received message is a valid CBOR object.<a href="#section-4.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.2-2.2">Verify that the message contains a COSE_Sign1 structure.<a href="#section-4.1.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.2-2.3">Verify that the resulting COSE Header includes only parameters
  and values whose syntax and semantics are both understood and
  supported or that are specified as being ignored when not
  understood.<a href="#section-4.1.2-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.2-2.4">Follow the steps specified in Section 4 of <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span> ("Signing Objects") for
  validating a COSE_Sign1 object. The COSE_Sign1 payload is the content
  of the TEEP message.<a href="#section-4.1.2-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.2-2.5">Verify that the TEEP message is a valid CBOR map and verify the fields of
  the
  TEEP message according to this specification.<a href="#section-4.1.2-2.5" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="queryrequest-message">
<section id="section-4.2">
        <h3 id="name-queryrequest-message">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-queryrequest-message" class="section-name selfRef">QueryRequest Message</a>
        </h3>
<p id="section-4.2-1">A QueryRequest message is used by the TAM to learn 
information from the TEEP Agent, such as
the features supported by the TEEP Agent, including 
ciphersuites and protocol versions. Additionally, 
the TAM can selectively request data items from the 
TEEP Agent via the request parameter. Currently, 
the following features are supported:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">Request for attestation information,<a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.2">Listing supported extensions,<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.3">Querying installed Trusted Components, and<a href="#section-4.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.4">Listing supported SUIT commands.<a href="#section-4.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-3">Like other TEEP messages, the QueryRequest message is
signed, and the relevant CDDL snippet is shown below. 
The complete CDDL structure is shown in Appendix C.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-4">
<pre>
query-request = [
  type: TEEP-TYPE-query-request,
  options: {
    ? token =&gt; bstr .size (8..64),
    ? supported-cipher-suites =&gt; [ + suite ],
    ? supported-freshness-mechanisms =&gt; [ + freshness-mechanism ],
    ? challenge =&gt; bstr .size (8..512),
    ? versions =&gt; [ + version ],
    * $$query-request-extensions
    * $$teep-option-extensions
  },
  data-item-requested: data-item-requested
]
</pre><a href="#section-4.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2-5">The message has the following fields:<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-6">
          <dt id="section-4.2-6.1">type</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-6.2">
  The value of (1) corresponds to a QueryRequest message sent from the TAM to 
the TEEP Agent.<a href="#section-4.2-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.3">token</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-6.4">
  The value in the token parameter is used to match responses to requests.
This is particularly useful when a TAM issues multiple concurrent requests
to a TEEP Agent. The token MUST be present if and only if the attestation bit is clear in
the data-item-requested value. The size of the token is at least 8 bytes
(64 bits) and maximum of 64 bytes, which is the same as in an EAT Nonce
Claim (see <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span> Section 3.3). The first usage of a token
generated by a TAM MUST be randomly created.
Subsequent token values MUST be different for each request message
to distinguish the correct response from multiple requests.
The token value MUST NOT be used for other purposes, such as a TAM to
identify the devices and/or a device to identify TAMs or Trusted Components.
The TAM SHOULD set an expiration time for each token and MUST ignore any messages with expired tokens.
The TAM MUST expire the token value after receiving the first response
containing the token value and ignore any subsequent messages that have the same token
value.<a href="#section-4.2-6.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.5">data-item-requested</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-6.6">
            <p id="section-4.2-6.6.1">
  The data-item-requested parameter indicates what information the TAM requests from the TEEP
Agent in the form of a bitmap. Each value in the bitmap corresponds to an 
IANA registered information element. This 
specification defines the following initial set of information elements:<a href="#section-4.2-6.6.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-6.6.2">
              <dt id="section-4.2-6.6.2.1">attestation (1)</dt>
              <dd style="margin-left: 1.5em" id="section-4.2-6.6.2.2">
        With this value the TAM requests the TEEP Agent to return attestation
evidence (e.g., an EAT) in the response.<a href="#section-4.2-6.6.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-6.6.2.3">trusted-components (2)</dt>
              <dd style="margin-left: 1.5em" id="section-4.2-6.6.2.4">
        With this value the TAM queries the TEEP Agent for all installed Trusted Components.<a href="#section-4.2-6.6.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-6.6.2.5">extensions (4)</dt>
              <dd style="margin-left: 1.5em" id="section-4.2-6.6.2.6">
        With this value the TAM queries the TEEP Agent for supported capabilities
and extensions, which allows a TAM to discover the capabilities of a TEEP
Agent implementation.<a href="#section-4.2-6.6.2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-4.2-6.6.3">

Further values may be added in the future via IANA registration.<a href="#section-4.2-6.6.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.7">supported-cipher-suites</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-6.8">
  The supported-cipher-suites parameter lists the ciphersuites supported by the TAM. If this parameter is not present, it is to be treated the same as if
it contained all ciphersuites defined in this document that are listed as "MUST". Details
about the ciphersuite encoding can be found in <a href="#ciphersuite" class="xref">Section 8</a>.<a href="#section-4.2-6.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.9">supported-freshness-mechanisms</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-6.10">
  The supported-freshness-mechanisms parameter lists the freshness mechanism(s) supported by the TAM.
Details about the encoding can be found in <a href="#freshness-mechanisms" class="xref">Section 9</a>.
If this parameter is absent, it means only the nonce mechanism is supported.<a href="#section-4.2-6.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.11">challenge</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-6.12">
  The challenge field is an optional parameter used for ensuring the freshness of the
attestation evidence returned with a QueryResponse message. It MUST be absent if
the attestation bit is clear (since the token is used instead in that case).
When a challenge is 
provided in the QueryRequest and an EAT is returned with a QueryResponse message
then the challenge contained in this request MUST be used to generate the EAT,
such as by copying the challenge into the nonce claim found in the EAT if
using the Nonce freshness mechanism.  For more details see <a href="#freshness-mechanisms" class="xref">Section 9</a>.

If any format other than EAT is used, it is up to that
format to define the use of the challenge field.<a href="#section-4.2-6.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.13">versions</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-6.14">
  The versions parameter enumerates the TEEP protocol version(s) supported by the TAM.
A value of 0 refers to the current version of the TEEP protocol.
If this field is not present, it is to be treated the same as if
it contained only version 0.<a href="#section-4.2-6.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="query-response">
<section id="section-4.3">
        <h3 id="name-queryresponse-message">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-queryresponse-message" class="section-name selfRef">QueryResponse Message</a>
        </h3>
<p id="section-4.3-1">The QueryResponse message is the successful response by the TEEP Agent after 
receiving a QueryRequest message.  As discussed in <a href="#agent" class="xref">Section 7.2</a>, it can also be sent
unsolicited if the contents of the QueryRequest are already known and do not vary
per message.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Like other TEEP messages, the QueryResponse message is
signed, and the relevant CDDL snippet is shown below. 
The complete CDDL structure is shown in Appendix C.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-3">
<pre>
query-response = [
  type: TEEP-TYPE-query-response,
  options: {
    ? token =&gt; bstr .size (8..64),
    ? selected-cipher-suite =&gt; suite,
    ? selected-version =&gt; version,
    ? evidence-format =&gt; text,
    ? evidence =&gt; bstr,
    ? tc-list =&gt; [ + tc-info ],
    ? requested-tc-list =&gt; [ + requested-tc-info ],
    ? unneeded-tc-list =&gt; [ + SUIT_Component_Identifier ],
    ? ext-list =&gt; [ + ext-info ],
    * $$query-response-extensions,
    * $$teep-option-extensions
  }
]

tc-info = {
  component-id =&gt; SUIT_Component_Identifier,
  ? tc-manifest-sequence-number =&gt; .within uint .size 8
}

requested-tc-info = {
  component-id =&gt; SUIT_Component_Identifier,
  ? tc-manifest-sequence-number =&gt; .within uint .size 8
  ? have-binary =&gt; bool
}
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3-4">The QueryResponse message has the following fields:<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-5">
          <dt id="section-4.3-5.1">type</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.2">
  The value of (2) corresponds to a QueryResponse message sent from the TEEP Agent
to the TAM.<a href="#section-4.3-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.3">token</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.4">
  The value in the token parameter is used to match responses to requests. The
value MUST correspond to the value received with the QueryRequest message
if one was present, and MUST be absent if no token was present in the
QueryRequest.<a href="#section-4.3-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.5">selected-cipher-suite</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.6">
  The selected-cipher-suite parameter indicates the selected ciphersuite. Details
about the ciphersuite encoding can be found in <a href="#ciphersuite" class="xref">Section 8</a>.<a href="#section-4.3-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.7">selected-version</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.8">
  The selected-version parameter indicates the TEEP protocol version selected by the
TEEP Agent. The absense of this parameter indicates the same as if it
was present with a value of 0.<a href="#section-4.3-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.9">evidence-format</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.10">
  The evidence-format parameter indicates the IANA Media Type of the
attestation evidence contained in the evidence parameter.  It MUST be
present if the evidence parameter is present and the format is not an EAT.<a href="#section-4.3-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.11">evidence</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.12">
  The evidence parameter contains the attestation evidence.  This parameter
MUST be present if the QueryResponse is sent in response to a QueryRequest
with the attestation bit set.  If the evidence-format parameter is absent,
the attestation evidence contained in this parameter MUST be
an Entity Attestation Token following the encoding
defined in <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span>.  See <a href="#evidence" class="xref">Section 4.3.1</a> for further discussion.<a href="#section-4.3-5.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.13">tc-list</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.14">
  The tc-list parameter enumerates the Trusted Components installed on the device
in the form of tc-info objects.  This parameter MUST be present if the
QueryResponse is sent in response to a QueryRequest with the
trusted-components bit set.<a href="#section-4.3-5.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.15">requested-tc-list</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.16">
  The requested-tc-list parameter enumerates the Trusted Components that are
not currently installed in the TEE, but which are requested to be installed,
for example by an installer of an Untrusted Application that has a TA
as a dependency, or by a Trusted Application that has another Trusted
Component as a dependency.  Requested Trusted Components are expressed in
the form of requested-tc-info objects.
A TEEP Agent can get this information from the RequestTA conceptual API
defined in <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span> section 6.2.1.<a href="#section-4.3-5.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.17">unneeded-tc-list</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.18">
  The unneeded-tc-list parameter enumerates the Trusted Components that are
currently installed in the TEE, but which are no longer needed by any
other application.  The TAM can use this information in determining
whether a Trusted Component can be deleted.  Each unneeded Trusted Component is identified
by its SUIT Component Identifier.
A TEEP Agent can get this information from the UnrequestTA conceptual API
defined in <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span> section 6.2.1.<a href="#section-4.3-5.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.19">ext-list</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.20">
  The ext-list parameter lists the supported extensions. This document does not
define any extensions.  This parameter MUST be present if the
QueryResponse is sent in response to a QueryRequest with the
extensions bit set.<a href="#section-4.3-5.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-6">The tc-info object has the following fields:<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-7">
          <dt id="section-4.3-7.1">component-id</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-7.2">
  A SUIT Component Identifier.<a href="#section-4.3-7.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-7.3">tc-manifest-sequence-number</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-7.4">
  The suit-manifest-sequence-number value from the SUIT manifest for the Trusted Component,
if a SUIT manifest was used.<a href="#section-4.3-7.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-8">The requested-tc-info message has the following fields:<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-9">
          <dt id="section-4.3-9.1">component-id</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-9.2">
  A SUIT Component Identifier.<a href="#section-4.3-9.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-9.3">tc-manifest-sequence-number</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-9.4">
  The minimum suit-manifest-sequence-number value from a SUIT manifest for
the Trusted Component.  If not present, indicates that any sequence number will do.<a href="#section-4.3-9.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-9.5">have-binary</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-9.6">
  If present with a value of true, indicates that the TEEP agent already has
the Trusted Component binary and only needs an Update message with a SUIT manifest
that authorizes installing it.  If have-binary is true, the
tc-manifest-sequence-number field MUST be present.<a href="#section-4.3-9.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div id="evidence">
<section id="section-4.3.1">
          <h4 id="name-evidence-and-attestation-re">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-evidence-and-attestation-re" class="section-name selfRef">Evidence and Attestation Results</a>
          </h4>
<p id="section-4.3.1-1">Section 7 of <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span> lists information that may appear
in evidence depending on the circumstance.  However, the evidence is
opaque to the TEEP protocol and there are no formal requirements on the contents
of evidence.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">TAMs however consume Attestation Results and do need enough information therein to
make decisions on how to remediate a TEE that is out of compliance, or update a TEE
that is requesting an authorized change.  To do so, the information in
Section 7 of <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span> is often required depending on the policy.
When an Entity
Attestation Token is used, the following claims can be used to meet those
requirements:<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
            <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
                <th class="text-left" rowspan="1" colspan="1">Claim</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Device unique identifier</td>
                <td class="text-left" rowspan="1" colspan="1">ueid</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span> section 3.4</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Vendor of the device</td>
                <td class="text-left" rowspan="1" colspan="1">oemid</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span> section 3.6</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Class of the device</td>
                <td class="text-left" rowspan="1" colspan="1">class-identifier</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#I-D.birkholz-rats-suit-claims" class="xref">I-D.birkholz-rats-suit-claims</a>]</span> section 3.1.2</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TEE hardware type</td>
                <td class="text-left" rowspan="1" colspan="1">chip-version</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span> section 3.7</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TEE hardware version</td>
                <td class="text-left" rowspan="1" colspan="1">chip-version</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span> section 3.7</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TEE firmware type</td>
                <td class="text-left" rowspan="1" colspan="1">sw-name</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span> section 3.9</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TEE firmware version</td>
                <td class="text-left" rowspan="1" colspan="1">sw-version</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span> section 3.10</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Freshness proof</td>
                <td class="text-left" rowspan="1" colspan="1">nonce</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span> section 3.3</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="update-msg-def">
<section id="section-4.4">
        <h3 id="name-update-message">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-update-message" class="section-name selfRef">Update Message</a>
        </h3>
<p id="section-4.4-1">The Update message is used by the TAM to install and/or delete one or more Trusted
Components via the TEEP Agent.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">Like other TEEP messages, the Update message is
signed, and the relevant CDDL snippet is shown below. 
The complete CDDL structure is shown in Appendix C.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-3">
<pre>
update = [
  type: TEEP-TYPE-update,
  options: {
    ? token =&gt; bstr .size (8..64),
    ? manifest-list =&gt; [ + bstr .cbor SUIT_Envelope ],
    * $$update-extensions,
    * $$teep-option-extensions
  }
]
</pre><a href="#section-4.4-3" class="pilcrow">¶</a>
</div>
<p id="section-4.4-4">The Update message has the following fields:<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.4-5">
          <dt id="section-4.4-5.1">type</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-5.2">
  The value of (3) corresponds to an Update message sent from the TAM to
the TEEP Agent. In case of successful processing, a Success
message is returned by the TEEP Agent. In case of an error, an Error message
is returned. Note that the Update message
is used for initial Trusted Component installation as well as for updates
and deletes.<a href="#section-4.4-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-5.3">token</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-5.4">
  The value in the token field is used to match responses to requests.<a href="#section-4.4-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-5.5">manifest-list</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-5.6">
  The manifest-list field is used to convey one or multiple SUIT manifests
to install.  A manifest is
a bundle of metadata about a Trusted Component, such as where to
find the code, the devices to which it applies, and cryptographic
information protecting the manifest. The manifest may also convey personalization
data. Trusted Component binaries and personalization data can be signed and encrypted
by the same Trusted Component Signer. Other combinations are, however, possible as well. For example,
it is also possible for the TAM to sign and encrypt the personalization data
and to let the Trusted Component Developer sign and/or encrypt the Trusted Component binary.<a href="#section-4.4-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.4-6">Note that an Update message carrying one or more SUIT manifests will inherently
involve multiple signatures, one by the TAM in the TEEP message and one from 
a Trusted Component Signer inside each manifest.  This is intentional as they
are for different purposes.<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<p id="section-4.4-7">The TAM is what authorizes
apps to be installed, updated, and deleted on a given TEE and so the TEEP
signature is checked by the TEEP Agent at protocol message processing time.
(This same TEEP security wrapper is also used on messages like QueryRequest
so that Agents only send potentially sensitive data such as evidence to
trusted TAMs.)<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<p id="section-4.4-8">The Trusted Component signer on the other hand is what authorizes the
Trusted Component to actually run, so the manifest signature could be
checked at install time or load (or run) time or both, and this checking is
done by the TEE independent of whether TEEP is used or some other update
mechanism.
See section 5 of <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span> for further discussion.<a href="#section-4.4-8" class="pilcrow">¶</a></p>
<p id="section-4.4-9">The Update Message has a SUIT_Envelope containing SUIT manifests. Following are some examples of using SUIT manifests in the Update Message.<a href="#section-4.4-9" class="pilcrow">¶</a></p>
<div id="example-1-having-one-suit-manifest-pointing-to-a-uri-of-a-trusted-component-binary">
<section id="section-4.4.1">
          <h4 id="name-example-1-having-one-suit-m">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-example-1-having-one-suit-m" class="section-name selfRef">Example 1: Having one SUIT Manifest pointing to a URI of a Trusted Component Binary</a>
          </h4>
<p id="section-4.4.1-1">In this example, a SUIT Manifest has a URI pointing to a Trusted Component Binary.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">A Trusted Component Developer creates a new Trusted Component Binary and hosts it at a Trusted Component Developer's URI.  Then the Trusted Component Developer generates an associated SUIT manifest with the filename "tc-uuid.suit" that contains the URI. The filename "tc-uuid.suit" is used in Example 3 later.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3">The TAM receives the latest SUIT manifest from the Trusted Component Developer, and
the URI it contains will not be changeable by the TAM since the SUIT manifest is signed by the Trusted Component Developer.<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.4.1-4">Pros:<a href="#section-4.4.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-5.1">The Trusted Component Developer can ensure that the intact Trusted Component Binary is downloaded by devices<a href="#section-4.4.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-5.2">The TAM does not have to send large Update messages containing the Trusted Component Binary<a href="#section-4.4.1-5.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.1-6">Cons:<a href="#section-4.4.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-7.1">The Trusted Component Developer must host the Trusted Component Binary server<a href="#section-4.4.1-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-7.2">The device must fetch the Trusted Component Binary in another connection after receiving an Update message<a href="#section-4.4.1-7.2" class="pilcrow">¶</a>
</li>
          </ul>
<div class="alignLeft art-text artwork" id="section-4.4.1-8">
<pre>
    +------------+           +-------------+
    | TAM        |           | TEEP Agent  |
    +------------+           +-------------+

             Update  ----&gt;

    +=================== teep-protocol(TAM) ==================+
    | TEEP_Message([                                          |
    |   TEEP-TYPE-update,                                     |
    |   options: {                                            |
    |     manifest-list: [                                    |
    |       += suit-manifest "tc-uuid.suit" (TC Developer) =+ |
    |       | SUIT_Envelope({                               | |
    |       |   manifest: {                                 | |
    |       |     install: {                                | |
    |       |       set-parameter: {                        | |
    |       |         uri: "https://example.org/tc-uuid.ta" | |
    |       |       },                                      | |
    |       |       fetch                                   | |
    |       |     }                                         | |
    |       |   }                                           | |
    |       | })                                            | |
    |       +===============================================+ |
    |     ]                                                   |
    |   }                                                     |
    | ])                                                      |
    +=========================================================+

    and then,

    +-------------+          +--------------+
    | TEEP Agent  |          | TC Developer |
    +-------------+          +--------------+

                     &lt;----

      fetch "https://example.org/tc-uuid.ta"

          +======= tc-uuid.ta =======+
          | 48 65 6C 6C 6F 2C 20 ... |
          +==========================+

    Figure 1: URI of the Trusted Component Binary
</pre><a href="#section-4.4.1-8" class="pilcrow">¶</a>
</div>
<p id="section-4.4.1-9">For the full SUIT Manifest example binary, see <a href="#suit-uri" class="xref">Appendix "Example 1: SUIT Manifest pointing to URI of the Trusted Component Binary"</a>.<a href="#section-4.4.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-2-having-a-suit-manifest-include-the-trusted-component-binary">
<section id="section-4.4.2">
          <h4 id="name-example-2-having-a-suit-man">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-example-2-having-a-suit-man" class="section-name selfRef">Example 2: Having a SUIT Manifest include the Trusted Component Binary</a>
          </h4>
<p id="section-4.4.2-1">In this example, the SUIT manifest contains the entire Trusted Component Binary using the integrated-payload (see <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span> Section 7.6).<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-2">A Trusted Component Developer delegates to the TAM the task of delivering the Trusted Component Binary in the SUIT manifest. The Trusted Component Developer creates a SUIT manifest and embeds the Trusted Component Binary, which is referenced in the URI parameter with identifier "#tc". The Trusted Component Developer provides the SUIT manifest to the TAM.<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.4.2-3">The TAM serves the SUIT manifest containing the Trusted Component Binary to the device in an Update message.<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.4.2-4">Pros:<a href="#section-4.4.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.2-5.1">The device can obtain the Trusted Component Binary and its SUIT manifest together in one Update message<a href="#section-4.4.2-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.2-5.2">The Trusted Component Developer does not have to host a server to deliver the Trusted Component Binary directly to devices<a href="#section-4.4.2-5.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.2-6">Cons:<a href="#section-4.4.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.2-7.1">The TAM must host the Trusted Component Binary itself, rather than delegating such storage to the Trusted Component Developer<a href="#section-4.4.2-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.2-7.2">The TAM must deliver Trusted Component Binaries in Update messages, which result in increased Update message size<a href="#section-4.4.2-7.2" class="pilcrow">¶</a>
</li>
          </ul>
<div class="alignLeft art-text artwork" id="section-4.4.2-8">
<pre>
    +------------+           +-------------+
    | TAM        |           | TEEP Agent  |
    +------------+           +-------------+

             Update  ----&gt;

      +=========== teep-protocol(TAM) ============+
      | TEEP_Message([                            |
      |   TEEP-TYPE-update,                       |
      |   options: {                              |
      |     manifest-list: [                      |
      |       +== suit-manifest(TC Developer) ==+ |
      |       | SUIT_Envelope({                 | |
      |       |   "#tc": h'48 65 6C 6C ...',    | |
      |       |   manifest: {                   | |
      |       |     install: {                  | |
      |       |       set-parameter: {          | |
      |       |         uri: "#tc"              | |
      |       |       },                        | |
      |       |       fetch                     | |
      |       |     }                           | |
      |       |   }                             | |
      |       | })                              | |
      |       +=================================+ |
      |     ]                                     |
      |   }                                       |
      | ])                                        |
      +===========================================+

    Figure 2: Integrated Payload with Trusted Component Binary
</pre><a href="#section-4.4.2-8" class="pilcrow">¶</a>
</div>
<p id="section-4.4.2-9">For the full SUIT Manifest example binary, see <a href="#suit-integrated" class="xref">Appendix "Example 2: SUIT Manifest including the Trusted Component Binary"</a>.<a href="#section-4.4.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-3-supplying-personalization-data-for-the-trusted-component-binary">
<section id="section-4.4.3">
          <h4 id="name-example-3-supplying-persona">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-example-3-supplying-persona" class="section-name selfRef">Example 3: Supplying Personalization Data for the Trusted Component Binary</a>
          </h4>
<p id="section-4.4.3-1">In this example, Personalization Data is associated with the Trusted Component Binary "tc-uuid.suit" from Example 1.<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.4.3-2">The Trusted Component Developer places Personalization Data in a file named "config.json" and hosts it on an HTTPS server.  The Trusted Component Developer then creates a SUIT manifest with the URI, specifying which Trusted Component Binary it correlates to in the parameter 'dependency-resolution', and signs the SUIT manifest.<a href="#section-4.4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.4.3-3">The TAM delivers the SUIT manifest of the Personalization Data which depends on the Trusted Component Binary from Example 1.<a href="#section-4.4.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.3-4">
<pre>
    +------------+           +-------------+
    | TAM        |           | TEEP Agent  |
    +------------+           +-------------+

             Update  ----&gt;

      +================= teep-protocol(TAM) ======================+
      | TEEP_Message([                                            |
      |   TEEP-TYPE-update,                                       |
      |   options: {                                              |
      |     manifest-list: [                                      |
      |       +======== suit-manifest(TC Developer) ============+ |
      |       | SUIT_Envelope({                                 | |
      |       |   manifest: {                                   | |
      |       |     common: {                                   | |
      |       |       dependencies: [                           | |
      |       |         {{digest-of-tc.suit}}                   | |
      |       |       ]                                         | |
      |       |     }                                           | |
      |       |     dependency-resolution: {                    | |
      |       |       set-parameter: {                          | |
      |       |         uri: "https://example.org/tc-uuid.suit" | |
      |       |       }                                         | |
      |       |       fetch                                     | |
      |       |     }                                           | |
      |       |     install: {                                  | |
      |       |       set-parameter: {                          | |
      |       |         uri: "https://example.org/config.json"  | |
      |       |       },                                        | |
      |       |       fetch                                     | |
      |       |       set-dependency-index                      | |
      |       |       process-dependency                        | |
      |       |     }                                           | |
      |       |   }                                             | |
      |       | })                                              | |
      |       +=================================================+ |
      |     ]                                                     |
      |   }                                                       |
      | ])                                                        |
      +===========================================================+

    and then,

    +-------------+          +--------------+
    | TEEP Agent  |          | TC Developer |
    +-------------+          +--------------+

                     &lt;----
      fetch "https://example.org/config.json"

          +=======config.json========+
          | 7B 22 75 73 65 72 22 ... |
          +==========================+

    Figure 3: Personalization Data
</pre><a href="#section-4.4.3-4" class="pilcrow">¶</a>
</div>
<p id="section-4.4.3-5">For the full SUIT Manifest example binary, see <a href="#suit-personalization" class="xref">Appendix "Example 3: Supplying Personalization Data for Trusted Component Binary"</a>.<a href="#section-4.4.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-4-unlinking-trusted-component">
<section id="section-4.4.4">
          <h4 id="name-example-4-unlinking-trusted">
<a href="#section-4.4.4" class="section-number selfRef">4.4.4. </a><a href="#name-example-4-unlinking-trusted" class="section-name selfRef">Example 4: Unlinking Trusted Component</a>
          </h4>
<p id="section-4.4.4-1">This subsection shows an example deleting the Trusted Component Binary in the TEEP Device.<a href="#section-4.4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4.4-2">A Trusted Component Developer can also generate SUIT Manifest which unlinks the installed Trusted Component. The TAM deliver it when the TAM want to uninstall the component.<a href="#section-4.4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4.4-3">The directive-unlink (see <span>[<a href="#I-D.moran-suit-trust-domains" class="xref">I-D.moran-suit-trust-domains</a>]</span> Section-6.5.4) is located in the manifest to delete the Trusted Component. Note that in case other Trusted Components depend on it, i.e. the reference count is not zero, the TEEP Device SHOULD NOT delete it immediately.<a href="#section-4.4.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.4-4">
<pre>
    +------------+           +-------------+
    | TAM        |           | TEEP Agent  |
    +------------+           +-------------+

             Update  ----&gt;

      +=========== teep-protocol(TAM) ============+
      | TEEP_Message([                            |
      |   TEEP-TYPE-update,                       |
      |   options: {                              |
      |     manifest-list: [                      |
      |       +== suit-manifest(TC Developer) ==+ |
      |       | SUIT_Envelope({                 | |
      |       |   manifest: {                   | |
      |       |     install: [                  | |
      |       |       unlink                    | |
      |       |     ]                           | |
      |       |   }                             | |
      |       | })                              | |
      |       +=================================+ |
      |     ]                                     |
      |   }                                       |
      | ])                                        |
      +===========================================+

    Figure 4: Unlink Trusted Component example (summary)
</pre><a href="#section-4.4.4-4" class="pilcrow">¶</a>
</div>
<p id="section-4.4.4-5">For the full SUIT Manifest example binary, see <span><a href="#suit-unlink" class="xref">Appendix E. SUIT Example 4</a> (<a href="#suit-unlink" class="xref">Appendix "E.4. Example 4: Unlink a Trusted Component"</a>)</span><a href="#section-4.4.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="success-message">
<section id="section-4.5">
        <h3 id="name-success-message">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-success-message" class="section-name selfRef">Success Message</a>
        </h3>
<p id="section-4.5-1">The Success message is used by the TEEP Agent to return a success in
response to an Update message.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">Like other TEEP messages, the Success message is
signed, and the relevant CDDL snippet is shown below. 
The complete CDDL structure is shown in Appendix C.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-3">
<pre>
teep-success = [
  type: TEEP-TYPE-teep-success,
  options: {
    ? token =&gt; bstr .size (8..64),
    ? msg =&gt; text .size (1..128),
    ? suit-reports =&gt; [ + suit-report ],
    * $$teep-success-extensions,
    * $$teep-option-extensions
  }
]
</pre><a href="#section-4.5-3" class="pilcrow">¶</a>
</div>
<p id="section-4.5-4">The Success message has the following fields:<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.5-5">
          <dt id="section-4.5-5.1">type</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-5.2">
  The value of (5) corresponds to corresponds to a Success message sent from the TEEP Agent to the
TAM.<a href="#section-4.5-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.5-5.3">token</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-5.4">
  The value in the token parameter is used to match responses to requests.
It MUST match the value of the token parameter in the Update
message the Success is in response to, if one was present.  If none was
present, the token MUST be absent in the Success message.<a href="#section-4.5-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.5-5.5">msg</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-5.6">
  The msg parameter contains optional diagnostics information encoded in
UTF-8 <span>[<a href="#RFC3629" class="xref">RFC3629</a>]</span> using Net-Unicode form <span>[<a href="#RFC5198" class="xref">RFC5198</a>]</span> with max 128 bytes
returned by the TEEP Agent.<a href="#section-4.5-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.5-5.7">suit-reports</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-5.8">
  If present, the suit-reports parameter contains a set of SUIT Reports
as defined in Section 4 of <span>[<a href="#I-D.moran-suit-report" class="xref">I-D.moran-suit-report</a>]</span>.
If a token parameter was present in the Update
message the Success message is in response to,
the suit-report-nonce field MUST be present in the SUIT Report with a
value matching the token parameter in the Update
message.<a href="#section-4.5-5.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="error-message-def">
<section id="section-4.6">
        <h3 id="name-error-message">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-error-message" class="section-name selfRef">Error Message</a>
        </h3>
<p id="section-4.6-1">The Error message is used by the TEEP Agent to return an error in
response to an Update message.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">Like other TEEP messages, the Error message is
signed, and the relevant CDDL snippet is shown below. 
The complete CDDL structure is shown in Appendix C.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6-3">
<pre>
teep-error = [
  type: TEEP-TYPE-teep-error,
  options: {
     ? token =&gt; bstr .size (8..64),
     ? err-msg =&gt; text .size (1..128),
     ? supported-cipher-suites =&gt; [ + suite ],
     ? supported-freshness-mechanisms =&gt; [ + freshness-mechanism ],
     ? versions =&gt; [ + version ],
     ? suit-reports =&gt; [ + suit-report ],
     * $$teep-error-extensions,
     * $$teep-option-extensions
  },
  err-code: uint (0..23)
]
</pre><a href="#section-4.6-3" class="pilcrow">¶</a>
</div>
<p id="section-4.6-4">The Error message has the following fields:<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.6-5">
          <dt id="section-4.6-5.1">type</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-5.2">
  The value of (6) corresponds to an Error message sent from the TEEP Agent to the TAM.<a href="#section-4.6-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.3">token</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-5.4">
  The value in the token parameter is used to match responses to requests.
It MUST match the value of the token parameter in the Update
message the Success is in response to, if one was present.  If none was
present, the token MUST be absent in the Error message.<a href="#section-4.6-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.5">err-msg</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-5.6">
  The err-msg parameter is human-readable diagnostic text that MUST be encoded
using UTF-8 <span>[<a href="#RFC3629" class="xref">RFC3629</a>]</span> using Net-Unicode form <span>[<a href="#RFC5198" class="xref">RFC5198</a>]</span> with max 128 bytes.<a href="#section-4.6-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.7">supported-cipher-suites</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-5.8">
  The supported-cipher-suites parameter lists the ciphersuite(s) supported by the TEEP Agent.
Details about the ciphersuite encoding can be found in <a href="#ciphersuite" class="xref">Section 8</a>.
This otherwise optional parameter MUST be returned if err-code is ERR_UNSUPPORTED_CIPHER_SUITES.<a href="#section-4.6-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.9">supported-freshness-mechanisms</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-5.10">
  The supported-freshness-mechanisms parameter lists the freshness mechanism(s) supported by the TEEP Agent.
Details about the encoding can be found in <a href="#freshness-mechanisms" class="xref">Section 9</a>.
This otherwise optional parameter MUST be returned if err-code is ERR_UNSUPPORTED_FRESHNESS_MECHANISMS.<a href="#section-4.6-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.11">versions</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-5.12">
  The versions parameter enumerates the TEEP protocol version(s) supported by the TEEP
Agent. This otherwise optional parameter MUST be returned if err-code is ERR_UNSUPPORTED_MSG_VERSION.<a href="#section-4.6-5.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.13">suit-reports</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-5.14">
  If present, the suit-reports parameter contains a set of SUIT Reports
as defined in Section 4 of <span>[<a href="#I-D.moran-suit-report" class="xref">I-D.moran-suit-report</a>]</span>.  If
a token parameter was present in the Update message the Error message is in response to,
the suit-report-nonce field MUST be present in the SUIT Report with a
value matching the token parameter in the Update
message.<a href="#section-4.6-5.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.15">err-code</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-5.16">
  The err-code parameter contains one of the 
error codes listed below). Only selected values are applicable
to each message.<a href="#section-4.6-5.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-6">This specification defines the following initial error messages:<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.6-7">
          <dt id="section-4.6-7.1">ERR_PERMANENT_ERROR (1)</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-7.2">
  The TEEP
request contained incorrect fields or fields that are inconsistent with
other fields.
For diagnosis purposes it is RECOMMMENDED to identify the failure reason
in the error message.
A TAM receiving this error might refuse to communicate further with
the TEEP Agent for some period of time until it has reason to believe
it is worth trying again, but it should take care not to give up on
communication when there is no attestation evidence indicating that
the error is genuine.  In contrast, ERR_TEMPORARY_ERROR is an indication
that a more agressive retry is warranted.<a href="#section-4.6-7.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-7.3">ERR_UNSUPPORTED_EXTENSION (2)</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-7.4">
  The TEEP Agent does not support an extension included in the request
message.
For diagnosis purposes it is RECOMMMENDED to identify the unsupported
extension in the error message.
A TAM receiving this error might retry the request without using extensions.<a href="#section-4.6-7.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-7.5">ERR_UNSUPPORTED_FRESHNESS_MECHANISMS (3)</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-7.6">
  The TEEP Agent does not
support any freshness algorithm mechanisms in the request message.
A TAM receiving this error might retry the request using a different
set of supported freshness mechanisms in the request message.<a href="#section-4.6-7.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-7.7">ERR_UNSUPPORTED_MSG_VERSION (4)</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-7.8">
  The TEEP Agent does not
support the TEEP protocol version indicated in the request message.
A TAM receiving this error might retry the request using a different
TEEP protocol version.<a href="#section-4.6-7.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-7.9">ERR_UNSUPPORTED_CIPHER_SUITES (5)</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-7.10">
  The TEEP Agent does not
support any ciphersuites indicated in the request message.
A TAM receiving this error might retry the request using a different
set of supported ciphersuites in the request message.<a href="#section-4.6-7.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-7.11">ERR_BAD_CERTIFICATE (6)</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-7.12">
  Processing of a certificate failed. For diagnosis purposes it is
RECOMMMENDED to include information about the failing certificate
in the error message.  For example, the certificate was of an
unsupported type, or the certificate was revoked by its signer.
A TAM receiving this error might attempt to use an alternate certificate.<a href="#section-4.6-7.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-7.13">ERR_CERTIFICATE_EXPIRED (9)</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-7.14">
  A certificate has expired or is not currently
valid.
A TAM receiving this error might attempt to renew its certificate
before using it again.<a href="#section-4.6-7.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-7.15">ERR_TEMPORARY_ERROR (10)</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-7.16">
  A miscellaneous
temporary error, such as a memory allocation failure, occurred while processing the request message.
A TAM receiving this error might retry the same request at a later point
in time.<a href="#section-4.6-7.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-7.17">ERR_MANIFEST_PROCESSING_FAILED (17)</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-7.18">
  The TEEP Agent encountered one or more manifest processing failures.
If the suit-reports parameter is present, it contains the failure details.
A TAM receiving this error might still attempt to install or update
other components that do not depend on the failed manifest.<a href="#section-4.6-7.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-8">New error codes should be added sparingly, not for every implementation
error.  That is the intent of the err-msg field, which can be used to
provide details meaningful to humans.  New error codes should only be
added if the TAM is expected to do something behaviorally different upon
receipt of the error message, rather than just logging the event.
Hence, each error code is responsible for saying what the
behavioral difference is expected to be.<a href="#section-4.6-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="eat">
<section id="section-5">
      <h2 id="name-eat-profile">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-eat-profile" class="section-name selfRef">EAT Profile</a>
      </h2>
<p id="section-5-1">The TEEP protocol operates between a TEEP Agent and a TAM.  While
the TEEP protocol does not require use of EAT, use of EAT is encouraged and
<a href="#query-response" class="xref">Section 4.3</a> explicitly defines a way to carry an Entity Attestation Token
evidence in a QueryResponse.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">As discussed in <a href="#evidence" class="xref">Section 4.3.1</a>, the content of attestation evidence is opaque to the TEEP
architecture, but the content of Attestation Results is not, where Attestation
Results flow between a Verifier and a TAM (as the Relying Party).
Although Attestation Results required by a TAM are separable from the TEEP protocol
per se, this section is included as part of the requirements for building
a compliant TAM that uses EATs for Attestation Results.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Section 7 of <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span> defines the requirement for
Entity Attestation Token profiles.  This section defines an EAT profile
for use with TEEP.<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">profile-label: The profile-label for this specification is the URI<a href="#section-5-4.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-5"><a href="https://datatracker.ietf.org/doc/html/draft-ietf-teep-protocol-08">https://datatracker.ietf.org/doc/html/draft-ietf-teep-protocol-08</a>.
(RFC-editor: upon RFC publication, replace string with
"https://www.rfc-editor.org/info/rfcXXXX" where XXXX is the RFC number
of this document.)<a href="#section-5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-6.1">Use of JSON, CBOR, or both: CBOR only.<a href="#section-5-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.2">CBOR Map and Array Encoding: Only definite length arrays and maps.<a href="#section-5-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.3">CBOR String Encoding: Only definite-length strings are allowed.<a href="#section-5-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.4">CBOR Preferred Serialization: Encoders must use preferred serialization,
and decoders need not accept non-preferred serialization.<a href="#section-5-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.5">COSE/JOSE Protection: See <a href="#ciphersuite" class="xref">Section 8</a>.<a href="#section-5-6.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.6">Detached EAT Bundle Support: DEB use is permitted.<a href="#section-5-6.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.7">Verification Key Identification: COSE Key ID (kid) is used, where
the key ID is the hash of a public key (where the public key may be
used as a raw public key, or in a certificate).<a href="#section-5-6.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.8">Endorsement Identification: Optional, but semantics are the same
as in Verification Key Identification.<a href="#section-5-6.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.9">Freshness: See <a href="#freshness-mechanisms" class="xref">Section 9</a>.<a href="#section-5-6.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.10">Required Claims: None.<a href="#section-5-6.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.11">Prohibited Claims: None.<a href="#section-5-6.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.12">Additional Claims: Optional claims are those listed in <a href="#evidence" class="xref">Section 4.3.1</a>.<a href="#section-5-6.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.13">Refined Claim Definition: None.<a href="#section-5-6.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.14">CBOR Tags: CBOT Tags are not used.<a href="#section-5-6.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.15">Manifests and Software Evidence Claims: The sw-name claim for a Trusted
Component holds the URI of the SUIT manifest for that component.<a href="#section-5-6.15" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="tags">
<section id="section-6">
      <h2 id="name-mapping-of-teep-message-par">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-mapping-of-teep-message-par" class="section-name selfRef">Mapping of TEEP Message Parameters to CBOR Labels</a>
      </h2>
<p id="section-6-1">In COSE, arrays and maps use strings, negative integers, and unsigned
integers as their keys. Integers are used for compactness of
encoding. Since the word "key" is mainly used in its other meaning, as a
cryptographic key, this specification uses the term "label" for this usage
as a map key.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">This specification uses the following mapping:<a href="#section-6-2" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
        <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Label</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">supported-cipher-suites</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">challenge</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">version</td>
            <td class="text-left" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">selected-cipher-suite</td>
            <td class="text-left" rowspan="1" colspan="1">5</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">selected-version</td>
            <td class="text-left" rowspan="1" colspan="1">6</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">evidence</td>
            <td class="text-left" rowspan="1" colspan="1">7</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">tc-list</td>
            <td class="text-left" rowspan="1" colspan="1">8</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ext-list</td>
            <td class="text-left" rowspan="1" colspan="1">9</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">manifest-list</td>
            <td class="text-left" rowspan="1" colspan="1">10</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">msg</td>
            <td class="text-left" rowspan="1" colspan="1">11</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">err-msg</td>
            <td class="text-left" rowspan="1" colspan="1">12</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">evidence-format</td>
            <td class="text-left" rowspan="1" colspan="1">13</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">requested-tc-list</td>
            <td class="text-left" rowspan="1" colspan="1">14</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">unneeded-tc-list</td>
            <td class="text-left" rowspan="1" colspan="1">15</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">component-id</td>
            <td class="text-left" rowspan="1" colspan="1">16</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">tc-manifest-sequence-number</td>
            <td class="text-left" rowspan="1" colspan="1">17</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">have-binary</td>
            <td class="text-left" rowspan="1" colspan="1">18</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">suit-reports</td>
            <td class="text-left" rowspan="1" colspan="1">19</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">token</td>
            <td class="text-left" rowspan="1" colspan="1">20</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">supported-freshness-mechanisms</td>
            <td class="text-left" rowspan="1" colspan="1">21</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="behavior-specification">
<section id="section-7">
      <h2 id="name-behavior-specification">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-behavior-specification" class="section-name selfRef">Behavior Specification</a>
      </h2>
<p id="section-7-1">Behavior is specified in terms of the conceptual APIs defined in
section 6.2.1 of <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="tam">
<section id="section-7.1">
        <h3 id="name-tam-behavior">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-tam-behavior" class="section-name selfRef">TAM Behavior</a>
        </h3>
<p id="section-7.1-1">When the ProcessConnect API is invoked, the TAM sends a QueryRequest message.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">When the ProcessTeepMessage API is invoked, the TAM first does validation
as specified in <a href="#validation" class="xref">Section 4.1.2</a>, and drops the message if it is not valid.
Otherwise, it proceeds as follows.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">If the message includes a token, it can be used to 
match the response to a request previously sent by the TAM.
The TAM MUST expire the token value after receiving the first response
from the device that has a valid signature and ignore any subsequent messages that have the same token
value.  The token value MUST NOT be used for other purposes, such as a TAM to
identify the devices and/or a device to identify TAMs or Trusted Components.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">If a QueryResponse message is received that contains evidence, the evidence
is passed to an attestation Verifier (see <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>)
to determine whether the Agent is in a trustworthy state.
Based on the results of attestation, and the lists of installed, requested,
and unneeded Trusted Components reported in the QueryResponse, the TAM
determines, in any implementation specific manner, which Trusted Components
need to be installed, updated, or deleted, if any.
If any Trusted Components need to be installed, updated, or deleted,
the TAM sends an Update message containing SUIT Manifests with command
sequences to do the relevant installs, updates, or deletes.
It is important to note that the TEEP Agent's
Update Procedure requires resolving and installing any dependencies
indicated in the manifest, which may take some time, and the resulting Success
or Error message is generated only after completing the Update Procedure.
Hence, depending on the freshness mechanism in use, the TAM may need to
store data (e.g., a nonce) for some time.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">If a Success or Error message is received containing one or more SUIT Reports, the TAM also validates that
the nonce in any SUIT Report matches the token sent in the Update message,
and drops the message if it does not match.  Otherwise, the TAM handles
the update in any implementation specific way, such as updating any locally
cached information about the state of the TEEP Agent, or logging the results.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">If any other Error message is received, the TAM can handle it in any implementation
specific way, but <a href="#error-message-def" class="xref">Section 4.6</a> provides recommendations for such handling.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="agent">
<section id="section-7.2">
        <h3 id="name-teep-agent-behavior">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-teep-agent-behavior" class="section-name selfRef">TEEP Agent Behavior</a>
        </h3>
<p id="section-7.2-1">When the RequestTA API is invoked, the TEEP Agent first checks whether the
requested TA is already installed.  If it is already installed, the
TEEP Agent passes no data back to the caller.  Otherwise, 
if the TEEP Agent chooses to initiate the process of requesting the indicated
TA, it determines (in any implementation specific way) the TAM URI based on 
any TAM URI provided by the RequestTA caller and any local configuration,
and passes back the TAM URI to connect to.  It MAY also pass back a
QueryResponse message if all of the following conditions are true:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">The last QueryRequest message received from that TAM contained no token or challenge,<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-2.2">The ProcessError API was not invoked for that TAM since the last QueryResponse
message was received from it, and<a href="#section-7.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-2.3">The public key or certificate of the TAM is cached and not expired.<a href="#section-7.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-3">When the RequestPolicyCheck API is invoked, the TEEP Agent decides
whether to initiate communication with any trusted TAMs (e.g., it might
choose to do so for a given TAM unless it detects that it has already
communicated with that TAM recently). If so, it passes back a TAM URI
to connect to.  If the TEEP Agent has multiple TAMs it needs to connect
with, it just passes back one, with the expectation that
RequestPolicyCheck API will be invoked to retrieve each one successively
until there are no more and it can pass back no data at that time.
Thus, once a TAM URI is returned, the TEEP Agent can remember that it has
already initiated communication with that TAM.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">When the ProcessError API is invoked, the TEEP Agent can handle it in
any implementation specific way, such as logging the error or
using the information in future choices of TAM URI.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">When the ProcessTeepMessage API is invoked, the Agent first does validation
as specified in <a href="#validation" class="xref">Section 4.1.2</a>, and drops the message if it is not valid.
Otherwise, processing continues as follows based on the type of message.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">When a QueryRequest message is received, the Agent responds with a
QueryResponse message if all fields were understood, or an Error message
if any error was encountered.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<p id="section-7.2-7">When an Update message is received, the Agent attempts to update
the Trusted Components specified in the SUIT manifests
by following the Update Procedure specified
in <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>, and responds with a Success message if
all SUIT manifests were successfully installed, or an Error message
if any error was encountered.
It is important to note that the
Update Procedure requires resolving and installing any dependencies
indicated in the manifest, which may take some time, and the Success
or Error message is generated only after completing the Update Procedure.<a href="#section-7.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ciphersuite">
<section id="section-8">
      <h2 id="name-ciphersuites">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-8-1">The TEEP protocol uses COSE for protection of TEEP messages.
After a QueryResponse is received, the selected cryptographic algorithm is used in subsequent TEEP messages (Install, Success, and Error).
To negotiate cryptographic mechanisms and algorithms, the TEEP protocol defines the following ciphersuite structure.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-2">
<pre>
ciphersuite = [
    teep-cose-sign-algs / nil,
    teep-cose-encrypt-algs / nil ,
    teep-cose-mac-algs / nil
]
</pre><a href="#section-8-2" class="pilcrow">¶</a>
</div>
<p id="section-8-3">The ciphersuite structure is used to present the combination of mechanisms and cryptographic algorithms.
Each suite value corresponds with a COSE-type defined in Section 2 of <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.<a href="#section-8-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-4">
<pre>
supported-cipher-suites = [ + suite ]
</pre><a href="#section-8-4" class="pilcrow">¶</a>
</div>
<p id="section-8-5">Cryptographic algorithm values are defined in the COSE Algorithms registry <span>[<a href="#COSE.Algorithm" class="xref">COSE.Algorithm</a>]</span>.
A TAM MUST support both of the following ciphersuites.  A TEEP Agent MUST support at least
one of the two but can choose which one.  For example, a TEEP Agent might
choose a given ciphersuite if it has hardware support for it.<a href="#section-8-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-6">
<pre>
teep-cose-sign-algs /= cose-alg-es256,
teep-cose-sign-algs /= cose-alg-eddsa
</pre><a href="#section-8-6" class="pilcrow">¶</a>
</div>
<p id="section-8-7">A TAM or TEEP Agent MUST also support the following algorithms:<a href="#section-8-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-8">
<pre>
teep-cose-encrypt-algs /= cose-alg-accm-16-64-128

teep-cose-mac-algs /= cose-alg-hmac-256
</pre><a href="#section-8-8" class="pilcrow">¶</a>
</div>
<p id="section-8-9">A TAM or TEEP Agent MAY also support one or more of the following algorithms:<a href="#section-8-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-10">
<pre>
teep-cose-sign-algs /= cose-alg-ps256,
teep-cose-sign-algs /= cose-alg-ps384,
teep-cose-sign-algs /= cose-alg-ps512,
teep-cose-sign-algs /= cose-alg-rsa-oaep-256,
teep-cose-sign-algs /= cose-alg-rsa-oaep-512
</pre><a href="#section-8-10" class="pilcrow">¶</a>
</div>
<p id="section-8-11">Any ciphersuites without confidentiality protection can only be added if the
associated specification includes a discussion of security considerations and
applicability, since manifests may carry sensitive information. For example,
Section 6 of <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span> permits implementations that
terminate transport security inside the TEE and if the transport security
provides confidentiality then additional encryption might not be needed in
the manifest for some use cases. For most use cases, however, manifest
confidentiality will be needed to protect sensitive fields from the TAM as
discussed in Section 9.8 of <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span>.<a href="#section-8-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="freshness-mechanisms">
<section id="section-9">
      <h2 id="name-freshness-mechanisms">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-freshness-mechanisms" class="section-name selfRef">Freshness Mechanisms</a>
      </h2>
<p id="section-9-1">A freshness mechanism determines how a TAM can tell whether evidence provided
in a Query Response is fresh.  There are multiple ways this can be done
as discussed in Section 10 of <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Each freshness mechanism is identified with an integer value, which corresponds to
an IANA registered freshness mechanism (see <a href="#freshness-mechanism-registry" class="xref">Section 11.2</a>.
This document defines the following freshness mechanisms:<a href="#section-9-2" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
        <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Freshness mechanism</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">Nonce</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">Timestamp</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">Epoch ID</td>
          </tr>
        </tbody>
      </table>
<p id="section-9-4">In the Nonce mechanism, the evidence MUST include a nonce provided
in the QueryRequest challenge.  In other mechanisms, a timestamp
or epoch ID determined via mechanisms outside the TEEP protocol is
used, and the challenge is only needed in the QueryRequest message
if a challenge is needed in generating evidence for reasons other
than freshness.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">If a TAM supports multiple freshness mechanisms that require different challenge
formats, the QueryRequest message can currently only send one such challenge.
This situation is expected to be rare, but should it occur, the TAM can
choose to prioritize one of them and exclude the other from the
supported-freshness-mechanisms in the QueryRequest, and resend the QueryRequest
with the other mechanism if an ERR_UNSUPPORTED_FRESHNESS_MECHANISMS Error
is received that indicates the TEEP Agent supports the other mechanism.<a href="#section-9-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-10">
      <h2 id="name-security-considerations-12">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations-12" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">This section summarizes the security considerations discussed in this
specification:<a href="#section-10-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-10-2">
        <dt id="section-10-2.1">Cryptographic Algorithms</dt>
        <dd style="margin-left: 1.5em" id="section-10-2.2">
  TEEP protocol messages exchanged between the TAM and the TEEP Agent
are protected using COSE. This specification relies on the
cryptographic algorithms provided by COSE.  Public key based
authentication is used by the TEEP Agent to authenticate the TAM
and vice versa.<a href="#section-10-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-2.3">Attestation</dt>
        <dd style="margin-left: 1.5em" id="section-10-2.4">
  A TAM can rely on the attestation evidence provided by the TEEP
Agent.  To sign the attestation evidence, it is necessary
for the device to possess a public key (usually in the form of a
certificate <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>) along with the corresponding private key. Depending on
the properties of the attestation mechanism, it is possible to
uniquely identify a device based on information in the attestation
evidence or in the certificate used to sign the attestation
evidence.  This uniqueness may raise privacy concerns. To lower the
privacy implications the TEEP Agent MUST present its attestation
evidence only to an authenticated and authorized TAM and when using
EATS, it SHOULD use encryption as discussed in <span>[<a href="#I-D.ietf-rats-eat" class="xref">I-D.ietf-rats-eat</a>]</span>, since
confidentiality is not provided by the TEEP protocol itself and
the transport protocol under the TEEP protocol might be implemented
outside of any TEE. If any mechanism other than EATs is used, it is
up to that mechanism to specify how privacy is provided.<a href="#section-10-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-2.5">Trusted Component Binaries</dt>
        <dd style="margin-left: 1.5em" id="section-10-2.6">
  Each Trusted Component binary is signed by a Trusted Component Signer. It is the responsibility of the
TAM to relay only verified Trusted Components from authorized Trusted Component Signers.  Delivery of
a Trusted Component to the TEEP Agent is then the responsibility of the TAM,
using the security mechanisms provided by the TEEP
protocol.  To protect the Trusted Component binary, the SUIT manifest format is used and
it offers a variety of security features, including digitial
signatures and symmetric encryption.<a href="#section-10-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-2.7">Personalization Data</dt>
        <dd style="margin-left: 1.5em" id="section-10-2.8">
  A Trusted Component Signer or TAM can supply personalization data along with a Trusted Component.
This data is also protected by a SUIT manifest.
Personalization data signed and encrypted by a Trusted Component Signer other than
the TAM is opaque to the TAM.<a href="#section-10-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-2.9">TEEP Broker</dt>
        <dd style="margin-left: 1.5em" id="section-10-2.10">
  As discussed in section 6 of <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span>,
the TEEP protocol typically relies on a TEEP Broker to relay messages
between the TAM and the TEEP Agent.  When the TEEP Broker is
compromised it can drop messages, delay the delivery of messages,
and replay messages but it cannot modify those messages. (A replay
would be, however, detected by the TEEP Agent.) A compromised TEEP
Broker could reorder messages in an attempt to install an old
version of a Trusted Component. Information in the manifest ensures that TEEP
Agents are protected against such downgrade attacks based on
features offered by the manifest itself.<a href="#section-10-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-2.11">Trusted Component Signer Compromise</dt>
        <dd style="margin-left: 1.5em" id="section-10-2.12">
          <p id="section-10-2.12.1">
  A TAM is responsible for vetting a Trusted Component and
before distributing them to TEEP Agents.<a href="#section-10-2.12.1" class="pilcrow">¶</a></p>
<p id="section-10-2.12.2">
It is RECOMMENDED to provide a way to
update the trust anchor store used by the TEE, for example using
a firmware update mechanism.  Thus, if a Trusted Component
Signer is later compromised, the TAM can update the trust anchor
store used by the TEE, for example using a firmware update mechanism.<a href="#section-10-2.12.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-10-2.13">CA Compromise</dt>
        <dd style="margin-left: 1.5em" id="section-10-2.14">
  The CA issuing certificates to a TEE or a Trusted Component Signer might get compromised.
It is RECOMMENDED to provide a way to
update the trust anchor store used by the TEE, for example using
a firmware update mechanism. If the CA issuing certificates to
devices gets compromised then these devices might be rejected by a
TAM, if revocation is available to the TAM.<a href="#section-10-2.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-2.15">TAM Certificate Expiry</dt>
        <dd style="margin-left: 1.5em" id="section-10-2.16">
  The integrity and the accuracy of the
clock within the TEE determines the ability to determine an expired
TAM certificate, if certificates are used.<a href="#section-10-2.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-2.17">Compromised Time Source</dt>
        <dd style="margin-left: 1.5em" id="section-10-2.18">
  As discussed above, certificate validity checks rely on comparing
validity dates to the current time, which relies on having a trusted
source of time, such as <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>.  A compromised time source could
thus be used to subvert such validity checks.<a href="#section-10-2.18" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA">
<section id="section-11">
      <h2 id="name-iana-considerations-12">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations-12" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="media-type-registration">
<section id="section-11.1">
        <h3 id="name-media-type-registration">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-media-type-registration" class="section-name selfRef">Media Type Registration</a>
        </h3>
<p id="section-11.1-1">IANA is requested to assign a media type for
application/teep+cbor.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.1-2">
          <dt id="section-11.1-2.1">Type name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.2">
  application<a href="#section-11.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.3">Subtype name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.4">
  teep+cbor<a href="#section-11.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.5">Required parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.6">
  none<a href="#section-11.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.7">Optional parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.8">
  none<a href="#section-11.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.9">Encoding considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.10">
  Same as encoding considerations of
application/cbor.<a href="#section-11.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.11">Security considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.12">
  See Security Considerations Section of this document.<a href="#section-11.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.13">Interoperability considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.14">
  Same as interoperability
considerations of application/cbor as specified in <span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span>.<a href="#section-11.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.15">Published specification:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.16">
  This document.<a href="#section-11.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.17">Applications that use this media type:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.18">
  TEEP protocol implementations<a href="#section-11.1-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.19">Fragment identifier considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.20">
  N/A<a href="#section-11.1-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.21">Additional information:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.22">
            <span class="break"></span><dl class="dlParallel" id="section-11.1-2.22.1">
              <dt id="section-11.1-2.22.1.1">Deprecated alias names for this type:</dt>
              <dd style="margin-left: 1.5em" id="section-11.1-2.22.1.2">
        N/A<a href="#section-11.1-2.22.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-11.1-2.22.1.3">Magic number(s):</dt>
              <dd style="margin-left: 1.5em" id="section-11.1-2.22.1.4">
        N/A<a href="#section-11.1-2.22.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-11.1-2.22.1.5">File extension(s):</dt>
              <dd style="margin-left: 1.5em" id="section-11.1-2.22.1.6">
        N/A<a href="#section-11.1-2.22.1.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-11.1-2.22.1.7">Macintosh file type code(s):</dt>
              <dd style="margin-left: 1.5em" id="section-11.1-2.22.1.8">
        N/A<a href="#section-11.1-2.22.1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.23">Person to contact for further information:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.24">
  teep@ietf.org<a href="#section-11.1-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.25">Intended usage:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.26">
  COMMON<a href="#section-11.1-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.27">Restrictions on usage:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.28">
  none<a href="#section-11.1-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.29">Author:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.30">
  See the "Authors' Addresses" section of this document<a href="#section-11.1-2.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.31">Change controller:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.32">
  IETF<a href="#section-11.1-2.32" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="freshness-mechanism-registry">
<section id="section-11.2">
        <h3 id="name-freshness-mechanism-registr">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-freshness-mechanism-registr" class="section-name selfRef">Freshness Mechanism Registry</a>
        </h3>
<p id="section-11.2-1">IANA is also requested to create a new registry for freshness mechanisms.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">Name of registry: TEEP Freshness Mechanisms<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<p id="section-11.2-3">Policy: Specification Required <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span><a href="#section-11.2-3" class="pilcrow">¶</a></p>
<p id="section-11.2-4">Additional requirements: The specification must document relevant security considerations.<a href="#section-11.2-4" class="pilcrow">¶</a></p>
<p id="section-11.2-5">Initial values:<a href="#section-11.2-5" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Freshness mechanism</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Nonce</td>
              <td class="text-left" rowspan="1" colspan="1">RFC TBD <a href="#freshness-mechanisms" class="xref">Section 9</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Timestamp</td>
              <td class="text-left" rowspan="1" colspan="1">RFC TBD <a href="#freshness-mechanisms" class="xref">Section 9</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Epoch ID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC TBD <a href="#freshness-mechanisms" class="xref">Section 9</a>
</td>
            </tr>
          </tbody>
        </table>
<p id="section-11.2-7">(RFC Editor: please replace TBD above with the number assigned to this document.)<a href="#section-11.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-12">
      <h2 id="name-references-10">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references-10" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references-12">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references-12" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Algorithm">[COSE.Algorithm]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms">https://www.iana.org/assignments/cose/cose.xhtml#algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-architecture">[I-D.ietf-rats-architecture]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote Attestation Procedures Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-architecture-15</span>, <time datetime="2022-02-08" class="refDate">8 February 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-rats-architecture-15.txt">https://www.ietf.org/archive/id/draft-ietf-rats-architecture-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-eat">[I-D.ietf-rats-eat]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, and <span class="refAuthor">J. O'Donoghue</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-12</span>, <time datetime="2022-02-24" class="refDate">24 February 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-rats-eat-12.txt">https://www.ietf.org/archive/id/draft-ietf-rats-eat-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-suit-manifest">[I-D.ietf-suit-manifest]</dt>
        <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Birkholz, H.</span>, and <span class="refAuthor">K. Zandberg</span>, <span class="refTitle">"A Concise Binary Object Representation (CBOR)-based Serialization Format for the Software Updates for Internet of Things (SUIT) Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-manifest-16</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-suit-manifest-16.txt">https://www.ietf.org/archive/id/draft-ietf-suit-manifest-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.moran-suit-report">[I-D.moran-suit-report]</dt>
        <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refTitle">"Secure Reporting of Update Status"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-moran-suit-report-01</span>, <time datetime="2021-02-22" class="refDate">22 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-moran-suit-report-01.txt">https://www.ietf.org/archive/id/draft-moran-suit-report-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.moran-suit-trust-domains">[I-D.moran-suit-trust-domains]</dt>
        <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refTitle">"SUIT Manifest Extensions for Multiple Trust Domains"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-moran-suit-trust-domains-00</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-moran-suit-trust-domains-00.txt">https://www.ietf.org/archive/id/draft-moran-suit-trust-domains-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5198">[RFC5198]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span> and <span class="refAuthor">M. Padlipsky</span>, <span class="refTitle">"Unicode Format for Network Interchange"</span>, <span class="seriesInfo">RFC 5198</span>, <span class="seriesInfo">DOI 10.17487/RFC5198</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5198">https://www.rfc-editor.org/info/rfc5198</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7049">[RFC7049]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references-10">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references-10" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.birkholz-rats-suit-claims">[I-D.birkholz-rats-suit-claims]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span> and <span class="refAuthor">B. Moran</span>, <span class="refTitle">"Trustworthiness Vectors for the Software Updates of Internet of Things (SUIT) Workflow Model"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-birkholz-rats-suit-claims-03</span>, <time datetime="2022-01-12" class="refDate">12 January 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-birkholz-rats-suit-claims-03.txt">https://www.ietf.org/archive/id/draft-birkholz-rats-suit-claims-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-architecture">[I-D.ietf-teep-architecture]</dt>
        <dd>
<span class="refAuthor">Pei, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">D. Wheeler</span>, <span class="refTitle">"Trusted Execution Environment Provisioning (TEEP) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-architecture-16</span>, <time datetime="2022-02-28" class="refDate">28 February 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-teep-architecture-16.txt">https://www.ietf.org/archive/id/draft-ietf-teep-architecture-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8915">[RFC8915]</dt>
      <dd>
<span class="refAuthor">Franke, D.</span>, <span class="refAuthor">Sibold, D.</span>, <span class="refAuthor">Teichel, K.</span>, <span class="refAuthor">Dansarie, M.</span>, and <span class="refAuthor">R. Sundblad</span>, <span class="refTitle">"Network Time Security for the Network Time Protocol"</span>, <span class="seriesInfo">RFC 8915</span>, <span class="seriesInfo">DOI 10.17487/RFC8915</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8915">https://www.rfc-editor.org/info/rfc8915</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="a-contributors">
<section id="appendix-A">
      <h2 id="name-a-contributors">
<a href="#name-a-contributors" class="section-name selfRef">A. Contributors</a>
      </h2>
<p id="appendix-A-1">We would like to thank Brian Witten (Symantec), Tyler Kim (Solacia), Nick Cook (Arm), and  Minho Yoo (IoTrust) for their contributions
to the Open Trust Protocol (OTrP), which influenced the design of this specification.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="b-acknowledgements">
<section id="appendix-B">
      <h2 id="name-b-acknowledgements">
<a href="#name-b-acknowledgements" class="section-name selfRef">B. Acknowledgements</a>
      </h2>
<p id="appendix-B-1">We would like to thank Eve Schooler for the suggestion of the protocol name.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">We would like to thank Kohei Isobe (TRASIO/SECOM), Ken Takayama (SECOM)
Kuniyasu Suzaki (TRASIO/AIST), Tsukasa Oi (TRASIO), and Yuichi Takita (SECOM)
for their valuable implementation feedback.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">We would also like to thank Carsten Bormann and Henk Birkholz for their help with the CDDL.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="c-complete-cddl">
<section id="appendix-C">
      <h2 id="name-c-complete-cddl">
<a href="#name-c-complete-cddl" class="section-name selfRef">C. Complete CDDL</a>
      </h2>
<p id="appendix-C-1">Valid TEEP messages MUST adhere to the following CDDL data definitions,
except that <code>SUIT_Envelope</code> and <code>SUIT_Component_Identifier</code> are
specified in <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C-2">
<pre>
teep-message = $teep-message-type .within teep-message-framework

SUIT_Envelope = any

teep-message-framework = [
  type: uint (0..23) / $teep-type-extension,
  options: { * teep-option },
  * uint; further integers, e.g., for data-item-requested
]

teep-option = (uint =&gt; any)

; messages defined below:
$teep-message-type /= query-request
$teep-message-type /= query-response
$teep-message-type /= update
$teep-message-type /= teep-success
$teep-message-type /= teep-error

; message type numbers, uint (0..23)
TEEP-TYPE-query-request = 1
TEEP-TYPE-query-response = 2
TEEP-TYPE-update = 3
TEEP-TYPE-teep-success = 5
TEEP-TYPE-teep-error = 6

version = .within uint .size 4
ext-info = .within uint .size 4

; data items as bitmaps
data-item-requested = $data-item-requested .within uint .size 8
attestation = 1
$data-item-requested /= attestation
trusted-components = 2
$data-item-requested /= trusted-components
extensions = 4
$data-item-requested /= extensions

query-request = [
  type: TEEP-TYPE-query-request,
  options: {
    ? token =&gt; bstr .size (8..64),
    ? supported-cipher-suites =&gt; [ + suite ],
    ? supported-freshness-mechanisms =&gt; [ + freshness-mechanism ],
    ? challenge =&gt; bstr .size (8..512),
    ? versions =&gt; [ + version ],
    * $$query-request-extensions
    * $$teep-option-extensions
  },
  data-item-requested: data-item-requested
]

; ciphersuites
suite = [
    teep-cose-sign-algs / nil,
    teep-cose-encrypt-algs / nil,
    teep-cose-mac-algs / nil
]

teep-cose-sign-algs /= cose-alg-es256,
teep-cose-sign-algs /= cose-alg-eddsa
teep-cose-sign-algs /= cose-alg-ps256,
teep-cose-sign-algs /= cose-alg-ps384,
teep-cose-sign-algs /= cose-alg-ps512,
teep-cose-sign-algs /= cose-alg-rsa-oaep-256,
teep-cose-sign-algs /= cose-alg-rsa-oaep-512

teep-cose-encrypt-algs /= cose-alg-accm-16-64-128

teep-cose-mac-algs /= cose-alg-hmac-256

; algorithm identifiers defined in the IANA COSE Algorithms Registry
cose-alg-es256 = -7
cose-alg-eddsa = -8
cose-alg-ps256 = -37
cose-alg-ps384 = -38
cose-alg-ps512 = -39
cose-alg-rsa-oaep-256 = -41
cose-alg-rsa-oaep-512 = -42
cose-alg-accm-16-64-128 = 10
cose-alg-hmac-256 = 5

; freshness-mechanisms

freshness-mechanism = $TEEP-freshness-mechanism .within uint .size 4

FRESHNESS_NONCE = 0
FRESHNESS_TIMESTAMP = 1
FRESHNESS_EPOCH_ID = 2

$TEEP-freshness-mechanism /= FRESHNESS_NONCE
$TEEP-freshness-mechanism /= FRESHNESS_TIMESTAMP
$TEEP-freshness-mechanism /= FRESHNESS_EPOCH_ID

query-response = [
  type: TEEP-TYPE-query-response,
  options: {
    ? token =&gt; bstr .size (8..64),
    ? selected-cipher-suite =&gt; suite,
    ? selected-version =&gt; version,
    ? evidence-format =&gt; text,
    ? evidence =&gt; bstr,
    ? tc-list =&gt; [ + tc-info ],
    ? requested-tc-list =&gt; [ + requested-tc-info ],
    ? unneeded-tc-list =&gt; [ + SUIT_Component_Identifier ],
    ? ext-list =&gt; [ + ext-info ],
    * $$query-response-extensions,
    * $$teep-option-extensions
  }
]

tc-info = {
  component-id =&gt; SUIT_Component_Identifier,
  ? tc-manifest-sequence-number =&gt; .within uint .size 8
}

requested-tc-info = {
  component-id =&gt; SUIT_Component_Identifier,
  ? tc-manifest-sequence-number =&gt; .within uint .size 8
  ? have-binary =&gt; bool
}

update = [
  type: TEEP-TYPE-update,
  options: {
    ? token =&gt; bstr .size (8..64),
    ? manifest-list =&gt; [ + bstr .cbor SUIT_Envelope ],
    * $$update-extensions,
    * $$teep-option-extensions
  }
]

teep-success = [
  type: TEEP-TYPE-teep-success,
  options: {
    ? token =&gt; bstr .size (8..64),
    ? msg =&gt; text .size (1..128),
    ? suit-reports =&gt; [ + suit-report ],
    * $$teep-success-extensions,
    * $$teep-option-extensions
  }
]

teep-error = [
  type: TEEP-TYPE-teep-error,
  options: {
     ? token =&gt; bstr .size (8..64),
     ? err-msg =&gt; text .size (1..128),
     ? supported-cipher-suites =&gt; [ + suite ],
     ? supported-freshness-mechanisms =&gt; [ + freshness-mechanism ],
     ? versions =&gt; [ + version ],
     ? suit-reports =&gt; [ + suit-report ],
     * $$teep-error-extensions,
     * $$teep-option-extensions
  },
  err-code: uint (0..23)
]

; The err-code parameter, uint (0..23)
ERR_PERMANENT_ERROR = 1
ERR_UNSUPPORTED_EXTENSION = 2
ERR_UNSUPPORTED_FRESHNESS_MECHANISMS = 3
ERR_UNSUPPORTED_MSG_VERSION = 4
ERR_UNSUPPORTED_CIPHER_SUITES = 5
ERR_BAD_CERTIFICATE = 6
ERR_CERTIFICATE_EXPIRED = 9
ERR_TEMPORARY_ERROR = 10
ERR_MANIFEST_PROCESSING_FAILED = 17

; labels of mapkey for teep message parameters, uint (0..23)
supported-cipher-suites = 1
challenge = 2
versions = 3
selected-cipher-suite = 5
selected-version = 6
evidence = 7
tc-list = 8
ext-list = 9
manifest-list = 10
msg = 11
err-msg = 12
evidence-format = 13
requested-tc-list = 14
unneeded-tc-list = 15
component-id = 16
tc-manifest-sequence-number = 17
have-binary = 18
suit-reports = 19
token = 20
supported-freshness-mechanisms = 21
</pre><a href="#appendix-C-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="d-examples-of-diagnostic-notation-and-binary-representation">
<section id="appendix-D">
      <h2 id="name-d-examples-of-diagnostic-no">
<a href="#name-d-examples-of-diagnostic-no" class="section-name selfRef">D. Examples of Diagnostic Notation and Binary Representation</a>
      </h2>
<p id="appendix-D-1">This section includes some examples with the following assumptions:<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1">
          <p id="appendix-D-2.1.1">The device will have two TCs with the following SUIT Component Identifiers:<a href="#appendix-D-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.1">[ 0x000102030405060708090a0b0c0d0e0f ]<a href="#appendix-D-2.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-D-2.1.2.2">[ 0x100102030405060708090a0b0c0d0e0f ]<a href="#appendix-D-2.1.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-D-2.2">SUIT manifest-list is set empty only for example purposes (see Appendix E
for actual manifest examples)<a href="#appendix-D-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<div id="d1-queryrequest-message">
<section id="appendix-D.1">
        <h3 id="name-d1-queryrequest-message">
<a href="#name-d1-queryrequest-message" class="section-name selfRef">D.1. QueryRequest Message</a>
        </h3>
<div id="d11-cbor-diagnostic-notation">
<section id="appendix-D.1.1">
          <h4 id="name-d11-cbor-diagnostic-notatio">
<a href="#name-d11-cbor-diagnostic-notatio" class="section-name selfRef">D.1.1. CBOR Diagnostic Notation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.1.1-1">
<pre>
/ query-request = /
[
  1,  / type : TEEP-TYPE-query-request = 1 (uint (0..23)) /
  / options : /
  {
    20 : 0xa0a1a2a3a4a5a6a7a8a9aaabacadaeaf,
            / token = 20 (mapkey) :
              h'a0a1a2a3a4a5a6a7a8a9aaabacadaeaf' (bstr .size (8..64)),
              generated by TAM /
    1 : [ 1 ], / supported-cipher-suites = 1 (mapkey) :
                 TEEP-AES-CCM-16-64-128-HMAC256--256-X25519-EdDSA =
                 [ 1 ] (array of .within uint .size 4) /
    3 : [ 0 ] / version = 3 (mapkey) :
                 [ 0 ] (array of .within uint .size 4) /
  },
  3   / data-item-requested :
        attestation | trusted-components = 3 (.within uint .size 8) /
]
</pre><a href="#appendix-D.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="d12-cbor-binary-representation">
<section id="appendix-D.1.2">
          <h4 id="name-d12-cbor-binary-representat">
<a href="#name-d12-cbor-binary-representat" class="section-name selfRef">D.1.2. CBOR Binary Representation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.1.2-1">
<pre>
83                       # array(3)
  01                     # unsigned(1) uint (0..23)
  A4                     # map(4)
    14                   # unsigned(20) uint (0..23)
    4F                   # bytes(16) (8..64)
      A0A1A2A3A4A5A6A7A8A9AAABACADAEAF
    01                   # unsigned(1) uint (0..23)
    81                   # array(1)
      01                 # unsigned(1) within uint .size 4
    03                   # unsigned(3) uint (0..23)
    81                   # array(1)
      00                 # unsigned(0) within uint .size 4
    04                   # unsigned(4) uint (0..23)
    43                   # bytes(3)
      010203             # "\x01\x02\x03"
  03                     # unsigned(3) .within uint .size 8
</pre><a href="#appendix-D.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="d2-entity-attestation-token">
<section id="appendix-D.2">
        <h3 id="name-d2-entity-attestation-token">
<a href="#name-d2-entity-attestation-token" class="section-name selfRef">D.2. Entity Attestation Token</a>
        </h3>
<p id="appendix-D.2-1">This is shown below in CBOR diagnostic form.  Only the payload signed by
COSE is shown.<a href="#appendix-D.2-1" class="pilcrow">¶</a></p>
<div id="d21-cbor-diagnostic-notation">
<section id="appendix-D.2.1">
          <h4 id="name-d21-cbor-diagnostic-notatio">
<a href="#name-d21-cbor-diagnostic-notatio" class="section-name selfRef">D.2.1. CBOR Diagnostic Notation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.2.1-1">
<pre>
/ eat-claim-set = /
{
    / issuer /                   1: "joe",
    / timestamp (iat) /          6: 1(1526542894)
    / nonce /                   10: h'948f8860d13a463e8e',
    / secure-boot /             15: true,
    / debug-status /            16: 3, / disabled-permanently /
    / security-level /          14: 3, / secure-restricted /
    / device-identifier /    &lt;TBD&gt;: h'e99600dd921649798b013e9752dcf0c5',
    / vendor-identifier /    &lt;TBD&gt;: h'2b03879b33434a7ca682b8af84c19fd4',
    / class-identifier /     &lt;TBD&gt;: h'9714a5796bd245a3a4ab4f977cb8487f',
    / chip-version /            26: [ "MyTEE", 1 ],
    / component-identifier / &lt;TBD&gt;: h'60822887d35e43d5b603d18bcaa3f08d',
    / version /              &lt;TBD&gt;: "v0.1"
}
</pre><a href="#appendix-D.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="d3-queryresponse-message">
<section id="appendix-D.3">
        <h3 id="name-d3-queryresponse-message">
<a href="#name-d3-queryresponse-message" class="section-name selfRef">D.3. QueryResponse Message</a>
        </h3>
<div id="d31-cbor-diagnostic-notation">
<section id="appendix-D.3.1">
          <h4 id="name-d31-cbor-diagnostic-notatio">
<a href="#name-d31-cbor-diagnostic-notatio" class="section-name selfRef">D.3.1. CBOR Diagnostic Notation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.3.1-1">
<pre>
/ query-response = /
[
  2,  / type : TEEP-TYPE-query-response = 2 (uint (0..23)) /
  / options : /
  {
    20 : 0xa0a1a2a3a4a5a6a7a8a9aaabacadaeaf,
            / token = 20 (mapkey) :
              h'a0a1a2a3a4a5a6a7a8a9aaabacadaeaf' (bstr .size (8..64)),
              given from TAM's QueryRequest message /
    5 : 1,  / selected-cipher-suite = 5 (mapkey) :
              TEEP-AES-CCM-16-64-128-HMAC256--256-X25519-EdDSA =
              1 (.within uint .size 4) /
    6 : 0,  / selected-version = 6 (mapkey) :
              0 (.within uint .size 4) /
    7 : ... / evidence = 7 (mapkey) :
              Entity Attestation Token /
    8 : [   / tc-list = 8 (mapkey) : (array of tc-info) /
      {
        16 : [ 0x000102030405060708090a0b0c0d0e0f ] / component-id =
               16 (mapkey) : [ h'000102030405060708090a0b0c0d0e0f' ]
               (SUIT_Component_Identifier =  [* bstr]) /
      },
      {
        16 : [ 0x100102030405060708090a0b0c0d0e0f ] / component-id =
               16 (mapkey) : [ h'100102030405060708090a0b0c0d0e0f' ]
               (SUIT_Component_Identifier =  [* bstr]) /
      }
        ]
    }
]
</pre><a href="#appendix-D.3.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="d32-cbor-binary-representation">
<section id="appendix-D.3.2">
          <h4 id="name-d32-cbor-binary-representat">
<a href="#name-d32-cbor-binary-representat" class="section-name selfRef">D.3.2. CBOR Binary Representation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.3.2-1">
<pre>
82                       # array(2)
  02                     # unsigned(2) uint (0..23)
  A5                     # map(5)
    14                   # unsigned(20) uint (0..23)
    4F                   # bytes(16) (8..64)
      A0A1A2A3A4A5A6A7A8A9AAABACADAEAF
    05                   # unsigned(5) uint (0..23)
    01                   # unsigned(1) .within uint .size 4
    06                   # unsigned(6) uint (0..23)
    00                   # unsigned(0) .within uint .size 4
    07                   # unsigned(7) uint (0..23)
      ...                # Entity Attestation Token
    08                   # unsigned(8) uint (0..23)
    82                   # array(2)
      81                 # array(1)
        4F               # bytes(16)
          000102030405060708090A0B0C0D0E0F
      81                 # array(1)
        4F               # bytes(16)
          100102030405060708090A0B0C0D0E0F
</pre><a href="#appendix-D.3.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="d4-update-message">
<section id="appendix-D.4">
        <h3 id="name-d4-update-message">
<a href="#name-d4-update-message" class="section-name selfRef">D.4. Update Message</a>
        </h3>
<div id="d41-cbor-diagnostic-notation">
<section id="appendix-D.4.1">
          <h4 id="name-d41-cbor-diagnostic-notatio">
<a href="#name-d41-cbor-diagnostic-notatio" class="section-name selfRef">D.4.1. CBOR Diagnostic Notation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.4.1-1">
<pre>
/ update = /
[
  3,  / type : TEEP-TYPE-update = 3 (uint (0..23)) /
  / options : /
  {
    20 : 0xa0a1a2a3a4a5a6a7a8a9aaabacadaeaf,
             / token = 20 (mapkey) :
               h'a0a1a2a3a4a5a6a7a8a9aaabacadaeaf' (bstr .size (8..64)),
               generated by TAM /
    10 : [ ] / manifest-list = 10 (mapkey) :
               [ ] (array of bstr wrapped SUIT_Envelope(any)) /
             / empty, example purpose only /
  }
]
</pre><a href="#appendix-D.4.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="d42-cbor-binary-representation">
<section id="appendix-D.4.2">
          <h4 id="name-d42-cbor-binary-representat">
<a href="#name-d42-cbor-binary-representat" class="section-name selfRef">D.4.2. CBOR Binary Representation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.4.2-1">
<pre>
82                       # array(2)
  03                     # unsigned(3) uint (0..23)
  A3                     # map(3)
    14                   # unsigned(20) uint (0..23)
    4F                   # bytes(16) (8..64)
      A0A1A2A3A4A5A6A7A8A9AAABACADAEAF
    0A                   # unsigned(10) uint (0..23)
    80                   # array(0)
</pre><a href="#appendix-D.4.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="d5-success-message">
<section id="appendix-D.5">
        <h3 id="name-d5-success-message">
<a href="#name-d5-success-message" class="section-name selfRef">D.5. Success Message</a>
        </h3>
<div id="d51-cbor-diagnostic-notation">
<section id="appendix-D.5.1">
          <h4 id="name-d51-cbor-diagnostic-notatio">
<a href="#name-d51-cbor-diagnostic-notatio" class="section-name selfRef">D.5.1. CBOR Diagnostic Notation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.5.1-1">
<pre>
/ teep-success = /
[
  5,  / type : TEEP-TYPE-teep-success = 5 (uint (0..23)) /
  / options : /
  {
    20 : 0xa0a1a2a3a4a5a6a7a8a9aaabacadaeaf,
             / token = 20 (mapkey) :
               h'a0a1a2a3a4a5a6a7a8a9aaabacadaeaf' (bstr .size (8..64)),
               given from TAM's Update message /
  }
]
</pre><a href="#appendix-D.5.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="d52-cbor-binary-representation">
<section id="appendix-D.5.2">
          <h4 id="name-d52-cbor-binary-representat">
<a href="#name-d52-cbor-binary-representat" class="section-name selfRef">D.5.2. CBOR Binary Representation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.5.2-1">
<pre>
82                       # array(2)
  05                     # unsigned(5) uint (0..23)
  A1                     # map(1)
    14                   # unsigned(20) uint (0..23)
    4F                   # bytes(16) (8..64)
      A0A1A2A3A4A5A6A7A8A9AAABACADAEAF
</pre><a href="#appendix-D.5.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="d6-error-message">
<section id="appendix-D.6">
        <h3 id="name-d6-error-message">
<a href="#name-d6-error-message" class="section-name selfRef">D.6. Error Message</a>
        </h3>
<div id="d61-cbor-diagnostic-notation">
<section id="appendix-D.6.1">
          <h4 id="name-d61-cbor-diagnostic-notatio">
<a href="#name-d61-cbor-diagnostic-notatio" class="section-name selfRef">D.6.1. CBOR Diagnostic Notation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.6.1-1">
<pre>
/ teep-error = /
[
  6,  / type : TEEP-TYPE-teep-error = 6 (uint (0..23)) /
  / options : /
  {
    20 : 0xa0a1a2a3a4a5a6a7a8a9aaabacadaeaf,
           / token = 20 (mapkey) :
             h'a0a1a2a3a4a5a6a7a8a9aaabacadaeaf' (bstr .size (8..64)),
             given from TAM's Update message /
    12 : "disk-full"  / err-msg = 12 (mapkey) :
                        "disk-full" (text .size (1..128)) /
  },
  17, / err-code : ERR_MANIFEST_PROCESSING_FAILED = 17 (uint (0..23)) /
]
</pre><a href="#appendix-D.6.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="d62-cbor-binary-representation">
<section id="appendix-D.6.2">
          <h4 id="name-d62-cbor-binary-representat">
<a href="#name-d62-cbor-binary-representat" class="section-name selfRef">D.6.2. CBOR binary Representation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-D.6.2-1">
<pre>
83                       # array(3)
  06                     # unsigned(6) uint (0..23)
  A2                     # map(2)
    14                   # unsigned(20) uint (0..23)
    4F                   # bytes(16) (8..64)
      A0A1A2A3A4A5A6A7A8A9AAABACADAEAF
    0C                   # unsigned(12) uint (0..23)
    69                   # text(9) (1..128)
      6469736B2D66756C6C # "disk-full"
  11                     # unsigned(17) uint (0..23)
</pre><a href="#appendix-D.6.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="suit-examples">
<section id="appendix-E">
      <h2 id="name-e-examples-of-suit-manifest">
<a href="#name-e-examples-of-suit-manifest" class="section-name selfRef">E. Examples of SUIT Manifests</a>
      </h2>
<p id="appendix-E-1">This section shows some examples of SUIT manifests described in <a href="#update-msg-def" class="xref">Section 4.4</a>.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">The examples are signed using the following ECDSA secp256r1 key with SHA256 as the digest function.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<p id="appendix-E-3">COSE_Sign1 Cryptographic Key:<a href="#appendix-E-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-E-4">
<pre>
-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgApZYjZCUGLM50VBC
CjYStX+09jGmnyJPrpDLTz/hiXOhRANCAASEloEarguqq9JhVxie7NomvqqL8Rtv
P+bitWWchdvArTsfKktsCYExwKNtrNHXi9OB3N+wnAUtszmR23M4tKiW
-----END PRIVATE KEY-----
</pre><a href="#appendix-E-4" class="pilcrow">¶</a>
</div>
<p id="appendix-E-5">The corresponding public key can be used to verify these examples:<a href="#appendix-E-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-E-6">
<pre>
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhJaBGq4LqqvSYVcYnuzaJr6qi/Eb
bz/m4rVlnIXbwK07HypLbAmBMcCjbazR14vTgdzfsJwFLbM5kdtzOLSolg==
-----END PUBLIC KEY-----
</pre><a href="#appendix-E-6" class="pilcrow">¶</a>
</div>
<div id="suit-uri">
<section id="appendix-E.1">
        <h3 id="name-example-1-suit-manifest-poi">
<a href="#name-example-1-suit-manifest-poi" class="section-name selfRef">Example 1: SUIT Manifest pointing to URI of the Trusted Component Binary</a>
        </h3>
<div id="cbor-diagnostic-notation-of-suit-manifest">
<section id="appendix-E.1.1">
          <h4 id="name-cbor-diagnostic-notation-of">
<a href="#name-cbor-diagnostic-notation-of" class="section-name selfRef">CBOR Diagnostic Notation of SUIT Manifest</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.1.1-1">
<pre>
/ SUIT_Envelope_Tagged / 107( {
  / suit-authentication-wrapper / 2: &lt;&lt; [
    &lt;&lt; [
      / suit-digest-algorithm-id: / -16 / suit-cose-alg-sha256 /,
      / suit-digest-bytes: / h'DB601ADE73092B58532CA03FBB663DE49532435336F1558B49BB622726A2FEDD'
    ] &gt;&gt;,
    &lt;&lt; / COSE_Sign1_Tagged / 18( [
      / protected: / &lt;&lt; {
        / algorithm-id / 1: -7 / ES256 /
      } &gt;&gt;,
      / unprotected: / {},
      / payload: / null,
      / signature: / h'5B2D535A2B6D5E3C585C1074F414DA9E10BD285C99A33916DADE3ED38812504817AC48B62B8E984EC622785BD1C411888BE531B1B594507816B201F6F28579A4'
    ] ) &gt;&gt;
  ] &gt;&gt;,
  / suit-manifest / 3: &lt;&lt; {
    / suit-manifest-version / 1: 1,
    / suit-manifest-sequence-number / 2: 3,
    / suit-common / 3: &lt;&lt; {
      / suit-components / 2: [
        [
          h'544545502D446576696365',           / "TEEP-Device" /
          h'5365637572654653',                 / "SecureFS" /
          h'8D82573A926D4754935332DC29997F74', / tc-uuid /
          h'7461'                              / "ta" /
        ]
      ],
      / suit-common-sequence / 4: &lt;&lt; [
        / suit-directive-override-parameters / 20, {
          / suit-parameter-vendor-identifier / 1: h'C0DDD5F15243566087DB4F5B0AA26C2F',
          / suit-parameter-class-identifier / 2: h'DB42F7093D8C55BAA8C5265FC5820F4E',
          / suit-parameter-image-digest / 3: &lt;&lt; [
            / suit-digest-algorithm-id: / -16 / suit-cose-alg-sha256 /,
            / suit-digest-bytes: / h'8CF71AC86AF31BE184EC7A05A411A8C3A14FD9B77A30D046397481469468ECE8'
          ] &gt;&gt;,
          / suit-parameter-image-size / 14: 20
        },
        / suit-condition-vendor-identifier / 1, 15,
        / suit-condition-class-identifier / 2, 15
      ] &gt;&gt;
    } &gt;&gt;,
    / suit-install / 9: &lt;&lt; [
      / suit-directive-override-parameters / 20, {
        / suit-parameter-uri / 21: "https://example.org/8d82573a-926d-4754-9353-32dc29997f74.ta"
      },
      / suit-directive-fetch / 21, 15,
      / suit-condition-image-match / 3, 15
    ] &gt;&gt;
  } &gt;&gt;
} )
</pre><a href="#appendix-E.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor-binary-representation">
<section id="appendix-E.1.2">
          <h4 id="name-cbor-binary-representation">
<a href="#name-cbor-binary-representation" class="section-name selfRef">CBOR Binary Representation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.1.2-1">
<pre>
D8 6B                                               # tag(107) / SUIT_Envelope_Tagged /
   A2                                               # map(2)
      02                                            # unsigned(2) / suit-authentication-wrapper /
      58 73                                         # bytes(115)
         82                                         # array(2)
            58 24                                   # bytes(36)
               82                                   # array(2)
                  2F                                # negative(15) / -16 = suit-cose-alg-sha256 /
                  58 20                             # bytes(32)
                     DB601ADE73092B58532CA03FBB663DE49532435336F1558B49BB622726A2FEDD
            58 4A                                   # bytes(74)
               D2                                   # tag(18) / COSE_Sign1_Tagged /
                  84                                # array(4)
                     43                             # bytes(3)
                        A1                          # map(1)
                           01                       # unsigned(1) / algorithm-id /
                           26                       # negative(6) / -7 = ES256 /
                     A0                             # map(0)
                     F6                             # primitive(22) / null /
                     58 40                          # bytes(64)
                        5B2D535A2B6D5E3C585C1074F414DA9E10BD285C99A33916DADE3ED38812504817AC48B62B8E984EC622785BD1C411888BE531B1B594507816B201F6F28579A4
      03                                            # unsigned(3) / suit-manifest: /
      58 D4                                         # bytes(212)
         A4                                         # map(4)
            01                                      # unsigned(1) / suit-manifest-version: /
            01                                      # unsigned(1)
            02                                      # unsigned(2) / suit-manifest-sequence-number: /
            03                                      # unsigned(3)
            03                                      # unsigned(3) / suit-common: /
            58 84                                   # bytes(132)
               A2                                   # map(2)
                  02                                # unsigned(2) / suit-components: /
                  81                                # array(1)
                     84                             # array(4)
                        4B                          # bytes(11)
                           544545502D446576696365   # "TEEP-Device"
                        48                          # bytes(8)
                           5365637572654653         # "SecureFS"
                        50                          # bytes(16)
                           8D82573A926D4754935332DC29997F74 # tc-uuid
                        42                          # bytes(2)
                           7461                     # "ta"
                  04                                # unsigned(4) / suit-common-sequence: /
                  58 54                             # bytes(84)
                     86                             # array(6)
                        14                          # unsigned(20) / suit-directive-override-parameters: /
                        A4                          # map(4)
                           01                       # unsigned(1) / suit-parameter-vendor-identifier: /
                           50                       # bytes(16)
                              C0DDD5F15243566087DB4F5B0AA26C2F
                           02                       # unsigned(2) / suit-parameter-class-identifier: /
                           50                       # bytes(16)
                              DB42F7093D8C55BAA8C5265FC5820F4E
                           03                       # unsigned(3) / suit-parameter-image-digest: /
                           58 24                    # bytes(36)
                              82                    # array(2)
                                 2F                 # negative(15) / -16 = suit-cose-alg-sha256 /
                                 58 20              # bytes(32)
                                    8CF71AC86AF31BE184EC7A05A411A8C3A14FD9B77A30D046397481469468ECE8
                           0E                       # unsigned(14) / suit-parameter-image-size: /
                           14                       # unsigned(20)
                        01                          # unsigned(1) / suit-condition-vendor-identifier: /
                        0F                          # unsigned(15)
                        02                          # unsigned(2) / suit-condition-class-identifier: /
                        0F                          # unsigned(15)
            09                                      # unsigned(9) / suit-install: /
            58 45                                   # bytes(69)
               86                                   # array(6)
                  14                                # unsigned(20) / suit-directive-override-parameters: /
                  A1                                # map(1)
                     15                             # unsigned(21) / suit-parameter-uri: /
                     78 3B                          # text(59)
                        68747470733A2F2F6578616D706C652E6F72672F38643832353733612D393236642D343735342D393335332D3332646332393939376637342E7461 # "https://example.org/8d82573a-926d-4754-9353-32dc29997f74.ta"
                  15                                # unsigned(21) / suit-directive-fetch: /
                  0F                                # unsigned(15)
                  03                                # unsigned(3) / suit-condition-image-match: /
                  0F                                # unsigned(15)
</pre><a href="#appendix-E.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor-binary-in-hex">
<section id="appendix-E.1.3">
          <h4 id="name-cbor-binary-in-hex">
<a href="#name-cbor-binary-in-hex" class="section-name selfRef">CBOR Binary in Hex</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.1.3-1">
<pre>
D86BA2025873825824822F5820DB601ADE73092B58532CA03FBB663DE495
32435336F1558B49BB622726A2FEDD584AD28443A10126A0F658405B2D53
5A2B6D5E3C585C1074F414DA9E10BD285C99A33916DADE3ED38812504817
AC48B62B8E984EC622785BD1C411888BE531B1B594507816B201F6F28579
A40358D4A401010203035884A20281844B544545502D4465766963654853
65637572654653508D82573A926D4754935332DC29997F74427461045854
8614A40150C0DDD5F15243566087DB4F5B0AA26C2F0250DB42F7093D8C55
BAA8C5265FC5820F4E035824822F58208CF71AC86AF31BE184EC7A05A411
A8C3A14FD9B77A30D046397481469468ECE80E14010F020F0958458614A1
15783B68747470733A2F2F6578616D706C652E6F72672F38643832353733
612D393236642D343735342D393335332D3332646332393939376637342E
7461150F030F
</pre><a href="#appendix-E.1.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="suit-integrated">
<section id="appendix-E.2">
        <h3 id="name-example-2-suit-manifest-inc">
<a href="#name-example-2-suit-manifest-inc" class="section-name selfRef">Example 2: SUIT Manifest including the Trusted Component Binary</a>
        </h3>
<div id="cbor-diagnostic-notation-of-suit-manifest-1">
<section id="appendix-E.2.1">
          <h4 id="name-cbor-diagnostic-notation-of-">
<a href="#name-cbor-diagnostic-notation-of-" class="section-name selfRef">CBOR Diagnostic Notation of SUIT Manifest</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.2.1-1">
<pre>
/ SUIT_Envelope_Tagged / 107( {
  / suit-authentication-wrapper / 2: &lt;&lt; [
    &lt;&lt; [
      / suit-digest-algorithm-id: / -16 / suit-cose-alg-sha256 /,
      / suit-digest-bytes: / h'14A98BE957DE38FAE37376EA491FD6CAD9BFBD3C90051C8F5B017D7A496C3B05'
    ] &gt;&gt;,
    &lt;&lt; / COSE_Sign1_Tagged / 18( [
      / protected: / &lt;&lt; {
        / algorithm-id / 1: -7 / ES256 /
      } &gt;&gt;,
      / unprotected: / {},
      / payload: / null,
      / signature: / h'4093B323953785981EB607C8BA61B21E5C4F85726A2AF48C1CB05BD4401B1B1565070728FDA38E6496D631E1D23F966CFF7805EDE721D48507D9192993DA8722'
    ] ) &gt;&gt;
  ] &gt;&gt;,
  / suit-integrated-payload / "#tc": h'48656C6C6F2C2053656375726520576F726C6421', / "Hello, Secure World!" /
  / suit-manifest / 3: &lt;&lt; {
    / suit-manifest-version / 1: 1,
    / suit-manifest-sequence-number / 2: 3,
    / suit-common / 3: &lt;&lt; {
      / suit-components / 2: [
        [
          h'544545502D446576696365',           / "TEEP-Device" /
          h'5365637572654653',                 / "SecureFS" /
          h'8D82573A926D4754935332DC29997F74', / tc-uuid /
          h'7461'                              / "ta" /
        ]
      ],
      / suit-common-sequence / 4: &lt;&lt; [
        / suit-directive-override-parameters / 20, {
          / suit-parameter-vendor-identifier / 1: h'C0DDD5F15243566087DB4F5B0AA26C2F',
          / suit-parameter-class-identifier / 2: h'DB42F7093D8C55BAA8C5265FC5820F4E',
          / suit-parameter-image-digest / 3: &lt;&lt; [
            / suit-digest-algorithm-id: / -16 / suit-cose-alg-sha256 /,
            / suit-digest-bytes: / h'8CF71AC86AF31BE184EC7A05A411A8C3A14FD9B77A30D046397481469468ECE8'
          ] &gt;&gt;,
          / suit-parameter-image-size / 14: 20
        },
        / suit-condition-vendor-identifier / 1, 15,
        / suit-condition-class-identifier / 2, 15
      ] &gt;&gt;
    } &gt;&gt;,
    / suit-install / 9: &lt;&lt; [
      / suit-directive-override-parameters / 20, {
        / suit-parameter-uri / 21: "#tc"
      },
      / suit-directive-fetch / 21, 15,
      / suit-condition-image-match / 3, 15
    ] &gt;&gt;
  } &gt;&gt;
} )
</pre><a href="#appendix-E.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor-binary-representation-1">
<section id="appendix-E.2.2">
          <h4 id="name-cbor-binary-representation-2">
<a href="#name-cbor-binary-representation-2" class="section-name selfRef">CBOR Binary Representation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.2.2-1">
<pre>
D8 6B                                               # tag(107) / SUIT_Envelope_Tagged /
   A3                                               # map(3)
      02                                            # unsigned(2) / suit-authentication-wrapper /
      58 73                                         # bytes(115)
         82                                         # array(2)
            58 24                                   # bytes(36)
               82                                   # array(2)
                  2F                                # negative(15) / -16 = suit-cose-alg-sha256 /
                  58 20                             # bytes(32)
                     14A98BE957DE38FAE37376EA491FD6CAD9BFBD3C90051C8F5B017D7A496C3B05
            58 4A                                   # bytes(74)
               D2                                   # tag(18) / COSE_Sign1_Tagged /
                  84                                # array(4)
                     43                             # bytes(3)
                        A1                          # map(1)
                           01                       # unsigned(1) / algorithm-id /
                           26                       # negative(6) / -7 = ES256 /
                     A0                             # map(0)
                     F6                             # primitive(22) / null /
                     58 40                          # bytes(64)
                        4093B323953785981EB607C8BA61B21E5C4F85726A2AF48C1CB05BD4401B1B1565070728FDA38E6496D631E1D23F966CFF7805EDE721D48507D9192993DA8722
      63                                            # text(3) / suit-integrated-payload /
         237463                                     # "#tc"
      54                                            # bytes(20)
         48656C6C6F2C2053656375726520576F726C6421   # "Hello, Secure World!"
      03                                            # unsigned(3) / suit-manifest: /
      58 9A                                         # bytes(154)
         A4                                         # map(4)
            01                                      # unsigned(1) / suit-manifest-version: /
            01                                      # unsigned(1)
            02                                      # unsigned(2) / suit-manifest-sequence-number: /
            03                                      # unsigned(3)
            03                                      # unsigned(3) / suit-common: /
            58 84                                   # bytes(132)
               A2                                   # map(2)
                  02                                # unsigned(2) / suit-components: /
                  81                                # array(1)
                     84                             # array(4)
                        4B                          # bytes(11)
                           544545502D446576696365   # "TEEP-Device"
                        48                          # bytes(8)
                           5365637572654653         # "SecureFS"
                        50                          # bytes(16)
                           8D82573A926D4754935332DC29997F74 # tc-uuid
                        42                          # bytes(2)
                           7461                     # "ta"
                  04                                # unsigned(4) / suit-common-sequence: /
                  58 54                             # bytes(84)
                     86                             # array(6)
                        14                          # unsigned(20) / suit-directive-override-parameters: /
                        A4                          # map(4)
                           01                       # unsigned(1) / suit-parameter-vendor-identifier: /
                           50                       # bytes(16)
                              C0DDD5F15243566087DB4F5B0AA26C2F
                           02                       # unsigned(2) / suit-parameter-class-identifier: /
                           50                       # bytes(16)
                              DB42F7093D8C55BAA8C5265FC5820F4E
                           03                       # unsigned(3) / suit-parameter-image-digest: /
                           58 24                    # bytes(36)
                              82                    # array(2)
                                 2F                 # negative(15) / -16 = suit-cose-alg-sha256 /
                                 58 20              # bytes(32)
                                    8CF71AC86AF31BE184EC7A05A411A8C3A14FD9B77A30D046397481469468ECE8
                           0E                       # unsigned(14) / suit-parameter-image-size: /
                           14                       # unsigned(20)
                        01                          # unsigned(1) / suit-condition-vendor-identifier: /
                        0F                          # unsigned(15)
                        02                          # unsigned(2) / suit-condition-class-identifier: /
                        0F                          # unsigned(15)
            09                                      # unsigned(9) / suit-install: /
            4C                                      # bytes(12)
               86                                   # array(6)
                  14                                # unsigned(20) / suit-directive-override-parameters: /
                  A1                                # map(1)
                     15                             # unsigned(21) / suit-parameter-uri: /
                     63                             # text(3)
                        237463                      # "#tc"
                  15                                # unsigned(21) / suit-directive-fetch: /
                  0F                                # unsigned(15)
                  03                                # unsigned(3) / suit-condition-image-match: /
                  0F                                # unsigned(15)
</pre><a href="#appendix-E.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor-binary-in-hex-1">
<section id="appendix-E.2.3">
          <h4 id="name-cbor-binary-in-hex-2">
<a href="#name-cbor-binary-in-hex-2" class="section-name selfRef">CBOR Binary in Hex</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.2.3-1">
<pre>
D86BA3025873825824822F582014A98BE957DE38FAE37376EA491FD6CAD9
BFBD3C90051C8F5B017D7A496C3B05584AD28443A10126A0F658404093B3
23953785981EB607C8BA61B21E5C4F85726A2AF48C1CB05BD4401B1B1565
070728FDA38E6496D631E1D23F966CFF7805EDE721D48507D9192993DA87
22632374635448656C6C6F2C2053656375726520576F726C642103589AA4
01010203035884A20281844B544545502D44657669636548536563757265
4653508D82573A926D4754935332DC29997F744274610458548614A40150
C0DDD5F15243566087DB4F5B0AA26C2F0250DB42F7093D8C55BAA8C5265F
C5820F4E035824822F58208CF71AC86AF31BE184EC7A05A411A8C3A14FD9
B77A30D046397481469468ECE80E14010F020F094C8614A1156323746315
0F030F
</pre><a href="#appendix-E.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="suit-personalization">
<section id="appendix-E.3">
        <h3 id="name-example-3-supplying-personal">
<a href="#name-example-3-supplying-personal" class="section-name selfRef">Example 3: Supplying Personalization Data for Trusted Component Binary</a>
        </h3>
<div id="cbor-diagnostic-notation-of-suit-manifest-2">
<section id="appendix-E.3.1">
          <h4 id="name-cbor-diagnostic-notation-of-s">
<a href="#name-cbor-diagnostic-notation-of-s" class="section-name selfRef">CBOR Diagnostic Notation of SUIT Manifest</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.3.1-1">
<pre>
/ SUIT_Envelope_Tagged / 107( {
  / suit-authentication-wrapper / 2: &lt;&lt; [
    &lt;&lt; [
      / suit-digest-algorithm-id: / -16 / suit-cose-alg-sha256 /,
      / suit-digest-bytes: / h'CE596D785169B72712560B3A246AA98F814498EA3625EEBB72CED9AF273E7FFD'
    ] &gt;&gt;,
    &lt;&lt; / COSE_Sign1_Tagged / 18( [
      / protected: / &lt;&lt; {
        / algorithm-id / 1: -7 / ES256 /
      } &gt;&gt;,
      / unprotected: / {},
      / payload: / null,
      / signature: / h'E9083AA71D2BFCE48253037B9C3116A5EDF23BE0F4B4357A8A835F724660DA7482C64345B4C73DE95F05513BD09FC2E58BD2CC865CC851AD797513A9A951A3CA'
    ] ) &gt;&gt;
  ] &gt;&gt;,
  / suit-manifest / 3: &lt;&lt; {
    / suit-manifest-version / 1: 1,
    / suit-manifest-sequence-number / 2: 3,
    / suit-common / 3: &lt;&lt; {
      / suit-dependencies / 1: [
        {
          / suit-dependency-digest / 1: [
            / suit-digest-algorithm-id: / -16 / suit-cose-alg-sha256 /,
            / suit-digest-bytes: / h'F8690E5A86D010BF2B5348ABB99F2254DB7B608D0D626B98DB51AB3ECFC51907'
          ]
        }
      ],
      / suit-components / 2: [
        [
          h'544545502D446576696365', / "TEEP-Device" /
          h'5365637572654653',       / "SecureFS" /
          h'636F6E6669672E6A736F6E'  / "config.json" /
        ]
      ],
      / suit-common-sequence / 4: &lt;&lt; [
        / suit-directive-set-component-index / 12, 0,
        / suit-directive-override-parameters / 20, {
          / suit-parameter-vendor-identifier / 1: h'C0DDD5F15243566087DB4F5B0AA26C2F',
          / suit-parameter-class-identifier / 2: h'DB42F7093D8C55BAA8C5265FC5820F4E',
          / suit-parameter-image-digest / 3: &lt;&lt; [
            / suit-digest-algorithm-id: / -16 / suit-cose-alg-sha256 /,
            / suit-digest-bytes: / h'AAABCCCDEEEF00012223444566678889ABBBCDDDEFFF01112333455567778999'
          ] &gt;&gt;,
          / suit-parameter-image-size / 14: 64
        },
        / suit-condition-vendor-idnetifier / 1, 15,
        / suit-condition-class-identifier / 2, 15
      ] &gt;&gt;
    } &gt;&gt;,
    / suit-dependency-resolution / 7: &lt;&lt; [
      / suit-directive-set-dependency-index / 13, 0,
      / suit-directive-override-parameters / 20, {
        / suit-parameter-uri / 21: "https://example.org/8d82573a-926d-4754-9353-32dc29997f74.suit"
      },
      / suit-directive-fetch / 21, 2,
      / suit-condition-image-match / 3, 15
    ] &gt;&gt;,
    / suit-install / 9: &lt;&lt; [
      / suit-directive-set-dependency-index / 13, 0,
      / suit-directive-process-dependency / 18, 0,
      / suit-directive-set-component-index / 12, 0,
      / suit-directive-override-parameters / 20, {
        / suit-parameter-uri / 21: "https://example.org/config.json"
      },
      / suit-directive-fetch / 21, 2,
      / suit-condition-image-match / 3, 15
    ] &gt;&gt;,
    / suit-validate / 10: &lt;&lt; [
      / suit-directive-set-component-index / 12, 0,
      / suit-condition-image-match/ 3, 15
    ] &gt;&gt;
  } &gt;&gt;
} )
</pre><a href="#appendix-E.3.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor-binary-represenation">
<section id="appendix-E.3.2">
          <h4 id="name-cbor-binary-represenation">
<a href="#name-cbor-binary-represenation" class="section-name selfRef">CBOR Binary Represenation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.3.2-1">
<pre>
D8 6B                                               # tag(107) / SUIT_Envelope_Tagged /
   A2                                               # map(2)
      02                                            # unsigned(2) / suit-authentication-wrapper: /
      58 73                                         # bytes(115)
         82                                         # array(2)
            58 24                                   # bytes(36)
               82                                   # array(2)
                  2F                                # negative(15) / -16 = suit-cose-alg-sha256 /
                  58 20                             # bytes(32)
                     CE596D785169B72712560B3A246AA98F814498EA3625EEBB72CED9AF273E7FFD
            58 4A                                   # bytes(74)
               D2                                   # tag(18) / COSE_Sign1_Tagged /
                  84                                # array(4)
                     43                             # bytes(3)
                        A1                          # map(1)
                           01                       # unsigned(1) / algorithm-id /
                           26                       # negative(6) / -7 = ES256 /
                     A0                             # map(0)
                     F6                             # primitive(22) / null /
                     58 40                          # bytes(64)
                        E9083AA71D2BFCE48253037B9C3116A5EDF23BE0F4B4357A8A835F724660DA7482C64345B4C73DE95F05513BD09FC2E58BD2CC865CC851AD797513A9A951A3CA
      03                                            # unsigned(3) / suit-manifest: /
      59 0134                                       # bytes(308)
         A6                                         # map(6)
            01                                      # unsigned(1) / suit-manifest-version: /
            01                                      # unsigned(1)
            02                                      # unsigned(2) / suit-manifest-sequence-number: /
            03                                      # unsigned(3)
            03                                      # unsigned(3) / suit-common: /
            58 A7                                   # bytes(167)
               A3                                   # map(3)
                  01                                # unsigned(1) / suit-dependencies: /
                  81                                # array(1)
                     A1                             # map(1)
                        01                          # unsigned(1) suit-dependency-digest: /
                        82                          # array(2)
                           2F                       # negative(15) / -16 = suit-cose-alg-sha256 /
                           58 20                    # bytes(32)
                              F8690E5A86D010BF2B5348ABB99F2254DB7B608D0D626B98DB51AB3ECFC51907
                  02                                # unsigned(2) / suit-components: /
                  81                                # array(1)
                     83                             # array(3)
                        4B                          # bytes(11)
                           544545502D446576696365   # "TEEP-Device"
                        48                          # bytes(8)
                           5365637572654653         # "SecureFS"
                        4B                          # bytes(11)
                           636F6E6669672E6A736F6E   # "config.json"
                  04                                # unsigned(4) / suit-common-sequence: /
                  58 57                             # bytes(87)
                     88                             # array(8)
                        0C                          # unsigned(12) / suit-directive-set-component-index: /
                        00                          # unsigned(0)
                        14                          # unsigned(20) / suit-directive-override-parameters: /
                        A4                          # map(4)
                           01                       # unsigned(1) / suit-parameter-vendor-identifier: /
                           50                       # bytes(16)
                              C0DDD5F15243566087DB4F5B0AA26C2F
                           02                       # unsigned(2) / suit-parameter-class-identifier: /
                           50                       # bytes(16)
                              DB42F7093D8C55BAA8C5265FC5820F4E
                           03                       # unsigned(3) / suit-parameter-image-digest: /
                           58 24                    # bytes(36)
                              82                    # array(2)
                                 2F                 # negative(15) / -16 = suit-cose-alg-sha256 /
                                 58 20              # bytes(32)
                                    AAABCCCDEEEF00012223444566678889ABBBCDDDEFFF01112333455567778999
                           0E                       # unsigned(14) / suit-parameter-image-size: /
                           18 40                    # unsigned(64)
                        01                          # unsigned(1) / suit-condition-vendor-identifier: /
                        0F                          # unsigned(15)
                        02                          # unsigned(2) / suit-condition-class-identifier: /
                        0F                          # unsigned(15)
            07                                      # unsigned(7) / suit-dependency-resolution: /
            58 49                                   # bytes(73)
               88                                   # array(8)
                  0D                                # unsigned(13) / suit-directive-set-dependency-index: /
                  00                                # unsigned(0)
                  14                                # unsigned(20) / suit-directive-override-parameters: /
                  A1                                # map(1)
                     15                             # unsigned(21) / suit-parameter-uri: /
                     78 3D                          # text(61)
                        68747470733A2F2F6578616D706C652E6F72672F38643832353733612D393236642D343735342D393335332D3332646332393939376637342E73756974 # "https://example.org/8d82573a-926d-4754-9353-32dc29997f74.suit"
                  15                                # unsigned(21) / suit-directive-fetch: /
                  02                                # unsigned(2)
                  03                                # unsigned(3) / suit-condition-image-match: /
                  0F                                # unsigned(15)
            09                                      # unsigned(9) / suit-install: /
            58 2F                                   # bytes(47)
               8C                                   # array(12)
                  0D                                # unsigned(13) / suit-directive-set-dependency-index: /
                  00                                # unsigned(0)
                  12                                # unsigned(18) / suit-directive-process-dependency: /
                  00                                # unsigned(0)
                  0C                                # unsigned(12) / suit-directive-set-component-index: /
                  00                                # unsigned(0)
                  14                                # unsigned(20) / suit-directive-override-parameters: /
                  A1                                # map(1)
                     15                             # unsigned(21) / suit-parameter-uri: /
                     78 1F                          # text(31)
                        68747470733A2F2F6578616D706C652E6F72672F636F6E6669672E6A736F6E # "https://example.org/config.json"
                  15                                # unsigned(21) / suit-directive-fetch: /
                  02                                # unsigned(2)
                  03                                # unsigned(3) / suit-condition-image-match: /
                  0F                                # unsigned(15)
            0A                                      # unsigned(10) / suit-validate: /
            45                                      # bytes(5)
               84                                   # array(4)
                  0C                                # unsigned(12) / suit-directive-set-component-index: /
                  00
                  03                                # unsigned(3) / suit-condition-image-match: /
                  0F                                # unsigned(15)
</pre><a href="#appendix-E.3.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor-binary-in-hex-2">
<section id="appendix-E.3.3">
          <h4 id="name-cbor-binary-in-hex-3">
<a href="#name-cbor-binary-in-hex-3" class="section-name selfRef">CBOR Binary in Hex</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.3.3-1">
<pre>
D86BA2025873825824822F5820CE596D785169B72712560B3A246AA98F81
4498EA3625EEBB72CED9AF273E7FFD584AD28443A10126A0F65840E9083A
A71D2BFCE48253037B9C3116A5EDF23BE0F4B4357A8A835F724660DA7482
C64345B4C73DE95F05513BD09FC2E58BD2CC865CC851AD797513A9A951A3
CA03590134A6010102030358A7A30181A101822F5820DB601ADE73092B58
532CA03FBB663DE49532435336F1558B49BB622726A2FEDD0281834B5445
45502D4465766963654853656375726546534B636F6E6669672E6A736F6E
045857880C0014A40150C0DDD5F15243566087DB4F5B0AA26C2F0250DB42
F7093D8C55BAA8C5265FC5820F4E035824822F5820AAABCCCDEEEF000122
23444566678889ABBBCDDDEFFF011123334555677789990E1840010F020F
075849880D0014A115783D68747470733A2F2F6578616D706C652E6F7267
2F38643832353733612D393236642D343735342D393335332D3332646332
393939376637342E737569741502030F09582F8C0D0012000C0014A11578
1F68747470733A2F2F6578616D706C652E6F72672F636F6E6669672E6A73
6F6E1502030F0A45840C00030F
</pre><a href="#appendix-E.3.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="suit-unlink">
<section id="appendix-E.4">
        <h3 id="name-e4-example-4-unlink-a-trust">
<a href="#name-e4-example-4-unlink-a-trust" class="section-name selfRef">E.4. Example 4: Unlink a Trusted Component</a>
        </h3>
<div id="cbor-diagnostic-notation-of-suit-manifest-3">
<section id="appendix-E.4.1">
          <h4 id="name-cbor-diagnostic-notation-of-su">
<a href="#name-cbor-diagnostic-notation-of-su" class="section-name selfRef">CBOR Diagnostic Notation of SUIT Manifest</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.4.1-1">
<pre>
/ SUIT_Envelope_Tagged / 107( {
  / suit-authentication-wrapper / 2: &lt;&lt; [
    &lt;&lt; [
      / suit-digest-algorithm-id: / -16 / suit-cose-alg-sha256 /,
      / suit-digest-bytes: / h'632454F19A9440A5B83493628A7EF8704C8A0205A62C34E425BAA34C71341F42'
    ] &gt;&gt;,
    &lt;&lt; / COSE_Sign1_Tagged / 18( [
      / protected / &lt;&lt; {
        / algorithm-id / 1: -7 / ES256 /
      } &gt;&gt;,
      / unprotected: / {},
      / payload: / null,
      / signature: / h'A32CDB7C1D089C27408CED3C79087220EB0D77F105BB5330912875F4D94AD108D7658C650463AEB7E1CCA5084F22B2F3993176E8B3529A3202ED735E4D39BBBF'
    ] ) &gt;&gt;
  ] &gt;&gt;,
  / suit-manifest / 3: &lt;&lt; {
    / suit-manifest-version / 1: 1,
    / suit-manifest-sequence-number / 2: 18446744073709551615 / UINT64_MAX /,
    / suit-common / 3: &lt;&lt; {
      / suit-components / 2: [
        [
          h'544545502D446576696365',           / "TEEP-Device" /
          h'5365637572654653',                 / "SecureFS" /
          h'8D82573A926D4754935332DC29997F74', / tc-uuid /
          h'7461'                              / "ta" /
        ]
      ],
      / suit-common-sequence / 4: &lt;&lt; [
        / suit-directive-override-parameters / 20, {
          / suit-parameter-vendor-identifier / 1: h'C0DDD5F15243566087DB4F5B0AA26C2F',
          / suit-parameter-class-identifier / 2: h'DB42F7093D8C55BAA8C5265FC5820F4E'
        },
        / suit-condition-vendor-identifier / 1, 15,
        / suit-condition-class-identifier / 2, 15
      ] &gt;&gt;
    } &gt;&gt;,
    / suit-install / 9: &lt;&lt; [
      / suit-directive-set-component-index: / 12, 0,
      / suit-directive-unlink: / 33, 0
    ] &gt;&gt;
  } &gt;&gt;
} )
</pre><a href="#appendix-E.4.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor-binary-representation-2">
<section id="appendix-E.4.2">
          <h4 id="name-cbor-binary-representation-3">
<a href="#name-cbor-binary-representation-3" class="section-name selfRef">CBOR Binary Representation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.4.2-1">
<pre>
D8 6B                                               # tag(107) / SUIT_Envelope_Tagged /
   A2                                               # map(2)
      02                                            # unsigned(2) / suit-authentication-wrapper /
      58 73                                         # bytes(115)
         82                                         # array(2)
            58 24                                   # bytes(36)
               82                                   # array(2)
                  2F                                # negative(15) / -16 = suit-cose-alg-sha256 /
                  58 20                             # bytes(32)
                     632454F19A9440A5B83493628A7EF8704C8A0205A62C34E425BAA34C71341F42
            58 4A                                   # bytes(74)
               D2                                   # tag(18) / COSE_Sign1_Tagged /
                  84                                # array(4)
                     43                             # bytes(3)
                        A1                          # map(1)
                           01                       # unsigned(1) / algorithm-id /
                           26                       # negative(6) / -7 = ES256 /
                     A0                             # map(0)
                     F6                             # primitive(22) / null /
                     58 40                          # bytes(64)
                        A32CDB7C1D089C27408CED3C79087220EB0D77F105BB5330912875F4D94AD108D7658C650463AEB7E1CCA5084F22B2F3993176E8B3529A3202ED735E4D39BBBF
      03                                            # unsigned(3) / suit-manifest: /
      58 73                                         # bytes(115)
         A4                                         # map(4)
            01                                      # unsigned(1) / suit-manifest-version: /
            01                                      # unsigned(1)
            02                                      # unsigned(2) / suit-manifest-sequence-number: /
            1B FFFFFFFFFFFFFFFF                     # unsigned(18446744073709551615)
            03                                      # unsigned(3) / suit-common: /
            58 5B                                   # bytes(91)
               A2                                   # map(2)
                  02                                # unsigned(2) / suit-components: /
                  81                                # array(1)
                     84                             # array(4)
                        4B                          # bytes(11)
                           544545502D446576696365   # "TEEP-Device"
                        48                          # bytes(8)
                           5365637572654653         # "SecureFS"
                        50                          # bytes(16)
                           8D82573A926D4754935332DC29997F74 # tc-uuid
                        42                          # bytes(2)
                           7461                     # "ta"
                  04                                # unsigned(4) / suit-common-sequence: /
                  58 2B                             # bytes(84)
                     86                             # array(6)
                        14                          # unsigned(20) / suit-directive-override-parameters: /
                        A2                          # map(2)
                           01                       # unsigned(1) / suit-parameter-vendor-identifier: /
                           50                       # bytes(16)
                              C0DDD5F15243566087DB4F5B0AA26C2F
                           02                       # unsigned(2) / suit-parameter-class-identifier: /
                           50                       # bytes(16)
                              DB42F7093D8C55BAA8C5265FC5820F4E
                        01                          # unsigned(1) / suit-condition-vendor-identifier: /
                        0F                          # unsigned(15)
                        02                          # unsigned(2) / suit-condition-class-identifier: /
                        0F                          # unsigned(15)
            09                                      # unsigned(9) / suit-install: /
            46                                      # bytes(6)
               84                                   # array(4)
                  0C                                # unsigned(12) / suit-directive-set-component-index: /
                  00                                # unsigned(0)
                  18 21                             # unsigned(33) / suit-directive-unlink: /
                  00                                # unsigned(0)
</pre><a href="#appendix-E.4.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor-binary-in-hex-3">
<section id="appendix-E.4.3">
          <h4 id="name-cbor-binary-in-hex-4">
<a href="#name-cbor-binary-in-hex-4" class="section-name selfRef">CBOR Binary in Hex</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-E.4.3-1">
<pre>
D86BA2025873825824822F5820632454F19A9440A5B83493628A7EF8704C
8A0205A62C34E425BAA34C71341F42584AD28443A10126A0F65840A32CDB
7C1D089C27408CED3C79087220EB0D77F105BB5330912875F4D94AD108D7
658C650463AEB7E1CCA5084F22B2F3993176E8B3529A3202ED735E4D39BB
BF035873A40101021BFFFFFFFFFFFFFFFF03585BA20281844B544545502D
446576696365485365637572654653508D82573A926D4754935332DC2999
7F7442746104582B8614A20150C0DDD5F15243566087DB4F5B0AA26C2F02
50DB42F7093D8C55BAA8C5265FC5820F4E010F020F0946840C00182100
</pre><a href="#appendix-E.4.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="suit-reports">
<section id="appendix-F">
      <h2 id="name-f-examples-of-suit-reports">
<a href="#name-f-examples-of-suit-reports" class="section-name selfRef">F. Examples of SUIT Reports</a>
      </h2>
<p id="appendix-F-1">This section shows some examples of SUIT reports.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<div id="f1-example-1-success">
<section id="appendix-F.1">
        <h3 id="name-f1-example-1-success">
<a href="#name-f1-example-1-success" class="section-name selfRef">F.1. Example 1: Success</a>
        </h3>
<p id="appendix-F.1-1">SUIT Reports have no records if no conditions have failed.
The URI in this example is the reference URI provided in the SUIT manifest.<a href="#appendix-F.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-F.1-2">
<pre>
{
  / suit-report-manifest-digest / 1:&lt;&lt;[
    / algorithm-id / -16 / "sha256" /,
    / digest-bytes / h'a7fd6593eac32eb4be578278e6540c5c'
                     h'09cfd7d4d234973054833b2b93030609'
  ]&gt;&gt;,
  / suit-report-manifest-uri / 2: "tam.teep.example/personalisation.suit",
  / suit-report-records / 4: []
}
</pre><a href="#appendix-F.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="f2-example-2-faiure">
<section id="appendix-F.2">
        <h3 id="name-f2-example-2-faiure">
<a href="#name-f2-example-2-faiure" class="section-name selfRef">F.2. Example 2: Faiure</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-F.2-1">
<pre>
{
  / suit-report-manifest-digest / 1:&lt;&lt;[
    / algorithm-id / -16 / "sha256" /,
    / digest-bytes / h'a7fd6593eac32eb4be578278e6540c5c09cfd7d4d234973054833b2b93030609'
  ]&gt;&gt;,
  / suit-report-manifest-uri / 2: "tam.teep.example/personalisation.suit",
  / suit-report-records / 4: [
    {
      / suit-record-manifest-id / 1:[],
      / suit-record-manifest-section / 2: 7 / dependency-resolution /,
      / suit-record-section-offset / 3: 66,
      / suit-record-dependency-index / 5: 0,
      / suit-record-failure-reason / 6: 404
    }
  ]
}
</pre><a href="#appendix-F.2-1" class="pilcrow">¶</a>
</div>
<p id="appendix-F.2-2">where the dependency-resolution refers to:<a href="#appendix-F.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-F.2-3">
<pre>
107({
  authentication-wrapper,
  / manifest / 3:&lt;&lt;{
    / manifest-version / 1:1,
    / manifest-sequence-number / 2:3,
    common,
    dependency-resolution,
    install,
    validate,
    run,
    text
  }&gt;&gt;,
})
</pre><a href="#appendix-F.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-F.2-4">and the suit-record-section-offset refers to:<a href="#appendix-F.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-F.2-5">
<pre>
&lt;&lt;[
  / directive-set-dependency-index / 13,0 ,
  / directive-set-parameters / 19,{
    / uri / 21:'tam.teep.example/'
               'edd94cd8-9d9c-4cc8-9216-b3ad5a2d5b8a.suit',
    } ,
  / directive-fetch / 21,2 ,
  / condition-image-match / 3,15
]&gt;&gt;,
</pre><a href="#appendix-F.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-G">
      <h2 id="name-authors-addresses-11">
<a href="#name-authors-addresses-11" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">Arm Ltd.</span></div>
<div dir="auto" class="left">
<span class="postal-code">6067</span> <span class="locality">Absam</span>
</div>
<div dir="auto" class="left"><span class="country-name">Austria</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@arm.com" class="email">hannes.tschofenig@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mingliang Pei</span></div>
<div dir="auto" class="left"><span class="org">Broadcom</span></div>
<div dir="auto" class="left"><span class="street-address">350 Ellis St</span></div>
<div dir="auto" class="left">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mingliang.pei@broadcom.com" class="email">mingliang.pei@broadcom.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Wheeler</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:davewhee@amazon.com" class="email">davewhee@amazon.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dave Thaler</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dthaler@microsoft.com" class="email">dthaler@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Akira Tsukamoto</span></div>
<div dir="auto" class="left"><span class="org">AIST</span></div>
<div dir="auto" class="left"><span class="country-name">Japan</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:akira.tsukamoto@aist.go.jp" class="email">akira.tsukamoto@aist.go.jp</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
