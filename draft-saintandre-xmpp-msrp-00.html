<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Interworking between the Extensible Messaging and Presence Protocol (XMPP) and the Message Session Relay Protocol (MSRP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Interworking between the Extensible Messaging and Presence Protocol (XMPP) and the Message Session Relay Protocol (MSRP)">
<meta name="keywords" content="Instant Messaging, SIP, MSRP, XMPP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">P. Saint-Andre</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">XMPP Standards Foundation</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">E. Gavita</td></tr>
<tr><td class="header">Expires: May 15, 2008</td><td class="header">N. Hossain</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Loreto</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Ericsson</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 12, 2007</td></tr>
</table></td></tr></table>
<h1><br />Interworking between the Extensible Messaging and Presence Protocol (XMPP) and the Message Session Relay Protocol (MSRP)<br />draft-saintandre-xmpp-msrp-00.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 15, 2008.</p>

<h3>Abstract</h3>

<p>This document defines a bidirectional protocol mapping for use by gateways that enable the exchange of messages in the context of a chat session between a system that implements the Extensible Messaging and Presence Protocol (XMPP) and a system that implements the Session Initiation Protocol (SIP), specifically for the latter session-mode messages that use the Message Session Relay Protocol (MSRP).
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Architectural Assumptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Connection Maintenance<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">1.4.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">1.5.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor7">2.</a>&nbsp;
Message Sessions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.2.</a>&nbsp;
XMPP Formal Chat Session to MSRP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.2.1.</a>&nbsp;
Initiating a Formal Session<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">2.2.2.</a>&nbsp;
Accepting a Formal Session<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">2.2.3.</a>&nbsp;
Terminating a Formal Session<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">2.2.4.</a>&nbsp;
Canceling the Negotiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">2.2.5.</a>&nbsp;
Rejecting a Formal Session<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">2.3.</a>&nbsp;
XMPP Informal Session to MSRP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">2.4.</a>&nbsp;
MSRP to XMPP formal session<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">2.4.1.</a>&nbsp;
Initiating a Session<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">2.4.2.</a>&nbsp;
Accepting a Session<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">2.4.3.</a>&nbsp;
Completing the Transaction<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">2.4.4.</a>&nbsp;
Send a Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">2.4.5.</a>&nbsp;
Terminating a Session<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">2.4.6.</a>&nbsp;
Cancel the transaction<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">2.4.7.</a>&nbsp;
Rejecting a transaction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">2.5.</a>&nbsp;
MSRP to an XMPP Informal Session<br />
<a href="#anchor25">3.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">4.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">4.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">4.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Overview</h3>

<p>Within the IETF, work on instant messaging has proceeded on two technologies that conform to the requirements defined in <a class='info' href='#IMP-REQS'>[IMP&#8209;REQS]<span> (</span><span class='info'>Day, M., Aggarwal, S., Mohr, G., and J. Vincent, &ldquo;Instant Messaging / Presence Protocol Requirements,&rdquo; February&nbsp;2000.</span><span>)</span></a>:
</p>
<p>
          </p>
<ul class="text">
<li>The Extensible Messaging and Presence Protocol <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a>, which consists of a formalization of the core XML streaming protocols developed originally by the Jabber open-source community; the relevant specifications are <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a> for the XML streaming layer and <a class='info' href='#XMPP-IM'>[XMPP&#8209;IM]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a> for basic presence and instant messaging extensions, including both single messages via XMPP &lt;message/&gt; stanzas of type "normal" and messaging sessions via XMPP &lt;message/&gt; stanzas of type "chat".
</li>
<li>Various extensions to the Session Initiation Protocol <a class='info' href='#SIP'>[SIP]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> for instant messaging and presence, as developed within the SIP for Instant Messaging and Presence Leveraging Extensions (SIMPLE) Working Group; the relevant specifications for instant messaging are <a class='info' href='#SIP-MSG'>[SIP&#8209;MSG]<span> (</span><span class='info'>Campbell, B., Rosenberg, J., Schulzrinne, H., Huitema, C., and D. Gurle, &ldquo;Session Initiation Protocol (SIP) Extension for Instant Messaging,&rdquo; December&nbsp;2002.</span><span>)</span></a> for single messages (also called "pager-mode" messaging) and <a class='info' href='#MSRP'>[MSRP]<span> (</span><span class='info'>Campbell, B., Mahy, R., and C. Jennings, &ldquo;The Message Session Relay Protocol (MSRP),&rdquo; September&nbsp;2007.</span><span>)</span></a> for messaging sessions (also called "session-mode" messaging).
</li>
</ul><p>
        
</p>
<p>Because both of these technologies have been implemented and deployed over the Internet, it is important to clearly define bidirectional mappings between them.  Work on such mappings began with <a class='info' href='#XMPP-SIMPLE'>[XMPP&#8209;SIMPLE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Basic Messaging and Presence Interworking between the Extensible Messaging  and Presence Protocol (XMPP) and Session Initiation Protocol (SIP) for Instant Messaging and Presence Leveraging Extensions (SIMPLE),&rdquo; August&nbsp;2007.</span><span>)</span></a>, which defines mappings for addresses, presence, and single messages.  This document extends that work by defining a mapping for one-to-one chat or messaging sessions.
</p>
<p>Both XMPP and SIP/SIMPLE technologies enable end users to send "instant messages" to other end users.  The term "instant message" usually refers to messages sent between two end-users for delivery in close to real time (rather than messages that are stored and forwarded to the intended recipient upon request).  Generally, there are three kinds of instant messages:
</p>
<p>
          </p>
<ol class="text">
<li>Single messages, which are sent from the sender to the recipient outside the context of any one-to-one chat session or multi-user text conference.  The message is immediately delivered and not stored in an inbox.  In XMPP a single message is a &lt;message/&gt; stanza of type "normal" as specified in <a class='info' href='#XMPP-IM'>[XMPP&#8209;IM]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a>.  In SIP/SIMPLE a single message is sent via the MESSAGE method as specified in <a class='info' href='#MSRP'>[MSRP]<span> (</span><span class='info'>Campbell, B., Mahy, R., and C. Jennings, &ldquo;The Message Session Relay Protocol (MSRP),&rdquo; September&nbsp;2007.</span><span>)</span></a>.
</li>
<li>One-to-one chat messages, which are sent from the sender to the recipient (i.e., one-to-one) in the context of a "chat session" between the two entities.  In XMPP a chat message is a &lt;message/&gt; stanza of type "chat".  In SIP/SIMPLE a chat message is sent using an MSRP session.
</li>
<li>Groupchat messages, which are sent from a sender to multiple recipients (i.e., 2 or more) in the context of a "multi-user chat session" or "text conference".  In XMPP a groupchat message is a &lt;message/&gt; stanza of type "groupchat" that is reflected from the sender to multiple recipients by a multi-user chat service as defined in <a class='info' href='#XEP-0045'>[XEP&#8209;0045]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Multi-User Chat,&rdquo; April&nbsp;2007.</span><span>)</span></a>.  In SIP/SIMPLE a groupchat message is  reflected from the sender to multiple recipients by a conference server that uses MSRP to handle groupchat sessions.
</li>
</ol><p>
        
</p>
<p>This document only covers the scenario #2 above for converting XMPP messages of type "chat" to their corresponding SIP INVITE - MSRP message types on the SIP/SIMPLE side.
</p>
<p>As in <a class='info' href='#XMPP-SIMPLE'>[XMPP&#8209;SIMPLE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Basic Messaging and Presence Interworking between the Extensible Messaging  and Presence Protocol (XMPP) and Session Initiation Protocol (SIP) for Instant Messaging and Presence Leveraging Extensions (SIMPLE),&rdquo; August&nbsp;2007.</span><span>)</span></a>, the approach taken here is to directly map syntax and semantics from one protocol to another.  One-to-one chat sessions using XMPP message stanzas of type "chat" are specified in <a class='info' href='#XMPP-IM'>[XMPP&#8209;IM]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a>, and a method for formally negotiating such a session is specified in <a class='info' href='#XEP-0155'>[XEP&#8209;0155]<span> (</span><span class='info'>Paterson, I. and P. Saint-Andre, &ldquo;Stanza Session Negotiation,&rdquo; March&nbsp;2007.</span><span>)</span></a>.  One-to-one chat sessions using the SIP MESSAGE method, the SIP INVITE method, and the Message Session Relay Protocol (MSRP) are specified in <a class='info' href='#SIP-MSG'>[SIP&#8209;MSG]<span> (</span><span class='info'>Campbell, B., Rosenberg, J., Schulzrinne, H., Huitema, C., and D. Gurle, &ldquo;Session Initiation Protocol (SIP) Extension for Instant Messaging,&rdquo; December&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#MSRP'>[MSRP]<span> (</span><span class='info'>Campbell, B., Mahy, R., and C. Jennings, &ldquo;The Message Session Relay Protocol (MSRP),&rdquo; September&nbsp;2007.</span><span>)</span></a>.  In particular, this document defines a mapping between XMPP chat sessions (as specified in <a class='info' href='#XMPP-IM'>[XMPP&#8209;IM]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a> and <a class='info' href='#XEP-0155'>[XEP&#8209;0155]<span> (</span><span class='info'>Paterson, I. and P. Saint-Andre, &ldquo;Stanza Session Negotiation,&rdquo; March&nbsp;2007.</span><span>)</span></a>) and the Message Session Relay Protocol (as specified in <a class='info' href='#MSRP'>[MSRP]<span> (</span><span class='info'>Campbell, B., Mahy, R., and C. Jennings, &ldquo;The Message Session Relay Protocol (MSRP),&rdquo; September&nbsp;2007.</span><span>)</span></a>).
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Architectural Assumptions</h3>

<p>In this section we remind the reader of the Architectural Assumptions already presented in <a class='info' href='#XMPP-SIMPLE'>[XMPP&#8209;SIMPLE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Basic Messaging and Presence Interworking between the Extensible Messaging  and Presence Protocol (XMPP) and Session Initiation Protocol (SIP) for Instant Messaging and Presence Leveraging Extensions (SIMPLE),&rdquo; August&nbsp;2007.</span><span>)</span></a>, with some small changes necessary to support the MSRP scenario.
</p>
<p>XMPP IM technologies consist of three element types: Clients, Servers and Gateways.  Each client can source and sink messages.  Each Server relays messages between Clients and from/to Gateways and handles presence information.  The Gateway provides transformations between XMPP and other IM protocols.
</p>
<p>SIP/SIMPLE technologies employ four element types: Clients, Proxies, Presence Servers and Gateways.  Each Client can source and sink messages.  A Proxy server relays messages between Clients and/or Gateways.  SIMPLE defines separable Presence Servers to maintain presence about Client users.  Gateways provide transformations between SIMPLE and other IM protocols.
</p>
<p>Protocol mapping between XMPP and SIP SIMPLE may occur in a number of different entities, depending on the architecture of messaging deployments.  For instance, protocol translation could occur within a multi-protocol server, within a multi-protocol client, or within a gateway that acts as a dedicated protocol translator.  This document assumes that the protocol translation will occur within a gateway.  Specifically, we assume that the protocol translation will occur within an "XMPP-to-MSRP gateway" that translates XMPP syntax and semantics on behalf of an XMPP service when communicating with SIP SIMPLE services and/or within an "MSRP-to-XMPP gateway" that translates SIP syntax and semantics on behalf of a SIP SIMPLE service when communicating with XMPP services.
</p>
<p>We further assume that protocol translation will occur within a gateway in the source domain, so that messages and presence information generated by the user of an XMPP service will be translated by a gateway within the trust domain of that XMPP service, and messages and presence information generated by the user of an MSRP service will be translated by a gateway within the trusted domain of that MSRP service.
</p>
<p>An architectural diagram for a typical gateway deployment is shown below, where the entities have the following significance and the "#" character is used to show the boundary of a trusted domain:
</p>
<p>
          </p>
<ul class="text">
<li>juliet@example.com -- an XMPP user.
</li>
<li>example.com -- a XMPP service.
</li>
<li>x2m.example.com -- an XMPP-to-MSRP gateway.
</li>
<li>romeo@example.net -- an MSRP user.
</li>
<li>example.net -- an MSRP service.
</li>
<li>m2x.example.net -- an MSRP-to-XMPP gateway.
</li>
</ul><p>
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
#####################################################################
#                               #                                   #
#         +-- m2x.example.net---#------------- example.com          #
#         |                     #              |      |             #
#  example.net------------------#--- x2m.example.com  |             #
#       |                       #                     |             #
#       |                       #                     |             #
#  romeo@example.net            #              juliet@example.com   #
#                               #                                   #
#####################################################################
</pre></div>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Connection Maintenance</h3>

<p>XMPP makes use of long-lived TCP connections.  If mobility affecting Layer 3 causes a dropped connection, the connection must be re-established.  If mobility preserves the IP address, the TCP connection will be dropped.  Any TLS session and SASL associations must be re-established if the TCP connection is dropped.  XMPP binds directly to TCP in the core specification, so the TCP session must remain open for the entire duration of the chat/conversation.  The XMPP Standards Foundation does define protocol extensions enabling transport of XMPP traffic over HTTP (refer to <a class='info' href='#XEP-0124'>[XEP&#8209;0124]<span> (</span><span class='info'>Paterson, I., Smith, D., and P. Saint-Andre, &ldquo;Bidirectional-streams Over Synchronous HTTP (BOSH),&rdquo; February&nbsp;2007.</span><span>)</span></a> and <a class='info' href='#XEP-0206'>[XEP&#8209;0206]<span> (</span><span class='info'>Paterson, I., &ldquo;XMPP Over BOSH,&rdquo; June&nbsp;2007.</span><span>)</span></a>), so that individual messages are carried using HTTP and are more robust in environments such as mobile networks, allowing for better recovery if a TCP session is broken.
</p>
<p>SIMPLE is similar when using MSRP.  The Message Session Relay Protocol <a class='info' href='#MSRP'>[MSRP]<span> (</span><span class='info'>Campbell, B., Mahy, R., and C. Jennings, &ldquo;The Message Session Relay Protocol (MSRP),&rdquo; September&nbsp;2007.</span><span>)</span></a> is a protocol for transmitting instant messages (IM) in the context of a session.  The protocol specification describes how the session can be negotiated and established with an offer or answer <a class='info' href='#OFFER'>[OFFER]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;An Offer/Answer Model with Session Description Protocol (SDP),&rdquo; June&nbsp;2002.</span><span>)</span></a> using the Session Description Protocol <a class='info' href='#SDP'>[SDP]<span> (</span><span class='info'>Handley, M., Jacobson, V., and C. Perkins, &ldquo;SDP: Session Description Protocol,&rdquo; July&nbsp;2006.</span><span>)</span></a>.  In SIMPLE, this exchange is carried using SIP as the signaling protocol.  After the TCP connection is established, if it fails for any reason, then an MSRP endpoint MAY choose to re-create such session using a new SDP exchange in a SIP re-INVITE.  SIMPLE also uses MESSAGE request for transporting instant messaging outside the context of a session.  The MESSAGE request is sent inside the signaling path without establishing any dedicate connection.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Terminology</h3>

<p>This document inherits terminology from <a class='info' href='#MSRP'>[MSRP]<span> (</span><span class='info'>Campbell, B., Mahy, R., and C. Jennings, &ldquo;The Message Session Relay Protocol (MSRP),&rdquo; September&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#SIP'>[SIP]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>, <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a>, and <a class='info' href='#XMPP-IM'>[XMPP&#8209;IM]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a>.
</p>
<p>The capitalized key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#TERMS'>[TERMS]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5"></a><h3>1.5.&nbsp;
Acknowledgements</h3>

<p>Some text in this document was borrowed from <a class='info' href='#XMPP-SIMPLE'>[XMPP&#8209;SIMPLE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Basic Messaging and Presence Interworking between the Extensible Messaging  and Presence Protocol (XMPP) and Session Initiation Protocol (SIP) for Instant Messaging and Presence Leveraging Extensions (SIMPLE),&rdquo; August&nbsp;2007.</span><span>)</span></a> and from <a class='info' href='#XEP-0155'>[XEP&#8209;0155]<span> (</span><span class='info'>Paterson, I. and P. Saint-Andre, &ldquo;Stanza Session Negotiation,&rdquo; March&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Message Sessions</h3>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Overview</h3>

<p>The traditional model for one-to-one chat "session" in Jabber/XMPP is for a user to simply send a message to a contact with a thread ID, but without any formal negotiation of session parameter.
</p>
<p>This informal approach to session initiation in XMPP can be mapped both to SIP pager-mode messaging using the SIP MESSAGE method (as documented in <a class='info' href='#XMPP-SIMPLE'>[XMPP&#8209;SIMPLE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Basic Messaging and Presence Interworking between the Extensible Messaging  and Presence Protocol (XMPP) and Session Initiation Protocol (SIP) for Instant Messaging and Presence Leveraging Extensions (SIMPLE),&rdquo; August&nbsp;2007.</span><span>)</span></a>) and to a MSRP chat session.  How the Gateway chooses to map the XMPP chat session in the SIP side is a matter of the implementation.
</p>
<p>However, in XMPP it also possibile to formally request a chat session and negotiate its parameters (e.g., security, privacy, message logging) before beginning the session.  The protocol for doing so is defined in <a class='info' href='#XEP-0155'>[XEP&#8209;0155]<span> (</span><span class='info'>Paterson, I. and P. Saint-Andre, &ldquo;Stanza Session Negotiation,&rdquo; March&nbsp;2007.</span><span>)</span></a>.  In this case, the XMPP chat session should be translated into a MSRP session.
</p>
<p>This document covers the mapping of both informal and formally-negotiated XMPP chat session into a MSRP session.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
XMPP Formal Chat Session to MSRP</h3>

<p>XMPP Protocol offers two ways an XMPP user can initiate a 1-1 chat: the first approach doesn't establish a session (this method is referred to the "informal session" approach); the second approach instead involves explicit negotiation of a session (this method is referred to the "formal session" approach).
</p>
<p>This section describes how to map an XMPP "formal session" to an MSRP session.
</p>
<p>The XMPP formal session is based on the protocol described in <a class='info' href='#XEP-0155'>[XEP&#8209;0155]<span> (</span><span class='info'>Paterson, I. and P. Saint-Andre, &ldquo;Stanza Session Negotiation,&rdquo; March&nbsp;2007.</span><span>)</span></a>, which enable the initiation, renegotiation, and termination of a format chat session on the XMPP side.  This approach maps to the semantic of the SIP INVITE and BYE methods.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
XMPP User                   X2M GW                    SIP User
    |                          |                          |
    |(F1) (XMPP) Stanza session request                   |
    |-------------------------&gt;|                          |
    |                          |(F2) (SIP) INVITE         |
    |                          |-------------------------&gt;|
    |                          |(F3) (SIP) 200 OK         |
    |                          |&lt;-------------------------|
    |(F4) (XMPP) Stanza session acceptance                |
    |&lt;-------------------------|                          |
    |                          |(F5) (SIP) ACK            |
    |                          |-------------------------&gt;|
    |(F6) (XMPP) Stanza session completion                |
    |-------------------------&gt;|                          |
    |                          |(F7) (MSRP) SEND          |
    |                          |-------------------------&gt;|
    |(F8) (XMPP) Stanza session termination               |
    |-------------------------&gt;|                          |
    |                          |(F9) (SIP) BYE            |
    |                          |-------------------------&gt;|
    |                          |(F10) (SIP) 200 OK        |
    |                          |&lt;-------------------------|
    |(F11) (XMPP) Stanza acknoledgment                    |
    |             session termination                     |
    |&lt;-------------------------|                          |
</pre></div>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
Initiating a Formal Session</h3>

<p>When the XMPP user ("Juliet") wants to initiate a negotiated session with a SIP user ("Romeo"), she sends a &lt;message/> stanza to Romeo containing a &lt;feature/&gt; child qualified by the 'http://jabber.org/protocol/feature-neg' namespace.  The &lt;message/> stanza must not contain a &lt;body/&lt; child (as specified in <a class='info' href='#XMPP-IM'>[XMPP&#8209;IM]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a>), since thhat child element is used for human-readable text.  The &lt;message/&gt; stanza type should be "normal".  The stanza must contain a &lt;thread/&gt; element for tracking purposes (where the newly-generated ThreadID is unique to the proposed session).  The encapsulated data form shall contain a FORM_TYPE field whose type is "hidden" and whose value is "urn:xmpp:ssn"; it must also contain a boolean field named "accept".
</p>
<p>The XMPP user may request a session with a specific resource of the contact.  However in this document the resource identifier will be ignored and discarded for cross-system interworking.
</p>
<p>Example: (F1) Juliet starts a formal session:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
        from='juliet@example.com'
        to='romeo@example.net'&gt;
 &lt;thread&gt;711609sa&lt;/thread&gt;
 &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
  &lt;x xmlns='jabber:x:data' type='form'&gt;
   &lt;title&gt;Open chat with Juliet?&lt;/title&gt;
   &lt;field var='FORM_TYPE' type='hidden'&gt;
     &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
   &lt;/field&gt;
   &lt;field label='Accept this session?' type='form' var='accept'&gt;
     &lt;value&gt;true&lt;/value&gt;
     &lt;required/&gt;
   &lt;/field&gt;
   &lt;field label='Primary written language of the chat'
     type='list-single' var='language'&gt;
      &lt;value&gt;en&lt;/value&gt;
      &lt;option label='English'&gt;&lt;value&gt;en&lt;/value&gt;&lt;/option&gt;
      &lt;option label='Italiano'&gt;&lt;value&gt;it&lt;/value&gt;&lt;/option&gt;
   &lt;/field&gt;
  &lt;/x&gt;
&lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>Upon receiving such a session request, the XMPP server to which Juliet has authenticated attempts to deliver the request to a local user or attempts to route the request to the foreign domain that services the hostname in the 'to' attribute.  Naturally, in this document we assume that the hostname in the 'to' attribute is an IM-aware SIP service hosted by a separate server.
</p>
<p>As specified in <a class='info' href='#XMPP-IM'>[XMPP&#8209;IM]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a>, the XMPP server needs to determine the identity of the foreign domain, which it does by performing one or more <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a> lookups.  For message stanzas, the order of lookups recommended by <a class='info' href='#XMPP-IM'>[XMPP&#8209;IM]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a> is to first try the "_xmpp-server" service as specified in <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a> and to then try the "_im" service as specified in <a class='info' href='#IMP-SRV'>[IMP&#8209;SRV]<span> (</span><span class='info'>Peterson, J., &ldquo;Address Resolution for Instant Messaging and Presence,&rdquo; August&nbsp;2004.</span><span>)</span></a>.  Here we assume that the first lookup will fail but that the second lookup will succeed and return a resolution "_im._simple.example.net.", since we have already assumed that the example.net hostname is running a SIP instant messaging service.  (Note: The XMPP server may have previously determined that the foreign domain is a SIMPLE server, in which case it would not need to perform the SRV lookups; the caching of such information is a matter of implementation and local service policy, and is therefore out of scope for this document.)
</p>
<p>Once the XMPP server has determined that the foreign domain is serviced by a SIMPLE server, it must determine how to proceed.  We here assume that the XMPP server contains or has available to it an XMPP-MSRP gateway.  The XMPP server would then deliver the message stanza to the XMPP-MSRP gateway.
</p>
<p>The XMPP-MSRP gateway is then responsible for translating the XMPP session into an MSRP session.
</p>
<p>Example: (F2) Juliet starts a formal session (SIP transformation):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
INVITE sip:romeo@example.net SIP/2.0
To: &lt;sip:romeo@example.net&gt;
From: &lt;sip:juliet@example.com&gt;;tag=786
Subject: Open chat with Juliet?
Call-ID: 711609sa
Content-Type: application/sdp

c=IN IP4 x2m.example.com
m=message 7654 TCP/MSRP *
a=accept-types:text/plain
a=lang:en
a=lang:it
a=path:msrp://x2m.example.com:7654/jshA7weztas;tcp
</pre></div>
<p>There is no direct mapping for the MSRP URIs.  In fact MSRP URIs identify a session of instant message at a particular device; they are ephemeral and have not meaning outside the scope of that session.  The authority component of the MSRP URI MUST contain the XMPP-MSRP gateway hostname or numeric IP address and an explicit port number.
</p>
<p>Native XMPP supports text (i.e., UTF-8) only, so the "accept-types" attribute that follows an MSRP media line MUST indicate text/plain as the only media-type that is acceptable to the endpoint.
</p>
<p>As specified in <a class='info' href='#XMPP-SIMPLE'>[XMPP&#8209;SIMPLE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Basic Messaging and Presence Interworking between the Extensible Messaging  and Presence Protocol (XMPP) and Session Initiation Protocol (SIP) for Instant Messaging and Presence Leveraging Extensions (SIMPLE),&rdquo; August&nbsp;2007.</span><span>)</span></a>, the mapping of XMPP syntax elements to SIP and SDP syntax elements SHOULD be as shown in the following table.  (Mappings for elements not mentioned are undefined).
</p>
<p>Table 1: Message syntax mapping from XMPP to SIP/SDP
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-----------------------------+-----------------------------+
|  XMPP Element or Attribute  |  SIP Header or SDP Contents |
+-----------------------------+-----------------------------+
|  &lt;thread/&gt;                  |  Call-ID                    |
|  from                       |  From                       |
|  to                         |  To                         |
|  &lt;title/&gt;                   |  Subject                    |
|  xml:lang                   |  a=lang:&lt;language tag&gt;      |
|  -                          |  a=accept-types:text/plain  |
+-----------------------------+-----------------------------+
</pre></div>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Accepting a Formal Session</h3>

<p>The SIP user agent Romeo receiving the SIP invitation, containing an offered session description that includes a session of MSRP, accepts the invitation and includes an answer session description that acknowledges the choice of media.
</p>
<p>Example: (F3) Romeo accepts the request
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SIP/2.0 200 OK
To: &lt;sip:romeo@example.net&gt;;tag=087js
From: &lt;sip:juliet@example.com&gt;;tag=786
Call-ID: 711609sa
Content-Type: application/sdp

c=IN IP4 example.net
m=message 12763 TCP/MSRP *
a=accept-types:text/plain
a=lang:it
a=path:msrp://example.net:12763/kjhd37s2s20w2a;tcp
</pre></div>
<p>Upon receiving such a response, the MSRP-XMPP gateway SHOULD remember that this is a response to a SIP transaction related to an XMPP-MSRP translation.  The gateway is responsible for translating the response into an XMPP message stanza and deliver it from the SIP user back to the XMPP user deliver.
</p>
<p>The MSRP-XMPP gateway MUST include in the response translation values for all the fields that the XMPP request indicated are required.
</p>
<p>Example: (F4) Romeo accepts the request (XMPP translation)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='romeo@example.net'
         to='juliet@example.com'&gt;
  &lt;thread&gt;711609sa&lt;/thread&gt;
  &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
    &lt;x xmlns='jabber:x:data' type='submit'&gt;
      &lt;field var='FORM_TYPE'&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='accept'&gt;&lt;value&gt;true&lt;/value&gt;&lt;/field&gt;
      &lt;field var='language'&gt;&lt;value&gt;it&lt;/value&gt;&lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>The gateway MUST also send a SIP ACK to the SIP user.
</p>
<p>Example: (F5) The GW sends the ACK to Romeos UA:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
ACK sip:romeo@example.com SIP/2.0
To: &lt;sip:romeo@example.net&gt;;tag=087js
From: &lt;sip:juliet@example.com&gt;;tag=786
Call-ID: 711609sa
</pre></div>
<p>If Romeo accepted the session Juliet MUST either complete or cancel the stanza session negotiation.  The user's client SHOULD verify that the selected values of the fields are acceptable before completing the stanza session negotiation -- and confirming that the session is open -- by replying with the form 'type' attribute set to 'result'.  The form MUST contain the FORM_TYPE field and the "accept" field set to "1" or "true".  The user MAY include other content "e.g., a &lt;body/&gt; element in the confirmation stanza:
</p>
<p>Example: (F6) Juliet completes negotiation, confirms session is open and send a message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='juliet@example.com'
         to='romeo@example.net'&gt;
  &lt;thread&gt;711609sa&lt;/thread&gt;
  &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
    &lt;x xmlns='jabber:x:data' type='result'&gt;
      &lt;field var='FORM_TYPE'&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='accept'&gt;&lt;value&gt;true&lt;/value&gt;&lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>Upon receiving such stanza completing the session negotiation, the XMPP server MUST not send any confirmation to the SIP side.
</p>
<p>The XMPP-MSRP gateway must create a transaction identifier and use this and the SEND method to create an MSRP request start line.
</p>
<p>The XMPP 'id' attribute is not required in the protocol and there is not a way to enforce its use for messages.  It is RECOMMENDED to add it as a negotiable item in the XEP-0155, however it may not be present within the &lt;message/> stanza, in this case the XMPP-MSRP MUST generate a new unique Message-ID.
</p>
<p>Note: If the XMPP user has not explicitly requested message receipts during the negotiation, it is RECOMMENDED that the XMPP-MSRP inserts a Failure-Report header field value of "no" during the creation of a SEND request.  The XMPP user can include the requested for message receipts using the Message Receipts XMPP protocol extension <a class='info' href='#XEP-0184'>[XEP&#8209;0184]<span> (</span><span class='info'>Saint-Andre, P. and J. Hildebrand, &ldquo;Message Receipts,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
</p>
<p>As specified in <a class='info' href='#XMPP-SIMPLE'>[XMPP&#8209;SIMPLE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Basic Messaging and Presence Interworking between the Extensible Messaging  and Presence Protocol (XMPP) and Session Initiation Protocol (SIP) for Instant Messaging and Presence Leveraging Extensions (SIMPLE),&rdquo; August&nbsp;2007.</span><span>)</span></a>, the mapping of XMPP syntax elements to MSRP syntax elements SHOULD be as shown in the following table.  (Mappings for elements not mentioned are undefined).
</p>
<p>Table 2: Message syntax mapping from XMPP Message to MSRP
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-----------------------------+-----------------------------+
|  XMPP Element or Attribute  |  MSRP Header                |
+-----------------------------+-----------------------------+
|  to                         |  To-Path                    |
|  from                       |  From-Path                  |
|  &lt;body/&gt;                    |  body of the SEND request   |
|  -                          |  Content-Type: text/plain   |
|  id                         |  Message-ID                 |
+-----------------------------+-----------------------------+
</pre></div>
<p>Upon receiving the SEND request, if the request either contains a Failure-Report header field value of "yes" or does not contain a Failure-Report header at all, Alice's client MUST immediately generate and send a response.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
MSRP d93kswow 200 OK
To-Path: msrp://x2m.example.com:7654/jshA7weztas;tcp
From-Path: msrp://example.net:12763/kjhd37s2s20w2a;tcp
-------d93kswow$
</pre></div>
<p>The XML character data of an XMPP message is not limited by the protocol, but is sometimes limited in deployment.  However messages sent using MSRP can be delivered in several SEND requests, so when the XMPP-MSRP gateway receives a message longer then 2048, it is STRONGLY RECOMMENDED it delivers this message using as few chunks (at least 2048 octets long) as possible.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.3"></a><h3>2.2.3.&nbsp;
Terminating a Formal Session</h3>

<p>If Juliet decides to terminate the negotiated chat session, her client sends a &lt;message/&gt; stanza to Romeo containing a data form of type "submit".  The &lt;message/&gt; stanza MUST contain a &lt;thread/&gt; element with the same XML character data as the original initiation request.  The data form  containing a boolean field named "terminate" set to a value of "1" or "true".
</p>
<p>Example: (F8) Juliet terminates the chat session
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='juliet@example.com'
         to='romeo@example.net'&gt;
  &lt;thread&gt;711609sa&lt;/thread&gt;
  &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
    &lt;x xmlns='jabber:x:data' type='submit'&gt;
      &lt;field var='FORM_TYPE'&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='terminate'&gt;&lt;value&gt;1&lt;/value&gt;&lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>Upon receiving such stanza terminating the chat session, the gateway terminates the SIP session by sending a SIP BYE to tear down the MSRP session with Romeo's client.  Romeo's SIP client then responds with a 200 OK.
</p>
<p>Example: (F9) Juliet terminates the chat session (SIP translation)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
BYE romeo@example.com sip: SIP/2.0
Max-Forwards: 70
From: &lt;sip:juliet@example.com&gt;;tag=786
To: &lt;sip:romeo@example.net&gt;;tag=087js
Call-ID: 711609sa
Cseq: 1 BYE
Content-Length: 0
</pre></div>
<p>Example: (F10) Romeo terminates the chat session
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SIP/2.0 200 OK
From: &lt;sip:juliet@example.com&gt;;tag=786
To: &lt;sip:romeo@example.net&gt;; tag=087js
Call-ID: 711609sa
CSeq: 1 BYE
Content-Length: 0
</pre></div>
<p>Upon receiving the 200 OK, the GW acknowledges the termination of the chat session on the XMPP side by sending a &lt;message/> containing a data form of type "result", and the value of the "terminate" field set to "1" or "true".  The client must mirror the &lt;thread/> value it received.
</p>
<p>Example: (F11) Romeo terminates the chat session (XMPP translation)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='romeo@example.net'
         to=='juliet@example.com'&gt;
 &lt;thread&gt;711609sa&lt;/thread&gt;
 &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
   &lt;x xmlns='jabber:x:data' type='result'&gt;
     &lt;field var='FORM_TYPE'&gt;
       &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
     &lt;/field&gt;
     &lt;field var='terminate'&gt;&lt;value&gt;1&lt;/value&gt;&lt;/field&gt;
     &lt;/x&gt;
 &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.4"></a><h3>2.2.4.&nbsp;
Canceling the Negotiation</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
XMPP User                   X2M GW                    SIP User
    |                          |                          |
    |(F1) (XMPP) Stanza session request                   |
    |-------------------------&gt;|                          |
    |                          |(F2) (SIP) INVITE         |
    |                          |-------------------------&gt;|
    |                          |(F3) (SIP) 200 OK         |
    |                          |&lt;-------------------------|
    |(F4) (XMPP) Stanza session acceptance                |
    |&lt;-------------------------|                          |
    |                          |(F5) (SIP) ACK            |
    |                          |-------------------------&gt;|
    |(F6) (XMPP) Stanza session canceling                 |
    |-------------------------&gt;|                          |
    |                          |(F7) (SIP) BYE            |
    |                          |-------------------------&gt;|
    |                          |(F8) (SIP) 200 OK         |
    |                          |&lt;-------------------------|
</pre></div>
<p>If Romeo accepted the session, but Juliet decides to cancel the stanza session negotiation, the client must reply with a data form containing the FORM_TYPE field and the "accept" field set to "0" or "false":
</p>
<p>Example: (F6) User cancels stanza session negotiation
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='juliet@example.com'
         to='romeo@example.net'&gt;
 &lt;thread&gt;711609sa&lt;/thread&gt;
 &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
   &lt;x xmlns='jabber:x:data' type='result'&gt;
     &lt;field var='FORM_TYPE'&gt;
       &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
     &lt;/field&gt;
     &lt;field var='accept'&gt;&lt;value&gt;0&lt;/value&gt;&lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>Upon receiving such stanza canceling the session negotiation, the XMPP-MSRP Gateway MUST send a SIP BYE.  Once the XMPP-MSRP receives the 200 OK, the internal session data is removed and the session is officially canceled also in the gateway.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.5"></a><h3>2.2.5.&nbsp;
Rejecting a Formal Session</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
XMPP User                   X2M GW                    SIP User
    |                          |                          |
    |(F1) (XMPP) Stanza session request                   |
    |-------------------------&gt;|                          |
    |                          |(F2) (SIP) INVITE         |
    |                          |-------------------------&gt;|
    |                          |(F3) (SIP) 4xx/6xx        |
    |                          |&lt;-------------------------|
    |(F4) (XMPP) Stanza session decline                   |
    |&lt;-------------------------|                          |
</pre></div>
<p>A common scenario occurs when the SIP UA is currently not willing or able to accept a formal session.  The SIP UA declining an offer contained in an INVITE SHOULD return a 4xx or a 6xx response.  Such response SHOULD include a Warning header field value explaining why the offer was rejected.
</p>
<p>Upon receiving the error response for the SIP INVITE, the XMPP-MSRP GW will send back a "Session Reject" message back to the XMPP Client.  The data form MUST contain the FORM_TYPE field and the "accept" field set to "0" or "false".  It is reccomended that the form does not contain any other field even if the request indicated they are required.  The client MAY include a reason in the &lt;body/> child of the &lt;message/> stanza.
</p>
<p>The content of the Warning header field present in the SIP response SHOULD be copied in the &lt;body/> child of the &lt;message/> stanza.  If the Warning header it is not present then the descriptive phrase of the SIP response can be used.
</p>
<p>Example: (F4) User declines offer and specifies reason
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='romeo@example.net'
         to='juliet@example.com'&gt;
  &lt;thread&gt;711609sa&lt;/thread&gt;
  &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
    &lt;x xmlns='jabber:x:data' type='submit'&gt;
      &lt;field var='FORM_TYPE'&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='accept'&gt;&lt;value&gt;0&lt;/value&gt;&lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
XMPP Informal Session to MSRP</h3>

<p>The "informal session" approach is to simply send someone a &lt;message type='chat'/> without start any session negotiation before (as described in <a class='info' href='#XMPP-IM'>[XMPP&#8209;IM]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a>).  The XMPP "informal session" approach maps very well into a SIP MESSAGE request, as described in <a class='info' href='#XMPP-SIMPLE'>[XMPP&#8209;SIMPLE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Basic Messaging and Presence Interworking between the Extensible Messaging  and Presence Protocol (XMPP) and Session Initiation Protocol (SIP) for Instant Messaging and Presence Leveraging Extensions (SIMPLE),&rdquo; August&nbsp;2007.</span><span>)</span></a>.  Although the mapping to a SIP Message is straightforward, it is also possible to map an informal session to an MSRP session.  The mapping will be provided in a future version of this specification.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
MSRP to XMPP formal session</h3>

<p>Unlike the XMPP protocol, the MSRP protocol only offers one way to initiate a Chat session, that is typically initiated using the Session Description Protocol <a class='info' href='#SDP'>[SDP]<span> (</span><span class='info'>Handley, M., Jacobson, V., and C. Perkins, &ldquo;SDP: Session Description Protocol,&rdquo; July&nbsp;2006.</span><span>)</span></a> via the SIP offer/answer mechanism <a class='info' href='#OFFER'>[OFFER]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;An Offer/Answer Model with Session Description Protocol (SDP),&rdquo; June&nbsp;2002.</span><span>)</span></a>.
</p>
<p>This section will describe how to map a MSRP Chat session to either a formal or informal XMPP session.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SIP User                  M2X GW                    XMPP User
   |                         |                          |
   |(F1)(SIP) INVITE         |                          |
   |------------------------&gt;|                          |
   |                         |(F2)(XMPP) Stanza session request
   |                         |-------------------------&gt;|
   |                         |(F3)(XMPP) Stanza session acceptance
   |                         |&lt;-------------------------|
   |(F4)(SIP) 200 OK         |                          |
   |&lt;------------------------|                          |
   |(F5)(SIP) ACK            |                          |
   |------------------------&gt;|                          |
   |                         |(F6)(XMPP) Stanza session completion
   |                         |-------------------------&gt;|
   |(F7)(MSRP) SEND          |                          |
   |------------------------&gt;|                          |
   |                         |(F8)(XMPP) Stanza message |
   |                         |-------------------------&gt;|
   |(F9)(SIP) BYE            |                          |
   |------------------------&gt;|                          |
   |                         |(F10)(XMPP) Stanza session termination
   |                         |-------------------------&gt;|
   |                         |(F11)(XMPP) Stanza acknowledgment
   |                         |            session termination
   |                         |&lt;-------------------------|
   |(F12)(SIP) 200 OK        |                          |
   |&lt;------------------------|                          |
</pre></div>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.1"></a><h3>2.4.1.&nbsp;
Initiating a Session</h3>

<p>When Romeo wants to start an MSRP message session with Juliet, he first has to start the SIP session by sending out a SIP INVITE request containing an offered session description that includes an MSRP media line accompanied by a mandatory "path" attribute and corresponding URIs.  The MSRP media line is also accompanied by an "accept-types" attribute used to specify the only media-types acceptable for Romeo (i.e., text/plain).
</p>
<p>In addition to plain text messages, MSRP is able to carry arbitrary (binary) Multipurpose Internet Mail Extensions <a class='info' href='#MIME'>[MIME]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a> compliant content, such as images or video clips.
</p>
<p>Example: (F1) SIP user starts the session:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
INVITE sip:juliet@example.com SIP/2.0
To: &lt;sip:juliet@example.com&gt;
From: &lt;sip:romeo@example.net&gt;;tag=576
Subject: Open chat with Romeo?
Call-ID: 742507no
Content-Type: application/sdp

c=IN IP4 example.net
m=message 7313 TCP/MSRP *
a=accept-types:text/plain
a=lang:en
a=lang:it
a=path:msrp://example.net:7313/ansp71weztas;tcp
</pre></div>
<p>Upon receiving the INVITE, the MSRP-XMPP gateway needs to determine the identity of the foreign domain, which it does by performing one or more DNS SRV lookups <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>.  The gateway SHOULD resolve the address present in the To header of the INVITE to an im, then follow the rules in <a class='info' href='#IMP-SRV'>[IMP&#8209;SRV]<span> (</span><span class='info'>Peterson, J., &ldquo;Address Resolution for Instant Messaging and Presence,&rdquo; August&nbsp;2004.</span><span>)</span></a> regarding the "_im" SRV service for the target domain contained in the To header.  If SRV address resolution fails for the "_im" service, the gateway MAY attempt a lookup for the "_xmpp-server" service as specified in <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a> or MAY return an error to the sender (i.e.  502 Bad Gateway).
</p>
<p>If SVR address resolution succeeds, the gateway is responsible for translating the request into an XMPP message stanza to initiate a negotiated session from the SIP user to the XMPP user.
</p>
<p>Example: (F2) SIP user starts the session (XMPP transformation):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
        from='romeo@example.net'
        to='juliet@example.com'&gt;
  &lt;thread&gt;742507no&lt;/thread&gt;
  &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
    &lt;x xmlns='jabber:x:data' type='form'&gt;
      &lt;title&gt;Open chat with Romeo?&lt;/title&gt;
      &lt;field var='FORM_TYPE' type='hidden'&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field label='Accept this session?' type='form' var='accept'&gt;
        &lt;value&gt;true&lt;/value&gt;
        &lt;required/&gt;
      &lt;/field&gt;
      &lt;field label='Primary written language of the chat'
             type='list-single'
             var='language'&gt;
        &lt;value&gt;en&lt;/value&gt;
        &lt;option label='English'&gt;&lt;value&gt;en&lt;/value&gt;&lt;/option&gt;
        &lt;option label='Italiano'&gt;&lt;value&gt;it&lt;/value&gt;&lt;/option&gt;
      &lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>The mapping of SIP and SDP syntax elements to XMPP syntax elements SHOULD be as shown in the following table.  (Mappings for elements not mentioned in the foregoing table are undefined).
</p>
<p>Table 3: Message syntax mapping from SIP to XMPP
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-----------------------------+-----------------------------+
|  SIP Header or SDP Contents |  XMPP Element or Attribute  |
+-----------------------------+-----------------------------+
|  Call-ID                    |  &lt;thread/&gt;                  |
|  From                       |  from                       |
|  To                         |  to                         |
|  Subject                    |  &lt;title/&gt;                   |
|  accept-types               |  -                          |
|  a=lang                     |  xml:lang                   |
|  To                         |  to                         |
+-----------------------------+-----------------------------+
</pre></div>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.2"></a><h3>2.4.2.&nbsp;
Accepting a Session</h3>

<p>If the request is accepted then Juliets client MUST include all the fields that were marked as required in the request message.
</p>
<p>In the example below, we assume that Juliet accepts the session and specifies that she prefers to speak Italian with Romeo.
</p>
<p>Example: (F3) Juliet accepts session and specifies parameters:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='juliet@example.com'
         to='romeo@example.net'&gt;
  &lt;thread&gt;742507no&lt;/thread&gt;
  &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
    &lt;x xmlns='jabber:x:data' type='submit'&gt;
      &lt;field var='FORM_TYPE'&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='accept'&gt;&lt;value&gt;true&lt;/value&gt;&lt;/field&gt;
      &lt;field var='language'&gt;&lt;value&gt;it&lt;/value&gt;&lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>Upon receiving such a response, the MSRP-XMPP gateway SHOULD remember that this is a response to a stanza related to an MSRP-XMPP translation.  The gateway is responsible for translating the response into a SIP response and deliver it from the XMPP user back to the SIP user.
</p>
<p>Example: (F4) Juliet accepts session (SIP translation)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SIP/2.0 200 OK
To: &lt;sip:juliet@example.com&gt;;tag=534
From: &lt;sip:romeo@example.net&gt;;tag=576
Call-ID: 742507no
Content-Type: application/sdp

c=IN IP4 m2x.example.net
m=message 8763 TCP/MSRP *
a=accept-types:text/plain
a=lang:it
a=path:msrp://m2x.example.net:8763/lkjh37s2s20w2a;tcp
</pre></div>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.3"></a><h3>2.4.3.&nbsp;
Completing the Transaction</h3>

<p>In this case, the 200 OK is routed back and is received by Romeo UA.  Finally, Romeos client sends an acknowledgment message, ACK, to Juliets client to confirm the reception of the final response (200 OK).
</p>
<p>Example: (F5) Romeo sends the ACK:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
ACK sip:juliet@example.com SIP/2.0
To: &lt;sip:juliet@example.com&gt;;tag=534
From: &lt;sip:romeo@example.net&gt;;tag=576
Call-ID: 742507no
</pre></div>
<p>Upon receiving the ACK, the MSRP-XMPP gateway SHOULD remember this is an acknowledgment to an XMPP formal session.  The gateway is responsible for translating the acknowledgment into a confirmation stanza, without inserting other content (e.g.  a &lt;body/&gt; element can not be inserted).
</p>
<p>Example: (F6) Romeo sends the ACK (XMPP translation)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='romeo@example.net'
         to='juliet@example.com'&gt;
  &lt;thread&gt;742507no&lt;/thread&gt;
  &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
    &lt;x xmlns='jabber:x:data' type='result'&gt;
      &lt;field var='FORM_TYPE'&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='accept'&gt;&lt;value&gt;true&lt;/value&gt;&lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.4"></a><h3>2.4.4.&nbsp;
Send a Message</h3>

<p>When Romeo wants to send a message, he creates an MSRP SEND request that contains message.
</p>
<p>Example: (F7) Romeo send a message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
MSRP ad49kswow SEND
To-Path: msrp://m2x.example.net:8763/lkjh37s2s20w2a;tcp
From-Path: msrp://example.net:7313/ansp71weztas;tcp
Message-ID: 44921zaqwsx
Byte-Range: 1-32/32
Failure-Report: no
Content-Type: text/plain

I forgot what I wanted to say!
-------ad49kswow$
</pre></div>
<p>Upon receiving the MSRP SEND request, the MSRP-XMPP gateway SHOULD remember that the message is for an XMPP user.  The gateway is responsible for translating the MSRP SEND request in an XMPP message stanza.
</p>
<p>Example: (F8) Romeo sends a message (XMPP translation).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='romeo@example.net'
         to='juliet@example.com'&gt;
  &lt;thread&gt;742507no&lt;/thread&gt;
  &lt;body&gt;I forgot what I wanted to say!&lt;/body&gt;
&lt;/message&gt;
</pre></div>
<p>The mapping of MSRP syntax elements to XMPP syntax elements SHOULD be as shown in the following table.  (Mappings for elements not mentioned are undefined).
</p>
<p>Table 4: Message syntax mapping from MSRP Message to XMPP
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-----------------------------+-----------------------------+
| MSRP Header                 |  XMPP Element or Attribute  |
+-----------------------------+-----------------------------+
|  To-Path                    |  to                         |
|  From-Path                  |  from                       |
|  body of the SEND request   |  &lt;body/&gt;                    |
|  Content-Type: text/plain   |  -                          |
|  Message-ID                 |  id                         |
+-----------------------------+-----------------------------+
</pre></div>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.5"></a><h3>2.4.5.&nbsp;
Terminating a Session</h3>

<p>When Romeo wants to terminate the Session, he is required to send a SIP BYE request.
</p>
<p>Example: (F9) Romeo terminates the session
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
BYE juliet@example.com sip: SIP/2.0
Max-Forwards: 70
From: &lt;sip:romeo@example.net&gt;;tag=576
To: &lt;sip:juliet@example.com&gt;;tag=534
Call-ID: 742507no
Cseq: 1 BYE
Content-Length: 0
</pre></div>
<p>Upon receiving the SIP BYE request, the GW SHOULD translate the request to a &lt;message/> stanza containing a data form of type "submit".  The &lt;message/&gt; element MUST contain a &lt;thread/> element with the same XML character data as the original initiation request.  The data form containing a boolean field named "terminate" should be set to a value of "1" or "true".
</p>
<p>Example: (F10) Romeo terminates the session (XMPP translation)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='romeo@example.net'
         to='juliet@example.com'&gt;
  &lt;thread&gt;742507no&lt;/thread&gt;
  &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
    &lt;x xmlns='jabber:x:data' type='submit'&gt;
      &lt;field var='FORM_TYPE'&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='terminate'&gt;&lt;value&gt;1&lt;/value&gt;&lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>Juliet explicitly acknowledges the termination of the chat session on the XMPP side by sending a &lt;message/> containing a data form of type "result", and the value of the "terminate" field set to "1" or "true".  The client MUST mirror the &lt;thread/> value it received.
</p>
<p>Example: (F11) Juliet acknowledges the termination of the session.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='juliet@example.com'
         to=='romeo@example.net'&gt;
 &lt;thread&gt;742507no&lt;/thread&gt;
 &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
   &lt;x xmlns='jabber:x:data' type='result'&gt;
     &lt;field var='FORM_TYPE'&gt;
       &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
     &lt;/field&gt;
     &lt;field var='terminate'&gt;&lt;value&gt;1&lt;/value&gt;&lt;/field&gt;
     &lt;/x&gt;
 &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>Upon receiving the acknowledgment message, the GW SHOULD translate it to a SIP answer 200 OK.
</p>
<p>Example: (F12) Juliet acknowledges the termination of the session (SIP translation)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SIP/2.0 200 OK
From: &lt;sip:romeo@example.net&gt;;tag=576
To: &lt;sip:juliet@example.com&gt;;tag=534
Call-ID: 742507no
CSeq: 1 BYE
</pre></div>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.6"></a><h3>2.4.6.&nbsp;
Cancel the transaction</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SIP User                   M2X GW                    XMPP User
   |                        |                          |
   |(F1)(SIP) INVITE        |                          |
   |-----------------------&gt;|                          |
   |                        |(F2)(XMPP) Stanza session request
   |                        |-------------------------&gt;|
   |(F3)(SIP) CANCEL        |                          |
   |-----------------------&gt;|                          |
   |                        |(F4)(XMPP) Stanza session termination
   |                        |-------------------------&gt;|
   |                        |(F5)(XMPP) Stanza acknowledgment
   |                        |            session termination
   |                        |&lt;-------------------------|
   |(F6)(SIP) 200 OK        |                          |
   |&lt;-----------------------|                          |
</pre></div>
<p>A common scenario occurs when the SIP user issues an invitation to set up a Chat session with an XMPP user and immediately after the SIP invitation is sent, the SIP user decides to cancel it.  The XMPP-MSRP GW will receive the CANCEL request and using the the Call-ID, To, From and CSeq (sequence number only) header field values as a guide, will issue an XMPP Stanza session termination request to the XMPP user to cancel the XMPP formal session (assuming that it was already set up).  Once the XMPP-MSRP GW receives an ACK stanza message for the session termination, the XMPP-MSRP GW will respond with a status of 200 (OK) back to the SIP user.  It is important to note that if the SIP session transaction does not exist, the XMPP-MSRP GW will return a status of 481 (Transaction Does Not Exist) back to the SIP User.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.7"></a><h3>2.4.7.&nbsp;
Rejecting a transaction</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SIP User                      M2X GW                    XMPP User
    |                           |                          |
    |(F1)(SIP) INVITE           |                          |
    |--------------------------&gt;|                          |
    |                           |(F2)(XMPP) Stanza session request
    |                           |-------------------------&gt;|
    |                           |(F3)(XMPP) Stanza session decline
    |                           |&lt;-------------------------|
    |(F4)(SIP) 4xx/6xx          |                          |
    |&lt;--------------------------|                          |
</pre></div>
<p>Another common scenario occurs when the XMPP UA is currently not willing or able to accept a formal session request.  The XMPP UA SHOULD decline the invitation.  The data form MUST contain the FORM_TYPE field and the "accept" field set to "0" or "false".  It is RECOMMENDED that the form does not contain any other fields even if the request indicated they are required.  The client MAY include a reason in the &lt;body/> child of the &lt;message/> stanza:
</p>
<p>Example: (F3) User declines offer and specifies reason
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message type='normal'
         from='juliet@example.com'
         to='romeo@example.net'&gt;
  &lt;thread&gt;742507no&lt;/thread&gt;
  &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
    &lt;x xmlns='jabber:x:data' type='submit'&gt;
      &lt;field var='FORM_TYPE'&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='accept'&gt;&lt;value&gt;0&lt;/value&gt;&lt;/field&gt;
    &lt;/x&gt;
  &lt;/feature&gt;
&lt;/message&gt;
</pre></div>
<p>Upon receiving the declined response for the XMPP formal session request, the XMPP-MSRP GW SHOULD return a 4xx or a 6xx SIP response back to the SIP client.  Any content that is contained in the &lt;body/> child of the &lt;message/>.  stanza SHOULD be copied into the response Warning header field which explains why the offer was rejected.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
MSRP to an XMPP Informal Session</h3>

<p>To follow.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Security Considerations</h3>

<p>To follow.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>4.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="IMP-SRV">[IMP-SRV]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc3861">Address Resolution for Instant Messaging and Presence</a>,&rdquo; RFC&nbsp;3861, August&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3861.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MSRP">[MSRP]</a></td>
<td class="author-text">Campbell, B., Mahy, R., and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4975">The Message Session Relay Protocol (MSRP)</a>,&rdquo; RFC&nbsp;4975, September&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4975.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OFFER">[OFFER]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3264">An Offer/Answer Model with Session Description Protocol (SDP)</a>,&rdquo; RFC&nbsp;3264, June&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3264.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIP">[SIP]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TERMS">[TERMS]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0155">[XEP-0155]</a></td>
<td class="author-text"><a href="mailto:ian.paterson@clientside.co.uk">Paterson, I.</a> and <a href="mailto:stpeter@jabber.org">P. Saint-Andre</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0155.html">Stanza Session Negotiation</a>,&rdquo; XSF XEP&nbsp;0155, March&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMPP">[XMPP]</a></td>
<td class="author-text"><a href="mailto:stpeter@jabber.org">Saint-Andre, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3920">Extensible Messaging and Presence Protocol (XMPP): Core</a>,&rdquo; RFC&nbsp;3920, October&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3920.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3920.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3920.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XMPP-IM">[XMPP-IM]</a></td>
<td class="author-text"><a href="mailto:stpeter@jabber.org">Saint-Andre, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3921">Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence</a>,&rdquo; RFC&nbsp;3921, October&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3921.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3921.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3921.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XMPP-SIMPLE">[XMPP-SIMPLE]</a></td>
<td class="author-text">Saint-Andre, P., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-saintandre-xmpp-simple-10.txt">Basic Messaging and Presence Interworking between the Extensible Messaging  and Presence Protocol (XMPP) and Session Initiation Protocol (SIP) for Instant Messaging and Presence Leveraging Extensions (SIMPLE)</a>,&rdquo; draft-saintandre-xmpp-simple-10 (work in progress), August&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-saintandre-xmpp-simple-10.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>4.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DNS-SRV">[DNS-SRV]</a></td>
<td class="author-text"><a href="mailto:arnt@troll.no">Gulbrandsen, A.</a>, Vixie, P., and <a href="mailto:levone@microsoft.com">L. Esibov</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>,&rdquo; RFC&nbsp;2782, February&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMP-REQS">[IMP-REQS]</a></td>
<td class="author-text"><a href="mailto:mday@alum.mit.edu">Day, M.</a>, <a href="mailto:sonuag@microsoft.com">Aggarwal, S.</a>, <a href="mailto:gojomo@usa.net">Mohr, G.</a>, and <a href="mailto:jesse@intonet.com">J. Vincent</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2779">Instant Messaging / Presence Protocol Requirements</a>,&rdquo; RFC&nbsp;2779, February&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2779.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MIME">[MIME]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</a>,&rdquo; RFC&nbsp;2045, November&nbsp;1996 (<a href="ftp://ftp.isi.edu/in-notes/rfc2045.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SDP">[SDP]</a></td>
<td class="author-text">Handley, M., Jacobson, V., and C. Perkins, &ldquo;<a href="http://tools.ietf.org/html/rfc4566">SDP: Session Description Protocol</a>,&rdquo; RFC&nbsp;4566, July&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4566.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIP-MSG">[SIP-MSG]</a></td>
<td class="author-text">Campbell, B., Rosenberg, J., Schulzrinne, H., Huitema, C., and D. Gurle, &ldquo;<a href="http://tools.ietf.org/html/rfc3428">Session Initiation Protocol (SIP) Extension for Instant Messaging</a>,&rdquo; RFC&nbsp;3428, December&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3428.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0045">[XEP-0045]</a></td>
<td class="author-text"><a href="mailto:stpeter@jabber.org">Saint-Andre, P.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0045.html">Multi-User Chat</a>,&rdquo; XSF XEP&nbsp;0045, April&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0124">[XEP-0124]</a></td>
<td class="author-text"><a href="mailto:ian.paterson@clientside.co.uk">Paterson, I.</a>, <a href="mailto:dizzyd@jabber.org">Smith, D.</a>, and <a href="mailto:stpeter@jabber.org">P. Saint-Andre</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0124.html">Bidirectional-streams Over Synchronous HTTP (BOSH)</a>,&rdquo; XSF XEP&nbsp;0124, February&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0184">[XEP-0184]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a> and <a href="mailto:jhildebrand@jabber.com">J. Hildebrand</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0184.html">Message Receipts</a>,&rdquo; XSF XEP&nbsp;0184, September&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0206">[XEP-0206]</a></td>
<td class="author-text"><a href="mailto:ian.paterson@clientside.co.uk">Paterson, I.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0206.html">XMPP Over BOSH</a>,&rdquo; XSF XEP&nbsp;0206, June&nbsp;2007.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Peter Saint-Andre</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">XMPP Standards Foundation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P.O. Box 1641</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Denver, CO  80201</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:stpeter@jabber.org">stpeter@jabber.org</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="https://stpeter.im/">https://stpeter.im/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eddy Gavita</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ericsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Decarie Boulevard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Town of Mount Royal, Quebec  </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:eddy.gavita@ericsson.com">eddy.gavita@ericsson.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nazin Hossain</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ericsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Decarie Boulevard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Town of Mount Royal, Quebec</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Nazin.Hossain@ericsson.com">Nazin.Hossain@ericsson.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salvatore Loreto</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ericsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hirsalantie 11</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jorvas  02420</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Salvatore.Loreto@ericsson.com">Salvatore.Loreto@ericsson.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
