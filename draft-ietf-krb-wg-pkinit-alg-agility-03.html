<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>PK-INIT Cryptographic Algorithm Agility</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="PK-INIT Cryptographic Algorithm Agility">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">NETWORK WORKING GROUP</td><td class="header">L. Astrand</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Stockholm University</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc4556'>4556</a> (if&nbsp;approved)</td><td class="header">L. Zhu</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Microsoft Corporation</td></tr>
<tr><td class="header">Expires: January 2, 2008</td><td class="header">July 2007</td></tr>
</table></td></tr></table>
<h1><br />PK-INIT Cryptographic Algorithm Agility<br /> draft-ietf-krb-wg-pkinit-alg-agility-03</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 2, 2008.</p>

<h3>Abstract</h3>

<p>The PK-INIT defined in RFC 4556 is examined and updated to remove
   protocol structures tied to specific cryptographic algorithms.  The affinity to SHA
   as the check-sum algorithm in the authentication request is analyzed.
   The PK-INIT key derivation function is made negotiable, the digest
   algorithms for signing the pre-authentication data and the client's
   X.509 certificates are made discoverable.
</p>
<p>These changes provide protection preemptively against vulnerabilities
   discovered in the future against any specific cryptographic algorithm, and
   allow incremental deployment of newer algorithms.  
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#anchor1">2.</a>&nbsp;
Requirements Notation<br />
<a href="#pachk">3.</a>&nbsp;
paChecksum Agility<br />
<a href="#anchor2">4.</a>&nbsp;
CMS Digest Algorithm Agility<br />
<a href="#anchor3">5.</a>&nbsp;
X.509 Certificate Signer Algorithm Agility<br />
<a href="#kdf">6.</a>&nbsp;
KDF agility<br />
<a href="#securityconsideration">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor4">8.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor5">9.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#asnmod">Appendix&nbsp;A.</a>&nbsp;
PKINIT ASN.1 Module<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>In August 2004, Xiaoyun Wang's research group reported MD4 <a class='info' href='#RFC1320'>[RFC1320]<span> (</span><span class='info'>Rivest, R., &ldquo;The MD4 Message-Digest Algorithm,&rdquo; April&nbsp;1992.</span><span>)</span></a> collisions
   generated using hand calculation [WANG04] alongside attacks on later hash function designs in the MD4, MD5 <a class='info' href='#RFC1321'>[RFC1321]<span> (</span><span class='info'>Rivest, R., &ldquo;The MD5 Message-Digest Algorithm,&rdquo; April&nbsp;1992.</span><span>)</span></a> and SHA <a class='info' href='#RFC4634'>[RFC4634]<span> (</span><span class='info'>Eastlake, D. and T. Hansen, &ldquo;US Secure Hash Algorithms (SHA and HMAC-SHA),&rdquo; July&nbsp;2006.</span><span>)</span></a> family.  
   Implementations based on Wang's algorithm can find collisions in real time.  
   These discoveries challenged the security
   for protocols relying on the collision resistance properties
   of these hashes, for example one can forge a digital signature when SHA-1 <a class='info' href='#RFC4634'>[RFC4634]<span> (</span><span class='info'>Eastlake, D. and T. Hansen, &ldquo;US Secure Hash Algorithms (SHA and HMAC-SHA),&rdquo; July&nbsp;2006.</span><span>)</span></a> is
   the digest algorithm.  A more far reaching side effect of these
   recent events, however, is that it is now generally considered flawed or
   distasteful at least if protocols are designed to use only specific
   algorithms.
</p>
<p>The Internet Engineer Task Force (IETF) called for actions to update existing protocols to provide
   crypto algorithm agility in order to untie protocols with specific
   algorithms.  The idea is that if the protocol has crypto algorithm
   agility, and when a new vulnerability specific to an algorithm is
   discovered, this algorithm can be disabled via protocol negotiation
   quickly, thus we can avoid the wait for the multi-year
   standardization and implementation efforts to update the protocols. In additon, crypto agility allows deployment
    of new crypto algorithms to be done incrementally, rather than requring a
    "flag day" on which the change must be deployed everywhere at the
    same time in order to maintain interoperability

</p>
<p>This document is to update PK-INIT <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>  to provide crypto algorithm
   agility.  Several protocol structures used in the <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> protocol
   are either tied to SHA-1, or require the algorithms not negotiated but rather based on
   local policy.  The following concerns have been addressed: 
</p>
<p> </p>
<ul class="text">
<li> The checksum algorithm in the
   authentication request is hardwired to use SHA-1 <a class='info' href='#RFC4634'>[RFC4634]<span> (</span><span class='info'>Eastlake, D. and T. Hansen, &ldquo;US Secure Hash Algorithms (SHA and HMAC-SHA),&rdquo; July&nbsp;2006.</span><span>)</span></a>.<br />
<br />

</li>
<li> The acceptable
   digest algorithms for signing the authentication data are not
   discoverable.<br />
<br />

</li>
<li>The key derivation function in Section 3.2.3 is
   hardwired to use SHA-1.<br />
<br />
 
</li>
<li>The acceptable digest algorithms for
   signing the client X.509 certificates are not discoverable.
</li>
</ul><p>
   
</p>
<p>To accomplish these, new key derivation functions (KDFs) identifiable by object identifiers are defined.
The PKINIT client provides a list of KDFs in the request and 
   the KDC picks one in the response, thus a mutually-supported KDF is negotiated.
</p>
<p>Furthermore, structures are defined to allow the client discover the Cryptographic Message Syntax (CMS) <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a>
   digest algorithms supported by the KDC for signing the pre-authentication
   data and signing the client X.509 certificate.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Requirements Notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="pachk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
paChecksum Agility</h3>

<p>The paChecksum defined in Section 3.2.1 of <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> provides a cryptographic
   bindings between the client's pre-authentication data and the corresponding Kerberos request body.  This also prevents the KDC body
   from being tempered with.  SHA-1 is the only allowed checksum
   algorithm defined in <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>.  This facility relies the collision
   resistance properties of the SHA-1 checksum <a class='info' href='#RFC4634'>[RFC4634]<span> (</span><span class='info'>Eastlake, D. and T. Hansen, &ldquo;US Secure Hash Algorithms (SHA and HMAC-SHA),&rdquo; July&nbsp;2006.</span><span>)</span></a>.  
</p>
<p>When the reply key delivery mechanism is based on public key encryption as described in Section 3.2.3. of <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>,
   the asChecksum in the KDC reply provides the binding between the pre-authentication and the ticket request and response messages, and
   integrity protection for the unauthenticated clear text in these messages.  However, if the reply key delivery mechanism is
   based on the Diffie-Hellman key agreement as described in Section 3.2.3.1 of <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>, the security provided by using SHA-1
   in the paChecksum is weak.  In this case, the
   new KDF selected by the KDC as described in <a class='info' href='#kdf'>Section&nbsp;6<span> (</span><span class='info'>KDF agility</span><span>)</span></a> provides the
   cryptographic binding and integrity protection.
   
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
CMS Digest Algorithm Agility</h3>

<p> When the KDC_ERR_DIGEST_IN_SIGNED_DATA_NOT_ACCEPTED error is returned
   as described In section 3.2.2 of <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>, implementations comforming to this
   specification can OPTIONALLY send back a list of supported CMS types
   signifying the digest algorithms supported by the KDC, in the decreasing
   preference order.  This is accomplished by including a
   TD_CMS_DATA_DIGEST_ALGORITHMS typed data element in the error data.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     TD_CMS_DATA_DIGEST_ALGORITHMS      111
</pre></div>
<p>
   The corresponding data for the TD_CMS_DATA_DIGEST_ALGORITHMS contains the ASN.1 Distinguished Encoding Rules (DER) [X680] [X690]

   encoded TD-CMS-DIGEST-ALGORITHMS-DATA structure defined as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     TD-CMS-DIGEST-ALGORITHMS-DATA ::= SEQUENCE OF
         AlgorithmIdentifier
            -- Contains the list of CMS algorithm [RFC3852]
            -- identifiers that identify the digest algorithms
            -- acceptable by the KDC for signing CMS data in
            -- the order of decreasing preference.
</pre></div>
<p>The algorithm identifiers in the TD-CMS-DIGEST-ALGORITHMS identifiy   
   digest algorithms supported by the KDC.
</p>
<p>This information sent by the KDC via TD_CMS_DATA_DIGEST_ALGORITHMS can
   facilitate trouble-shooting when none of the digest algorithms supported by the client is
   supported by the KDC.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
X.509 Certificate Signer Algorithm Agility</h3>

<p>When the client's X.509 certificate is rejected and the
   KDC_ERR_DIGEST_IN_SIGNED_DATA_NOT_ACCEPTED error is returned as
   described in section 3.2.2 of <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>, conforming implementations can OPTIONALLY send a list of digest algorithms acceptable by the KDC for use by the CA in signing the client's X.509
   certificate, in the decreasing preference order.  This is accomplished by including a TD_CERT_DIGEST_ALGORITHMS
   typed data element in the error data.  The corresponding data contains the ASN.1 DER encoding of the structure
   TD-CERT-DIGEST-ALGORITHMS-DATA defined as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     TD_CERT_DIGEST_ALGORITHMS          112

     TD-CERT-DIGEST-ALGORITHMS-DATA ::= SEQUENCE {
            allowedAlgorithms [0] SEQUENCE OF AlgorithmIdentifier,
                -- Contains the list of CMS algorithm [RFC3852]
                -- identifiers that identify the digest algorithms
                -- that are used by the CA to sign the client's
                -- X.509 certificate and acceptable by the KDC in
                -- the process of validating the client's X.509
                -- certificate, in the order of decreasing
                -- preference.
            rejectedAlgorithm [1] AlgorithmIdentifier OPTIONAL,
                -- This identifies the digest algorithm that was
                -- used to sign the client's X.509 certificate and
                -- has been rejected by the KDC in the process of
                -- validating the client's X.509 certificate
                -- [RFC3280].
            ...
     }
</pre></div>
<p>The KDC fills in allowedAlgorithm field with the list of algorithm
   <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a> identifiers that identify digest algorithms that are 
   used by the CA to sign the client's X.509 certificate and acceptable by the KDC in the 
   process of validating the client's X.509 certificate, in the order of decreasing preference.
The rejectedAlgorithm field identifies the signing algorithm for use in signing the client's X.509 certificate that has been rejected by the KDC in the process of validating the client's certificate <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>.
</p>
<a name="kdf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
KDF agility</h3>

<p>Based on <a class='info' href='#RFC3766'>[RFC3766]<span> (</span><span class='info'>Orman, H. and P. Hoffman, &ldquo;Determining Strengths For Public Keys Used For Exchanging Symmetric Keys,&rdquo; April&nbsp;2004.</span><span>)</span></a> and [X9.42], 
   Section 3.2.3.1 of <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> defines a Key Derivation Function (KDF)
   that derives a Kerberos protocol key based on the secret value generated by the Diffie-Hellman key exchange.  
   This KDF requires the use of SHA-1 <a class='info' href='#RFC4634'>[RFC4634]<span> (</span><span class='info'>Eastlake, D. and T. Hansen, &ldquo;US Secure Hash Algorithms (SHA and HMAC-SHA),&rdquo; July&nbsp;2006.</span><span>)</span></a>.
</p>
<p>New KDFs defined in this document based on [SP80056A] can be used in conjunction with any hash functions. A new KDF is identified
   by an object identifier. The following KDF object identifiers are defined:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   id-pkinit-kdf OBJECT IDENTIFIER            ::= { id-pkinit 6}
        -- PKINIT KDFs
   id-pkinit-kdf-ah-sha1 OBJECT IDENTIFIER   ::= { id-pkinit-kdf 1}
        -- SP800 56A ASN.1 structured hash based KDF using SHA-1
   id-pkinit-kdf-ah-sha256 OBJECT IDENTIFIER ::= { id-pkinit-kdf 2 }
       -- SP800 56A ASN.1 structured hash based KDF using SHA-256
   id-pkinit-kdf-ah-sha512 OBJECT IDENTIFIER ::= { id-pkinit-kdf 3 }
       -- SP800 56A ASN.1 structured hash based KDF using SHA-512
</pre></div>
<p>Where id-pkinit is defined in <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>. The id-pkinit-kdf-ah-sha1 KDF is the
   ASN.1 structured hash based KDF (HKDF) [SP80056A] that uses SHA-1 <a class='info' href='#RFC4634'>[RFC4634]<span> (</span><span class='info'>Eastlake, D. and T. Hansen, &ldquo;US Secure Hash Algorithms (SHA and HMAC-SHA),&rdquo; July&nbsp;2006.</span><span>)</span></a> as the hash function. Similarly
   id-pkinit-kdf-ah-sha256 and id-pkinit-kdf-ah-sha512 are the ASN.1 structured HKDF using
   SHA-256 <a class='info' href='#RFC4634'>[RFC4634]<span> (</span><span class='info'>Eastlake, D. and T. Hansen, &ldquo;US Secure Hash Algorithms (SHA and HMAC-SHA),&rdquo; July&nbsp;2006.</span><span>)</span></a> and SHA-512 <a class='info' href='#RFC4634'>[RFC4634]<span> (</span><span class='info'>Eastlake, D. and T. Hansen, &ldquo;US Secure Hash Algorithms (SHA and HMAC-SHA),&rdquo; July&nbsp;2006.</span><span>)</span></a> respectively. 
   The common input parameters for these KDFs are provided as follows:
</p>
<p>
       </p>
<ul class="text">
<li>The secret value is the shared secret value generated by the Diffie-Hellman exchange. The
           Diffie-Hellman shared value is first padded with leading zeros such that the
      size of the secret value in octets is the same as that of the
      modulus, then represented as a string of octets in big-endian
      order. <br />
<br />

</li>
<li>The key data length is K. K is the key-generation seed length in bits <a class='info' href='#RFC3961'>[RFC3961]<span> (</span><span class='info'>Raeburn, K., &ldquo;Encryption and Checksum Specifications for Kerberos 5,&rdquo; February&nbsp;2005.</span><span>)</span></a> for the Authentication Service (AS) reply
      key. The enctype of the AS reply key is selected according to <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a>.<br />
<br />

</li>
<li>The algorithm identifier input parameter is the identifier of the respective KDF. For example, this is id-pkinit-kdf-ah-sha1 if
           the KDF is the [SP80056A] ASN.1 structured HKDF using SHA-1 as the hash. <br />
<br />

</li>
<li>The initiator identifier is an OCTET STRING that contains the ASN.1 DER encoding of the KRB5PrincipalName 

           <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> that identifies the client as specified in the AS-REQ <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a> in the request.<br />
<br />

</li>
<li>The recipient identifier is an OCTET STRING that contains the ASN.1 DER encoding of the KRB5PrincipalName 
           <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> that identifies the TGS as specified in the AS-REQ <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a> in the request.<br />
<br />

</li>
<li>The supplemental private information is absent (not used).<br />
<br />

</li>
<li> The supplemental public information is an OCTET STRING that contains the ASN.1 DER encoding of the structure PkinitSuppPubInfo as defined
           later in this section. <br />
<br />
 
</li>
<li>The hash length is 128 for id-pkinit-kdf-ah-sha1, 256 for id-pkinit-kdf-ah-sha256, and 512 for id-pkinit-kdf-ah-sha512.<br />
<br />

</li>
<li>The maximum hash input length is 2^64 in bits.
</li>
</ul><p>
   
</p>
<p>The structure PkinitSuppPubInfo is defined as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     PkinitSuppPubInfo ::= SEQUENCE {
            enctype           [0] Int32,
                -- The enctype of the AS reply key.
            as-REQ            [1] OCTET STRING,
                -- This contains the AS-REQ in the request.
            pk-as-rep         [2] OCTET STRING,
                -- Contains the DER encoding of the type
                -- PA-PK-AS-REP [RFC4556] in the KDC reply.
            ticket            [3] Ticket,
                -- This is the ticket in the KDC reply.
            ...
     }
</pre></div>
<p> The PkinitSuppPubInfo structure contains mutually-known public information specific 
 to the authentication exchange. The enctype field is the enctype of the AS reply key as selected according to <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a>. 
   The as-REQ field contains the DER encoding of the type AS-REQ
   [RFC4120] in the request sent from the client to the KDC.  Note that the as-REQ field
   does not include the wrapping 4 octet length field when TCP is used.  The pk-as-rep field contains
   the DER encoding of the type PA-PK-AS-REP <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> in the KDC reply. The ticket field is filled
   with the ticket in the KDC reply. The PkinitSuppPubInfo
     provides a cryptographic
   bindings between the pre-authentication data and the
   corresponding ticket request and response, thus addresses the concerns described in <a class='info' href='#pachk'>Section&nbsp;3<span> (</span><span class='info'>paChecksum Agility</span><span>)</span></a>. 
</p>
<p>The above ASN.1 structured [SP80056A] HKDF produces a bit string of length K in bits as the keying material, and then the AS reply key
 is the output of random-to-key() <a class='info' href='#RFC3961'>[RFC3961]<span> (</span><span class='info'>Raeburn, K., &ldquo;Encryption and Checksum Specifications for Kerberos 5,&rdquo; February&nbsp;2005.</span><span>)</span></a> using that returned keying material as the input.
</p>
<p>The KDF is negotiated between the client and the KDC. The client sends an unordered set of supported KDFs in the request, and the KDC picks one from the set in the reply. 

</p>
<p>
To acomplish this, the AuthPack structure in <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> is extended as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     AuthPack ::= SEQUENCE {
            pkAuthenticator   [0] PKAuthenticator,
            clientPublicValue [1] SubjectPublicKeyInfo OPTIONAL,
            supportedCMSTypes [2] SEQUENCE OF AlgorithmIdentifier
                     OPTIONAL,
            clientDHNonce     [3] DHNonce OPTIONAL,
            ...,
            supportedKDFs     [4] SEQUENCE OF KDFAlgorithmId OPTIONAL,
                -- Contains an unordered set of KDFs supported by the
                -- client.
            ...
     }

     KDFAlgorithmId ::= SEQUENCE {
            kdf-id            [0] OBJECT IDENTIFIER,
                -- Contains the object identifier of the KDF.
            ...
     }
</pre></div>
<p>The new field supportedKDFs contains an unordered set of KDFs supported by the client. 
</p>
<p> The KDFAlgorithmId structure contains an object identifier that identifies a KDF. The algorithm of the KDF 
and its parameters are defined by the corresponding specification of that KDF.
</p>
<p> The DHRepInfo structure in <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> is extended as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   DHRepInfo ::= SEQUENCE {
           dhSignedData         [0] IMPLICIT OCTET STRING,
           serverDHNonce        [1] DHNonce OPTIONAL,
           ...,
           kdf                  [2] KDFAlgorithmId OPTIONAL,
               -- The KDF picked by the KDC.
           ...
   }
</pre></div>
<p>
   The new field kdf in the extended DHRepInfo structure identifies the KDF picked by the KDC. This kdf field MUST be filled
   by the comforming KDC if the supportedKDFs field is present in the request, and it 
   MUST be one of the KDFs supported by the client as indicated in the request. Which KDF is chosen is a matter of the local policy on the KDC.
</p>
<p>If the supportedKDFs field is not present in the request, the kdf field in the reply MUST be absent.
</p>
<p>If the client fills the supportedKDFs field in the request, but the kdf field in the reply is not present, the client 
can deduce that the KDC is not updated to conform with this specification. In that case, it is a matter of local policy on the client whether to reject
the reply when the kdf field is absent in the reply.
</p>
<p>Implementations comforming to this specification MUST support id-pkinit-kdf-ah-sha256.
</p>
<a name="securityconsideration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>This document describes negotiation of checksum types, key derivation
   functions and other cryptographic functions. If
   negotiation is done unauthenticated, care MUST be taken to
   accept only acceptable values. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p> Jeffery Hutzelman  reviewed the document and provided suggestions for improvements.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>There is no action required for IANA.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3852">[RFC3852]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3852">Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;3852, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3852.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3961">[RFC3961]</a></td>
<td class="author-text">Raeburn, K., &ldquo;<a href="http://tools.ietf.org/html/rfc3961">Encryption and Checksum Specifications for Kerberos 5</a>,&rdquo; RFC&nbsp;3961, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3961.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4120">[RFC4120]</a></td>
<td class="author-text">Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;<a href="http://tools.ietf.org/html/rfc4120">The Kerberos Network Authentication Service (V5)</a>,&rdquo; RFC&nbsp;4120, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4120.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4556">[RFC4556]</a></td>
<td class="author-text">Zhu, L. and B. Tung, &ldquo;<a href="http://tools.ietf.org/html/rfc4556">Public Key Cryptography for Initial Authentication in Kerberos (PKINIT)</a>,&rdquo; RFC&nbsp;4556, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4556.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4634">[RFC4634]</a></td>
<td class="author-text">Eastlake, D. and T. Hansen, &ldquo;<a href="http://tools.ietf.org/html/rfc4634">US Secure Hash Algorithms (SHA and HMAC-SHA)</a>,&rdquo; RFC&nbsp;4634, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4634.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1320">[RFC1320]</a></td>
<td class="author-text"><a href="mailto:rivest@theory.lcs.mit.edu">Rivest, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1320">The MD4 Message-Digest Algorithm</a>,&rdquo; RFC&nbsp;1320, April&nbsp;1992 (<a href="http://www.rfc-editor.org/rfc/rfc1320.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1321">[RFC1321]</a></td>
<td class="author-text"><a href="mailto:rivest@theory.lcs.mit.edu">Rivest, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1321">The MD5 Message-Digest Algorithm</a>,&rdquo; RFC&nbsp;1321, April&nbsp;1992 (<a href="http://www.rfc-editor.org/rfc/rfc1321.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3766">[RFC3766]</a></td>
<td class="author-text">Orman, H. and P. Hoffman, &ldquo;<a href="http://tools.ietf.org/html/rfc3766">Determining Strengths For Public Keys Used For Exchanging Symmetric Keys</a>,&rdquo; BCP&nbsp;86, RFC&nbsp;3766, April&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3766.txt">TXT</a>).</td></tr>
</table>

<a name="asnmod"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
PKINIT ASN.1 Module</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     KerberosV5-PK-INIT-Agility-SPEC {
            iso(1) identified-organization(3) dod(6) internet(1)
            security(5) kerberosV5(2) modules(4) pkinit(5) agility (1)
     } DEFINITIONS EXPLICIT TAGS ::= BEGIN

     IMPORTS
        AlgorithmIdentifier, SubjectPublicKeyInfo
            FROM PKIX1Explicit88 { iso (1)
              identified-organization (3) dod (6) internet (1)
              security (5) mechanisms (5) pkix (7) id-mod (0)
              id-pkix1-explicit (18) }
              -- As defined in RFC 3280.

        Ticket, Int32, Realm, EncryptionKey, Checksum
            FROM KerberosV5Spec2 { iso(1) identified-organization(3)
              dod(6) internet(1) security(5) kerberosV5(2)
              modules(4) krb5spec2(2) }
              -- as defined in RFC 4120.

        PKAuthenticator, DHNonce
            FROM KerberosV5-PK-INIT-SPEC {
              iso(1) identified-organization(3) dod(6) internet(1)
              security(5) kerberosV5(2) modules(4) pkinit(5) };
              -- as defined in RFC 4556.

     TD-CMS-DIGEST-ALGORITHMS-DATA ::= SEQUENCE OF
         AlgorithmIdentifier
             -- Contains the list of CMS algorithm [RFC3852]
             -- identifiers that identify the digest algorithms
             -- acceptable by the KDC for signing CMS data in
             -- the order of decreasing preference.

     TD-CERT-DIGEST-ALGORITHMS-DATA ::= SEQUENCE {
            allowedAlgorithms [0] SEQUENCE OF AlgorithmIdentifier,
                -- Contains the list of CMS algorithm [RFC3852]
                -- identifiers that identify the digest algorithms
                -- that are used by the CA to sign the client's
                -- X.509 certificate and acceptable by the KDC in
                -- the process of validating the client's X.509
                -- certificate, in the order of decreasing
                -- preference.
            rejectedAlgorithm [1] AlgorithmIdentifier OPTIONAL,
                -- This identifies the digest algorithm that was
                -- used to sign the client's X.509 certificate and
                -- has been rejected by the KDC in the process of
                -- validating the client's X.509 certificate
                -- [RFC3280].
            ...
     }

     PkinitSuppPubInfo ::= SEQUENCE {
            enctype           [0] Int32,
                -- The enctype of the AS reply key.
            as-REQ            [1] OCTET STRING,
                -- This contains the AS-REQ in the request.
            pk-as-rep         [2] OCTET STRING,
                -- Contains the DER encoding of the type
                -- PA-PK-AS-REP [RFC4556] in the KDC reply.
            ticket            [3] Ticket,
                -- This is the ticket in the KDC reply.
            ...
     }

     AuthPack ::= SEQUENCE {
            pkAuthenticator   [0] PKAuthenticator,
            clientPublicValue [1] SubjectPublicKeyInfo OPTIONAL,
            supportedCMSTypes [2] SEQUENCE OF AlgorithmIdentifier
                     OPTIONAL,
            clientDHNonce     [3] DHNonce OPTIONAL,
            ...,
            supportedKDFs     [4] SEQUENCE OF KDFAlgorithmId OPTIONAL,
                -- Contains an unordered set of KDFs supported by the
                -- client.
            ...
     }

     KDFAlgorithmId ::= SEQUENCE {
            kdf-id            [0] OBJECT IDENTIFIER,
                -- Contains the object identifier of the KDF.
            ...
     }

     DHRepInfo ::= SEQUENCE {
            dhSignedData      [0] IMPLICIT OCTET STRING,
            serverDHNonce     [1] DHNonce OPTIONAL,
            ...,
            kdf               [2] KDFAlgorithmId OPTIONAL,
                -- The KDF picked by the KDC.
            ...
     }
     END
</pre></div>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Love Hornquist Astrand</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stockholm University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SE-106 91</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stockholm</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sweden</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ha@it.su.se">ha@it.su.se</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Larry Zhu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Microsoft Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redmond, WA  98052</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:lzhu@microsoft.com">lzhu@microsoft.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
