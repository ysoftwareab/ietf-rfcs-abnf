<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>TCP User Timeout Option</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="TCP User Timeout Option">
<meta name="keywords" content="TCP, user timeout, timeout advertisement, TCP option, intermittent connectivity, mobility">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">TCP Maintenance and Minor</td><td class="header">L. Eggert</td></tr>
<tr><td class="header">Extensions (tcpm)</td><td class="header">Nokia</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">F. Gont</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">UTN/FRH</td></tr>
<tr><td class="header">Expires: July 26, 2009</td><td class="header">January 22, 2009</td></tr>
</table></td></tr></table>
<h1><br />TCP User Timeout Option<br />draft-ietf-tcpm-tcp-uto-11</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 26, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The TCP user
timeout controls how long transmitted data may remain
unacknowledged before a connection is forcefully closed. It is a
local, per-connection parameter.
This document specifies a new TCP option - the TCP User Timeout
Option - that allows one end of a TCP connection to advertise its current user timeout value. This information provides advice to the other end of the TCP connection to adapt its user timeout accordingly. 
Increasing the user timeouts on both ends of a TCP connection allows it to survive extended periods without end-to-end connectivity. Decreasing the user timeouts allows busy servers to
explicitly notify their clients that they will maintain the
connection state only for a short time without connectivity.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#anchor1">2.</a>&nbsp;
Conventions<br />
<a href="#op">3.</a>&nbsp;
Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#range">3.1.</a>&nbsp;
Changing the Local User Timeout<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">3.2.</a>&nbsp;
UTO Option Reliability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.3.</a>&nbsp;
Option Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#special">3.4.</a>&nbsp;
Reserved Option Values<br />
<a href="#anchor4">4.</a>&nbsp;
Interoperability Issues<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Middleboxes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
TCP Keep-Alives<br />
<a href="#mangcons">5.</a>&nbsp;
Programming and Manageability Considerations<br />
<a href="#seccons">6.</a>&nbsp;
Security Considerations<br />
<a href="#iana">7.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor7">8.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#anchor10">Appendix&nbsp;A.</a>&nbsp;
Document Revision History<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The Transmission Control Protocol (TCP) specification 
<a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> defines a local, per-connection "user
timeout" parameter that specifies the maximum amount of time that
transmitted data may remain unacknowledged before TCP will
forcefully close the corresponding connection. Applications can set
and change this parameter with OPEN and SEND calls. 
If an end-to-end connectivity disruption lasts longer than the
       user timeout, a sender will receive no acknowledgments for any
       transmission attempt, including keep-alives, and it will close
       the TCP connection when the user timeout occurs.

</p>
<p>
This document specifies a new TCP option - the TCP User Timeout
Option - that allows one end of a TCP connection to advertise its current user timeout value. This information provides advice to the other end of the connection to adapt its user timeout accordingly. That is, TCP remains free to disregard the advice provided by the UTO option if local policies suggest it to be appropriate.
</p>
<p>
Increasing the user timeouts on both ends of a TCP connection allows it to survive extended periods without end-to-end connectivity. Decreasing the user timeouts allows busy servers to
explicitly notify their clients that they will maintain the
connection state only for a short time without connectivity.

</p>
<p>
In the absence of an application-specified
user timeout, the TCP specification 
<a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> defines a default user timeout of 5
minutes. The Host Requirements RFC 
<a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a> refines this definition by introducing two
thresholds, R1 and R2 (R2 &gt; R1), that control the number of
retransmission attempts for a single segment. It suggests that TCP should
notify applications when R1 is reached for a segment, and close the
connection when R2 is reached. 
<a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a> also defines the recommended values for R1
(three retransmissions) and R2 (100 seconds), noting that R2 for
SYN segments should be at least 3 minutes. Instead of a single user
timeout, some TCP implementations offer finer-grained policies. For
example, Solaris supports different timeouts depending on whether a
TCP connection is in the SYN-SENT, SYN-RECEIVED, or ESTABLISHED
state 
<a class='info' href='#SOLARIS-MANUAL'>[SOLARIS&#8209;MANUAL]<span> (</span><span class='info'>Sun Microsystems, &ldquo;Solaris Tunable Parameters Reference Manual,&rdquo; 2002.</span><span>)</span></a>.
</p>
<p>Although some TCP implementations allow applications to set
their local user timeout, TCP has no in-protocol mechanism to
signal changes to the local user timeout to the other end of a connection. This
causes local changes to be ineffective in allowing a connection to survive extended periods without connectivity, because the other end will still
close the connection after its user timeout expires. 

</p>
<p>
The ability to inform the
other end of a connection about the local user timeout can
improve TCP operation in scenarios that are currently not well
supported. One example of such a scenario is mobile hosts that
change network attachment points. Such
hosts, maybe using Mobile IP 
<a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>, HIP 
<a class='info' href='#RFC4423'>[RFC4423]<span> (</span><span class='info'>Moskowitz, R. and P. Nikander, &ldquo;Host Identity Protocol (HIP) Architecture,&rdquo; May&nbsp;2006.</span><span>)</span></a> or transport-layer mobility mechanisms 
<a class='info' href='#I-D.eddy-tcp-mobility'>[I&#8209;D.eddy&#8209;tcp&#8209;mobility]<span> (</span><span class='info'>Eddy, W., &ldquo;Mobility Support For TCP,&rdquo; April&nbsp;2004.</span><span>)</span></a>, are only intermittently
connected to the Internet. In between connected periods, mobile
hosts may experience periods without end-to-end connectivity. Other factors that can cause
transient connectivity disruptions are high levels of congestion or link or routing failures inside the network.
In these scenarios, a host may not
know exactly when or for how long connectivity disruptions will occur, but it might be able to determine an increased likelihood for such events based on past mobility
patterns and thus benefit from using longer user timeouts. In other
scenarios, the time and duration of a connectivity disruption may even
be predictable.
For example, a node in space might experience connectivity
       disruptions due to line-of-sight blocking by planetary
       bodies. The timing of these events  may be computable from orbital mechanics.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL"
in this document are to be interpreted as described in 
<a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="op"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Operation</h3>

<p>Use of the TCP User Timeout Option can be enabled either on a per-connection basis, e.g., through an API option, or controlled by a system-wide setting. TCP maintains four per-connection state variables to control the operation of the UTO option, three of which (ADV_UTO, ENABLED and CHANGEABLE) are new:
</p>
<blockquote class="text"><dl>
<dt>USER_TIMEOUT</dt>
<dd>
TCP's USER TIMEOUT parameter, as specified in <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>.
</dd>
<dt>ADV_UTO</dt>
<dd>
UTO option advertised to the remote TCP peer. This is an application-specified value, and may be specified on a system-wide basis. If unspecified, it defaults to the default system-wide USER TIMEOUT.
</dd>
<dt>ENABLED (Boolean)</dt>
<dd>
Flag that controls whether the UTO option is enabled for a connection. This flag applies to both sending and receiving. Defaults to false.
</dd>
<dt>CHANGEABLE (Boolean)</dt>
<dd>
Flag that controls whether USER_TIMEOUT (TCP's USER TIMEOUT parameter) may be changed based on an UTO option received from the other end of the connection. Defaults to true and becomes false when an application explicitly sets USER_TIMEOUT.
</dd>
</dl></blockquote><p>

</p>
<p>Note that an exchange of UTO options between both ends of a connection is not a binding negotiation. Transmission of a UTO option is a suggestion that the other end consider adapting
its user timeout. This adaptation only happens if the other end of the connection has explicitly allowed it (both ENABLED and CHANGEABLE are true).

</p>
<p>Before opening a connection, an application that wishes to use the UTO option  enables its use by setting ENABLED to true. It may choose an appropriate local UTO by explicitly setting ADV_UTO; otherwise, UTO is set to the default USER TIMEOUT value. Finally, the application should determine whether it will allow the local USER TIMEOUT to change based on received UTO options from the other end of a connection. The default is to allow this for connections that do not have specific user timeout concerns. If an application explicitly sets the USER_TIMEOUT, CHANGEABLE MUST become false, to prevent UTO options from the other end to override local application requests. Alternatively, applications can set or clear CHANGEABLE directly through API calls.

</p>
<p>
Performing these steps before an active or passive open causes UTO options to be exchanged in the SYN and SYN-ACK packets and is a reliable way to initially exchange, and potentially adapt to, UTO values. TCP implementations MAY provide system-wide default settings for the ENABLED, ADV_UTO and CHANGEABLE connection parameters.

</p>
<p>
In addition to exchanging UTO options in the SYN segments, a connection that has enabled UTO options 
SHOULD include a UTO option in the first packet that does not have the
SYN flag set. This helps to minimize the amount of state
information TCP must keep for connections in non-synchronized
states, and is particularly useful when mechanisms such as "SYN cookies" 
<a class='info' href='#RFC4987'>[RFC4987]<span> (</span><span class='info'>Eddy, W., &ldquo;TCP SYN Flooding Attacks and Common Mitigations,&rdquo; August&nbsp;2007.</span><span>)</span></a> are implemented, allowing
a newly-established TCP connection to benefit from the information
advertised by the UTO option, even if the UTO contained in the
initial SYN segment was not recorded.
</p>
<p>A host that supports the UTO option SHOULD include
one in the next possible outgoing segment whenever it starts
using a new user timeout for the connection. This allows the other end of the connection to adapt its local user timeout accordingly. A TCP implementation that does not support the UTO option MUST silently ignore it 
<a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a>, thus ensuring interoperability.
</p>
<p>Hosts MUST impose upper and lower limits on the user timeouts
they use for a connection. 
<a class='info' href='#range'>Section&nbsp;3.1<span> (</span><span class='info'>Changing the Local User Timeout</span><span>)</span></a> discusses user timeout limits and potentially problematic effects of some
user timeout settings.
</p>
<p>Finally, it is worth noting that TCP's option space is limited to 40 bytes. As a result, if other TCP options are in use, they may already consume all the available TCP option space, thus preventing the use of the UTO option specified in this document. Therefore, TCP option space issues should be considered before enabling the UTO option.
</p>
<a name="range"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Changing the Local User Timeout</h3>

<p>When a host receives a TCP User Timeout Option, it must decide
whether to change the local user timeout of the corresponding
connection. 
If the CHANGEABLE flag is false, USER_TIMEOUT MUST NOT be changed, regardless of the received UTO option.
Without this restriction, the UTO option would modify TCP semantics, because an
application-requested USER TIMEOUT could be overridden by peer
requests. In this case TCP SHOULD, however, notify the
application about the user timeout value received from the
other end system.

</p>
<p>
In general, unless the application on the local
host has requested a specific USER TIMEOUT for the connection, CHANGEABLE will be true and hosts SHOULD adjust the local TCP USER TIMEOUT (USER_TIMEOUT) in response to receiving a UTO option, as described in the remainder of this section. 
</p>
<p>The UTO option specifies the user timeout in seconds or minutes, rather than in number of retransmissions
or round-trip times (RTTs). Thus, the UTO option allows hosts to exchange user timeout values from 1
second to over 9 hours at a granularity of seconds, and from 1
minute to over 22 days at a granularity of minutes. 
</p>
<p>Very short USER TIMEOUT values can affect TCP transmissions over
high-delay paths. If the user timeout occurs before an
acknowledgment for an outstanding segment arrives, possibly due to
packet loss, the connection closes. Many TCP implementations
default to USER TIMEOUT values of a few minutes. Although the UTO option
allows suggestion of short timeouts, applications advertising them
should consider these effects.
</p>
<p>Long USER TIMEOUT values allow hosts to tolerate extended
periods without end-to-end connectivity. However, they also require hosts to
maintain the TCP state information associated with connections for
long periods of time. 
<a class='info' href='#seccons'>Section&nbsp;6<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> discusses the security implications of
long timeout values.
</p>
<p>To protect against these effects, implementations MUST impose
limits on the user timeout values they accept and use. The
remainder of this section describes a RECOMMENDED scheme to limit
TCP's USER TIMEOUT based on upper and lower limits. 
</p>
<p>
Under the RECOMMENDED scheme, and when CHANGEABLE is true, each end SHOULD compute the local USER TIMEOUT for a connection according to this formula:
</p>
<p>USER_TIMEOUT = min(U_LIMIT, max(ADV_UTO, REMOTE_UTO,
L_LIMIT))
</p>
<p>Each field is to be interpreted as follows:
</p>
<p>
</p>
<blockquote class="text"><dl>
<dt>USER_TIMEOUT</dt>
<dd>
USER TIMEOUT value to be adopted by the local TCP for this connection.
</dd>
<dt>U_LIMIT</dt>
<dd>
Current upper limit imposed on the user
timeout of a connection by the local host.
</dd>
<dt>ADV_UTO</dt>
<dd>
User timeout advertised to the remote TCP peer in a TCP User Timeout Option.
</dd>
<dt>REMOTE_UTO</dt>
<dd>
Last user timeout value received from the
other end in a TCP User Timeout Option.
</dd>
<dt>L_LIMIT</dt>
<dd>
Current lower limit imposed on the user
timeout of a connection by the local host.
</dd>
</dl></blockquote><p>

</p>
<p>The RECOMMENDED formula results in the maximum of the two advertised values, adjusted for the configured upper and lower limits, to be adopted for the user timeout of the connection on both ends. The rationale is that choosing
the maximum of the two values will let the connection survive
longer periods without end-to-end connectivity. If the end that announced the
lower of the two user timeout values did so in order to reduce the
amount of TCP state information that must be kept on the host, it
can close or abort the connection whenever it
wants. 

</p>
<p>It must be noted that the two endpoints of the connection will
not necessarily adopt the same user timeout.
</p>
<p>Enforcing a lower limit (L_LIMIT) prevents connections from
closing due to transient network conditions, including temporary
congestion, mobility hand-offs and routing instabilities.
</p>
<p>An upper limit (U_LIMIT) can reduce the effect of resource
exhaustion attacks. 
<a class='info' href='#seccons'>Section&nbsp;6<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> discusses the details of these attacks.
</p>
<p>Note that these limits MAY be specified as system-wide constants
or at other granularities, such as on per-host, per-user, per-outgoing-interface or even
per-connection basis. Furthermore, these limits need not be static.
For example, they MAY be a function of system resource utilization
or attack status and could be dynamically adapted.
</p>
<p>The Host Requirements RFC 
<a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a> does not impose any limits on the length
of the user timeout. However, it recommends a time interval of at least 100
seconds. Consequently, the lower limit (L_LIMIT)
SHOULD be set to at least 100 seconds when following the
RECOMMENDED scheme described in this section. Adopting a user
timeout smaller than the current retransmission timeout (RTO) for
the connection would likely cause the connection to be aborted
unnecessarily. Therefore, the lower limit (L_LIMIT) MUST be larger
than the current retransmission timeout (RTO) for the connection.
It is worth noting that an upper limit may be imposed on the RTO,
provided it is at least 60 seconds 
<a class='info' href='#RFC2988'>[RFC2988]<span> (</span><span class='info'>Paxson, V. and M. Allman, &ldquo;Computing TCP's Retransmission Timer,&rdquo; November&nbsp;2000.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
UTO Option Reliability</h3>

<p>The TCP User Timeout Option is an advisory TCP option that does
not change processing of subsequent segments. Unlike other TCP
options, it need not be exchanged reliably. Consequently, the
specification does not define a reliability
handshake for UTO option exchanges. When a segment
that carries a UTO option is lost, the other end will simply not have the opportunity to update its local UTO.
</p>
<p>Implementations MAY implement local mechanisms to improve
delivery reliability, such as retransmitting a UTO option when they retransmit a segment that originally carried it,
or "attaching" the option to a byte in the stream and
retransmitting the option whenever that byte or its ACK are
retransmitted.
</p>
<p>It is important to note that although these mechanisms can
improve transmission reliability for the UTO option,
they do not guarantee delivery (a three-way handshake would be
required for this). Consequently, implementations MUST NOT assume
that UTO options are transmitted reliably.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Option Format</h3>

<p>Sending a TCP User Timeout Option informs the other end of the connection of the current local user timeout and suggests that the other end adapt its user timeout
accordingly. The user timeout value
included in a UTO option contains the ADV_UTO value, that is expected to be adopted for the TCP's USER TIMEOUT parameter during the synchronized states of a connection
(ESTABLISHED, FIN-WAIT-1, FIN-WAIT-2, CLOSE-WAIT, CLOSING, or
LAST-ACK). Connections in other states MUST use the default timeout
values defined in 
<a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> and <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="figureoptionformat"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Kind = TBD  |   Length = 4  |G|        User Timeout         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>(One tick mark represents one bit.)
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Format of the TCP User Timeout Option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
<a class='info' href='#figureoptionformat'>Figure&nbsp;1<span> (</span><span class='info'>Format of the TCP User Timeout Option</span><span>)</span></a> shows the format of the TCP
User Timeout Option. It contains these fields: 
</p>
<blockquote class="text"><dl>
<dt>Kind (8 bits)</dt>
<dd>
This MUST be TBD, i.e., the TCP option number 
<a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> assigned by IANA upon publication of
this document (see <a class='info' href='#iana'>Section&nbsp;7<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>). [[Note to the RFC Editor: Throughout this document, replace "TBD" with the TCP option number that IANA has allocated and remove this note.]]
</dd>
<dt>Length (8 bits)</dt>
<dd>
Length of the TCP option in octets 
<a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>; its value MUST be 4.
</dd>
<dt>Granularity (1 bit)</dt>
<dd>
Granularity bit, indicating the
granularity of the "User Timeout" field. When set (G = 1), the time
interval in the "User Timeout" field MUST be interpreted as
minutes. Otherwise (G = 0), the time interval in the "User Timeout"
field MUST be interpreted as seconds.
</dd>
<dt>User Timeout (15 bits)</dt>
<dd>
Specifies the user timeout suggestion for this connection. It MUST be interpreted as a 15-bit unsigned integer. The granularity of the timeout (minutes or seconds)
depends on the "G" field.
</dd>
</dl></blockquote>

<a name="special"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Reserved Option Values</h3>

<p>An TCP User Timeout Option with a "User
Timeout" field of zero and a "Granularity" bit of either minutes (1) or seconds (0) is reserved
for future use. Current TCP implementations MUST NOT send it and MUST
ignore it upon reception.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Interoperability Issues</h3>

<p>This section discusses interoperability issues related to
introducing the TCP User Timeout Option.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Middleboxes</h3>

<p>A TCP implementation that does not support the TCP User
Timeout Option MUST silently ignore it 
<a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a>, thus ensuring interoperability. In a
study of the effects of middleboxes on transport protocols, Medina
et al. have shown that the vast majority of modern TCP stacks correctly handle unknown TCP options <a class='info' href='#MEDINA'>[MEDINA]<span> (</span><span class='info'>Medina, A., Allman, M., and S. Floyd, &ldquo;Measuring Interactions Between Transport Protocols and Middleboxes,&rdquo; October&nbsp;2004.</span><span>)</span></a>. In this study, 3% of connections failed
when an unknown TCP option appeared in the middle of a connection.
Because the number of failures caused by unknown options is small and they are a result of incorrectly implemented TCP stacks that violate existing requirements to ignore
unknown options, they do not warrant special measures. Thus, this document does not define a mechanism to negotiate support of the TCP User Timeout Option during the three-way handshake.
</p>
<p>Stateful firewalls usually time out connection state after a period of
inactivity. If such a firewall exists along the path, it may close or abort connections regardless of the use of
the TCP User Timeout Option. In the future, such firewalls may
learn to parse the TCP User Timeout Option in unencrypted TCP segments and adapt connection state management accordingly.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
TCP Keep-Alives</h3>

<p>Some TCP implementations, such as those in BSD systems, use a
different abort policy for TCP keep-alives than for user data.
Thus, the TCP keep-alive mechanism might abort a connection that
would otherwise have survived the transient period without connectivity. Therefore, if a connection that enables keep-alives is also using the TCP User Timeout Option, then the
keep-alive timer MUST be set to a value larger than that of the
adopted USER TIMEOUT.
</p>
<a name="mangcons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Programming and Manageability Considerations</h3>

<p>
The IETF specification for TCP <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> includes a simple, abstract application programming interface (API). The API for the UTO extension in <a class='info' href='#op'>Section&nbsp;3<span> (</span><span class='info'>Operation</span><span>)</span></a> is kept similarly abstract. TCP implementations, however, usually provide more complex and feature-rich APIs. The "socket" API that originated with BSD Unix and is now standardized by POSIX is one such example <a class='info' href='#POSIX'>[POSIX]<span> (</span><span class='info'>IEEE Std. 1003.1-2001, &ldquo;Standard for Information Technology - Portable Operating System Interface (POSIX),&rdquo; December&nbsp;2001.</span><span>)</span></a>. It is expected that TCP implementations that choose to include the UTO extension will extend their API to allow applications to use and configure its parameters.

</p>
<p>
  The MIB objects defined in <a class='info' href='#RFC4022'>[RFC4022]<span> (</span><span class='info'>Raghunarayan, R., &ldquo;Management Information Base for the Transmission Control Protocol (TCP),&rdquo; March&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#RFC4898'>[RFC4898]<span> (</span><span class='info'>Mathis, M., Heffner, J., and R. Raghunarayan, &ldquo;TCP Extended Statistics MIB,&rdquo; May&nbsp;2007.</span><span>)</span></a> allow management of TCP
  connections. It is expected that revisions to these documents
  will include definitions of objects for managing the UTO
  extension defined in this document.

</p>
<a name="seccons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>Lengthening user timeouts has obvious security implications.
Flooding attacks cause denial of service by forcing servers to
commit resources for maintaining the state of throw-away
connections. However, TCP implementations do not become more
vulnerable to simple SYN flooding by implementing the TCP User
Timeout Option, because user timeouts exchanged during the
handshake only affect the synchronized states (ESTABLISHED,
FIN-WAIT-1, FIN-WAIT-2, CLOSE-WAIT, CLOSING, LAST-ACK), which
simple SYN floods never reach.
</p>
<p>However, when an attacker completes the three-way handshakes of
its throw-away connections it can amplify the effects of resource
exhaustion attacks, because the attacked server must maintain the
connection state associated with the throw-away connections for
longer durations. Because connection state is kept longer,
lower-frequency attack traffic, which may be more difficult to
detect, can already exacerbate resource exhaustion.
</p>
<p>
   Several approaches can help mitigate this issue.  First,
   implementations can require prior peer authentication, e.g., using IPsec
   <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> or TCP-MD5 <a class='info' href='#RFC2385'>[RFC2385]<span> (</span><span class='info'>Heffernan, A., &ldquo;Protection of BGP Sessions via the TCP MD5 Signature Option,&rdquo; August&nbsp;1998.</span><span>)</span></a>, before accepting long user
   timeouts for the peer's connections.  (Implementors that decide
   to use TCP-MD5 for this purpose are encouraged to monitor the
   development of TCP-AO <a class='info' href='#I-D.ietf-tcpm-tcp-auth-opt'>[I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;auth&#8209;opt]<span> (</span><span class='info'>Touch, J., Mankin, A., and R. Bonica, &ldquo;The TCP Authentication Option,&rdquo; March&nbsp;2010.</span><span>)</span></a>, its designated
   successor, and update their implementation when it is published
   as an RFC.)  A similar approach is for a host to start accepting
   long user timeouts for an established connection only after
   in-band authentication has occurred, for example, after a TLS handshake
across the connection has succeeded 
<a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>. Although these are arguably the most
complete solutions, they depend on external mechanisms to establish
a trust relationship.
</p>
<p>A second alternative that does not depend on external mechanisms
would introduce a per-peer limit on the number of connections that
may use increased user timeouts. Several variants of this approach
are possible, such as fixed limits or shortening accepted user
timeouts with a rising number of connections. Although this
alternative does not eliminate resource exhaustion attacks from a
single peer, it can limit their effects. Reducing the number of
high-UTO connections a server supports in the face of an attack
turns that attack into a denial-of-service attack against the
service of high-UTO connections.
</p>
<p>Per-peer limits cannot protect against distributed denial of
service attacks, where multiple clients coordinate a resource
exhaustion attack that uses long user timeouts. To protect against
such attacks, TCP implementations could reduce the duration of
accepted user timeouts with increasing resource utilization.
</p>
<p>TCP implementations under attack may be forced to shed load by
resetting established connections. Some load-shedding heuristics,
such as resetting connections with long idle times first, can
negatively affect service for intermittently connected, trusted
peers that have suggested long user timeouts. On the other hand,
resetting connections to untrusted peers that use long user
timeouts may be effective. In general, using the peers' level of
trust as a parameter during the load-shedding decision process may
be useful. Note that if TCP needs to close or abort connections
with a long TCP User Timeout Option to shed load, these connections
are still no worse off than without the option.
</p>
<p>Finally, upper and lower limits on user timeouts, discussed in 
<a class='info' href='#range'>Section&nbsp;3.1<span> (</span><span class='info'>Changing the Local User Timeout</span><span>)</span></a>, can be an effective tool to limit the
impact of these sorts of attacks.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This section is to be interpreted according to 
<a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<p>This document does not define any new namespaces. It requests that IANA allocate a new 8-bit TCP option number for the UTO option from the registry maintained at
http://www.iana.org/assignments/tcp-parameters.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgments</h3>

<p>The following people have improved this document through
thoughtful suggestions: Mark Allman, Caitlin Bestler, David Borman,
Bob Braden, Scott Brim, Marcus Brunner, Wesley Eddy, Gorry Fairhurst, Abolade
Gbadegesin, Ted Faber, Guillermo Gont, Tom Henderson, Joseph Ishac,
Jeremy Harris, Alfred Hoenes, Phil Karn, Michael Kerrisk, Dan Krejsa, Jamshid
Mahdavi, Kostas Pentikousis, Juergen Quittek, Anantha Ramaiah, Joe Touch, Stefan
Schmid, Simon Schuetz, Tim Shepard and Martin Stiemerling.
</p>
<p>
Lars Eggert is partly funded by <a class='info' href='#TRILOGY'>[TRILOGY]<span> (</span><span class='info'>, &ldquo;Trilogy Project,&rdquo; .</span><span>)</span></a>, a research project supported by the European Commission under its Seventh Framework Program.
	
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0793">[RFC0793]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>,&rdquo; STD&nbsp;7, RFC&nbsp;793, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1122">[RFC1122]</a></td>
<td class="author-text"><a href="mailto:Braden@ISI.EDU">Braden, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1122">Requirements for Internet Hosts - Communication Layers</a>,&rdquo; STD&nbsp;3, RFC&nbsp;1122, October&nbsp;1989 (<a href="http://www.rfc-editor.org/rfc/rfc1122.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.eddy-tcp-mobility">[I-D.eddy-tcp-mobility]</a></td>
<td class="author-text">Eddy, W., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-eddy-tcp-mobility-00.txt">Mobility Support For TCP</a>,&rdquo; draft-eddy-tcp-mobility-00 (work in progress), April&nbsp;2004 (<a href="http://www.ietf.org/internet-drafts/draft-eddy-tcp-mobility-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tcpm-tcp-auth-opt">[I-D.ietf-tcpm-tcp-auth-opt]</a></td>
<td class="author-text">Touch, J., Mankin, A., and R. Bonica, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-auth-opt-11.txt">The TCP Authentication Option</a>,&rdquo; draft-ietf-tcpm-tcp-auth-opt-11 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-auth-opt-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MEDINA">[MEDINA]</a></td>
<td class="author-text">Medina, A., Allman, M., and S. Floyd, &ldquo;Measuring Interactions Between Transport Protocols and
Middleboxes,&rdquo; Proc. 4th ACM SIGCOMM/USENIX Conference on Internet Measurement&nbsp;, October&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="POSIX">[POSIX]</a></td>
<td class="author-text">IEEE Std. 1003.1-2001, &ldquo;Standard for Information Technology - Portable Operating System Interface (POSIX),&rdquo; Open Group Technical Standard: Base Specifications&nbsp;Issue 6, ISO/IEC 9945:2002, December&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2385">[RFC2385]</a></td>
<td class="author-text"><a href="mailto:ahh@cisco.com">Heffernan, A.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2385">Protection of BGP Sessions via the TCP MD5 Signature Option</a>,&rdquo; RFC&nbsp;2385, August&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2385.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2385.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2385.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2988">[RFC2988]</a></td>
<td class="author-text">Paxson, V. and M. Allman, &ldquo;<a href="http://tools.ietf.org/html/rfc2988">Computing TCP's Retransmission Timer</a>,&rdquo; RFC&nbsp;2988, November&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2988.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3344">[RFC3344]</a></td>
<td class="author-text">Perkins, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3344">IP Mobility Support for IPv4</a>,&rdquo; RFC&nbsp;3344, August&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3344.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4022">[RFC4022]</a></td>
<td class="author-text">Raghunarayan, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4022">Management Information Base for the Transmission Control Protocol (TCP)</a>,&rdquo; RFC&nbsp;4022, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4022.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[RFC4301]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4423">[RFC4423]</a></td>
<td class="author-text">Moskowitz, R. and P. Nikander, &ldquo;<a href="http://tools.ietf.org/html/rfc4423">Host Identity Protocol (HIP) Architecture</a>,&rdquo; RFC&nbsp;4423, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4423.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4898">[RFC4898]</a></td>
<td class="author-text">Mathis, M., Heffner, J., and R. Raghunarayan, &ldquo;<a href="http://tools.ietf.org/html/rfc4898">TCP Extended Statistics MIB</a>,&rdquo; RFC&nbsp;4898, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4898.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4987">[RFC4987]</a></td>
<td class="author-text">Eddy, W., &ldquo;<a href="http://tools.ietf.org/html/rfc4987">TCP SYN Flooding Attacks and Common Mitigations</a>,&rdquo; RFC&nbsp;4987, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4987.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SOLARIS-MANUAL">[SOLARIS-MANUAL]</a></td>
<td class="author-text">Sun Microsystems, &ldquo;Solaris Tunable Parameters Reference Manual,&rdquo; Part No.&nbsp;806-7009-10, 2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="TRILOGY">[TRILOGY]</a></td>
<td class="author-text">&ldquo;Trilogy Project,&rdquo; &nbsp;http://www.trilogy-project.org/.</td></tr>
</table>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Document Revision History</h3>

<p>[[Note to the RFC Editor: Section to be removed upon publication.]]
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left" width="85%">
<tr><th align="left">Revision</th><th align="left">Comments</th></tr>
<tr>
<td align="left">-11</td>
<td align="left">Addressing IESG review comments.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-10</td>
<td align="left">Addressing the gen-art review comments from Scott Brim. Updated reference to <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>. Added funding source acknowledgment.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-09</td>
<td align="left">Resubmission after expiration. Updated reference to <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-08</td>
<td align="left">Addressed additional, minor working group last call comments.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-07</td>
<td align="left">Addressed working group last call comments.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-06</td>
<td align="left">Includes a note on the limited space for TCP options and miscellaneous editorial changes (suggested by Anantha Ramaiah). Includes possible enforcement of per-outgoing-interface limits for the UTO, and miscellaneous editorial changes (suggested by Alfred Hoenes). Includes relevant changes to reflect WG consensus how the local user timeout should be selected (i.e., record both the current user timeout, and the advertised UTO).</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-05</td>
<td align="left">Made behavior on when to change/not change the local UTO in response to incoming options consistent through the document. This required some reshuffling of text and also removed the need for the special "don't care" option value. </td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-04</td>
<td align="left">Clarified the results obtained by Medina et al. Added text to
suggest inclusion of the UTO in the first non-SYN segment by the
TCP that sent a SYN in response to an active OPEN.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-03</td>
<td align="left">Corrected use of RFC2119 terminology. Clarified how use of the
TCP UTO is triggered. Clarified reason for sending a UTO in the SYN
and SYN/ACK segments. Removed discussion of the SO_SNDTIMEO and
SO_RCVTIMEO socket options. Removed text that suggested that a UTO should
be sent upon receipt of an UTO from the other end. Required
minimum value for the lower limit of the user timeout. Moved
alternative solutions to appendix. Miscellaneous editorial
changes.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-02</td>
<td align="left">Corrected terminology by replacing terms like "negotiate",
"coordinate", etc. that were left from pre-WG-document times when
the UTO was a more formalized exchange instead of the advisory one
it is now. Application-requested UTOs take precedence over ones
received from the peer (pointed out by Ted Faber). Added a brief
mention of SO_SNDTIMEO and a slightly longer discussion of
SO_RCVTIMEO.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-01</td>
<td align="left">Clarified and corrected the description of the existing user
timeout in RFC793 and RFC1122. Removed distinction between
operating during the 3WHS and the established states and introduced
zero-second "don't care" UTOs in response to mailing list feedback.
Updated references and addressed many other comments from the
mailing list.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">-00</td>
<td align="left">Resubmission of draft-eggert-gont-tcpm-tcp-uto-option-01.txt to
the secretariat after WG adoption. Thus, permit derivative works.
Updated Lars Eggert's funding attribution. Updated several
references. No technical changes.</td>
</tr>
</table>
<br clear="all" />

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lars Eggert</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Research Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P.O. Box 407</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Group  00045</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 50 48 24461</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:lars.eggert@nokia.com">lars.eggert@nokia.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://research.nokia.com/people/lars_eggert/">http://research.nokia.com/people/lars_eggert/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fernando Gont</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Universidad Tecnologica
Nacional / Facultad Regional Haedo</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Evaristo Carriego 2644</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Haedo, Provincia de Buenos Aires  1706</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Argentina</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+54 11 4650 8472</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fernando@gont.com.ar">fernando@gont.com.ar</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.gont.com.ar/">http://www.gont.com.ar/</a></td></tr>
</table>
</body></html>
