
INTERNET-DRAFT                                                   P. Grau
<draft-dfncis-netnews-admin-sys-00.txt>                        V. Heinau
Expires August 2, 2000                                    H. Schlichting
                                                                 DFN-CIS
                                                            January 2000


                  Netnews Administration System (NAS)
                <draft-dfncis-netnews-admin-sys-00.txt>



Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of section 10 of [RFC2026].

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress".

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.


Abstract

   The Netnews Administration System (NAS) is a framework to simplify
   the administration and usage of network news on the Internet. Data
   for the administration of newsgroups and hierarchies are kept in a
   distributed hierarchical database, and are available through a
   client-server-protocol.

   The database is accessible by news servers and news administrators as
   well as by news readers. News servers can update their configuration
   automatically, administrators are able to get the data manually. News
   reader programs are able to get certain information from an NAS
   server, automatically or at a user's discretion, to provide detailed
   information about groups and hierarchies to the user.



Grau, Heinau, Schlichting                                       [Page 1]


Internet Draft       Netnews Administration System      January 28, 2000


   NAS is usable in coexistence with the current, established process of
   control messages, an unwanted interference is impossible.
   Furthermore, NAS is able to reflect the somewhat chaotic structure of
   the Usenet in a hierarchical database. NAS can be used without
   modification of existing news relay, news server or news reader
   software, however some tasks will be better accomplished with NAS
   compliant software.












































Grau, Heinau, Schlichting                                       [Page 2]


Internet Draft       Netnews Administration System      January 28, 2000


                           Table of Contents

Status of this Memo ...............................................    1
Abstract ..........................................................    1
1.  Introduction ..................................................    4
2.  Overview ......................................................    4
3.  Protocol Level ................................................    5
4.  Description of Functions ......................................    5
5.  Definitions ...................................................    7
6.  Specification of the NAS Protocol (TCP) .......................    7
    6.1.  Responses ...............................................    7
        6.1.1.  Overview ..........................................    7
        6.1.2.  Response Code Values, Structure and Meaning .......    8
    6.2.  Connection setup ........................................    9
    6.3.  Commands ................................................    9
        6.3.1.  Structure .........................................    9
        6.3.2.  Overview ..........................................    9
        6.3.3.  Detailed Description ..............................   10
            6.3.3.1.  HELP ........................................   10
            6.3.3.2.  INFO ........................................   11
            6.3.3.3.  DATE ........................................   12
            6.3.3.4.  VERS ........................................   13
            6.3.3.5.  QUIT ........................................   14
            6.3.3.6.  LIST ........................................   14
            6.3.3.7.  LSTR ........................................   16
            6.3.3.8.  HIER ........................................   17
            6.3.3.9.  DATA ........................................   19
            6.3.3.10.  GETL .......................................   20
            6.3.3.11.  GETP .......................................   21
            6.3.3.12.  GETA .......................................   23
            6.3.3.13.  Unknown Commands and Syntax Errors .........   25
        6.3.4.  Data codes for the commands DATA and HIER .........   25
            6.3.4.1.  Description .................................   25
        6.3.5.  Status Indicators .................................   36
        6.3.6.  Newsgroup Types ...................................   37
        6.3.7.  Hierarchy Types ...................................   37
        6.3.8.  PGP Keys ..........................................   38
7.  Specification of the NAS Protocol (UDP) .......................   39
8.  Security Considerations .......................................   39
9.  References ....................................................   39
10.  Author's Address .............................................   40
Appendix A - Response Codes (Overview) ............................   40
Appendix B - Data Codes for DATA and HIER Commands (Overview) .....   41








Grau, Heinau, Schlichting                                       [Page 3]


Internet Draft       Netnews Administration System      January 28, 2000


1.  Introduction

   The increasing number of newsgroups, hierarchies and articles has
   made the administration of news servers a complex and time consuming
   task. The tools for the administration are unchanged for nearly ten
   years now and no longer appropriate. Many hierarchies are
   inconsistent, many new newsgroups are not created or only with a huge
   delay, removed groups keep lurking in the configuration files for a
   long period of time. There is no administration tool that utilizes
   the power of the Internet, nor is there a possibility to check the
   consistency of the news server at a given point of time.

   Users have difficulties to get an overview of the newsgroups, the
   charter of a particular one, which language is preferred, or whether
   a group is moderated or not. Renaming, the status change from
   moderated to unmoderated or vice versa, the splitting of a group into
   several others are dynamic processes. These processes are common use,
   but it takes a long time until every news server is aware of these
   changes.

   An increasing number of faked control messages appeared in the last
   few years. Purposely or accidentally control messages were sent to
   foreign news servers to create or remove a certain group, although
   this task was not approved by the rules of the hierarchy in question.
   Due to this fact, on many news servers the automatic creation is
   disabled and several dead groups have been created. It is very
   difficult for users to determine the status of a group, and therefore
   the propagation of articles is affected by this fact.

   It is the design goal of NAS to provide a system that helps to
   maintain, propagate and deliver the required information.


2.  Overview

   NAS is based on a database which contains information belonging to
   certain groups and hierarchies. This database is structured in a
   hierarchical manner, distributed to various servers and is able to
   receive queries at any time. The service is comparable to directory
   services like DNS, LDAP or NIS. The NAS protocol is inspired by
   protocols like NNTP and SMTP.  There already is a reserved port
   number for NAS, 991. It is registered by the Internet Assigned Number
   Authority (IANA) [IANA-PN].

   The organizational structure of NAS is hierarchical, that means an
   NAS root server collects data from the subservers which are
   authoritative for certain hierarchies. The root server signs the data
   and distributes it authoritatively. Replication of database entries



Grau, Heinau, Schlichting                                       [Page 4]


Internet Draft       Netnews Administration System      January 28, 2000


   is possible. The hierarchical structure can consist of multiple
   levels. Usage of the database is possible for news servers, news
   readers and special client programs. The communication is based on
   TCP and UDP.

   NAS contains information about newsgroups as well as complete
   hierarchies. Furthermore it contains the information about the
   hierarchies' inheritable entries and default values for a single
   newsgroup.


3.  Protocol Level

   It is expected that the real life use of NAS will change the
   requirements for the netnews administration system. On one hand the
   protocol has to be extensible and flexible in order to implement
   improvements. On the other hand it must ensure compatibility between
   different versions. A simultaneous migration of all sites using NAS
   to a new protocol version is not likely to happen. To solve this
   problem, NAS has got a protocol level defined. This protocol level
   describes the current functionality. The protocol level, being a
   number between 1 and 32767, is negotiated at connection setup.
   Enhancements and modifications must use a different protocol level
   than their predecessors. (Usually the protocol level is incremented
   by 1 with every new version of the protocol specification.) Every
   current or future implementation must be compatible with the protocol
   level 1, in order to fall back to this level when communication on a
   higher level fails.

   An implementation of higher protocol levels should be able to emulate
   the behavior of lower levels, even if this implies a loss of
   features. The negotiation of the protocol level between client and
   server is described in the specification of the command VERS. If
   there is no agreement on the protocol level, only commands of the
   protocol level 1 must be used. Documents enhancing or modifying the
   NAS standard must specify from upon which level these changes take
   place and how the behavior should be in other protocol levels.

   This document describes protocol level 1.


4.  Description of Functions

   In order to use an NAS server, a connection must be opened by the
   client. The NAS server can be located in the same domain or somewhere
   else on the Internet.

   The NAS system is hierarchical. The idea is to have an NAS root



Grau, Heinau, Schlichting                                       [Page 5]


Internet Draft       Netnews Administration System      January 28, 2000


   server like the DNS root servers.  The root server distributes the
   data collected from client NAS servers, which are authoritative
   servers for their hierarchy.  The maintenance of the authoritative
   data is possible on any system. The root server collects the data and
   makes them available to other servers, which also can distribute
   these data to other servers. The administrator has the opportunity to
   make use of either all data or only parts of the database. NAS
   servers can ask multiple NAS servers for data. An attached time stamp
   provides the possibility to distinguish between new and old data, and
   to avoid loops in the propagation.

   To describe the NAS in greater detail it is necessary to emphasize
   the hierarchical design of the NAS system.  The following picture
   shows the propagation of data along the server hierarchy. There are
   two kinds of data collection: in first place the authoritative data
   for a newsgroup or a hierarchy are collected, and written into a
   database. This database is made available to a local NAS server. The
   data will then be collected by the upstream NAS server.

    ............     collects from >
    . root NAS .-------------------------+
    . server   .----------------+        |
    ............                |        |
    . database .                |        |
    ............                |        |
          ^ v                   |    ..............
          | |                   |    . de.*       .
          | |distributes        |    . NAS server .
   queries| |                   |    ..............
          | |                   |    .  database  .
          ^ v                   |    ..............
    ............                |
    . database .                `--------+
    . with NAS .                         |
    . client   .                     ..............
    ............                     . bln.*      .
      ^  ^  ^                        . NAS server .
      |  |  |  .----------.          ..............
    q |  |  `--| netnews  |          .  database  .
    u |  |     | server   |          ..............
    e |  |     .----------.
    r |  |
    i |  |  .----------.
    e |  `--| admin    |
    s |     | program  |
      |     .----------.
      |
      |  .----------.



Grau, Heinau, Schlichting                                       [Page 6]


Internet Draft       Netnews Administration System      January 28, 2000


      `--| news     |
         | reader   |
         .----------.

   Requests to an NAS server originating at a client as well as
   another server are accomplished in several steps, as there are:
   Establishing a connection, authentication (optional),
   negotiating a protocol level (optional), queries on
   the database, and termination.


5.  Definitions


   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].




6.  Specification of the NAS Protocol (TCP)

6.1.  Responses

6.1.1.  Overview

   There are several types of answers to a request:

   1) Single line answers

   A one line answer of the NAS protocol must start with a response code
   (a three digit number), optionally followed by white space and a
   textual message.

   2) Multi line answers

   Every line but the last of a multi line answer must start with a
   response code (a three digit number), followed by a hyphen "-" and an
   optional textual message. The last line must begin with the response
   code, followed optionally by some text with leading white space. That
   is, the optional text must be separated from the response code by
   white space.

   3) Single line plus additional data lines (6xx answers)

   The first line of an answer including data blocks must start with a
   response code (a three digit number), followed by white space and the



Grau, Heinau, Schlichting                                       [Page 7]


Internet Draft       Netnews Administration System      January 28, 2000


   end mark. The end mark must be a string not including any white space
   with a total length of up to 32 characters.  The end mark has to be
   chosen so that the following data lines do not begin with this
   string. For most cases, two consecutive periods ".." should be an
   appropriate end mark.  The end mark may be followed by white space
   and an optional textual message.

   After this preamble line, an unlimited number of data lines may
   follow. The format of the data lines depends on the particular
   request and is described in later sections.

   The transmission of data lines is completed by a line that starts
   with the end mark from above and optionally followed by white space
   and a textual message.


6.1.2.  Response Code Values, Structure and Meaning

   The first digit of the response code indicates the message type, i.e.
   informational, success, warning, error, data:

   1xx Information
   2xx Request successful
   3xx Request successful, data follow
   4xx Request accepted, but no operation possible
   5xx Request is wrong (syntax error), not implemented, or leads to an
       internal error
   6xx Request successful, data follow until end mark

   The second digit specifies the message category:

   x0x connection related stuff
   x1x queries, answers, data
   x2x server-server communication
   x3x authentication, authorization
   x8x non-standard extensions
   x9x debugging output

   The actual response code for a specific command is listed in the
   description of the commands. Answers of the type 1xx, 2xx, 4xx, and
   5xx can have a text after the numerical code. 3xx answers contain one
   or more parameters with data, the exact format is explained in the
   description of the commands.

   An answer to an incorrect request may be longer than one line.






Grau, Heinau, Schlichting                                       [Page 8]


Internet Draft       Netnews Administration System      January 28, 2000


6.2.  Connection setup

   NAS uses typically port 991, which is reserved by IANA [IANA-PN].  If
   a connection is set up by the client, the server answers immediately
   (without a request) with the greeting message, which will start with
   code 200:

   200 nas.fu-berlin.de ready

   If a connection is refused because the client has no permission to
   access the server, the answer code is 434. When the server is
   currently out of service, the answer code is 404.

    Examples:

   434 You have no permission to retrieve data. Good bye.
   404 Maintenance time

   After sending the 404 or 434 message the connection will be closed.


6.3.  Commands

6.3.1.  Structure

   A command consists of a command word, sometimes followed by a
   parameter. Parameters are separated from the command word by white
   space.

   Commands used in the NAS protocol are not case sensitive. A command
   word or parameter may be upper case, lower case, or any mixture of
   upper and lower case.

   The length of a command line is not limited.

   The protocol level described in this document uses command words with
   a length of exactly four characters each.

   In examples, octets sent to the NAS server are preceded by "<-- " and
   those sent by the NAS server by "--> ". The indicator is omitted if
   the direction of the dialog does not change.


6.3.2.  Overview

   The commands described below are defined using the Augmented Backus-
   Naur Form (ABNF) defined in [RFC2234]. The definitions for `ALPHA',
   `CRLF', `DIGIT', `WSP' and `VCHAR' are taken from appendix A of



Grau, Heinau, Schlichting                                       [Page 9]


Internet Draft       Netnews Administration System      January 28, 2000


   [RFC2234] and not repeated here.

   The following ABNF definitions comprise the set of NAS commands which
   can be sent from the client to an NAS server.

6.3.3.  Detailed Description

   Some overall definitions:

   text       = %d1-9 /           ; all octets except
                %d11-12 /         ; US-ASCII NUL, CR and LF
                %d14-255

   answertext = WSP *(ALPHA / DIGIT / "+"/ "-"/ "/"/ "_"/ "="/ "?"/ SP)

   endmark    = 1*32VCHAR
   utc-time   = 14*DIGIT  ; The date and time of the server in UTC
                          ; YYYYMMDDhhmmss

   Newsgroup names and hierarchy names are defined according to the
   following ABNF definitions. Since a hierarchy name can be the same as
   a newsgroup name (e.g., hierarchy bln.announce.fub.* and newsgroup
   name bln.announce.fub) there is no difference between the two.

   hierarchy-name      =  newsgroup-name ; these two are identical
   newsgroup-name      =  plain-component *( "." component )
   component           =  plain-component / encoded-word
   encoded-word        =  lowercase / DIGIT
                       =/ "+"/ "-"/ "/"/ "_"/ "="/ "?"
   plain-component     =  first-component-start component-rest
   first-component-start = lowercase
   component-start     =  lowercase / digit
   lowercase           =  %x61-7a ; letter a-z lowercase
   component-rest      =  component-start / "+"/ "-"/ "_"

NOTE: This definition of a newsgroup name is according to
son-of-1036-draft [SON1036]. When the current draft "News Article
Format" [USERFOR] is established as an RFC, it's definitions should be
integrated into a higher protocol level of NAS.

6.3.3.1.  HELP

   Description

   This command prints a short help text on a given command.  If called
   without parameters it will display a complete list of commands.

   help-cmd = "HELP" [ WSP Commandname ] CRLF



Grau, Heinau, Schlichting                                      [Page 10]


Internet Draft       Netnews Administration System      January 28, 2000


   Commandname =  "DATA" / "DATE" / "GETL" / "GETP" / "GETA"
               =/ "HELP" / "HIER" / "INFO" / "LIST" / "LSTR"
               =/ "QUIT" / "VERS"

   Possible answers

   100: Command overview, command description
   410: Indicates that the server is not giving any information

   help-answer =  *( "100" "-" [ text ] CRLF ) "100" [ " " text ] CRLF
               =/ *( "410" "-" [ text ] CRLF ) "410" [ " " text ] CRLF

   Examples

   <-- HELP
   --> 100-NAS server nas.fu-berlin.de, Version 1.0
       100-
       100-Supported commands:
       100-DATA - data for a newsgroup
       100-DATE - show time of server in UTC
       100-GETL - get list of hierarchy packages
       100-GETP - get package
       100-GETA - get data from an authoritative server
       100-HELP - show this help
       100-HIER - data for a hierarchy
       100-INFO - show info on current connection
       100-LIST - list newsgroups or hierarchies
       100-LSTR - recursive list newsgroups or hierarchies
       100-QUIT - close the connection
       100-VERS - show or set current protocol level
       100-
       100 Contact address nas@cis.fu-berlin.de

   <-- HELP LIST
   --> 100-LIST - list newsgroups or hierarchies
       100-Syntax: LIST hierarchy ...
       100-Get a list of newsgroups and sub-hierarchies
       100-directly under the parameter hierarchy
       100

   <-- HELP NOOP
   --> 410 unknown command "NOOP"


6.3.3.2.  INFO

   Description




Grau, Heinau, Schlichting                                      [Page 11]


Internet Draft       Netnews Administration System      January 28, 2000


   Prints information about the current connection, the server, and the
   client.

   info-cmd =  "INFO" CRLF

   Possible answers

   101: Normal answer, prints some information about client
        and Server
   400: Indicates that the server is not giving any information

   info-answer =  *( "101" "-" text CRLF ) "101" [ WSP text ] CRLF
               =/ *( "400" "-" text CRLF ) "400" [ WSP text ] CRLF

   Examples

   <-- INFO
   --> 101-Server: nas.fu-berlin.de (160.45.11.141)
       101-Uptime: 2 weeks, 3 days, 5 hours, 9 minutes
       101-Software: NAS 1.0
       101-Client: waran.cis.fu-berlin.de (160.45.11.136)
       101-Connection: 9 minutes
       101-Highest protocol level supported: 1
       101-Requested protocol level: 1
       101-Protocol level used: 1
       101-
       101 End

   <-- INFO
   --> 400 No information available.


6.3.3.3.  DATE

   Description

   Prints the actual time of the server in UTC (Universal Coordinated
   Time) in the format YYYYMMDDhhmmss, followed by an optional comment.
   The DATE command is only for informational use and to control the
   server time. The NTP protocol [RFC1305] should be used for the
   transmission of time over the network.

   date-cmd =  "DATE" CRLF

   Possible answers

   300: Print the UTC time in specified format, see below
   511: Error, print an error message



Grau, Heinau, Schlichting                                      [Page 12]


Internet Draft       Netnews Administration System      January 28, 2000


   date-answer =  "300" WSP utc-time [ answertext ] CRLF
               =/ *( "511" "-" [ text ] CRLF ) "511" [ " " text ] CRLF

   Examples

   <-- DATE
   --> 300 19990427135230 UTC

   <-- DATE
   --> 511 Time is unknown


6.3.3.4.  VERS

   Description

   The VERS command is used to determine the protocol level used between
   client and server. The parameter is a protocol level which the client
   supports and wants to use. The server will respond with the highest
   level that will be accepted. That version number must not be higher
   than requested by the client. Client and server must only use
   commands from the level that the server has confirmed. It is
   possible, but seldom necessary, to change the protocol level during a
   session by client request (VERS [protocol level]). When no option is
   given, the current protocol level will be printed. When no protocol
   level is negotiated, the protocol level 1 will be used. Commands of a
   higher level are not allowed without a successful negotiation. The
   protocol level can be followed by an optional comment.

   vers-cmd =  "VERS" [ WSP level ] CRLF

   level = 1*5DIGIT ; the valid range is 1 - 32767

   Possible answers

   202: Returns current protocol level
   302: Answer to an successful request
   402: Requested level too high, falling back to lower level
   510: Syntax error

   vers-answer =  "202" WSP level [ answertext ] CRLF
               =/ "302" WSP level [ answertext ] WSP level CRLF
               =/ "402" WSP level [ answertext ] WSP level CRLF
               =/ "510" WSP level [ answertext ] CRLF

   Examples

   <-- VERS



Grau, Heinau, Schlichting                                      [Page 13]


Internet Draft       Netnews Administration System      January 28, 2000


   --> 202 2 Current protocol level is 2

   <-- VERS 2
   --> 302 2 My max protocol level is 10

   <-- VERS 11
   --> 402 10 Falling back to level 10

   <-- VERS BAL
   --> 510 1 Syntax error


6.3.3.5.  QUIT

   Description

   Terminates the connection.

   quit-cmd =  "QUIT" CRLF

   Possible answers

   201: Termination of the connection

   quit-answer = "201" [ answertext ] CRLF

   Examples

   <-- QUIT
   --> 201 Closing connection. Bye.


6.3.3.6.  LIST

   Description

   To obtain a list of newsgroups and sub-hierarchies in the requested
   hierarchies the command LIST is used. The status of the hierarchies
   is also given. The highest level consists of all top-level
   hierarchies and is labeled "0" (zero). It can be obtained this way,
   too.

   After the response code 610 follow white space and the end mark. The
   last line of the data stream must begin with the end mark. The end
   mark will be checked case insensitive. Comments after the separating
   white space are allowed.

   The data consist of a newsgroup- or hierarchy-name/status indicator



Grau, Heinau, Schlichting                                      [Page 14]


Internet Draft       Netnews Administration System      January 28, 2000


   pair per line. Name and status indicator must be separated by at
   least one white space. The status indicator is one letter (see
   section 6.3.5). The interpretation is not case sensitive.

   list-cmd =  "LIST" 1*(WSP hierarchy-name) CRLF

   Possible answers

   401: Permission denied
   530: The parameter "hierarchy" is missing
   610: Regular answer with all requested data

   list-answer =  "610" WSP endmark [ answertext ] CRLF
                  *( listdata CRLF )
                  endmark [ answertext ] CRLF
               =/ *( "401" "-" [ text ] CRLF ) "401" [ " " text ] CRLF
               =/ *( "530" "-" [ text ] CRLF ) "530" [ " " text ] CRLF

   listdata    =  newsgroup-name WSP list-status CRLF

   The list-status is the status of a newsgroup or hierarchy according
   to section 6.3.5.

   list-status =  "A" / "H" / "O" / "Y" / "M" / "U" / "N" / "X" / "I"
                  ; these are also valid in lower case characters

   Examples

   <-- LIST 0
   --> 610 .. data follow
       alt A
       bln H
       comp H
       de H
       rec H
       sub O
       ..

   <-- LIST de
   --> 610 .. data follow
       de.admin H
       de.alt A
       de.comm H
       de.comp H
       de.etc H
       de.markt H
       de.newusers H
       de.org H



Grau, Heinau, Schlichting                                      [Page 15]


Internet Draft       Netnews Administration System      January 28, 2000


       de.rec H
       de.sci H
       de.soc H
       de.talk H
       de.answers M
       de.test Y
       ..

   <-- LIST foo
   --> 610 .. data follow
       foo U
       ..

   <-- LIST
   --> 530 missing parameter hierarchy

   <-- LIST de
   --> 401 Permission denied


6.3.3.7.  LSTR

   Description

   To obtain a recursive list of newsgroups and sub-hierarchies in the
   named hierarchy the command LSTR is used. The status of the
   hierarchies is also given. The highest level consists of all top-
   level hierarchies and is labeled "0" (zero). It can be obtained this
   way, too. Only a recursive listing of all hierarchies with the status
   indicator "H" and "A" set will be listed, see section 6.3.5.

   lstr-cmd = "LSTR" ( "0" | 1*(WSP hierarchy-name)) CRLF

   Possible answers

   401: Permission denied
   530: The parameter "hierarchy" is missing
   610: Regular answer with all requested data

   lstr-answer =  "610" WSP endmark [ answertext ] CRLF
                  *( listdata CRLF )
                  endmark [ answertext ] CRLF
               =/ *( "401" "-" [ text ] CRLF ) "401" [ " " text ] CRLF
               =/ *( "530" "-" [ text ] CRLF ) "530" [ " " text ] CRLF

   listdata    =  newsgroup-name WSP list-status CRLF

   Examples



Grau, Heinau, Schlichting                                      [Page 16]


Internet Draft       Netnews Administration System      January 28, 2000


   <-- LSTR de.admin
   --> 610 .. recursive mode
       de.admin H
       de.admin.archiv Y
       de.admin.infos M
       de.admin.lists M
       de.admin.misc Y
       de.admin.net-abuse H
       de.admin.net-abuse.announce M
       de.admin.net-abuse.mail Y
       de.admin.net-abuse.misc Y
       de.admin.net-abuse.news Y
       de.admin.news H
       de.admin.news.announce M
       de.admin.news.groups Y
       de.admin.news.misc Y
       de.admin.news.nocem Y
       de.admin.news.regeln Y
       de.admin.submaps M
       ..


6.3.3.8.  HIER

   Description

   The command HIER lists all available information about the hierarchy.
   The data block starts with the data code (0-32767, decimal) followed
   by white space or a dash. The dash indicates multiple entries of the
   same data code that belong together (e.g. data codes 81,82) where the
   entry has multiple lines. The last data line must have white space
   after the data code. When a data code is repeatable and has more then
   one entry (not multiple lines), there is no dash. With data code "0"
   (Zero) a new data block for another hierarchy is started. Code "0"
   gives the name of the hierarchy. The data codes are described in
   section 6.3.4.

   hier-cmd =  "HIER" [ WSP range ] 1*( WSP hierarchy-name) CRLF

   range    = [ "-" ] 1*2DIGIT *((( "," / " ") / "-") 1*2DIGIT)
                   ; Describes the range of data codes that are
                   ; requested

   Examples for range

    -30    : list all entries up to and including data code 30
    0-20   : list all from 0 to 20
    0,1,30 : list 0,1 and 30



Grau, Heinau, Schlichting                                      [Page 17]


Internet Draft       Netnews Administration System      January 28, 2000


    0 50   : list 0 and 50

   Possible answers

   401: Permission denied
   530: Missing parameter
   611: Regular answer with all requested data

   hier-answer =  "611" WSP endmark [ answertext ] CRLF
                  *( hierdata CRLF )
                  endmark [ answertext ] CRLF
               =/ *( "530" "-" [ text ] CRLF ) "530" [ " " text ] CRLF
               =/ *( "401" "-" [ text ] CRLF ) "401" [ " " text ] CRLF

   hierdata    =  2*( *( datacode "-" text CRLF ) datacode WSP text)

   datacode    =  1*6DIGIT ; datacode must be less than 32768
                           ; see section 6.3.4
   Examples

   <-- HIER de
   --> 611 .. Data coming
       0 de
       1 H
       10 Internationale deutschsprachige Newsgruppen
       21 http://www.dana.de/de/netiquette.html
       22 http://www.dana.de/de/neue-de-gruppe.html
       30 moderator@dana.de
       32 de.admin.news.announce
       33 %s@moderators.dana.de
       40 DE
       41 ISO-8859-1
       43 text/plain
       50 D
       51 I
       60 14
       70 199210060000
       ..

   <-- HIER bln
   --> 401 Permission denied

   <-- HIER
   --> 530 missing parameter hierarchy







Grau, Heinau, Schlichting                                      [Page 18]


Internet Draft       Netnews Administration System      January 28, 2000


6.3.3.9.  DATA

   Description

   The DATA command corresponds to the HIER command, but it is used for
   information about a newsgroup. A summary of codes can be found in
   section 6.3.4

   data-cmd =  "DATA" [ WSP range ] 1*( WSP newsgroup-name ) CRLF

   Possible answers

   401: Permission denied
   530: Missing parameter
   612: Regular answer with all requested data

   data-answer =  "612" WSP endmark CRLF
                  *( datadata CRLF )
                  endmark CRLF
               =/  *( "530" "-" [ text ] CRLF ) "530" [ " " text ] CRLF
               =/  *( "401" "-" [ text ] CRLF ) "401" [ " " text ] CRLF

   datadata    =  2*( *( datacode "-" text CRLF ) datacode WSP text)

   Examples

   <-- DATA de.comp.os.unix.linux.moderated
   --> 612 .. data follow
       0 de.comp.os.unix.linux.moderated
       1 M
       10 Linux und -Distributionen. <dcoulm-moderators@linux-config.de>
       20 http://www.dana.de/mod/chartas/de.comp.html#de.comp.
                                           os.unix.linux.moderated
       21 http://www.dana.de/de/netiquette.html
       21 ftp://ftp.fu-berlin.de/doc/usenet/german/netiquette.gz
       34 dcoulm-moderators@linux-config.de
       36 http://wpxx02.toxi.uni-wuerzburg.de/~dcoulmod/
       50 d
       ..

   <-- DATA de.foo
   --> 612 .. data follow
       0 de.foo
       1 I
       ..

   <-- DATA de
   --> 401 Permission denied



Grau, Heinau, Schlichting                                      [Page 19]


Internet Draft       Netnews Administration System      January 28, 2000


   <-- DATA
   --> 530 missing parameter newsgroup


6.3.3.10.  GETL

   Description

   The GETL command is intended for the server-server communication; it
   will request the list of packages that a server is offering. A
   package is the complete information available for a hierarchy or
   newsgroup. I.e. all entries that have a value including PGP keys. The
   format of the data is the same as for the commands "HIER" and "LIST".

   The server will send a list of available and distributable hierarchy
   packages.

   getl-cmd =  "GETL" CRLF

   Possible answers

   401: Permission denied
   614: Lists all packages a server is authoritative for

   getl-answer =  "614" WSP endmark CRLF
                  *( getldata CRLF)
                  endmark CRLF
               =/ *( "401" "-" [ text ] CRLF ) "401" [ " " text ] CRLF


   getldata    = *( newsgroup-name CRLF )

   Examples

   <-- GETL
   --> 614 .. data follow
       de
       ..

   <-- GETL
   --> 614 .. data follow
       de
       hk
       comp
       rec
       [...]
       bln
       ..



Grau, Heinau, Schlichting                                      [Page 20]


Internet Draft       Netnews Administration System      January 28, 2000


6.3.3.11.  GETP

   Description

   GETP requests the packages specified by the parameter "Package". If
   "0" is given as package name, all data the server is offering will be
   transmitted. The "serial" is the date and time the package was last
   obtained by the client, so the server can check if the data on the
   client side is still valid or if it is too old. If the data on the
   client side is still valid a 213 answer is sent, so the client knows
   that his data is ok. If the serial is "0", the server is forced to
   transmit the data.

   The data for a successful request are sent in ASCII armor according
   to [RFC2440], so a client has the possibility to check the signature
   or to ignore it. The actual data will be surrounded by an indicator
   which indicates the signing method, the beginning mark, and the end
   mark. These specifications will be included in the signed text block.

   getp-cmd =  "GETP" WSP password WSP serial
               WSP ( "0" / *[ WSP hierarchy-name ] ) CRLF

   password =  *VCHAR / "0"

   serial   =  utc-time ; date and time of the last retrieval
            =/ "0"      ; force the transmission of data

   Possible answers

   213: Valid data at the client side
   411: No package with that name
   430: Permission denied
   530: Missing parameter
   613: Package data

   getp-answer =  "613" WSP endmark CRLF
                  pgp-start-mark ; this is according to [RFC2440]
                  "GETP" WSP "SIGN" WSP method CRLF
                  "GETP" WSP "BEGIN" CRLF
                  *( getpdata CRLF)
                  "GETP" WSP "END" CRLF
                  pgp-end-mark ; this is according to [RFC2440]
                  endmark CRLF
               =/ "213" [ answertext ] CRLF
               =/ *( "430" "-" [ text ] CRLF ) "430" [ " " text ] CRLF
               =/ *( "411" "-" [ text ] CRLF ) "411" [ " " text ] CRLF
               =/ *( "530" "-" [ text ] CRLF ) "530" [ " " text ] CRLF




Grau, Heinau, Schlichting                                      [Page 21]


Internet Draft       Netnews Administration System      January 28, 2000


   Currently the following methods are supported:

   method      =  "PGP2" / "PGP5" / "GPG"
                  ; PGP version 2, PGP version 5 and GnuPG

   pgp-start-mark and the pgp-end-mark are build according to [RFC2440]
   Section 6.2. "Forming ASCII Armor".

   geta-data = 2*( *( datacode "-" text CRLF ) datacode WSP text)

   Examples

   <-- GETP 0 0 humanities
   --> 613 .. data follow
       -----BEGIN PGP SIGNED MESSAGE-----

       GETP SIGN PGP2
       GETP BEGIN
       0 humanities
       1 H
       10-branches of learning that investigate human constructs and
       10 concerns as opposed to natural processes
       21 ftp://rtfm.mit.edu/pub/usenet/news.announce.newusers/
                       A_Primer_on_How_to_Work_With_the_Usenet_Community
       23 http://www.uvv.org/formus/big8creation.htm
       30 group-admin@isc.org
       33 news.announce.newgroup
       40 EN
       41 US-ASCII
       42 text/plain
       50 D
       51 I
       61 14
       70 19950417143009
       0  humanities.answers
       1  M
       10 Repository for periodic USENET articles. (Moderated)
       34 news-answers@mit.edu
       35 news-answers-request@mit.edu
       50 A
       70 19950725182040
       0 humanities.classics
       [...]
       GETP END


       -----BEGIN PGP SIGNATURE-----
       Version: 2.6.3in



Grau, Heinau, Schlichting                                      [Page 22]


Internet Draft       Netnews Administration System      January 28, 2000


       Charset: noconv

       iQCVAwUBOBhmWTiii3auEmclAQEM9wP9FVem1VXYrywFa2FLEh1apsay9yJC9jKT
       V80U1M1LAKkR+xkXZdczd/PIGEAQapauKjINpxFOgynMWd8A2Ta0y4s4ZXHgEiZP
       A/tKaMGi/7roZwUp8ERQRBsvc54kckgnX57HiVUgsbVd41FHPTvsVLv/QIHmqaGd
       fR5aQJfwKhE=
       =Sg4p
       -----END PGP SIGNATURE-----
       ..

   <-- GETP 0 1999090091010 de
   --> 213 You are uptodate

   <-- GETP foo
   --> 411 no packages with that name

   <-- GETP test 0 de
   --> 430-You have no permission to retrieve the data
       430 Cause: Wrong IP number


6.3.3.12.  GETA

   Description

   The GETA command is used for the server-server communication; it will
   request packages that the server is authoritative for. A package is
   the authoritative data either for a newsgroup or a hierarchy. Each
   package has a serial number attached to control the age of the
   package.  Serial is a number that is the date in UTC format of the
   last known modification of the package. A serial of "0" indicates
   that the package MUST be retrieved. If the retrieving client has a
   recent package (i.e. no modification on the authoritative server) the
   server sends only a 215 response.  The format of the data is the same
   as for the commands "HIER" and "LIST".

   geta-cmd =  "GETA" WSP password WSP serial WSP hierarchy-name CRLF

   password =  *VCHAR / "0"

   Possible answers

   215: The client already has the current data
   430: Permission denied
   411: No package with that name
   530: Missing parameter
   615: Regular answer with all requested data




Grau, Heinau, Schlichting                                      [Page 23]


Internet Draft       Netnews Administration System      January 28, 2000


   geta-answer =  "615" WSP endmark CRLF
                  pgp-start-mark ; this is according to [RFC2440]
                  "GETA" WSP "SIGN" WSP method CRLF
                  "GETA" WSP "BEGIN" CRLF
                  *( getadata CRLF)
                  "GETA" WSP "END" CRLF
                  pgp-end-mark ; this is according to [RFC2440]
                  endmark CRLF
               =/ "215" [ answertext ] CRLF
               =/ *( "430" "-" [ text ] CRLF ) "430" [ " " text ] CRLF
               =/ *( "411" "-" [ text ] CRLF ) "411" [ " " text ] CRLF
               =/ *( "530" "-" [ text ] CRLF ) "530" [ " " text ] CRLF

   geta-data = 2*( *( datacode "-" text CRLF ) datacode WSP text)

   Examples

   <-- GETA 0 0 humanities
   --> 613 .. data follow
       -----BEGIN PGP SIGNED MESSAGE-----

       GETA SIGN PGP2
       GETA BEGIN
       0 humanities
       1 H
       10-the branches of learning that investigate human constructs and
       10 concerns as opposed to natural processes
       21 ftp://rtfm.mit.edu/pub/usenet/news.announce.newusers/
                       A_Primer_on_How_to_Work_With_the_Usenet_Community
       23 http://www.uvv.org/formus/big8creation.htm
       30 group-admin@isc.org
       33 news.announce.newgroup
       40 EN
       41 US-ASCII
       42 text/plain
       50 D
       51 I
       61 14
       70 19950417143009
       0  humanities.answers
       1  M
       10 Repository for periodic USENET articles. (Moderated)
       34 news-answers@mit.edu
       35 news-answers-request@mit.edu
       50 A
       70 19950725182040
       0 humanities.classics
       [...]



Grau, Heinau, Schlichting                                      [Page 24]


Internet Draft       Netnews Administration System      January 28, 2000


       GETA END


       -----BEGIN PGP SIGNATURE-----
       Version: 2.6.3in
       Charset: noconv

       iQCVAwUBOBhmWTiii3auEmclAQEM9wP9FVem1VXYrywFa2FLEh1apsay9yJC9jKT
       V80U1M1LAKkR+xkXZdczd/PIGEAQapauKjINpxFOgynMWd8A2Ta0y4s4ZXHgEiZP
       A/tKaMGi/7roZwUp8ERQRBsvc54kckgnX57HiVUgsbVd41FHPTvsVLv/QIHmqaGd
       fR5aQJfwKhE=
       =Sg4p
       -----END PGP SIGNATURE-----
       ..


6.3.3.13.  Unknown Commands and Syntax Errors

   If a command is recognized as unknown, it MUST be ignored. If an
   error occurs after the command string (e.g. a missing parameter) a
   530 return code is given.

6.3.4.  Data codes for the commands DATA and HIER

6.3.4.1.  Description

   The following descriptions are keywords and key terms, which support
   retrieval and storing of information.  Every data code has a unique
   decimal number and a unique English code name.

   The content of a data code is inheritable within a hierarchy, as long
   as the data code is marked as inheritable. The content is the default
   value for all downstream newsgroups and sub-hierarchies. For example
   in the hierarchy "de" the language code has a value of "DE" (German),
   therefore this value is true for all newsgroups in this hierarchy,
   except those who explicitly define a language code of their own.

   Hierarchies and newsgroups must at least have values for the data
   codes "0" (Name) and "1" (Status). Unknown hierarchies get the status
   "U" and unknown groups get the status "I".

   Code 0 - Name (Mandatory)

   Code:        0
   Name:        name

   Used for:    hierarchy
   Inheritable: no



Grau, Heinau, Schlichting                                      [Page 25]


Internet Draft       Netnews Administration System      January 28, 2000


   Repeatable:  no
   Description: Name of a hierarchy
   Comment:     Start of a new data block
   Example:     0 comp

   Used for:    newsgroup
   Repeatable:  no
   Description: Name of a newsgroup
   Comment:     Start of a new data block
   Example:     0 de.admin.news.announce


   Code 1 - Status (Mandatory)

   Code:        1
   Name:        status

   Used for:    hierarchy
   Inheritable: no
   Repeatable:  no
   Description: Status of a hierarchy
   Comment:     For a detailed description see section 6.3.5
   Example:     1 H

   Used for:    newsgroup
   Repeatable:  no
   Description: Status of a newsgroup
   Comment:     For a detailed description see section 6.3.5
   Example:     1 M


   Code 2 - Group for followup

   Code:        2
   Name:        followup

   Used for:    newsgroup
   Repeatable:  no
   Description: Name of the newsgroup, that will take the followup
                postings of a moderated group.
   Comment:     The value can be used as default value for the
                "Followup-To:" header on postings to a moderated group.
                This value is only useful on groups which are moderated
                (Status M) and have a dedicated discussion group.
   Example:     2 bln.announce.fub.zedat.d
                (for the moderated group bln.announce.fub.zedat)





Grau, Heinau, Schlichting                                      [Page 26]


Internet Draft       Netnews Administration System      January 28, 2000


   Code 10 - Short description

   Code:        10
   Name:        description

   Used for:    hierarchy
   Inheritable: no
   Repeatable:  no
   Description: Short description of a hierarchy
   Example:     10 Angelegenheiten, die den Grossraum Berlin betreffen
                (for the hierarchy bln)

   Used for:    newsgroup
   Repeatable:  no
   Description: Short description of a newsgroup
   Comment:     This information is often presented to the news reader
                upon selection of the newsgroup, and it should describe
                the topics in brief, but meaningful.
   Example:     10 Technisches zur Newssoftware
                (for de.admin.news.software)


   Code 20 - Charter-URL

   Code:        20
   Name:        charter

   Used for:    hierarchy
   Inheritable: no
   Repeatable:  yes
   Description: URL that points to the charter of a hierarchy
   Example:     20 ftp://ftp.fu-berlin.de/doc/news/bln/bln
                (for the hierarchy bln)

   Used for:    newsgroup
   Repeatable:  yes
   Description: URL that points to the charter of a newsgroup
   Comment:     This information should be presented to the
                news reader upon selection of the newsgroup.
   Example:     20 http://www.dana.de/mod/charta/admin.html


   Code 21 - Netiquette-URL

   Code:        21
   Name:        netiquette

   Used for:    hierarchy



Grau, Heinau, Schlichting                                      [Page 27]


Internet Draft       Netnews Administration System      January 28, 2000


   Inheritable: yes
   Repeatable:  yes
   Description: URL that points to the netiquette of a hierarchy.
   Comment:     Since the netiquettes are often valid for
                a complete hierarchy this is inheritable.
   Example:     21 http://www.dana.de/mod/netiquette.html

   Used for:    newsgroup
   Repeatable:  yes
   Description: URL for Netiquette
   Comment:     If a group has some special rules, this is the
                pointer to these rules.
   Example:     21 http://research.de.uu.net:8080/de.sci.announce/faq
                (for de.sci.announce)


   Code 22 - Frequently Asked Questions (FAQ)

   Code:        22
   Name:        faq

   Used for:    Newsgroup
   Repeatable:  yes
   Description: URL for the FAQ of a newsgroup
   Example:     22 http://www2.informatik.uni-wuerzburg.de/dclc-faq/
                (for de.comp.lang.c)


   Code 23 - Administration rules

   Code:        23
   Name:        rules

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: URL pointing to a document that describes the rules for
                creating, deleting or renaming newsgroups in this
                hierarchy.
   Comment:     Normally inherited from the (toplevel)
                hierarchy
   Example:     23 http://www.dana.de/mod/einrichtung.html
                (for the hierarchy de)


   Code 30 - Control Email

   Code:        30



Grau, Heinau, Schlichting                                      [Page 28]


Internet Draft       Netnews Administration System      January 28, 2000


   Name:        ctl_send_adr

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: Email address of the sender of control messages
   Comment:     Multiple addresses are valid
   Example:     30 group-admin@isc.org
                (for the hierarchy sci)


   Code 32 - Control newsgroup

   Code:        32
   Name:        ctl_newsgroup

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: Name of the newsgroup that will get the postings for
                checkgroups, rmgroup and newsgroup control messages.
   Example:     32 de.admin.news.groups


   Code 33 - Moderators

   Code:        33
   Name:        mod_wildcard

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  no
   Description: Moderator wildcard for this hierarchy.
   Comment:     This information can be used by the configuration of the
                news system, for example the moderators file in INN.
   Example:     33 %s@moderators.dana.de
                (for the hierarchy de)


   Code 34 - Submission address

   Code:        34
   Name:        mod_sub_adr

   Used for:    newsgroup
   Repeatable:  yes
   Description: Email address for submissions to the newsgroup.
   Comment:     If there is no code 34 for a moderated newsgroup,



Grau, Heinau, Schlichting                                      [Page 29]


Internet Draft       Netnews Administration System      January 28, 2000


                code 33 of the hierarchy is used. Code 34 is only
                useful for moderated groups (Status M).
   Example:     34 news-answers@mit.edu
                (for the newsgroup news.answers)


   Code 35 - Moderator's address (email)

   Code:        35
   Name:        mod_adm_adr

   Used for:    newsgroup
   Repeatable:  yes
   Description: Email address of the moderator for the newsgroup.
   Comment:     If there is no code 35 for a moderated newsgroup,
                code 33 of the hierarchy is used. Code 35 is only
                useful for moderated groups (Status M).
   Example:     35 news-answers-request@mit.edu
                (for the newsgroup news.answers)


   Code 36 - Info-URL

   Code:        36
   Name:        mod_group_info

   Used for:    newsgroup
   Repeatable:  yes
   Description: URL that points to a document, where the moderator
                presents information about the newsgroup and the
                submission of articles.
   Example:     http://www.cs.helsinki.fi/u/mjrauhal/linux
                                                       /cola-submit.html
                (for comp.os.linux.announce)


   Code 40 - Language

   Code:        40
   Name:        language

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: The language that will normally be used in postings
   Comment:     The notation is according to [RFC1766], the
                "Content-Language" field.  The languages that are not
                the preferred language are enclosed in parenthesis.



Grau, Heinau, Schlichting                                      [Page 30]


Internet Draft       Netnews Administration System      January 28, 2000


   Example:     40 DE
                (for the hierarchy de)

   Used for:    newsgroup
   Repeatable:  yes
   Description: The language that will normally be used in postings.
   Comment:     The notation is according to [RFC1766], the
                "Content-Language" field. The languages that are not
                the preferred language are enclosed in parenthesis.
   Example:     40 TR
                40 DE
                40 (EN)
                (for the newsgroup bln.kultur.tuerkisch)


   Code 41 - Charset

   Code:        41
   Name:        charset

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: Charset that will normally be used in postings in this
                hierarchy.
   Comment:     The complete set of charset names is defined by
                [RFC2277] and the IANA Character Set registry [IANA-CS].
                The charsets that are not the preferred charsets are
                enclosed in parenthesis.
   Example:     41 ISO-8859-1
                (for the hierarchy de)

   Used for:    newsgroup
   Repeatable:  yes
   Description: Charset that will normally be used in
                postings in this group.
   Comment:     The complete set of charset names is defined by
                [RFC2277] and the IANA Character Set registry
                [IANA-CS]. The charsets that are not the preferred
                charsets are enclosed in parenthesis.
   Example:     41 ISO-8859-9
                41 ISO-8859-1
                (for the newsgroup bln.kultur.tuerkisch)

   Code 42 - Encoding

   Code:        42
   Name:        encoding



Grau, Heinau, Schlichting                                      [Page 31]


Internet Draft       Netnews Administration System      January 28, 2000


   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: Encoding for this hierarchy according to MIME [RFC2045]
   Comment:     This is the media type used in this hierarchy, a list of
                registered media types can be found at [IANA-MT]. The
                encodings that are not the preferred encoding are
                enclosed in parenthesis.
   Example:     42 text/plain

   Used for:    newsgroup
   Repeatable:  yes
   Description: Encoding for this newsgroup according to MIME [RFC2045]
   Comment      This is the media type used in this newsgroup, a list of
                registered media types can be found at [IANA-MT]. The
                encodings that are not the preferred encoding are
                enclosed in parenthesis.
   Example:     42 text/plain


   Code 50 - Type of newsgroup

   Code:        50
   Name:        ng_type

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: Default newsgroup type in this hierarchy
   Comment:     This code has no concrete meaning for a hierarchy, but
                is used for the inheritance to newsgroups in the
                hierarchy.
                Specification of the types can be found in section 6.3.6
   Example:     50 D
                (for the hierarchy de)

   Used for:    newsgroup
   Repeatable:  yes
   Description: Type of newsgroup
   Comment:     Specification of the types can be found in section 6.3.6
   Example:     50 A
                (for de.admin.news.announce)


   Code 51 - Type of hierarchy

   Code:        51
   Name:        hier_type



Grau, Heinau, Schlichting                                      [Page 32]


Internet Draft       Netnews Administration System      January 28, 2000


   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: Type of hierarchy
   Comment:     Specification of the types can be found in section 6.3.7
   Example:     51 R
                (for hierarchy bln)


   Code 52 - Regional or organizational area

   Code:        52
   Name:        area

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: Description of the geographical region or organization
                of this hierarchy
   Comment:     This code is useful when the hierarchy type
                (51, hier_type) is R or O.
   Example:     52 Grossraum Berlin
                (for the hierarchy bln)


   Code 60 - Name length of group names

   Code:        60
   Name:        name_length

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  no
   Description: Maximum length of a newsgroup name
   Example:     60 72
                (for the hierarchy bln)


   Code 61 - Component length of group names

   Code:        61
   Name:        comp_length

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  no
   Description: Maximum length of a single component in the newsgroup
                name



Grau, Heinau, Schlichting                                      [Page 33]


Internet Draft       Netnews Administration System      January 28, 2000


   Example:     61 14
                (for the hierarchy de)


   Code 62 - Article length

   Code:        62
   Name:        article_length

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  no
   Description: Maximum length of an article in bytes.
   Comment:     This code has no concrete meaning for a hierarchy, but
                is used for the inheritance to newsgroups in the
                hierarchy.
   Example:     62 50000

   Used for:    newsgroup
   Repeatable:  no
   Description: Maximum length of an article in bytes
   Example:     62 50000


   Code 70 - Date of creation

   Code:        70
   Name:        date_create

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  no
   Description: Creation date of a hierarchy (can even be in future).
   Comment:     The format is the same as in the DATE command.
   Example:     70 19970330101514

   Used for:    newsgroup
   Repeatable:  no
   Description: Creation date of a newsgroup (can even be in future).
   Comment:     The format is the same as in the DATE command.
   Example:     70 19970330101514


   Code 71 - Date of removal

   Code:        71
   Name:        date_delete




Grau, Heinau, Schlichting                                      [Page 34]


Internet Draft       Netnews Administration System      January 28, 2000


   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  no
   Description: Date of removal of a hierarchy (can even be in future).
   Comment:     The format is the same as in the DATE command.
   Example:     71 19970330101514

   Used for:    newsgroup
   Repeatable:  no
   Description: Date of removal of a newsgroup (can even be in future).
   Comment:     The format is the same as in the DATE command.
   Example:     71 19970330101514


   Code 72 - Successor

   Code:        72
   Name:        replacement

   Used for:    hierarchy
   Inheritable: no
   Repeatable:  yes
   Description: Name of the hierarchy that replaced a removed hierarchy
                if status is O or will replace a hierarchy if the date
                of removal is in the future.
   Example:     72 de
                (for the hierarchy sub)

   Used for:    newsgroup
   Repeatable:  yes
   Description: Name of the newsgroup or newsgroups that will replace a
                removed newsgroup if status is X or will replace the
                newsgroup if the date of removal is in the future.
   Example:     72 bln.markt.arbeit
                (for bln.jobs)

   Code 81 - Control PGP key

   Code:        81
   Name:        ctl_pgp_key

   Used for:    hierarchy
   Inheritable: yes
   Repeatable:  yes
   Description: PGP key (with additional information: key owner, key-id,
                etc.) of the sender of control messages in this
                hierarchy.
   Comment:     This field is only printed if the attribute range



Grau, Heinau, Schlichting                                      [Page 35]


Internet Draft       Netnews Administration System      January 28, 2000


                contains the "81". The exact format is described in
                section 6.3.8.
   Example:     81-U de.admin.news.announce
                81-B 1024
                81-I D3033C99
                81-L http://www.dana.de/mod/pgp/dana.asc
                81-L ftp://ftp.fu-berlin.de/unix/news/pgpcontrol
                                                             /PGPKEYS.gz
                81-F 5B B0 52 88 BF 55 19 4F  66 7D C2 AE 16 26 28 25
                81-V 2.6.3ia
                81-K------BEGIN PGP PUBLIC KEY BLOCK-----
                81-K-Version: 2.6.3ia
                81-K-
                81-K-mQCNEALZ+Xfm/WDCEMXM48gK1PlKG6TkV3SLbXt4CnzpGM0tOMa
                81-K-HjlHqM1wEGUHD5hw/BL/heR5Tq+C5IEyXQQmYwkrgeVFMOz/rAQ
                [...]
                81-K-SDw+iQgAAtN6zrYOhHFBp+68h9k674Yg9IHqj3BWdRjJF6tPKoa
                81-K-VpvRovMz+lSOy9Zcsbs+5t8Pj9ZVAQyfxBkqD5A=
                81-K-=Xwgc
                81 K -----END PGP PUBLIC KEY BLOCK-----


   Code 82 - Moderator's PGP key

   Code:        82
   Name:        mod_pgp_key

   Used for:    newsgroup
   Repeatable:  yes
   Description: Public PGP key (with additional information: key owner,
                key-id, etc) of this newsgroup's moderator.
   Comment:     This field is only printed if the attribute range
                contains the "82". The exact format is described in
                section 6.3.8
   Example:     see section 6.3.8


6.3.5.  Status Indicators

   The status indicator is used as a unique indicator of the status of a
   hierarchy or newsgroup. The indicator is case-insensitive.

   Indicator  Type       Description
   ---------  ---------  -------------------------------------------
    H         hierarchy  authorized, complete known hierarchy
    A         hierarchy  not completely known hierarchy
    O         hierarchy  obsolete hierarchy, should contain
                         only newsgroups with status X



Grau, Heinau, Schlichting                                      [Page 36]


Internet Draft       Netnews Administration System      January 28, 2000


    U         hierarchy  no information available, unknown hierarchy
    Y         newsgroup  posting allowed, unmoderated
    N         newsgroup  posting not allowed
    M         newsgroup  moderated group, articles must be sent to
                         the moderator
    X         newsgroup  deleted or renamed newsgroup, no posting
                         or transport
    I         newsgroup  unknown group, no information available



6.3.6.  Newsgroup Types

   A comprehensive overview about some characteristics of a newsgroup,
   being a test group, a binary group and so on. The indicator is case-
   insensitive.

   Code  Use of a newsgroup
   ----  ----------------------------------------------------
    D    discussion (text postings)
    B    (encoded) binary postings
    S    source postings (e.g., comp.unix.sources)
    A    announcements, press releases, RfD/CfV
    T    test postings, sometimes reflectors (e.g., de.test)
    R    automatic postings (e.g., comp.mail.maps)
    X    experimental, other



6.3.7.  Hierarchy Types

   To describe a hierarchy the following codes are used. These flags are
   used to mark some properties of a news hierarchy.  The indicator is
   case-insensitive.

   Code  Type of hierarchy
   ----  --------------------------------------------------------
    I    international, global hierarchy
         (e.g., the hierarchies comp, de, rec)
    R    regional hierarchy
    A    alternative hierarchy, simpler rules for
         creating a group, no formal structure
         (e.g., the hierarchy alt)
    P    only for personal use, commercial use is prohibited
         (e.g., the hierarchy de)
    C    commercial use permitted
         (e.g., the hierarchy biz)
    O    hierarchy bound to an organization



Grau, Heinau, Schlichting                                      [Page 37]


Internet Draft       Netnews Administration System      January 28, 2000


         (e.g., the hierarchy gnu) letter "O" not zero


6.3.8.  PGP Keys

   PGP keys for ctrl_pgp_key and mod_pgp_key are transmitted in the
   following structure:

   Code  Mandatory  Description
   ----  ---------  ----------------------------------------------
    K      yes      public key block in ASCII armor format RFC2440
    V      yes      PGP-Version
    U      no       key user id
    B      no       number of bits
    I      no       key id, without leading "0x"
    F      no       fingerprint
    L      no       URL that points to the public key

   A hyphen following the code indicates that the block is continued on
   the next line. In the last message row there must be white space
   after the code, this is also true for a single line code.

    Example

   <-- HIER -81 de
   --> 611 ..
       0 de
       1 H
       [...]
       81-U de.admin.news.announce
       81-B 1024
       81-I D3033C99
       81-L http://www.dana.de/mod/pgp/dana.asc
       81-L ftp://ftp.fu-berlin.de/unix/news/pgpcontrol/PGPKEYS.gz
       81-F 5B B0 52 88 BF 55 19 4F  66 7D C2 AE 16 26 28 25
       81-V 2.6.3ia
       81-K------BEGIN PGP PUBLIC KEY BLOCK-----
       81-K-Version: 2.6.3ia
       81-K-
       81-K-mQCNAzGeB/YAAAEEALZ+Xfm/WDCEMXM48gK1PlKG6TkV3SLbXt4CnzpGMtOM
       81-K-HjlHaU6Xco5ijAuqM1wEGUHD5hw/BL/heR5Tq+C5IEyXQQmYwkrgeVFMO/rA
       [...]
       81-K-SDw+Id0JPFO9AWOiQgAAtN6zrYOhHFBp+68h9k674Yg9IHqj3BWdRjJF6PKo
       81-K-VpvRovMz+lSOy9Zcsbs+5t8Pj9ZVAQyfxBkqD5A=
       81-K-=Xwgc
       81 K -----END PGP PUBLIC KEY BLOCK-----
       [...]
       ..



Grau, Heinau, Schlichting                                      [Page 38]


Internet Draft       Netnews Administration System      January 28, 2000


7.  Specification of the NAS Protocol (UDP)

   UDP is intended for reading programs (news reader), it is not in the
   scope of this document and will be described in a separate paper.


8.  Security Considerations

   Security issues are only vital for the server-server communication,
   since we want a strict hierarchical model of the netnews
   administration system. So we want to be sure that only authorized
   clients connect to an authoritative server.

   Every server has the possibility to deny some commands or the whole
   connection based on the client's IP number.


9.  References


   [IANA-CS] IANA: Character Sets
             ftp://ftp.isi.edu/in-notes/iana/assignments/character-sets

   [IANA-MT] IANA: Media Types   ftp://ftp.isi.edu/in-notes/iana/
             assignments/media-types/media-types

   [IANA-PN] IANA: Assigned Port Numbers
             ftp://ftp.isi.edu/in-notes/iana/assignments/port-numbers

   [RFC1036] Horton, M., and Adams, R., "Standard for Interchange of
             USENET Messages, RFC 1036, AT&T Bell Laboratories/
             Center for Seismic Studies, December 1987

   [RFC1305] Mills, D.L., "Network Time Protocol", RFC 1305,
             University of Delaware, March 1992

   [RFC1700] Reynolds, J., and J. Postel, "Assigned Numbers", STD 2, RFC
             1700, USC/ISI, October 1994.

   [RFC1766] Alvestrand, H., "Tags for the Identification of
             Languages", RFC 1766, March 1995.

   [RFC2026] Bradner, S., "The Internet Standards Process - Revision 3",
             RFC 2026, Harvard University, October 1996

   [RFC2045] Freed, N. and Borenstein, N., "Multipurpose Internet Mail
             Extensions (MIME)", RFC 2045, Innosoft/First Virtual,
             November 1996



Grau, Heinau, Schlichting                                      [Page 39]


Internet Draft       Netnews Administration System      January 28, 2000


   [RFC2119] Bradner, "Key words for use in RFCs to Indicate Requirement
             Levels", RFC 2119, Harvard University, March 1997.

   [RFC2234] Crocker, Overell, "Augmented BNF for Syntax Specifications:
             ABNF", RFC 2234, November 1997.

   [RFC2277] Alvestrand, H., "IETF Policy on Character Sets and
             Language", RFC 2277, January 1998

   [RFC2440] Callas, J., Donnerhacke, L., Finney, H. and R.  Thayer,
             "OpenPGP Message Format", RFC 2240, November 1998.

   [SON1036] Henry Spencer, "News Article Format and Transmission",
             A Draft for an RFC 1036 Successor,
             ftp://zoo.toronto.edu/pub/news.txt.Z

   [USEFOR]  USEFOR Working Group, "News Article Format"
             draft-ietf-usefor-article-02


10.  Author's Address

   Philipp Grau, Vera Heinau, Heiko Schlichting
   Freie Universitaet Berlin
   ZEDAT, DFN-CIS
   Fabeckstr. 32
   D-14195 Berlin
   Germany

   Phone: +49 30 838-56583
   Fax:   +49 30 838-56721

   Email: nas@cis.fu-berlin.de
   WWW: http://nas.cis.fu-berlin.de/


Appendix A - Response Codes (Overview)

   Code  Description
   ----  ---------------------------------------------------------------
   100   Command overview, Infomation command description (HELP)
   101   Information about connection, client and server (INFO)
   200   Greeting message (Connection Setup)
   201   Termination of the connection (QUIT)
   202   Returns current protocol level (VERS)
   213   Valid data at the client side (GETP)
   215   The client already has the current data (GETA)
   300   Time in UTC (DATE)



Grau, Heinau, Schlichting                                      [Page 40]


Internet Draft       Netnews Administration System      January 28, 2000


   302   Answer to an successful request (VERS)
   400   Indicates that the server is not giving any information (INFO)
   401   Permission denied (LIST, LSTR, HIER, DATA, GETL)
   402   Requested level too high, falling back to lower level (VERS)
   404   Server currently out of service (Connection Setup)
   410   Indicates that the server is not giving any information (HELP)
   411   No package with that name (GETP, GETA)
   430   Permission denied (GETP, GETA)
   434   Client has no permission to talk to server (Connection Setup)
   510   Syntax error (VERS)
   511   Internal error (TIME)
   530   Missing parameter (LIST, LSTR, HIER, DATA, GETP, GETA)
   610   Regular answer with all requested data (LIST,LSTR)
   611   Regular answer with all requested data (HIER)
   612   Regular answer with all requested data (DATA)
   613   Package data (GETP)
   614   Lists all packages a server is authoritative for (GETL)
   615   Regular answer with all requested data (GETA)


Appendix B - Data Codes for DATA and HIER Commands (Overview)

   Code Name            Mandatory  Use Multiple Description
   ---- --------------- ---------- --- -------- ------------------------
   0    name            yes        H/N no       Name of a hierarchy or
                                                newsgroup (Start of a
                                                new data block)
   1    status          yes        H/N no       Status of hierarchy or
                                                newsgroup
   2    followup        no           N no       Group for followup
   10   description     no         H/N no       Short description of a
                                                hierarchy/newsgroup
   20   charter         no         H/N yes      Charter-URL
   21   netiquette      no         H/N yes      Netiquette-URL
   22   faq             no           N yes      FAQ-URL
   23   rules           no         H   yes      Administration rules URL
   30   ctl_send_adr    no         H   yes      Control email
   32   ctl_newsgroup   no         H   yes      Control newsgroup
   33   mod_wildcard    no         H   no       Moderator wildcard
   34   mod_sub_adr     no           N no       Submission address
   35   mod_adm_adr     no           N yes      Moderator's address
                                                (email)
   36   mod_group_info  no           N yes      Info-URL
   40   language        no         H/N yes      Language
   41   charset         no         H/N yes      Charset
   42   encoding        no         H/N yes      Encoding
   50   ng_type         no         H/N yes      Type of newsgroup
   51   hier_type       no         H   yes      Type of hierarchy



Grau, Heinau, Schlichting                                      [Page 41]


Internet Draft       Netnews Administration System      January 28, 2000


   52   area            no         H   yes      Regional or
                                                organizational area
   60   name_length     no         H   no       Total length of group
                                                names
   61   comp_length     no         H   no       Component length of
                                                group names
   62   article_length  no         H   no       Article length
   70   date_create     no         H/N no       Date of creation
   71   date_delete     no         H/N no       Date of removal
   72   replacement     no         H/N yes      Successor
   81   ctl_pgp_key     no         H   yes      Control PGP key
   82   mod_pgp_key     no           N yes      Moderator's PGP key

   Expires August 2, 2000





































Grau, Heinau, Schlichting                                      [Page 42]
