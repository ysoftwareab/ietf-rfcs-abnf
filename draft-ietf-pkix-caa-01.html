<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DNS Certification Authority Authorization (CAA) Resource Record</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Definitions">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Defined Terms">
<link href="#rfc.section.2" rel="Chapter" title="2 Introduction">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 The CAA RR type">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Examples of Use.">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Certification Authority Processing">
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 Canonical Domain Name">
<link href="#rfc.section.2.2.2" rel="Chapter" title="2.2.2 Use of DNS Security">
<link href="#rfc.section.2.2.3" rel="Chapter" title="2.2.3 Archive">
<link href="#rfc.section.3" rel="Chapter" title="3 Mechanism">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Syntax">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Canonical Presentation Format">
<link href="#rfc.section.3.1.1.1" rel="Chapter" title="3.1.1.1 Policy OID Encoding Options">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 policy Property value">
<link href="#rfc.section.3.1.3" rel="Chapter" title="3.1.3 path Property value">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Mis-Issue by Authorized Certification Authority">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Suppression or spoofing of CAA records">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Applications">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Certification Authorities">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Denial of Service">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Abuse of the Critical Flag">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Registration of the CAA Resource Record Type">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Certification Authority Authorization Properties">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="6.2 Non Normative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Object Digest Identifier Calculation">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Example: CA Certificate A">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Example: CA Certificate A">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Example Certificates">
<link href="#rfc.appendix.Appendix%20B.1" rel="Chapter" title="Appendix B.1 CA Certificate A">
<link href="#rfc.appendix.Appendix%20C" rel="Chapter" title="Appendix C ASN.1 Values (Non-Normative)">
<link href="#rfc.appendix.Appendix%20C.1" rel="Chapter" title="Appendix C.1 DER Sequence Encoding">
<link href="#rfc.appendix.Appendix%20C.2" rel="Chapter" title="Appendix C.2 Object Identifiers for Certificate Types">
<link href="#rfc.appendix.Appendix%20C.3" rel="Chapter" title="Appendix C.3 Object Identifiers for Digest Algorithms">
<link href="#rfc.appendix.Appendix%20C.4" rel="Chapter" title="Appendix C.4 DER Data Encoding Prefixes">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The Certification Authority Authorization (CAA) DNS Resource Record allows a DNS domain name holder to specify the certificate signing certificate(s) authorized to issue certificates for that domain.  CAA resource records allow a public Certification Authority to implement additional controls to reduce the risk of unintended certificate mis-issue.  " />
  <meta name="description" content="The Certification Authority Authorization (CAA) DNS Resource Record allows a DNS domain name holder to specify the certificate signing certificate(s) authorized to issue certificates for that domain.  CAA resource records allow a public Certification Authority to implement additional controls to reduce the risk of unintended certificate mis-issue.  " />
  <meta name="keywords" content="DNS, DNSSEC, PKIX" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">P. M. Hallam-Baker</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Comodo Group Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">R. N. Stradling</td>
</tr>
<tr>
<td class="left">Expires: January 08, 2012</td>
<td class="right">Comodo CA Ltd.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">B. Laurie</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Google Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 07, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DNS Certification Authority Authorization (CAA) Resource Record<br />
  <span class="filename">draft-ietf-pkix-caa-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The Certification Authority Authorization (CAA) DNS Resource Record allows a DNS domain name holder to specify the certificate signing certificate(s) authorized to issue certificates for that domain.  CAA resource records allow a public Certification Authority to implement additional controls to reduce the risk of unintended certificate mis-issue.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 08, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Definitions</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Defined Terms</a>
</li>
<li>2.   <a href="#rfc.section.2">Introduction</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">The CAA RR type</a>
</li>
<li>2.1.1.   <a href="#rfc.section.2.1.1">Examples of Use.</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Certification Authority Processing</a>
</li>
<li>2.2.1.   <a href="#rfc.section.2.2.1">Canonical Domain Name</a>
</li>
<li>2.2.2.   <a href="#rfc.section.2.2.2">Use of DNS Security</a>
</li>
<li>2.2.3.   <a href="#rfc.section.2.2.3">Archive</a>
</li>
<li>3.   <a href="#rfc.section.3">Mechanism</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Syntax</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Canonical Presentation Format</a>
</li>
<li>3.1.1.1.   <a href="#rfc.section.3.1.1.1">Policy OID Encoding Options</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">policy Property value</a>
</li>
<li>3.1.3.   <a href="#rfc.section.3.1.3">path Property value</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Mis-Issue by Authorized Certification Authority</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Suppression or spoofing of CAA records</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">Applications</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Certification Authorities</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Denial of Service</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Abuse of the Critical Flag</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Registration of the CAA Resource Record Type</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Certification Authority Authorization Properties</a>
</li>
<li>6.   <a href="#rfc.references">References</a>
</li>
<li>6.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>6.2.   <a href="#rfc.references.2">Non Normative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Object Digest Identifier Calculation</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Example: CA Certificate A</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Example: CA Certificate A</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Example Certificates</a>
</li>
<li>Appendix B.1.   <a href="#rfc.appendix.Appendix%20B.1">CA Certificate A</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.Appendix%20C">ASN.1 Values (Non-Normative)</a>
</li>
<li>Appendix C.1.   <a href="#rfc.appendix.Appendix%20C.1">DER Sequence Encoding</a>
</li>
<li>Appendix C.2.   <a href="#rfc.appendix.Appendix%20C.2">Object Identifiers for Certificate Types</a>
</li>
<li>Appendix C.3.   <a href="#rfc.appendix.Appendix%20C.3">Object Identifiers for Digest Algorithms</a>
</li>
<li>Appendix C.4.   <a href="#rfc.appendix.Appendix%20C.4">DER Data Encoding Prefixes</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Definitions</h1>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Defined Terms</h1>
<p id="rfc.section.1.2.p.1">The following terms are used in this document:</p>
<p></p>

<dl>
<dt>Abstract Syntax Notation One (ASN.1)</dt>
<dd style="margin-left: 8">A notation for describing abstract types and values, as specified in <a href="#X.680">X.680</a> <cite title="NONE">[X.680]</cite>.</dd>
<dt>Authorization Entry</dt>
<dd style="margin-left: 8">An authorization assertion that grants or denies a specific set of permissions to a specific group of entities.</dd>
<dt>Canonical Domain Name</dt>
<dd style="margin-left: 8">A Domain Name that is not an alias.  </dd>
<dt>Canonical Domain Name Value</dt>
<dd style="margin-left: 8">The value of a Canonical Domain Name. The value resulting from applying alias transformations to a Domain Name that is not canonical.  </dd>
<dt>Certificate</dt>
<dd style="margin-left: 8">An X.509 Certificate, as specified in <a href="#RFC5280">RFC 5280</a> <cite title="NONE">[RFC5280]</cite>.  </dd>
<dt>Certification Policy (CP)</dt>
<dd style="margin-left: 8">Specifies the criteria that a Certification Authority undertakes to meet in its issue of certificates.</dd>
<dt>Certification Practices Statement (CPS)</dt>
<dd style="margin-left: 8">Specifies the means by which the criteria of the Certification Policy are met. In most cases this will be the document against which the operations of the Certification Authority are audited.</dd>
<dt>Certification Authority (CA)</dt>
<dd style="margin-left: 8">An entity that issues Certificates in accordance with a specified Certification Policy.</dd>
<dt>Distinguished Encoding Rules (DER)</dt>
<dd style="margin-left: 8">A set of rules for encoding ASN.1 objects, as specified in <a href="#X.690">X.690</a> <cite title="NONE">[X.690]</cite>.</dd>
<dt>Domain</dt>
<dd style="margin-left: 8">The set of resources associated with a DNS Domain Name.</dd>
<dt>Domain Name</dt>
<dd style="margin-left: 8">A DNS Domain name as specified in <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> and revisions.  </dd>
<dt>Domain Name System (DNS)</dt>
<dd style="margin-left: 8">The Internet naming system specified in <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> and revisions.  </dd>
<dt>DNS Security (DNSSEC)</dt>
<dd style="margin-left: 8">Extensions to the DNS that provide authentication services as specified in <a href="#RFC4033">RFC 4033</a> <cite title="NONE">[RFC4033]</cite> and revisions.  </dd>
<dt>Extended Issuer Authorization Set</dt>
<dd style="margin-left: 8">The most specific Issuer Authorization Set that is active for a domain.  This is either the Issuer Authorization Set for the domain itself, or if that is empty, the Issuer Authorization Set for the corresponding Public Delegation Point.  </dd>
<dt>Issuer Authorization Set</dt>
<dd style="margin-left: 8">The set of Authorization Entries for a domain name that are flagged for use by Issuers. Analogous to an Access Control List but with no ordering specified.</dd>
<dt>Public Delegation Point</dt>
<dd style="margin-left: 8">A Domain Name that is obtained from a public DNS registry as defined by a Certification Policy.  </dd>
<dt>Public Key Infrastructure X.509 (PKIX)</dt>
<dd style="margin-left: 8">Standards and specifications issued by the IETF that apply the <a href="#X.509">X.509</a> <cite title="NONE">[X.509]</cite> certificate standards specified by the ITU to Internet applications as specified in <a href="#RFC5280">RFC 5280</a> <cite title="NONE">[RFC5280]</cite> and related documents.  </dd>
<dt>Resource Record (RR)</dt>
<dd style="margin-left: 8">A set of attributes bound to a Domain Name.</dd>
<dt>Relying Party</dt>
<dd style="margin-left: 8">A party that makes use of an application whose operation depends on use of a Certificate for making a security decision.</dd>
<dt>Relying Application</dt>
<dd style="margin-left: 8">An application whose operation depends on use of a Certificate for making a security decision.  </dd>
<dt>Relying Party Authorization Set</dt>
<dd style="margin-left: 8">The set of Authorization Entries for a domain name that are flagged for use by Relying Party Applications. Analogous to an Access Control List but with no ordering specified.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Introduction</h1>
<p id="rfc.section.2.p.1">The Certification Authority Authorization (CAA) DNS Resource Record allows a DNS domain name holder to specify the Certification Authorities authorized to issue certificates for that domain. Publication of CAA resource records allow a public Certification Authority (CA) to implement additional controls to reduce the risk of unintended certificate mis-issue.  </p>
<p id="rfc.section.2.p.2">Conformance with a published CAA record is a necessary but not sufficient condition for issue of a certificate.  Before issuing a certificate, a PKIX CA is required to validate the request according to the policies set out in its Certificate Policy Statement. In the case of a public CA that validates certificate requests as a third party, the certificate will be typically issued under a public root certificate embedded in one or more relevant reliant applications.  </p>
<p id="rfc.section.2.p.3">Criteria for inclusion of embedded root certificates in applications are outside the scope of this document but typically require the CA to publish a Certificate Practices Statement (CPS) that specifies how the requirements of the Certificate Policy (CP) are achieved and provide an annual audit statement of their performance against their CPS performed by an independent third party auditor.  </p>
<p id="rfc.section.2.p.4">It is the intention of the authors to propose the CAA record defined in this document as the basis for CA validation requirements to be proposed in organizations that publish validation requirements.  </p>
<p id="rfc.section.2.p.5">CAA records only describe the current state of Certification Authority certificate issue authority. Since a certificate is typically valid for at least a year, it is possible that a certificate that is not conformant with the CAA records currently published was conformant with the CAA records published at the time that it was issued. Thus Relying Applications MUST NOT use failure to conform to currently published CAA records as a rejection criteria for certificates unless the published records are flagged as being intended for that use.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> The CAA RR type</h1>
<p id="rfc.section.2.1.p.1">A CAA RR publishes a CAA property entry that corresponds to the specified domain name. Multiple property entries MAY be associated with the same domain name by publiching multiple CAA RRs at that domain name. Each property entry MAY be tagged with one or more of the following flag values: </p>
<p></p>

<dl>
<dt>Critical</dt>
<dd style="margin-left: 8">If set, indicates that the corresponding property entry tag MUST be understood if the semantics of the CAA record are to be correctly understood by the specified audience.</dd>
<dt></dt>
<dd style="margin-left: 8">Issuers MUST NOT issue certificates for a domain if the Extended Issuer Authorization Set contains unknown property entry tags that are flagged as critical.  </dd>
<dt></dt>
<dd style="margin-left: 8">Relying Parties MUST NOT attempt to enforce CAA records if the Relying Party Authorization Set contains unknown property entry tags that are flagged as critical </dd>
<dt>Must be Zero</dt>
<dd style="margin-left: 8">This bit is reserved for future use.  </dd>
<dt></dt>
<dd style="margin-left: 8">Issuers MUST NOT issue certificates for a domain if the Extended Issuer Authorization Set contains property entries with the Must Be Zero Tag Set.  </dd>
<dt></dt>
<dd style="margin-left: 8">Relying Parties MUST NOT attempt to enforce CAA records if the Relying Party Authorization Set contains property entries with the Must Be Zero Tag Set.  </dd>
<dt>Relying Party</dt>
<dd style="margin-left: 8">This bit is reserved to specify that the corresponding Property Entry MAY be used by Relying Party Applications.  </dd>
<dt></dt>
<dd style="margin-left: 8">Relying Parties MUST NOT attempt to enforce properties specified in CAA records with the Relying Party bit set clear.  </dd>
<dt>Issuer</dt>
<dd style="margin-left: 8">Specifies that the corresponding Property Entry is to be used by Issuers and forms part of the Issuer Authorization Set for the domain.  </dd>
</dl>

<p> </p>
<p id="rfc.section.2.1.p.3">The following properties are defined: </p>
<p></p>

<dl>
<dt>policy &lt;Certificate Policy OID&gt;</dt>
<dd style="margin-left: 8">The policy property entry declares an authorization entry granting authorization to issue under the specified Certificate Policy.  </dd>
<dt>path &lt;Object Digest Identifier&gt;</dt>
<dd style="margin-left: 8">The path property entry declares an authorization entry granting authorization to issue end entity certificates under a trust path that includes the specified signing credential.  </dd>
</dl>

<p> </p>
<p id="rfc.section.2.1.p.5">An Object Digest Identifier (ODI) is a means of specifying a reference to an object instance by means of a cryptographic digest function. A CAA path property may use an ODI to specify a certificate trust path by means of: </p>
<p></p>

<dl>
<dt>A Certificate Signing Certificate</dt>
<dd style="margin-left: 8"></dd>
<dt>A Public Signing Key</dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<p id="rfc.section.2.1.p.7">In either case a path Authorization Entry authorizes an issuer to issue an End Entity certificate to the corresponding domain if and only if it is possible to form a valid certificate path to it from the referenced certificate or key.  </p>
<h1 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> Examples of Use.</h1>
<p id="rfc.section.2.1.1.p.1">For convenience the examples are presented in the text format suggested in section <a href="#zoneformat">Section 3.1.1</a> </p>
<p id="rfc.section.2.1.1.p.2">The following example informs CAs that certificates must not be issued except under the Default Deny Security 'Example 1' Certificate Policy (1.3.6.1.4.1.35405.666.1). Since the policy is published at the Public Delegation Point, the policy applies to all subordinate domains under example.com.  </p>
<div id="#rfc.figure.1"></div>
<pre>
$ORIGIN example.com
.       CAA 1 policy 1.3.6.1.4.1.35405.666.1
                    </pre>
<p id="rfc.section.2.1.1.p.3">The following example informs CAs that certificates must not be issued except under the Certificate Authority Root certificate specified in Appendix B.  </p>
<div id="#rfc.figure.2"></div>
<pre>
$ORIGIN example.com
.       CAA 1 path MDIGA1UEJQYJYIZIAWUDBAIBBCAXzJgPaoT7Fe
                 XaPzKv6mI2D0yilif+7WhzmhMGLe/oBA== 
                    </pre>
<p id="rfc.section.2.1.1.p.4">A domain MAY authorize multiple CAs to issue certificates at the same time. The following example allows issue under the Default Deny Security certification policy 'Example 1' or 'Example 2': </p>
<div id="#rfc.figure.3"></div>
<pre>
$ORIGIN example.com
.       CAA 1 policy 1.3.6.1.4.1.35405.666.1
.       CAA 1 policy 1.3.6.1.4.1.35405.666.2 
                        </pre>
<p id="rfc.section.2.1.1.p.5">If Authorization Entries using the path and policy properties are present at a given Domain, compatibility with either is sufficient to authorize the request.  </p>
<p id="rfc.section.2.1.1.p.6">Future versions of this specification MAY use the critical flag to introduce new semantics that MUST be understood for correct processing of the record, preventing Certification Authorities that do not recognize the record from issuing certificates.  </p>
<p id="rfc.section.2.1.1.p.7">In the following example, the property 'tbs' is flagged as critical. The Default Deny Security CA is not authorized to issue under either policy unless the processing rules for the 'tbs' property tag are understood.  </p>
<div id="#rfc.figure.4"></div>
<pre>
$ORIGIN example.com
.       CAA 1 policy 1.3.6.1.4.1.35405.666.1
.       CAA 1 policy 1.3.6.1.4.1.35405.666.2
.       CAA 129 tbs MDIGA1UEJQYJYIZIAWUDBAIBBCAXzJgPaoT7Fe
                 XaPzKv6mI2D0yilif+7WhzmhMGLe/oBA==  
                        </pre>
<p id="rfc.section.2.1.1.p.8">Note that the above restrictions only apply to issue of certificates.  Since the validity of an end entity certificate is typically a year or more it is quite possible that the CAA records published at a domain will change between the issue of the certificate and verification by a relying party.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Certification Authority Processing</h1>
<p id="rfc.section.2.2.p.1">Before issue of a certificate, a compliant CA MUST check for publication of a relevant CAA Resource Record(s) and if such record(s) are published, that the certificate requested is consistent with them. If the certificate requested is not consistent with the relevant CAA RRs, the CA MUST NOT issue the certificate.  </p>
<p id="rfc.section.2.2.p.2">The Issuer Authorization Set for a domain name consists of the set of all CAA Authorization Entries declared for the canonical form of the specified domain.  </p>
<p id="rfc.section.2.2.p.3">The Extended Issuer Authorization Set for a domain name consists of the Issuer Authorization Set for that domain name if it is non-empty.  Otherwise the Extended Issuer Authorization Set for a domain name consists of the Issuer Authorization Set for the corresponding Public Delegation Point for that domain name.  </p>
<p id="rfc.section.2.2.p.4">If the Extended Issuer Authorization Set for a domain name is not empty, a Certification Authority MUST NOT issue a certificate unless it conforms to at least one authorization entry in the Extended Issuer Authorization Set.  </p>
<p id="rfc.section.2.2.p.5">Note that while it MUST be possible to form a certificate validation path that contains at least one certificate that is so specified, it MAY also be possible to form valid certificate paths that are not.  </p>
<p id="rfc.section.2.2.p.6">For example, a CA that has updated its root certificate to extend the expiry date is entitled to issue certificates for domains where the CAA record only specifies the older root certificate provided that the older root certificate has not actually expired and it is thus possible to form a valid certificate path.  </p>
<h1 id="rfc.section.2.2.1">
<a href="#rfc.section.2.2.1">2.2.1.</a> Canonical Domain Name</h1>
<p id="rfc.section.2.2.1.p.1">The DNS defines the CNAME and DNAME mechanisms for specifying domain name aliases. The canonical name of a DNS name is the name that results from performing all DNS alias operations.  </p>
<p id="rfc.section.2.2.1.p.2">A Certification Authority MUST perform CNAME and DNAME processing as defined in the DNS specifications <a href="#RFC1035">1035</a> <cite title="NONE">[RFC1035]</cite>.  </p>
<h1 id="rfc.section.2.2.2">
<a href="#rfc.section.2.2.2">2.2.2.</a> Use of DNS Security</h1>
<p id="rfc.section.2.2.2.p.1">Use of DNSSEC to authenticate CAA RRs is strongly recommended but not required. A CA MUST NOT issue certificates if doing so would conflict with the corresponding extended issuer authorization set whether the corresponding DNS records are signed or not.  </p>
<p id="rfc.section.2.2.2.p.2">Use of DNSSEC allows a CA to acquire and archive a non-repudiable proof that they were authorized to issue certificates for the domain.  </p>
<h1 id="rfc.section.2.2.3">
<a href="#rfc.section.2.2.3">2.2.3.</a> Archive</h1>
<p id="rfc.section.2.2.3.p.1">A compliant CA SHOULD maintain an archive of the DNS transactions used to verify CAA eligibility.  </p>
<p id="rfc.section.2.2.3.p.2">In particular a CA SHOULD ensure that where DNSSEC data is available that the corresponding signature and NSEC/NSEC3 records are preserved so as to enable later compliance audits.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Mechanism</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Syntax</h1>
<p id="rfc.section.3.1.p.1">A CAA RR contains a single property entry consisting of a tag value pair.  Each tag represents a property of the CAA record. The value of a CAA property is that specified in the corresponding value field.  </p>
<p id="rfc.section.3.1.p.2">A domain name MAY have multiple CAA RRs associated with it and a given property MAY be specified more than once.  </p>
<p id="rfc.section.3.1.p.3">The CAA data field contains one property entry.  A property entry consists of the following data fields: </p>
<div id="#rfc.figure.5"></div>
<pre>
+0-1-2-3-4-5-6-7-|0-1-2-3-4-5-6-7-|
| Flags          | Tag Length = n |
+----------------+----------------+...+---------------+
| Tag char 0     | Tag Char 1     |...| Tag Char n-1  |
+----------------+----------------+...+---------------+
+----------------+----------------+.....+---------------+
| Data byte 0    | Data byte 1    |.....| Data byte m-1 |
+----------------+----------------+.....+---------------+
                    </pre>
<p id="rfc.section.3.1.p.4">Where n is the length specified in the tag length field and m is the remaining octets in the data field (m = d - n - 2) where d is the length of the data section.  </p>
<p id="rfc.section.3.1.p.5">The data fields are defined as follows: </p>
<p></p>

<dl>
<dt>Flags</dt>
<dd style="margin-left: 8">One octet containing the following fields: <dl>
<dt>Bit 0: Critical Flag</dt>
<dd style="margin-left: 8">If the value is set (1), the critical flag is asserted and the property MUST be understood if the CAA record is to be correctly processed.  </dd>
<dt></dt>
<dd style="margin-left: 8">A Certification Authority MUST NOT issue certificates for any Domain that contains a CAA critical property for an unknown or unsupported property type.  </dd>
<dt>Bit 5: Must Be Zero</dt>
<dd style="margin-left: 8">Bit 5 is reserved and MUST be set to zero. Processors that encounter a CAA record containing a property with this bit set MUST treat the record set as if the critical property was asserted for an unknown record.  </dd>
<dt>Bit 6: Relying Application Use</dt>
<dd style="margin-left: 8">If set, the property entry contains an Authorization Entry that forms part of the Relying Application Authorization Set for the corresponding domain.  </dd>
<dt>Bit 7: Issuer Use</dt>
<dd style="margin-left: 8">If set, the property entry contains an Authorization Entry that forms part of the Issuer Application Authorization Set for the corresponding domain.  </dd>
</dl>
<p> </p>
</dd>
<dt></dt>
<dd style="margin-left: 8">Note that according to the conventions set out in  <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> Bit 0 is the Most Significant Bit and Bit 7 is the Least Significant.  Thus a flags value of 0x51 indicates a tag length of 5 octets and that the property entry is not critical and is not to be used for relying party processing.  </dd>
<dt>Tag Length</dt>
<dd style="margin-left: 8">A single octet containing an unsigned integer specifying the tag length in octets. The tag length MUST be at least 1 and SHOULD be no more than 15.  </dd>
<dt>Tag</dt>
<dd style="margin-left: 8">The property identifier, a sequence of ASCII characters.</dd>
<dt></dt>
<dd style="margin-left: 8">Tag values MAY contain ASCII characters a through z and the numbers 0 through 9. Tag values MUST NOT contain any other characters. Matching of tag values is case insensitive.  </dd>
<dt>Value</dt>
<dd style="margin-left: 8">A sequence of octets representing the property value. Property values are encoded as binary values and MAY employ sub-formats.</dd>
<dt></dt>
<dd style="margin-left: 8">The length of the value field is specified implicitly as the remaining length of the enclosing Resource Record data field.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> <a href="#zoneformat" id="zoneformat">Canonical Presentation Format</a>
</h1>
<p id="rfc.section.3.1.1.p.1">The canonical presentation format of the CAA record is as follows: </p>
<p id="rfc.section.3.1.1.p.2">CAA &lt;flags&gt; &lt;tag&gt; &lt;data&gt; </p>
<p id="rfc.section.3.1.1.p.3">Where: </p>
<p></p>

<dl>
<dt>flags</dt>
<dd style="margin-left: 8">Is an unsigned integer between 0 and 15.</dd>
<dt>tag</dt>
<dd style="margin-left: 8">Is a non-zero sequence of ASCII letter and numbers in lower case.  </dd>
<dt>data</dt>
<dd style="margin-left: 8">Is the Base64 Encoding <a href="#RFC4648">[RFC4648]</a> of the value field.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.1.1.1">
<a href="#rfc.section.3.1.1.1">3.1.1.1.</a> Policy OID Encoding Options</h1>
<p id="rfc.section.3.1.1.1.p.1">For convenience of administration, implementations MAY support ASN.1 Policy OID encoding at their option.  </p>
<p id="rfc.section.3.1.1.1.p.2">The Base64 encoding of data never contains the period character '.', while the encoding of ASN.1 OID values specified in IETF GSER encoding <a href="#RFC3642">[RFC3642]</a> will always incorporate at least one period character.  </p>
<p id="rfc.section.3.1.1.1.p.3">It follows that a data decoder MAY unambiguously interpret data specified in the Base64 or GSER format without the need for additional disambiguation.  </p>
<p id="rfc.section.3.1.1.1.p.4">Implementations MAY choose to allow use of both formats in both file and presentation formats.  </p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> policy Property value</h1>
<p id="rfc.section.3.1.2.p.1">The policy property value specifies an Authorization Entry by means of an ASN.1 OID specifying a Certification Policy. A Certification Authority is authorized to issue Certificates under a policy Authorization Entry if and only if </p>
<p></p>

<ul class="empty">
<li>The Certification Authority has the right to issue certificates under the specified policy, AND </li>
<li>The certificate request is compliant with the requirements of the specified policy, AND </li>
<li>The certificate request meets all the criteria under the Certification Policy under which the certificate is to be issued.  </li>
</ul>

<p> </p>
<p id="rfc.section.3.1.2.p.3">Each policy property specifies a single ASN.1 OID value consisting of the ASN.1 type, length specifier and OID data.  </p>
<p id="rfc.section.3.1.2.p.4">The policy property applies to the specified policy OID and all policy OIDs that fall within the same OID arc. If the OID arc 1.3.6.1.4.1.35405.666 is specified, then the policy OIDs 1.3.6.1.4.1.35405.666, 1.3.6.1.4.1.35405.666.1, 1.3.6.1.4.1.35405.666.2 etc. are all authorized.  </p>
<p id="rfc.section.3.1.2.p.5">The Certificate that is issued MAY incorporate the specified policy OID itself but is not required to provided that the issue of the certificate is consistent with the requirements of the specified policy.  </p>
<p id="rfc.section.3.1.2.p.6">For example, a CA that offers two levels of Certification Policy such that the higher level of assurance included all the requirements of the lower one MAY rely on a policy property specifying the lower assurance policy as authorization for issue under the higher assurance policy but not vice-versa.  </p>
<h1 id="rfc.section.3.1.3">
<a href="#rfc.section.3.1.3">3.1.3.</a> path Property value</h1>
<p id="rfc.section.3.1.3.p.1">The path property value specifies an Authorization Entry by means of a Certificate Signer Certificate or a Certificate Signing key.  A Certification Authority is authorized to issue Certificates under a path Authorization Entry if and only if </p>
<p></p>

<ul class="empty">
<li>A valid PKIX trust path can be formed from the specified Certificate Signer Certificate or a Certificate Signing key to the certificate that is to be issued, AND </li>
<li>The certificate request meets all the criteria under the Certification Policy under which the certificate is to be issued.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Security Considerations</h1>
<p id="rfc.section.4.p.1">CAA Records provide an accountability control. They are intended to deter rather than prevent undesired behavior.  </p>
<p id="rfc.section.4.p.2">While a Certification Authority can choose to ignore published CAA records, doing so increases the both the probability that they will mis-issue a certificate and the consequences of doing so. Once it is known that a CA observes CAA records, malicious registration requests will target disproportionately target the negligent CAs that do not, and so the mis-issue rate amongst the negligent CAs will increase.  Since the CA could clearly have avoided the mis-issue by performing CAA processing, the likelihood of sanctions against the negligent CA is increased. Failure to observe CAA issue restrictions provides an objective criteria for excluding issuers from embedded roots of trust.  </p>
<p id="rfc.section.4.p.3">In contrast, a Certification Authority that processes CAA records correctly can reasonably claim that any residual mis-issue event could have been avoided had the Domain Name holder published appropriate CAA records.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Mis-Issue by Authorized Certification Authority</h1>
<p id="rfc.section.4.1.p.1">Use of CAA records does not provide protection against mis-issue by an authorized Certification Authority.  </p>
<p id="rfc.section.4.1.p.2">Domain name holders SHOULD ensure that the CAs they authorize to issue certificates for their domains employ appropriate controls to ensure that certificates are only issued to authorized parties within their organization.  </p>
<p id="rfc.section.4.1.p.3">Such controls are most appropriately determined by the domain name holder and the authorized CA(s) directly and are thus out of scope of this document.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Suppression or spoofing of CAA records</h1>
<p id="rfc.section.4.2.p.1">Suppression of the CAA record or insertion of a bogus CAA record could enable an attacker to obtain a certificate from a CA that was not authorized to issue for that domain name.  </p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> Applications</h1>
<p id="rfc.section.4.2.1.p.1">Applications performing CAA checking SHOULD mitigate the risk of suppresion or spoofing of CAA records by means of DNSSEC validation where present. In cases where DNSSEC validation is not available, CAA checking is of limited security value.  </p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> Certification Authorities</h1>
<p id="rfc.section.4.2.2.p.1">Since a certificate issued by a CA can be valid for several years, the consequences of a spoofing or suppression attack are much greater for Certification Authorities and so additional countermeasures are justified.  </p>
<p id="rfc.section.4.2.2.p.2">A CA MUST mitigate this risk by employing DNSSEC verification whenever possible and rejecting certificate requests in any case where it is not possible to verify the non-existence or contents of a relevant CAA record.  </p>
<p id="rfc.section.4.2.2.p.3">In cases where DNSSEC is not deployed in a corresponding domain, a CA SHOULD attempt to mitigate this risk by employing appropriate DNS security controls. For example all portions of the DNS lookup process SHOULD be performed against the authoritative name server.  Cached data MUST NOT be relied on but MAY be used to support additional anti-spoofing or anti-suppression controls.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Denial of Service</h1>
<p id="rfc.section.4.3.p.1">Introduction of a malformed or malicious CAA RR could in theory enable a Denial of Service attack.  </p>
<p id="rfc.section.4.3.p.2">This specific threat is not considered to add significantly to the risk of running an insecure DNS service.  </p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> Abuse of the Critical Flag</h1>
<p id="rfc.section.4.4.p.1">A Certification Authority could make use of the critical flag to trick customers into publishing records which prevent competing Certification Authorities from issuing certificates even though the customer intends to authorize multiple providers.  </p>
<p id="rfc.section.4.4.p.2">In practice, such an attack would be of minimal effect since any competent competitor that found itself unable to issue certificates due to lack of support for a property marked critical is going to investigate the cause and report the reason to the customer who was deceived. It is thus unlikely that the attack would succeed and the attempt might lay the perpetrator open to civil or criminal sanctions.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> IANA Considerations</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Registration of the CAA Resource Record Type</h1>
<p id="rfc.section.5.1.p.1">IANA has assigned Resource Record Type TBD1 for the CAA Resource Record Type and added the line depicted below to the registry named Resource Record (RR) TYPEs and QTYPEs as defined in BCP 42 RFC 5395 [RFC5395] and located at http://www.iana.org/assignments/dns-parameters.  </p>
<div id="#rfc.figure.6"></div>
<pre>
             Value and meaning                                Reference
-----------  ---------------------------------------------    ---------
CAA          TBD1 Certification Authority Restriction         [RFCXXXX]
</pre>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Certification Authority Authorization Properties</h1>
<p id="rfc.section.5.2.p.1">IANA has created the Certification Authority Authorization Properties registry with the following initial values: </p>
<div id="#rfc.figure.7"></div>
<pre>

             Meaning                                          Reference
-----------  -----------------------------------------------  ---------
path         Authorization Entry by Signature Path            [RFCXXXX]
policy       Authorization Entry by Certificate Policy        [RFCXXXX]
                    </pre>
<p id="rfc.section.5.2.p.2">Addition of tag identifiers requires a public specification and expert review as set out in <a href="#RFC5395">RFC5395</a> <cite title="NONE">[RFC5395]</cite> </p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a title="USC/ISI">Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4033">[RFC4033]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4055">[RFC4055]</b></td>
<td class="top">
<a>Schaad, J.</a>, <a>Kaliski, B.</a> and <a>R. Housley</a>, "<a href="http://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 4055, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5395">[RFC5395]</b></td>
<td class="top">
<a>Eastlake, D.</a>, "<a href="http://tools.ietf.org/html/rfc5395">Domain Name System (DNS) IANA Considerations</a>", RFC 5395, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.509">[X.509]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.509 (11/2008): Information technology - Open systems interconnection - The Directory: Public-key and attribute certificate frameworks </a>", ITU-T Recommendation X.509, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.680">[X.680]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.680 (11/2008): Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation </a>", ITU-T Recommendation X.680, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.690">[X.690]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.690 (11/2008): Information technology - Abstract Syntax Notation One (ASN.1): Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER) </a>", ITU-T Recommendation X.690, November 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">6.2.</a> Non Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3642">[RFC3642]</b></td>
<td class="top">
<a>Legg, S.</a>, "<a href="http://tools.ietf.org/html/rfc3642">Common Elements of Generic String Encoding Rules (GSER) Encodings</a>", RFC 3642, October 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="NIST-ALGS">[NIST-ALGS]</b></td>
<td class="top">
<a>National Institute of Standards and Technology </a>, "<a>Cryptographic Algorithm Registration</a>", March 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Object Digest Identifier Calculation</h1>
<p id="rfc.section.Appendix A.p.1">An Object Digest is an ASN.1 structure with three components: </p>
<p></p>

<ul class="empty">
<li>An ASN.1 Object Identifier specifying the object type of the referenced object</li>
<li>An ASN.1 Object Identifier specifying the digest algorithm</li>
<li>An ASN.1 <a href="#X.690">DER</a> <cite title="NONE">[X.690]</cite> encoded data field containing the digest value of the referenced object processed using the specified digest algorithm.  </li>
</ul>

<p> </p>
<div id="#rfc.figure.8"></div>
<pre>

DNSCAA DEFINITIONS ::=

BEGIN

 ObjectDigestIdentifier ::= SEQUENCE {
   type             OBJECT IDENTIFIER,
   digestAlgorithm  OBJECT IDENTIFIER,
   digest           OCTET STRING
 }

END
        </pre>
<p id="rfc.section.Appendix A.p.3">The Object Digest Identifier construction is designed to facilitate implementation in applications that already require ASN.1 handling mechanisms (i.e. most cryptographic applications) without causing an undue coding burden in cases where ASN.1 code is not already supported.  Appendix C provides all the necessary information to create a fully compliant Object Digest Identifier implementation.  </p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> Example: CA Certificate A</h1>
<p id="rfc.section.Appendix A.1.p.1">The ODI of CA Certificate A (specified in Appendix B.1) is calculated as follows: </p>
<p></p>

<ul class="empty">
<li>ASN.1 Sequence tag: <samp>3032</samp> </li>
<li>ASN.1 OID id-at-cACertificate (2.5.4.37): <samp>0603550425</samp> </li>
<li>ASN.1 OID sha256 (2.16.840.1.101.3.4.2.1): <samp>0609608648016503040201</samp> </li>
<li>SHA-256 Digest Value: <samp>042017cc980f6a84fb15e5da3f32afea62360f4ca29627feed68739a13062defe804</samp> </li>
</ul>

<p> </p>
<p id="rfc.section.Appendix A.1.p.3">The ODI in BASE64 format is MDIGA1UEJQYJYIZIAWUDBAIBBCAXzJgPaoT7FeXaPzKv6mI2D0yilif+7WhzmhMGLe/oBA==.  </p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Example: CA Certificate A</h1>
<p id="rfc.section.Appendix A.2.p.1">The ODI of the signing key of CA Certificate A (specified in Appendix B.1) is calculated as follows: </p>
<p></p>

<ul class="empty">
<li>ASN.1 Sequence tag </li>
<li>ASN.1 OID 'CA Signing Key' </li>
<li>ASN.1 OID 'SHA-256' </li>
<li>SHA-256 Digest Value </li>
</ul>

<p> </p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> Example Certificates</h1>
<p id="rfc.section.Appendix B.p.1">The following certificates are used in the examples.  </p>
<h1 id="rfc.appendix.Appendix B.1">
<a href="#rfc.appendix.Appendix%20B.1">Appendix B.1.</a> CA Certificate A</h1>
<p id="rfc.section.Appendix B.1.p.1">CA Certificate A is a self signed certificate signed with a 2048 bit RSA key: </p>
<div id="#rfc.figure.9"></div>
<pre>
-----BEGIN CERTIFICATE-----
MIIDATCCAeugAwIBAgIBATALBgkqhkiG9w0BAQUwKDERMA8GA1UEChMIQWNtZSBJ
bmMxEzARBgNVBAMTCkV4YW1wbGUgQ0EwHhcNMTAxMTExMTgxMjAzWhcNMjAxMTA4
MTgxMjAzWjAoMREwDwYDVQQKEwhBY21lIEluYzETMBEGA1UEAxMKRXhhbXBsZSBD
QTCCAR8wCwYJKoZIhvcNAQEBA4IBDgAwggEJAoIBALHvos3yEe0ugR6Ae2rPATXA
pBYGK6BMzGTLkXCg6MZaG9CZpfleZTZ/EgIKBwRJlIXvWdKwjMZ7GBByT+fdMDZp
7zkx64UZ4+CJm98NRjdugxovl8HhscIBXnhCHERgamp0U/f8Ho5W8eAxYLZ1XcIG
mB7mVknvolaN9EqlEmYn+qHexGJPlpWFmR4NKhVAATE6B1a9z5PCmoOgW9p0Vqic
SJ6CdAHKaa7JZS+sqNQDx57H8Q6R9lh52XXmJVVficxBp2K7C+Wvht45t68FG6f1
sXWuWDRYc6iUmOxZbzDDvIoFU0pAXESTdMOWvXKI8ZUaYBoZ7/YnSSTaseiW86sC
AwEAAaM9MDswDgYDVR0PAQEBBAQDAgAEMA8GA1UdEwEBAQQFMAMBAQEwGAYDVR0g
BBEwDzANBgsrBgEEAYKUTYUaATALBgkqhkiG9w0BAQUDggEBAGcNiaQXdyiI9Y5e
Ps+XEYdKiWYvmSnRIfbUZuQWaQpPcj5cHzMe91CUZipGDNJYXwqWhIUtQAAGmtrq
ZGa4F9Yh0cPFAHBXPHXKGeM1hMtAR7Mv9kHu4DFIhb822O0n4DdBIit8FNas5t/5
CbM6crDpWB5hjAsD37U+GZGvTJmag059VWjnjv90NcfCQ6YJ6AA5VKnmrV695VnL
dSPaN9VS5RN6heJqU9tcbqPkAEP3MuJtd1QxB8Q34f9e1kTYXxc/dBJK1RQ0F4nc
Jc4NbJzakvFq+QcbzEqkhDMiXvjDV0JJt+GkFZrsREi6IgQY4DQHPv65OIvbr3uW
329dd+g=
-----END CERTIFICATE-----
                    </pre>
<p id="rfc.section.Appendix B.1.p.2">In binary form, the certificate data is: </p>
<div id="#rfc.figure.10"></div>
<pre>
0000  30 82 03 01 30 82 01 eb  a0 03 02 01 02 02 01 01
0010  30 0b 06 09 2a 86 48 86  f7 0d 01 01 05 30 28 31
0020  11 30 0f 06 03 55 04 0a  13 08 41 63 6d 65 20 49
0030  6e 63 31 13 30 11 06 03  55 04 03 13 0a 45 78 61
0040  6d 70 6c 65 20 43 41 30  1e 17 0d 31 30 31 31 31
0050  31 31 38 31 32 30 33 5a  17 0d 32 30 31 31 30 38
0060  31 38 31 32 30 33 5a 30  28 31 11 30 0f 06 03 55
0070  04 0a 13 08 41 63 6d 65  20 49 6e 63 31 13 30 11
0080  06 03 55 04 03 13 0a 45  78 61 6d 70 6c 65 20 43
0090  41 30 82 01 1f 30 0b 06  09 2a 86 48 86 f7 0d 01
00a0  01 01 03 82 01 0e 00 30  82 01 09 02 82 01 00 b1
00b0  ef a2 cd f2 11 ed 2e 81  1e 80 7b 6a cf 01 35 c0
00c0  a4 16 06 2b a0 4c cc 64  cb 91 70 a0 e8 c6 5a 1b
00d0  d0 99 a5 f9 5e 65 36 7f  12 02 0a 07 04 49 94 85
00e0  ef 59 d2 b0 8c c6 7b 18  10 72 4f e7 dd 30 36 69
00f0  ef 39 31 eb 85 19 e3 e0  89 9b df 0d 46 37 6e 83
0100  1a 2f 97 c1 e1 b1 c2 01  5e 78 42 1c 44 60 6a 6a
0110  74 53 f7 fc 1e 8e 56 f1  e0 31 60 b6 75 5d c2 06
0120  98 1e e6 56 49 ef a2 56  8d f4 4a a5 12 66 27 fa
0130  a1 de c4 62 4f 96 95 85  99 1e 0d 2a 15 40 01 31
0140  3a 07 56 bd cf 93 c2 9a  83 a0 5b da 74 56 a8 9c
0150  48 9e 82 74 01 ca 69 ae  c9 65 2f ac a8 d4 03 c7
0160  9e c7 f1 0e 91 f6 58 79  d9 75 e6 25 55 5f 89 cc
0170  41 a7 62 bb 0b e5 af 86  de 39 b7 af 05 1b a7 f5
0180  b1 75 ae 58 34 58 73 a8  94 98 ec 59 6f 30 c3 bc
0190  8a 05 53 4a 40 5c 44 93  74 c3 96 bd 72 88 f1 95
01a0  1a 60 1a 19 ef f6 27 49  24 da b1 e8 96 f3 ab 02
01b0  03 01 00 01 a3 3d 30 3b  30 0e 06 03 55 1d 0f 01
01c0  01 01 04 04 03 02 00 04  30 0f 06 03 55 1d 13 01
01d0  01 01 04 05 30 03 01 01  01 30 18 06 03 55 1d 20
01e0  04 11 30 0f 30 0d 06 0b  2b 06 01 04 01 82 94 4d
01f0  85 1a 01 30 0b 06 09 2a  86 48 86 f7 0d 01 01 05
0200  03 82 01 01 00 67 0d 89  a4 17 77 28 88 f5 8e 5e
0210  3e cf 97 11 87 4a 89 66  2f 99 29 d1 21 f6 d4 66
0220  e4 16 69 0a 4f 72 3e 5c  1f 33 1e f7 50 94 66 2a
0230  46 0c d2 58 5f 0a 96 84  85 2d 40 00 06 9a da ea
0240  64 66 b8 17 d6 21 d1 c3  c5 00 70 57 3c 75 ca 19
0250  e3 35 84 cb 40 47 b3 2f  f6 41 ee e0 31 48 85 bf
0260  36 d8 ed 27 e0 37 41 22  2b 7c 14 d6 ac e6 df f9
0270  09 b3 3a 72 b0 e9 58 1e  61 8c 0b 03 df b5 3e 19
0280  91 af 4c 99 9a 83 4e 7d  55 68 e7 8e ff 74 35 c7
0290  c2 43 a6 09 e8 00 39 54  a9 e6 ad 5e bd e5 59 cb
02a0  75 23 da 37 d5 52 e5 13  7a 85 e2 6a 53 db 5c 6e
02b0  a3 e4 00 43 f7 32 e2 6d  77 54 31 07 c4 37 e1 ff
02c0  5e d6 44 d8 5f 17 3f 74  12 4a d5 14 34 17 89 dc
02d0  25 ce 0d 6c 9c da 92 f1  6a f9 07 1b cc 4a a4 84
02e0  33 22 5e f8 c3 57 42 49  b7 e1 a4 15 9a ec 44 48
02f0  ba 22 04 18 e0 34 07 3e  fe b9 38 8b db af 7b 96
0300  df 6f 5d 77 e8
                    </pre>
<p id="rfc.section.Appendix B.1.p.3">The SHA-256 digest of the certificate data is: </p>
<div id="#rfc.figure.11"></div>
<pre>
17cc980f6a84fb15e5da3f32afea62360f4ca29627feed68739a13062defe804
                    </pre>
<h1 id="rfc.appendix.Appendix C">
<a href="#rfc.appendix.Appendix%20C">Appendix C.</a> ASN.1 Values (Non-Normative)</h1>
<p id="rfc.section.Appendix C.p.1">Although the Object Digest Identifier form employs ASN.1 DER encoding only a small subset of ASN.1 features are used and a full ASN.1 stack is not necessary.  </p>
<p id="rfc.section.Appendix C.p.2">This appendix provides sufficient information to implement an Object Digest Identifier constructor or parser.  </p>
<h1 id="rfc.appendix.Appendix C.1">
<a href="#rfc.appendix.Appendix%20C.1">Appendix C.1.</a> DER Sequence Encoding</h1>
<p id="rfc.section.Appendix C.1.p.1">In DER encoding, the enclosing SEQUENCE will always be represented by the type identifier x30 followed by the length specifier. Since the total length of the following data fields will almost certainly be less than 127 bytes, the single byte encoding mechanism in which bit 7 is clear and the length value is encoded in the lower 7 bits will be required.  </p>
<h1 id="rfc.appendix.Appendix C.2">
<a href="#rfc.appendix.Appendix%20C.2">Appendix C.2.</a> Object Identifiers for Certificate Types</h1>
<p id="rfc.section.Appendix C.2.p.1">OIDs have been defined in connection with the X.500 directory for user certificates, certification authority certificates, revocations of certification authority, and revocations of user certificates.  The following table lists the OIDs, their DER encoding, and their type identifier and length-prefixed hex format for use in Object Digest Identifiers.  </p>
<div id="#rfc.figure.12"></div>
<pre>
id-at  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2) ds(5) 4 }

id-at-userCertificate  OBJECT IDENTIFIER  ::=  { id-at 36 }    
                                                 -- 06 03 55 04 24
  id-at-cACertificate  OBJECT IDENTIFIER  ::=  { id-at 37 }    
                                                 -- 06 03 55 04 25
 TBS-PUBLIC-KEY-VALUE  OBJECT IDENTIFIER  ::=  { ??? }         
                                                 -- 06 xx xx xx xx
                    </pre>
<h1 id="rfc.appendix.Appendix C.3">
<a href="#rfc.appendix.Appendix%20C.3">Appendix C.3.</a> Object Identifiers for Digest Algorithms</h1>
<p id="rfc.section.Appendix C.3.p.1">OIDs have been assigned by NIST for the SHA-2 digest algorithms <a href="#NIST-ALGS">[NIST-ALGS]</a> <a href="#RFC4055">[RFC4055]</a> Use of the SHA-1 digest algorithm is not recommended due to concerns for the security of the algorithm.  </p>
<div id="#rfc.figure.13"></div>
<pre>
hashAlgs  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2) 
              country(16) us(840) organization(1) gov(101) csor(3) 
              nistAlgorithm(4) 2 }

id-sha256  OBJECT IDENTIFIER  ::=  { hashAlgs 1 }    
                                     -- 06 09 60 86 48 01 65 03 04 02 01
id-sha384  OBJECT IDENTIFIER  ::=  { hashAlgs 2 }    
                                     -- 06 09 60 86 48 01 65 03 04 02 02
id-sha512  OBJECT IDENTIFIER  ::=  { hashAlgs 3 }    
                                     -- 06 09 60 86 48 01 65 03 04 02 03
id-sha224  OBJECT IDENTIFIER  ::=  { hashAlgs 4 }    
                                     -- 06 09 60 86 48 01 65 03 04 02 04
                    </pre>
<h1 id="rfc.appendix.Appendix C.4">
<a href="#rfc.appendix.Appendix%20C.4">Appendix C.4.</a> DER Data Encoding Prefixes</h1>
<p id="rfc.section.Appendix C.4.p.1">The rules of ASN.1 encoding state that every data value is preceded by a data type identifier and a length identifier. In the case of an Object Digest Identifier the data type identifier is always OCTET STRING (04) and the length for all currently defined digest algorithms will be less than 128 bytes (1024 bits) and thus use the single byte encoding form in which bit 7 is set to 0 and the lower 7 bits specify the length.  </p>
<p id="rfc.section.Appendix C.4.p.2">The length prefixes for commonly used digest lengths in hexadecimal notation are thus: </p>
<p></p>

<dl>
<dt>160 bits</dt>
<dd style="margin-left: 8">04 14</dd>
<dt>224 bits</dt>
<dd style="margin-left: 8">04 1C</dd>
<dt>256 bits</dt>
<dd style="margin-left: 8">04 20</dd>
<dt>384 bits</dt>
<dd style="margin-left: 8">04 30</dd>
<dt>512 bits</dt>
<dd style="margin-left: 8">04 40</dd>
</dl>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Phillip Hallam-Baker</span> 
	  <span class="n hidden">
		<span class="family-name">Hallam-Baker</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo Group Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:philliph@comodo.com">philliph@comodo.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rob Stradling</span> 
	  <span class="n hidden">
		<span class="family-name">Stradling</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo CA Ltd.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:rob.stradling@comodo.com">rob.stradling@comodo.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ben Laurie</span> 
	  <span class="n hidden">
		<span class="family-name">Laurie</span>
	  </span>
	</span>
	<span class="org vcardline">Google Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:benl@google.com">benl@google.com</a></span>

  </address>
</div>

</body>
</html>