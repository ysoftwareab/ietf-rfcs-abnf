



Network Working Group                                          A. Lindem
Internet-Draft                                                     Y. Qu
Intended status: Standards Track                           Cisco Systems
Expires: April 19, 2018                                 October 16, 2017


                          RIB YANG Data Model
                draft-acee-rtgwg-yang-rib-extend-05.txt

Abstract

   The Routing Information Base (RIB) is a list of routes and their
   corresponding administrative data and operational state.

   The document [ROUTING-CFG] defines the basic building blocks for RIB,
   and this model augments it to support multiple next-hops (aka, paths)
   for each route as well as additional attributes.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 19, 2018.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of




Lindem & Qu              Expires April 19, 2018                 [Page 1]

Internet-Draft                  YANG RIB                    October 2017


   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Requirements Notation . . . . . . . . . . . . . . . . . .   2
   2.  Design of the Model . . . . . . . . . . . . . . . . . . . . .   2
     2.1.  RIB Tags and Preference . . . . . . . . . . . . . . . . .   3
     2.2.  Multiple next-hops  . . . . . . . . . . . . . . . . . . .   3
     2.3.  Repair path . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  RIB Model Tree  . . . . . . . . . . . . . . . . . . . . . . .   3
   4.  RIB YANG Model  . . . . . . . . . . . . . . . . . . . . . . .   5
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .  10
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  10
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  11
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .  11
     7.2.  Informative References  . . . . . . . . . . . . . . . . .  11
   Appendix A.  Acknowledgments  . . . . . . . . . . . . . . . . . .  11
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  11

1.  Introduction

   This document defines a YANG, [YANG], data model which extends the
   generic data model for RIB by augmenting the ietf-routing model as
   defined in [ROUTING-CFG].

   RIB is a collection of best routes from all routing protocols.
   Within a protocol routes are selected based on the metrics in use by
   that protocol, and the protocol install its best routes to RIB.  RIB
   selects the best route by comparing the route preference (aka,
   administrative distance) of the associated protocol.

   The augmentations described herein extend the RIB to support multiple
   paths per route, route metrics, and administrative tags.

1.1.  Requirements Notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC-KEYWORDS].

2.  Design of the Model

   The YANG definitions in this document augment the ietf-routing model
   defined in [ROUTING-CFG], which provides a basis for routing system
   data model development.  Together with modules defined in




Lindem & Qu              Expires April 19, 2018                 [Page 2]

Internet-Draft                  YANG RIB                    October 2017


   [ROUTING-CFG], a generic RIB Yang model is defined to implement and
   monitor RIB.

   The models in [ROUTING-CFG] also define the basic configuration and
   operational state for both IPv4 and IPv6 static routes and this
   document also provides augmentations for static routes to support
   multiple next-hop and more next-hop attributes.

2.1.  RIB Tags and Preference

   Individual routes tags will be supported at both the route and next-
   hop level.  A preference per next-hop is also supported for selection
   of the most prefered reachable static route.

2.2.  Multiple next-hops

   Both Ipv4 and IPv6 static route configuration defined in
   [ROUTING-CFG] have been augmented with a multi-next-hop option.

   A static route/prefix can be configured to have multiple next-hops,
   each with their own tag and route preference.

   In RIB, a route may have multiple next-hops.  They can be either
   equal cost multiple paths (ECMP), or they may have different metrics.

2.3.  Repair path

   The loop-free alternate (LFA) Fast Reroute (FRR) pre-computes repair
   paths by routing protocols, and RIB stores the best repair path.

   A repair path is augmented in RIB operation state for each path.

3.  RIB Model Tree

   A simplified graphical representation of the augmentations described
   herein is included below.

   The meaning of the symbols in this diagrams is as follows:

   o  Brackets "[" and "]" enclose list keys.

   o  Curly braces "{" and "}" contain names of optional features that
      make the corresponding node conditional.

   o  Abbreviations before data node names: "rw" means configuration
      (read-write), "ro" state data (read-only), "-x" RPC operations,
      and "-n" notifications.




Lindem & Qu              Expires April 19, 2018                 [Page 3]

Internet-Draft                  YANG RIB                    October 2017


   o  Symbols after data node names: "?" means an optional node, "!" a
      container with presence, and "*" denotes a "list" or "leaf-list".

   o  Parentheses enclose choice and case nodes, and case nodes are also
      marked with a colon (":").

   o  Ellipsis ("...") stands for contents of subtrees that are not
      shown.

   augment /rt:routing/rt:control-plane-protocols
           /rt:control-plane-protocol/rt:static-routes
           /v4ur:ipv4/v4ur:route/v4ur:next-hop
           /v4ur:next-hop-options/v4ur:simple-next-hop:
    +--rw preference?   uint32
    +--rw tag?          uint32
   augment /rt:routing/rt:control-plane-protocols
           /rt:control-plane-protocol/rt:static-routes
           /v4ur:ipv4/v4ur:route/v4ur:next-hop
           /v4ur:next-hop-options/v4ur:next-hop-list/v4ur:next-hop-list
           /v4ur:next-hop:
    +--rw preference?   uint32
    +--rw tag?          uint32
   augment /rt:routing/rt:control-plane-protocols
           /rt:control-plane-protocol/rt:static-routes
           /v6ur:ipv6/v6ur:route/v6ur:next-hop
           /v6ur:next-hop-options/v6ur:simple-next-hop:
    +--rw preference?   uint32
    +--rw tag?          uint32
   augment /rt:routing/rt:control-plane-protocols
           /rt:control-plane-protocol/rt:static-routes
           /v6ur:ipv6/v6ur:route/v6ur:next-hop
           /v6ur:next-hop-options/v6ur:next-hop-list/v6ur:next-hop-list
           /v6ur:next-hop:
    +--rw preference?   uint32
    +--rw tag?          uint32
   augment /rt:routing/rt:ribs/rt:rib/rt:routes/rt:route:
    +--ro metric?   uint32
    +--ro tag?      uint32
   augment /rt:routing/rt:ribs/rt:rib/rt:routes:
    +--ro repair-route* [id]
       +--ro id          string
       +--ro next-hop
       |  +--ro outgoing-interface?   if:interface-state-ref
       |  +--ro next-hop-address?     inet:ip-address
       +--ro metric?     uint32
   augment /rt:routing/rt:ribs/rt:rib/rt:routes/rt:route
           /rt:next-hop/rt:next-hop-options/rt:simple-next-hop:
    +--ro repair-path?



Lindem & Qu              Expires April 19, 2018                 [Page 4]

Internet-Draft                  YANG RIB                    October 2017


            -> /rt:routing/ribs/rib/routes/repair-route/id
   augment /rt:routing/rt:ribs/rt:rib/rt:routes/rt:route
           /rt:next-hop/rt:next-hop-options/rt:special-next-hop:
    +--ro repair-path?
            -> /rt:routing/ribs/rib/routes/repair-route/id
   augment /rt:routing/rt:ribs/rt:rib/rt:routes/rt:route
           /rt:next-hop/rt:next-hop-options/rt:next-hop-list
           /rt:next-hop-list/rt:next-hop:
    +--ro repair-path?
            -> /rt:routing/ribs/rib/routes/repair-route/id

4.  RIB YANG Model

   <CODE BEGINS> file "ietf-rib@2017-10-16.yang"
   module ietf-rib-extension {
     namespace "urn:ietf:params:xml:ns:yang:ietf-rib-extension";

     prefix rib;

     import ietf-inet-types {
       prefix "inet";
     }

     import ietf-interfaces {
       prefix "if";
     }

     import ietf-routing {
       prefix "rt";
     }

     import ietf-ipv4-unicast-routing {
       prefix "v4ur";
     }

     import ietf-ipv6-unicast-routing {
       prefix "v6ur";
     }

     organization
       "Cisco Systems
        170 West Tasman Drive
        San Jose, CA 95134-1706
        USA";
     contact
       "Acee Lindem - acee@cisco.com
        Yingzhen QU - yiqu@cisco.com";




Lindem & Qu              Expires April 19, 2018                 [Page 5]

Internet-Draft                  YANG RIB                    October 2017


     description
       "This YANG module extends the generic data model for
        RIB by augmenting the ietf-netmod-routing-cfg
        model. It is intended that the module will be extended
        by vendors to define vendor-specific RIB parameters.
       ";

     revision 2017-10-16 {
       description
         "Initial RFC Version";
       reference
         "RFC XXXX: A YANG Data Model for RIB Extensions.";
     }

     /* Groupings */
     grouping next-hop {
       description
         "Next-hop grouping";
       leaf interface {
         type if:interface-ref;
         description
           "Outgoing interface";
       }
       leaf address {
         type inet:ip-address;
         description
           "IPv4 or IPv6 Address of the next-hop";
       }
     }

     grouping attributes {
       description
         "Common attributes applicable to all paths";
       leaf metric {
         type uint32;
         description "Route metric";
       }
       leaf tag {
         type uint32;
         description "Route tag";
       }
     }
     grouping path-attribute {
       description
         "Path attribute grouping";
       leaf repair-path {
         type leafref {
           path "/rt:routing/rt:ribs/rt:rib/"



Lindem & Qu              Expires April 19, 2018                 [Page 6]

Internet-Draft                  YANG RIB                    October 2017


                + "rt:routes/repair-route/id";
         }
         description
           "IP Fast ReRoute (IPFRR) repair path, use a path
            from repair-route list";
       }
     }

     augment "/rt:routing/rt:control-plane-protocols/"
           + "rt:control-plane-protocol/rt:static-routes/v4ur:ipv4/"
           + "v4ur:route/v4ur:next-hop/v4ur:next-hop-options/"
           + "v4ur:simple-next-hop"
     {
       description
         "Augment 'simple-next-hop' case in IPv4 unicast route.";
       leaf preference {
         type uint32;
         default "1";
         description "Route preference - Used to select among multiple
                     static routes with a lower preference next-hop
                     preferred and equal preference paths yielding
                     Equal Cost Multi-Path (ECMP).";
       }
       leaf tag {
         type uint32;
         default "0";
         description "Route tag";
       }
     }

     augment "/rt:routing/rt:control-plane-protocols/"
           + "rt:control-plane-protocol/rt:static-routes/v4ur:ipv4/"
           + "v4ur:route/v4ur:next-hop/v4ur:next-hop-options/"
           + "v4ur:next-hop-list/v4ur:next-hop-list/v4ur:next-hop"
     {
       description
         "Augment static route configuration 'next-hop-list'.";

       leaf preference {
         type uint32;
         default "1";
         description "Route preference - Used to select among multiple
                     static routes with a lower preference next-hop
                     preferred and equal preference paths yielding
                     Equal Cost Multi-Path (ECMP).";
       }
       leaf tag {
         type uint32;



Lindem & Qu              Expires April 19, 2018                 [Page 7]

Internet-Draft                  YANG RIB                    October 2017


         default "0";
         description "Route tag";
       }
     }

     augment "/rt:routing/rt:control-plane-protocols/"
           + "rt:control-plane-protocol/rt:static-routes/v6ur:ipv6/"
           + "v6ur:route/v6ur:next-hop/v6ur:next-hop-options/"
           + "v6ur:simple-next-hop"
     {
       description
         "Augment 'simple-next-hop' case in IPv6 unicast route.";
       leaf preference {
         type uint32;
         default "1";
         description "Route preference - Used to select among multiple
                     static routes with a lower preference next-hop
                     preferred and equal preference paths yielding
                     Equal Cost Multi-Path (ECMP).";
       }
       leaf tag {
         type uint32;
         default "0";
         description "Route tag";
       }
     }

     augment "/rt:routing/rt:control-plane-protocols/"
           + "rt:control-plane-protocol/rt:static-routes/v6ur:ipv6/"
           + "v6ur:route/v6ur:next-hop/v6ur:next-hop-options/"
           + "v6ur:next-hop-list/v6ur:next-hop-list/v6ur:next-hop"
     {
       description
         "Augment static route configuration 'next-hop-list'.";

       leaf preference {
         type uint32;
         default "1";
         description "Route preference - Used to select among multiple
                     static routes with a lower preference next-hop
                     preferred and equal preference paths yielding
                     Equal Cost Multi-Path (ECMP).";
       }
       leaf tag {
         type uint32;
         default "0";
         description "Route tag";
       }



Lindem & Qu              Expires April 19, 2018                 [Page 8]

Internet-Draft                  YANG RIB                    October 2017


     }

     augment "/rt:routing/rt:ribs/rt:rib/"
           + "rt:routes/rt:route"
     {
       description
         "Augment a route in RIB with tag.";
       uses attributes;
     }

     augment "/rt:routing/rt:ribs/rt:rib/"
           + "rt:routes"
     {
       description
         "Augment a route with a list of repair-paths.";
       list repair-route {
         key "id";
         description
           "A repair-path entry, which can be referenced
            by a repair-path.";
         leaf id {
           type string;
           description
             "A unique identifier.";
         }

         container next-hop {
                 description
                   "Route's next-hop attribute.";
           leaf outgoing-interface {
             type if:interface-state-ref;
             description
               "Name of the outgoing interface.";
           }
           leaf next-hop-address {
             type inet:ip-address;
             description
               "IP address of the next hop.";
           }
         }
         leaf metric {
           type uint32;
           description "Route metric";
         }
       }
     }

     augment "/rt:routing/rt:ribs/rt:rib/"



Lindem & Qu              Expires April 19, 2018                 [Page 9]

Internet-Draft                  YANG RIB                    October 2017


           + "rt:routes/rt:route/rt:next-hop/rt:next-hop-options/"
           + "rt:simple-next-hop"
     {
        description
          "Add more parameters to a path.";
        uses path-attribute;
     }

     augment "/rt:routing/rt:ribs/rt:rib/"
           + "rt:routes/rt:route/rt:next-hop/rt:next-hop-options/"
           + "rt:special-next-hop"
     {
       description
         "Add more parameters to a path.";
       uses path-attribute;
     }

     augment "/rt:routing/rt:ribs/rt:rib/"
           + "rt:routes/rt:route/rt:next-hop/rt:next-hop-options/"
           + "rt:next-hop-list/rt:next-hop-list/rt:next-hop"
     {
       description
         "This case augments the 'next-hop-options' in the routing
          model.";
       uses path-attribute;
     }
   }
   <CODE ENDS>

5.  Security Considerations

   The YANG model augmentations defined herein do not introduce any
   security issues other than those already discussed in [ROUTING-CFG],
   and [NETCONF].  If confidentiality is desired, the underlying NETCONF
   communication should be utilized as described in [NETCONF-SSH].

6.  IANA Considerations

   This document registers a URI in the IETF XML registry
   [XML-REGISTRY].  Following the format in RFC 3688, the following
   registration is requested to be made:

      URI: urn:ietf:params:xml:ns:yang:ietf-rib

      Registrant Contact: The IESG.

      XML: N/A, the requested URI is an XML namespace.




Lindem & Qu              Expires April 19, 2018                [Page 10]

Internet-Draft                  YANG RIB                    October 2017


      This document registers a YANG module in the YANG Module Names
      registry [YANG].

      name: ietf-acl namespace: urn:ietf:params:xml:ns:yang:ietf-rib
      prefix: ietf-rib reference: RFC XXXX

7.  References

7.1.  Normative References

   [RFC-KEYWORDS]
              Bradner, S., "Key words for use in RFC's to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [ROUTING-CFG]
              Lhothka, L. and A. Lindem, "A YANG Data Model for Routing
              Management", RFC 8022, November 2016.

   [YANG]     Bjorklund, M., "YANG - A Data Modeling Language for the
              Network Configuration Protocol (NETCONF)", RFC 6020,
              October 2010.

7.2.  Informative References

   [NETCONF]  Enns, R., Bjorklund, M., Schoenwaelder, J., and A.
              Bierman, "Network Configuration Protocol (NETCONF)", RFC
              6241, June 2011.

   [NETCONF-SSH]
              Wasserman, M., "Using NETCONF Protocol over Secure Shell
              (SSH)", RFC 6242, June 2011.

   [XML-REGISTRY]
              Mealling, M., "The IETF XML Registry", BCP 81, RFC 3688,
              January 2004.

Appendix A.  Acknowledgments

   The RFC text was produced using Marshall Rose's xml2rfc tool.

   The authors wish to thank Les Ginsberg, Krishna Deevi and Suyoung
   Yoon for their helpful comments and suggestions.

Authors' Addresses







Lindem & Qu              Expires April 19, 2018                [Page 11]

Internet-Draft                  YANG RIB                    October 2017


   Acee Lindem
   Cisco Systems
   301 Midenhall Way
   Cary, NC  27513
   USA

   Email: acee@cisco.com


   Yingzhen Qu
   Cisco Systems
   170 West Tasman Drive
   San Jose, CA  95134
   USA

   Email: yiqu@cisco.com



































Lindem & Qu              Expires April 19, 2018                [Page 12]
