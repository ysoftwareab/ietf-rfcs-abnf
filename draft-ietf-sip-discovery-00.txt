

Network Working Group                                        W A Simpson
Internet Draft                                                Daydreamer
expires in six months                                         April 1993



                          SIP System Discovery



Status of this Memo

   This memo is the product of the SIP Working Group of the Internet
   Engineering Task Force (IETF).  Comments on this memo should be
   submitted to the sip@caldera.usc.edu mailing list.

   Distribution of this memo is unlimited.

   This document is an Internet Draft.  Internet Drafts are working
   documents of the Internet Engineering Task Force (IETF), its Areas,
   and its Working Groups.  Note that other groups may also distribute
   working documents as Internet Drafts.  Internet Drafts are draft
   documents valid for a maximum of six months.  Internet Drafts may be
   updated, replaced, or obsoleted by other documents at any time.  It
   is not appropriate to use Internet Drafts as reference material or to
   cite them other than as a ``working draft'' or ``work in progress.''
   Please check the 1id-abstracts.txt listing contained in the
   internet-drafts Shadow Directories on nic.ddn.mil, nnsc.nsf.net,
   nic.nordu.net, ftp.nisc.sri.com, or munnari.oz.au to learn the
   current status of any Internet Draft.

Abstract

   This document specifies ICMP messages for the identification and
   location of adjacent SIP systems.  This is intended to replace ARP,
   ICMP Router Advertisement, ICMP Redirect, and OSPF Hello in the SIP
   environment.

   [This is a rough first draft.  Need assessment of needed fields,
   much more text describing usage.  Autoconfiguration will be in a
   separate draft, since the issues here are already getting too big.]








Simpson                  expires in six months                  [Page i]
DRAFT                      system discovery                 April 1993


1.  Criteria

       Multicast support.

           Nearly all of the respondents listed this as the first or
           second desire stated.  It is noted that not all media
           supports multicast.

       Reduced net traffic.

           On one hand, a flood of hosts sending periodic
           advertisements; on the other, 2 extra packets for every
           address request.

           Two solutions were proposed:

            1) Sending the first packet to the all-systems multicast,
               and receiving a redirect.  This reduces the traffic from
               3 to 2 packets.

            2) Automatic router discovery.  For those packets which are
               clearly destined off net, the packet can be sent directly
               to the next hop.  Preference values were cited as useful.

           Also, carrying media addresses within the router discovery
           and redirect packets, so that a further query/response can be
           avoided.

       Low host overhead.

           A host should only retain information for those systems with
           with it is directly communicating.

       Autoconfiguration.

           In particular, automatic address discovery and automatic
           address prefix changes.

       Mobility support.

           Partly a subset of the above, as related to dynamically
           changing addresses while moving.  In addition, the "hidden
           transmitter" problem (you can hear another system, it can't
           hear you, but there is a path through a third system which it
           can hear, completing the circuit).  This is not well
           supported in any of the current protocols.

       Black hole detection.

           This was repeatedly cited as important.  There is a basic



Simpson                  expires in six months                  [Page 1]
DRAFT                      system discovery                 April 1993


           tradeoff between frequent queries and resources used.
           Explicit holding times were cited as useful.

       Media independence.

           There were many examples, such as point-to-point versus
           broadcast versus LPDN.  Media level redirects between logical
           subnets on the same physical media.  The difficulties with
           carrying media addresses within packets, especially in the
           presence of multi-media bridges.  This is not well supported
           in any of the current protocols.

       Optimal route determination.

           This is essentially a superset of next hop router discovery,
           combined with resource reservation and possible policy
           considerations, and the ability to redirect traffic under
           changing conditions.  The very things that have been causing
           so much discussion of late.  This is not well supported in
           any of the current protocols.

       Simplicity.

           All of the above desires, and they want to keep it simple,
           too.


   Proposed Solution Space.

   None of the current protocols are extensible in dimensions that fix
   the desires above.  While some have the ability to change in simple
   terms, such as larger addresses, none were designed to add new kinds
   of information to be carried in the same packet.

   This proposal describes two replacement packets, not much different
   from those already deployed.  These familiar forms are re-packaged to
   join common functions into the same packet to reduce traffic, and are
   designed to be more extensible in the future.

   In order to foster media independence, the packets are part of ICMP,
   which allows the procotols to be used over broadcast, multicast,
   partial-mesh, and point-to-point media.  This is similar to the
   positioning of ES-IS.

   All of the advertisementmessages have expiration times.

   Each message is composed of "optional" parts, designed to allow
   flexibility and extensibility.




Simpson                  expires in six months                  [Page 2]
DRAFT                      system discovery                 April 1993


   One of the common parts is the media address, so that each message
   contains enough information to return a reply directly to the sender,
   without additional location traffic.

   Another common part is a list of the routers which can be heard,
   which allows routers to build a map of the paths between routers, and
   routers to hosts.  This solves the "hidden transmitter" problem, when
   used together with the well-known link-state class of routing
   protocols.


   Examples of use:

       Simple case -- J to K on the same fully-connected segment.

           J sends the Where-Are-You (which contains its own media address)
           to all-systems.  K sends the I-Am-Here (which contains its own
           media address) directly to J.  At this point, they both know
           that they can talk directly to each other, without regard to
           subnet.

       Routed case -- J to K not on the same fully-connected segment.

           If no resource reservation or policy routing is desired, J
           simply sends its packets directly to the "best" router that it
           has learned from the Advertisements.  If there is a better
           router for the first hop, that router sends the I-Am-Here to J,
           but never-the-less forwards the packet.

           In the presence of RR or PR, J sends the Where-Are-You to the
           "best" router that it has learned from the Advertisements.  That
           router always returns the I-Am-Here (even if the correct hop is
           itself), which contains the requested RR or PR status
           information.  J then sends its packets to the first hop
           router as determined from the I-Am-Here.

       General case -- J to K over disconnected partial mesh (radio/framerelay).

           J sends the Where-Are-You (which contains its own media address,
           and the addresses of its "heard" routers) to the all-systems
           address.  The routers use such messages to construct a map of
           the current state of the topology.  The routers now know who J
           hears, and who hears J.

           If the routing map doesn't contain a current whereabouts of K,
           the Destination Unreachable message is returned by the "best"
           router on J's "heard" list.

           If the routing map contains the current whereabouts of K, the



Simpson                  expires in six months                  [Page 3]
DRAFT                      system discovery                 April 1993


           "best" router on K's "heard" list sends a copy of the
           Where-Are-You to K, with a substitute list of routers which can
           hear K.  The list is ordered by the intersection of those
           routers which can also hear J, minimizing the number of hops.

           Of course, K may have heard J's Where-Are-You directly, in which
           case it adds its own address to the front of the list of routers.

           When K hears the J Where-Are-You, it sends the I-Am-Here to the
           all-systems address.  The "best" router on J's "heard" list
           sends a copy of the I-Am-Here to J, with a substitute list of
           routers which can hear J.  The list is ordered by the
           intersection of those routers which can also hear K.

           At this point, the routing fabric knows which routers are heard
           by J and K, and which routers can hear J and K.  J and K know
           whether they can hear each other directly.  If not, they know
           the "best" next hop router (which may not be the same in both
           directions).

           Unlike the fully-connected scenarios, this scheme requires that
           the I-Am-Here is sent from time to time to keep the map updated.
           However, only routers need store the information.




























Simpson                  expires in six months                  [Page 4]
DRAFT                      system discovery                 April 1993


2.  Additional ICMP Packets

   The Packet format and basic facilities are already defined for ICMP
   [3], as modified for SIP [1].

   Up-to-date values of the ICMP Type field are specified in the most
   recent "Assigned Numbers" RFC [2].  This document concerns the
   following values:


      <TBD>   System Solicitation
      <TBD>   System Advertisement







































Simpson                  expires in six months                  [Page 5]
DRAFT                      system discovery                 April 1993


2.1.  System Solicitation

   A summary of the System Solicitation message format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |          Checksum             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Reserved                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                       System Identifier                       +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extensions ...
   +-+-+-+-+-+-+-+-+-+-+-+-+


   Type

      <TBD>

   Code

      0

   Checksum

      The ICMP Checksum.

   System Identifier

      The System Identifier field is eight octets in length, and contains
      the identifier of the system which is sought.

   Extensions

      The Extensions field is variable in length and contains zero or more
      Extensions.  These Extensions are described in a later section.










Simpson                  expires in six months                  [Page 6]
DRAFT                      system discovery                 April 1993


2.1.1.  Description

   The System Solicitation (Where-Are-You) message is used to determine
   the presence and availability of the next hop.  This message is also
   used for resource reservation and policy route determination.

   The message is sent on demand to the all-systems multicast, or to the
   best first hop router, as indicated by the Advertisement.  The
   information is stored only by routers and the subject hosts.

   [Need more text describing use for each case, and for resource
   reservation and policy routing]




































Simpson                  expires in six months                  [Page 7]
DRAFT                      system discovery                 April 1993


2.2.  System Advertisement

   A summary of the System Advertisement message format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |          Checksum             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Sequence Number        |          LifeTime             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                       System Identifier                       +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Default Metric                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Mask Size   |               |     Area      |    Priority   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extensions ...
   +-+-+-+-+-+-+-+-+-+-+-+-+


   Type

      <TBD>

   Code

      The Code field is one octet.  Up-to-date values of the System
      Advertisement Code field are specified in the most recent
      "Assigned Numbers" RFC [2].  Current values are assigned as
      follows:


           0     RESERVED
           1     Intermediate System
           2     End System
           3     Local Redirect
           4     Remote Redirect


   Checksum

      The ICMP Checksum.





Simpson                  expires in six months                  [Page 8]
DRAFT                      system discovery                 April 1993


   Sequence Number

      The Sequence Number field is two octets in length, and contains
      the number of System Advertisements sent.  This number MUST
      include this advertisement.

   LifeTime

      The LifeTime field is two octets in length, and indicates the
      seconds remaining before the entry is considered invalid.

   System Identifier

      The System Identifier field is eight octets in length, and
      contains the primary identifier for this system.  Other
      identifiers are indicated with the Other Identifiers extension.

   Default Metric

      The Default Metric field is four octets in length, and indicates
      the preference level for use of this system as a default router.
      Lower values indicate greater preference.

      End Systems MUST set this field to zero.

   Mask Size

      The Mask Size field is one octet in length, and indicates the
      number of bits in the System Identifier which indicate the subnet
      mask for the interface.

      If the System Identifier does not indicate a valid local subnet,
      the value is zero.

      End Systems SHOULD have a Mask Size of 64.

   Area

      The Area field is one octet in length, and indicates the area that
      the system inhabits.  A value of zero indicates that no area has
      been assigned.

      End Systems must set this field to zero.

   Priority

      The Priority field is one octet in length, and indicates the
      priority for election to Designated Backup.  A value of zero



Simpson                  expires in six months                  [Page 9]
DRAFT                      system discovery                 April 1993


      indicates that the system is not eligible.

      End Systems must set this field to zero.

   Extensions

      The Extensions field is variable in length and contains zero or
      more Extensions.  These Extensions are described in a later
      section.

2.2.1.  Description

   The System Advertisement (I-Am-Here) message is used to announce the
   presence of an intermediate or end system, to indicate changes in the
   topology, and to support system mobility.

   It contains all of the information now in the old Router
   Advertisement, ES Hello, IS Hello, OSPF Hello and RSPF Hello.


   Intermediate Systems

      The message is sent by each intermediate system periodically to
      the all-systems multicast.  The information is stored by all
      systems.

      The message is also sent in response to a System Solicitation.

   End Systems

      The message is sent in response to a System Solicitation.  The
      information is stored only by the affected systems.

   Local Redirect

      The message is sent in response to changes in the routing.  The
      information is stored only by the affected systems.

   Remote Redirect

      The message is sent to indicate movement of a system beyond the
      local area.  The information is stored only by the affected
      systems.








Simpson                  expires in six months                 [Page 10]
DRAFT                      system discovery                 April 1993


3.  Extensions

   Extensions allow variable amounts of information to be carried within
   each Advertisement or Solicitation packet.  Some extensions are
   common to both packet types.

   The end of the list of Extensions is indicated by the Payload Length
   of the SIP packet.

   A summary of the Extensions format is shown below.  The fields are
   transmitted from left to right.

    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |    Data ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Type

      The Type field is one octet and indicates the type of Extension.
      Up-to-date values of the Extension Type field are specified in the
      most recent "Assigned Numbers" RFC [2].  Current values are
      assigned as follows:

           1     Media Access
           2     Other Identifiers
           3     System Heard
           4     Routing Information
           5     Service Information


   Length

      The Length field is one octet and indicates the length of the Data
      field which has been used.

      Each Extension ends on an octet boundary which is an integral
      multiple of four octets.  Any unused portion of the Data field is
      padded with zeros.

            length          actual
            0 through 2        4
            3 through 6        8
            7 through 10      12





Simpson                  expires in six months                 [Page 11]
DRAFT                      system discovery                 April 1993


   Data

      The Data field is zero or more octets and contains the value or
      other information for this Extension.  The format and length of
      the Data field is determined by the Type and Length fields.














































Simpson                  expires in six months                 [Page 12]
DRAFT                      system discovery                 April 1993


3.1.  Media Access

A summary of the Media Access extension format is shown below.  The
fields are transmitted from left to right.

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |    Length     |           Media Type          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     MAC Address ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


Type

     1

Length

     >= 3

Media Type

   The Media Type field is two octets in length.  The value of this
   field is the same as the Hardware Type used in ARP.  Up-to-date
   values of the Hardware Type field are specified in the most recent
   "Assigned Numbers" RFC [2].

      [Should we use the ifType from MIB-II instead?]

MAC Address

   The MAC Address field is variable in length, and contains the media
   address which is used to access this system.

   The MAC Address is always specified in Canonical order.

The Media Access extension MUST be included in those messages sent from
an interface on a multi-access media.

It MUST NOT be included in a message sent from a point-to-point
interface, or in messages such as the Remote Redirect which pass through
intermediate systems.







Simpson                  expires in six months                 [Page 13]
DRAFT                      system discovery                 April 1993


3.2.  Other Identifiers

A summary of the Other Identifiers extension format is shown below.  The
fields are transmitted from left to right.

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |    Length     |               |   Mask Size   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Preference                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                       System Identifier                       +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


Type

     2

Length

    14

System Identifier

   The System Identifier field is eight octets in length, and contains
   an identifier for this system.  This may be another identifier for
   the same interface that sent the message, or may identify another
   interface on the same system which sent the message.

Preference

   The Preference field is four octets in length, and indicates the
   preference level for use of this system to forward packets to the
   System Identifier.  Lower values indicate greater preference.

   End Systems MUST set this field to zero.

Mask Size

   The Mask Size field is one octet in length, and indicates the number
   of bits in the System Identifier which indicate the subnet mask for
   the interface.

   If the System Identifier does not indicate a valid local subnet, the



Simpson                  expires in six months                 [Page 14]
DRAFT                      system discovery                 April 1993


   value is zero.

   End Systems SHOULD have a Mask Size of 64.

Every identifier for every interface is listed in each System
Advertisement message.

This supports multiple identifiers per interface, as well as multi-homed
systems.

This enables systems to determine the best next hop without sending a
Solicitation when the next hop is on another interface attached to the
same system.





































Simpson                  expires in six months                 [Page 15]
DRAFT                      system discovery                 April 1993


3.3.  System Heard

A summary of the System Heard extension format is shown below.  The
fields are transmitted from left to right.

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |    Length     |     Speed     |   Mask Size   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Sequence Number        |          LifeTime             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                       System Identifier                       +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            Quality                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |              MRU              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Advertisement Count                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Error Count                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


Type

     4

Length

    30

Sequence Number

   The Sequence Number field is two octets in length, and contains the
   last heard sequence number from the system.

LifeTime

   The LifeTime field is two octets in length, and indicates the seconds
   remaining before the entry is considered invalid.

System Identifier

   The System Identifier field is eight octets in length, and contains
   the primary identifier for the system.



Simpson                  expires in six months                 [Page 16]
DRAFT                      system discovery                 April 1993


Quality

   The Quality field is four octets in length, and contains an
   indication of the signal quality received from this system.  Higher
   values indicate greater quality.

Speed

   The Speed field is one octet in length, and indicates the speed of
   the link.  Higher values indicate greater speed.  The speed value is
   related to the log2 of the speed in bits per second.

   Unfortunately, there are several series which don't quite match.  Is
   there a standard assignment out there?

        0     link is down
        8              1,200 or less
        9              2,400
                       4,800
                       9,600
       10                     14,400
                      19,200
       12                     28,800
                      38,400
       14                     57,600
                                      64,000
       17                            128,000
       18            153,600
       19                            256,000
       22          1,544,000 T1
       23                          2,048,000 E1
       24                                     4,000,000 Token Ring
                   6,312,000 T2
       25                                    10,000,000 Ethernet
       26                                    16,000,000 Token Ring
       28         44,736,000 T3
       30        155,520,000 STS-3/STM-1
       32        622,080,000 STS-12/STM-4
       34      2,488,320,000 STS-48/STM-16


Mask Size

   The Mask Size field is one octet in length, and indicates the number
   of bits in the System Identifier which indicate the subnet mask for
   the interface.

   If the System Identifier does not indicate a valid local subnet, the



Simpson                  expires in six months                 [Page 17]
DRAFT                      system discovery                 April 1993


   value is zero.

   End Systems SHOULD have a Mask Size of 64.

Advertisement Count

   The Advertisement Count field is four octets in length, and indicates
   the number of advertisements that have been heard from the identified
   system.

Error Count

   The Error Count field is four octets in length, and indicates the
   number of errors which have been detected on the link with the
   identified system.

The System Heard extension MUST be included in every System
Advertisement.

































Simpson                  expires in six months                 [Page 18]
DRAFT                      system discovery                 April 1993


3.4.  Routing Information

A summary of the Routing Information extension format is shown below.
The fields are transmitted from left to right.

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |    Length     |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Reserved                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                       Designated Backup                       +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


Type

     5

Length

    14

Designated Backup

   The Designated Backup field is eight octets in length, and contains
   the identifier of the designated backup for this area.

This extension is included in the Intermediate System Advertisement of
the Designated Router, to assert its status as the Designated Router,
and indicate the Designated Backup.

















Simpson                  expires in six months                 [Page 19]
DRAFT                      system discovery                 April 1993


3.5.  Service Information

A summary of the Service Information extension format is shown below.
The fields are transmitted from left to right.

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |    Length     |              QoS              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Preference                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


Type

     6

Length

     6

QoS

   The Quality of Service field is two octets in length, and indicates a
   service for which transit will be accepted.

Preference

   The Preference field is four octets in length, and indicates the
   preference level for use of this network to forward packets of the
   indicated service.  Lower values indicate greater preference.

This extension is included in the Intermediate System Advertisement to
indicate that it will accept transit traffic.  If this extension is not
included, the system will treat the link as a stub network.















Simpson                  expires in six months                 [Page 20]
DRAFT                      system discovery                 April 1993


4.  Abstraction Algorithm

   An Area is defined to be a collection of subnets which are aggregated
   as the same next hop.

   The areas are learned from the Advertisements, which contain the
   necessary subnet information.  The subnets are assigned by hand.

   When the subnet mask shortens by at least one bit, a new level of
   area is created.  The area is defined by an area index (assigned by
   the designated router of the affected area), and the count of bits
   common to the subnet.  This can be expressed as a pair of 8-bit
   numbers.

   Discovery of stub areas (probably the most common type) is easy and
   automatic.  Discovery of aggregate areas is made by routers one hop
   out from the area.  This is communicated through its Advertisements,
   which are heard by the routers bordering the area.

   This algorithm results in a few, fairly large areas.  There can never
   be more than 64 levels of area, and it is more likely to be 5 to 10
   because of natural assignment boundaries.  The numbering space also
   places a limit on the number of routers bordering an area to 255, but
   that is highly unlikely.

   Fragmentation of areas simply results in automatic generation of
   internal areas, and has no effect on area levels farther out.
























Simpson                  expires in six months                 [Page 21]
DRAFT                      system discovery                 April 1993


Security Considerations

   Security issues are not discussed in this memo.


References

   [1]

   [2]


Acknowledgments



Chair's Address

   The working group can be contacted via the current chairs:





Author's Address

   Questions about this memo can also be directed to:

      William Allen Simpson
      Daydreamer
      Computer Systems Consulting Services
      P O Box 6205
      East Lansing, MI  48826-6205

      EMail: Bill.Simpson@um.cc.umich.edu
















Simpson                  expires in six months                 [Page 22]
DRAFT                      system discovery                 April 1993


                           Table of Contents


     1.     Criteria ..............................................    1

     2.     Additional ICMP Packets ...............................    5
        2.1       System Solicitation .............................    6
           2.1.1  Description .....................................    6
        2.2       System Advertisement ............................    8
           2.2.1  Description .....................................   10

     3.     Extensions ............................................   11
        3.1       Media Access ....................................   13
        3.2       Other Identifiers ...............................   14
        3.3       System Heard ....................................   16
        3.4       Routing Information .............................   19
        3.5       Service Information .............................   20

     4.     Abstraction Algorithm .................................   21

     SECURITY CONSIDERATIONS ......................................   22

     REFERENCES ...................................................   22

     ACKNOWLEDGEMENTS .............................................   22

     CHAIR'S ADDRESS ..............................................   22

     AUTHOR'S ADDRESS .............................................   22


