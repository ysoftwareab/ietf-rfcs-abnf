<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</title>
<meta content="Peter Saint-Andre" name="author">
<meta content="Jeff Hodges" name="author">
<meta content="Rich Salz" name="author">
<meta content="
       Many application technologies enable secure communication between two entities
by means of Internet Public Key Infrastructure Using X.509 (PKIX) certificates
in the context of Transport Layer Security (TLS).  This document specifies
procedures for representing and verifying the identity of application services
in such interactions. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-uta-rfc6125bis-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 57.0.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-uta-rfc6125bis-00-0wkqltm6.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Service Identity</td>
<td class="right">June 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Saint-Andre, et al.</td>
<td class="center">Expires 31 December 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-uta-rfc6125bis-00</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6125" class="eref">6125</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-06-29" class="published">29 June 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-12-31">31 December 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Saint-Andre</div>
<div class="org">Mozilla</div>
</div>
<div class="author">
      <div class="author-name">J. Hodges</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">R. Salz</div>
<div class="org">Akamai Technologies</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Many application technologies enable secure communication between two entities
by means of Internet Public Key Infrastructure Using X.509 (PKIX) certificates
in the context of Transport Layer Security (TLS).  This document specifies
procedures for representing and verifying the identity of application services
in such interactions.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues-2">
<a href="#name-discussion-venues-2" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Using TLS in Applications Working Group mailing list (uta@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/uta/">https://mailarchive.ietf.org/arch/browse/uta/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/richsalz/draft-ietf-uta-rfc6125bis">https://github.com/richsalz/draft-ietf-uta-rfc6125bis</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-2">
<a href="#name-status-of-this-memo-2" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 31 December 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-2">
<a href="#name-copyright-notice-2" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-2">
<a href="#name-table-of-contents-2" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-2" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-motivation-2" class="xref">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-audience-2" class="xref">Audience</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-how-to-read-this-document-2" class="xref">How to Read This Document</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-applicability-2" class="xref">Applicability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="xref">1.5</a>.  <a href="#name-overview-of-recommendations-2" class="xref">Overview of Recommendations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="xref">1.6</a>.  <a href="#name-scope-2" class="xref">Scope</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.1.2.6.2.1">
                    <p id="section-toc.1-1.1.2.6.2.1.1"><a href="#section-1.6.1" class="xref">1.6.1</a>.  <a href="#name-in-scope-2" class="xref">In Scope</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.1.2.6.2.2">
                    <p id="section-toc.1-1.1.2.6.2.2.1"><a href="#section-1.6.2" class="xref">1.6.2</a>.  <a href="#name-out-of-scope-2" class="xref">Out of Scope</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7">
                <p id="section-toc.1-1.1.2.7.1"><a href="#section-1.7" class="xref">1.7</a>.  <a href="#name-terminology-2" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-naming-of-application-servic" class="xref">Naming of Application Services</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-naming-application-services-2" class="xref">Naming Application Services</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-dns-domain-names-2" class="xref">DNS Domain Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-subject-naming-in-pkix-certi" class="xref">Subject Naming in PKIX Certificates</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="xref">2.3.1</a>.  <a href="#name-implementation-notes-2" class="xref">Implementation Notes</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-designing-application-protoc" class="xref">Designing Application Protocols</a></p>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-representing-server-identity" class="xref">Representing Server Identity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-rules-3" class="xref">Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-examples-3" class="xref">Examples</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-requesting-server-certificat" class="xref">Requesting Server Certificates</a></p>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-verifying-service-identity-2" class="xref">Verifying Service Identity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-overview-2" class="xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-constructing-a-list-of-refer" class="xref">Constructing a List of Reference Identifiers</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-rules-4" class="xref">Rules</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-examples-4" class="xref">Examples</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-preparing-to-seek-a-match-2" class="xref">Preparing to Seek a Match</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-matching-the-dns-domain-name" class="xref">Matching the DNS Domain Name Portion</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="xref">6.4.1</a>.  <a href="#name-checking-of-traditional-doma" class="xref">Checking of Traditional Domain Names</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="xref">6.4.2</a>.  <a href="#name-checking-of-internationalize" class="xref">Checking of Internationalized Domain Names</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.3">
                    <p id="section-toc.1-1.6.2.4.2.3.1"><a href="#section-6.4.3" class="xref">6.4.3</a>.  <a href="#name-checking-of-wildcard-certifi" class="xref">Checking of Wildcard Certificates</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.4">
                    <p id="section-toc.1-1.6.2.4.2.4.1"><a href="#section-6.4.4" class="xref">6.4.4</a>.  <a href="#name-checking-of-common-names-2" class="xref">Checking of Common Names</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-matching-the-application-ser" class="xref">Matching the Application Service Type Portion</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="xref">6.5.1</a>.  <a href="#name-srv-id-2" class="xref">SRV-ID</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="xref">6.5.2</a>.  <a href="#name-uri-id-2" class="xref">URI-ID</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-outcome-2" class="xref">Outcome</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.6.2.1">
                    <p id="section-toc.1-1.6.2.6.2.1.1"><a href="#section-6.6.1" class="xref">6.6.1</a>.  <a href="#name-case-1-match-found-2" class="xref">Case #1: Match Found</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.6.2.2">
                    <p id="section-toc.1-1.6.2.6.2.2.1"><a href="#section-6.6.2" class="xref">6.6.2</a>.  <a href="#name-case-2-no-match-found-pinned" class="xref">Case #2: No Match Found, Pinned Certificate</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.6.2.3">
                    <p id="section-toc.1-1.6.2.6.2.3.1"><a href="#section-6.6.3" class="xref">6.6.3</a>.  <a href="#name-case-3-no-match-found-no-pin" class="xref">Case #3: No Match Found, No Pinned Certificate</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.6.2.4">
                    <p id="section-toc.1-1.6.2.6.2.4.1"><a href="#section-6.6.4" class="xref">6.6.4</a>.  <a href="#name-fallback-2" class="xref">Fallback</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations-2" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-pinned-certificates-2" class="xref">Pinned Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-wildcard-certificates-2" class="xref">Wildcard Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-internationalized-domain-nam" class="xref">Internationalized Domain Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-multiple-identifiers-2" class="xref">Multiple Identifiers</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references-2" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references-2" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references-2" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-sample-text-2" class="xref">Sample Text</a></p>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref"></a><a href="#name-acknowledgements-2" class="xref">Acknowledgements</a></p>
</li>
          <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses-2" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction-2">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
      </h2>
<div id="motivation">
<section id="section-1.1">
        <h3 id="name-motivation-2">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-motivation-2" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-1.1-1">The visible face of the Internet largely consists of services that employ
a client-server architecture in which an interactive or automated client
communicates with an application service in order to retrieve or upload information,
communicate with other entities, or access a broader network of services.
When a client communicates with an application service using Transport Layer
Security <span>[<a href="#TLS" class="xref">TLS</a>]</span> or Datagram Transport Layer Security <span>[<a href="#DTLS" class="xref">DTLS</a>]</span>, it
references some notion of the server's identity (e.g., "the website
at example.com") while attempting to establish secure communication.  Likewise,
during TLS negotiation, the server presents its notion of the service's identity
in the form of a public-key certificate that was issued by a certification
authority (CA) in the context of the Internet Public Key Infrastructure using
X.509 <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>.  Informally, we can think of these identities as the client's "reference
identity" and the server's "presented identity" (these rough ideas are defined
more precisely later in this document through the concept of particular identifiers).
In general, a client needs to verify that the server's presented identity
matches its reference identity so it can authenticate the communication.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Many application technologies adhere to the pattern just outlined.  Such
protocols have traditionally specified their own rules for representing and
verifying application service identity.  Unfortunately, this divergence of
approaches has caused some confusion among certification authorities, application
developers, and protocol designers.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Therefore, to codify secure procedures for the implementation and deployment
of PKIX-based authentication, this document specifies recommended procedures
for representing and verifying application service identity in certificates
intended for use in application protocols employing TLS.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="audience">
<section id="section-1.2">
        <h3 id="name-audience-2">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-audience-2" class="section-name selfRef">Audience</a>
        </h3>
<p id="section-1.2-1">The primary audience for this document consists of application protocol designers,
who can reference this document instead of defining their own rules for the
representation and verification of application service identity.  Secondarily,
the audience consists of certification authorities, service providers, and
client developers from technology communities that might reuse the recommendations
in this document when defining certificate issuance policies, generating
certificate signing requests, or writing software algorithms for identity
matching.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reading">
<section id="section-1.3">
        <h3 id="name-how-to-read-this-document-2">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-how-to-read-this-document-2" class="section-name selfRef">How to Read This Document</a>
        </h3>
<p id="section-1.3-1">This document is longer than the authors would have liked because it was
necessary to carefully define terminology, explain the underlying concepts,
define the scope, and specify recommended behavior for both certification
authorities and application software implementations.  The following sections
are of special interest to various audiences:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">Protocol designers might want to first read the checklist in <a href="#design" class="xref">Section 3</a>.<a href="#section-1.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.2">Certification authorities might want to first read the recommendations for
representation of server identity in <a href="#represent" class="xref">Section 4</a>.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.3">Service providers might want to first read the recommendations for requesting
of server certificates in <a href="#request" class="xref">Section 5</a>.<a href="#section-1.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.4">Software implementers might want to first read the recommendations for verification
of server identity in <a href="#verify" class="xref">Section 6</a>.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.3-3">The sections on terminology (<a href="#terminology" class="xref">Section 1.7</a>), naming of application
services (<a href="#names" class="xref">Section 2</a>), document scope (<a href="#scope" class="xref">Section 1.6</a>), and the like provide
useful background information regarding the recommendations
and guidelines that are contained in the above-referenced sections, but are
not absolutely necessary for a first reading of this document.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="applicability">
<section id="section-1.4">
        <h3 id="name-applicability-2">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-applicability-2" class="section-name selfRef">Applicability</a>
        </h3>
<p id="section-1.4-1">This document does not supersede the rules for certificate issuance or validation
provided in <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>.  Therefore, <span>[<a href="#PKIX" class="xref">PKIX</a>]</span> is authoritative on any
point that might also be discussed in this document.
Furthermore, <span>[<a href="#PKIX" class="xref">PKIX</a>]</span> also governs any certificate-related topic on which this document is silent,
including but not limited to certificate syntax, certificate extensions such
as name constraints and extended key usage, and handling of certification
paths.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">This document addresses only name forms in the leaf "end entity" server certificate,
not any name forms in the chain of certificates used to validate the server
certificate.  Therefore, in order to ensure proper authentication, application
clients need to verify the entire certification path per <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">This document also does not supersede the rules for verifying service identity
provided in specifications for existing application protocols published prior
to this document.  However,
the procedures described here can be referenced by future
specifications,
including updates to specifications for existing application protocols if
the relevant technology communities agree to do so.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-1.5">
        <h3 id="name-overview-of-recommendations-2">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-overview-of-recommendations-2" class="section-name selfRef">Overview of Recommendations</a>
        </h3>
<p id="section-1.5-1">To orient the reader, this section provides an informational overview of
the recommendations contained in this document.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<p id="section-1.5-2">The previous version of this specification, <span>[<a href="#VERIFY" class="xref">VERIFY</a>]</span>,
surveyed the current practice from
many IETF standards and tried to generalize best practices.
This document takes the lessons learned in the past decade and codifies
them as best practices.<a href="#section-1.5-2" class="pilcrow">¶</a></p>
<p id="section-1.5-3">For the primary audience of application protocol designers, this document
provides recommended procedures for the representation and verification of
application service identity within PKIX certificates used in the context
of TLS.<a href="#section-1.5-3" class="pilcrow">¶</a></p>
<p id="section-1.5-4">For the secondary audiences, in essence this document encourages certification
authorities, application service providers, and application client developers
to coalesce on the following practices:<a href="#section-1.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-5.1">Stop including and checking strings that look like domain names
in the subject's Common Name.<a href="#section-1.5-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-5.2">Check DNS domain names via the subjectAlternativeName
extension designed for that purpose: dNSName.<a href="#section-1.5-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-5.3">Move toward including and checking even more specific
subjectAlternativeName extensions where appropriate for using the protocol
(e.g., uniformResourceIdentifier and the otherName form SRVName).<a href="#section-1.5-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-5.4">Constrain and simplify the validation of so-called wildcard certificates
(e.g., a certificate
containing an identifier for <code>*.example.com</code>).<a href="#section-1.5-5.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="scope">
<section id="section-1.6">
        <h3 id="name-scope-2">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-scope-2" class="section-name selfRef">Scope</a>
        </h3>
<div id="in-scope">
<section id="section-1.6.1">
          <h4 id="name-in-scope-2">
<a href="#section-1.6.1" class="section-number selfRef">1.6.1. </a><a href="#name-in-scope-2" class="section-name selfRef">In Scope</a>
          </h4>
<p id="section-1.6.1-1">This document applies only to service identities associated with
fully qualified DNS domain names, only to TLS and DTLS (or the older Secure
Sockets Layer (SSL) technology), and only to PKIX-based systems.  As a result,
the scenarios described in the following section are out of scope for this
specification (although they might be addressed by future specifications).<a href="#section-1.6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="out-of-scope">
<section id="section-1.6.2">
          <h4 id="name-out-of-scope-2">
<a href="#section-1.6.2" class="section-number selfRef">1.6.2. </a><a href="#name-out-of-scope-2" class="section-name selfRef">Out of Scope</a>
          </h4>
<p id="section-1.6.2-1">The following topics are out of scope for this specification:<a href="#section-1.6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.2-2.1">
              <p id="section-1.6.2-2.1.1">Client or end-user identities.<a href="#section-1.6.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-1.6.2-2.1.2">
Certificates representing client or end-user identities (e.g., the rfc822Name
identifier) can be used for mutual authentication between a client and server
or between two clients, thus enabling stronger client-server security or
end-to-end security.  However, certification authorities, application developers,
and service operators have less experience with client certificates than
with server certificates, thus giving us fewer models from which to generalize
and a less solid basis for defining best practices.<a href="#section-1.6.2-2.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.2-2.2">
              <p id="section-1.6.2-2.2.1">Identifiers other than fully qualified DNS domain names.<a href="#section-1.6.2-2.2.1" class="pilcrow">¶</a></p>
<p id="section-1.6.2-2.2.2">
Some certification authorities issue server certificates based on IP addresses,
but preliminary evidence indicates that such certificates are a very small
percentage (less than 1%) of issued certificates.  Furthermore, IP addresses
are not necessarily reliable identifiers for application services because
of the existence of private internets <span>[<a href="#PRIVATE" class="xref">PRIVATE</a>]</span>, host mobility,
multiple interfaces on a given host, Network Address Translators
(NATs) resulting in different addresses for a host from different locations
on the network, the practice of grouping many hosts together behind a single
IP address, etc.  Most fundamentally, most users find DNS domain names much
easier to work with than IP addresses, which is why the domain name system
was designed in the first place.  We prefer to define best practices for
the much more common use case and not to complicate the rules in
this specification.<a href="#section-1.6.2-2.2.2" class="pilcrow">¶</a></p>
<p id="section-1.6.2-2.2.3">
Furthermore, we focus here on application service identities, not
specific resources located at such services.
Therefore this document discusses Uniform Resource Identifiers
<span>[<a href="#URI" class="xref">URI</a>]</span> only as a way to communicate a DNS domain name (via the URI
"host" component or its equivalent), not as a way to communicate
other aspects of a service such as a specific resource (via the URI
"path" component) or parameters (via the URI "query" component).<a href="#section-1.6.2-2.2.3" class="pilcrow">¶</a></p>
<p id="section-1.6.2-2.2.4">
We also do not discuss attributes unrelated to DNS domain names,
such as those defined in <span>[<a href="#X.520" class="xref">X.520</a>]</span> and other such specifications
(e.g., organizational attributes, geographical attributes, company
logos, and the like).<a href="#section-1.6.2-2.2.4" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.2-2.3">
              <p id="section-1.6.2-2.3.1">Security protocols other than <span>[<a href="#TLS" class="xref">TLS</a>]</span>, <span>[<a href="#DTLS" class="xref">DTLS</a>]</span>, or the older Secure
Sockets Layer (SSL) technology.<a href="#section-1.6.2-2.3.1" class="pilcrow">¶</a></p>
<p id="section-1.6.2-2.3.2">
Although other secure, lower-layer protocols exist and even employ
PKIX certificates at times (e.g., IPsec <span>[<a href="#IPSEC" class="xref">IPSEC</a>]</span>), their use cases
can differ from those of TLS-based and DTLS-based application
technologies.
Furthermore, application technologies have less experience
with IPsec than with TLS, thus making it more difficult to gather feedback
on proposed best practices.<a href="#section-1.6.2-2.3.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.2-2.4">
              <p id="section-1.6.2-2.4.1">Keys or certificates employed outside the context of PKIX-based systems.<a href="#section-1.6.2-2.4.1" class="pilcrow">¶</a></p>
<p id="section-1.6.2-2.4.2">
Some deployed application technologies use a web of trust model
based on or similar to OpenPGP <span>[<a href="#OPENPGP" class="xref">OPENPGP</a>]</span>, or use self-signed
certificates, or are deployed on networks that are not directly
connected to the public Internet and therefore cannot depend on
Certificate Revocation Lists (CRLs) or the Online Certificate Status
Protocol <span>[<a href="#OCSP" class="xref">OCSP</a>]</span> to check CA-issued certificates.
However, the method for binding a public key to an identifier in
OpenPGP differs essentially from the method in X.509, the data in
self-signed certificates has not been certified by a third party in
any way, and checking of CA-issued certificates via CRLs or OCSP is
critically important to maintaining the security of PKIX-based
systems.
Attempting to define best practices for such technologies would
unduly complicate the rules defined in this specification.<a href="#section-1.6.2-2.4.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.2-2.5">
              <p id="section-1.6.2-2.5.1">Certification authority policies, such as:<a href="#section-1.6.2-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.2-2.5.2.1">What types or "classes" of certificates to issue and whether to apply different
policies for them (e.g., allow the wildcard character in certificates issued
to individuals who have provided proof of identity but do not allow the wildcard
character in "Extended Validation" certificates <span>[<a href="#EV-CERTS" class="xref">EV-CERTS</a>]</span>).<a href="#section-1.6.2-2.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.6.2-2.5.2.2">Whether to issue certificates based on IP addresses (or
some other form, such as relative domain names) in addition to fully qualified
DNS domain names.<a href="#section-1.6.2-2.5.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.6.2-2.5.2.3">Which identifiers to include (e.g., whether to include SRV-IDs or URI-IDs
as defined in the body of this specification).<a href="#section-1.6.2-2.5.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.6.2-2.5.2.4">How to certify or validate fully qualified DNS domain names and application
service types.<a href="#section-1.6.2-2.5.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.6.2-2.5.2.5">How to certify or validate other kinds of information that might be included
in a certificate (e.g., organization name).<a href="#section-1.6.2-2.5.2.5" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.6.2-2.6">
              <p id="section-1.6.2-2.6.1">Resolution of DNS domain names.<a href="#section-1.6.2-2.6.1" class="pilcrow">¶</a></p>
<p id="section-1.6.2-2.6.2">
Although the process whereby a client resolves the DNS domain name
of an application service can involve several steps (e.g., this is
true of resolutions that depend on DNS SRV resource records, Naming
Authority Pointer (NAPTR) DNS resource records <span>[<a href="#NAPTR" class="xref">NAPTR</a>]</span>, and
related technologies such as <span>[<a href="#S-NAPTR" class="xref">S-NAPTR</a>]</span>), for our purposes we care
only about the fact that the client needs to verify the identity of
the entity with which it communicates as a result of the resolution
process.
Thus the resolution process itself is out of scope for this
specification.<a href="#section-1.6.2-2.6.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.2-2.7">
              <p id="section-1.6.2-2.7.1">User interface issues.<a href="#section-1.6.2-2.7.1" class="pilcrow">¶</a></p>
<p id="section-1.6.2-2.7.2">
In general, such issues are properly the responsibility of client
software developers and standards development organizations
dedicated to particular application technologies (see, for example,
<span>[<a href="#WSC-UI" class="xref">WSC-UI</a>]</span>).<a href="#section-1.6.2-2.7.2" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-1.7">
        <h3 id="name-terminology-2">
<a href="#section-1.7" class="section-number selfRef">1.7. </a><a href="#name-terminology-2" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.7-1">Because many concepts related to "identity" are often too vague to be actionable
in application protocols, we define a set of more concrete terms for use
in this specification.<a href="#section-1.7-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.7-2">
          <dt id="section-1.7-2.1">
application service:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.2">
            <p id="section-1.7-2.2.1">A service on the Internet that enables interactive and automated clients
to connect for the purpose of retrieving or uploading information, communicating
with other entities, or connecting to a broader network of services.<a href="#section-1.7-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.3">
application service provider:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.4">
            <p id="section-1.7-2.4.1">An organization or individual that hosts or deploys an application service.<a href="#section-1.7-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.5">
application service type:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.6">
            <p id="section-1.7-2.6.1">A formal identifier for the
application protocol used to provide a particular kind of application service
at a domain;
the application service type typically takes the form of a Uniform Resource
Identifier
scheme <span>[<a href="#URI" class="xref">URI</a>]</span> or a DNS SRV Service <span>[<a href="#DNS-SRV" class="xref">DNS-SRV</a>]</span>.<a href="#section-1.7-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.7">
attribute-type-and-value pair:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.8">
            <p id="section-1.7-2.8.1">A colloquial name for the ASN.1-based construction comprising a Relative
Distinguished Name (RDN), which itself is a building-block component of Distinguished
Names. See Section 2 of <span>[<a href="#LDAP-DN" class="xref">LDAP-DN</a>]</span>.<a href="#section-1.7-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.9">
automated client:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.10">
            <p id="section-1.7-2.10.1">A software agent or device that is not directly controlled by a human user.<a href="#section-1.7-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.11">
delegated domain:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.12">
            <p id="section-1.7-2.12.1">A domain name or host name that is explicitly configured for communicating
with the source domain, by either (a) the human user controlling an interactive
client or (b) a trusted administrator.  In case (a), one example of delegation
is an account setup that specifies the domain name of a particular host to
be used for retrieving information or connecting to a network, which might
be different from the server portion of the user's account name (e.g., a
server at mailhost.example.com for connecting to an IMAP server hosting an
email address of juliet@example.com).  In case (b), one example of delegation
is an admin-configured host-to-address/address-to-host lookup table.<a href="#section-1.7-2.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.13">
derived domain:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.14">
            <p id="section-1.7-2.14.1">A domain name or host name that a client has derived from the source domain
in an automated fashion (e.g., by means of a <span>[<a href="#DNS-SRV" class="xref">DNS-SRV</a>]</span> lookup).<a href="#section-1.7-2.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.15">
identifier:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.16">
            <p id="section-1.7-2.16.1">A particular instance of an identifier type that is either presented by a
server in a certificate or referenced by a client for matching purposes.<a href="#section-1.7-2.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.17">
identifier type:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.18">
            <p id="section-1.7-2.18.1">A formally defined category of identifier that can be included in a certificate
and therefore that can also be used for matching purposes.  For conciseness
and convenience, we define the following identifier types of interest, which
are based on those found in the PKIX specification <span>[<a href="#PKIX" class="xref">PKIX</a>]</span> and various PKIX extensions.<a href="#section-1.7-2.18.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7-2.18.2.1">CN-ID = a Relative Distinguished Name (RDN) in the certificate subject field
that contains one and only one attribute-type-and-value pair of type Common
Name (CN), where the value matches the overall form of a domain name (informally,
dot-separated letter-digit-hyphen labels); see <span>[<a href="#PKIX" class="xref">PKIX</a>]</span> and also <span>[<a href="#LDAP-SCHEMA" class="xref">LDAP-SCHEMA</a>]</span><a href="#section-1.7-2.18.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.7-2.18.2.2">DNS-ID = a subjectAltName entry of type dNSName; see <span>[<a href="#PKIX" class="xref">PKIX</a>]</span><a href="#section-1.7-2.18.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.7-2.18.2.3">SRV-ID = a subjectAltName entry of type otherName whose name form is SRVName;
see <span>[<a href="#SRVNAME" class="xref">SRVNAME</a>]</span><a href="#section-1.7-2.18.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.7-2.18.2.4">URI-ID = a subjectAltName entry of type uniformResourceIdentifier whose value
includes both (i) a "scheme" and (ii) a "host" component (or its equivalent)
that matches the "reg-name" rule (where the quoted terms represent
the associated <span>[<a href="#ABNF" class="xref">ABNF</a>]</span> productions from <span>[<a href="#URI" class="xref">URI</a>]</span>); see <span>[<a href="#PKIX" class="xref">PKIX</a>]</span> and <span>[<a href="#URI" class="xref">URI</a>]</span><a href="#section-1.7-2.18.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.19">
interactive client:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.20">
            <p id="section-1.7-2.20.1">A software agent or device that is directly controlled by a human user.
(Other specifications related to security and application protocols, such
as <span>[<a href="#WSC-UI" class="xref">WSC-UI</a>]</span>, often refer to this entity as a "user agent".)<a href="#section-1.7-2.20.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.21">
pinning:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.22">
            <p id="section-1.7-2.22.1">The act of establishing a cached name association between the application
service's certificate and one of the client's reference identifiers, despite
the fact that none of the presented identifiers matches the given reference
identifier.  Pinning is accomplished by allowing a human user to positively
accept the mismatch during an attempt to communicate with the application
service.  Once a cached name association is established, the
certificate is said to be pinned to the reference identifier and in
future communication attempts the client simply verifies that the
service's presented certificate matches the pinned certificate, as
described under <a href="#verify-outcome-pin" class="xref">Section 6.6.2</a>.
(A similar definition of "pinning" is provided in <span>[<a href="#WSC-UI" class="xref">WSC-UI</a>]</span>.)<a href="#section-1.7-2.22.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.23">
PKIX:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.24">
            <p id="section-1.7-2.24.1">PKIX is a short name for the Internet Public Key Infrastructure using X.509
defined in RFC 5280 <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>, which comprises a profile of the X.509v3 certificate
specifications and X.509v2 certificate revocation list (CRL) specifications
for use in the Internet.<a href="#section-1.7-2.24.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.25">
PKIX-based system:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.26">
            <p id="section-1.7-2.26.1">A software implementation or deployed service that makes use of X.509v3 certificates
and X.509v2 certificate revocation lists (CRLs).<a href="#section-1.7-2.26.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.27">
PKIX certificate:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.28">
            <p id="section-1.7-2.28.1">An X.509v3 certificate generated and employed in the context of PKIX.<a href="#section-1.7-2.28.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.29">
presented identifier:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.30">
            <p id="section-1.7-2.30.1">An identifier that is presented by a server to a client within a
PKIX certificate when the client attempts to establish secure
communication with the server; the certificate can include one or
more presented identifiers of different types, and if the server
hosts more than one domain then the certificate might present
distinct identifiers for each domain.<a href="#section-1.7-2.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.31">
reference identifier:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.32">
            <p id="section-1.7-2.32.1">An identifier, constructed from a source domain and optionally an
application service type, used by the client for matching purposes
when examining presented identifiers.<a href="#section-1.7-2.32.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.33">
source domain:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.34">
            <p id="section-1.7-2.34.1">The fully qualified DNS domain name
that a client expects an application service to present in the certificate
(e.g., <code>www.example.com</code>), typically input by a human user, configured into
a
client, or provided by reference such as in a hyperlink.  The combination
of a
source domain and, optionally, an application service type enables a client
to construct one or more reference identifiers.<a href="#section-1.7-2.34.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.35">
subjectAltName entry:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.36">
            <p id="section-1.7-2.36.1">An identifier placed in a subjectAltName extension.<a href="#section-1.7-2.36.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.37">
subjectAltName extension:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.38">
            <p id="section-1.7-2.38.1">A standard PKIX certificate extension <span>[<a href="#PKIX" class="xref">PKIX</a>]</span> enabling identifiers
of various types to be bound to the certificate subject -- in
addition to, or in place of, identifiers that may be embedded within
or provided as a certificate's subject field.<a href="#section-1.7-2.38.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.39">
subject field:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.40">
            <p id="section-1.7-2.40.1">The subject field of a PKIX certificate identifies the entity
associated with the public key stored in the subject public key
field (see Section 4.1.2.6 of <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>).<a href="#section-1.7-2.40.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.41">
subject name:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.42">
            <p id="section-1.7-2.42.1">In an overall sense, a subject's name(s) can be represented by or in
the subject field, the subjectAltName extension, or both (see
<span>[<a href="#PKIX" class="xref">PKIX</a>]</span> for details).
More specifically, the term often refers to the name of a PKIX
certificate's subject, encoded as the X.501 type Name and conveyed
in a certificate's subject field (see Section 4.1.2.6 of <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>).<a href="#section-1.7-2.42.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.43">
TLS client:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.44">
            <p id="section-1.7-2.44.1">An entity that assumes the role of a client in a Transport Layer
Security <span>[<a href="#TLS" class="xref">TLS</a>]</span> negotiation. In this specification we generally
assume that the TLS client is an (interactive or automated)
application client; however, in application protocols that enable
server-to-server communication, the TLS client could be a peer
application service.<a href="#section-1.7-2.44.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.7-2.45">
TLS server:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.7-2.46">
            <p id="section-1.7-2.46.1">An entity that assumes the role of a server in a Transport Layer
Security <span>[<a href="#TLS" class="xref">TLS</a>]</span> negotiation; in this specification we assume that
the TLS server is an application service.<a href="#section-1.7-2.46.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.7-3">Most security-related terms in this document are to be understood in
the sense defined in <span>[<a href="#SECTERMS" class="xref">SECTERMS</a>]</span>; such terms include, but are not
limited to, "attack," "authentication," "authorization,"
"certification authority," "certification path," "certificate,"
"credential," "identity," "self-signed certificate," "trust," "trust
anchor," "trust chain," "validate," and "verify".<a href="#section-1.7-3" class="pilcrow">¶</a></p>
<p id="section-1.7-4">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL</span>
NOT", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.7-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="names">
<section id="section-2">
      <h2 id="name-naming-of-application-servic">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-naming-of-application-servic" class="section-name selfRef">Naming of Application Services</a>
      </h2>
<p id="section-2-1">This section discusses naming of application services on the Internet, followed
by a brief tutorial about subject naming in PKIX.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="names-apps">
<section id="section-2.1">
        <h3 id="name-naming-application-services-2">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-naming-application-services-2" class="section-name selfRef">Naming Application Services</a>
        </h3>
<p id="section-2.1-1">This specification assumes that the name of an application service is
based on a DNS domain name (e.g., <code>example.com</code>) -- supplemented in
some circumstances by an application service type (e.g., "the IMAP
server at example.com").<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">From the perspective of the application client or user, some names
are direct because they are provided directly by a human user (e.g., via
runtime input, prior configuration, or explicit acceptance of a client
communication attempt), whereas other names are indirect because they are
automatically resolved by the client based on user input (e.g., a target
name
resolved from a source name using DNS SRV or NAPTR records). This dimension
matters most for certificate consumption, specifically verification as
discussed in this document.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">From the perspective of the application service, some names are unrestricted
because they can be used in any type of service (e.g., a certificate might
be reused for both the HTTP service and the IMAP service at example.com),
whereas other names are restricted because they can be used in only one type
of service (e.g., a special-purpose certificate that can be used only for
an IMAP service).  This dimension matters most for certificate issuance.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Therefore, we can categorize the identifier types of interest as follows:<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-5.1">A CN-ID is direct and unrestricted.<a href="#section-2.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.2">A DNS-ID is direct and unrestricted.<a href="#section-2.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.3">An SRV-ID can be either direct or (more typically) indirect, and is restricted.<a href="#section-2.1-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.4">A URI-ID is direct and restricted.<a href="#section-2.1-5.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-6">We summarize this taxonomy in the following table.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1-7">
<pre>
  +-----------+-----------+---------------+
  |           |  Direct   |  Restricted   |
  +-----------+-----------+---------------+
  |  CN-ID    |  Yes      |  No           |
  +-----------+-----------+---------------+
  |  DNS-ID   |  Yes      |  No           |
  +-----------+-----------+---------------+
  |  SRV-ID   |  Either   |  Yes          |
  +-----------+-----------+---------------+
  |  URI-ID   |  Yes      |  Yes          |
  +-----------+-----------+---------------+
</pre><a href="#section-2.1-7" class="pilcrow">¶</a>
</div>
<p id="section-2.1-8">When implementing software, deploying services, and issuing certificates
for secure PKIX-based authentication, it is important to keep these distinctions
in mind.  In particular, best practices differ somewhat for application server
implementations, application client implementations, application service
providers, and certification authorities.  Ideally, protocol specifications
that reference this document will specify which identifiers are mandatory-to-implement
by servers and clients, which identifiers ought to be supported by certificate
issuers, and which identifiers ought to be requested by application service
providers.  Because these requirements differ across applications, it is
impossible to categorically stipulate universal rules (e.g., that all software
implementations, service providers, and certification authorities for all
application protocols need to use or support DNS-IDs as a baseline for the
purpose of interoperability).<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">However, it is preferable that each application protocol will at least define
a baseline that applies to the community of software developers, application
service providers, and CAs actively using or supporting that technology (one
such community, the CA/Browser Forum, has codified such a baseline for "Extended
Validation Certificates" in <span>[<a href="#EV-CERTS" class="xref">EV-CERTS</a>]</span>).<a href="#section-2.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="names-dns">
<section id="section-2.2">
        <h3 id="name-dns-domain-names-2">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-dns-domain-names-2" class="section-name selfRef">DNS Domain Names</a>
        </h3>
<p id="section-2.2-1">For the purposes of this specification, the name of an application service
is (or is based on) a DNS domain name that conforms to one of the following
forms:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2-2">
          <li id="section-2.2-2.1">A "traditional domain name," i.e., a fully qualified DNS domain
  name or "FQDN" (see <span>[<a href="#DNS-CONCEPTS" class="xref">DNS-CONCEPTS</a>]</span>) all of whose labels are "LDH
  labels" as described in <span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>]</span>.
  Informally, such labels are constrained to <span>[<a href="#US-ASCII" class="xref">US-ASCII</a>]</span> letters,
  digits, and the hyphen, with the hyphen prohibited in the first
  character position.
  Additional qualifications apply (please refer to the
  above-referenced specifications for details), but they are not
  relevant to this specification.<a href="#section-2.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.2">An "internationalized domain name," i.e., a DNS domain name that
  conforms to the overall form of a domain name (informally,
  dot-separated letter-digit-hyphen labels) but includes at least one
  label containing appropriately encoded Unicode code points outside
  the traditional US-ASCII range. That is, it contains at least one
  U-label or A-label, but otherwise may contain any mixture of NR-LDH
  labels, A-labels, or U-labels, as described in <span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>]</span> and the
  associated documents.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="names-pkix">
<section id="section-2.3">
        <h3 id="name-subject-naming-in-pkix-certi">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-subject-naming-in-pkix-certi" class="section-name selfRef">Subject Naming in PKIX Certificates</a>
        </h3>
<p id="section-2.3-1">In theory, the Internet Public Key Infrastructure using X.509 <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>
employs the global directory service model defined in <span>[<a href="#X.500" class="xref">X.500</a>]</span> and
<span>[<a href="#X.501" class="xref">X.501</a>]</span>.
Under that model, information is held in a directory information base
(DIB) and entries in the DIB are organized in a hierarchy called the
directory information tree (DIT).
An object or alias entry in that hierarchy consists of a set of
attributes (each of which has a defined type and one or more values)
and is uniquely identified by a Distinguished Name (DN).
The DN of an entry is constructed by combining the Relative
Distinguished Names of its superior entries in the tree (all the way
down to the root of the DIT) with one or more specially nominated
attributes of the entry itself (which together comprise the Relative
Distinguished Name (RDN) of the entry, so-called because it is
relative to the Distinguished Names of the superior entries in the
tree).
The entry closest to the root is sometimes referred to as the "most
significant" entry, and the entry farthest from the root is sometimes
referred to as the "least significant" entry.
An RDN is a set (i.e., an unordered group) of attribute-type-and-value
pairs (see also <span>[<a href="#LDAP-DN" class="xref">LDAP-DN</a>]</span>), each of which asserts some attribute
about the entry.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">In practice, the certificates used in <span>[<a href="#X.509" class="xref">X.509</a>]</span> and <span>[<a href="#PKIX" class="xref">PKIX</a>]</span> borrow
key concepts from X.500 and X.501 (e.g., DNs and RDNs) to identify
entities, but such certificates are not necessarily part of a global
directory information base.
Specifically, the subject field of a PKIX certificate is an X.501 type
Name that "identifies the entity associated with the public key stored
in the subject public key field" (see Section 4.1.2.6 of <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>).
However, it is perfectly acceptable for the subject field to be empty,
as long as the certificate contains a subject alternative name
("subjectAltName") extension that includes at least one subjectAltName
entry, because the subjectAltName extension allows various identities
to be bound to the subject (see Section 4.2.1.6 of <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>).
The subjectAltName extension itself is a sequence of typed entries,
where each type is a distinct kind of identifier.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">For our purposes, an application service can be identified by a name
or names carried in the subject field (i.e., a CN-ID) and/or in one of
the following identifier types within subjectAltName entries:<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-4.1">DNS-ID<a href="#section-2.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-4.2">SRV-ID<a href="#section-2.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-4.3">URI-ID<a href="#section-2.3-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.3-5">Existing certificates often use a CN-ID in the subject field to
represent a fully qualified DNS domain name; for example, consider the
following three subject names, where the attribute of type Common Name contains
a string whose form matches that of a fully qualified DNS domain name (<code>im.example.org</code>,
<code>mail.example.net</code>, and <code>www.example.com</code>, respectively):<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.3-6">
<pre>
     CN=im.example.org,O=Example Org,C=GB

     C=CA,O=Example Internetworking,CN=mail.example.net

     O=Examples-R-Us,CN=www.example.com,C=US
</pre><a href="#section-2.3-6" class="pilcrow">¶</a>
</div>
<p id="section-2.3-7">However, the Common Name is not strongly typed because a Common Name
might contain a human-friendly string for the service, rather than a string
whose form matches that of a fully qualified DNS domain name (a certificate
with such a single Common Name will typically have at least one subjectAltName
entry containing the fully qualified DNS domain name):<a href="#section-2.3-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.3-8">
<pre>
     CN=A Free Chat Service,O=Example Org,C=GB
</pre><a href="#section-2.3-8" class="pilcrow">¶</a>
</div>
<p id="section-2.3-9">Or, a certificate's subject might contain both a CN-ID as well as another
common name attribute containing a human-friendly string:<a href="#section-2.3-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.3-10">
<pre>
     CN=A Free Chat Service,CN=im.example.org,O=Example Org,C=GB
</pre><a href="#section-2.3-10" class="pilcrow">¶</a>
</div>
<p id="section-2.3-11">In general, this specification recommends and prefers use of subjectAltName
entries (DNS-ID, SRV-ID, URI-ID, etc.) over use of the subject field (CN-ID)
where possible, as more completely described in the following sections.
However, specifications that reuse this one can legitimately encourage continued
support for the CN-ID identifier type if they have good reasons to do so,
such as backward compatibility with deployed infrastructure (see, for example, <span>[<a href="#EV-CERTS" class="xref">EV-CERTS</a>]</span>).<a href="#section-2.3-11" class="pilcrow">¶</a></p>
<div id="names-pkix-notes">
<section id="section-2.3.1">
          <h4 id="name-implementation-notes-2">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-implementation-notes-2" class="section-name selfRef">Implementation Notes</a>
          </h4>
<p id="section-2.3.1-1">Confusion sometimes arises from different renderings or encodings of the
hierarchical information contained in a certificate.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">Certificates are binary objects and are encoded using the
Distinguished Encoding Rules (DER) specified in <span>[<a href="#X.690" class="xref">X.690</a>]</span>.
However, some implementations generate displayable (a.k.a. printable)
renderings of the certificate issuer, subject field, and
subjectAltName extension, and these renderings convert the DER-encoded
sequences into a "string representation" before being displayed.
Because a certificate subject field (of type Name <span>[<a href="#X.509" class="xref">X.509</a>]</span>, the same
as for a Distinguished Name (DN) <span>[<a href="#X.501" class="xref">X.501</a>]</span>) is an ordered sequence,
order is typically preserved in subject string representations,
although the two most prevalent subject (and DN) string
representations differ in employing left-to-right vs. right-to-left
ordering.
However, because a Relative Distinguished Name (RDN) is an unordered
group of attribute-type-and-value pairs, the string representation of
an RDN can differ from the canonical DER encoding (and the order of
attribute-type-and-value pairs can differ in the RDN string
representations or display orders provided by various
implementations).
Furthermore, various specifications refer to the order of RDNs in DNs
or certificate subject fields using terminology that is implicitly
related to an information hierarchy (which may or may not actually
exist), such as "most specific" vs. "least specific," "left-most"
vs. "right-most," "first" vs. "last," or "most significant" vs. "least
significant" (see, for example, <span>[<a href="#LDAP-DN" class="xref">LDAP-DN</a>]</span>).<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-2.3.1-3">To reduce confusion, in this specification we avoid such terms and
instead use the terms provided under <a href="#terminology" class="xref">Section 1.7</a>; in particular,
we do not use the term "(most specific) Common Name field in the
subject field" from <span>[<a href="#HTTP-TLS" class="xref">HTTP-TLS</a>]</span> and instead state that a CN-ID is a
Relative Distinguished Name (RDN) in the certificate subject
containing one and only one attribute-type-and-value pair of type
Common Name (thus removing the possibility that an RDN might contain
multiple AVAs (Attribute Value Assertions) of type CN, one of which
could be considered "most specific").<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
<p id="section-2.3.1-4">Finally, although theoretically some consider the order of RDNs within
a subject field to have meaning, in practice that rule is often not
observed.
An AVA of type CN is considered to be valid at any position within the
subject field.<a href="#section-2.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="design">
<section id="section-3">
      <h2 id="name-designing-application-protoc">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-designing-application-protoc" class="section-name selfRef">Designing Application Protocols</a>
      </h2>
<p id="section-3-1">This section provides guidelines for designers of application protocols,
in the form of a checklist to follow when reusing the recommendations provided
in this document.<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">Does your technology use DNS SRV records to resolve the DNS domain
names of application services?
If so, consider recommending or requiring support for the SRV-ID
identifier type in PKIX certificates issued and used in your
technology community.
(Note that many existing application technologies use DNS SRV
records to resolve the DNS domain names of application services, but
do not rely on representations of those records in PKIX certificates
by means of SRV-IDs as defined in <span>[<a href="#SRVNAME" class="xref">SRVNAME</a>]</span>.)<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">Does your technology use URIs to identify application services?
If so, consider recommending or requiring support for the URI-ID
identifier type.
(Note that many existing application technologies use URIs to
identify application services, but do not rely on representation of
those URIs in PKIX certificates by means of URI-IDs.)<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.3">Does your technology need to use DNS domain names in the Common Name
of certificates for the sake of backward compatibility?
If so, consider recommending support for the CN-ID identifier type
as a fallback.<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.4">Does your technology need to allow the wildcard character in DNS
domain names?
If so, consider recommending support for wildcard certificates, and
specify exactly where the wildcard character is allowed to occur
(e.g., only the complete left-most label of a DNS domain name).<a href="#section-3-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-3">Sample text is provided under <a href="#text" class="xref">Appendix A</a>.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="represent">
<section id="section-4">
      <h2 id="name-representing-server-identity">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-representing-server-identity" class="section-name selfRef">Representing Server Identity</a>
      </h2>
<p id="section-4-1">This section provides rules and guidelines for issuers of
certificates.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="represent-rules">
<section id="section-4.1">
        <h3 id="name-rules-3">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-rules-3" class="section-name selfRef">Rules</a>
        </h3>
<p id="section-4.1-1">When a certification authority issues a certificate based on the fully
qualified DNS domain name at which the application service provider
will provide the relevant application, the following rules apply to
the representation of application service identities.
The reader needs to be aware that some of these rules are cumulative
and can interact in important ways that are illustrated later in this
document.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-2">
          <li id="section-4.1-2.1">The certificate <span class="bcp14">SHOULD</span> include a "DNS-ID" if possible as a baseline
for interoperability.<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.2">If the service using the certificate deploys a technology for which
  the relevant specification stipulates that certificates ought to
  include identifiers of type SRV-ID (e.g., this is true of <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>),
  then the certificate <span class="bcp14">SHOULD</span> include an SRV-ID.<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.3">If the service using the certificate deploys a technology for which
  the relevant specification stipulates that certificates ought to
  include identifiers of type URI-ID (e.g., this is true of <span>[<a href="#SIP" class="xref">SIP</a>]</span> as
  specified by <span>[<a href="#SIP-CERTS" class="xref">SIP-CERTS</a>]</span>, but not true of <span>[<a href="#HTTP" class="xref">HTTP</a>]</span> since
  <span>[<a href="#HTTP-TLS" class="xref">HTTP-TLS</a>]</span> does not describe usage of a URI-ID for HTTP services),
  then the certificate <span class="bcp14">SHOULD</span> include a URI-ID.
  The scheme <span class="bcp14">SHALL</span> be that of the protocol associated with the
  application service type and the "host" component (or its
  equivalent) <span class="bcp14">SHALL</span> be the fully qualified DNS domain name of the
  service.
  A specification that reuses this one <span class="bcp14">MUST</span> specify which URI schemes
  are to be considered acceptable in URI-IDs contained in PKIX
  certificates used for the application protocol (e.g., <code>sip</code> but not
  <code>sips</code> or <code>tel</code> for SIP as described in <span>[<a href="#SIP-SIPS" class="xref">SIP-SIPS</a>]</span>, or perhaps
  http and https for HTTP as might be described in a future
  specification).<a href="#section-4.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.4">The certificate <span class="bcp14">MAY</span> include other application-specific identifiers
  for types that were defined before publication of <span>[<a href="#SRVNAME" class="xref">SRVNAME</a>]</span> (e.g.,
  XmppAddr for <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>) or for which service names or URI schemes do
  not exist; however, such application-specific identifiers are not
  applicable to all application technologies and therefore are out of
  scope for this specification.<a href="#section-4.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.5">Even though many deployed clients still check for the CN-ID within
  the certificate subject field, certification authorities are
  encouraged to migrate away from issuing certificates that represent
  the server's fully qualified DNS domain name in a CN-ID.
  Therefore, the certificate <span class="bcp14">SHOULD NOT</span> include a CN-ID unless the
  certification authority issues the certificate in accordance with a
  specification that reuses this one and that explicitly encourages
  continued support for the CN-ID identifier type in the context of a
  given application technology.<a href="#section-4.1-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.6">The certificate <span class="bcp14">MAY</span> contain more than one DNS-ID, SRV-ID, or URI-ID
  but <span class="bcp14">SHOULD NOT</span> contain more than one CN-ID, as further explained
  under <a href="#security-multi" class="xref">Section 7.4</a>.<a href="#section-4.1-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.7">Unless a specification that reuses this one allows continued
  support for the wildcard character <code>*</code>, the DNS domain name portion
  of a presented identifier <span class="bcp14">SHOULD NOT</span> contain the wildcard character,
  whether as the complete left-most label within the identifier
  (following the description of labels and domain names in
  <span>[<a href="#DNS-CONCEPTS" class="xref">DNS-CONCEPTS</a>]</span>, e.g., <code>*.example.com</code>) or as a fragment thereof
  (e.g., <code>*oo.example.com</code>, <code>f*o.example.com</code>, or <code>fo*.example.com</code>). A
  more detailed discussion of so-called "wildcard certificates" is
  provided under <a href="#security-wildcards" class="xref">Section 7.2</a>.<a href="#section-4.1-2.7" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="represent-examples">
<section id="section-4.2">
        <h3 id="name-examples-3">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-examples-3" class="section-name selfRef">Examples</a>
        </h3>
<p id="section-4.2-1">Consider a simple website at <code>www.example.com</code>, which is not
discoverable via DNS SRV lookups.
Because HTTP does not specify the use of URIs in server certificates,
a certificate for this service might include only a DNS-ID of
<code>www.example.com</code>.
It might also include a CN-ID of <code>www.example.com</code> for backward
compatibility with deployed infrastructure.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Consider an IMAP-accessible email server at the host
<code>mail.example.net</code> servicing email addresses of the form
<code>user@example.net</code> and discoverable via DNS SRV lookups on the
application service name of <code>example.net</code>.
A certificate for this service might include SRV-IDs of
<code>_imap.example.net</code> and <code>_imaps.example.net</code> (see <span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span>) along
with DNS-IDs of <code>example.net</code> and <code>mail.example.net</code>.
It might also include CN-IDs of <code>example.net</code> and <code>mail.example.net</code>
for backward compatibility with deployed infrastructure.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Consider a SIP-accessible voice-over-IP (VoIP) server at the host
<code>voice.example.edu</code> servicing SIP addresses of the form
<code>user@voice.example.edu</code> and identified by a URI of
&lt;sip:voice.example.edu&gt;.
A certificate for this service would include a URI-ID of
<code>sip:voice.example.edu</code> (see <span>[<a href="#SIP-CERTS" class="xref">SIP-CERTS</a>]</span>) along with a DNS-ID of
<code>voice.example.edu</code>.
It might also include a CN-ID of <code>voice.example.edu</code> for backward
compatibility with deployed infrastructure.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Consider an XMPP-compatible instant messaging (IM) server at the host
<code>im.example.org</code> servicing IM addresses of the form
<code>user@im.example.org</code> and discoverable via DNS SRV lookups on the
<code>im.example.org</code> domain.
A certificate for this service might include SRV-IDs of
<code>_xmpp-client.im.example.org</code> and
<code>_xmpp-server.im.example.org</code> (see <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>), a DNS-ID of
<code>im.example.org</code>, and an XMPP-specific <code>XmppAddr</code> of <code>im.example.org</code>
(see <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>).
It might also include a CN-ID of <code>im.example.org</code> for backward
compatibility with deployed infrastructure.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="request">
<section id="section-5">
      <h2 id="name-requesting-server-certificat">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-requesting-server-certificat" class="section-name selfRef">Requesting Server Certificates</a>
      </h2>
<p id="section-5-1">This section provides rules and guidelines for service providers regarding
the information to include in certificate signing requests (CSRs).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">In general, service providers are encouraged to request certificates that
include all of the identifier types that are required or recommended for
the application service type that will be secured using the certificate to
be issued.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">If the certificate might be used for any type of application service, then
the service provider is encouraged to request a certificate that includes
only a DNS-ID.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">If the certificate will be used for only a single type of application
service, then the service provider is encouraged to request a certificate
that
includes a DNS-ID and, if appropriate for the application service type, an
SRV-ID or URI-ID
that limits the deployment scope of the certificate to only the defined
application service type.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">If a service provider offering multiple application service types
(e.g., a World Wide Web service, an email service, and an instant
messaging service) wishes to limit the applicability of certificates
using SRV-IDs or URI-IDs, then the service provider is encouraged to
request multiple certificates, i.e., one certificate per application
service type. Conversely, the service provider is discouraged from
requesting a single certificate containing multiple SRV-IDs or URI-IDs
identifying each different application service type.
This guideline does not apply to application service type "bundles"
that are used to identify manifold distinct access methods to the same
underlying application (e.g., an email application with access methods
denoted by the application service types of <code>imap</code>, <code>imaps</code>, <code>pop3</code>,
<code>pop3s</code>, and <code>submission</code> as described in <span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span>).<a href="#section-5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify">
<section id="section-6">
      <h2 id="name-verifying-service-identity-2">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-verifying-service-identity-2" class="section-name selfRef">Verifying Service Identity</a>
      </h2>
<p id="section-6-1">This section provides rules and guidelines for implementers of application
client software regarding algorithms for verification of application service
identity.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="verify-overview">
<section id="section-6.1">
        <h3 id="name-overview-2">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-overview-2" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-6.1-1">At a high level, the client verifies the application service's
identity by performing the actions listed below (which are defined in
the following subsections of this document):<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-2">
          <li id="section-6.1-2.1">The client constructs a list of acceptable reference identifiers
  based on the source domain and, optionally, the type of service to
  which the client is connecting.<a href="#section-6.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.2">The server provides its identifiers in the form of a PKIX
certificate.<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.3">The client checks each of its reference identifiers against the
  presented identifiers for the purpose of finding a match.<a href="#section-6.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.4">When checking a reference identifier against a presented
  identifier, the client matches the source domain of the identifiers
  and, optionally, their application service type.<a href="#section-6.1-2.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.1-3">Naturally, in addition to checking identifiers, a client might
complete further checks to ensure that the server is authorized to
provide the requested service.
However, such checking is not a matter of verifying the application
service identity presented in a certificate, and therefore methods for
doing so (e.g., consulting local policy information) are out of scope
for this document.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-reference">
<section id="section-6.2">
        <h3 id="name-constructing-a-list-of-refer">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-constructing-a-list-of-refer" class="section-name selfRef">Constructing a List of Reference Identifiers</a>
        </h3>
<div id="verify-reference-rules">
<section id="section-6.2.1">
          <h4 id="name-rules-4">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-rules-4" class="section-name selfRef">Rules</a>
          </h4>
<p id="section-6.2.1-1">The client <span class="bcp14">MUST</span> construct a list of acceptable reference identifiers,
and <span class="bcp14">MUST</span> do so independently of the identifiers presented by the
service.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">The inputs used by the client to construct its list of reference
identifiers might be a URI that a user has typed into an interface
(e.g., an HTTPS URL for a website), configured account information
(e.g., the domain name of a particular host or URI used for retrieving
information or connecting to a network, which might be different from
the DNS domain name portion of a username), a hyperlink in a web page
that triggers a browser to retrieve a media object or script, or some
other combination of information that can yield a source domain and an
application service type.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<p id="section-6.2.1-3">The client might need to extract the source domain and application
service type from the input(s) it has received.
The extracted data <span class="bcp14">MUST</span> include only information that can be securely
parsed out of the inputs (e.g., parsing the fully qualified DNS domain
name out of the "host" component (or its equivalent) of a URI or
deriving the application service type from the scheme of a URI) or
information that is derived in a manner not subject to subversion by
network attackers (e.g., pulling the data from a delegated domain that
is explicitly established via client or system configuration,
resolving the data via <span>[<a href="#DNSSEC" class="xref">DNSSEC</a>]</span>, or obtaining the data from a
third-party domain mapping service in which a human user has
explicitly placed trust and with which the client communicates over a
connection or association that provides both mutual authentication and
integrity checking).
These considerations apply only to extraction of the source domain
from the inputs; naturally, if the inputs themselves are invalid or
corrupt (e.g., a user has clicked a link provided by a malicious
entity in a phishing attack), then the client might end up
communicating with an unexpected application service.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6.2.1-4.1">Example: Given an input URI of &lt;sips:alice@example.net&gt;, a client
would derive the application service type <code>sip</code> from the "scheme"
and parse the domain name <code>example.net</code> from the "host" component
(or its equivalent).<a href="#section-6.2.1-4.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-5">Each reference identifier in the list <span class="bcp14">SHOULD</span> be based on the source
domain and <span class="bcp14">SHOULD NOT</span> be based on a derived domain (e.g., a host name
or domain name discovered through DNS resolution of the source
domain).
This rule is important because only a match between the user inputs
and a presented identifier enables the client to be sure that the
certificate can legitimately be used to secure the client's
communication with the server.
There is only one scenario in which it is acceptable for an
interactive client to override the recommendation in this rule and
therefore communicate with a domain name other than the source domain:
because a human user has "pinned" the application service's
certificate to the alternative domain name as further discussed under
<a href="#verify-outcome-fallback" class="xref">Section 6.6.4</a> and <a href="#security-pinning" class="xref">Section 7.1</a>.
In this case, the inputs used by the client to construct its list of
reference identifiers might include more than one fully qualified DNS
domain name, i.e., both (a) the source domain and (b) the alternative
domain contained in the pinned certificate.<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<p id="section-6.2.1-6">Using the combination of fully qualified DNS domain name(s) and
application service type, the client constructs a list of reference identifiers
in accordance with the following rules:<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-7.1">The list <span class="bcp14">SHOULD</span> include a DNS-ID.
A reference identifier of type DNS-ID can be directly constructed
from a fully qualified DNS domain name that is (a) contained in or
securely derived from the inputs (i.e., the source domain), or (b)
explicitly associated with the source domain by means of user
configuration (i.e., a derived domain).<a href="#section-6.2.1-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-7.2">If a server for the application service type is typically discovered
by means of DNS SRV records, then the list <span class="bcp14">SHOULD</span> include an SRV-ID.<a href="#section-6.2.1-7.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-7.3">If a server for the application service type is typically associated
with a URI for security purposes (i.e., a formal protocol document
specifies the use of URIs in server certificates), then the list
<span class="bcp14">SHOULD</span> include a URI-ID.<a href="#section-6.2.1-7.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-7.4">
              <p id="section-6.2.1-7.4.1">The list <span class="bcp14">MAY</span> include a CN-ID, mainly for the sake of backward
compatibility with deployed infrastructure.<a href="#section-6.2.1-7.4.1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-7.4.2">
Which identifier types a client includes in its list of reference
identifiers is a matter of local policy.
For example, in certain deployment environments, a client that is
built to connect only to a particular kind of service (e.g., only IM
services) might be configured to accept as valid only certificates
that include an SRV-ID for that application service type; in this
case, the client would include only SRV-IDs matching the application
service type in its list of reference identifiers (not, for example,
DNS-IDs).
By contrast, a more lenient client (even one built to connect only
to a particular kind of service) might include both SRV-IDs and
DNS-IDs in its list of reference identifiers.<a href="#section-6.2.1-7.4.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6.2.1-8.1">Implementation Note: It is highly likely that implementers of client software
will need to support CN-IDs for the foreseeable future, because certificates
containing CN-IDs are so widely deployed.  Implementers are advised to monitor
the state of the art with regard to certificate issuance policies and migrate
away from support CN-IDs in the future if possible.<a href="#section-6.2.1-8.1" class="pilcrow">¶</a>
</li>
          </ul>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6.2.1-9.1">Implementation Note: The client does not need to construct the foregoing
identifiers in the actual formats found in a certificate (e.g., as ASN.1
types); it only needs to construct the functional equivalent of such identifiers
for matching purposes.<a href="#section-6.2.1-9.1" class="pilcrow">¶</a>
</li>
          </ul>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6.2.1-10.1">Security Warning: A client <span class="bcp14">MUST NOT</span> construct a reference identifier corresponding
to Relative Distinguished Names (RDNs) other than those of type Common Name
and <span class="bcp14">MUST NOT</span> check for RDNs other than those of type Common Name in the presented
identifiers.<a href="#section-6.2.1-10.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="verify-reference-examples">
<section id="section-6.2.2">
          <h4 id="name-examples-4">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-examples-4" class="section-name selfRef">Examples</a>
          </h4>
<p id="section-6.2.2-1">A web browser that is connecting via HTTPS to the website at <code>www.example.com</code>
might have two reference identifiers: a DNS-ID of <code>www.example.com</code> and,
as a fallback, a CN-ID of <code>www.example.com</code>.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2.2-2">A mail user agent that is connecting via IMAPS to the email
service at <code>example.net</code> (resolved as <code>mail.example.net</code>) might have five
reference identifiers: an SRV-ID of <code>_imaps.example.net</code> (see <span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span>),
DNS-IDs of <code>example.net</code> and <code>mail.example.net</code>, and, as a fallback, CN-IDs
of <code>example.net</code> and <code>mail.example.net</code>. (A legacy email user agent would
not support <span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span> and therefore would probably be explicitly configured to
connect to <code>mail.example.net</code>, whereas an SRV-aware user agent would derive
<code>example.net</code> from an email address of the form <code>user@example.net</code> but might
also accept <code>mail.example.net</code> as the DNS domain name portion of reference
identifiers for the service.)<a href="#section-6.2.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2.2-3">A voice-over-IP (VoIP) user agent that is connecting via SIP to the voice
service at <code>voice.example.edu</code> might have only one reference identifier:
a URI-ID of <code>sip:voice.example.edu</code> (see <span>[<a href="#SIP-CERTS" class="xref">SIP-CERTS</a>]</span>).<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2.2-4">An instant messaging (IM) client that is connecting via XMPP to the IM
service at <code>im.example.org</code> might have three reference identifiers: an
SRV-ID of <code>_xmpp-client.im.example.org</code> (see <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>), a DNS-ID of
<code>im.example.org</code>, and an XMPP-specific <code>XmppAddr</code> of <code>im.example.org</code>
(see <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>).<a href="#section-6.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="verify-seek">
<section id="section-6.3">
        <h3 id="name-preparing-to-seek-a-match-2">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-preparing-to-seek-a-match-2" class="section-name selfRef">Preparing to Seek a Match</a>
        </h3>
<p id="section-6.3-1">Once the client has constructed its list of reference identifiers and has
received the server's presented identifiers in the form of a PKIX certificate,
the client checks its reference identifiers against the presented identifiers
for the purpose of finding a match.  The search fails if the client exhausts
its list of reference identifiers without finding a match.  The search succeeds
if any presented identifier matches one of the reference identifiers, at
which point the client <span class="bcp14">SHOULD</span> stop the search.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6.3-2.1">Implementation Note: A client might be configured to perform
multiple searches, i.e., to match more than one reference
identifier.
Although such behavior is not forbidden by this specification, rules
for matching multiple reference identifiers are a matter for
implementation or future specification.<a href="#section-6.3-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6.3-3.1">Security Warning: A client <span class="bcp14">MUST NOT</span> seek a match for a reference identifier
of CN-ID if the presented identifiers include a DNS-ID, SRV-ID, URI-ID, or
any application-specific identifier types supported by the client.<a href="#section-6.3-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-4">Before applying the comparison rules provided in the following
sections, the client might need to split the reference identifier into
its DNS domain name portion and its application service type portion,
as follows:<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.1">A reference identifier of type DNS-ID does not include an
application service type portion and thus can be used directly as the DNS
domain name for comparison purposes.  As an example, a DNS-ID of <code>www.example.com</code>
would result in a DNS domain name portion of <code>www.example.com</code>.<a href="#section-6.3-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-5.2">A reference identifier of type CN-ID also does not include an
application service type portion and thus can be used directly as the DNS
domain name for comparison purposes.  As previously mentioned, this document
specifies that a CN-ID always contains a string whose form matches that of
a DNS domain name (thus differentiating a CN-ID from a Common Name containing
a human-friendly name).<a href="#section-6.3-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-5.3">For a reference identifier of type SRV-ID, the DNS domain name
portion is the Name and the application service type portion is the Service.
As an example, an SRV-ID of <code>_imaps.example.net</code> would be split into a DNS
domain name portion of <code>example.net</code> and an application service type portion
of <code>imaps</code> (mapping to an application protocol of IMAP as explained in <span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span>).<a href="#section-6.3-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-5.4">For a reference identifier of type URI-ID, the DNS domain name
portion is the "reg-name" part of the "host" component (or its
equivalent) and the application service type portion is the
application service type associated with the scheme name matching
the <span>[<a href="#ABNF" class="xref">ABNF</a>]</span> "scheme" rule from <span>[<a href="#URI" class="xref">URI</a>]</span> (not including the ':'
separator).
As previously mentioned, this document specifies that a URI-ID
always contains a "host" component (or its equivalent) containing a
"reg-name".
(Matching only the "reg-name" rule from <span>[<a href="#URI" class="xref">URI</a>]</span> limits verification
to DNS domain names, thereby differentiating a URI-ID from a
uniformResourceIdentifier entry that contains an IP address or a
mere host name, or that does not contain a "host" component at all.)
Furthermore, note that extraction of the "reg-name" might
necessitate normalization of the URI (as explained in <span>[<a href="#URI" class="xref">URI</a>]</span>).
As an example, a URI-ID of <code>sip:voice.example.edu</code> would be split
into a DNS domain name portion of <code>voice.example.edu</code> and an
application service type of <code>sip</code> (associated with an application
protocol of SIP as explained in <span>[<a href="#SIP-CERTS" class="xref">SIP-CERTS</a>]</span>).<a href="#section-6.3-5.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-6">Detailed comparison rules for matching the DNS domain name portion
and application service type portion of the reference identifier are provided
in the following sections.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-domain">
<section id="section-6.4">
        <h3 id="name-matching-the-dns-domain-name">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-matching-the-dns-domain-name" class="section-name selfRef">Matching the DNS Domain Name Portion</a>
        </h3>
<p id="section-6.4-1">The client <span class="bcp14">MUST</span> match the DNS domain name portion of a reference
identifier according to the following rules (and <span class="bcp14">SHOULD</span> also check the
application service type as described under <a href="#verify-app" class="xref">Section 6.5</a>).
The rules differ depending on whether the domain to be checked is a
"traditional domain name" or an "internationalized domain name" (as
defined under <a href="#names-dns" class="xref">Section 2.2</a>).
Furthermore, to meet the needs of clients that support presented
identifiers containing the wildcard character <code>*</code>, we define a
supplemental rule for so-called "wildcard certificates".
Finally, we also specify the circumstances under which it is
acceptable to check the CN-ID identifier type.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div id="verify-domain-trad">
<section id="section-6.4.1">
          <h4 id="name-checking-of-traditional-doma">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-checking-of-traditional-doma" class="section-name selfRef">Checking of Traditional Domain Names</a>
          </h4>
<p id="section-6.4.1-1">If the DNS domain name portion of a reference identifier is a
"traditional domain name," then matching of the reference identifier
against the presented identifier is performed by comparing the set of
domain name labels using a case-insensitive ASCII comparison, as
clarified by <span>[<a href="#DNS-CASE" class="xref">DNS-CASE</a>]</span> (e.g., <code>WWW.Example.Com</code> would be
lower-cased to <code>www.example.com</code> for comparison purposes).
Each label <span class="bcp14">MUST</span> match in order for the names to be considered to
match, except as supplemented by the rule about checking of wildcard
labels (<a href="#verify-domain-wildcards" class="xref">Section 6.4.3</a>).<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-domain-idn">
<section id="section-6.4.2">
          <h4 id="name-checking-of-internationalize">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-checking-of-internationalize" class="section-name selfRef">Checking of Internationalized Domain Names</a>
          </h4>
<p id="section-6.4.2-1">If the DNS domain name portion of a reference identifier is an
internationalized domain name, then an implementation <span class="bcp14">MUST</span> convert any
U-labels <span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>]</span> in the domain name to A-labels before checking
the domain name.
In accordance with <span>[<a href="#IDNA-PROTO" class="xref">IDNA-PROTO</a>]</span>, A-labels <span class="bcp14">MUST</span> be compared as
case-insensitive ASCII.
Each label <span class="bcp14">MUST</span> match in order for the domain names to be considered
to match, except as supplemented by the rule about checking of
wildcard labels (<a href="#verify-domain-wildcards" class="xref">Section 6.4.3</a>; but see also
<a href="#security-wildcards" class="xref">Section 7.2</a> regarding wildcards in internationalized domain
names).<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-domain-wildcards">
<section id="section-6.4.3">
          <h4 id="name-checking-of-wildcard-certifi">
<a href="#section-6.4.3" class="section-number selfRef">6.4.3. </a><a href="#name-checking-of-wildcard-certifi" class="section-name selfRef">Checking of Wildcard Certificates</a>
          </h4>
<p id="section-6.4.3-1">A client employing this specification's rules <span class="bcp14">MAY</span> match the
reference identifier against a presented identifier whose DNS domain name
portion contains the wildcard character <code>*</code> as part or all of a label
(following the description of labels and domain names in <span>[<a href="#DNS-CONCEPTS" class="xref">DNS-CONCEPTS</a>]</span>).<a href="#section-6.4.3-1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-2">For information regarding the security characteristics of wildcard certificates,
see <a href="#security-wildcards" class="xref">Section 7.2</a>.<a href="#section-6.4.3-2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-3">If a client matches the reference identifier against a presented identifier
whose DNS domain name portion contains the wildcard character <code>*</code>, the following
rules apply:<a href="#section-6.4.3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.4.3-4">
            <li id="section-6.4.3-4.1">The client <span class="bcp14">MUST NOT</span> attempt to match a presented identifier in which the
  wildcard character appears in other than the left-most label (e.g., do not
  match <code>bar.*.example.net</code>).<a href="#section-6.4.3-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.3-4.2">The client <span class="bcp14">MUST NOT</span> attempt to match a presented identifier if there are
  other characters before the wildcard character.<a href="#section-6.4.3-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.3-4.3">The client <span class="bcp14">MUST NOT</span> attempt to match a wildcard character against more than
  one label (e.g., <code>*.example.net</code> does not match 1api.foo.example.net`)<a href="#section-6.4.3-4.3" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.3-4.4">The client <span class="bcp14">MUST NOT</span> treat the label as having a wildcard if
  it is embedded with an
  A-label or U-label <span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>]</span> of an internationalized domain name <span>[<a href="#IDNA-PROTO" class="xref">IDNA-PROTO</a>]</span>.<a href="#section-6.4.3-4.4" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="verify-domain-cn">
<section id="section-6.4.4">
          <h4 id="name-checking-of-common-names-2">
<a href="#section-6.4.4" class="section-number selfRef">6.4.4. </a><a href="#name-checking-of-common-names-2" class="section-name selfRef">Checking of Common Names</a>
          </h4>
<p id="section-6.4.4-1">As noted, a client <span class="bcp14">MUST NOT</span> seek a match for a reference identifier of
CN-ID if the presented identifiers include a DNS-ID, SRV-ID, URI-ID,
or any application-specific identifier types supported by the client.<a href="#section-6.4.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4.4-2">Therefore, if and only if the presented identifiers do not include a
DNS-ID, SRV-ID, URI-ID, or any application-specific identifier types
supported by the client, then the client <span class="bcp14">MAY</span> as a last resort check
for a string whose form matches that of a fully qualified DNS domain
name in a Common Name field of the subject field (i.e., a CN-ID).
If the client chooses to compare a reference identifier of type CN-ID
against that string, it <span class="bcp14">MUST</span> follow the comparison rules for the DNS
domain name portion of an identifier of type DNS-ID, SRV-ID, or
URI-ID, as described under <a href="#verify-domain-trad" class="xref">Section 6.4.1</a>,
<a href="#verify-domain-idn" class="xref">Section 6.4.2</a>, and <a href="#verify-domain-wildcards" class="xref">Section 6.4.3</a>.<a href="#section-6.4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="verify-app">
<section id="section-6.5">
        <h3 id="name-matching-the-application-ser">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-matching-the-application-ser" class="section-name selfRef">Matching the Application Service Type Portion</a>
        </h3>
<p id="section-6.5-1">When a client checks identifiers of type SRV-ID and URI-ID, it <span class="bcp14">MUST</span>
check not only the DNS domain name portion of the identifier but also
the application service type portion.
The client does this by splitting the identifier into the DNS domain
name portion and the application service type portion (as described
under <a href="#verify-seek" class="xref">Section 6.3</a>), then checking both the DNS domain name portion
(as described under <a href="#verify-domain" class="xref">Section 6.4</a>) and the application service
type portion as described in the following subsections.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">Implementation Note: An identifier of type SRV-ID or URI-ID provides an
application service type portion to be checked, but that portion is combined
only with the DNS domain name portion of the SRV-ID or URI-ID itself.  For
example, if a client's list of reference identifiers includes an SRV-ID of
<code>_xmpp-client.im.example.org</code> and a DNS-ID of <code>apps.example.net</code>, the client
would check (a) the combination of an application service type of
<code>xmpp-client</code> and a DNS domain name of <code>im.example.org</code> and (b) a DNS domain
name of <code>apps.example.net</code>.  However, the client would not check (c) the
combination of an application service type of <code>xmpp-client</code> and a DNS domain
name of <code>apps.example.net</code> because it does not have an SRV-ID of
<code>_xmpp-client.apps.example.net</code> in its list of reference identifiers.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<div id="verify-app-srv">
<section id="section-6.5.1">
          <h4 id="name-srv-id-2">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-srv-id-2" class="section-name selfRef">SRV-ID</a>
          </h4>
<p id="section-6.5.1-1">The application service name portion of an SRV-ID (e.g., <code>imaps</code>) <span class="bcp14">MUST</span>
be matched in a case-insensitive manner, in accordance with
<span>[<a href="#DNS-SRV" class="xref">DNS-SRV</a>]</span>.
Note that the <code>_</code> character is prepended to the service identifier in
DNS SRV records and in SRV-IDs (per <span>[<a href="#SRVNAME" class="xref">SRVNAME</a>]</span>), and thus does not
need to be included in any comparison.<a href="#section-6.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-app-uri">
<section id="section-6.5.2">
          <h4 id="name-uri-id-2">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-uri-id-2" class="section-name selfRef">URI-ID</a>
          </h4>
<p id="section-6.5.2-1">The scheme name portion of a URI-ID (e.g., <code>sip</code>) <span class="bcp14">MUST</span> be matched in a
case-insensitive manner, in accordance with <span>[<a href="#URI" class="xref">URI</a>]</span>.
Note that the <code>:</code> character is a separator between the scheme name
and the rest of the URI, and thus does not need to be included in any
comparison.<a href="#section-6.5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="verify-outcome">
<section id="section-6.6">
        <h3 id="name-outcome-2">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-outcome-2" class="section-name selfRef">Outcome</a>
        </h3>
<p id="section-6.6-1">The outcome of the matching procedure is one of the following cases.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<div id="verify-outcome-matched">
<section id="section-6.6.1">
          <h4 id="name-case-1-match-found-2">
<a href="#section-6.6.1" class="section-number selfRef">6.6.1. </a><a href="#name-case-1-match-found-2" class="section-name selfRef">Case #1: Match Found</a>
          </h4>
<p id="section-6.6.1-1">If the client has found a presented identifier that matches a reference identifier,
then the service identity check has succeeded.  In this case, the client
<span class="bcp14">MUST</span> use the matched reference identifier as the validated identity of the
application service.<a href="#section-6.6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-outcome-pin">
<section id="section-6.6.2">
          <h4 id="name-case-2-no-match-found-pinned">
<a href="#section-6.6.2" class="section-number selfRef">6.6.2. </a><a href="#name-case-2-no-match-found-pinned" class="section-name selfRef">Case #2: No Match Found, Pinned Certificate</a>
          </h4>
<p id="section-6.6.2-1">If the client does not find a presented identifier matching any of the
reference identifiers but the client has previously pinned the
application service's certificate to one of the reference identifiers
in the list it constructed for this communication attempt (as
"pinning" is explained under <a href="#terminology" class="xref">Section 1.7</a>), and the presented
certificate matches the pinned certificate (including the context as
described under <a href="#security-pinning" class="xref">Section 7.1</a>), then the service identity check
has succeeded.<a href="#section-6.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-outcome-nopin">
<section id="section-6.6.3">
          <h4 id="name-case-3-no-match-found-no-pin">
<a href="#section-6.6.3" class="section-number selfRef">6.6.3. </a><a href="#name-case-3-no-match-found-no-pin" class="section-name selfRef">Case #3: No Match Found, No Pinned Certificate</a>
          </h4>
<p id="section-6.6.3-1">If the client does not find a presented identifier matching any of the
reference identifiers and the client has not previously pinned the
certificate to one of the reference identifiers in the list it
constructed for this communication attempt, then the client <span class="bcp14">MUST</span>
proceed as described under <a href="#verify-outcome-fallback" class="xref">Section 6.6.4</a>.<a href="#section-6.6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-outcome-fallback">
<section id="section-6.6.4">
          <h4 id="name-fallback-2">
<a href="#section-6.6.4" class="section-number selfRef">6.6.4. </a><a href="#name-fallback-2" class="section-name selfRef">Fallback</a>
          </h4>
<p id="section-6.6.4-1">If the client is an interactive client that is directly controlled by a human
user, then it <span class="bcp14">SHOULD</span> inform the user of the identity mismatch and automatically
terminate the communication attempt with a bad certificate error; this behavior
is preferable because it prevents users from inadvertently bypassing security
protections in hostile situations.<a href="#section-6.6.4-1" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6.6.4-2.1">Security Warning: Some interactive clients give advanced users the option
of proceeding with acceptance despite the identity mismatch, thereby "pinning"
the certificate to one of the reference identifiers in the list constructed
by the client for this communication attempt.  Although this behavior can
be appropriate in certain specialized circumstances, in general it ought
to be exposed only to advanced users.  Even then it needs to be handled with
extreme caution, for example by first encouraging even an advanced user to
terminate the communication attempt and, if the advanced user chooses to
proceed anyway, by forcing the user to view the entire certification path
and only then allowing the user to pin the certificate (on a temporary or
permanent basis, at the user's option).<a href="#section-6.6.4-2.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.6.4-3">Otherwise, if the client is an automated application not directly controlled
by a human user, then it <span class="bcp14">SHOULD</span> terminate the communication attempt with
a bad certificate error and log the error appropriately.  An automated application
<span class="bcp14">MAY</span> provide a configuration setting that disables this behavior, but <span class="bcp14">MUST</span>
enable the behavior by default.<a href="#section-6.6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations-2">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations-2" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="security-pinning">
<section id="section-7.1">
        <h3 id="name-pinned-certificates-2">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-pinned-certificates-2" class="section-name selfRef">Pinned Certificates</a>
        </h3>
<p id="section-7.1-1">As defined under <a href="#terminology" class="xref">Section 1.7</a>, a certificate is said
to be "pinned" to a DNS domain name when a user has explicitly chosen to
associate a service's certificate with that DNS domain name despite the fact
that the certificate contains some other DNS domain name (e.g., the user
has
explicitly approved <code>apps.example.net</code> as a domain associated with a source
domain of <code>example.com</code>).  The cached name association <span class="bcp14">MUST</span> take account
of
both the certificate presented and the context in which it was accepted or
configured (where the "context" includes the chain of certificates from the
presented certificate to the trust anchor, the source domain, the application
service type, the service's derived domain and port number, and any other
relevant information provided by the user or associated by the client).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-wildcards">
<section id="section-7.2">
        <h3 id="name-wildcard-certificates-2">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-wildcard-certificates-2" class="section-name selfRef">Wildcard Certificates</a>
        </h3>
<p id="section-7.2-1">This document states that the wildcard character <code>*</code> <span class="bcp14">SHOULD NOT</span> be
included in presented identifiers but <span class="bcp14">MAY</span> be checked by application clients
(mainly for the sake of backward compatibility with deployed infrastructure).
As a result, the rules provided in this document are more restrictive than
the rules for many existing application technologies.
Several security considerations justify tightening the rules:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">Wildcard certificates automatically vouch for any and all host names
within their domain. This can be convenient for administrators but
also poses the risk of vouching for rogue or buggy hosts. See for
example <span>[<a href="#Defeating-SSL" class="xref">Defeating-SSL</a>]</span> (beginning at slide 91) and <span>[<a href="#HTTPSbytes" class="xref">HTTPSbytes</a>]</span>
(slides 38-40).<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-2.2">
            <p id="section-7.2-2.2.1">Specifications for existing application technologies are not clear or consistent
about the allowable location of the wildcard character, such as whether it
can be:<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.2.2.1">only the complete left-most label (e.g., <code>*.example.com</code>)<a href="#section-7.2-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.2-2.2.2.2">some fragment of the left-most label (e.g.,
<code>fo*.example.com</code>, <code>f*o.example.com</code>, or <code>*oo.example.com</code>)<a href="#section-7.2-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.2-2.2.2.3">all or part of a label other than the left-most label (e.g., <code>www.*.example.com</code>
or <code>www.foo*.example.com</code>)<a href="#section-7.2-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.2-2.2.2.4">all or part of a label that identifies a so-called "public suffix" (e.g.,
<code>*.co.uk</code> or <code>*.com</code>)<a href="#section-7.2-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.2-2.2.2.5">included more than once in a given label (e.g., <code>f*b*r.example.com</code><a href="#section-7.2-2.2.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.2-2.2.2.6">included as all or part of more than one label (e.g., <code>*.*.example.com</code>)<a href="#section-7.2-2.2.2.6" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-7.2-2.2.3">
These ambiguities might introduce exploitable differences in identity checking
behavior among client implementations and necessitate overly complex and
inefficient identity checking algorithms.<a href="#section-7.2-2.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.3">There is no specification that defines how the wildcard character
may be embedded within the A-labels or U-labels <span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>]</span> of an
internationalized domain name <span>[<a href="#IDNA-PROTO" class="xref">IDNA-PROTO</a>]</span>; as a result,
implementations are strongly discouraged from including or
attempting to check for the wildcard character embedded within the
A-labels or U-labels of an internationalized domain name (e.g.,
<code>xn--kcry6tjko*.example.org</code>).
Note, however, that a presented domain name identifier <span class="bcp14">MAY</span> contain
the wildcard character as long as that character occupies the entire
left-most label position, where all of the remaining labels are
valid NR-LDH labels, A-labels, or U-labels (e.g.,
<code>*.xn--kcry6tjko.example.org</code>).<a href="#section-7.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-3">Notwithstanding the foregoing security considerations, specifications that
reuse this one can legitimately encourage continued support for the wildcard
character if they have good reasons to do so, such as backward compatibility
with deployed infrastructure (see, for example, <span>[<a href="#EV-CERTS" class="xref">EV-CERTS</a>]</span>).<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-idn">
<section id="section-7.3">
        <h3 id="name-internationalized-domain-nam">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-internationalized-domain-nam" class="section-name selfRef">Internationalized Domain Names</a>
        </h3>
<p id="section-7.3-1">Allowing internationalized domain names can lead to the inclusion of visually
similar (so-called "confusable") characters in certificates; for discussion,
see for example <span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>]</span>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-multi">
<section id="section-7.4">
        <h3 id="name-multiple-identifiers-2">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-multiple-identifiers-2" class="section-name selfRef">Multiple Identifiers</a>
        </h3>
<p id="section-7.4-1">A given application service might be addressed by multiple DNS domain names
for a variety of reasons, and a given deployment might service multiple domains
(e.g., in so-called "virtual hosting" environments).  In the default TLS
handshake exchange, the client is not able to indicate the DNS domain name
with which it wants to communicate, and the TLS server returns only one certificate
for itself.  Absent an extension to TLS, a typical workaround used to facilitate
mapping an application service to multiple DNS domain names is to embed all
of the domain names into a single certificate.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">A more recent approach, formally specified in <span>[<a href="#TLS-EXT" class="xref">TLS-EXT</a>]</span>, is for the
client to use the TLS "Server Name Indication" (SNI) extension when
sending the client_hello message, stipulating the DNS domain name it
desires or expects of the service.
The service can then return the appropriate certificate in its
Certificate message, and that certificate can represent a single DNS
domain name.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">To accommodate the workaround that was needed before the development
of the SNI extension, this specification allows multiple DNS-IDs,
SRV-IDs, or URI-IDs in a certificate; however, it explicitly
discourages multiple CN-IDs.
Although it would be preferable to forbid multiple CN-IDs entirely,
there are several reasons at this time why this specification states
that they <span class="bcp14">SHOULD NOT</span> (instead of <span class="bcp14">MUST NOT</span>) be included:<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-4.1">At least one significant technology community of interest explicitly allows
multiple CN-IDs <span>[<a href="#EV-CERTS" class="xref">EV-CERTS</a>]</span>.<a href="#section-7.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.4-4.2">At least one significant certification authority is known to issue certificates
containing multiple CN-IDs.<a href="#section-7.4-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.4-4.3">Many service providers often deem inclusion of multiple CN-IDs
necessary in virtual hosting environments because at least one widely deployed
operating system does not yet support the SNI extension.<a href="#section-7.4-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.4-5">It is hoped that the recommendation regarding multiple CN-IDs can be further
tightened in the future.<a href="#section-7.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references-2">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references-2" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references-2">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references-2" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="DNS-CONCEPTS">[DNS-CONCEPTS]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.V.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC1034">https://doi.org/10.17487/RFC1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS-SRV">[DNS-SRV]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC2782">https://doi.org/10.17487/RFC2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IDNA-DEFS">[IDNA-DEFS]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC5890">https://doi.org/10.17487/RFC5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IDNA-PROTO">[IDNA-PROTO]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names in Applications (IDNA): Protocol"</span>, <span class="seriesInfo">RFC 5891</span>, <span class="seriesInfo">DOI 10.17487/RFC5891</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC5891">https://doi.org/10.17487/RFC5891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LDAP-DN">[LDAP-DN]</dt>
        <dd>
<span class="refAuthor">Zeilenga, K., Ed.</span>, <span class="refTitle">"Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names"</span>, <span class="seriesInfo">RFC 4514</span>, <span class="seriesInfo">DOI 10.17487/RFC4514</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC4514">https://doi.org/10.17487/RFC4514</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PKIX">[PKIX]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC5280">https://doi.org/10.17487/RFC5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC2119">https://doi.org/10.17487/RFC2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC8174">https://doi.org/10.17487/RFC8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRVNAME">[SRVNAME]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name"</span>, <span class="seriesInfo">RFC 4985</span>, <span class="seriesInfo">DOI 10.17487/RFC4985</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC4985">https://doi.org/10.17487/RFC4985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="URI">[URI]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC3986">https://doi.org/10.17487/RFC3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references-2">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references-2" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ABNF">[ABNF]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC5234">https://doi.org/10.17487/RFC5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Defeating-SSL">[Defeating-SSL]</dt>
        <dd>
<span class="refAuthor">Marlinspike, M.</span>, <span class="refTitle">"New Tricks for Defeating SSL in Practice"</span>, <span class="seriesInfo">BlackHat DC</span>, <time datetime="2009-02" class="refDate">February 2009</time>, <span>&lt;<a href="http://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf">http://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS-CASE">[DNS-CASE]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) Case Insensitivity Clarification"</span>, <span class="seriesInfo">RFC 4343</span>, <span class="seriesInfo">DOI 10.17487/RFC4343</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC4343">https://doi.org/10.17487/RFC4343</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNSSEC">[DNSSEC]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC4033">https://doi.org/10.17487/RFC4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DTLS">[DTLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security"</span>, <span class="seriesInfo">RFC 4347</span>, <span class="seriesInfo">DOI 10.17487/RFC4347</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC4347">https://doi.org/10.17487/RFC4347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EMAIL-SRV">[EMAIL-SRV]</dt>
        <dd>
<span class="refAuthor">Daboo, C.</span>, <span class="refTitle">"Use of SRV Records for Locating Email Submission/Access Services"</span>, <span class="seriesInfo">RFC 6186</span>, <span class="seriesInfo">DOI 10.17487/RFC6186</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC6186">https://doi.org/10.17487/RFC6186</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EV-CERTS">[EV-CERTS]</dt>
        <dd>
<span class="refAuthor">CA/Browser Forum</span>, <span class="refTitle">"Guidelines For The Issuance And Management Of Extended Validation Certificates"</span>, <time datetime="2009-10" class="refDate">October 2009</time>, <span>&lt;<a href="http://www.cabforum.org/Guidelines_v1_2.pdf">http://www.cabforum.org/Guidelines_v1_2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTP">[HTTP]</dt>
        <dd>
<span class="refAuthor">Fielding, R.</span>, <span class="refAuthor">Gettys, J.</span>, <span class="refAuthor">Mogul, J.</span>, <span class="refAuthor">Frystyk, H.</span>, <span class="refAuthor">Masinter, L.</span>, <span class="refAuthor">Leach, P.</span>, and <span class="refAuthor">T. Berners-Lee</span>, <span class="refTitle">"Hypertext Transfer Protocol -- HTTP/1.1"</span>, <span class="seriesInfo">RFC 2616</span>, <span class="seriesInfo">DOI 10.17487/RFC2616</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC2616">https://doi.org/10.17487/RFC2616</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTP-TLS">[HTTP-TLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"HTTP Over TLS"</span>, <span class="seriesInfo">RFC 2818</span>, <span class="seriesInfo">DOI 10.17487/RFC2818</span>, <time datetime="2000-05" class="refDate">May 2000</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC2818">https://doi.org/10.17487/RFC2818</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTPSbytes">[HTTPSbytes]</dt>
        <dd>
<span class="refAuthor">Sokol, J.</span> and <span class="refAuthor">R. Hansen</span>, <span class="refTitle">"HTTPS Can Byte Me"</span>, <span class="seriesInfo">BlackHat Abu Dhabi</span>, <time datetime="2010-11" class="refDate">November 2010</time>, <span>&lt;<a href="https://media.blackhat.com/bh-ad-10/Hansen/Blackhat-AD-2010-Hansen-Sokol-HTTPS-Can-Byte-Me-slides.pdf">https://media.blackhat.com/bh-ad-10/Hansen/Blackhat-AD-2010-Hansen-Sokol-HTTPS-Can-Byte-Me-slides.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IPSEC">[IPSEC]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC4301">https://doi.org/10.17487/RFC4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LDAP-SCHEMA">[LDAP-SCHEMA]</dt>
        <dd>
<span class="refAuthor">Sciberras, A., Ed.</span>, <span class="refTitle">"Lightweight Directory Access Protocol (LDAP): Schema for User Applications"</span>, <span class="seriesInfo">RFC 4519</span>, <span class="seriesInfo">DOI 10.17487/RFC4519</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC4519">https://doi.org/10.17487/RFC4519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NAPTR">[NAPTR]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"Dynamic Delegation Discovery System (DDDS) Part Three: The Domain Name System (DNS) Database"</span>, <span class="seriesInfo">RFC 3403</span>, <span class="seriesInfo">DOI 10.17487/RFC3403</span>, <time datetime="2002-10" class="refDate">October 2002</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC3403">https://doi.org/10.17487/RFC3403</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OCSP">[OCSP]</dt>
        <dd>
<span class="refAuthor">Myers, M.</span>, <span class="refAuthor">Ankney, R.</span>, <span class="refAuthor">Malpani, A.</span>, <span class="refAuthor">Galperin, S.</span>, and <span class="refAuthor">C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 2560</span>, <span class="seriesInfo">DOI 10.17487/RFC2560</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC2560">https://doi.org/10.17487/RFC2560</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OPENPGP">[OPENPGP]</dt>
        <dd>
<span class="refAuthor">Callas, J.</span>, <span class="refAuthor">Donnerhacke, L.</span>, <span class="refAuthor">Finney, H.</span>, <span class="refAuthor">Shaw, D.</span>, and <span class="refAuthor">R. Thayer</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="seriesInfo">RFC 4880</span>, <span class="seriesInfo">DOI 10.17487/RFC4880</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC4880">https://doi.org/10.17487/RFC4880</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PRIVATE">[PRIVATE]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y.</span>, <span class="refAuthor">Moskowitz, B.</span>, <span class="refAuthor">Karrenberg, D.</span>, <span class="refAuthor">de Groot, G. J.</span>, and <span class="refAuthor">E. Lear</span>, <span class="refTitle">"Address Allocation for Private Internets"</span>, <span class="seriesInfo">BCP 5</span>, <span class="seriesInfo">RFC 1918</span>, <span class="seriesInfo">DOI 10.17487/RFC1918</span>, <time datetime="1996-02" class="refDate">February 1996</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC1918">https://doi.org/10.17487/RFC1918</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="S-NAPTR">[S-NAPTR]</dt>
        <dd>
<span class="refAuthor">Daigle, L.</span> and <span class="refAuthor">A. Newton</span>, <span class="refTitle">"Domain-Based Application Service Location Using SRV RRs and the Dynamic Delegation Discovery Service (DDDS)"</span>, <span class="seriesInfo">RFC 3958</span>, <span class="seriesInfo">DOI 10.17487/RFC3958</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC3958">https://doi.org/10.17487/RFC3958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SECTERMS">[SECTERMS]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC4949">https://doi.org/10.17487/RFC4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIP">[SIP]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span>, <span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">Camarillo, G.</span>, <span class="refAuthor">Johnston, A.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Sparks, R.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">E. Schooler</span>, <span class="refTitle">"SIP: Session Initiation Protocol"</span>, <span class="seriesInfo">RFC 3261</span>, <span class="seriesInfo">DOI 10.17487/RFC3261</span>, <time datetime="2002-06" class="refDate">June 2002</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC3261">https://doi.org/10.17487/RFC3261</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIP-CERTS">[SIP-CERTS]</dt>
        <dd>
<span class="refAuthor">Gurbani, V.</span>, <span class="refAuthor">Lawrence, S.</span>, and <span class="refAuthor">A. Jeffrey</span>, <span class="refTitle">"Domain Certificates in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 5922</span>, <span class="seriesInfo">DOI 10.17487/RFC5922</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC5922">https://doi.org/10.17487/RFC5922</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIP-SIPS">[SIP-SIPS]</dt>
        <dd>
<span class="refAuthor">Audet, F.</span>, <span class="refTitle">"The Use of the SIPS URI Scheme in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 5630</span>, <span class="seriesInfo">DOI 10.17487/RFC5630</span>, <time datetime="2009-10" class="refDate">October 2009</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC5630">https://doi.org/10.17487/RFC5630</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS">[TLS]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC5246">https://doi.org/10.17487/RFC5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS-EXT">[TLS-EXT]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC6066">https://doi.org/10.17487/RFC6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="US-ASCII">[US-ASCII]</dt>
        <dd>
<span class="refAuthor">American National Standards Institute</span>, <span class="refTitle">"Coded Character Set - 7-bit American Standard Code for Information Interchange"</span>, <span class="seriesInfo">ANSI X3.4</span>, <time datetime="1986" class="refDate">1986</time>. </dd>
<dd class="break"></dd>
<dt id="VERIFY">[VERIFY]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC6125">https://doi.org/10.17487/RFC6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WSC-UI">[WSC-UI]</dt>
        <dd>
<span class="refAuthor">Saldhana, A.</span> and <span class="refAuthor">T. Roessler</span>, <span class="refTitle">"Web Security Context: User Interface Guidelines"</span>, <span class="seriesInfo">World Wide Web Consortium LastCall WD-wsc-ui-20100309</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="http://www.w3.org/TR/2010/WD-wsc-ui-20100309">http://www.w3.org/TR/2010/WD-wsc-ui-20100309</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.500">[X.500]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information Technology - Open Systems Interconnection - The Directory: Overview of concepts, models and services"</span>, <span class="seriesInfo">ISO Standard 9594-1</span>, <span class="seriesInfo">ITU-T Recommendation X.500</span>, <time datetime="2005-08" class="refDate">August 2005</time>. </dd>
<dd class="break"></dd>
<dt id="X.501">[X.501]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information Technology - Open Systems Interconnection - The Directory: Models"</span>, <span class="seriesInfo">ISO Standard 9594-2</span>, <span class="seriesInfo">ITU-T Recommendation X.501</span>, <time datetime="2005-08" class="refDate">August 2005</time>. </dd>
<dd class="break"></dd>
<dt id="X.509">[X.509]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information Technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks"</span>, <span class="seriesInfo">ISO Standard 9594-8</span>, <span class="seriesInfo">ITU-T Recommendation X.509</span>, <time datetime="2005-08" class="refDate">August 2005</time>. </dd>
<dd class="break"></dd>
<dt id="X.520">[X.520]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information Technology - Open Systems Interconnection - The Directory: Selected attribute types"</span>, <span class="seriesInfo">ISO Standard 9594-6</span>, <span class="seriesInfo">ITU-T Recommendation X.509</span>, <time datetime="2005-08" class="refDate">August 2005</time>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO Standard 8825-1</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <time datetime="2008-08" class="refDate">August 2008</time>. </dd>
<dd class="break"></dd>
<dt id="XMPP">[XMPP]</dt>
      <dd>
<span class="refAuthor">Saint-Andre, P.</span>, <span class="refTitle">"Extensible Messaging and Presence Protocol (XMPP): Core"</span>, <span class="seriesInfo">RFC 6120</span>, <span class="seriesInfo">DOI 10.17487/RFC6120</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://doi.org/10.17487/RFC6120">https://doi.org/10.17487/RFC6120</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="text">
<section id="appendix-A">
      <h2 id="name-sample-text-2">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-sample-text-2" class="section-name selfRef">Sample Text</a>
      </h2>
<p id="appendix-A-1">At the time of this writing, two application technologies reuse the
recommendations in this specification: email <span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span> and XMPP
<span>[<a href="#XMPP" class="xref">XMPP</a>]</span>.
Here we include the text from <span>[<a href="#XMPP" class="xref">XMPP</a>]</span> to illustrate the thought
process that might be followed by protocol designers for other
application technologies.
Specifically, because XMPP uses DNS SRV records for resolution of the
DNS domain names for application services, the XMPP specification
recommends the use of SRV-IDs.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">The text regarding certificate issuance is as follows:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">######<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">In a PKIX certificate to be presented by an XMPP server (i.e., a "server
certificate"), the certificate <span class="bcp14">MUST</span> include one or more XMPP addresses (i.e.,
domainparts) associated with XMPP services hosted at the server.  The rules
and guidelines defined in this specification apply to XMPP server certificates,
with the following XMPP-specific considerations:<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">Support for the DNS-ID identifier type <span>[<a href="#PKIX" class="xref">PKIX</a>]</span> is <span class="bcp14">REQUIRED</span> in XMPP
client and server software implementations.
Certification
authorities that issue XMPP-specific certificates <span class="bcp14">MUST</span> support the DNS-ID
identifier type.
XMPP service providers <span class="bcp14">SHOULD</span> include the DNS-ID identifier type in
certificate requests.<a href="#appendix-A-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.2">Support for the SRV-ID identifier type <span>[<a href="#SRVNAME" class="xref">SRVNAME</a>]</span> is <span class="bcp14">REQUIRED</span> for
XMPP client and server software implementations (for verification
purposes XMPP client implementations need to support only the
<code>_xmpp-client</code> application service type, whereas XMPP server
implementations need to support both the <code>_xmpp-client</code> and
<code>_xmpp-server</code> application service types).
Certification authorities that issue XMPP-specific certificates
<span class="bcp14">SHOULD</span> support the SRV-ID identifier type.
XMPP service providers <span class="bcp14">SHOULD</span> include the SRV-ID identifier type in
certificate requests.<a href="#appendix-A-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.3">Support for the XmppAddr identifier type is encouraged in XMPP
client and server software implementations for the sake of
backward-compatibility, but is no longer encouraged in certificates
issued by certification authorities or requested by XMPP service
providers.<a href="#appendix-A-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.4">DNS domain names in server certificates <span class="bcp14">MAY</span> contain the wildcard
character <code>*</code> as the complete left-most label within the
identifier.<a href="#appendix-A-5.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-6">######<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<p id="appendix-A-7">The text regarding certificate verification is as follows:<a href="#appendix-A-7" class="pilcrow">¶</a></p>
<p id="appendix-A-8">######<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<p id="appendix-A-9">For server certificates, the rules and guidelines defined in this specification
apply, with the proviso that the XmppAddr identifier is allowed as a reference
identifier.<a href="#appendix-A-9" class="pilcrow">¶</a></p>
<p id="appendix-A-10">The identities to be checked are set as follows:<a href="#appendix-A-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-11.1">The initiating entity sets its reference identifier to the 'to' address it
communicates in the initial stream header; i.e., this is the identity it
expects the receiving entity to provide in a PKIX certificate.<a href="#appendix-A-11.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-11.2">The receiving entity sets its reference identifier to the 'from' address
communicated by the initiating entity in the initial stream header; i.e.,
this is the identity that the initiating entity is trying to assert.<a href="#appendix-A-11.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-12">######<a href="#appendix-A-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements-2">
<a href="#name-acknowledgements-2" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">We gratefully acknowledge everyone who contributed to the previous
version of this document, <span>[<a href="#VERIFY" class="xref">VERIFY</a>]</span>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses-2">
<a href="#name-authors-addresses-2" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Peter Saint-Andre</span></div>
<div dir="auto" class="left"><span class="org">Mozilla</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stpeter@mozilla.com" class="email">stpeter@mozilla.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeff Hodges</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jdhodges@google.com" class="email">jdhodges@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rich Salz</span></div>
<div dir="auto" class="left"><span class="org">Akamai Technologies</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rsalz@akamai.com" class="email">rsalz@akamai.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
