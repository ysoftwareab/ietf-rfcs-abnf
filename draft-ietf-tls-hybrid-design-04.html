<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Hybrid key exchange in TLS 1.3</title>
<meta content="Douglas Stebila" name="author">
<meta content="Scott Fluhrer" name="author">
<meta content="Shay Gueron" name="author">
<meta content="
       Hybrid key exchange refers to using multiple key exchange algorithms simultaneously and combining the result with the goal of providing security even if all but one of the component algorithms is broken.  It is motivated by transition to post-quantum cryptography.  This document provides a construction for hybrid key exchange in the Transport Layer Security (TLS) protocol version 1.3. 
       Discussion of this work is encouraged to happen on the TLS IETF mailing list tls@ietf.org or on the GitHub repository which contains the draft: https://github.com/dstebila/draft-ietf-tls-hybrid-design. 
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-tls-hybrid-design-04" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-tls-hybrid-design-u8ig7dif.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ietf-tls-hybrid-design</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Stebila, et al.</td>
<td class="center">Expires 15 July 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-tls-hybrid-design-04</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-01-11" class="published">11 January 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-07-15">15 July 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Stebila</div>
<div class="org">University of Waterloo</div>
</div>
<div class="author">
      <div class="author-name">S. Fluhrer</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">S. Gueron</div>
<div class="org">U. Haifa, Amazon Web Services</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Hybrid key exchange in TLS 1.3</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Hybrid key exchange refers to using multiple key exchange algorithms simultaneously and combining the result with the goal of providing security even if all but one of the component algorithms is broken.  It is motivated by transition to post-quantum cryptography.  This document provides a construction for hybrid key exchange in the Transport Layer Security (TLS) protocol version 1.3.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Discussion of this work is encouraged to happen on the TLS IETF mailing list tls@ietf.org or on the GitHub repository which contains the draft: https://github.com/dstebila/draft-ietf-tls-hybrid-design.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 15 July 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-revision-history" class="xref">Revision history</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-motivation-for-use-of-hybri" class="xref">Motivation for use of hybrid key exchange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-scope" class="xref">Scope</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="xref">1.5</a>.  <a href="#name-goals" class="xref">Goals</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-key-encapsulation-mechanism" class="xref">Key encapsulation mechanisms</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-construction-for-hybrid-key" class="xref">Construction for hybrid key exchange</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-negotiation" class="xref">Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-transmitting-public-keys-an" class="xref">Transmitting public keys and ciphertexts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-shared-secret-calculation" class="xref">Shared secret calculation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-discussion" class="xref">Discussion</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-related-work" class="xref">Related work</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document gives a construction for hybrid key exchange in TLS 1.3.  The overall design approach is a simple, "concatenation"-based approach: each hybrid key exchange combination should be viewed as a single new key exchange method, negotiated and transmitted using the existing TLS 1.3 mechanisms.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document does not propose specific post-quantum mechanisms; see <a href="#scope" class="xref">Section 1.4</a> for more on the scope of this document.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="revision-history">
<section id="section-1.1">
        <h3 id="name-revision-history">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-revision-history" class="section-name selfRef">Revision history</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.1-1.1">
            <strong>RFC Editor's Note:</strong> Please remove this section prior to publication of a final version of this document.<a href="#section-1.1-1.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-2">Earlier versions of this document categorized various design decisions one could make when implementing hybrid key exchange in TLS 1.3.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">
            <p id="section-1.1-3.1.1">Since draft-ietf-tls-hybrid-design-03:<a href="#section-1.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1.2.1">Some wording changes<a href="#section-1.1-3.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.1-3.1.2.2">Remove design considerations appendix<a href="#section-1.1-3.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1">draft-ietf-tls-hybrid-design-03:<a href="#section-1.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.2.2.1">Remove specific code point examples and requested codepoint range for hybrid private use<a href="#section-1.1-3.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.1-3.2.2.2">Change "Open questions" to "Discussion"<a href="#section-1.1-3.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.1-3.2.2.3">Some wording changes<a href="#section-1.1-3.2.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-3.3">
            <p id="section-1.1-3.3.1">draft-ietf-tls-hybrid-design-02:<a href="#section-1.1-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.3.2.1">Bump to version -02 to avoid expiry<a href="#section-1.1-3.3.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-3.4">
            <p id="section-1.1-3.4.1">draft-ietf-tls-hybrid-design-01:<a href="#section-1.1-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.4.2.1">Forbid variable-length secret keys<a href="#section-1.1-3.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.1-3.4.2.2">Use fixed-length KEM public keys/ciphertexts<a href="#section-1.1-3.4.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-3.5">
            <p id="section-1.1-3.5.1">draft-ietf-tls-hybrid-design-00:<a href="#section-1.1-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.5.2.1">Allow key_exchange values from the same algorithm to be reused across multiple KeyShareEntry records in the same ClientHello.<a href="#section-1.1-3.5.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-3.6">
            <p id="section-1.1-3.6.1">draft-stebila-tls-hybrid-design-03:<a href="#section-1.1-3.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.6.2.1">Add requirement for KEMs to provide protection against key reuse.<a href="#section-1.1-3.6.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.1-3.6.2.2">Clarify FIPS-compliance of shared secret concatenation method.<a href="#section-1.1-3.6.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-3.7">
            <p id="section-1.1-3.7.1">draft-stebila-tls-hybrid-design-02:<a href="#section-1.1-3.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.7.2.1">Design considerations from draft-stebila-tls-hybrid-design-00 and draft-stebila-tls-hybrid-design-01 are moved to the appendix.<a href="#section-1.1-3.7.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.1-3.7.2.2">A single construction is given in the main body.<a href="#section-1.1-3.7.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-3.8">
            <p id="section-1.1-3.8.1">draft-stebila-tls-hybrid-design-01:<a href="#section-1.1-3.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.8.2.1">Add (Comb-KDF-1) and (Comb-KDF-2) options.<a href="#section-1.1-3.8.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.1-3.8.2.2">Add two candidate instantiations.<a href="#section-1.1-3.8.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-3.9">draft-stebila-tls-hybrid-design-00: Initial version.<a href="#section-1.1-3.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">For the purposes of this document, it is helpful to be able to divide cryptographic algorithms into two classes:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">"Traditional" algorithms: Algorithms which are widely deployed today, but which may be deprecated in the future.  In the context of TLS 1.3 in 2019, examples of traditional key exchange algorithms include elliptic curve Diffie-Hellman using secp256r1 or x25519, or finite-field Diffie-Hellman.<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">"Next-generation" (or "next-gen") algorithms: Algorithms which are not yet widely deployed, but which may eventually be widely deployed.  An additional facet of these algorithms may be that we have less confidence in their security due to them being relatively new or less studied.  This includes "post-quantum" algorithms.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.2-3">"Hybrid" key exchange, in this context, means the use of two (or more) key exchange algorithms based on different cryptographic assumptions, e.g., one traditional algorithm and one next-gen algorithm, with the purpose of the final session key being secure as long as at least one of the component key exchange algorithms remains unbroken.  We use the term "component" algorithms to refer to the algorithms combined in a hybrid key exchange.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">We note that some authors prefer the phrase "composite" to refer to the use of multiple algorithms, to distinguish from "hybrid public key encryption" in which a key encapsulation mechanism and data encapsulation mechanism are combined to create public key encryption.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">The primary motivation of this document is preparing for post-quantum algorithms.  However, it is possible that public key cryptography based on alternative mathematical constructions will be required independent of the advent of a quantum computer, for example because of a cryptanalytic breakthrough.  As such we opt for the more generic term "next-generation" algorithms rather than exclusively "post-quantum" algorithms.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">Note that TLS 1.3 uses the phrase "groups" to refer to key exchange algorithms - for example, the <code>supported_groups</code> extension - since all key exchange algorithms in TLS 1.3 are Diffie-Hellman-based.  As a result, some parts of this document will refer to data structures or messages with the term "group" in them despite using a key exchange algorithm that is not Diffie-Hellman-based nor a group.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="motivation">
<section id="section-1.3">
        <h3 id="name-motivation-for-use-of-hybri">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-motivation-for-use-of-hybri" class="section-name selfRef">Motivation for use of hybrid key exchange</a>
        </h3>
<p id="section-1.3-1">A hybrid key exchange algorithm allows early adopters eager for post-quantum security to have the potential of post-quantum security (possibly from a less-well-studied algorithm) while still retaining at least the security currently offered by traditional algorithms.  They may even need to retain traditional algorithms due to regulatory constraints, for example FIPS compliance.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">Ideally, one would not use hybrid key exchange: one would have confidence in a single algorithm and parameterization that will stand the test of time.  However, this may not be the case in the face of quantum computers and cryptanalytic advances more generally.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">Many (though not all) post-quantum algorithms currently under consideration are relatively new; they have not been subject to the same depth of study as RSA and finite-field or elliptic curve Diffie-Hellman, and thus the security community does not necessarily have as much confidence in their fundamental security, or the concrete security level of specific parameterizations.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4">Moreover, it is possible that after next-generation algorithms are defined, and for a period of time thereafter, conservative users may not have full confidence in some algorithms.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<p id="section-1.3-5">Some users may want to accelerate adoption of post-quantum cryptography due the threat of retroactive decryption: if a cryptographic assumption is broken due to the advent of a quantum computer or some other cryptanalytic breakthrough, confidentiality of information can be broken retroactively by any adversary who has passively recorded handshakes and encrypted communications.  Hybrid key exchange enables potential security against retroactive decryption while not fully abandoning classical cryptosystems.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6">As such, there may be users for whom hybrid key exchange is an appropriate step prior to an eventual transition to next-generation algorithms.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scope">
<section id="section-1.4">
        <h3 id="name-scope">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
        </h3>
<p id="section-1.4-1">This document focuses on hybrid ephemeral key exchange in TLS 1.3 <span>[<a href="#TLS13" class="xref">TLS13</a>]</span>.  It intentionally does not address:<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-2.1">Selecting which next-generation algorithms to use in TLS 1.3, or algorithm identifiers or encoding mechanisms for next-generation algorithms.  This selection will be based on the recommendations by the Crypto Forum Research Group (CFRG), which is currently waiting for the results of the NIST Post-Quantum Cryptography Standardization Project <span>[<a href="#NIST" class="xref">NIST</a>]</span>.<a href="#section-1.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.4-2.2">Authentication using next-generation algorithms.  While quantum computers could retroactively decrypt previous sessions, session authentication cannot be retroactively broken.<a href="#section-1.4-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="goals">
<section id="section-1.5">
        <h3 id="name-goals">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-goals" class="section-name selfRef">Goals</a>
        </h3>
<p id="section-1.5-1">The primary goal of a hybrid key exchange mechanism is to facilitate the establishment of a shared secret which remains secure as long as as one of the component key exchange mechanisms remains unbroken.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<p id="section-1.5-2">In addition to the primary cryptographic goal, there may be several additional goals in the context of TLS 1.3:<a href="#section-1.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-3.1">
            <p id="section-1.5-3.1.1"><strong>Backwards compatibility:</strong> Clients and servers who are "hybrid-aware", i.e., compliant with whatever hybrid key exchange standard is developed for TLS, should remain compatible with endpoints and middle-boxes that are not hybrid-aware.  The three scenarios to consider are:<a href="#section-1.5-3.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.5-3.1.2">
<li id="section-1.5-3.1.2.1">Hybrid-aware client, hybrid-aware server: These parties should establish a hybrid shared secret.<a href="#section-1.5-3.1.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-1.5-3.1.2.2">Hybrid-aware client, non-hybrid-aware server:  These parties should establish a traditional shared secret (assuming the hybrid-aware client is willing to downgrade to traditional-only).<a href="#section-1.5-3.1.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-1.5-3.1.2.3">Non-hybrid-aware client, hybrid-aware server:  These parties should establish a traditional shared secret (assuming the hybrid-aware server is willing to downgrade to traditional-only).<a href="#section-1.5-3.1.2.3" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-1.5-3.1.3">
Ideally backwards compatibility should be achieved without extra round trips and without sending duplicate information; see below.<a href="#section-1.5-3.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-3.2">
            <strong>High performance:</strong> Use of hybrid key exchange should not be prohibitively expensive in terms of computational performance.  In general this will depend on the performance characteristics of the specific cryptographic algorithms used, and as such is outside the scope of this document.  See <span>[<a href="#PST" class="xref">PST</a>]</span> for preliminary results about performance characteristics.<a href="#section-1.5-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-3.3">
            <p id="section-1.5-3.3.1"><strong>Low latency:</strong> Use of hybrid key exchange should not substantially increase the latency experienced to establish a connection.  Factors affecting this may include the following.<a href="#section-1.5-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-3.3.2.1">The computational performance characteristics of the specific algorithms used.  See above.<a href="#section-1.5-3.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-3.3.2.2">The size of messages to be transmitted.  Public key and ciphertext sizes for post-quantum algorithms range from hundreds of bytes to over one hundred kilobytes, so this impact can be substantial.  See <span>[<a href="#PST" class="xref">PST</a>]</span> for preliminary results in a laboratory setting, and <span>[<a href="#LANGLEY" class="xref">LANGLEY</a>]</span> for preliminary results on more realistic networks.<a href="#section-1.5-3.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-3.3.2.3">Additional round trips added to the protocol.  See below.<a href="#section-1.5-3.3.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.5-3.4">
            <strong>No extra round trips:</strong> Attempting to negotiate hybrid key exchange should not lead to extra round trips in any of the three hybrid-aware/non-hybrid-aware scenarios listed above.<a href="#section-1.5-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-3.5">
            <strong>Minimal duplicate information:</strong> Attempting to negotiate hybrid key exchange should not mean having to send multiple public keys of the same type.<a href="#section-1.5-3.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="kems">
<section id="section-2">
      <h2 id="name-key-encapsulation-mechanism">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-key-encapsulation-mechanism" class="section-name selfRef">Key encapsulation mechanisms</a>
      </h2>
<p id="section-2-1">This document models key agreement as key encapsulation mechanisms (KEMs), which consist of three algorithms:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">
          <code>KeyGen() -&gt; (pk, sk)</code>: A probabilistic key generation algorithm, which generates a public key <code>pk</code> and a secret key <code>sk</code>.<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">
          <code>Encaps(pk) -&gt; (ct, ss)</code>: A probabilistic encapsulation algorithm, which takes as input a public key <code>pk</code> and outputs a ciphertext <code>ct</code> and shared secret <code>ss</code>.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.3">
          <code>Decaps(sk, ct) -&gt; ss</code>: A decapsulation algorithm, which takes as input a secret key <code>sk</code> and ciphertext <code>ct</code> and outputs a shared secret <code>ss</code>, or in some cases a distinguished error value.<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-3">The main security property for KEMs is indistinguishability under adaptive chosen ciphertext attack (IND-CCA2), which means that shared secret values should be indistinguishable from random strings even given the ability to have other arbitrary ciphertexts decapsulated.  IND-CCA2 corresponds to security against an active attacker, and the public key / secret key pair can be treated as a long-term key or reused.  A common design pattern for obtaining security under key reuse is to apply the Fujisaki-Okamoto (FO) transform <span>[<a href="#FO" class="xref">FO</a>]</span> or a variant thereof <span>[<a href="#HHK" class="xref">HHK</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">A weaker security notion is indistinguishability under chosen plaintext attack (IND-CPA), which means that the shared secret values should be indistinguishable from random strings given a copy of the public key.  IND-CPA roughly corresponds to security against a passive attacker, and sometimes corresponds to one-time key exchange.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Key exchange in TLS 1.3 is phrased in terms of Diffie-Hellman key exchange in a group.  DH key exchange can be modeled as a KEM, with <code>KeyGen</code> corresponding to selecting an exponent <code>x</code> as the secret key and computing the public key <code>g^x</code>; encapsulation corresponding to selecting an exponent <code>y</code>, computing the ciphertext <code>g^y</code> and the shared secret <code>g^(xy)</code>, and decapsulation as computing the shared secret <code>g^(xy)</code>. See <span>[<a href="#I-D.irtf-cfrg-hpke" class="xref">I-D.irtf-cfrg-hpke</a>]</span> for more details of such Diffie-Hellman-based key encapsulation mechanisms.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">TLS 1.3 does not require that ephemeral public keys be used only in a single key exchange session; some implementations may reuse them, at the cost of limited forward secrecy.  As a result, any KEM used in the manner described in this document MUST explicitly be designed to be secure in the event that the public key is reused, such as achieving IND-CCA2 security or having a transform like the Fujisaki-Okamoto transform <span>[<a href="#FO" class="xref">FO</a>]</span> <span>[<a href="#HHK" class="xref">HHK</a>]</span> applied.  While it is recommended that implementations avoid reuse of KEM public keys, implementations that do reuse KEM public keys MUST ensure that the number of reuses of a KEM public key abides by any bounds in the specification of the KEM or subsequent security analyses.  Implementations MUST NOT reuse randomness in the generation of KEM ciphertexts.<a href="#section-2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="construction">
<section id="section-3">
      <h2 id="name-construction-for-hybrid-key">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-construction-for-hybrid-key" class="section-name selfRef">Construction for hybrid key exchange</a>
      </h2>
<div id="construction-negotiation">
<section id="section-3.1">
        <h3 id="name-negotiation">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-negotiation" class="section-name selfRef">Negotiation</a>
        </h3>
<p id="section-3.1-1">Each particular combination of algorithms in a hybrid key exchange will be represented as a <code>NamedGroup</code> and sent in the <code>supported_groups</code> extension.  No internal structure or grammar is implied or required in the value of the identifier; they are simply opaque identifiers.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Each value representing a hybrid key exchange will correspond to an ordered pair of two algorithms.  For example, a future document could specify that one codepoint corresponds to secp256r1+PQALG1, and another corresponds to x25519+PQALG1.  (We note that this is independent from future documents standardizing solely post-quantum key exchange methods, which would have to be assigned their own identifier.)<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Specific values shall be standardized by IANA in the TLS Supported Groups registry.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-4">
<pre>
    enum {

          /* Elliptic Curve Groups (ECDHE) */
          secp256r1(0x0017), secp384r1(0x0018), secp521r1(0x0019),
          x25519(0x001D), x448(0x001E),

          /* Finite Field Groups (DHE) */
          ffdhe2048(0x0100), ffdhe3072(0x0101), ffdhe4096(0x0102),
          ffdhe6144(0x0103), ffdhe8192(0x0104),

          /* Hybrid Key Exchange Methods */
          TBD(0xTBD), ...,

          /* Reserved Code Points */
          ffdhe_private_use(0x01FC..0x01FF),
          ecdhe_private_use(0xFE00..0xFEFF),
          (0xFFFF)
    } NamedGroup;
</pre><a href="#section-3.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="construction-transmitting">
<section id="section-3.2">
        <h3 id="name-transmitting-public-keys-an">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-transmitting-public-keys-an" class="section-name selfRef">Transmitting public keys and ciphertexts</a>
        </h3>
<p id="section-3.2-1">We take the relatively simple "concatenation approach": the messages from the two algorithms being hybridized will be concatenated together and transmitted as a single value, to avoid having to change existing data structures.  The values are directly concatenated, without any additional encoding or length fields; this assumes that the representation and length of elements is fixed once the algorithm is fixed.  If concatenation were to be used with values that are not fixed-length, a length prefix or other unambiguous encoding must be used to ensure that the composition of the two values is injective and requires a mechanism different from that specified in this document.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Recall that in TLS 1.3 a KEM public key or KEM ciphertext is represented as a <code>KeyShareEntry</code>:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-3">
<pre>
    struct {
        NamedGroup group;
        opaque key_exchange&lt;1..2^16-1&gt;;
    } KeyShareEntry;
</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2-4">These are transmitted in the <code>extension_data</code> fields of <code>KeyShareClientHello</code> and <code>KeyShareServerHello</code> extensions:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-5">
<pre>
    struct {
        KeyShareEntry client_shares&lt;0..2^16-1&gt;;
    } KeyShareClientHello;

    struct {
        KeyShareEntry server_share;
    } KeyShareServerHello;
</pre><a href="#section-3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-3.2-6">The client's shares are listed in descending order of client preference; the server selects one algorithm and sends its corresponding share.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">For a hybrid key exchange, the <code>key_exchange</code> field of a <code>KeyShareEntry</code> is the concatenation of the <code>key_exchange</code> field for each of the constituent algorithms.  The order of shares in the concatenation is the same as the order of algorithms indicated in the definition of the <code>NamedGroup</code>.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">For the client's share, the <code>key_exchange</code> value contains the concatenation of the <code>pk</code> outputs of the corresponding KEMs' <code>KeyGen</code> algorithms, if that algorithm corresponds to a KEM; or the (EC)DH ephemeral key share, if that algorithm corresponds to an (EC)DH group.  For the server's share, the <code>key_exchange</code> value contains concatenation of the <code>ct</code> outputs of the corresponding KEMs' <code>Encaps</code> algorithms, if that algorithm corresponds to a KEM; or the (EC)DH ephemeral key share, if that algorithm corresponds to an (EC)DH group.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9"><span>[<a href="#TLS13" class="xref">TLS13</a>]</span> requires that ``The key_exchange values for each KeyShareEntry MUST be generated independently.''  In the context of this document, since the same algorithm may appear in multiple named groups, we relax the above requirement to allow the same key_exchange value for the same algorithm to be reused in multiple KeyShareEntry records sent in within the same <code>ClientHello</code>.  However, key_exchange values for different algorithms MUST be generated independently.<a href="#section-3.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="construction-shared-secret">
<section id="section-3.3">
        <h3 id="name-shared-secret-calculation">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-shared-secret-calculation" class="section-name selfRef">Shared secret calculation</a>
        </h3>
<p id="section-3.3-1">Here we also take a simple "concatenation approach": the two shared secrets are concatenated together and used as the shared secret in the existing TLS 1.3 key schedule.  Again, we do not add any additional structure (length fields) in the concatenation procedure: among all Round 3 finalists and alternate candidates, once the algorithm and variant are specified, the shared secret output length is fixed.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">In other words, the shared secret is calculated as<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-3">
<pre>
    concatenated_shared_secret = shared_secret_1 || shared_secret_2
</pre><a href="#section-3.3-3" class="pilcrow">¶</a>
</div>
<p id="section-3.3-4">and inserted into the TLS 1.3 key schedule in place of the (EC)DHE shared secret:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-5">
<pre>
                                    0
                                    |
                                    v
                      PSK -&gt;  HKDF-Extract = Early Secret
                                    |
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    |
                                    v
                              Derive-Secret(., "derived", "")
                                    |
                                    v
concatenated_shared_secret -&gt; HKDF-Extract = Handshake Secret
^^^^^^^^^^^^^^^^^^^^^^^^^^          |
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    |
                                    v
                              Derive-Secret(., "derived", "")
                                    |
                                    v
                         0 -&gt; HKDF-Extract = Master Secret
                                    |
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
</pre><a href="#section-3.3-5" class="pilcrow">¶</a>
</div>
<p id="section-3.3-6"><strong>FIPS-compliance of shared secret concatenation.</strong>
          <span>[<a href="#NIST-SP-800-56C" class="xref">NIST-SP-800-56C</a>]</span> or <span>[<a href="#NIST-SP-800-135" class="xref">NIST-SP-800-135</a>]</span> give NIST recommendations for key derivation methods in key exchange protocols.  Some hybrid combinations may combine the shared secret from a NIST-approved algorithm (e.g., ECDH using the nistp256/secp256r1 curve) with a shared secret from a non-approved algorithm (e.g., post-quantum).  <span>[<a href="#NIST-SP-800-56C" class="xref">NIST-SP-800-56C</a>]</span> lists simple concatenation as an approved method for generation of a hybrid shared secret in which one of the constituent shared secret is from an approved method.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="discussion">
<section id="section-4">
      <h2 id="name-discussion">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-discussion" class="section-name selfRef">Discussion</a>
      </h2>
<p id="section-4-1"><strong>Larger public keys and/or ciphertexts.</strong>
The <code>HybridKeyExchange</code> struct in <a href="#construction-transmitting" class="xref">Section 3.2</a> limits public keys and ciphertexts to 2^16-1 bytes; this is bounded by the same (2^16-1)-byte limit on the <code>key_exchange</code> field in the <code>KeyShareEntry</code> struct.  Some post-quantum KEMs have larger public keys and/or ciphertexts; for example, Classic McEliece's smallest parameter set has public key size 261,120 bytes.  Hence this draft can not accommodate all current NIST Round 3 candidates.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2"><strong>Duplication of key shares.</strong>
Concatenation of public keys in the <code>HybridKeyExchange</code> struct as described in <a href="#construction-transmitting" class="xref">Section 3.2</a> can result in sending duplicate key shares.  For example, if a client wanted to offer support for two combinations, say "secp256r1+sikep503" and "x25519+sikep503", it would end up sending two sikep503 public keys, since the <code>KeyShareEntry</code> for each combination contains its own copy of a sikep503 key.  This duplication may be more problematic for post-quantum algorithms which have larger public keys.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3"><strong>Failures.</strong>
Some post-quantum key exchange algorithms have non-zero probability of failure, meaning two honest parties may derive different shared secrets.  This would cause a handshake failure.  All current NIST Round 3 candidates have either 0 or cryptographically small failure rate; if other algorithms are used, implementers should be aware of the potential of handshake failure. Clients can retry if a failure is encountered.<a href="#section-4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">Identifiers for specific key exchange algorithm combinations will be defined in later documents.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">The shared secrets computed in the hybrid key exchange should be computed in a way that achieves the "hybrid" property: the resulting secret is secure as long as at least one of the component key exchange algorithms is unbroken.  See <span>[<a href="#GIACON" class="xref">GIACON</a>]</span> and <span>[<a href="#BINDEL" class="xref">BINDEL</a>]</span> for an investigation of these issues.  Under the assumption that shared secrets are fixed length once the combination is fixed, the construction from <a href="#construction-shared-secret" class="xref">Section 3.3</a> corresponds to the dual-PRF combiner of <span>[<a href="#BINDEL" class="xref">BINDEL</a>]</span> which is shown to preserve security under the assumption that the hash function is a dual-PRF.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">As noted in <a href="#kems" class="xref">Section 2</a>, KEMs used in the manner described in this document MUST explicitly be designed to be secure in the event that the public key is reused, such as achieving IND-CCA2 security or having a transform like the Fujisaki-Okamoto transform applied.  Some IND-CPA-secure post-quantum KEMs (i.e., without countermeasures such as the FO transform) are completely insecure under public key reuse; for example, some lattice-based IND-CPA-secure KEMs are vulnerable to attacks that recover the private key after just a few thousand samples <span>[<a href="#FLUHRER" class="xref">FLUHRER</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3"><strong>Public keys, ciphertexts, and secrets should be constant length.</strong>
This document assumes that the length of each public key, ciphertext, and shared secret is fixed once the algorithm is fixed.  This is the case for all Round 3 finalists and alternate candidates.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Note that variable-length secrets are, generally speaking, dangerous.  In particular, when using key material of variable length and processing it using hash functions, a timing side channel may arise.  In broad terms, when the secret is longer, the hash function may need to process more blocks internally.  In some unfortunate circumstances, this has led to timing attacks, e.g. the Lucky Thirteen <span>[<a href="#LUCKY13" class="xref">LUCKY13</a>]</span> and Raccoon <span>[<a href="#RACCOON" class="xref">RACCOON</a>]</span> attacks.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">Furthermore, <span>[<a href="#AVIRAM" class="xref">AVIRAM</a>]</span> identified a risk of using variable-length secrets when the hash function used in the key derivation function is no longer collision-resistant.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">Therefore, this specification MUST only be used with algorithms which have fixed-length shared secrets (after the variant has been fixed by the algorithm identifier in the <code>NamedGroup</code> negotiation in <a href="#construction-negotiation" class="xref">Section 3.1</a>).<a href="#section-6-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-7">
      <h2 id="name-acknowledgements">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-7-1">These ideas have grown from discussions with many colleagues, including Christopher Wood, Matt Campagna, Eric Crockett, authors of the various hybrid Internet-Drafts and implementations cited in this document, and members of the TLS working group.  The immediate impetus for this document came from discussions with attendees at the Workshop on Post-Quantum Software in Mountain View, California, in January 2019.  Daniel J. Bernstein and Tanja Lange commented on the risks of reuse of ephemeral public keys.  Matt Campagna and the team at Amazon Web Services provided additional suggestions.  Nimrod Aviram proposed restricting to fixed-length secrets.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="TLS13">[TLS13]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AVIRAM">[AVIRAM]</dt>
        <dd>
<span class="refAuthor">Nimrod Aviram, .</span>, <span class="refAuthor">Benjamin Dowling, .</span>, <span class="refAuthor">Ilan Komargodski, .</span>, <span class="refAuthor">Kenny Paterson, .</span>, <span class="refAuthor">Eyal Ronen, .</span>, and <span class="refAuthor">. Eylon Yogev</span>, <span class="refTitle">"[TLS] Combining Secrets in Hybrid Key Exchange in TLS 1.3"</span>, <time datetime="2021-09-01" class="refDate">1 September 2021</time>, <span>&lt;<a href="https://mailarchive.ietf.org/arch/msg/tls/F4SVeL2xbGPaPB2GW_GkBbD_a5M/">https://mailarchive.ietf.org/arch/msg/tls/F4SVeL2xbGPaPB2GW_GkBbD_a5M/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BCNS15">[BCNS15]</dt>
        <dd>
<span class="refAuthor">Bos, J.</span>, <span class="refAuthor">Costello, C.</span>, <span class="refAuthor">Naehrig, M.</span>, and <span class="refAuthor">D. Stebila</span>, <span class="refTitle">"Post-Quantum Key Exchange for the TLS Protocol from the Ring Learning with Errors Problem"</span>, <span class="seriesInfo">2015 IEEE Symposium on Security and Privacy</span>, <span class="seriesInfo">DOI 10.1109/sp.2015.40</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://doi.org/10.1109/sp.2015.40">https://doi.org/10.1109/sp.2015.40</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BERNSTEIN">[BERNSTEIN]</dt>
        <dd>
<span class="refTitle">"Post-Quantum Cryptography"</span>, <span class="seriesInfo">Springer Berlin Heidelberg book</span>, <span class="seriesInfo">DOI 10.1007/978-3-540-88702-7</span>, <time datetime="2009" class="refDate">2009</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-540-88702-7">https://doi.org/10.1007/978-3-540-88702-7</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BINDEL">[BINDEL]</dt>
        <dd>
<span class="refAuthor">Bindel, N.</span>, <span class="refAuthor">Brendel, J.</span>, <span class="refAuthor">Fischlin, M.</span>, <span class="refAuthor">Goncalves, B.</span>, and <span class="refAuthor">D. Stebila</span>, <span class="refTitle">"Hybrid Key Encapsulation Mechanisms and Authenticated Key Exchange"</span>, <span class="seriesInfo">Post-Quantum Cryptography pp. 206-226</span>, <span class="seriesInfo">DOI 10.1007/978-3-030-25510-7_12</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-030-25510-7_12">https://doi.org/10.1007/978-3-030-25510-7_12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CAMPAGNA">[CAMPAGNA]</dt>
        <dd>
<span class="refAuthor">Campagna, M.</span> and <span class="refAuthor">E. Crockett</span>, <span class="refTitle">"Hybrid Post-Quantum Key Encapsulation Methods (PQ KEM) for Transport Layer Security 1.2 (TLS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-campagna-tls-bike-sike-hybrid-07</span>, <time datetime="2021-09-02" class="refDate">2 September 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-campagna-tls-bike-sike-hybrid-07.txt">https://www.ietf.org/archive/id/draft-campagna-tls-bike-sike-hybrid-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CECPQ1">[CECPQ1]</dt>
        <dd>
<span class="refAuthor">Braithwaite, M.</span>, <span class="refTitle">"Experimenting with Post-Quantum Cryptography"</span>, <time datetime="2016-07-07" class="refDate">7 July 2016</time>, <span>&lt;<a href="https://security.googleblog.com/2016/07/experimenting-with-post-quantum.html">https://security.googleblog.com/2016/07/experimenting-with-post-quantum.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CECPQ2">[CECPQ2]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refTitle">"CECPQ2"</span>, <time datetime="2018-12-12" class="refDate">12 December 2018</time>, <span>&lt;<a href="https://www.imperialviolet.org/2018/12/12/cecpq2.html">https://www.imperialviolet.org/2018/12/12/cecpq2.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DODIS">[DODIS]</dt>
        <dd>
<span class="refAuthor">Dodis, Y.</span> and <span class="refAuthor">J. Katz</span>, <span class="refTitle">"Chosen-Ciphertext Security of Multiple Encryption"</span>, <span class="seriesInfo">Theory of Cryptography pp. 188-209</span>, <span class="seriesInfo">DOI 10.1007/978-3-540-30576-7_11</span>, <time datetime="2005" class="refDate">2005</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-540-30576-7_11">https://doi.org/10.1007/978-3-540-30576-7_11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ETSI">[ETSI]</dt>
        <dd>
<span class="refAuthor">Campagna, M., Ed.</span> and <span class="refAuthor">. others</span>, <span class="refTitle">"Quantum safe cryptography and security: An introduction, benefits, enablers and challengers"</span>, <span class="seriesInfo">ETSI White Paper No. 8 </span>, <time datetime="2015-06" class="refDate">June 2015</time>, <span>&lt;<a href="https://www.etsi.org/images/files/ETSIWhitePapers/QuantumSafeWhitepaper.pdf">https://www.etsi.org/images/files/ETSIWhitePapers/QuantumSafeWhitepaper.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EVEN">[EVEN]</dt>
        <dd>
<span class="refAuthor">Even, S.</span> and <span class="refAuthor">O. Goldreich</span>, <span class="refTitle">"On the Power of Cascade Ciphers"</span>, <span class="seriesInfo">Advances in Cryptology pp. 43-50</span>, <span class="seriesInfo">DOI 10.1007/978-1-4684-4730-9_4</span>, <time datetime="1984" class="refDate">1984</time>, <span>&lt;<a href="https://doi.org/10.1007/978-1-4684-4730-9_4">https://doi.org/10.1007/978-1-4684-4730-9_4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EXTERN-PSK">[EXTERN-PSK]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"TLS 1.3 Extension for Certificate-Based Authentication with an External Pre-Shared Key"</span>, <span class="seriesInfo">RFC 8773</span>, <span class="seriesInfo">DOI 10.17487/RFC8773</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8773">https://www.rfc-editor.org/info/rfc8773</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FLUHRER">[FLUHRER]</dt>
        <dd>
<span class="refAuthor">Fluhrer, S.</span>, <span class="refTitle">"Cryptanalysis of ring-LWE based key exchange with key share reuse"</span>, <span class="seriesInfo">Cryptology ePrint Archive, Report 2016/085 </span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://eprint.iacr.org/2016/085">https://eprint.iacr.org/2016/085</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FO">[FO]</dt>
        <dd>
<span class="refAuthor">Fujisaki, E.</span> and <span class="refAuthor">T. Okamoto</span>, <span class="refTitle">"Secure Integration of Asymmetric and Symmetric Encryption Schemes"</span>, <span class="seriesInfo">Journal of Cryptology Vol. 26, pp. 80-101</span>, <span class="seriesInfo">DOI 10.1007/s00145-011-9114-1</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://doi.org/10.1007/s00145-011-9114-1">https://doi.org/10.1007/s00145-011-9114-1</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FRODO">[FRODO]</dt>
        <dd>
<span class="refAuthor">Bos, J.</span>, <span class="refAuthor">Costello, C.</span>, <span class="refAuthor">Ducas, L.</span>, <span class="refAuthor">Mironov, I.</span>, <span class="refAuthor">Naehrig, M.</span>, <span class="refAuthor">Nikolaenko, V.</span>, <span class="refAuthor">Raghunathan, A.</span>, and <span class="refAuthor">D. Stebila</span>, <span class="refTitle">"Frodo: Take off the Ring! Practical, Quantum-Secure Key Exchange from LWE"</span>, <span class="seriesInfo">Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security</span>, <span class="seriesInfo">DOI 10.1145/2976749.2978425</span>, <time datetime="2016-10" class="refDate">October 2016</time>, <span>&lt;<a href="https://doi.org/10.1145/2976749.2978425">https://doi.org/10.1145/2976749.2978425</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GIACON">[GIACON]</dt>
        <dd>
<span class="refAuthor">Giacon, F.</span>, <span class="refAuthor">Heuer, F.</span>, and <span class="refAuthor">B. Poettering</span>, <span class="refTitle">"KEM Combiners"</span>, <span class="seriesInfo">Public-Key Cryptography - PKC 2018 pp. 190-218</span>, <span class="seriesInfo">DOI 10.1007/978-3-319-76578-5_7</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-319-76578-5_7">https://doi.org/10.1007/978-3-319-76578-5_7</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HARNIK">[HARNIK]</dt>
        <dd>
<span class="refAuthor">Harnik, D.</span>, <span class="refAuthor">Kilian, J.</span>, <span class="refAuthor">Naor, M.</span>, <span class="refAuthor">Reingold, O.</span>, and <span class="refAuthor">A. Rosen</span>, <span class="refTitle">"On Robust Combiners for Oblivious Transfer and Other Primitives"</span>, <span class="seriesInfo">Lecture Notes in Computer Science pp. 96-113</span>, <span class="seriesInfo">DOI 10.1007/11426639_6</span>, <time datetime="2005" class="refDate">2005</time>, <span>&lt;<a href="https://doi.org/10.1007/11426639_6">https://doi.org/10.1007/11426639_6</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HHK">[HHK]</dt>
        <dd>
<span class="refAuthor">Hofheinz, D.</span>, <span class="refAuthor">Hovelmanns, K.</span>, and <span class="refAuthor">E. Kiltz</span>, <span class="refTitle">"A Modular Analysis of the Fujisaki-Okamoto Transformation"</span>, <span class="seriesInfo">Theory of Cryptography pp. 341-371</span>, <span class="seriesInfo">DOI 10.1007/978-3-319-70500-2_12</span>, <time datetime="2017" class="refDate">2017</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-319-70500-2_12">https://doi.org/10.1007/978-3-319-70500-2_12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HOFFMAN">[HOFFMAN]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"The Transition from Classical to Post-Quantum Cryptography"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hoffman-c2pq-07</span>, <time datetime="2020-05-26" class="refDate">26 May 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-hoffman-c2pq-07.txt">https://www.ietf.org/archive/id/draft-hoffman-c2pq-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-hpke">[I-D.irtf-cfrg-hpke]</dt>
        <dd>
<span class="refAuthor">Barnes, R. L.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hpke-12</span>, <time datetime="2021-09-02" class="refDate">2 September 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-hpke-12.txt">https://www.ietf.org/archive/id/draft-irtf-cfrg-hpke-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IKE-HYBRID">[IKE-HYBRID]</dt>
        <dd>
<span class="refAuthor">Tjhai, C.</span>, <span class="refAuthor">Tomlinson, M.</span>, <span class="refAuthor">Bartlett, G.</span>, <span class="refAuthor">Fluhrer, S.</span>, <span class="refAuthor">Geest, D. V.</span>, <span class="refAuthor">Garcia-Morchon, O.</span>, and <span class="refAuthor">V. Smyslov</span>, <span class="refTitle">"Framework to Integrate Post-quantum Key Exchanges into Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tjhai-ipsecme-hybrid-qske-ikev2-04</span>, <time datetime="2019-07-09" class="refDate">9 July 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-tjhai-ipsecme-hybrid-qske-ikev2-04.txt">https://www.ietf.org/archive/id/draft-tjhai-ipsecme-hybrid-qske-ikev2-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IKE-PSK">[IKE-PSK]</dt>
        <dd>
<span class="refAuthor">Fluhrer, S.</span>, <span class="refAuthor">Kampanakis, P.</span>, <span class="refAuthor">McGrew, D.</span>, and <span class="refAuthor">V. Smyslov</span>, <span class="refTitle">"Mixing Preshared Keys in the Internet Key Exchange Protocol Version 2 (IKEv2) for Post-quantum Security"</span>, <span class="seriesInfo">RFC 8784</span>, <span class="seriesInfo">DOI 10.17487/RFC8784</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8784">https://www.rfc-editor.org/info/rfc8784</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KIEFER">[KIEFER]</dt>
        <dd>
<span class="refAuthor">Kiefer, F.</span> and <span class="refAuthor">K. Kwiatkowski</span>, <span class="refTitle">"Hybrid ECDHE-SIDH Key Exchange for TLS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-kiefer-tls-ecdhe-sidh-00</span>, <time datetime="2018-11-05" class="refDate">5 November 2018</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-kiefer-tls-ecdhe-sidh-00.txt">https://www.ietf.org/archive/id/draft-kiefer-tls-ecdhe-sidh-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LANGLEY">[LANGLEY]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refTitle">"Post-quantum confidentiality for TLS"</span>, <time datetime="2018-04-11" class="refDate">11 April 2018</time>, <span>&lt;<a href="https://www.imperialviolet.org/2018/04/11/pqconftls.html">https://www.imperialviolet.org/2018/04/11/pqconftls.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LUCKY13">[LUCKY13]</dt>
        <dd>
<span class="refAuthor">Al Fardan, N.J.</span> and <span class="refAuthor">K.G. Paterson</span>, <span class="refTitle">"Lucky Thirteen: Breaking the TLS and DTLS record protocols"</span>, <span>n.d.</span>, <span>&lt;<a href="https://ieeexplore.ieee.org/iel7/6547086/6547088/06547131.pdf">https://ieeexplore.ieee.org/iel7/6547086/6547088/06547131.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIELSEN">[NIELSEN]</dt>
        <dd>
<span class="refAuthor">Nielsen, M.A.</span> and <span class="refAuthor">I.L. Chuang</span>, <span class="refTitle">"Quantum Computation and Quantum Information"</span>, <span class="seriesInfo">Cambridge University Press </span>, <time datetime="2000" class="refDate">2000</time>. </dd>
<dd class="break"></dd>
<dt id="NIST">[NIST]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Post-Quantum Cryptography"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.nist.gov/pqcrypto">https://www.nist.gov/pqcrypto</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-SP-800-135">[NIST-SP-800-135]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Recommendation for Existing Application-Specific Key Derivation Functions"</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-135r1">https://doi.org/10.6028/NIST.SP.800-135r1</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-SP-800-56C">[NIST-SP-800-56C]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Recommendation for Key-Derivation Methods in Key-Establishment Schemes"</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-56Cr2">https://doi.org/10.6028/NIST.SP.800-56Cr2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OQS-102">[OQS-102]</dt>
        <dd>
<span class="refAuthor">Open Quantum Safe Project</span>, <span class="refTitle">"OQS-OpenSSL-1-0-2_stable"</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://github.com/open-quantum-safe/openssl/tree/OQS-OpenSSL_1_0_2-stable">https://github.com/open-quantum-safe/openssl/tree/OQS-OpenSSL_1_0_2-stable</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OQS-111">[OQS-111]</dt>
        <dd>
<span class="refAuthor">Open Quantum Safe Project</span>, <span class="refTitle">"OQS-OpenSSL-1-1-1_stable"</span>, <time datetime="2022-01" class="refDate">January 2022</time>, <span>&lt;<a href="https://github.com/open-quantum-safe/openssl/tree/OQS-OpenSSL_1_1_1-stable">https://github.com/open-quantum-safe/openssl/tree/OQS-OpenSSL_1_1_1-stable</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PST">[PST]</dt>
        <dd>
<span class="refAuthor">Paquin, C.</span>, <span class="refAuthor">Stebila, D.</span>, and <span class="refAuthor">G. Tamvada</span>, <span class="refTitle">"Benchmarking Post-quantum Cryptography in TLS"</span>, <span class="seriesInfo">Post-Quantum Cryptography pp. 72-91</span>, <span class="seriesInfo">DOI 10.1007/978-3-030-44223-1_5</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-030-44223-1_5">https://doi.org/10.1007/978-3-030-44223-1_5</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RACCOON">[RACCOON]</dt>
        <dd>
<span class="refAuthor">Merget, R.</span>, <span class="refAuthor">Brinkmann, M.</span>, <span class="refAuthor">Aviram, N.</span>, <span class="refAuthor">Somorovsky, J.</span>, <span class="refAuthor">Mittmann, J.</span>, and <span class="refAuthor">J. Schwenk</span>, <span class="refTitle">"Raccoon Attack: Finding and Exploiting Most-Significant-Bit-Oracles in TLS-DH(E)"</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://raccoon-attack.com/">https://raccoon-attack.com/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="S2N">[S2N]</dt>
        <dd>
<span class="refAuthor">Amazon Web Services</span>, <span class="refTitle">"Post-quantum TLS now supported in AWS KMS"</span>, <time datetime="2019-11-04" class="refDate">4 November 2019</time>, <span>&lt;<a href="https://aws.amazon.com/blogs/security/post-quantum-tls-now-supported-in-aws-kms/">https://aws.amazon.com/blogs/security/post-quantum-tls-now-supported-in-aws-kms/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCHANCK">[SCHANCK]</dt>
        <dd>
<span class="refAuthor">Schanck, J. M.</span> and <span class="refAuthor">D. Stebila</span>, <span class="refTitle">"A Transport Layer Security (TLS) Extension For Establishing An Additional Shared Secret"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-schanck-tls-additional-keyshare-00</span>, <time datetime="2017-04-17" class="refDate">17 April 2017</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-schanck-tls-additional-keyshare-00.txt">https://www.ietf.org/archive/id/draft-schanck-tls-additional-keyshare-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WHYTE12">[WHYTE12]</dt>
        <dd>
<span class="refAuthor">Schanck, J. M.</span>, <span class="refAuthor">Whyte, W.</span>, and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"Quantum-Safe Hybrid (QSH) Ciphersuite for Transport Layer Security (TLS) version 1.2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-whyte-qsh-tls12-02</span>, <time datetime="2016-07-22" class="refDate">22 July 2016</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-whyte-qsh-tls12-02.txt">https://www.ietf.org/archive/id/draft-whyte-qsh-tls12-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WHYTE13">[WHYTE13]</dt>
        <dd>
<span class="refAuthor">Whyte, W.</span>, <span class="refAuthor">Zhang, Z.</span>, <span class="refAuthor">Fluhrer, S.</span>, and <span class="refAuthor">O. Garcia-Morchon</span>, <span class="refTitle">"Quantum-Safe Hybrid (QSH) Key Exchange for Transport Layer Security (TLS) version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-whyte-qsh-tls13-06</span>, <time datetime="2017-10-03" class="refDate">3 October 2017</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-whyte-qsh-tls13-06.txt">https://www.ietf.org/archive/id/draft-whyte-qsh-tls13-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XMSS">[XMSS]</dt>
        <dd>
<span class="refAuthor">Huelsing, A.</span>, <span class="refAuthor">Butin, D.</span>, <span class="refAuthor">Gazdag, S.</span>, <span class="refAuthor">Rijneveld, J.</span>, and <span class="refAuthor">A. Mohaisen</span>, <span class="refTitle">"XMSS: eXtended Merkle Signature Scheme"</span>, <span class="seriesInfo">RFC 8391</span>, <span class="seriesInfo">DOI 10.17487/RFC8391</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8391">https://www.rfc-editor.org/info/rfc8391</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZHANG">[ZHANG]</dt>
      <dd>
<span class="refAuthor">Zhang, R.</span>, <span class="refAuthor">Hanaoka, G.</span>, <span class="refAuthor">Shikata, J.</span>, and <span class="refAuthor">H. Imai</span>, <span class="refTitle">"On the Security of Multiple Encryption or CCA-security+CCA-security=CCA-security?"</span>, <span class="seriesInfo">Public Key Cryptography - PKC 2004 pp. 360-374</span>, <span class="seriesInfo">DOI 10.1007/978-3-540-24632-9_26</span>, <time datetime="2004" class="refDate">2004</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-540-24632-9_26">https://doi.org/10.1007/978-3-540-24632-9_26</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="related-work">
<section id="appendix-A">
      <h2 id="name-related-work">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-related-work" class="section-name selfRef">Related work</a>
      </h2>
<p id="appendix-A-1">Quantum computing and post-quantum cryptography in general are outside the scope of this document.  For a general introduction to quantum computing, see a standard textbook such as <span>[<a href="#NIELSEN" class="xref">NIELSEN</a>]</span>.  For an overview of post-quantum cryptography as of 2009, see <span>[<a href="#BERNSTEIN" class="xref">BERNSTEIN</a>]</span>.  For the current status of the NIST Post-Quantum Cryptography Standardization Project, see <span>[<a href="#NIST" class="xref">NIST</a>]</span>.  For additional perspectives on the general transition from classical to post-quantum cryptography, see for example <span>[<a href="#ETSI" class="xref">ETSI</a>]</span> and <span>[<a href="#HOFFMAN" class="xref">HOFFMAN</a>]</span>, among others.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">There have been several Internet-Drafts describing mechanisms for embedding post-quantum and/or hybrid key exchange in TLS:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-3.1">Internet-Drafts for TLS 1.2: <span>[<a href="#WHYTE12" class="xref">WHYTE12</a>]</span>, <span>[<a href="#CAMPAGNA" class="xref">CAMPAGNA</a>]</span><a href="#appendix-A-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-3.2">Internet-Drafts for TLS 1.3: <span>[<a href="#KIEFER" class="xref">KIEFER</a>]</span>, <span>[<a href="#SCHANCK" class="xref">SCHANCK</a>]</span>, <span>[<a href="#WHYTE13" class="xref">WHYTE13</a>]</span><a href="#appendix-A-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-4">There have been several prototype implementations for post-quantum and/or hybrid key exchange in TLS:<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">Experimental implementations in TLS 1.2: <span>[<a href="#BCNS15" class="xref">BCNS15</a>]</span>, <span>[<a href="#CECPQ1" class="xref">CECPQ1</a>]</span>, <span>[<a href="#FRODO" class="xref">FRODO</a>]</span>, <span>[<a href="#OQS-102" class="xref">OQS-102</a>]</span>, <span>[<a href="#S2N" class="xref">S2N</a>]</span><a href="#appendix-A-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.2">Experimental implementations in TLS 1.3: <span>[<a href="#CECPQ2" class="xref">CECPQ2</a>]</span>, <span>[<a href="#OQS-111" class="xref">OQS-111</a>]</span>, <span>[<a href="#PST" class="xref">PST</a>]</span><a href="#appendix-A-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-6">These experimental implementations have taken an ad hoc approach and not attempted to implement one of the drafts listed above.<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<p id="appendix-A-7">Unrelated to post-quantum but still related to the issue of combining multiple types of keying material in TLS is the use of pre-shared keys, especially the recent TLS working group document on including an external pre-shared key <span>[<a href="#EXTERN-PSK" class="xref">EXTERN-PSK</a>]</span>.<a href="#appendix-A-7" class="pilcrow">¶</a></p>
<p id="appendix-A-8">Considering other IETF standards, there is work on post-quantum preshared keys in IKEv2 <span>[<a href="#IKE-PSK" class="xref">IKE-PSK</a>]</span> and a framework for hybrid key exchange in IKEv2 <span>[<a href="#IKE-HYBRID" class="xref">IKE-HYBRID</a>]</span>.  The XMSS hash-based signature scheme has been published as an informational RFC by the IRTF <span>[<a href="#XMSS" class="xref">XMSS</a>]</span>.<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<p id="appendix-A-9">In the academic literature, <span>[<a href="#EVEN" class="xref">EVEN</a>]</span> initiated the study of combining multiple symmetric encryption schemes; <span>[<a href="#ZHANG" class="xref">ZHANG</a>]</span>, <span>[<a href="#DODIS" class="xref">DODIS</a>]</span>, and <span>[<a href="#HARNIK" class="xref">HARNIK</a>]</span> examined combining multiple public key encryption schemes, and <span>[<a href="#HARNIK" class="xref">HARNIK</a>]</span> coined the term "robust combiner" to refer to a compiler that constructs a hybrid scheme from individual schemes while preserving security properties.  <span>[<a href="#GIACON" class="xref">GIACON</a>]</span> and <span>[<a href="#BINDEL" class="xref">BINDEL</a>]</span> examined combining multiple key encapsulation mechanisms.<a href="#appendix-A-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Douglas Stebila</span></div>
<div dir="auto" class="left"><span class="org">University of Waterloo</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dstebila@uwaterloo.ca" class="email">dstebila@uwaterloo.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Scott Fluhrer</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sfluhrer@cisco.com" class="email">sfluhrer@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shay Gueron</span></div>
<div dir="auto" class="left"><span class="org">University of Haifa and Amazon Web Services</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shay.gueron@gmail.com" class="email">shay.gueron@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
