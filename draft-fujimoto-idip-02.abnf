IDIP-message = IDIP-Request | IDIP-Response

IDIP-request = IDIP-command IDIP-parameters CRLF IDIP-data

               = IDIep-request | IDIiup-request | IDIidp-request


IDIP-response = IDIP-status IDIP-parameters CRLF IDIP-data

                = IDIep-response | IDIiup-response | IDIidp-response

IDIP-parameters = *(IDIP-parameter CRLF)

IDIP-status = status-code SP status-description CRLF

status-code   = success       ; 1xx
                 | client-error  ; 2xx
                 | server-error  ; 3xx
                 | generic-error ; 4xx

success           = "100" ; OK

client-error      = "201" ; Authentication Error
                     | "202" ; Request Denied
                     | "203" ; Function Not Launched
                     | "204" ; Parameter Not Acceptable
                     | "205" ; Launch Failed
                     | "206" ; Bad Request
server-error      = "301" ; Invalid Callee
                     | "302" ; Server Internal Error
                     | "303" ; No Function Available
                     | "304" ; Cannot Provide Acceptable Data
                     | "305" ; Server Timeout
                     | "306" ; IDO Moved
                     | "307" ; Function Busy
                     | "308" ; IDO Not Found
                     | "309" ; No IDIep Connection
                     | "310" ; No IDIiup Connection
                     | "311" ; No IDIidp Connection

generic-error     = "401" ; Unknown Error

status-description  = 1*TEXT

IDIP-parameter = IDO-To
                  | IDO-From
                  | content-type
                  | content-length
                  | accept-type
                  | IDIP-authenticate
                  | location
                  | keyword
                  | functionid
                  | FEname
                  | admitfrom
                  | denyfrom


IDO-To         = "To:" SP IDO-Address

IDO-From       = "From:" SP IDO-Address

IDO-Address    = identity_name ["@" host [":" port]]

identity_name  = 1 * <CHAR except "@">

host           = <FQDN or IP address (in dotted-decimal form),
                    as defined by Section 2.1 of RFC 1123>

port           = DIGIT


content-type   = "Content-Type:" SP media-type

media-type     = type "/" subtype *( ";" parameter )

type           = token

subtype        = token

parameter      = attribute "=" value

attribute      = token

value          = token | quoted-string

content-length = "Content-Length:" SP 1*DIGIT

   An example is

       Content-Length: 1024

accept-type       = "Accept-Type:" SP media-type

IDIP-authenticate = "IDIP-Authenticate:" SP auth-options

auth-options      = option *(";" option )

option 		  = authenticate-style

authenticate-style = "style" "=" value

keyword      = "Keywords:" SP IDIP-keyword

IDIP-keyword = [key "="] word CRLF

key          = token

word         = token

location     = "Location:" SP location

location     = IDO-Address

functionid   = "FunctionId:" SP functionId

FunctionId   = DIGIT

FEname       = token

admitfrom    = "Admit-from:" groupId | IDOaddress *(","  IDOaddress )

denyfrom     = "Deny-from:" groupId | IDOaddress *(","  IDOaddress )

groupId = "#" atom

IDIP-request = IDIP-command IDIP-parameters CRLF IDIP-data

IDIP-parameters = *(IDIP-parameter CRLF)


IDIP-command  =  IDIep-start-request      ;6.1
                   |IDIep-list-request       ;6.2
                   |IDIep-call-request       ;6.3
                   |IDIep-kill-request       ;6.4
                   |IDIep-end-request        ;6.5

IDIep-response = status IDIP-parameters CRLF IDIP-data

                 = Successful response                      ; 7.1
                 | Authentication error response            ; 7.2
                 | Redirect response                        ; 7.3
                 | No function available error response     ; 7.4
                 | Function not found error response        ; 7.5
                 | Parameter not acceptable error response  ; 7.6


IDIiup-Request  = IDIiup-login-request     ;8.1
                    |IDIiup-logout-request    ;8.2
                    |IDIiup-start-request     ;8.3
                    |IDIiup-end-request       ;8.4
                    |IDIiup-list-request      ;8.5
                    |IDIiup-call-request      ;8.6
                    |IDIiup-kill-request      ;8.7
                    |IDIiup-catch-request     ;8.8
                    |IDIiup-free-request      ;8.9
                    |IDIiup-add-request       ;8.10
                    |IDIiup-delete-request    ;8.11
                    |IDIiup-disable-request   ;8.12
                    |IDIiup-enable-request    ;8.13
                    |IDIiup-redirect-request  ;8.14

IDIiup-response = status IDIP-parameters CRLF IDIP-data

                   = successful response             ; 9.1
                   | authentication error response   ; 9.2
                   | no IDIiup connection response   ; 9.3
                   | no IDIep connection response    ; 9.4
                   | IDO moved response              ; 9.5
                   | IDO not found response          ; 9.6
                   | function not launched error     ; 9.7
                   | parameter not acceptable error  ; 9.8
                   | no function available error     ; 9.9


IDIidp-Request  = IDIidp-list-request      ;10.1
                    |IDIidp-call-request      ;10.2

IDIidp-response = status IDIP-parameters CRLF IDIP-data

                   = successful response             ; 11.1
                   | authentication error response   ; 11.2
                   | parameter not acceptable error  ; 11.3
                   | no function available error     ; 11.4

