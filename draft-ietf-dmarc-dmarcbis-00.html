<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Domain-based Message Authentication, Reporting, and Conformance (DMARC)</title>
<meta content="Emil Gustafsson" name="author">
<meta content="Todd M. Herr" name="author">
<meta content="John Levine" name="author">
<meta content="
       This document describes the Domain-based Message Authentication,
Reporting, and Conformance (DMARC) protocol. 
       DMARC is a scalable mechanism by which a mail-originating organization
can express domain-level policies and preferences for message validation,
disposition, and reporting. Mail-receiving organizations can in turn use
these expressions of policies and preferences to inform their mail handling
decisions should they choose to do so. 
       This document obsoletes RFC 7489. 
    " name="description">
<meta content="xml2rfc 3.4.0" name="generator">
<meta content="draft-ietf-dmarc-dmarcbis-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.4.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.1
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.24.0
    setuptools 40.6.2
    six 1.15.0
-->
<link href="/tmp/draft-ietf-dmarc-dmarcbis-00-c9nzjrdv.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DMARCbis</td>
<td class="right">November 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Gustafsson (ed), et al.</td>
<td class="center">Expires 15 May 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">DMARC</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-dmarc-dmarcbis-00</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc7489" class="eref">7489</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-11-11" class="published">11 November 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-05-15">15 May 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Gustafsson (ed)</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">T. Herr (ed)</div>
<div class="org">Valimail</div>
</div>
<div class="author">
      <div class="author-name">J. Levine (ed)</div>
<div class="org">Standcore LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Domain-based Message Authentication, Reporting, and Conformance (DMARC)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Domain-based Message Authentication,
Reporting, and Conformance (DMARC) protocol.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">DMARC is a scalable mechanism by which a mail-originating organization
can express domain-level policies and preferences for message validation,
disposition, and reporting. Mail-receiving organizations can in turn use
these expressions of policies and preferences to inform their mail handling
decisions should they choose to do so.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document obsoletes RFC 7489.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 15 May 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-requirements" class="xref">Requirements</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-high-level-goals" class="xref">High-Level Goals</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-out-of-scope" class="xref">Out of Scope</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-scalability" class="xref">Scalability</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-anti-phishing" class="xref">Anti-Phishing</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-terminology-and-definitions" class="xref">Terminology and Definitions</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-identifier-alignment" class="xref">Identifier Alignment</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-dkim-authenticated-identifi" class="xref">DKIM-Authenticated Identifiers</a><a href="#section-toc.1-1.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-spf-authenticated-identifie" class="xref">SPF-Authenticated Identifiers</a><a href="#section-toc.1-1.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.  <a href="#name-alignment-and-extension-tec" class="xref">Alignment and Extension Technologies</a><a href="#section-toc.1-1.3.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-organizational-domain" class="xref">Organizational Domain</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-authentication-mechanisms" class="xref">Authentication Mechanisms</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-key-concepts" class="xref">Key Concepts</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-flow-diagram" class="xref">Flow Diagram</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-use-of-rfc5322from" class="xref">Use of RFC5322.From</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-policy" class="xref">Policy</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-dmarc-policy-record" class="xref">DMARC Policy Record</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-dmarc-uris" class="xref">DMARC URIs</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-general-record-format" class="xref">General Record Format</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-formal-definition" class="xref">Formal Definition</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-domain-owner-actions" class="xref">Domain Owner Actions</a><a href="#section-toc.1-1.6.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-mail-receiver-actions" class="xref">Mail Receiver Actions</a><a href="#section-toc.1-1.6.2.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.6.2.1">
                    <p id="section-toc.1-1.6.2.6.2.1.1"><a href="#section-6.6.1" class="xref">6.6.1</a>.  <a href="#name-extract-author-domain" class="xref">Extract Author Domain</a><a href="#section-toc.1-1.6.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.6.2.2">
                    <p id="section-toc.1-1.6.2.6.2.2.1"><a href="#section-6.6.2" class="xref">6.6.2</a>.  <a href="#name-determine-handling-policy" class="xref">Determine Handling Policy</a><a href="#section-toc.1-1.6.2.6.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.6.2.3">
                    <p id="section-toc.1-1.6.2.6.2.3.1"><a href="#section-6.6.3" class="xref">6.6.3</a>.  <a href="#name-policy-discovery" class="xref">Policy Discovery</a><a href="#section-toc.1-1.6.2.6.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.6.2.4">
                    <p id="section-toc.1-1.6.2.6.2.4.1"><a href="#section-6.6.4" class="xref">6.6.4</a>.  <a href="#name-message-sampling" class="xref">Message Sampling</a><a href="#section-toc.1-1.6.2.6.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.6.2.5">
                    <p id="section-toc.1-1.6.2.6.2.5.1"><a href="#section-6.6.5" class="xref">6.6.5</a>.  <a href="#name-store-results-of-dmarc-proc" class="xref">Store Results of DMARC Processing</a><a href="#section-toc.1-1.6.2.6.2.5.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="xref">6.7</a>.  <a href="#name-policy-enforcement-consider" class="xref">Policy Enforcement Considerations</a><a href="#section-toc.1-1.6.2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-dmarc-feedback" class="xref">DMARC Feedback</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-minimum-implementations" class="xref">Minimum Implementations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-other-topics" class="xref">Other Topics</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-issues-specific-to-spf" class="xref">Issues Specific to SPF</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-dns-load-and-caching" class="xref">DNS Load and Caching</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-rejecting-messages" class="xref">Rejecting Messages</a><a href="#section-toc.1-1.9.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-identifier-alignment-consid" class="xref">Identifier Alignment Considerations</a><a href="#section-toc.1-1.9.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="xref">9.5</a>.  <a href="#name-interoperability-issues" class="xref">Interoperability Issues</a><a href="#section-toc.1-1.9.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-authentication-results-meth" class="xref">Authentication-Results Method Registry Update</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-authentication-results-resu" class="xref">Authentication-Results Result Registry Update</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-feedback-report-header-fiel" class="xref">Feedback Report Header Fields Registry Update</a><a href="#section-toc.1-1.10.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="xref">10.4</a>.  <a href="#name-dmarc-tag-registry" class="xref">DMARC Tag Registry</a><a href="#section-toc.1-1.10.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="xref">10.5</a>.  <a href="#name-dmarc-report-format-registr" class="xref">DMARC Report Format Registry</a><a href="#section-toc.1-1.10.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="xref">10.6</a>.  <a href="#name-underscored-and-globally-sc" class="xref">Underscored and Globally Scoped DNS Node Names Registry</a><a href="#section-toc.1-1.10.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-authentication-methods" class="xref">Authentication Methods</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-attacks-on-reporting-uris" class="xref">Attacks on Reporting URIs</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-dns-security" class="xref">DNS Security</a><a href="#section-toc.1-1.11.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="xref">11.4</a>.  <a href="#name-display-name-attacks" class="xref">Display Name Attacks</a><a href="#section-toc.1-1.11.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="xref">11.5</a>.  <a href="#name-external-reporting-addresse" class="xref">External Reporting Addresses</a><a href="#section-toc.1-1.11.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#section-11.6" class="xref">11.6</a>.  <a href="#name-secure-protocols" class="xref">Secure Protocols</a><a href="#section-toc.1-1.11.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-technology-considerations" class="xref">Technology Considerations</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-s-mime" class="xref">S/MIME</a><a href="#section-toc.1-1.14.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-method-exclusion" class="xref">Method Exclusion</a><a href="#section-toc.1-1.14.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-sender-header-field" class="xref">Sender Header Field</a><a href="#section-toc.1-1.14.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-a.4" class="xref">A.4</a>.  <a href="#name-domain-existence-test" class="xref">Domain Existence Test</a><a href="#section-toc.1-1.14.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-a.5" class="xref">A.5</a>.  <a href="#name-issues-with-adsp-in-operati" class="xref">Issues with ADSP in Operation</a><a href="#section-toc.1-1.14.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#section-a.6" class="xref">A.6</a>.  <a href="#name-organizational-domain-disco" class="xref">Organizational Domain Discovery Issues</a><a href="#section-toc.1-1.14.2.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.14.2.6.2.1">
                    <p id="section-toc.1-1.14.2.6.2.1.1"><a href="#section-a.6.1" class="xref">A.6.1</a>.  <a href="#name-public-suffix-lists" class="xref">Public Suffix Lists</a><a href="#section-toc.1-1.14.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-examples" class="xref">Examples</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-identifier-alignment-exampl" class="xref">Identifier Alignment Examples</a><a href="#section-toc.1-1.15.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.15.2.1.2.1">
                    <p id="section-toc.1-1.15.2.1.2.1.1"><a href="#section-b.1.1" class="xref">B.1.1</a>.  <a href="#name-spf" class="xref">SPF</a><a href="#section-toc.1-1.15.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.15.2.1.2.2">
                    <p id="section-toc.1-1.15.2.1.2.2.1"><a href="#section-b.1.2" class="xref">B.1.2</a>.  <a href="#name-dkim" class="xref">DKIM</a><a href="#section-toc.1-1.15.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-domain-owner-example" class="xref">Domain Owner Example</a><a href="#section-toc.1-1.15.2.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.15.2.2.2.1">
                    <p id="section-toc.1-1.15.2.2.2.1.1"><a href="#section-b.2.1" class="xref">B.2.1</a>.  <a href="#name-entire-domain-monitoring-on" class="xref">Entire Domain, Monitoring Only</a><a href="#section-toc.1-1.15.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.15.2.2.2.2">
                    <p id="section-toc.1-1.15.2.2.2.2.1"><a href="#section-b.2.2" class="xref">B.2.2</a>.  <a href="#name-entire-domain-monitoring-onl" class="xref">Entire Domain, Monitoring Only, Per-Message Reports</a><a href="#section-toc.1-1.15.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.15.2.2.2.3">
                    <p id="section-toc.1-1.15.2.2.2.3.1"><a href="#section-b.2.3" class="xref">B.2.3</a>.  <a href="#name-per-message-failure-reports" class="xref">Per-Message Failure Reports Directed to Third Party</a><a href="#section-toc.1-1.15.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.15.2.2.2.4">
                    <p id="section-toc.1-1.15.2.2.2.4.1"><a href="#section-b.2.4" class="xref">B.2.4</a>.  <a href="#name-subdomain-sampling-and-mult" class="xref">Subdomain, Sampling, and Multiple Aggregate Report URIs</a><a href="#section-toc.1-1.15.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-mail-receiver-example" class="xref">Mail Receiver Example</a><a href="#section-toc.1-1.15.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#section-b.4" class="xref">B.4</a>.  <a href="#name-processing-of-smtp-time" class="xref">Processing of SMTP Time</a><a href="#section-toc.1-1.15.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#section-b.5" class="xref">B.5</a>.  <a href="#name-utilization-of-aggregate-fe" class="xref">Utilization of Aggregate Feedback: Example</a><a href="#section-toc.1-1.15.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a href="#section-b.6" class="xref">B.6</a>.  <a href="#name-mailto-transport-example" class="xref">mailto Transport Example</a><a href="#section-toc.1-1.15.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.d" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH BEFORE PUBLISHING:
The source for this draft is maintained in GitHub at:
<a href="https://github.com/ietf-wg-dmarc/draft-ietf-dmarc-dmarcbis">https://github.com/ietf-wg-dmarc/draft-ietf-dmarc-dmarcbis</a><a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The Sender Policy Framework (<span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span>) and DomainKeys Identified
Mail (<span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>) protocols provide domain-level authentication, and
DMARC builds on these protocols. DMARC is designed to give ADminstrative
Management Domains (ADMDs) that originate email the ability to publish
in a DNS TXT record their email authentication policies, specify preferred
handling for mail that fails authentication checks, and request reports
about mail purportedly originated by the ADMD, as determined by the
RFC5322.From header in the message.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">As with SPF and DKIM, DMARC authentication checks result in verdicts of
"pass" or "fail". A DMARC pass verdict requires not only that SPF or DKIM
pass for the message in question, but also that the domain validated by the
SPF or DKIM check is aligned with the domain in the RFC5322.From header. In
the DMARC protocol, two domains are said to be "in alignment" if they have
the same Organizational Domain (a.k.a., relaxed alignment) or they are
identical (a.k.a., strict alignment).<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">A DMARC pass verdict asserts only that the RFC5322.From domain has been
authenticated in that message; there is no explicit or implied value assertion
attributed to a message that receives such a verdict. A mail-receiving organization
that performs DMARC validation checks on inbound mail can choose to use the results
and the preferences expressed by the originating domain for message disposition
to inform its mail handling decision for that message. For messages that pass
DMARC validation checks, the mail-receiving organization can be confident in
applying handling based on its known history for similarly authenticated
messages, whereas messages that fail such checks cannot be reliably associated
with a domain with a history of sending DMARC-validated messages.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">DMARC also describes a reporting framework in which mail-receiving domains
can generate regular reports containing data about messages seen that claim
to be from domains that publish DMARC policies, and send those reports to the
ADMD as requested by its DMARC policy record.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Experience with DMARC has revealed some issues of interoperability
with email in general that require due consideration before
deployment, particularly with configurations that can cause mail to
be rejected.  These are discussed in <a href="#other-topics" class="xref">Section 9</a>.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requirements">
<section id="section-2">
      <h2 id="name-requirements">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-2-1">Specification of DMARC is guided by the following high-level goals,
security dependencies, detailed requirements, and items that are
documented as out of scope.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="high-level-goals">
<section id="section-2.1">
        <h3 id="name-high-level-goals">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-high-level-goals" class="section-name selfRef">High-Level Goals</a>
        </h3>
<p id="section-2.1-1">DMARC has the following high-level goals:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">Allow Domain Owners to assert the preferred handling of
authentication failures, for messages purporting to have
authorship within the domain.<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">Allow Domain Owners to verify their authentication deployment.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.3">
            <p id="section-2.1-2.3.1">Minimize implementation complexity for both senders and receivers,
as well as the impact on handling and delivery of legitimate
messages.<a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">Reduce the amount of successfully delivered spoofed email.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.5">
            <p id="section-2.1-2.5.1">Work at Internet scale.<a href="#section-2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="out-of-scope">
<section id="section-2.2">
        <h3 id="name-out-of-scope">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-out-of-scope" class="section-name selfRef">Out of Scope</a>
        </h3>
<p id="section-2.2-1">Several topics and issues are specifically out of scope for the
initial version of this work.  These include the following:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-2.1">
            <p id="section-2.2-2.1.1">different treatment of messages that are not authenticated versus
those that fail authentication;<a href="#section-2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.2">
            <p id="section-2.2-2.2.1">evaluation of anything other than RFC5322.From;<a href="#section-2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.3">
            <p id="section-2.2-2.3.1">multiple reporting formats;<a href="#section-2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.4">
            <p id="section-2.2-2.4.1">publishing policy other than via the DNS;<a href="#section-2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.5">
            <p id="section-2.2-2.5.1">reporting or otherwise evaluating other than the last-hop IP
address;<a href="#section-2.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.6">
            <p id="section-2.2-2.6.1">attacks in the RFC5322.From field, also known as "display name"
attacks;<a href="#section-2.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.7">
            <p id="section-2.2-2.7.1">authentication of entities other than domains, since DMARC is
built upon SPF and DKIM, which authenticate domains; and<a href="#section-2.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.8">
            <p id="section-2.2-2.8.1">content analysis.<a href="#section-2.2-2.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="scalability">
<section id="section-2.3">
        <h3 id="name-scalability">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-scalability" class="section-name selfRef">Scalability</a>
        </h3>
<p id="section-2.3-1">Scalability is a major issue for systems that need to operate in a
system as widely deployed as current SMTP email.  For this reason,
DMARC seeks to avoid the need for third parties or pre-sending
agreements between senders and receivers.  This preserves the
positive aspects of the current email infrastructure.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">Although DMARC does not introduce third-party senders (namely
external agents authorized to send on behalf of an operator) to the
email-handling flow, it also does not preclude them.  Such third
parties are free to provide services in conjunction with DMARC.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="anti-phishing">
<section id="section-2.4">
        <h3 id="name-anti-phishing">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-anti-phishing" class="section-name selfRef">Anti-Phishing</a>
        </h3>
<p id="section-2.4-1">DMARC is designed to prevent bad actors from sending mail that claims
to come from legitimate senders, particularly senders of
transactional email (official mail that is about business
transactions).  One of the primary uses of this kind of spoofed mail
is phishing (enticing users to provide information by pretending to
be the legitimate service requesting the information).  Thus, DMARC
is significantly informed by ongoing efforts to enact large-scale,
Internet-wide anti-phishing measures.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">Although DMARC can only be used to combat specific forms of exact-
domain spoofing directly, the DMARC mechanism has been found to be
useful in the creation of reliable and defensible message streams.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">DMARC does not attempt to solve all problems with spoofed or
otherwise fraudulent email.  In particular, it does not address the
use of visually similar domain names ("cousin domains") or abuse of
the RFC5322.From human-readable &lt;display-name&gt;.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology-and-definitions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology-and-definitions" class="section-name selfRef">Terminology and Definitions</a>
      </h2>
<p id="section-3-1">This section defines terms used in the rest of the document.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Readers are encouraged to be familiar with the contents of
<span>[<a href="#RFC5598" class="xref">RFC5598</a>]</span>.  In particular, that document defines various roles in
the messaging infrastructure that can appear the same or separate in
various contexts.  For example, a Domain Owner could, via the
messaging security mechanisms on which DMARC is based, delegate the
ability to send mail as the Domain Owner to a third party with
another role.  This document does not address the distinctions among
such roles; the reader is encouraged to become familiar with that
material before continuing.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The following terms are also used:<a href="#section-3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-5">
        <dt id="section-3-5.1">Authenticated Identifiers:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.2">Domain-level identifiers that are
validated using authentication technologies are referred to as
"Authenticated Identifiers".  See <a href="#authenicated-mechanisms" class="xref">Section 4.1</a> for details about
the supported mechanisms.<a href="#section-3-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.3">Author Domain:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.4">The domain name of the apparent author, as extracted
from the RFC5322.From field.<a href="#section-3-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.5">Domain Owner:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.6">An entity or organization that owns a DNS domain.  The
term "owns" here indicates that the entity or organization being
referenced holds the registration of that DNS domain.  Domain
Owners range from complex, globally distributed organizations, to
service providers working on behalf of non-technical clients, to
individuals responsible for maintaining personal domains.  This
specification uses this term as analogous to an Administrative
Management Domain as defined in <span>[<a href="#RFC5598" class="xref">RFC5598</a>]</span>.  It can also refer
to delegates, such as Report Receivers, when those are outside of
their immediate management domain.<a href="#section-3-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.7">Identifier Alignment:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.8">When the domain in the RFC5322.From address
matches a domain validated by SPF or DKIM (or both), it has
Identifier Alignment.<a href="#section-3-5.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.9">Mail Receiver:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.10">The entity or organization that receives and
processes email.  Mail Receivers operate one or more Internet-
facing Mail Transport Agents (MTAs).<a href="#section-3-5.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.11">Organizational Domain:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.12">The domain that was registered with a domain
name registrar.  In the absence of more accurate methods,
heuristics are used to determine this, since it is not always the
case that the registered domain name is simply a top-level DNS
domain plus one component (e.g., "example.com", where "com" is a
top-level domain).  The Organizational Domain is determined by
applying the algorithm found in <a href="#organizational-domain" class="xref">Section 3.2</a>.<a href="#section-3-5.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.13">Report Receiver:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.14">An operator that receives reports from another
operator implementing the reporting mechanism described in this
document.  Such an operator might be receiving reports about its
own messages, or reports about messages related to another
operator.  This term applies collectively to the system components
that receive and process these reports and the organizations that
operate them.<a href="#section-3-5.14" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<div id="identifier-alignment">
<section id="section-3.1">
        <h3 id="name-identifier-alignment">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-identifier-alignment" class="section-name selfRef">Identifier Alignment</a>
        </h3>
<p id="section-3.1-1">Email authentication technologies authenticate various (and
disparate) aspects of an individual message.  For example, <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>
authenticates the domain that affixed a signature to the message,
while <span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span> can authenticate either the domain that appears in the
RFC5321.MailFrom (MAIL FROM) portion of <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span> or the RFC5321.EHLO/
HELO domain, or both.  These may be different domains, and they are
typically not visible to the end user.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">DMARC authenticates use of the RFC5322.From domain by requiring that
it match (be aligned with) an Authenticated Identifier.  The
RFC5322.From domain was selected as the central identity of the DMARC
mechanism because it is a required message header field and therefore
guaranteed to be present in compliant messages, and most Mail User
Agents (MUAs) represent the RFC5322.From field as the originator of
the message and render some or all of this header field's content to
end users.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Thus, this field is the one used by end users to identify the source
of the message and therefore is a prime target for abuse.  Many
high-profile email sources, such as email service providers, require
that the sending agent have authenticated before email can be
generated.  Thus, for these mailboxes, the mechanism described in
this document provides recipient end users with strong evidence that
the message was indeed originated by the agent they associate with
that mailbox, if the end user knows that these various protections
have been provided.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">Domain names in this context are to be compared in a case-insensitive
manner, per <span>[<a href="#RFC4343" class="xref">RFC4343</a>]</span>.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">It is important to note that Identifier Alignment cannot occur with a
message that is not valid per <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span>, particularly one with a
malformed, absent, or repeated RFC5322.From field, since in that case
there is no reliable way to determine a DMARC policy that applies to
the message.  Accordingly, DMARC operation is predicated on the input
being a valid RFC5322 message object, and handling of such
non-compliant cases is outside of the scope of this specification.
Further discussion of this can be found in <a href="#extract-author-domain" class="xref">Section 6.6.1</a>.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">Each of the underlying authentication technologies that DMARC takes
as input yields authenticated domains as their outputs when they
succeed.  From the perspective of DMARC, each can be operated in a
"strict" mode or a "relaxed" mode.  A Domain Owner would normally
select strict mode if it wanted Mail Receivers to apply DMARC
processing only to messages bearing an RFC5322.From domain exactly
matching the domains those mechanisms will verify.  Relaxed mode can
be used when the operator also wishes to affect message flows bearing
subdomains of the verified domains.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<div id="dkim-identifiers">
<section id="section-3.1.1">
          <h4 id="name-dkim-authenticated-identifi">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-dkim-authenticated-identifi" class="section-name selfRef">DKIM-Authenticated Identifiers</a>
          </h4>
<p id="section-3.1.1-1">DMARC permits Identifier Alignment, based on the result of a DKIM
authentication, to be strict or relaxed.  (Note that these are not
related to DKIM's "simple" and "relaxed" canonicalization modes.)<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">In relaxed mode, the Organizational Domains of both the <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>-
authenticated signing domain (taken from the value of the "d=" tag in
the signature) and that of the RFC5322.From domain must be equal if
the identifiers are to be considered aligned.  In strict mode, only
an exact match between both of the Fully Qualified Domain Names
(FQDNs) is considered to produce Identifier Alignment.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-3">To illustrate, in relaxed mode, if a validated DKIM signature
successfully verifies with a "d=" domain of "example.com", and the
RFC5322.From address is "alerts@news.example.com", the DKIM "d="
domain and the RFC5322.From domain are considered to be "in
alignment".  In strict mode, this test would fail, since the "d="
domain does not exactly match the FQDN of the address.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1.1-4">However, a DKIM signature bearing a value of "d=com" would never
allow an "in alignment" result, as "com" should appear on all public
suffix lists (see <a href="#public-suffix-lists" class="xref">Appendix A.6.1</a>) and therefore cannot be an
Organizational Domain.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1-5">Identifier Alignment is required because a message can bear a valid
signature from any domain, including domains used by a mailing list
or even a bad actor.  Therefore, merely bearing a valid signature is
not enough to infer authenticity of the Author Domain.<a href="#section-3.1.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1.1-6">Note that a single email can contain multiple DKIM signatures, and it
is considered to be a DMARC "pass" if any DKIM signature is aligned
and verifies.<a href="#section-3.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spf-identifiers">
<section id="section-3.1.2">
          <h4 id="name-spf-authenticated-identifie">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-spf-authenticated-identifie" class="section-name selfRef">SPF-Authenticated Identifiers</a>
          </h4>
<p id="section-3.1.2-1">DMARC permits Identifier Alignment, based on the result of an SPF
authentication, to be strict or relaxed.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">In relaxed mode, the <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>-authenticated domain and RFC5322.From
domain must have the same Organizational Domain.  In strict mode,
only an exact DNS domain match is considered to produce Identifier
Alignment.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2-3">Note that the RFC5321.HELO identity is not typically used in the
context of DMARC (except when required to "fake" an otherwise null
reverse-path), even though a "pure SPF" implementation according to
<span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span> would check that identifier.<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
<p id="section-3.1.2-4">For example, if a message passes an SPF check with an
RFC5321.MailFrom domain of "cbg.bounces.example.com", and the address
portion of the RFC5322.From field contains "payments@example.com",
the Authenticated RFC5321.MailFrom domain identifier and the
RFC5322.From domain are considered to be "in alignment" in relaxed
mode, but not in strict mode.<a href="#section-3.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alignment-and-extension-technologies">
<section id="section-3.1.3">
          <h4 id="name-alignment-and-extension-tec">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-alignment-and-extension-tec" class="section-name selfRef">Alignment and Extension Technologies</a>
          </h4>
<p id="section-3.1.3-1">If in the future DMARC is extended to include the use of other
authentication mechanisms, the extensions will need to allow for
domain identifier extraction so that alignment with the RFC5322.From
domain can be verified.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="organizational-domain">
<section id="section-3.2">
        <h3 id="name-organizational-domain">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-organizational-domain" class="section-name selfRef">Organizational Domain</a>
        </h3>
<p id="section-3.2-1">The Organizational Domain is determined using the following
algorithm:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-2">
<li id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">Acquire a "public suffix" list, i.e., a list of DNS domain names
reserved for registrations.  Some country Top-Level Domains
(TLDs) make specific registration requirements, e.g., the United
Kingdom places company registrations under ".co.uk"; other TLDs
such as ".com" appear in the IANA registry of top-level DNS
domains.  A public suffix list is the union of all of these.
<a href="#public-suffix-lists" class="xref">Appendix A.6.1</a> contains some discussion about obtaining a public
suffix list.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">Break the subject DNS domain name into a set of "n" ordered
labels.  Number these labels from right to left; e.g., for
"example.com", "com" would be label 1 and "example" would be
label 2.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">Search the public suffix list for the name that matches the
largest number of labels found in the subject DNS domain.  Let
that number be "x".<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">Construct a new DNS domain name using the name that matched from
the public suffix list and prefixing to it the "x+1"th label from
the subject domain.  This new name is the Organizational Domain.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-3">Thus, since "com" is an IANA-registered TLD, a subject domain of
"a.b.c.d.example.com" would have an Organizational Domain of
"example.com".<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">The process of determining a suffix is currently a heuristic one.  No
list is guaranteed to be accurate or current.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">In addition to Mediators, mail that is sent by authorized,
independent third parties might not be sent with Identifier
Alignment, also preventing a "pass" result.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">Issues specific to the use of policy mechanisms alongside DKIM are
further discussed in <span>[<a href="#RFC6377" class="xref">RFC6377</a>]</span>, particularly Section 5.2.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-4-1">This section provides a general overview of the design and operation
of the DMARC environment.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="authenicated-mechanisms">
<section id="section-4.1">
        <h3 id="name-authentication-mechanisms">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-authentication-mechanisms" class="section-name selfRef">Authentication Mechanisms</a>
        </h3>
<p id="section-4.1-1">The following mechanisms for determining Authenticated Identifiers
are supported in this version of DMARC:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1"><span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>, which provides a domain-level identifier in the content of
the "d=" tag of a validated DKIM-Signature header field.<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1"><span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>, which can authenticate both the domain found in an <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span>
HELO/EHLO command (the HELO identity) and the domain found in an
SMTP MAIL command (the MAIL FROM identity).  DMARC uses the result
of SPF authentication of the MAIL FROM identity.  Section 2.4 of
<span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span> describes MAIL FROM processing for cases in which the MAIL
command has a null path.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="key-concepts">
<section id="section-4.2">
        <h3 id="name-key-concepts">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-key-concepts" class="section-name selfRef">Key Concepts</a>
        </h3>
<p id="section-4.2-1">DMARC policies are published by the Domain Owner, and retrieved by
the Mail Receiver during the SMTP session, via the DNS.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">DMARC's filtering function is based on whether the RFC5322.From field
domain is aligned with (matches) an authenticated domain name from
SPF or DKIM.  When a DMARC policy is published for the domain name
found in the RFC5322.From field, and that domain name is not
validated through SPF or DKIM, the disposition of that message can be
affected by that DMARC policy when delivered to a participating
receiver.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">It is important to note that the authentication mechanisms employed
by DMARC authenticate only a DNS domain and do not authenticate the
local-part of any email address identifier found in a message, nor do
they validate the legitimacy of message content.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">DMARC's feedback component involves the collection of information
about received messages claiming to be from the Organizational Domain
for periodic aggregate reports to the Domain Owner.  The parameters
and format for such reports are discussed in later sections of this
document.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">A DMARC-enabled Mail Receiver might also generate per-message reports
that contain information related to individual messages that fail SPF
and/or DKIM.  Per-message failure reports are a useful source of
information when debugging deployments (if messages can be determined
to be legitimate even though failing authentication) or in analyzing
attacks.  The capability for such services is enabled by DMARC but
defined in other referenced material such as <span>[<a href="#RFC6591" class="xref">RFC6591</a>]</span>.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">A message satisfies the DMARC checks if at least one of the supported
authentication mechanisms:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-7">
<li id="section-4.2-7.1">
            <p id="section-4.2-7.1.1">produces a "pass" result, and<a href="#section-4.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-7.2">
            <p id="section-4.2-7.2.1">produces that result based on an identifier that is in alignment,
as defined in <a href="#terminology" class="xref">Section 3</a>.<a href="#section-4.2-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="flow-diagram">
<section id="section-4.3">
        <h3 id="name-flow-diagram">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-flow-diagram" class="section-name selfRef">Flow Diagram</a>
        </h3>
<div id="section-4.3-1">
<pre class="sourcecode lang-ascii-art"> +---------------+
 | Author Domain |&lt; . . . . . . . . . . . . . . . . . . . . . . .
 +---------------+                        .           .         .
     |                                    .           .         .
     V                                    V           V         .
 +-----------+     +--------+       +----------+ +----------+   .
 |   MSA     |&lt;***&gt;|  DKIM  |       |   DKIM   | |    SPF   |   .
 |  Service  |     | Signer |       | Verifier | | Verifier |   .
 +-----------+     +--------+       +----------+ +----------+   .
     |                                    ^            ^        .
     |                                    **************        .
     V                                                 *        .
  +------+        (~~~~~~~~~~~~)      +------+         *        .
  | sMTA |-------&gt;( other MTAs )-----&gt;| rMTA |         *        .
  +------+        (~~~~~~~~~~~~)      +------+         *        .
                                         |             * ........
                                         |             * .
                                         V             * .
                                  +-----------+        V V
                    +---------+   |    MDA    |     +----------+
                    |  User   |&lt;--| Filtering |&lt;***&gt;|  DMARC   |
                    | Mailbox |   |  Engine   |     | Verifier |
                    +---------+   +-----------+     +----------+


  MSA = Mail Submission Agent
  MDA = Mail Delivery Agent
</pre><a href="#section-4.3-1" class="pilcrow">¶</a>
</div>
<p id="section-4.3-2">The above diagram shows a simple flow of messages through a DMARC-
aware system.  Solid lines denote the actual message flow, dotted
lines involve DNS queries used to retrieve message policy related to
the supported message authentication schemes, and asterisk lines
indicate data exchange between message-handling modules and message
authentication modules.  "sMTA" is the sending MTA, and "rMTA" is the
receiving MTA.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">In essence, the steps are as follows:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-4">
<li id="section-4.3-4.1">
            <p id="section-4.3-4.1.1">Domain Owner constructs an SPF policy and publishes it in its
 DNS database as per <span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span>.  Domain Owner also configures its
 system for DKIM signing as described in <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>.  Finally, Domain
 Owner publishes via the DNS a DMARC message-handling policy.<a href="#section-4.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-4.2">
            <p id="section-4.3-4.2.1">Author generates a message and hands the message to Domain
 Owner's designated mail submission service.<a href="#section-4.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-4.3">
            <p id="section-4.3-4.3.1">Submission service passes relevant details to the DKIM signing
 module in order to generate a DKIM signature to be applied to
 the message.<a href="#section-4.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-4.4">
            <p id="section-4.3-4.4.1">Submission service relays the now-signed message to its
 designated transport service for routing to its intended
 recipient(s).<a href="#section-4.3-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-4.5">
            <p id="section-4.3-4.5.1">Message may pass through other relays but eventually arrives at
 a recipient's transport service.<a href="#section-4.3-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-4.6">
            <p id="section-4.3-4.6.1">Recipient delivery service conducts SPF and DKIM authentication
 checks by passing the necessary data to their respective
 modules, each of which requires queries to the Author Domain's
 DNS data (when identifiers are aligned; see below).<a href="#section-4.3-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-4.7">
            <p id="section-4.3-4.7.1">The results of these are passed to the DMARC module along with
 the Author's domain.  The DMARC module attempts to retrieve a
 policy from the DNS for that domain.  If none is found, the
 DMARC module determines the Organizational Domain and repeats
 the attempt to retrieve a policy from the DNS.  (This is
 described in further detail in <a href="#policy-discovery" class="xref">Section 6.6.3</a>.)<a href="#section-4.3-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-4.8">
            <p id="section-4.3-4.8.1">If a policy is found, it is combined with the Author's domain
 and the SPF and DKIM results to produce a DMARC policy result (a
 "pass" or "fail") and can optionally cause one of two kinds of
 reports to be generated (not shown).<a href="#section-4.3-4.8.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-4.9">
            <p id="section-4.3-4.9.1">Recipient transport service either delivers the message to the
 recipient inbox or takes other local policy action based on the
 DMARC result (not shown).<a href="#section-4.3-4.9.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-4.10">
            <p id="section-4.3-4.10.1">When requested, Recipient transport service collects data from
 the message delivery session to be used in providing feedback
 (see <a href="#dmarc-feedback" class="xref">Section 7</a>).<a href="#section-4.3-4.10.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="use-of-rfc5322-from">
<section id="section-5">
      <h2 id="name-use-of-rfc5322from">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-use-of-rfc5322from" class="section-name selfRef">Use of RFC5322.From</a>
      </h2>
<p id="section-5-1">One of the most obvious points of security scrutiny for DMARC is the
choice to focus on an identifier, namely the RFC5322.From address,
which is part of a body of data that has been trivially forged
throughout the history of email.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Several points suggest that it is the most correct and safest thing
to do in this context:<a href="#section-5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1">
          <p id="section-5-3.1.1">Of all the identifiers that are part of the message itself, this
is the only one guaranteed to be present.<a href="#section-5-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-3.2">
          <p id="section-5-3.2.1">It seems the best choice of an identifier on which to focus, as
most MUAs display some or all of the contents of that field in a
manner strongly suggesting those data as reflective of the true
originator of the message.<a href="#section-5-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-4">The absence of a single, properly formed RFC5322.From field renders
the message invalid.  Handling of such a message is outside of the
scope of this specification.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Since the sorts of mail typically protected by DMARC participants
tend to only have single Authors, DMARC participants generally
operate under a slightly restricted profile of RFC5322 with respect
to the expected syntax of this field.  See <a href="#mail-receiver-actions" class="xref">Section 6.6</a> for details.<a href="#section-5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="policy">
<section id="section-6">
      <h2 id="name-policy">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-policy" class="section-name selfRef">Policy</a>
      </h2>
<p id="section-6-1">DMARC policies are published by Domain Owners and applied by Mail
Receivers.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">A Domain Owner advertises DMARC participation of one or more of its
domains by adding a DNS TXT record (described in <a href="#dmarc-policy-record" class="xref">Section 6.1</a>) to
those domains.  In doing so, Domain Owners make specific requests of
Mail Receivers regarding the disposition of messages purporting to be
from one of the Domain Owner's domains and the provision of feedback
about those messages.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">A Domain Owner may choose not to participate in DMARC evaluation by
Mail Receivers.  In this case, the Domain Owner simply declines to
advertise participation in those schemes.  For example, if the
results of path authorization checks ought not be considered as part
of the overall DMARC result for a given Author Domain, then the
Domain Owner does not publish an SPF policy record that can produce
an SPF pass result.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">A Mail Receiver implementing the DMARC mechanism SHOULD make a
best-effort attempt to adhere to the Domain Owner's published DMARC
policy when a message fails the DMARC test.  Since email streams can
be complicated (due to forwarding, existing RFC5322.From
domain-spoofing services, etc.), Mail Receivers MAY deviate from a
Domain Owner's published policy during message processing and SHOULD
make available the fact of and reason for the deviation to the Domain
Owner via feedback reporting, specifically using the "PolicyOverride"
feature of the aggregate report (see the DMARC reporting documents).<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="dmarc-policy-record">
<section id="section-6.1">
        <h3 id="name-dmarc-policy-record">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-dmarc-policy-record" class="section-name selfRef">DMARC Policy Record</a>
        </h3>
<p id="section-6.1-1">Domain Owner DMARC preferences are stored as DNS TXT records in
subdomains named "_dmarc".  For example, the Domain Owner of
"example.com" would post DMARC preferences in a TXT record at
"_dmarc.example.com".  Similarly, a Mail Receiver wishing to query
for DMARC preferences regarding mail with an RFC5322.From domain of
"example.com" would issue a TXT query to the DNS for the subdomain of
"_dmarc.example.com".  The DNS-located DMARC preference data will
hereafter be called the "DMARC record".<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">DMARC's use of the Domain Name Service is driven by DMARC's use of
domain names and the nature of the query it performs.  The query
requirement matches with the DNS, for obtaining simple parametric
information.  It uses an established method of storing the
information, associated with the target domain name, namely an
isolated TXT record that is restricted to the DMARC context.  Use of
the DNS as the query service has the benefit of reusing an extremely
well-established operations, administration, and management
infrastructure, rather than creating a new one.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Per <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span>, a TXT record can comprise several "character-string"
objects.  Where this is the case, the module performing DMARC
evaluation MUST concatenate these strings by joining together the
objects in order and parsing the result as a single string.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dmarc-uris">
<section id="section-6.2">
        <h3 id="name-dmarc-uris">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-dmarc-uris" class="section-name selfRef">DMARC URIs</a>
        </h3>
<p id="section-6.2-1"><span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span> defines a generic syntax for identifying a resource.  The DMARC
mechanism uses this as the format by which a Domain Owner specifies
the destination for the two report types that are supported.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The place such URIs are specified (see <a href="#general-record-format" class="xref">Section 6.3</a>) allows a list of
these to be provided.  A report is normally sent to each listed URI
in the order provided by the Domain Owner.  Receivers MAY impose a
limit on the number of URIs to which they will send reports but MUST
support the ability to send to at least two.  The list of URIs is
separated by commas (ASCII 0x2C).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">Each URI can have associated with it a maximum report size that may
be sent to it.  This is accomplished by appending an exclamation
point (ASCII 0x21), followed by a maximum-size indication, before a
separating comma or terminating semicolon.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Thus, a DMARC URI is a URI within which any commas or exclamation
points are percent-encoded per <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>, followed by an OPTIONAL
exclamation point and a maximum-size specification, and, if there are
additional reporting URIs in the list, a comma and the next URI.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">For example, the URI "mailto:reports@example.com!50m" would request
that a report be sent via email to "reports@example.com" so long as
the report payload does not exceed 50 megabytes.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">A formal definition is provided in <a href="#formal-definition" class="xref">Section 6.4</a>.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="general-record-format">
<section id="section-6.3">
        <h3 id="name-general-record-format">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-general-record-format" class="section-name selfRef">General Record Format</a>
        </h3>
<p id="section-6.3-1">DMARC records follow the extensible "tag-value" syntax for DNS-based
key records defined in DKIM <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2"><a href="#iana-considerations" class="xref">Section 10</a> creates a registry for known DMARC tags and registers the
initial set defined in this document.  Only tags defined in this
document or in later extensions, and thus added to that registry, are
to be processed; unknown tags MUST be ignored.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">The following tags are introduced as the initial valid DMARC tags:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-4">
          <dt id="section-6.3-4.1">adkim:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.2">
            <p id="section-6.3-4.2.1">(plain-text; OPTIONAL; default is "r".)  Indicates whether
strict or relaxed DKIM Identifier Alignment mode is required by
the Domain Owner.  See <a href="#dkim-identifiers" class="xref">Section 3.1.1</a> for details.  Valid values
are as follows:<a href="#section-6.3-4.2.1" class="pilcrow">¶</a></p>
<p id="section-6.3-4.2.2">r: relaxed mode<a href="#section-6.3-4.2.2" class="pilcrow">¶</a></p>
<p id="section-6.3-4.2.3">s: strict mode<a href="#section-6.3-4.2.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.3">aspf:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.4">
            <p id="section-6.3-4.4.1">(plain-text; OPTIONAL; default is "r".)  Indicates whether
strict or relaxed SPF Identifier Alignment mode is required by the
Domain Owner.  See <a href="#spf-identifiers" class="xref">Section 3.1.2</a> for details.  Valid values are as
follows:<a href="#section-6.3-4.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-4.4.2">
              <dt id="section-6.3-4.4.2.1">r:</dt>
              <dd style="margin-left: 1.5em" id="section-6.3-4.4.2.2">relaxed mode<a href="#section-6.3-4.4.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.3-4.4.2.3">s:</dt>
              <dd style="margin-left: 1.5em" id="section-6.3-4.4.2.4">strict mode<a href="#section-6.3-4.4.2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.5">fo:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.6">
            <p id="section-6.3-4.6.1">Failure reporting options (plain-text; OPTIONAL; default is "0")
Provides requested options for generation of failure reports.
Report generators MAY choose to adhere to the requested options.
This tag's content MUST be ignored if a "ruf" tag (below) is not
also specified.  The value of this tag is a colon-separated list
of characters that indicate failure reporting options as follows:<a href="#section-6.3-4.6.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-4.6.2">
              <dt id="section-6.3-4.6.2.1">0:</dt>
              <dd style="margin-left: 1.5em" id="section-6.3-4.6.2.2">Generate a DMARC failure report if all underlying
authentication mechanisms fail to produce an aligned "pass"
result.<a href="#section-6.3-4.6.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.3-4.6.2.3">1:</dt>
              <dd style="margin-left: 1.5em" id="section-6.3-4.6.2.4">Generate a DMARC failure report if any underlying
authentication mechanism produced something other than an
aligned "pass" result.<a href="#section-6.3-4.6.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.3-4.6.2.5">d:</dt>
              <dd style="margin-left: 1.5em" id="section-6.3-4.6.2.6">Generate a DKIM failure report if the message had a signature
that failed evaluation, regardless of its alignment.  DKIM-
specific reporting is described in <span>[<a href="#RFC6651" class="xref">RFC6651</a>]</span>.<a href="#section-6.3-4.6.2.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.3-4.6.2.7">s:</dt>
              <dd style="margin-left: 1.5em" id="section-6.3-4.6.2.8">Generate an SPF failure report if the message failed SPF
evaluation, regardless of its alignment.  SPF-specific
reporting is described in <span>[<a href="#RFC6652" class="xref">RFC6652</a>]</span>.<a href="#section-6.3-4.6.2.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.7">p:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.8">
            <p id="section-6.3-4.8.1">Requested Mail Receiver policy (plain-text; REQUIRED for policy
records).  Indicates the policy to be enacted by the Receiver at
the request of the Domain Owner.  Policy applies to the domain
queried and to subdomains, unless subdomain policy is explicitly
described using the "sp" tag.  This tag is mandatory for policy
records only, but not for third-party reporting records (as discussed
in the document(s) that discuss DMARC reporting in more detail). Possible
values are as follows:<a href="#section-6.3-4.8.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-4.8.2">
              <dt id="section-6.3-4.8.2.1">none:</dt>
              <dd style="margin-left: 1.5em" id="section-6.3-4.8.2.2">The Domain Owner requests no specific action be taken
regarding delivery of messages.<a href="#section-6.3-4.8.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.3-4.8.2.3">quarantine:</dt>
              <dd style="margin-left: 1.5em" id="section-6.3-4.8.2.4">The Domain Owner wishes to have email that fails the
DMARC mechanism check be treated by Mail Receivers as
suspicious.  Depending on the capabilities of the Mail
Receiver, this can mean "place into spam folder", "scrutinize
with additional intensity", and/or "flag as suspicious".<a href="#section-6.3-4.8.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.3-4.8.2.5">reject:</dt>
              <dd style="margin-left: 1.5em" id="section-6.3-4.8.2.6">The Domain Owner wishes for Mail Receivers to reject
email that fails the DMARC mechanism check.  Rejection SHOULD
occur during the SMTP transaction.  See <a href="#rejecting-messages" class="xref">Section 9.3</a> for some
discussion of SMTP rejection methods and their implications.<a href="#section-6.3-4.8.2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.9">pct:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.10">
            <p id="section-6.3-4.10.1">(plain-text integer between 0 and 100, inclusive; OPTIONAL;
default is 100).  Percentage of messages from the Domain Owner's
mail stream to which the DMARC policy is to be applied.  However,
this MUST NOT be applied to the DMARC-generated reports, all of
which must be sent and received unhindered.  The purpose of the
"pct" tag is to allow Domain Owners to enact a slow rollout
enforcement of the DMARC mechanism.  The prospect of "all or
nothing" is recognized as preventing many organizations from
experimenting with strong authentication-based mechanisms.  See
<a href="#message-sampling" class="xref">Section 6.6.4</a> for details.  Note that random selection based on
this percentage, such as the following pseudocode, is adequate:<a href="#section-6.3-4.10.1" class="pilcrow">¶</a></p>
<p id="section-6.3-4.10.2">if (random mod 100) &lt; pct then
  selected = true
else
  selected = false<a href="#section-6.3-4.10.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.11">rf:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.12">
            <p id="section-6.3-4.12.1">Format to be used for message-specific failure reports (colon-
separated plain-text list of values; OPTIONAL; default is "afrf").
The value of this tag is a list of one or more report formats as
requested by the Domain Owner to be used when a message fails both
<span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span> and <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span> tests to report details of the individual
failure.  The values MUST be present in the registry of reporting
formats defined in <a href="#iana-considerations" class="xref">Section 10</a>; a Mail Receiver observing a
different value SHOULD ignore it or MAY ignore the entire DMARC
record.  For this version, only "afrf" (the auth-failure report
type defined in <span>[<a href="#RFC6591" class="xref">RFC6591</a>]</span>) is presently supported.  See the DMARC reporting documents
for details.  For interoperability, the Authentication Failure
Reporting Format (AFRF) MUST be supported.<a href="#section-6.3-4.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.13">ri:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.14">
            <p id="section-6.3-4.14.1">Interval requested between aggregate reports (plain-text 32-bit
unsigned integer; OPTIONAL; default is 86400).  Indicates a
request to Receivers to generate aggregate reports separated by no
more than the requested number of seconds.  DMARC implementations
MUST be able to provide daily reports and SHOULD be able to
provide hourly reports when requested.  However, anything other
than a daily report is understood to be accommodated on a best-
effort basis.<a href="#section-6.3-4.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.15">rua:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.16">
            <p id="section-6.3-4.16.1">Addresses to which aggregate feedback is to be sent (comma-
separated plain-text list of DMARC URIs; OPTIONAL).  A comma or
exclamation point that is part of such a DMARC URI MUST be encoded
per Section 2.1 of <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span> so as to distinguish it from the list
delimiter or an OPTIONAL size limit.  The DMARC reporting documents discuss
considerations that apply when the domain name of a URI differs
from that of the domain advertising the policy.  See <a href="#external-report-addresses" class="xref">Section 11.5</a>
for additional considerations.  Any valid URI can be specified.  A
Mail Receiver MUST implement support for a "mailto:" URI, i.e.,
the ability to send a DMARC report via electronic mail.  If not
provided, Mail Receivers MUST NOT generate aggregate feedback
reports.  URIs not supported by Mail Receivers MUST be ignored.
The aggregate feedback report format is described in the DMARC reporting documents.<a href="#section-6.3-4.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.17">ruf:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.18">
            <p id="section-6.3-4.18.1">Addresses to which message-specific failure information is to
be reported (comma-separated plain-text list of DMARC URIs;
OPTIONAL).  If present, the Domain Owner is requesting Mail
Receivers to send detailed failure reports about messages that
fail the DMARC evaluation in specific ways (see the "fo" tag
above).  The format of the message to be generated MUST follow the
format specified for the "rf" tag.  The DMARC reporting documents discuss
considerations that apply when the domain name of a URI differs
from that of the domain advertising the policy.  A Mail Receiver
MUST implement support for a "mailto:" URI, i.e., the ability to
send a DMARC report via electronic mail.  If not provided, Mail
Receivers MUST NOT generate failure reports.  See <a href="#external-report-addresses" class="xref">Section 11.5</a> for
additional considerations.<a href="#section-6.3-4.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.19">sp:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.20">
            <p id="section-6.3-4.20.1">Requested Mail Receiver policy for all subdomains (plain-text;
OPTIONAL).  Indicates the policy to be enacted by the Receiver at
the request of the Domain Owner.  It applies only to subdomains of
the domain queried and not to the domain itself.  Its syntax is
identical to that of the "p" tag defined above.  If absent, the
policy specified by the "p" tag MUST be applied for subdomains.
Note that "sp" will be ignored for DMARC records published on
subdomains of Organizational Domains due to the effect of the
DMARC policy discovery mechanism described in <a href="#policy-discovery" class="xref">Section 6.6.3</a>.<a href="#section-6.3-4.20.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.21">v:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.22">
            <p id="section-6.3-4.22.1">Version (plain-text; REQUIRED).  Identifies the record retrieved
as a DMARC record.  It MUST have the value of "DMARC1".  The value
of this tag MUST match precisely; if it does not or it is absent,
the entire retrieved record MUST be ignored.  It MUST be the first
tag in the list.<a href="#section-6.3-4.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.3-5">A DMARC policy record MUST comply with the formal specification found
in <a href="#formal-definition" class="xref">Section 6.4</a> in that the "v" tag MUST be present and MUST
appear first.  Unknown tags MUST be ignored.  Syntax errors
in the remainder of the record SHOULD be discarded in favor of
default values (if any) or ignored outright.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">Note that given the rules of the previous paragraph, addition of a
new tag into the registered list of tags does not itself require a
new version of DMARC to be generated (with a corresponding change to
the "v" tag's value), but a change to any existing tags does require
a new version of DMARC.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="formal-definition">
<section id="section-6.4">
        <h3 id="name-formal-definition">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-formal-definition" class="section-name selfRef">Formal Definition</a>
        </h3>
<p id="section-6.4-1">The formal definition of the DMARC format, using <span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>, is as
follows:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">[FIXTHIS: Reference to [RFC3986] in code block]<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.4-3">
<pre>  dmarc-uri       = URI [ "!" 1*DIGIT [ "k" / "m" / "g" / "t" ] ]
                    ; "URI" is imported from [RFC3986]; commas (ASCII
                    ; 0x2C) and exclamation points (ASCII 0x21)
                    ; MUST be encoded; the numeric portion MUST fit
                    ; within an unsigned 64-bit integer

  dmarc-record    = dmarc-version dmarc-sep
                    [dmarc-request]
                    [dmarc-sep dmarc-srequest]
                    [dmarc-sep dmarc-auri]
                    [dmarc-sep dmarc-furi]
                    [dmarc-sep dmarc-adkim]
                    [dmarc-sep dmarc-aspf]
                    [dmarc-sep dmarc-ainterval]
                    [dmarc-sep dmarc-fo]
                    [dmarc-sep dmarc-rfmt]
                    [dmarc-sep dmarc-percent]
                    [dmarc-sep]
                    ; components other than dmarc-version and
                    ; dmarc-request may appear in any order

  dmarc-version   = "v" *WSP "=" *WSP %x44 %x4d %x41 %x52 %x43 %x31

  dmarc-sep       = *WSP %x3b *WSP

  dmarc-request   = "p" *WSP "=" *WSP
                    ( "none" / "quarantine" / "reject" )

  dmarc-srequest  = "sp" *WSP "=" *WSP
                    ( "none" / "quarantine" / "reject" )

  dmarc-auri      = "rua" *WSP "=" *WSP
                    dmarc-uri *(*WSP "," *WSP dmarc-uri)

  dmarc-furi      = "ruf" *WSP "=" *WSP
                    dmarc-uri *(*WSP "," *WSP dmarc-uri)

  dmarc-adkim     = "adkim" *WSP "=" *WSP
                    ( "r" / "s" )

  dmarc-aspf      = "aspf" *WSP "=" *WSP
                    ( "r" / "s" )

  dmarc-ainterval = "ri" *WSP "=" *WSP 1*DIGIT

  dmarc-fo        = "fo" *WSP "=" *WSP
                    ( "0" / "1" / "d" / "s" )
                    *(*WSP ":" *WSP ( "0" / "1" / "d" / "s" ))

  dmarc-rfmt      = "rf"  *WSP "=" *WSP Keyword *(*WSP ":" Keyword)
                    ; registered reporting formats only

  dmarc-percent   = "pct" *WSP "=" *WSP
                    1*3DIGIT
</pre><a href="#section-6.4-3" class="pilcrow">¶</a>
</div>
<p id="section-6.4-4">"Keyword" is imported from Section 4.1.2 of <span>[<a href="#RFC5321" class="xref">RFC5321</a>]</span>.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">A size limitation in a dmarc-uri, if provided, is interpreted as a
count of units followed by an OPTIONAL unit size ("k" for kilobytes,
"m" for megabytes, "g" for gigabytes, "t" for terabytes).  Without a
unit, the number is presumed to be a basic byte count.  Note that the
units are considered to be powers of two; a kilobyte is 2^10, a
megabyte is 2^20, etc.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="domain-owner-actions">
<section id="section-6.5">
        <h3 id="name-domain-owner-actions">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-domain-owner-actions" class="section-name selfRef">Domain Owner Actions</a>
        </h3>
<p id="section-6.5-1">To implement the DMARC mechanism, the only action required of a
Domain Owner is the creation of the DMARC policy record in the DNS.
However, in order to make meaningful use of DMARC, a Domain Owner
must at minimum either establish an address to receive reports, or
deploy authentication technologies and ensure Identifier Alignment.
Most Domain Owners will want to do both.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">DMARC reports will be of significant size, and the addresses that
receive them are publicly visible, so we encourage Domain Owners to
set up dedicated email addresses to receive and process reports, and
to deploy abuse countermeasures on those email addresses as
appropriate.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">Authentication technologies are discussed in <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span> (see also
<span>[<a href="#RFC5585" class="xref">RFC5585</a>]</span> and <span>[<a href="#RFC5863" class="xref">RFC5863</a>]</span>) and <span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span>.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mail-receiver-actions">
<section id="section-6.6">
        <h3 id="name-mail-receiver-actions">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-mail-receiver-actions" class="section-name selfRef">Mail Receiver Actions</a>
        </h3>
<p id="section-6.6-1">This section describes receiver actions in the DMARC environment.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<div id="extract-author-domain">
<section id="section-6.6.1">
          <h4 id="name-extract-author-domain">
<a href="#section-6.6.1" class="section-number selfRef">6.6.1. </a><a href="#name-extract-author-domain" class="section-name selfRef">Extract Author Domain</a>
          </h4>
<p id="section-6.6.1-1">The domain in the RFC5322.From field is extracted as the domain to be
evaluated by DMARC.  If the domain is encoded with UTF-8, the domain
name must be converted to an A-label, as described in Section 2.3 of
<span>[<a href="#RFC5890" class="xref">RFC5890</a>]</span>, for further processing.<a href="#section-6.6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.6.1-2">In order to be processed by DMARC, a message typically needs to
contain exactly one RFC5322.From domain (a single From: field with a
single domain in it).  Not all messages meet this requirement, and
handling of them is outside of the scope of this document.  Typical
exceptions, and the way they have been historically handled by DMARC
participants, are as follows:<a href="#section-6.6.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.6.1-3.1">
              <p id="section-6.6.1-3.1.1">Messages with multiple RFC5322.From fields are typically rejected,
since that form is forbidden under RFC 5322 <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span>;<a href="#section-6.6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.6.1-3.2">
              <p id="section-6.6.1-3.2.1">Messages bearing a single RFC5322.From field containing multiple
addresses (and, thus, multiple domain names to be evaluated) are
typically rejected because the sorts of mail normally protected by
DMARC do not use this format;<a href="#section-6.6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.6.1-3.3">
              <p id="section-6.6.1-3.3.1">Messages that have no RFC5322.From field at all are typically
rejected, since that form is forbidden under RFC 5322 <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span>;<a href="#section-6.6.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.6.1-3.4">
              <p id="section-6.6.1-3.4.1">Messages with an RFC5322.From field that contains no meaningful
domains, such as RFC 5322 <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span>'s "group" syntax, are typically
ignored.<a href="#section-6.6.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.6.1-4">The case of a syntactically valid multi-valued RFC5322.From field
presents a particular challenge.  The process in this case is to
apply the DMARC check using each of those domains found in the
RFC5322.From field as the Author Domain and apply the most strict
policy selected among the checks that fail.<a href="#section-6.6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="determine-handling-policy">
<section id="section-6.6.2">
          <h4 id="name-determine-handling-policy">
<a href="#section-6.6.2" class="section-number selfRef">6.6.2. </a><a href="#name-determine-handling-policy" class="section-name selfRef">Determine Handling Policy</a>
          </h4>
<p id="section-6.6.2-1">To arrive at a policy for an individual message, Mail Receivers MUST
perform the following actions or their semantic equivalents.
Steps 2-4 MAY be done in parallel, whereas steps 5 and 6 require
input from previous steps.<a href="#section-6.6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.6.2-2">The steps are as follows:<a href="#section-6.6.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.6.2-3">
<li id="section-6.6.2-3.1">
              <p id="section-6.6.2-3.1.1">Extract the RFC5322.From domain from the message (as above).<a href="#section-6.6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.2-3.2">
              <p id="section-6.6.2-3.2.1">Query the DNS for a DMARC policy record.  Continue if one is
found, or terminate DMARC evaluation otherwise.  See
<a href="#policy-discovery" class="xref">Section 6.6.3</a> for details.<a href="#section-6.6.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.2-3.3">
              <p id="section-6.6.2-3.3.1">Perform DKIM signature verification checks.  A single email could
contain multiple DKIM signatures.  The results of this step are
passed to the remainder of the algorithm and MUST include the
value of the "d=" tag from each checked DKIM signature.<a href="#section-6.6.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.2-3.4">
              <p id="section-6.6.2-3.4.1">Perform SPF validation checks.  The results of this step are
passed to the remainder of the algorithm and MUST include the
domain name used to complete the SPF check.<a href="#section-6.6.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.2-3.5">
              <p id="section-6.6.2-3.5.1">Conduct Identifier Alignment checks.  With authentication checks
and policy discovery performed, the Mail Receiver checks to see
if Authenticated Identifiers fall into alignment as described in
<a href="#terminology" class="xref">Section 3</a>.  If one or more of the Authenticated Identifiers align
with the RFC5322.From domain, the message is considered to pass
the DMARC mechanism check.  All other conditions (authentication
failures, identifier mismatches) are considered to be DMARC
mechanism check failures.<a href="#section-6.6.2-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.2-3.6">
              <p id="section-6.6.2-3.6.1">Apply policy.  Emails that fail the DMARC mechanism check are
disposed of in accordance with the discovered DMARC policy of the
Domain Owner.  See <a href="#general-record-format" class="xref">Section 6.3</a> for details.<a href="#section-6.6.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.6.2-4">Heuristics applied in the absence of use by a Domain Owner of either
SPF or DKIM (e.g., <span>[<a href="#Best-Guess-SPF" class="xref">Best-Guess-SPF</a>]</span>) SHOULD NOT be used, as it may be
the case that the Domain Owner wishes a Message Receiver not to
consider the results of that underlying authentication protocol at
all.<a href="#section-6.6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.6.2-5">DMARC evaluation can only yield a "pass" result after one of the
underlying authentication mechanisms passes for an aligned
identifier.  If neither passes and one or both of them fail due to a
temporary error, the Receiver evaluating the message is unable to
conclude that the DMARC mechanism had a permanent failure; they
therefore cannot apply the advertised DMARC policy.  When otherwise
appropriate, Receivers MAY send feedback reports regarding temporary
errors.<a href="#section-6.6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.6.2-6">Handling of messages for which SPF and/or DKIM evaluation encounter a
permanent DNS error is left to the discretion of the Mail Receiver.<a href="#section-6.6.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="policy-discovery">
<section id="section-6.6.3">
          <h4 id="name-policy-discovery">
<a href="#section-6.6.3" class="section-number selfRef">6.6.3. </a><a href="#name-policy-discovery" class="section-name selfRef">Policy Discovery</a>
          </h4>
<p id="section-6.6.3-1">As stated above, the DMARC mechanism uses DNS TXT records to
advertise policy.  Policy discovery is accomplished via a method
similar to the method used for SPF records.  This method, and the
important differences between DMARC and SPF mechanisms, are discussed
below.<a href="#section-6.6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.6.3-2">To balance the conflicting requirements of supporting wildcarding,
allowing subdomain policy overrides, and limiting DNS query load, the
following DNS lookup scheme is employed:<a href="#section-6.6.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.6.3-3">
<li id="section-6.6.3-3.1">
              <p id="section-6.6.3-3.1.1">Mail Receivers MUST query the DNS for a DMARC TXT record at the
DNS domain matching the one found in the RFC5322.From domain in
the message.  A possibly empty set of records is returned.<a href="#section-6.6.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.3-3.2">
              <p id="section-6.6.3-3.2.1">Records that do not start with a "v=" tag that identifies the
current version of DMARC are discarded.<a href="#section-6.6.3-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.3-3.3">
              <p id="section-6.6.3-3.3.1">If the set is now empty, the Mail Receiver MUST query the DNS for
a DMARC TXT record at the DNS domain matching the Organizational
Domain in place of the RFC5322.From domain in the message (if
different).  This record can contain policy to be asserted for
subdomains of the Organizational Domain.  A possibly empty set of
records is returned.<a href="#section-6.6.3-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.3-3.4">
              <p id="section-6.6.3-3.4.1">Records that do not start with a "v=" tag that identifies the
current version of DMARC are discarded.<a href="#section-6.6.3-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.3-3.5">
              <p id="section-6.6.3-3.5.1">If the remaining set contains multiple records or no records,
policy discovery terminates and DMARC processing is not applied
to this message.<a href="#section-6.6.3-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.3-3.6">
              <p id="section-6.6.3-3.6.1">If a retrieved policy record does not contain a valid "p" tag, or
contains an "sp" tag that is not valid, then:<a href="#section-6.6.3-3.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.6.3-3.6.2">
<li id="section-6.6.3-3.6.2.1">
                  <p id="section-6.6.3-3.6.2.1.1">if a "rua" tag is present and contains at least one
syntactically valid reporting URI, the Mail Receiver SHOULD
act as if a record containing a valid "v" tag and "p=none"
was retrieved, and continue processing;<a href="#section-6.6.3-3.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-6.6.3-3.6.2.2">
                  <p id="section-6.6.3-3.6.2.2.1">otherwise, the Mail Receiver applies no DMARC processing to
this message.<a href="#section-6.6.3-3.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
          </ol>
<p id="section-6.6.3-4">If the set produced by the mechanism above contains no DMARC policy
record (i.e., any indication that there is no such record as opposed
to a transient DNS error), Mail Receivers SHOULD NOT apply the DMARC
mechanism to the message.<a href="#section-6.6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.6.3-5">Handling of DNS errors when querying for the DMARC policy record is
left to the discretion of the Mail Receiver.  For example, to ensure
minimal disruption of mail flow, transient errors could result in
delivery of the message ("fail open"), or they could result in the
message being temporarily rejected (i.e., an SMTP 4yx reply), which
invites the sending MTA to try again after the condition has possibly
cleared, allowing a definite DMARC conclusion to be reached ("fail
closed").<a href="#section-6.6.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-sampling">
<section id="section-6.6.4">
          <h4 id="name-message-sampling">
<a href="#section-6.6.4" class="section-number selfRef">6.6.4. </a><a href="#name-message-sampling" class="section-name selfRef">Message Sampling</a>
          </h4>
<p id="section-6.6.4-1">If the "pct" tag is present in the policy record, the Mail Receiver
MUST NOT enact the requested policy ("p" tag or "sp" tag") on more
than the stated percent of the totality of affected messages.
However, regardless of whether or not the "pct" tag is present, the
Mail Receiver MUST include all relevant message data in any reports
produced.<a href="#section-6.6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.6.4-2">If email is subject to the DMARC policy of "quarantine", the Mail
Receiver SHOULD quarantine the message.  If the email is not subject
to the "quarantine" policy (due to the "pct" tag), the Mail Receiver
SHOULD apply local message classification as normal.<a href="#section-6.6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.6.4-3">If email is subject to the DMARC policy of "reject", the Mail
Receiver SHOULD reject the message (see <a href="#rejecting-messages" class="xref">Section 9.3</a>).  If the email
is not subject to the "reject" policy (due to the "pct" tag), the
Mail Receiver SHOULD treat the email as though the "quarantine"
policy applies.  This behavior allows Domain Owners to experiment
with progressively stronger policies without relaxing existing
policy.<a href="#section-6.6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.6.4-4">Mail Receivers implement "pct" via statistical mechanisms that
achieve a close approximation to the requested percentage and provide
a representative sample across a reporting period.<a href="#section-6.6.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="store-results-of-dmarc-processing">
<section id="section-6.6.5">
          <h4 id="name-store-results-of-dmarc-proc">
<a href="#section-6.6.5" class="section-number selfRef">6.6.5. </a><a href="#name-store-results-of-dmarc-proc" class="section-name selfRef">Store Results of DMARC Processing</a>
          </h4>
<p id="section-6.6.5-1">The results of Mail Receiver-based DMARC processing should be stored
for eventual presentation back to the Domain Owner in the form of
aggregate feedback reports.  <a href="#general-record-format" class="xref">Section 6.3</a> and the DMARC reporting docuents discuss aggregate
feedback.<a href="#section-6.6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="policy-enforcement-considerations">
<section id="section-6.7">
        <h3 id="name-policy-enforcement-consider">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-policy-enforcement-consider" class="section-name selfRef">Policy Enforcement Considerations</a>
        </h3>
<p id="section-6.7-1">Mail Receivers MAY choose to reject or quarantine email even if email
passes the DMARC mechanism check.  The DMARC mechanism does not
inform Mail Receivers whether an email stream is "good".  Mail
Receivers are encouraged to maintain anti-abuse technologies to
combat the possibility of DMARC-enabled criminal campaigns.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<p id="section-6.7-2">Mail Receivers MAY choose to accept email that fails the DMARC
mechanism check even if the Domain Owner has published a "reject"
policy.  Mail Receivers need to make a best effort not to increase
the likelihood of accepting abusive mail if they choose not to comply
with a Domain Owner's reject, against policy.  At a minimum, addition
of the Authentication-Results header field (see <span>[<a href="#RFC8601" class="xref">RFC8601</a>]</span>) is
RECOMMENDED when delivery of failing mail is done.  When this is
done, the DNS domain name thus recorded MUST be encoded as an
A-label.<a href="#section-6.7-2" class="pilcrow">¶</a></p>
<p id="section-6.7-3">Mail Receivers are only obligated to report reject or quarantine
policy actions in aggregate feedback reports that are due to DMARC
policy.  They are not required to report reject or quarantine actions
that are the result of local policy.  If local policy information is
exposed, abusers can gain insight into the effectiveness and delivery
rates of spam campaigns.<a href="#section-6.7-3" class="pilcrow">¶</a></p>
<p id="section-6.7-4">Final disposition of a message is always a matter of local policy.
An operator that wishes to favor DMARC policy over SPF policy, for
example, will disregard the SPF policy, since enacting an
SPF-determined rejection prevents evaluation of DKIM; DKIM might
otherwise pass, satisfying the DMARC evaluation.  There is a
trade-off to doing so, namely acceptance and processing of the entire
message body in exchange for the enhanced protection DMARC provides.<a href="#section-6.7-4" class="pilcrow">¶</a></p>
<p id="section-6.7-5">DMARC-compliant Mail Receivers typically disregard any mail-handling
directive discovered as part of an authentication mechanism (e.g.,
Author Domain Signing Practices (ADSP), SPF) where a DMARC record is
also discovered that specifies a policy other than "none".  Deviating
from this practice introduces inconsistency among DMARC operators in
terms of handling of the message.  However, such deviation is not
proscribed.<a href="#section-6.7-5" class="pilcrow">¶</a></p>
<p id="section-6.7-6">To enable Domain Owners to receive DMARC feedback without impacting
existing mail processing, discovered policies of "p=none" SHOULD NOT
modify existing mail disposition processing.<a href="#section-6.7-6" class="pilcrow">¶</a></p>
<p id="section-6.7-7">Mail Receivers SHOULD also implement reporting instructions of DMARC,
even in the absence of a request for DKIM reporting <span>[<a href="#RFC6651" class="xref">RFC6651</a>]</span> or
SPF reporting <span>[<a href="#RFC6652" class="xref">RFC6652</a>]</span>.  Furthermore, the presence of such requests
SHOULD NOT affect DMARC reporting.<a href="#section-6.7-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dmarc-feedback">
<section id="section-7">
      <h2 id="name-dmarc-feedback">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-dmarc-feedback" class="section-name selfRef">DMARC Feedback</a>
      </h2>
<p id="section-7-1">Providing Domain Owners with visibility into how Mail Receivers
implement and enforce the DMARC mechanism in the form of feedback is
critical to establishing and maintaining accurate authentication
deployments.  When Domain Owners can see what effect their policies
and practices are having, they are better willing and able to use
quarantine and reject policies.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The details of this feedback are described in a separate document.<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="minimum-implementations">
<section id="section-8">
      <h2 id="name-minimum-implementations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-minimum-implementations" class="section-name selfRef">Minimum Implementations</a>
      </h2>
<p id="section-8-1">A minimum implementation of DMARC has the following characteristics:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">Is able to send and/or receive reports at least daily;<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.2">
          <p id="section-8-2.2.1">Is able to send and/or receive reports using "mailto" URIs;<a href="#section-8-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.3">
          <p id="section-8-2.3.1">Other than in exceptional circumstances such as resource
exhaustion, can generate or accept a report up to ten megabytes in
size;<a href="#section-8-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.4">
          <p id="section-8-2.4.1">If acting as a Mail Receiver, fully implements the provisions of
<a href="#mail-receiver-actions" class="xref">Section 6.6</a>.<a href="#section-8-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="other-topics">
<section id="section-9">
      <h2 id="name-other-topics">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-other-topics" class="section-name selfRef">Other Topics</a>
      </h2>
<p id="section-9-1">This section discusses some topics regarding choices made in the
development of DMARC, largely to commit the history to record.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="issues-specific-to-spf">
<section id="section-9.1">
        <h3 id="name-issues-specific-to-spf">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-issues-specific-to-spf" class="section-name selfRef">Issues Specific to SPF</a>
        </h3>
<p id="section-9.1-1">Though DMARC does not inherently change the semantics of an SPF
policy record, historically lax enforcement of such policies has led
many to publish extremely broad records containing many large network
ranges.  Domain Owners are strongly encouraged to carefully review
their SPF records to understand which networks are authorized to send
on behalf of the Domain Owner before publishing a DMARC record.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">Some receiver architectures might implement SPF in advance of any
DMARC operations.  This means that a "-" prefix on a sender's SPF
mechanism, such as "-all", could cause that rejection to go into
effect early in handling, causing message rejection before any DMARC
processing takes place.  Operators choosing to use "-all" should be
aware of this.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dns-load-and-caching">
<section id="section-9.2">
        <h3 id="name-dns-load-and-caching">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-dns-load-and-caching" class="section-name selfRef">DNS Load and Caching</a>
        </h3>
<p id="section-9.2-1">DMARC policies are communicated using the DNS and therefore inherit a
number of considerations related to DNS caching.  The inherent
conflict between freshness and the impact of caching on the reduction
of DNS-lookup overhead should be considered from the Mail Receiver's
point of view.  Should Domain Owners publish a DNS record with a very
short TTL, Mail Receivers can be provoked through the injection of
large volumes of messages to overwhelm the Domain Owner's DNS.
Although this is not a concern specific to DMARC, the implications of
a very short TTL should be considered when publishing DMARC policies.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">Conversely, long TTLs will cause records to be cached for long
periods of time.  This can cause a critical change to DMARC
parameters advertised by a Domain Owner to go unnoticed for the
length of the TTL (while waiting for DNS caches to expire).  Avoiding
this problem can mean shorter TTLs, with the potential problems
described above.  A balance should be sought to maintain
responsiveness of DMARC preference changes while preserving the
benefits of DNS caching.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rejecting-messages">
<section id="section-9.3">
        <h3 id="name-rejecting-messages">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-rejecting-messages" class="section-name selfRef">Rejecting Messages</a>
        </h3>
<p id="section-9.3-1">This proposal calls for rejection of a message during the SMTP
session under certain circumstances.  This is preferable to
generation of a Delivery Status Notification (<span>[<a href="#RFC3464" class="xref">RFC3464</a>]</span>), since
fraudulent messages caught and rejected using DMARC would then result
in annoying generation of such failure reports that go back to the
RFC5321.MailFrom address.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">This synchronous rejection is typically done in one of two ways:<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-3.1">
            <p id="section-9.3-3.1.1">Full rejection, wherein the SMTP server issues a 5xy reply code as
an indication to the SMTP client that the transaction failed; the
SMTP client is then responsible for generating notification that
delivery failed (see Section 4.2.5 of <span>[<a href="#RFC5321" class="xref">RFC5321</a>]</span>).<a href="#section-9.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-3.2">
            <p id="section-9.3-3.2.1">A "silent discard", wherein the SMTP server returns a 2xy reply
code implying to the client that delivery (or, at least, relay)
was successfully completed, but then simply discarding the message
with no further action.<a href="#section-9.3-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.3-4">Each of these has a cost.  For instance, a silent discard can help to
prevent backscatter, but it also effectively means that the SMTP
server has to be programmed to give a false result, which can
confound external debugging efforts.<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<p id="section-9.3-5">Similarly, the text portion of the SMTP reply may be important to
consider.  For example, when rejecting a message, revealing the
reason for the rejection might give an attacker enough information to
bypass those efforts on a later attempt, though it might also assist
a legitimate client to determine the source of some local issue that
caused the rejection.<a href="#section-9.3-5" class="pilcrow">¶</a></p>
<p id="section-9.3-6">In the latter case, when doing an SMTP rejection, providing a clear
hint can be useful in resolving issues.  A receiver might indicate in
plain text the reason for the rejection by using the word "DMARC"
somewhere in the reply text.  Many systems are able to scan the SMTP
reply text to determine the nature of the rejection.  Thus, providing
a machine-detectable reason for rejection allows the problems causing
rejections to be properly addressed by automated systems.  For
example:<a href="#section-9.3-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-9.3-7">
<pre>550 5.7.1 Email rejected per DMARC policy for example.com
</pre><a href="#section-9.3-7" class="pilcrow">¶</a>
</div>
<p id="section-9.3-8">If a Mail Receiver elects to defer delivery due to inability to
retrieve or apply DMARC policy, this is best done with a 4xy SMTP
reply code.<a href="#section-9.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identifier-alignment-considerations">
<section id="section-9.4">
        <h3 id="name-identifier-alignment-consid">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-identifier-alignment-consid" class="section-name selfRef">Identifier Alignment Considerations</a>
        </h3>
<p id="section-9.4-1">The DMARC mechanism allows both DKIM and SPF-authenticated
identifiers to authenticate email on behalf of a Domain Owner and,
possibly, on behalf of different subdomains.  If malicious or unaware
users can gain control of the SPF record or DKIM selector records for
a subdomain, the subdomain can be used to generate DMARC-passing
email on behalf of the Organizational Domain.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">For example, an attacker who controls the SPF record for
"evil.example.com" can send mail with an RFC5322.From field
containing "foo@example.com" that can pass both authentication and
the DMARC check against "example.com".<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">The Organizational Domain administrator should be careful not to
delegate control of subdomains if this is an issue, and to consider
using the "strict" Identifier Alignment option if appropriate.<a href="#section-9.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interoperability-issues">
<section id="section-9.5">
        <h3 id="name-interoperability-issues">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-interoperability-issues" class="section-name selfRef">Interoperability Issues</a>
        </h3>
<p id="section-9.5-1">DMARC limits which end-to-end scenarios can achieve a "pass" result.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<p id="section-9.5-2">Because DMARC relies on <span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span> and/or <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span> to achieve a "pass",
their limitations also apply.<a href="#section-9.5-2" class="pilcrow">¶</a></p>
<p id="section-9.5-3">Additional DMARC constraints occur when a message is processed by
some Mediators, such as mailing lists.  Transiting a Mediator often
causes either the authentication to fail or Identifier Alignment to
be lost.  These transformations may conform to standards but will
still prevent a DMARC "pass".<a href="#section-9.5-3" class="pilcrow">¶</a></p>
<p id="section-9.5-4">In addition to Mediators, mail that is sent by authorized,
independent third parties might not be sent with Identifier
Alignment, also preventing a "pass" result.<a href="#section-9.5-4" class="pilcrow">¶</a></p>
<p id="section-9.5-5">Issues specific to the use of policy mechanisms alongside DKIM are
further discussed in <span>[<a href="#RFC6377" class="xref">RFC6377</a>]</span>, particularly Section 5.2.<a href="#section-9.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This section describes actions completed by IANA.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="authentication-results-method-registry-update">
<section id="section-10.1">
        <h3 id="name-authentication-results-meth">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-authentication-results-meth" class="section-name selfRef">Authentication-Results Method Registry Update</a>
        </h3>
<p id="section-10.1-1">IANA has added the following to the "Email Authentication Methods"
registry:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">Method:  dmarc<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">Defined:  RFC 7489<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1-4">ptype:  header<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1-5">Property:  from<a href="#section-10.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1-6">Value:  the domain portion of the RFC5322.From field<a href="#section-10.1-6" class="pilcrow">¶</a></p>
<p id="section-10.1-7">Status:  active<a href="#section-10.1-7" class="pilcrow">¶</a></p>
<p id="section-10.1-8">Version:  1<a href="#section-10.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-results-result-registry-update">
<section id="section-10.2">
        <h3 id="name-authentication-results-resu">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-authentication-results-resu" class="section-name selfRef">Authentication-Results Result Registry Update</a>
        </h3>
<p id="section-10.2-1">IANA has added the following in the "Email Authentication Result
Names" registry:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">Code:  none<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">Existing/New Code:  existing<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<p id="section-10.2-4">Defined:  <span>[<a href="#RFC8601" class="xref">RFC8601</a>]</span><a href="#section-10.2-4" class="pilcrow">¶</a></p>
<p id="section-10.2-5">Auth Method:  dmarc (added)<a href="#section-10.2-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2-6">
          <dt id="section-10.2-6.1">Meaning:</dt>
          <dd style="margin-left: 1.5em" id="section-10.2-6.2">No DMARC policy record was published for the aligned
identifier, or no aligned identifier could be extracted.<a href="#section-10.2-6.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.2-7">Status:  active<a href="#section-10.2-7" class="pilcrow">¶</a></p>
<p id="section-10.2-8">Code:  pass<a href="#section-10.2-8" class="pilcrow">¶</a></p>
<p id="section-10.2-9">Existing/New Code:  existing<a href="#section-10.2-9" class="pilcrow">¶</a></p>
<p id="section-10.2-10">Defined:  <span>[<a href="#RFC8601" class="xref">RFC8601</a>]</span><a href="#section-10.2-10" class="pilcrow">¶</a></p>
<p id="section-10.2-11">Auth Method:  dmarc (added)<a href="#section-10.2-11" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2-12">
          <dt id="section-10.2-12.1">Meaning:</dt>
          <dd style="margin-left: 1.5em" id="section-10.2-12.2">A DMARC policy record was published for the aligned
identifier, and at least one of the authentication mechanisms passed.<a href="#section-10.2-12.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.2-13">Status:  active<a href="#section-10.2-13" class="pilcrow">¶</a></p>
<p id="section-10.2-14">Code:  fail<a href="#section-10.2-14" class="pilcrow">¶</a></p>
<p id="section-10.2-15">Existing/New Code:  existing<a href="#section-10.2-15" class="pilcrow">¶</a></p>
<p id="section-10.2-16">Defined:  <span>[<a href="#RFC8601" class="xref">RFC8601</a>]</span><a href="#section-10.2-16" class="pilcrow">¶</a></p>
<p id="section-10.2-17">Auth Method:  dmarc (added)<a href="#section-10.2-17" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2-18">
          <dt id="section-10.2-18.1">Meaning:</dt>
          <dd style="margin-left: 1.5em" id="section-10.2-18.2">A DMARC policy record was published for the aligned
identifier, and none of the authentication mechanisms passed.<a href="#section-10.2-18.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.2-19">Status:  active<a href="#section-10.2-19" class="pilcrow">¶</a></p>
<p id="section-10.2-20">Code:  temperror<a href="#section-10.2-20" class="pilcrow">¶</a></p>
<p id="section-10.2-21">Existing/New Code:  existing<a href="#section-10.2-21" class="pilcrow">¶</a></p>
<p id="section-10.2-22">Defined:  <span>[<a href="#RFC8601" class="xref">RFC8601</a>]</span><a href="#section-10.2-22" class="pilcrow">¶</a></p>
<p id="section-10.2-23">Auth Method:  dmarc (added)<a href="#section-10.2-23" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2-24">
          <dt id="section-10.2-24.1">Meaning:</dt>
          <dd style="margin-left: 1.5em" id="section-10.2-24.2">A temporary error occurred during DMARC evaluation.  A
later attempt might produce a final result.<a href="#section-10.2-24.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.2-25">Status:  active<a href="#section-10.2-25" class="pilcrow">¶</a></p>
<p id="section-10.2-26">Code:  permerror<a href="#section-10.2-26" class="pilcrow">¶</a></p>
<p id="section-10.2-27">Existing/New Code:  existing<a href="#section-10.2-27" class="pilcrow">¶</a></p>
<p id="section-10.2-28">Defined:  <span>[<a href="#RFC8601" class="xref">RFC8601</a>]</span><a href="#section-10.2-28" class="pilcrow">¶</a></p>
<p id="section-10.2-29">Auth Method:  dmarc (added)<a href="#section-10.2-29" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2-30">
          <dt id="section-10.2-30.1">Meaning:</dt>
          <dd style="margin-left: 1.5em" id="section-10.2-30.2">A permanent error occurred during DMARC evaluation, such as
encountering a syntactically incorrect DMARC record.  A later
attempt is unlikely to produce a final result.<a href="#section-10.2-30.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.2-31">Status:  active<a href="#section-10.2-31" class="pilcrow">¶</a></p>
</section>
</div>
<div id="feedback-report-header-fields-registry-update">
<section id="section-10.3">
        <h3 id="name-feedback-report-header-fiel">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-feedback-report-header-fiel" class="section-name selfRef">Feedback Report Header Fields Registry Update</a>
        </h3>
<p id="section-10.3-1">The following has been added to the "Feedback Report Header Fields"
registry:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">Field Name:  Identity-Alignment<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.3-3">
          <dt id="section-10.3-3.1">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-10.3-3.2">indicates whether the message about which a report is
being generated had any identifiers in alignment as defined in
RFC 7489<a href="#section-10.3-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.3-4">Multiple Appearances:  No<a href="#section-10.3-4" class="pilcrow">¶</a></p>
<p id="section-10.3-5">Related "Feedback-Type":  auth-failure<a href="#section-10.3-5" class="pilcrow">¶</a></p>
<p id="section-10.3-6">Reference:  RFC 7489<a href="#section-10.3-6" class="pilcrow">¶</a></p>
<p id="section-10.3-7">Status:  current<a href="#section-10.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dmarc-tag-registry">
<section id="section-10.4">
        <h3 id="name-dmarc-tag-registry">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-dmarc-tag-registry" class="section-name selfRef">DMARC Tag Registry</a>
        </h3>
<p id="section-10.4-1">A new registry tree called "Domain-based Message Authentication,
Reporting, and Conformance (DMARC) Parameters" has been created.
Within it, a new sub-registry called the "DMARC Tag Registry" has
been created.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<p id="section-10.4-2">Names of DMARC tags must be registered with IANA in this new
sub-registry.  New entries are assigned only for values that have
been documented in a manner that satisfies the terms of Specification
Required, per <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.  Each registration must include
the tag name; the specification that defines it; a brief description;
and its status, which must be one of "current", "experimental", or
"historic".  The Designated Expert needs to confirm that the provided
specification adequately describes the new tag and clearly presents
how it would be used within the DMARC context by Domain Owners and
Mail Receivers.<a href="#section-10.4-2" class="pilcrow">¶</a></p>
<p id="section-10.4-3">To avoid version compatibility issues, tags added to the DMARC
specification are to avoid changing the semantics of existing records
when processed by implementations conforming to prior specifications.<a href="#section-10.4-3" class="pilcrow">¶</a></p>
<p id="section-10.4-4">The initial set of entries in this registry is as follows:<a href="#section-10.4-4" class="pilcrow">¶</a></p>
<span id="name-dmarc-tag-registry-2"></span><table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-dmarc-tag-registry-2" class="selfRef">"DMARC Tag Registry"</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Tag Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">adkim</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">DKIM alignment mode</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">aspf</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">SPF alignment mode</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fo</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Failure reporting options</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">p</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Requested handling policy</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">pct</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Sampling rate</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">rf</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Failure reporting format(s)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ri</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Aggregate Reporting interval</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">rua</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Reporting URI(s) for aggregate data</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ruf</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Reporting URI(s) for failure data</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">sp</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Requested handling policy for subdomains</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">v</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Specification version</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="dmarc-report-format-registry">
<section id="section-10.5">
        <h3 id="name-dmarc-report-format-registr">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-dmarc-report-format-registr" class="section-name selfRef">DMARC Report Format Registry</a>
        </h3>
<p id="section-10.5-1">Also within "Domain-based Message Authentication, Reporting, and
Conformance (DMARC) Parameters", a new sub-registry called "DMARC
Report Format Registry" has been created.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<p id="section-10.5-2">Names of DMARC failure reporting formats must be registered with IANA
in this registry.  New entries are assigned only for values that
satisfy the definition of Specification Required, per
<span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.  In addition to a reference to a permanent
specification, each registration must include the format name; a
brief description; and its status, which must be one of "current",
"experimental", or "historic".  The Designated Expert needs to
confirm that the provided specification adequately describes the
report format and clearly presents how it would be used within the
DMARC context by Domain Owners and Mail Receivers.<a href="#section-10.5-2" class="pilcrow">¶</a></p>
<p id="section-10.5-3">The initial entry in this registry is as follows:<a href="#section-10.5-3" class="pilcrow">¶</a></p>
<span id="name-dmarc-report-format-registry"></span><table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-dmarc-report-format-registry" class="selfRef">"DMARC Report Format Registry"</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Format Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">afrf</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Authentication Failure Reporting Format (see <span>[<a href="#RFC6591" class="xref">RFC6591</a>]</span>)</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="underscored-and-globally-scoped-dns-node-names-registry">
<section id="section-10.6">
        <h3 id="name-underscored-and-globally-sc">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-underscored-and-globally-sc" class="section-name selfRef">Underscored and Globally Scoped DNS Node Names Registry</a>
        </h3>
<p id="section-10.6-1">Per [!@RFC8552], please add the following entry to the "Underscored
and Globally Scoped DNS Node Names" registry:<a href="#section-10.6-1" class="pilcrow">¶</a></p>
<span id="name-underscored-and-globally-sco"></span><table class="left" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-underscored-and-globally-sco" class="selfRef">"Underscored and Globally Scoped DNS Node Names" registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">RR Type</th>
              <th class="text-left" rowspan="1" colspan="1">_NODE NAME</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TXT</td>
              <td class="text-left" rowspan="1" colspan="1">_dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 7489</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">This section discusses security issues and possible remediations
(where available) for DMARC.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="authentication-methods">
<section id="section-11.1">
        <h3 id="name-authentication-methods">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-authentication-methods" class="section-name selfRef">Authentication Methods</a>
        </h3>
<p id="section-11.1-1">Security considerations from the authentication methods used by DMARC
are incorporated here by reference.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attacks-on-reporting-uris">
<section id="section-11.2">
        <h3 id="name-attacks-on-reporting-uris">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-attacks-on-reporting-uris" class="section-name selfRef">Attacks on Reporting URIs</a>
        </h3>
<p id="section-11.2-1">URIs published in DNS TXT records are well-understood possible
targets for attack.  Specifications such as <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> and <span>[<a href="#RFC2142" class="xref">RFC2142</a>]</span> either
expose or cause the exposure of email addresses that could be flooded
by an attacker, for example; MX, NS, and other records found in the
DNS advertise potential attack destinations; common DNS names such as
"www" plainly identify the locations at which particular services can
be found, providing destinations for targeted denial-of-service or
penetration attacks.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">Thus, Domain Owners will need to harden these addresses against
various attacks, including but not limited to:<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-3.1">
            <p id="section-11.2-3.1.1">high-volume denial-of-service attacks;<a href="#section-11.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-3.2">
            <p id="section-11.2-3.2.1">deliberate construction of malformed reports intended to identify
or exploit parsing or processing vulnerabilities;<a href="#section-11.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-3.3">
            <p id="section-11.2-3.3.1">deliberate construction of reports containing false claims for the
Submitter or Reported-Domain fields, including the possibility of
false data from compromised but known Mail Receivers.<a href="#section-11.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="dns-security">
<section id="section-11.3">
        <h3 id="name-dns-security">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-dns-security" class="section-name selfRef">DNS Security</a>
        </h3>
<p id="section-11.3-1">The DMARC mechanism and its underlying technologies (SPF, DKIM)
depend on the security of the DNS.  To reduce the risk of subversion
of the DMARC mechanism due to DNS-based exploits, serious
consideration should be given to the deployment of DNSSEC in parallel
with the deployment of DMARC by both Domain Owners and Mail
Receivers.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<p id="section-11.3-2">Publication of data using DNSSEC is relevant to Domain Owners and
third-party Report Receivers.  DNSSEC-aware resolution is relevant to
Mail Receivers and Report Receivers.<a href="#section-11.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="display-name-attacks">
<section id="section-11.4">
        <h3 id="name-display-name-attacks">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-display-name-attacks" class="section-name selfRef">Display Name Attacks</a>
        </h3>
<p id="section-11.4-1">A common attack in messaging abuse is the presentation of false
information in the display-name portion of the RFC5322.From field.
For example, it is possible for the email address in that field to be
an arbitrary address or domain name, while containing a well-known
name (a person, brand, role, etc.) in the display name, intending to
fool the end user into believing that the name is used legitimately.
The attack is predicated on the notion that most common MUAs will
show the display name and not the email address when both are
available.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<p id="section-11.4-2">Generally, display name attacks are out of scope for DMARC, as
further exploration of possible defenses against these attacks needs
to be undertaken.<a href="#section-11.4-2" class="pilcrow">¶</a></p>
<p id="section-11.4-3">There are a few possible mechanisms that attempt mitigation of these
attacks, such as the following:<a href="#section-11.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.4-4.1">
            <p id="section-11.4-4.1.1">If the display name is found to include an email address (as
specified in <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span>), execute the DMARC mechanism on the domain
name found there rather than the domain name discovered
originally.  However, this addresses only a very specific attack
space, and spoofers can easily circumvent it by simply not using
an email address in the display name.  There are also known cases
of legitimate uses of an email address in the display name with a
domain different from the one in the address portion, e.g.,<a href="#section-11.4-4.1.1" class="pilcrow">¶</a></p>
<p id="section-11.4-4.1.2">From: "user@example.org via Bug Tracker" <a href="mailto:support@example.com">support@example.com</a><a href="#section-11.4-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.4-4.2">
            <p id="section-11.4-4.2.1">In the MUA, only show the display name if the DMARC mechanism
succeeds.  This too is easily defeated, as an attacker could
arrange to pass the DMARC tests while fraudulently using another
domain name in the display name.<a href="#section-11.4-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.4-4.3">
            <p id="section-11.4-4.3.1">In the MUA, only show the display name if the DMARC mechanism
passes and the email address thus validated matches one found in
the receiving user's list of known addresses.<a href="#section-11.4-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="external-report-addresses">
<section id="section-11.5">
        <h3 id="name-external-reporting-addresse">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-external-reporting-addresse" class="section-name selfRef">External Reporting Addresses</a>
        </h3>
<p id="section-11.5-1">To avoid abuse by bad actors, reporting addresses generally have to
be inside the domains about which reports are requested.  In order to
accommodate special cases such as a need to get reports about domains
that cannot actually receive mail, The DMARC reporting documents describe a DNS-based
mechanism for verifying approved external reporting.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
<p id="section-11.5-2">The obvious consideration here is an increased DNS load against
domains that are claimed as external recipients.  Negative caching
will mitigate this problem, but only to a limited extent, mostly
dependent on the default TTL in the domain's SOA record.<a href="#section-11.5-2" class="pilcrow">¶</a></p>
<p id="section-11.5-3">Where possible, external reporting is best achieved by having the
report be directed to domains that can receive mail and simply having
it automatically forwarded to the desired external destination.<a href="#section-11.5-3" class="pilcrow">¶</a></p>
<p id="section-11.5-4">Note that the addresses shown in the "ruf" tag receive more
information that might be considered private data, since it is
possible for actual email content to appear in the failure reports.
The URIs identified there are thus more attractive targets for
intrusion attempts than those found in the "rua" tag.  Moreover,
attacking the DNS of the subject domain to cause failure data to be
routed fraudulently to an attacker's systems may be an attractive
prospect.  Deployment of <span>[<a href="#RFC4033" class="xref">RFC4033</a>]</span> is advisable if this is a concern.<a href="#section-11.5-4" class="pilcrow">¶</a></p>
<p id="section-11.5-5">The verification mechanism presented in the DMARC reporting docuemnts is currently not
mandatory ("MUST") but strongly recommended ("SHOULD").  It is
possible that it would be elevated to a "MUST" by later security
review.<a href="#section-11.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secure-protocols">
<section id="section-11.6">
        <h3 id="name-secure-protocols">
<a href="#section-11.6" class="section-number selfRef">11.6. </a><a href="#name-secure-protocols" class="section-name selfRef">Secure Protocols</a>
        </h3>
<p id="section-11.6-1">This document encourages use of secure transport mechanisms to
prevent loss of private data to third parties that may be able to
monitor such transmissions.  Unencrypted mechanisms should be
avoided.<a href="#section-11.6-1" class="pilcrow">¶</a></p>
<p id="section-11.6-2">In particular, a message that was originally encrypted or otherwise
secured might appear in a report that is not sent securely, which
could reveal private information.<a href="#section-11.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-12">
      <h2 id="name-normative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC1035">[RFC1035]</dt>
      <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span><span class="refAuthor">, Fielding, R.</span><span class="refAuthor">, and L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4343">[RFC4343]</dt>
      <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) Case Insensitivity Clarification"</span>, <span class="seriesInfo">RFC 4343</span>, <span class="seriesInfo">DOI 10.17487/RFC4343</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4343">https://www.rfc-editor.org/info/rfc4343</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
      <dd>
<span class="refAuthor">Crocker, D., Ed.</span><span class="refAuthor"> and P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5321">[RFC5321]</dt>
      <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Simple Mail Transfer Protocol"</span>, <span class="seriesInfo">RFC 5321</span>, <span class="seriesInfo">DOI 10.17487/RFC5321</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5321">https://www.rfc-editor.org/info/rfc5321</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5322">[RFC5322]</dt>
      <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5322">https://www.rfc-editor.org/info/rfc5322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5890">[RFC5890]</dt>
      <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5890">https://www.rfc-editor.org/info/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6376">[RFC6376]</dt>
      <dd>
<span class="refAuthor">Crocker, D., Ed.</span><span class="refAuthor">, Hansen, T., Ed.</span><span class="refAuthor">, and M. Kucherawy, Ed.</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) Signatures"</span>, <span class="seriesInfo">STD 76</span>, <span class="seriesInfo">RFC 6376</span>, <span class="seriesInfo">DOI 10.17487/RFC6376</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6376">https://www.rfc-editor.org/info/rfc6376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6591">[RFC6591]</dt>
      <dd>
<span class="refAuthor">Fontana, H.</span>, <span class="refTitle">"Authentication Failure Reporting Using the Abuse Reporting Format"</span>, <span class="seriesInfo">RFC 6591</span>, <span class="seriesInfo">DOI 10.17487/RFC6591</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6591">https://www.rfc-editor.org/info/rfc6591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6651">[RFC6651]</dt>
      <dd>
<span class="refAuthor">Kucherawy, M.</span>, <span class="refTitle">"Extensions to DomainKeys Identified Mail (DKIM) for Failure Reporting"</span>, <span class="seriesInfo">RFC 6651</span>, <span class="seriesInfo">DOI 10.17487/RFC6651</span>, <time datetime="2012-06" class="refDate">June 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6651">https://www.rfc-editor.org/info/rfc6651</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6652">[RFC6652]</dt>
      <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework (SPF) Authentication Failure Reporting Using the Abuse Reporting Format"</span>, <span class="seriesInfo">RFC 6652</span>, <span class="seriesInfo">DOI 10.17487/RFC6652</span>, <time datetime="2012-06" class="refDate">June 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6652">https://www.rfc-editor.org/info/rfc6652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7208">[RFC7208]</dt>
    <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1"</span>, <span class="seriesInfo">RFC 7208</span>, <span class="seriesInfo">DOI 10.17487/RFC7208</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7208">https://www.rfc-editor.org/info/rfc7208</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13">
      <h2 id="name-informative-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="Best-Guess-SPF">[Best-Guess-SPF]</dt>
      <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework: Best guess record (FAQ entry)"</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="http://www.openspf.org/FAQ/Best_guess_record">http://www.openspf.org/FAQ/Best_guess_record</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2142">[RFC2142]</dt>
      <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"Mailbox Names for Common Services, Roles and Functions"</span>, <span class="seriesInfo">RFC 2142</span>, <span class="seriesInfo">DOI 10.17487/RFC2142</span>, <time datetime="1997-05" class="refDate">May 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2142">https://www.rfc-editor.org/info/rfc2142</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3464">[RFC3464]</dt>
      <dd>
<span class="refAuthor">Moore, K.</span><span class="refAuthor"> and G. Vaudreuil</span>, <span class="refTitle">"An Extensible Message Format for Delivery Status Notifications"</span>, <span class="seriesInfo">RFC 3464</span>, <span class="seriesInfo">DOI 10.17487/RFC3464</span>, <time datetime="2003-01" class="refDate">January 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3464">https://www.rfc-editor.org/info/rfc3464</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4033">[RFC4033]</dt>
      <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5585">[RFC5585]</dt>
      <dd>
<span class="refAuthor">Hansen, T.</span><span class="refAuthor">, Crocker, D.</span><span class="refAuthor">, and P. Hallam-Baker</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) Service Overview"</span>, <span class="seriesInfo">RFC 5585</span>, <span class="seriesInfo">DOI 10.17487/RFC5585</span>, <time datetime="2009-07" class="refDate">July 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5585">https://www.rfc-editor.org/info/rfc5585</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5598">[RFC5598]</dt>
      <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"Internet Mail Architecture"</span>, <span class="seriesInfo">RFC 5598</span>, <span class="seriesInfo">DOI 10.17487/RFC5598</span>, <time datetime="2009-07" class="refDate">July 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5598">https://www.rfc-editor.org/info/rfc5598</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5617">[RFC5617]</dt>
      <dd>
<span class="refAuthor">Allman, E.</span><span class="refAuthor">, Fenton, J.</span><span class="refAuthor">, Delany, M.</span><span class="refAuthor">, and J. Levine</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"</span>, <span class="seriesInfo">RFC 5617</span>, <span class="seriesInfo">DOI 10.17487/RFC5617</span>, <time datetime="2009-08" class="refDate">August 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5617">https://www.rfc-editor.org/info/rfc5617</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5863">[RFC5863]</dt>
      <dd>
<span class="refAuthor">Hansen, T.</span><span class="refAuthor">, Siegel, E.</span><span class="refAuthor">, Hallam-Baker, P.</span><span class="refAuthor">, and D. Crocker</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) Development, Deployment, and Operations"</span>, <span class="seriesInfo">RFC 5863</span>, <span class="seriesInfo">DOI 10.17487/RFC5863</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5863">https://www.rfc-editor.org/info/rfc5863</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6377">[RFC6377]</dt>
      <dd>
<span class="refAuthor">Kucherawy, M.</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) and Mailing Lists"</span>, <span class="seriesInfo">BCP 167</span>, <span class="seriesInfo">RFC 6377</span>, <span class="seriesInfo">DOI 10.17487/RFC6377</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6377">https://www.rfc-editor.org/info/rfc6377</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8601">[RFC8601]</dt>
    <dd>
<span class="refAuthor">Kucherawy, M.</span>, <span class="refTitle">"Message Header Field for Indicating Message Authentication Status"</span>, <span class="seriesInfo">RFC 8601</span>, <span class="seriesInfo">DOI 10.17487/RFC8601</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8601">https://www.rfc-editor.org/info/rfc8601</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="technology-considerations">
<section id="section-appendix.a">
      <h2 id="name-technology-considerations">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-technology-considerations" class="section-name selfRef">Technology Considerations</a>
      </h2>
<p id="section-appendix.a-1">This section documents some design decisions that were made in the
development of DMARC.  Specifically, addressed here are some
suggestions that were considered but not included in the design.
This text is included to explain why they were considered and not
included in this version.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<div id="s-mime">
<section id="section-a.1">
        <h2 id="name-s-mime">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-s-mime" class="section-name selfRef">S/MIME</a>
        </h2>
<p id="section-a.1-1">S/MIME, or Secure Multipurpose Internet Mail Extensions, is a
standard for encryption and signing of MIME data in a message.  This
was suggested and considered as a third security protocol for
authenticating the source of a message.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<p id="section-a.1-2">DMARC is focused on authentication at the domain level (i.e., the
Domain Owner taking responsibility for the message), while S/MIME is
really intended for user-to-user authentication and encryption.  This
alone appears to make it a bad fit for DMARC's goals.<a href="#section-a.1-2" class="pilcrow">¶</a></p>
<p id="section-a.1-3">S/MIME also suffers from the heavyweight problem of Public Key
Infrastructure, which means that distribution of keys used to verify
signatures needs to be incorporated.  In many instances, this alone
is a showstopper.  There have been consistent promises that PKI
usability and deployment will improve, but these have yet to
materialize.  DMARC can revisit this choice after those barriers are
addressed.<a href="#section-a.1-3" class="pilcrow">¶</a></p>
<p id="section-a.1-4">S/MIME has extensive deployment in specific market segments
(government, for example) but does not enjoy similar widespread
deployment over the general Internet, and this shows no signs of
changing.  DKIM and SPF both are deployed widely over the general
Internet, and their adoption rates continue to be positive.<a href="#section-a.1-4" class="pilcrow">¶</a></p>
<p id="section-a.1-5">Finally, experiments have shown that including S/MIME support in the
initial version of DMARC would neither cause nor enable a substantial
increase in the accuracy of the overall mechanism.<a href="#section-a.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-exclusion">
<section id="section-a.2">
        <h2 id="name-method-exclusion">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-method-exclusion" class="section-name selfRef">Method Exclusion</a>
        </h2>
<p id="section-a.2-1">It was suggested that DMARC include a mechanism by which a Domain
Owner could tell Message Receivers not to attempt validation by one
of the supported methods (e.g., "check DKIM, but not SPF").<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<p id="section-a.2-2">Specifically, consider a Domain Owner that has deployed one of the
technologies, and that technology fails for some messages, but such
failures don't cause enforcement action.  Deploying DMARC would cause
enforcement action for policies other than "none", which would appear
to exclude participation by that Domain Owner.<a href="#section-a.2-2" class="pilcrow">¶</a></p>
<p id="section-a.2-3">The DMARC development team evaluated the idea of policy exception
mechanisms on several occasions and invariably concluded that there
was not a strong enough use case to include them.  The specific
target audience for DMARC does not appear to have concerns about the
failure modes of one or the other being a barrier to DMARC's
adoption.<a href="#section-a.2-3" class="pilcrow">¶</a></p>
<p id="section-a.2-4">In the scenario described above, the Domain Owner has a few options:<a href="#section-a.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-a.2-5">
<li id="section-a.2-5.1">
            <p id="section-a.2-5.1.1">Tighten up its infrastructure to minimize the failure modes of
the single deployed technology.<a href="#section-a.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.2-5.2">
            <p id="section-a.2-5.2.1">Deploy the other supported authentication mechanism, to offset
the failure modes of the first.<a href="#section-a.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.2-5.3">
            <p id="section-a.2-5.3.1">Deploy DMARC in a reporting-only mode.<a href="#section-a.2-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="sender-header-field">
<section id="section-a.3">
        <h2 id="name-sender-header-field">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-sender-header-field" class="section-name selfRef">Sender Header Field</a>
        </h2>
<p id="section-a.3-1">It has been suggested in several message authentication efforts that
the Sender header field be checked for an identifier of interest, as
the standards indicate this as the proper way to indicate a
re-mailing of content such as through a mailing list.  Most recently,
it was a protocol-level option for DomainKeys, but on evolution to
DKIM, this property was removed.<a href="#section-a.3-1" class="pilcrow">¶</a></p>
<p id="section-a.3-2">The DMARC development team considered this and decided not to include
support for doing so, for the following reasons:<a href="#section-a.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-a.3-3">
<li id="section-a.3-3.1">
            <p id="section-a.3-3.1.1">The main user protection approach is to be concerned with what
the user sees when a message is rendered.  There is no consistent
behavior among MUAs regarding what to do with the content of the
Sender field, if present.  Accordingly, supporting checking of
the Sender identifier would mean applying policy to an identifier
the end user might never actually see, which can create a vector
for attack against end users by simply forging a Sender field
containing some identifier that DMARC will like.<a href="#section-a.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.3-3.2">
            <p id="section-a.3-3.2.1">Although it is certainly true that this is what the Sender field
is for, its use in this way is also unreliable, making it a poor
candidate for inclusion in the DMARC evaluation algorithm.<a href="#section-a.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.3-3.3">
            <p id="section-a.3-3.3.1">Allowing multiple ways to discover policy introduces unacceptable
ambiguity into the DMARC evaluation algorithm in terms of which
policy is to be applied and when.<a href="#section-a.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="domain-existence-test">
<section id="section-a.4">
        <h2 id="name-domain-existence-test">
<a href="#section-a.4" class="section-number selfRef">A.4. </a><a href="#name-domain-existence-test" class="section-name selfRef">Domain Existence Test</a>
        </h2>
<p id="section-a.4-1">A common practice among MTA operators, and indeed one documented in
<span>[<a href="#RFC5617" class="xref">RFC5617</a>]</span>, is a test to determine domain existence prior to any more
expensive processing.  This is typically done by querying the DNS for
MX, A, or AAAA resource records for the name being evaluated and
assuming that the domain is nonexistent if it could be determined
that no such records were published for that domain name.<a href="#section-a.4-1" class="pilcrow">¶</a></p>
<p id="section-a.4-2">The original pre-standardization version of this protocol included a
mandatory check of this nature.  It was ultimately removed, as the
method's error rate was too high without substantial manual tuning
and heuristic work.  There are indeed use cases this work needs to
address where such a method would return a negative result about a
domain for which reporting is desired, such as a registered domain
name that never sends legitimate mail and thus has none of these
records present in the DNS.<a href="#section-a.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issues-with-adsp-in-operation">
<section id="section-a.5">
        <h2 id="name-issues-with-adsp-in-operati">
<a href="#section-a.5" class="section-number selfRef">A.5. </a><a href="#name-issues-with-adsp-in-operati" class="section-name selfRef">Issues with ADSP in Operation</a>
        </h2>
<p id="section-a.5-1">DMARC has been characterized as a "super-ADSP" of sorts.<a href="#section-a.5-1" class="pilcrow">¶</a></p>
<p id="section-a.5-2">Contributors to DMARC have compiled a list of issues associated with
ADSP, gained from operational experience, that have influenced the
direction of DMARC:<a href="#section-a.5-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-a.5-3">
<li id="section-a.5-3.1">
            <p id="section-a.5-3.1.1">ADSP has no support for subdomains, i.e., the ADSP record for
example.com does not explicitly or implicitly apply to
subdomain.example.com.  If wildcarding is not applied, then
spammers can trivially bypass ADSP by sending from a subdomain
with no ADSP record.<a href="#section-a.5-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.5-3.2">
            <p id="section-a.5-3.2.1">Nonexistent subdomains are explicitly out of scope in ADSP.
There is nothing in ADSP that states receivers should simply
reject mail from NXDOMAINs regardless of ADSP policy (which of
course allows spammers to trivially bypass ADSP by sending email
from nonexistent subdomains).<a href="#section-a.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.5-3.3">
            <p id="section-a.5-3.3.1">ADSP has no operational advice on when to look up the ADSP
record.<a href="#section-a.5-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.5-3.4">
            <p id="section-a.5-3.4.1">ADSP has no support for using SPF as an auxiliary mechanism to
DKIM.<a href="#section-a.5-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.5-3.5">
            <p id="section-a.5-3.5.1">ADSP has no support for a slow rollout, i.e., no way to configure
a percentage of email on which the receiver should apply the
policy.  This is important for large-volume senders.<a href="#section-a.5-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.5-3.6">
            <p id="section-a.5-3.6.1">ADSP has no explicit support for an intermediate phase where the
receiver quarantines (e.g., sends to the recipient's "spam"
folder) rather than rejects the email.<a href="#section-a.5-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-a.5-3.7">
            <p id="section-a.5-3.7.1">The binding between the "From" header domain and DKIM is too
tight for ADSP; they must match exactly.<a href="#section-a.5-3.7.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="organizational-domain-discovery-issues">
<section id="section-a.6">
        <h2 id="name-organizational-domain-disco">
<a href="#section-a.6" class="section-number selfRef">A.6. </a><a href="#name-organizational-domain-disco" class="section-name selfRef">Organizational Domain Discovery Issues</a>
        </h2>
<p id="section-a.6-1">Although protocols like ADSP are useful for "protecting" a specific
domain name, they are not helpful at protecting subdomains.  If one
wished to protect "example.com" by requiring via ADSP that all mail
bearing an RFC5322.From domain of "example.com" be signed, this would
"protect" that domain; however, one could then craft an email whose
RFC5322.From domain is "security.example.com", and ADSP would not
provide any protection.  One could use a DNS wildcard, but this can
undesirably interfere with other DNS activity; one could add ADSP
records as fraudulent domains are discovered, but this solution does
not scale and is a purely reactive measure against abuse.<a href="#section-a.6-1" class="pilcrow">¶</a></p>
<p id="section-a.6-2">The DNS does not provide a method by which the "domain of record", or
the domain that was actually registered with a domain registrar, can
be determined given an arbitrary domain name.  Suggestions have been
made that attempt to glean such information from SOA or NS resource
records, but these too are not fully reliable, as the partitioning of
the DNS is not always done at administrative boundaries.<a href="#section-a.6-2" class="pilcrow">¶</a></p>
<p id="section-a.6-3">When seeking domain-specific policy based on an arbitrary domain
name, one could "climb the tree", dropping labels off the left end of
the name until the root is reached or a policy is discovered, but
then one could craft a name that has a large number of nonsense
labels; this would cause a Mail Receiver to attempt a large number of
queries in search of a policy record.  Sending many such messages
constitutes an amplified denial-of-service attack.<a href="#section-a.6-3" class="pilcrow">¶</a></p>
<p id="section-a.6-4">The Organizational Domain mechanism is a necessary component to the
goals of DMARC.  The method described in <a href="#organizational-domain" class="xref">Section 3.2</a> is far from
perfect but serves this purpose reasonably well without adding undue
burden or semantics to the DNS.  If a method is created to do so that
is more reliable and secure than the use of a public suffix list,
DMARC should be amended to use that method as soon as it is generally
available.<a href="#section-a.6-4" class="pilcrow">¶</a></p>
<div id="public-suffix-lists">
<section id="section-a.6.1">
          <h3 id="name-public-suffix-lists">
<a href="#section-a.6.1" class="section-number selfRef">A.6.1. </a><a href="#name-public-suffix-lists" class="section-name selfRef">Public Suffix Lists</a>
          </h3>
<p id="section-a.6.1-1">A public suffix list for the purposes of determining the
Organizational Domain can be obtained from various sources.  The most
common one is maintained by the Mozilla Foundation and made public at
<a href="http://publicsuffix.org">http://publicsuffix.org</a>.  License terms governing the use of that
list are available at that URI.<a href="#section-a.6.1-1" class="pilcrow">¶</a></p>
<p id="section-a.6.1-2">Note that if operators use a variety of public suffix lists,
interoperability will be difficult or impossible to guarantee.<a href="#section-a.6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-appendix.b">
      <h2 id="name-examples">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="section-appendix.b-1">This section illustrates both the Domain Owner side and the Mail
Receiver side of a DMARC exchange.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<div id="identifier-alignment-examples">
<section id="section-b.1">
        <h2 id="name-identifier-alignment-exampl">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-identifier-alignment-exampl" class="section-name selfRef">Identifier Alignment Examples</a>
        </h2>
<p id="section-b.1-1">The following examples illustrate the DMARC mechanism's use of
Identifier Alignment.  For brevity's sake, only message headers are
shown, as message bodies are not considered when conducting DMARC
checks.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<div id="spf">
<section id="section-b.1.1">
          <h3 id="name-spf">
<a href="#section-b.1.1" class="section-number selfRef">B.1.1. </a><a href="#name-spf" class="section-name selfRef">SPF</a>
          </h3>
<p id="section-b.1.1-1">The following SPF examples assume that SPF produces a passing result.<a href="#section-b.1.1-1" class="pilcrow">¶</a></p>
<p id="section-b.1.1-2">Example 1: SPF in alignment:<a href="#section-b.1.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.1-3">
<pre>     MAIL FROM: &lt;sender@example.com&gt;

     From: sender@example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#section-b.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-b.1.1-4">In this case, the RFC5321.MailFrom parameter and the RFC5322.From
field have identical DNS domains.  Thus, the identifiers are in
alignment.<a href="#section-b.1.1-4" class="pilcrow">¶</a></p>
<p id="section-b.1.1-5">Example 2: SPF in alignment (parent):<a href="#section-b.1.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.1-6">
<pre>     MAIL FROM: &lt;sender@child.example.com&gt;

     From: sender@example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#section-b.1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-b.1.1-7">In this case, the RFC5322.From parameter includes a DNS domain that
is a parent of the RFC5321.MailFrom domain.  Thus, the identifiers
are in alignment if relaxed SPF mode is requested by the Domain
Owner, and not in alignment if strict SPF mode is requested.<a href="#section-b.1.1-7" class="pilcrow">¶</a></p>
<p id="section-b.1.1-8">Example 3: SPF not in alignment:<a href="#section-b.1.1-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.1-9">
<pre>     MAIL FROM: &lt;sender@example.net&gt;

     From: sender@child.example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#section-b.1.1-9" class="pilcrow">¶</a>
</div>
<p id="section-b.1.1-10">In this case, the RFC5321.MailFrom parameter includes a DNS domain
that is neither the same as nor a parent of the RFC5322.From domain.
Thus, the identifiers are not in alignment.<a href="#section-b.1.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dkim">
<section id="section-b.1.2">
          <h3 id="name-dkim">
<a href="#section-b.1.2" class="section-number selfRef">B.1.2. </a><a href="#name-dkim" class="section-name selfRef">DKIM</a>
          </h3>
<p id="section-b.1.2-1">The examples below assume that the DKIM signatures pass verification.
Alignment cannot exist with a DKIM signature that does not verify.<a href="#section-b.1.2-1" class="pilcrow">¶</a></p>
<p id="section-b.1.2-2">Example 1: DKIM in alignment:<a href="#section-b.1.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.2-3">
<pre>     DKIM-Signature: v=1; ...; d=example.com; ...
     From: sender@example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#section-b.1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-b.1.2-4">In this case, the DKIM "d=" parameter and the RFC5322.From field have
identical DNS domains.  Thus, the identifiers are in alignment.<a href="#section-b.1.2-4" class="pilcrow">¶</a></p>
<p id="section-b.1.2-5">Example 2: DKIM in alignment (parent):<a href="#section-b.1.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.2-6">
<pre>     DKIM-Signature: v=1; ...; d=example.com; ...
     From: sender@child.example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#section-b.1.2-6" class="pilcrow">¶</a>
</div>
<p id="section-b.1.2-7">In this case, the DKIM signature's "d=" parameter includes a DNS
domain that is a parent of the RFC5322.From domain.  Thus, the
identifiers are in alignment for relaxed mode, but not for strict
mode.<a href="#section-b.1.2-7" class="pilcrow">¶</a></p>
<p id="section-b.1.2-8">Example 3: DKIM not in alignment:<a href="#section-b.1.2-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.2-9">
<pre>     DKIM-Signature: v=1; ...; d=sample.net; ...
     From: sender@child.example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#section-b.1.2-9" class="pilcrow">¶</a>
</div>
<p id="section-b.1.2-10">In this case, the DKIM signature's "d=" parameter includes a DNS
domain that is neither the same as nor a parent of the RFC5322.From
domain.  Thus, the identifiers are not in alignment.<a href="#section-b.1.2-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="domain-owner-example">
<section id="section-b.2">
        <h2 id="name-domain-owner-example">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-domain-owner-example" class="section-name selfRef">Domain Owner Example</a>
        </h2>
<p id="section-b.2-1">A Domain Owner that wants to use DMARC should have already deployed
and tested SPF and DKIM.  The next step is to publish a DNS record
that advertises a DMARC policy for the Domain Owner's Organizational
Domain.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
<div id="entire-domain-monitoring-only">
<section id="section-b.2.1">
          <h3 id="name-entire-domain-monitoring-on">
<a href="#section-b.2.1" class="section-number selfRef">B.2.1. </a><a href="#name-entire-domain-monitoring-on" class="section-name selfRef">Entire Domain, Monitoring Only</a>
          </h3>
<p id="section-b.2.1-1">The owner of the domain "example.com" has deployed SPF and DKIM on
its messaging infrastructure.  The owner wishes to begin using DMARC
with a policy that will solicit aggregate feedback from receivers
without affecting how the messages are processed, in order to:<a href="#section-b.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2.1-2.1">
              <p id="section-b.2.1-2.1.1">Confirm that its legitimate messages are authenticating correctly<a href="#section-b.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-b.2.1-2.2">
              <p id="section-b.2.1-2.2.1">Verify that all authorized message sources have implemented
authentication measures<a href="#section-b.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-b.2.1-2.3">
              <p id="section-b.2.1-2.3.1">Determine how many messages from other sources would be affected
by a blocking policy<a href="#section-b.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-b.2.1-3">The Domain Owner accomplishes this by constructing a policy record
indicating that:<a href="#section-b.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2.1-4.1">
              <p id="section-b.2.1-4.1.1">The version of DMARC being used is "DMARC1" ("v=DMARC1;")<a href="#section-b.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-b.2.1-4.2">
              <p id="section-b.2.1-4.2.1">Receivers should not alter how they treat these messages because
of this DMARC policy record ("p=none")<a href="#section-b.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-b.2.1-4.3">
              <p id="section-b.2.1-4.3.1">Aggregate feedback reports should be sent via email to the address
"dmarc-feedback@example.com"
("rua=mailto:dmarc-feedback@example.com")<a href="#section-b.2.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-b.2.1-4.4">
              <p id="section-b.2.1-4.4.1">All messages from this Organizational Domain are subject to this
policy (no "pct" tag present, so the default of 100% applies)<a href="#section-b.2.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-b.2.1-5">The DMARC policy record might look like this when retrieved using a
common command-line tool:<a href="#section-b.2.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.1-6">
<pre>  % dig +short TXT _dmarc.example.com.
  "v=DMARC1; p=none; rua=mailto:dmarc-feedback@example.com"
</pre><a href="#section-b.2.1-6" class="pilcrow">¶</a>
</div>
<p id="section-b.2.1-7">To publish such a record, the DNS administrator for the Domain Owner
creates an entry like the following in the appropriate zone file
(following the conventional zone file format):<a href="#section-b.2.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.1-8">
<pre>  ; DMARC record for the domain example.com

  _dmarc  IN TXT ( "v=DMARC1; p=none; "
                   "rua=mailto:dmarc-feedback@example.com" )
</pre><a href="#section-b.2.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="entire-domain-monitoring-only-per-message-reports">
<section id="section-b.2.2">
          <h3 id="name-entire-domain-monitoring-onl">
<a href="#section-b.2.2" class="section-number selfRef">B.2.2. </a><a href="#name-entire-domain-monitoring-onl" class="section-name selfRef">Entire Domain, Monitoring Only, Per-Message Reports</a>
          </h3>
<p id="section-b.2.2-1">The Domain Owner from the previous example has used the aggregate
reporting to discover some messaging systems that had not yet
implemented DKIM correctly, but they are still seeing periodic
authentication failures.  In order to diagnose these intermittent
problems, they wish to request per-message failure reports when
authentication failures occur.<a href="#section-b.2.2-1" class="pilcrow">¶</a></p>
<p id="section-b.2.2-2">Not all Receivers will honor such a request, but the Domain Owner
feels that any reports it does receive will be helpful enough to
justify publishing this record.  The default per-message report
format (<span>[<a href="#RFC6591" class="xref">RFC6591</a>]</span>) meets the Domain Owner's needs in this scenario.<a href="#section-b.2.2-2" class="pilcrow">¶</a></p>
<p id="section-b.2.2-3">The Domain Owner accomplishes this by adding the following to its
policy record from <a href="#domain-owner-example" class="xref">Appendix B.2</a>:<a href="#section-b.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2.2-4.1">Per-message failure reports should be sent via email to the
address "auth-reports@example.com"
("ruf=mailto:auth-reports@example.com")<a href="#section-b.2.2-4.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-b.2.2-5">The DMARC policy record might look like this when retrieved using a
common command-line tool (the output shown would appear on a single
line but is wrapped here for publication):<a href="#section-b.2.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.2-6">
<pre>  % dig +short TXT _dmarc.example.com.
  "v=DMARC1; p=none; rua=mailto:dmarc-feedback@example.com;
   ruf=mailto:auth-reports@example.com"
</pre><a href="#section-b.2.2-6" class="pilcrow">¶</a>
</div>
<p id="section-b.2.2-7">To publish such a record, the DNS administrator for the Domain Owner
might create an entry like the following in the appropriate zone file
(following the conventional zone file format):<a href="#section-b.2.2-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.2-8">
<pre>  ; DMARC record for the domain example.com

  _dmarc  IN TXT ( "v=DMARC1; p=none; "
                    "rua=mailto:dmarc-feedback@example.com; "
                    "ruf=mailto:auth-reports@example.com" )
</pre><a href="#section-b.2.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="per-message-failure-reports-directed-to-third-party">
<section id="section-b.2.3">
          <h3 id="name-per-message-failure-reports">
<a href="#section-b.2.3" class="section-number selfRef">B.2.3. </a><a href="#name-per-message-failure-reports" class="section-name selfRef">Per-Message Failure Reports Directed to Third Party</a>
          </h3>
<p id="section-b.2.3-1">The Domain Owner from the previous example is maintaining the same
policy but now wishes to have a third party receive and process the
per-message failure reports.  Again, not all Receivers will honor
this request, but those that do may implement additional checks to
validate that the third party wishes to receive the failure reports
for this domain.<a href="#section-b.2.3-1" class="pilcrow">¶</a></p>
<p id="section-b.2.3-2">The Domain Owner needs to alter its policy record from <a href="#entire-domain-monitoring-only-per-message-reports" class="xref">Appendix B.2.2</a>
as follows:<a href="#section-b.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2.3-3.1">Per-message failure reports should be sent via email to the
address "auth-reports@thirdparty.example.net"
("ruf=mailto:auth-reports@thirdparty.example.net")<a href="#section-b.2.3-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-b.2.3-4">The DMARC policy record might look like this when retrieved using a
common command-line tool (the output shown would appear on a single
line but is wrapped here for publication):<a href="#section-b.2.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.3-5">
<pre>  % dig +short TXT _dmarc.example.com.
  "v=DMARC1; p=none; rua=mailto:dmarc-feedback@example.com;
   ruf=mailto:auth-reports@thirdparty.example.net"
</pre><a href="#section-b.2.3-5" class="pilcrow">¶</a>
</div>
<p id="section-b.2.3-6">To publish such a record, the DNS administrator for the Domain Owner
might create an entry like the following in the appropriate zone file
(following the conventional zone file format):<a href="#section-b.2.3-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.3-7">
<pre>  ; DMARC record for the domain example.com

  _dmarc IN TXT ( "v=DMARC1; p=none; "
                  "rua=mailto:dmarc-feedback@example.com; "
                  "ruf=mailto:auth-reports@thirdparty.example.net" )
</pre><a href="#section-b.2.3-7" class="pilcrow">¶</a>
</div>
<p id="section-b.2.3-8">Because the address used in the "ruf" tag is outside the
Organizational Domain in which this record is published, conforming
Receivers will implement additional checks as described in
the DMARC reporting documents.  In order to pass these additional
checks, the third party will need to publish an additional DNS record
as follows:<a href="#section-b.2.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2.3-9.1">Given the DMARC record published by the Domain Owner at
"_dmarc.example.com", the DNS administrator for the third party
will need to publish a TXT resource record at
"example.com._report._dmarc.thirdparty.example.net" with the value
"v=DMARC1;".<a href="#section-b.2.3-9.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-b.2.3-10">The resulting DNS record might look like this when retrieved using a
common command-line tool (the output shown would appear on a single
line but is wrapped here for publication):<a href="#section-b.2.3-10" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.3-11">
<pre>  % dig +short TXT example.com._report._dmarc.thirdparty.example.net
  "v=DMARC1;"
</pre><a href="#section-b.2.3-11" class="pilcrow">¶</a>
</div>
<p id="section-b.2.3-12">To publish such a record, the DNS administrator for example.net might
create an entry like the following in the appropriate zone file
(following the conventional zone file format):<a href="#section-b.2.3-12" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.3-13">
<pre>  ; zone file for thirdparty.example.net
  ; Accept DMARC failure reports on behalf of example.com

  example.com._report._dmarc   IN   TXT    "v=DMARC1;"
</pre><a href="#section-b.2.3-13" class="pilcrow">¶</a>
</div>
<p id="section-b.2.3-14">Intermediaries and other third parties should refer to the DMARC reporting documents
for the full details of this mechanism.<a href="#section-b.2.3-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subdomain-sampling-and-multiple-aggregate-report-uris">
<section id="section-b.2.4">
          <h3 id="name-subdomain-sampling-and-mult">
<a href="#section-b.2.4" class="section-number selfRef">B.2.4. </a><a href="#name-subdomain-sampling-and-mult" class="section-name selfRef">Subdomain, Sampling, and Multiple Aggregate Report URIs</a>
          </h3>
<p id="section-b.2.4-1">The Domain Owner has implemented SPF and DKIM in a subdomain used for
pre-production testing of messaging services.  It now wishes to
request that participating receivers act to reject messages from this
subdomain that fail to authenticate.<a href="#section-b.2.4-1" class="pilcrow">¶</a></p>
<p id="section-b.2.4-2">As a first step, it will ask that a portion (1/4 in this example) of
failing messages be quarantined, enabling examination of messages
sent to mailboxes hosted by participating receivers.  Aggregate
feedback reports will be sent to a mailbox within the Organizational
Domain, and to a mailbox at a third party selected and authorized to
receive same by the Domain Owner.  Aggregate reports sent to the
third party are limited to a maximum size of ten megabytes.<a href="#section-b.2.4-2" class="pilcrow">¶</a></p>
<p id="section-b.2.4-3">The Domain Owner will accomplish this by constructing a policy record
indicating that:<a href="#section-b.2.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2.4-4.1">
              <p id="section-b.2.4-4.1.1">The version of DMARC being used is "DMARC1" ("v=DMARC1;")<a href="#section-b.2.4-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-b.2.4-4.2">
              <p id="section-b.2.4-4.2.1">It is applied only to this subdomain (record is published at
"_dmarc.test.example.com" and not "_dmarc.example.com")<a href="#section-b.2.4-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-b.2.4-4.3">
              <p id="section-b.2.4-4.3.1">Receivers should quarantine messages from this Organizational
Domain that fail to authenticate ("p=quarantine")<a href="#section-b.2.4-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-b.2.4-4.4">
              <p id="section-b.2.4-4.4.1">Aggregate feedback reports should be sent via email to the
addresses "dmarc-feedback@example.com" and
"example-tld-test@thirdparty.example.net", with the latter
subjected to a maximum size limit ("rua=mailto:dmarc-feedback@
example.com,mailto:tld-test@thirdparty.example.net!10m")<a href="#section-b.2.4-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-b.2.4-4.5">
              <p id="section-b.2.4-4.5.1">25% of messages from this Organizational Domain are subject to
action based on this policy ("pct=25")<a href="#section-b.2.4-4.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-b.2.4-5">The DMARC policy record might look like this when retrieved using a
common command-line tool (the output shown would appear on a single
line but is wrapped here for publication):<a href="#section-b.2.4-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.4-6">
<pre>  % dig +short TXT _dmarc.test.example.com
  "v=DMARC1; p=quarantine; rua=mailto:dmarc-feedback@example.com,
   mailto:tld-test@thirdparty.example.net!10m; pct=25"
</pre><a href="#section-b.2.4-6" class="pilcrow">¶</a>
</div>
<p id="section-b.2.4-7">To publish such a record, the DNS administrator for the Domain Owner
might create an entry like the following in the appropriate zone
file:<a href="#section-b.2.4-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.4-8">
<pre>  ; DMARC record for the domain example.com

  _dmarc IN  TXT  ( "v=DMARC1; p=quarantine; "
                    "rua=mailto:dmarc-feedback@example.com,"
                    "mailto:tld-test@thirdparty.example.net!10m; "
                    "pct=25" )
</pre><a href="#section-b.2.4-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="mail-receiver-example">
<section id="section-b.3">
        <h2 id="name-mail-receiver-example">
<a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-mail-receiver-example" class="section-name selfRef">Mail Receiver Example</a>
        </h2>
<p id="section-b.3-1">A Mail Receiver that wants to use DMARC should already be checking
SPF and DKIM, and possess the ability to collect relevant information
from various email-processing stages to provide feedback to Domain
Owners (possibly via Report Receivers).<a href="#section-b.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-of-smtp-time">
<section id="section-b.4">
        <h2 id="name-processing-of-smtp-time">
<a href="#section-b.4" class="section-number selfRef">B.4. </a><a href="#name-processing-of-smtp-time" class="section-name selfRef">Processing of SMTP Time</a>
        </h2>
<p id="section-b.4-1">An optimal DMARC-enabled Mail Receiver performs authentication and
Identifier Alignment checking during the <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span> conversation.<a href="#section-b.4-1" class="pilcrow">¶</a></p>
<p id="section-b.4-2">Prior to returning a final reply to the DATA command, the Mail
Receiver's MTA has performed:<a href="#section-b.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-b.4-3">
<li id="section-b.4-3.1">
            <p id="section-b.4-3.1.1">An SPF check to determine an SPF-authenticated Identifier.<a href="#section-b.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-b.4-3.2">
            <p id="section-b.4-3.2.1">DKIM checks that yield one or more DKIM-authenticated
Identifiers.<a href="#section-b.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-b.4-3.3">
            <p id="section-b.4-3.3.1">A DMARC policy lookup.<a href="#section-b.4-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-b.4-4">The presence of an Author Domain DMARC record indicates that the Mail
Receiver should continue with DMARC-specific processing before
returning a reply to the DATA command.<a href="#section-b.4-4" class="pilcrow">¶</a></p>
<p id="section-b.4-5">Given a DMARC record and the set of Authenticated Identifiers, the
Mail Receiver checks to see if the Authenticated Identifiers align
with the Author Domain (taking into consideration any strict versus
relaxed options found in the DMARC record).<a href="#section-b.4-5" class="pilcrow">¶</a></p>
<p id="section-b.4-6">For example, the following sample data is considered to be from a
piece of email originating from the Domain Owner of "example.com":<a href="#section-b.4-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.4-7">
<pre>  Author Domain: example.com
  SPF-authenticated Identifier: mail.example.com
  DKIM-authenticated Identifier: example.com
  DMARC record:
    "v=DMARC1; p=reject; aspf=r;
     rua=mailto:dmarc-feedback@example.com"
</pre><a href="#section-b.4-7" class="pilcrow">¶</a>
</div>
<p id="section-b.4-8">In the above sample, both the SPF-authenticated Identifier and the
DKIM-authenticated Identifier align with the Author Domain.  The Mail
Receiver considers the above email to pass the DMARC check, avoiding
the "reject" policy that is to be applied to email that fails to pass
the DMARC check.<a href="#section-b.4-8" class="pilcrow">¶</a></p>
<p id="section-b.4-9">If no Authenticated Identifiers align with the Author Domain, then
the Mail Receiver applies the DMARC-record-specified policy.
However, before this action is taken, the Mail Receiver can consult
external information to override the Domain Owner's policy.  For
example, if the Mail Receiver knows that this particular email came
from a known and trusted forwarder (that happens to break both SPF
and DKIM), then the Mail Receiver may choose to ignore the Domain
Owner's policy.<a href="#section-b.4-9" class="pilcrow">¶</a></p>
<p id="section-b.4-10">The Mail Receiver is now ready to reply to the DATA command.  If the
DMARC check yields that the message is to be rejected, then the Mail
Receiver replies with a 5xy code to inform the sender of failure.  If
the DMARC check cannot be resolved due to transient network errors,
then the Mail Receiver replies with a 4xy code to inform the sender
as to the need to reattempt delivery later.  If the DMARC check
yields a passing message, then the Mail Receiver continues on with
email processing, perhaps using the result of the DMARC check as an
input to additional processing modules such as a domain reputation
query.<a href="#section-b.4-10" class="pilcrow">¶</a></p>
<p id="section-b.4-11">Before exiting DMARC-specific processing, the Mail Receiver checks to
see if the Author Domain DMARC record requests AFRF-based reporting.
If so, then the Mail Receiver can emit an AFRF to the reporting
address supplied in the DMARC record.<a href="#section-b.4-11" class="pilcrow">¶</a></p>
<p id="section-b.4-12">At the exit of DMARC-specific processing, the Mail Receiver captures
(through logging or direct insertion into a data store) the result of
DMARC processing.  Captured information is used to build feedback for
Domain Owner consumption.  This is not necessary if the Domain Owner
has not requested aggregate reports, i.e., no "rua" tag was found in
the policy record.<a href="#section-b.4-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="utilization-of-aggregate-feedback-example">
<section id="section-b.5">
        <h2 id="name-utilization-of-aggregate-fe">
<a href="#section-b.5" class="section-number selfRef">B.5. </a><a href="#name-utilization-of-aggregate-fe" class="section-name selfRef">Utilization of Aggregate Feedback: Example</a>
        </h2>
<p id="section-b.5-1">Aggregate feedback is consumed by Domain Owners to verify a Domain
Owner's understanding of how the Domain Owner's domain is being
processed by the Mail Receiver.  Aggregate reporting data on emails
that pass all DMARC-supporting authentication checks is used by
Domain Owners to verify that authentication practices remain
accurate.  For example, if a third party is sending on behalf of a
Domain Owner, the Domain Owner can use aggregate report data to
verify ongoing authentication practices of the third party.<a href="#section-b.5-1" class="pilcrow">¶</a></p>
<p id="section-b.5-2">Data on email that only partially passes underlying authentication
checks provides visibility into problems that need to be addressed by
the Domain Owner.  For example, if either SPF or DKIM fails to pass,
the Domain Owner is provided with enough information to either
directly correct the problem or understand where authentication-
breaking changes are being introduced in the email transmission path.
If authentication-breaking changes due to email transmission path
cannot be directly corrected, then the Domain Owner at least
maintains an understanding of the effect of DMARC-based policies upon
the Domain Owner's email.<a href="#section-b.5-2" class="pilcrow">¶</a></p>
<p id="section-b.5-3">Data on email that fails all underlying authentication checks
provides baseline visibility on how the Domain Owner's domain is
being received at the Mail Receiver.  Based on this visibility, the
Domain Owner can begin deployment of authentication technologies
across uncovered email sources.  Additionally, the Domain Owner may
come to an understanding of how its domain is being misused.<a href="#section-b.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mailto-transport-example">
<section id="section-b.6">
        <h2 id="name-mailto-transport-example">
<a href="#section-b.6" class="section-number selfRef">B.6. </a><a href="#name-mailto-transport-example" class="section-name selfRef">mailto Transport Example</a>
        </h2>
<p id="section-b.6-1">A DMARC record can contain a "mailto" reporting address, such as:<a href="#section-b.6-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.6-2">
<pre>mailto:dmarc-feedback@example.com
</pre><a href="#section-b.6-2" class="pilcrow">¶</a>
</div>
<p id="section-b.6-3">A sample aggregate report from the Mail Receiver at
mail.receiver.example follows:<a href="#section-b.6-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.6-4">
<pre>  DKIM-Signature: v=1; ...; d=mail.receiver.example; ...
  From: dmarc-reporting@mail.receiver.example
  Date: Fri, Feb 15 2002 16:54:30 -0800
  To: dmarc-feedback@example.com
  Subject: Report Domain: example.com
      Submitter: mail.receiver.example
      Report-ID: &lt;2002.02.15.1&gt;
  MIME-Version: 1.0
  Content-Type: multipart/alternative;
      boundary="----=_NextPart_000_024E_01CC9B0A.AFE54C00"
  Content-Language: en-us

  This is a multipart message in MIME format.

  ------=_NextPart_000_024E_01CC9B0A.AFE54C00
  Content-Type: text/plain; charset="us-ascii"
  Content-Transfer-Encoding: 7bit

  This is an aggregate report from mail.receiver.example.

  ------=_NextPart_000_024E_01CC9B0A.AFE54C00
  Content-Type: application/gzip
  Content-Transfer-Encoding: base64
  Content-Disposition: attachment;
      filename="mail.receiver.example!example.com!
                1013662812!1013749130.gz"

  &lt;gzipped content of report&gt;

  ------=_NextPart_000_024E_01CC9B0A.AFE54C00--
</pre><a href="#section-b.6-4" class="pilcrow">¶</a>
</div>
<p id="section-b.6-5">Not shown in the above example is that the Mail Receiver's feedback
should be authenticated using SPF.  Also, the value of the "filename"
MIME parameter is wrapped for printing in this specification but
would normally appear as one continuous string.<a href="#section-b.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-appendix.c">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.c-1">DMARC and the draft version of this document submitted to the
Independent Submission Editor were the result of lengthy efforts by
an informal industry consortium: DMARC.org (see <a href="http://dmarc.org">http://dmarc.org</a>).
Participating companies included Agari, American Greetings, AOL, Bank
of America, Cloudmark, Comcast, Facebook, Fidelity Investments,
Google, JPMorgan Chase &amp; Company, LinkedIn, Microsoft, Netease,
PayPal, ReturnPath, The Trusted Domain Project, and Yahoo!.  Although
the contributors and supporters are too numerous to mention, notable
individual contributions were made by J. Trent Adams, Michael Adkins,
Monica Chew, Dave Crocker, Tim Draegen, Steve Jones, Franck Martin,
Brett McDowell, and Paul Midgen.  The contributors would also like to
recognize the invaluable input and guidance that was provided early
on by J.D. Falk.<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<p id="section-appendix.c-2">Additional contributions within the IETF context were made by Kurt
Anderson, Michael Jack Assels, Les Barstow, Anne Bennett, Jim Fenton,
J. Gomez, Mike Jones, Scott Kitterman, Eliot Lear, John Levine,
S. Moonesamy, Rolf Sonneveld, Henry Timmes, and Stephen J. Turnbull.<a href="#section-appendix.c-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Emil Gustafsson</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:emgu@google.com" class="email">emgu@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Todd M. Herr</span></div>
<div dir="auto" class="left"><span class="org">Valimail</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:todd.herr@valimail.com" class="email">todd.herr@valimail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Levine</span></div>
<div dir="auto" class="left"><span class="org">Standcore LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:standards@standore.com" class="email">standards@standore.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
