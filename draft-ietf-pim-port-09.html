<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>A Reliable Transport Mechanism for PIM</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Notation">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Definitions">
<link href="#rfc.section.2" rel="Chapter" title="2 Protocol Overview">
<link href="#rfc.section.3" rel="Chapter" title="3 PIM Hello Options">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 PIM over the TCP Transport Protocol">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 PIM over the SCTP Transport Protocol">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Interface ID">
<link href="#rfc.section.4" rel="Chapter" title="4 Establishing Transport Connections">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Connection Security">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Connection Maintenance">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Actions When a Connection Goes Down">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Moving from PORT to Datagram Mode">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 On-demand versus Pre-configured Connections">
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 Possible Hello Suppression Considerations">
<link href="#rfc.section.4.7" rel="Chapter" title="4.7 Avoiding a Pair of TCP Connections between Neighbors">
<link href="#rfc.section.5" rel="Chapter" title="5 PORT Message Definitions">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 PORT Join/Prune Message">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 PORT Keep-alive Message">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 PORT Options">
<link href="#rfc.section.5.3.1" rel="Chapter" title="5.3.1 PIM IPv4 Join/Prune Option">
<link href="#rfc.section.5.3.2" rel="Chapter" title="5.3.2 PIM IPv6 Join/Prune Option">
<link href="#rfc.section.6" rel="Chapter" title="6 Explicit Tracking">
<link href="#rfc.section.7" rel="Chapter" title="7 Multiple Address-Family Support">
<link href="#rfc.section.8" rel="Chapter" title="8 Miscellany">
<link href="#rfc.section.9" rel="Chapter" title="9 Transport Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 Manageability Considerations">
<link href="#rfc.section.11" rel="Chapter" title="11 Security Considerations">
<link href="#rfc.section.12" rel="Chapter" title="12 IANA Considerations">
<link href="#rfc.section.12.1" rel="Chapter" title="12.1 PORT Port Number">
<link href="#rfc.section.12.2" rel="Chapter" title="12.2 PORT Hello Options">
<link href="#rfc.section.12.3" rel="Chapter" title="12.3 PORT Message Type Registry">
<link href="#rfc.section.12.4" rel="Chapter" title="12.4 PORT Option Type Registry">
<link href="#rfc.section.13" rel="Chapter" title="13 Contributors">
<link href="#rfc.section.14" rel="Chapter" title="14 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="15 References">
<link href="#rfc.references.1" rel="Chapter" title="15.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="15.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document defines a reliable transport mechanism for the PIM protocol for transmission of Join/Prune messages. This eliminates the need for periodic Join/Prune message transmission and processing. The reliable transport mechanism can use either TCP or SCTP as the transport protocol." />
  <meta name="description" content="This document defines a reliable transport mechanism for the PIM protocol for transmission of Join/Prune messages. This eliminates the need for periodic Join/Prune message transmission and processing. The reliable transport mechanism can use either TCP or SCTP as the transport protocol." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">D. Farinacci</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">IJ. Wijnands</td>
</tr>
<tr>
<td class="left">Intended status: Experimental Protocol</td>
<td class="right">S. Venaas</td>
</tr>
<tr>
<td class="left">Expires: April 26, 2012</td>
<td class="right">cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">M. Napierala</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">AT&amp;T Labs</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 24, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">A Reliable Transport Mechanism for PIM<br />
  <span class="filename">draft-ietf-pim-port-09.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines a reliable transport mechanism for the PIM protocol for transmission of Join/Prune messages. This eliminates the need for periodic Join/Prune message transmission and processing. The reliable transport mechanism can use either TCP or SCTP as the transport protocol.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 26, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Notation</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Definitions</a>
</li>
<li>2.   <a href="#rfc.section.2">Protocol Overview</a>
</li>
<li>3.   <a href="#rfc.section.3">PIM Hello Options</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">PIM over the TCP Transport Protocol</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">PIM over the SCTP Transport Protocol</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Interface ID</a>
</li>
<li>4.   <a href="#rfc.section.4">Establishing Transport Connections</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Connection Security</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Connection Maintenance</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Actions When a Connection Goes Down</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Moving from PORT to Datagram Mode</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">On-demand versus Pre-configured Connections</a>
</li>
<li>4.6.   <a href="#rfc.section.4.6">Possible Hello Suppression Considerations</a>
</li>
<li>4.7.   <a href="#rfc.section.4.7">Avoiding a Pair of TCP Connections between Neighbors</a>
</li>
<li>5.   <a href="#rfc.section.5">PORT Message Definitions</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">PORT Join/Prune Message</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">PORT Keep-alive Message</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">PORT Options</a>
</li>
<li>5.3.1.   <a href="#rfc.section.5.3.1">PIM IPv4 Join/Prune Option</a>
</li>
<li>5.3.2.   <a href="#rfc.section.5.3.2">PIM IPv6 Join/Prune Option</a>
</li>
<li>6.   <a href="#rfc.section.6">Explicit Tracking</a>
</li>
<li>7.   <a href="#rfc.section.7">Multiple Address-Family Support</a>
</li>
<li>8.   <a href="#rfc.section.8">Miscellany</a>
</li>
<li>9.   <a href="#rfc.section.9">Transport Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">Manageability Considerations</a>
</li>
<li>11.   <a href="#rfc.section.11">Security Considerations</a>
</li>
<li>12.   <a href="#rfc.section.12">IANA Considerations</a>
</li>
<li>12.1.   <a href="#rfc.section.12.1">PORT Port Number</a>
</li>
<li>12.2.   <a href="#rfc.section.12.2">PORT Hello Options</a>
</li>
<li>12.3.   <a href="#rfc.section.12.3">PORT Message Type Registry</a>
</li>
<li>12.4.   <a href="#rfc.section.12.4">PORT Option Type Registry</a>
</li>
<li>13.   <a href="#rfc.section.13">Contributors</a>
</li>
<li>14.   <a href="#rfc.section.14">Acknowledgments</a>
</li>
<li>15.   <a href="#rfc.references">References</a>
</li>
<li>15.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>15.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The goals of this specification are:</p>
<p></p>

<ul>
<li>To create a simple incremental mechanism to provide reliable PIM Join/Prune message delivery in PIM version 2 for use with PIM Sparse-Mode <a href="#RFC4601">[RFC4601]</a> (including Source-Specific Multicast) and Bidirectional PIM <a href="#RFC5015">[RFC5015]</a>.</li>
<li>When a router supports this specification, it need not use the reliable transport mechanism with every neighbor.  It can be negotiated on a per neighbor basis.</li>
</ul>
<p id="rfc.section.1.p.3">The explicit non-goals of this specification are:</p>
<p></p>

<ul>
<li>Changes to the PIM message formats as defined in <a href="#RFC4601">[RFC4601]</a>.</li>
<li>Provide support for automatic switching between the reliable transport mechanism and the regular PIM mechanism defined in <a href="#RFC4601">[RFC4601]</a>.  Two routers that are PIM neighbors on a link will always use the reliable transport mechanism if and only if both have enabled support for the reliable transport mechanism.</li>
</ul>
<p id="rfc.section.1.p.5">This document will specify how periodic Join/Prune message transmission can be eliminated by using TCP <a href="#RFC0793">[RFC0793]</a> or SCTP <a href="#RFC4960">[RFC4960]</a> as the reliable transport mechanism for Join/Prune messages. The destination port number is 8471 for both TCP and SCTP.</p>
<p id="rfc.section.1.p.6">This specification enables greater scalability in terms of control traffic overhead. However, for routers connected to multi-access links that comes at the price of increased PIM state and the overhead required to maintain this state.</p>
<p id="rfc.section.1.p.7">In many existing and emerging networks, particularly wireless and mobile satellite systems, link degradation due to weather, interference, and other impairments can result in temporary spikes in the packet loss. In these environments, periodic PIM joining can cause join latency when messages are lost causing a retransmission only 60 seconds later. By applying a reliable transport, a lost join is retransmitted rapidly. Furthermore, when the last user leaves a multicast group, any lost prune is similarly repaired and the multicast stream is quickly removed from the wireless/satellite link. Without a reliable transport, the multicast transmission could otherwise continue until it timed out, roughly 3 minutes later.  As network resources are at a premium in many of these environments, rapid termination of the multicast stream is critical for maintaining efficient use of bandwidth.</p>
<p id="rfc.section.1.p.8">This is an experimental extension to PIM. It makes some fundamental changes to how PIM works in that Join/Prune state does not require periodic updates, and partly turns PIM into a hard-state protocol. Also, using reliable delivery for PIM messages is a new concept, and it is likely that experiences from early implementations and deployments will lead to at least minor changes in the protocol. It should be considered making this a standards track protocol once there is some deployment experience.  Experiments using this protocol only require support by pairs of PIM neighbors, and need not be constrained to isolated networks.</p>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Notation</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#TERMS" id="TERMS">Definitions</a>
</h1>
<p></p>

<dl>
<dt>PORT: </dt>
<dd style="margin-left: 8">Stands for PIM Over Reliable Transport. Which is the short form for describing the mechanism in this specification where PIM can use the TCP or SCTP transport protocol.</dd>
<dt>Periodic Join/Prune message: </dt>
<dd style="margin-left: 8">A Join/Prune message sent periodically to refresh state.</dd>
<dt>Incremental Join/Prune message: </dt>
<dd style="margin-left: 8">A Join/Prune message sent as a result of state creation or deletion events. Also known as a triggered message.</dd>
<dt>Native Join/Prune message: </dt>
<dd style="margin-left: 8">A Join/Prune message that is carried with an IP protocol type of PIM.</dd>
<dt>PORT Join/Prune message: </dt>
<dd style="margin-left: 8">A Join/Prune message using TCP or SCTP for transport.</dd>
<dt>Datagram Mode: </dt>
<dd style="margin-left: 8">The procedures whereby PIM uses by encapsulates Join/Prune messages in IP packets sent either triggered or periodically.</dd>
<dt>PORT Mode: </dt>
<dd style="margin-left: 8">Procedures used by PIM defined in this specification for sending Join/Prune messages over the TCP or SCTP transport layer.</dd>
</dl>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Protocol Overview</h1>
<p id="rfc.section.2.p.1">PIM Over Reliable Transport (PORT) is a simple extension to PIMv2 for refresh reduction of PIM Join/Prune messages. It involves sending incremental rather than periodic Join/Prune messages over a TCP/SCTP connection between PIM neighbors.</p>
<p id="rfc.section.2.p.2">PORT only applies to PIM Sparse-Mode <a href="#RFC4601">[RFC4601]</a> and Bidirectional PIM <a href="#RFC5015">[RFC5015]</a> Join/Prune messages.</p>
<p id="rfc.section.2.p.3">This document does not restrict PORT to any specific link types.  However, the use of PORT on e.g. multi-access LANs with many PIM neighbors should be carefully evaluated. This due to the fact that there may be a full mesh of PORT connections, and that explicit tracking of all PIM PORT routers is required.</p>
<p id="rfc.section.2.p.4">PORT can be incrementally used on a link between PORT-capable neighbors. Routers that are not PORT-capable can continue to use PIM in Datagram Mode. PORT capability is detected using new PORT-Capable PIM Hello Options.</p>
<p id="rfc.section.2.p.5">Once PORT is enabled on an interface and a PIM neighbor also announces that it is PORT enabled, only PORT Join/Prune messages will be used. That is, only PORT Join/Prune messages are accepted from, and sent to, that particular neighbor. Native Join/Prune messages are still used for PIM neighbors that are not PORT enabled.</p>
<p id="rfc.section.2.p.6">PORT Join/Prune messages are sent using a TCP/SCTP connection.  When two PIM neighbors are PORT enabled, both for TCP or both for SCTP, they will immediately, or on-demand, establish a connection. If the connection goes down, they will again immediately, or on-demand, try to reestablish the connection.  No Join/Prune messages (neither Native nor PORT) are sent while there is no connection. Also, any received native Join/Prune messages from that neighbor are discarded, even when the connection is down.</p>
<p id="rfc.section.2.p.7">When PORT is used, only incremental Join/Prune messages are sent from downstream routers to upstream routers. As such, downstream routers do not generate periodic Join/Prune messages for state for which the RPF neighbor is PORT-capable.</p>
<p id="rfc.section.2.p.8">For Joins and Prunes, which are received over a TCP/SCTP connection, the upstream router does not start or maintain timers on the outgoing interface entry. Instead, it keeps track of which downstream routers have expressed interest. An interface is deleted from the outgoing interface list only when all downstream routers on the interface, no longer wish to receive traffic. If there also are native joins/prunes from non-PORT neighbor, then one can maintain timers on the outgoing interface entry as usual, while at the same time keep track of each of the downstream PORT joins/prunes.  </p>
<p id="rfc.section.2.p.9">This document does not update the PIM Join/Prune packet format.  In the procedures described in this document, each PIM Join/Prune message is included in the payload of a PORT message carried over TCP/SCTP.  See section <a href="#PM">Section 5</a> for details on the PORT message.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#helloopts" id="helloopts">PIM Hello Options</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> PIM over the TCP Transport Protocol</h1>
<div id="#rfc.figure.1"></div>
<p>Option Type: PIM-over-TCP-Capable</p>
<pre>

        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Type = 27           |         Length = 4 + X        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     TCP Connection ID AFI     |        Reserved       |  Exp  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       TCP Connection ID                       |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

            </pre>
<p>Assigned Hello Type values can be found in <a href="#HELLO-OPT">[HELLO-OPT]</a>.</p>
<p id="rfc.section.3.1.p.1">When a router is configured to use PIM over TCP on a given interface, it MUST include the PIM-over-TCP-Capable hello option in its Hello messages for that interface. If a router is explicitly disabled from using PIM over TCP, it MUST NOT include the PIM-over-TCP-Capable hello option in its Hello messages.</p>
<p id="rfc.section.3.1.p.2">All Hello messages containing the PIM-over-TCP-Capable hello option, MUST also contain the Interface ID hello option, see section <a href="#intid">Section 3.3</a>.</p>
<p id="rfc.section.3.1.p.3">Implementations MAY provide a configuration option to enable or disable PORT functionality. It is RECOMMENDED that this capability be disabled by default.</p>
<p></p>

<dl>
<dt>Length: </dt>
<dd style="margin-left: 8">Length in bytes for the value part of the Type/Length/Value encoding; where X is the number of bytes that make up the Connection ID field. X is 4 when AFI of value 1 (IPv4) <a href="#AFI">[AFI]</a> is used, 16 when AFI of value 2 (IPv6) <a href="#AFI">[AFI]</a> is used, and 0 if AFI of value 0 is used.</dd>
<dt>TCP Connection ID AFI: </dt>
<dd style="margin-left: 8">The AFI value to describe the address-family of the address of the TCP Connection ID field. When this field is 0, a mechanism outside the scope of this document is used to obtain the addresses used to establish the TCP connection.</dd>
<dt>Reserved: </dt>
<dd style="margin-left: 8">Set to zero on transmission and ignored on receipt.</dd>
<dt>Exp: </dt>
<dd style="margin-left: 8">For experimental use <a href="#RFC3692">[RFC3692]</a>. One expected use of these bits would be to signal experimental capabilities.  E.g. if a router supports an experimental feature, it may set a bit to indicate this. The default behavior, unless a router supports a particular experiment, is to ignore the bits on receipt.</dd>
<dt>TCP Connection ID: </dt>
<dd style="margin-left: 8">An IPv4 or IPv6 address used to establish the TCP connection.  This field is omitted (length 0) for the Connection ID AFI 0.</dd>
</dl>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> PIM over the SCTP Transport Protocol</h1>
<div id="#rfc.figure.2"></div>
<p>Option Type: PIM-over-SCTP-Capable</p>
<pre>

        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Type = 28           |         Length = 4 + X        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     SCTP Connection ID AFI    |        Reserved       |  Exp  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       SCTP Connection ID                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

            </pre>
<p>Assigned Hello Type values can be found in <a href="#HELLO-OPT">[HELLO-OPT]</a>.</p>
<p id="rfc.section.3.2.p.1">When a router is configured to use PIM over SCTP on a given interface, it MUST include the PIM-over-SCTP-Capable hello option in its Hello messages for that interface. If a router is explicitly disabled from using PIM over SCTP, it MUST NOT include the PIM-over-SCTP-Capable hello option in its Hello messages.</p>
<p id="rfc.section.3.2.p.2">All Hello messages containing the PIM-over-SCTP-Capable hello option, MUST also contain the Interface ID hello option, see section <a href="#intid">Section 3.3</a>.</p>
<p id="rfc.section.3.2.p.3">Implementations MAY provide a configuration option to enable or disable PORT functionality. It is RECOMMENDED that this capability be disabled by default.</p>
<p></p>

<dl>
<dt>Length: </dt>
<dd style="margin-left: 8">Length in bytes for the value part of the Type/Length/Value encoding; where X is the number of bytes that make up the Connection ID field. X is 4 when AFI of value 1 (IPv4) <a href="#AFI">[AFI]</a> is used, 16 when AFI of value 2 (IPv6) <a href="#AFI">[AFI]</a> is used, and 0 if AFI of value 0 is used.</dd>
<dt>SCTP Connection ID AFI: </dt>
<dd style="margin-left: 8">The AFI value to describe the address-family of the address of the SCTP Connection ID field. When this field is 0, a mechanism outside the scope of this document is used to obtain the addresses used to establish the SCTP connection.</dd>
<dt>Reserved: </dt>
<dd style="margin-left: 8">Set to zero on transmission and ignored on receipt.</dd>
<dt>Exp: </dt>
<dd style="margin-left: 8">For experimental use <a href="#RFC3692">[RFC3692]</a>. One expected use of these bits would be to signal experimental capabilities.  E.g. if a router supports an experimental feature, it may set a bit to indicate this. The default behavior, unless a router supports a particular experiment, is to ignore the bits on receipt.</dd>
<dt>SCTP Connection ID: </dt>
<dd style="margin-left: 8">An IPv4 or IPv6 address used to establish the SCTP connection.  This field is omitted (length 0) for the Connection ID AFI 0.</dd>
</dl>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#intid" id="intid">Interface ID</a>
</h1>
<p id="rfc.section.3.3.p.1">All Hello messages containing PIM-over-TCP-Capable or PIM-over-SCTP-Capable hello options, MUST also contain the Interface ID hello option <a href="#RFC6395">[RFC6395]</a>.  </p>
<p id="rfc.section.3.3.p.2">The Interface ID is used to associate a PORT Join/Prune message with the PIM neighbor that it is coming from.  When unnumbered interfaces are used or when a single Transport connection is used for sending and receiving Join/Prune messages over multiple interfaces, the Interface ID is used to convey the interface from Join/Prune message sender to Join/Prune message receiver. The value of the Interface ID hello option in Hellos sent on an interface, MUST be the same as the Interface ID value in all PORT Join/Prune messages sent to a PIM neighbor on that interface.</p>
<p id="rfc.section.3.3.p.3">The Interface ID need only uniquely identify an interface of a router, it does not need to identify which router the interface belongs to. This means that the Router ID part of the Interface ID MAY be 0. For details on the Router ID and the value 0, see <a href="#RFC6395">[RFC6395]</a>.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Establishing Transport Connections</h1>
<p id="rfc.section.4.p.1">While a router interface is PORT enabled, a PIM-over-TCP or a PIM-over-SCTP option MUST be included in the PIM Hello messages sent on that interface. When a router on a PORT-enabled interface receives a Hello message containing a PIM-over-TCP/PIM-over-SCTP Option from a new neighbor, or an existing neighbor that did not previously include the option, it switches to PORT mode for that particular neighbor.</p>
<p id="rfc.section.4.p.2">When a router switches to PORT mode for a neighbor, it stops sending and accepting Native Join/Prune messages for that neighbor.  Any state from previous Native Join/Prune messages is left to expire as normal. It will also attempt to establish a Transport connection (TCP or SCTP) with the neighbor. If both the router and its neighbor have announced both PIM-over-TCP and PIM-over-SCTP options, SCTP MUST be used. This resolves the issue where two transports are both offered. The method prefers SCTP over TCP, because SCTP has benefits such as call collision handling and support for multiple streams, as discussed later in this document.</p>
<p id="rfc.section.4.p.3">When the router is using TCP, it will compare the TCP Connection ID it announced in the PIM-over-TCP-Capable Option with the TCP Connection ID in the Hello received from the neighbor. Unless connections are opened on-demand (see below), the router with the lower Connection ID MUST do an active Transport open to the neighbor Connection ID. The router with the higher Connection ID MUST do a passive Transport open.  An implementation MAY open connections only on-demand, in that case it may be that the neighbor with the higher Connection ID does the active open, see <a href="#ondemand">Section 4.5</a>. If the router with the lower Connection ID chooses to only do an active open on-demand, it MUST do a passive open, allowing for the neighbor to initiate the connection.  Note that the source address of the active open MUST be the announced Connection ID.</p>
<p id="rfc.section.4.p.4">When the router is using SCTP, the IP address comparison need not be done since the SCTP protocol can handle call collision.</p>
<p id="rfc.section.4.p.5">The decisions whether to use PORT, which transport, and which Connection IDs to use are performed independently for IPv4 and IPv6. Thus, if PORT is used both for IPv4 and IPv6, both IPv4 and IPv6 PIM Hello messages MUST be sent, both containing PORT Hello options. If two neighbors announce the same transport (TCP or SCTP) and the same Connection IDs in the IPv4 and IPv6 Hello messages, then only one connection is established and is shared.  Otherwise, two connections are established and are used separately.  </p>
<p id="rfc.section.4.p.6">The PIM router that performs the active open initiates the connection with a locally generated source transport port number and a well-known destination transport port number. The PIM router that performs the passive open listens on the well-known local transport port number and does not qualify the remote transport port number. See <a href="#PM">Section 5</a> for well-known port number assignment for PORT.</p>
<p id="rfc.section.4.p.7">When a Transport connection is established (or reestablished), the two routers MUST both send a full set of Join/Prune messages for state for which the other router is the upstream neighbor. This is needed to ensure that the upstream neighbor has the correct state. When moving from Datagram mode, or when the connection has gone down, the router cannot be sure that all the previous Join/Prune state was received by the neighbor. Any state created before the connection was established (or reestablished) that is not refreshed, MUST be left to expire and be deleted. When the non-refreshed state has expired and been deleted, the two neighbors will be in sync.</p>
<p id="rfc.section.4.p.8">When not running PORT, a full update is only needed when a router restarts, with PORT it must be done every time a connection is established. This can be costly, although it is expected that it is a rare event for a PORT connection to go up and down. There may be a need for extensions to better handle this.</p>
<p id="rfc.section.4.p.9">It is possible that a router starts sending Hello messages with a new Connection ID, e.g. due to configuration changes.  A router MUST always use the last announced and last seen Connection IDs. A connection is identified by the local Connection ID (the one we are announcing on a particular interface), and the remote Connection ID (the one we are receiving from a neighbor on the same interface). When either the local or remote ID changes, the Connection ID pair we need a connection for changes. There may be an existing connection with the same pair, in which case the router will share that connection. Or a new connection may need to be established. Note that for link-local addresses, the interface should be regarded as part of the ID, so that connection sharing is not attempted when the same link-local addresses are seen on different interfaces.</p>
<p id="rfc.section.4.p.10">When a Connection ID changes, if the previously used connection is not needed (there are no other PIM neighborships using the same Connection ID pair), both peers MUST attempt to reset the transport connection. Next (even if the old connection is still needed), they MUST, unless a connection already exists with the new Connection ID pair, immediately or on-demand attempt to establish a new connection with the new Connection ID pair.  </p>
<p id="rfc.section.4.p.11">Normally the Interface ID would not change while a connection is up. However, if it does, it does not affect the connection.  It just means that when subsequent PORT join/prune messages are received, they should be matched against the last seen Interface ID.</p>
<p id="rfc.section.4.p.12">Note that, a Join sent over a Transport connection will only be seen by the upstream router, and thus will not cause  routers on the link that do not use PIM PORT with the upstream router to possibly delay the refresh of Join state for the same state.  Similarly, a Prune sent over a Transport connection will only be seen by the upstream router, and will thus never cause routers on the link that do not use PIM PORT with the upstream router, to send a Join to override this Prune.</p>
<p id="rfc.section.4.p.13">Note also, that a datagram PIM Join/Prune message for a said (S,G) or (*,G) sent by some router on a link will not cause routers on the same link that use a Transport connection with the upstream router for that state, to suppress the refresh of that state to the upstream router (because they don't need to periodically refresh this state) or to send a Join to override a Prune (as the upstream router will only stop forwarding the traffic when all joined routers that use a Transport connection have explicitly sent a Prune for this state, as explained in <a href="#track">Section 6</a>).</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#consec" id="consec">Connection Security</a>
</h1>
<p id="rfc.section.4.1.p.1">TCP/SCTP packets used for PORT MUST be sent with a TTL/Hop Limit of 255 to facilitate enabling of the Generalized TTL Security Mechanism (GTSM) <a href="#RFC5082">[RFC5082]</a>. Implementations SHOULD provide a configuration option to enable the GTSM check at the receiver. This means checking that inbound packets from directly connected neighbors have a TTL/Hop Limit of 255, but MAY also allow for a different TTL/Hop Limit threshold to check that the sender is within a certain number of router hops. The GTSM check SHOULD be disabled by default.  </p>
<p id="rfc.section.4.1.p.2">Implementations SHOULD support the TCP Authentication Option (TCP-AO) <a href="#RFC5925">[RFC5925]</a> and SCTP Authenticated Chunks <a href="#RFC4895">[RFC4895]</a>.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#conman" id="conman">Connection Maintenance</a>
</h1>
<p id="rfc.section.4.2.p.1">TCP is designed to keep connections up indefinitely during a period of network disconnection. If a PIM-over-TCP router fails, the TCP connection may stay up until the neighbor actually reboots, and even then it may continue to stay up until PORT tries to send the neighbor some information. This is particularly relevant to PIM, since the flow of Join/Prune messages might be in only one direction, and the downstream neighbor might never get any indication via TCP that the other end of the connection is not really there.</p>
<p id="rfc.section.4.2.p.2">SCTP has a heart beat mechanism that can be used to detect that a connection is not working, even when no data is sent. Many TCP implementations also support sending keep-alives for this purpose. Implementations MAY make use of TCP keep-alives, but it the PORT keep-alive mechanism defined below allows for more control and flexibility.</p>
<p id="rfc.section.4.2.p.3">One can detect that a PORT connection is not working by regularly sending PORT messages. This applies to both TCP and SCTP. E.g., for TCP the connection will be reset if no TCP ACKs are received after several retries. PORT in itself does not require any periodic signaling.  PORT Join/Prune messages are only sent when there is a state change. If the state changes are not frequent enough, a PORT Keep-Alive message (defined in <a href="#KAmsg">Section 5.2</a>) can be sent instead.  E.g., if an implementation wants to send a PORT message, to check that the connection is working, at least every 60 seconds, then whenever there is 60 seconds since the previous message, a Keep-Alive message could be sent. If there were less than 60 seconds between each Join/Prune, no Keep-Alive messages would be needed.  Implementations SHOULD support the use of PORT Keep-Alive messages. It is RECOMMENDED that a configuration option is available to network administrators to enable it when needed.  Note that Keep-Alives can be used by a peer, independently of whether the other peer supports it.</p>
<p id="rfc.section.4.2.p.4">An implementation that supports Keep-Alive messages acts as follows when processing a received PORT message.  When processing a Keep-Alive message with a non-zero Holdtime value, it MUST set a timer to the value. We call this timer Connection Expiry Timer (CET). If the CET is already running, it MUST be reset to the new value. When processing a Keep-Alive message with a zero Holdtime value, the CET MUST be stopped if running.  When processing a PORT message other than Keep-Alive, the CET MUST be reset to the last received Holdtime value if running. If the CET is not running, no action is taken.  If the CET expires, the connection SHOULD be shut down.  This specification does not mandate a specific default Holdtime value. However, the dynamic congestion and flow control in TCP and SCTP can result in variable transit delay between the endpoints when capacity varies, there may be loss in the network or variable link performance. Consistent behaviour therefore requires a sufficiently large Holdtime value. E.g., 60 seconds to prevent premature termination.</p>
<p id="rfc.section.4.2.p.5">It is possible that a router receives Join/Prune messages for an interface/link that is down. As long as the neighbor has not expired, it is RECOMMENDED processing those messages as usual. If they are ignored, then the router SHOULD ensure it gets a full update for that interface when it comes back up. This can be done by changing the GenID (Generation Identifier, see <a href="#RFC4601">[RFC4601]</a>), or by terminating and reestablishing the connection.</p>
<p id="rfc.section.4.2.p.6">If a PORT neighbor changes its GenID and a connection is established or attempting to be established, the local side should generally tear down the connection and do as described in <a href="#down">Section 4.3</a>. However, if the connection is shared by multiple interfaces and the GenID changes only for one of them, the local side SHOULD simply send a full update, similar to other cases when a GenID changes for an upstream neighbor.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#down" id="down">Actions When a Connection Goes Down</a>
</h1>
<p id="rfc.section.4.3.p.1">A connection may go down for a variety of reasons. It may be due to an error condition, or a configuration change.  A connection SHOULD be shut down as soon as there are no more PIM neighbors using it. That is, for the connection we have associated local and remote Connection IDs. When there is no PIM neighbor with that particular remote connection ID on any interface where we announce the local connection ID, the connection SHOULD be shut down. This may happen when a new connection ID is configured, PORT is disabled, or a PIM neighbor expires.</p>
<p id="rfc.section.4.3.p.2">If a PIM neighbor expires, one should free connection state and downstream oif-list state for the neighbor. A downstream router, when an upstream neighboring router has expired, will simply update the RPF neighbor for the corresponding state to a new neighbor where it would trigger Join/Prune messages. This behavior is according to <a href="#RFC4601">[RFC4601]</a> where also the term RPF neighbor is defined. It is required of a PIM router to clear its neighbor table for a neighbor who has timed out due to neighbor holdtime expiration.</p>
<p id="rfc.section.4.3.p.3">When a connection is no longer available between two PORT enabled PIM neighbors, they MUST immediately, or on-demand, try to reestablish the connection following the normal rules for connection establishment. The neighbors MUST also start expiry timers so that all oif-list state for the neighbor using the connection, gets expired after J/P_Holdtime, unless it later gets refreshed by receiving new Join/Prunes.</p>
<p id="rfc.section.4.3.p.4">The value of J/P_Holdtime is 215 seconds. This value is based on section 4.11 of <a href="#RFC4601">[RFC4601]</a> which says that J/P_HoldTime should be 3.5 * t_periodic where the default for t_periodic is 60 seconds.</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> Moving from PORT to Datagram Mode</h1>
<p id="rfc.section.4.4.p.1">There may be situations where an administrator decides to stop using PORT. If PORT is disabled on a router interface, or a previously PORT enabled neighbor no longer announces any of the PORT Hello options, the router follows the rules in <a href="#down">Section 4.3</a> for taking down connections and starting timers. Next, the router SHOULD trigger a full state update similar to what would be done if the GenID changed in Datagram Mode.  The router SHOULD send Join/Prune messages for any state where the router switched from PORT to Datagram Mode for the upstream neighbor.  </p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#ondemand" id="ondemand">On-demand versus Pre-configured Connections</a>
</h1>
<p id="rfc.section.4.5.p.1">Transport connections could be established when they are needed or when a router interface to other PIM neighbors has come up. The advantage of on-demand Transport connection establishment is the reduction of router resources. Especially in the case where there is no need for a full mesh of connections on a network interface.  The disadvantage is additional delay and queueing when a Join/Prune message needs to be sent and a Transport connection is not established yet.</p>
<p id="rfc.section.4.5.p.2">If a router interface has become operational and PIM neighbors are learned from Hello messages, at that time, Transport connections may be established. The advantage is that a connection is ready to transport data by the time a Join/Prune message needs to be sent. The disadvantage is there can be more connections established than needed. This can occur when there is a small set of RPF neighbors for the active distribution trees compared to the total number of neighbors. Even when Transport connections are pre-established before they are needed, a connection can go down and an implementation will have to deal with an on-demand situation.</p>
<p id="rfc.section.4.5.p.3">Note that for TCP, it is the router with the lower Connection ID that decides whether to open a connection immediately, or on-demand. The router with the higher Connection ID SHOULD only initiate a connection on-demand. That is, if it needs to send a Join/Prune message and there is no currently established connection.</p>
<p id="rfc.section.4.5.p.4">Therefore, this specification RECOMMENDS but does not mandate the use of on-demand Transport connection establishment.</p>
<h1 id="rfc.section.4.6">
<a href="#rfc.section.4.6">4.6.</a> Possible Hello Suppression Considerations</h1>
<p id="rfc.section.4.6.p.1">Based on this specification, a Transport connection cannot be established until a Hello message is received. One reason for this is to determine if the PIM neighbor supports this specification and the other is to determine the remote address to use to establish the Transport connection.</p>
<p id="rfc.section.4.6.p.2">There are cases where it is desirable to suppress entirely the transmission of Hello messages. In this case, it is outside the scope of this document on how to determine if the PIM neighbor supports this specification as well as an out-of-band (outside of the PIM protocol) method to determine the remote address to establish the Transport connection. </p>
<h1 id="rfc.section.4.7">
<a href="#rfc.section.4.7">4.7.</a> Avoiding a Pair of TCP Connections between Neighbors</h1>
<p id="rfc.section.4.7.p.1">To ensure that there is only one TCP connection between a pair of  PIM neighbors, the following set of rules MUST be followed.  Note that this section applies only to TCP, for SCTP this is not an issue. Let A and B be two PIM neighbors where A's Connection ID is numerically smaller than B's Connection ID, and each is known to the other as having a potential PIM adjacency relationship.</p>
<p id="rfc.section.4.7.p.2">At node A:</p>
<p></p>

<ul>
<li>If there is  already  an established  TCP  connection to B, on  the PIM-over-TCP  port,  then A  MUST  NOT  attempt  to establish  a  new connection to B.   Rather it uses the established  connection to send Join/Prune messages to B.  (This is independent of which  node initiated the connection.)</li>
<li>If A has initiated a connection to B, but the connection is still in the process of being established, then A MUST refuse any connection on the PIM-over-TCP port from B.</li>
<li>At any time when A does not have a connection to B which is either established or in the process of being established, A MUST accept connections from B.</li>
</ul>
<p id="rfc.section.4.7.p.4">At node B:</p>
<p></p>

<ul>
<li>If there is already an established TCP connection to A, on the PIM-over-TCP port, then B MUST NOT attempt to establish a new connection to A.  Rather it uses the established connection to send Join/Prune messages to A.  (This is independent of which node initiated the connection.)</li>
<li>If B has initiated a connection to A, but the connection is still in the process of being established, then if A initiates a connection too, B MUST accept the connection initiated by A and must release the connection which it (B) initiated.</li>
</ul>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#PM" id="PM">PORT Message Definitions</a>
</h1>
<p id="rfc.section.5.p.1">It may be desirable for scaling purposes to allow Join/Prune messages from different PIM protocol families to be sent over the same Transport connection. Also, it may be desirable to have a set of Join/Prune messages for one address-family sent over a Transport connection that is established over a different address-family network layer.</p>
<p id="rfc.section.5.p.2">To be able to do this we need a common PORT message format.  This will provide both record boundary and demux points when sending over a stream protocol like TCP/SCTP.</p>
<p id="rfc.section.5.p.3">A PORT message may contain PORT options, see <a href="#PO">Section 5.3</a>.  We will define two PORT options for carrying PIM Join/Prune messages. One for IPv4 and one for IPv6. For each PIM Join/Prune message to be sent over the Transport connection, we send a PORT Join/Prune message containing exactly one such option.  </p>
<p id="rfc.section.5.p.4">Each PORT message will have the Type/Length/Value format. Multiple different TLV types can be sent over the same Transport connection.</p>
<p id="rfc.section.5.p.5">To make sure PIM Join/Prune messages are delivered as soon as the TCP transport layer receives the Join/Prune buffer, the TCP Push flag will be set in all outgoing Join/Prune messages sent over a TCP transport connection.</p>
<p id="rfc.section.5.p.6">PORT messages will be sent using destination TCP port number 8471. When using SCTP as the reliable transport, destination port number 8471 will be used. See <a href="#IANA-Considerations">Section 12</a> for IANA considerations.</p>
<p id="rfc.section.5.p.7">PORT messages are error checked. This includes unknown/illegal type fields, or a truncated message. If the PORT message contains a PIM Join/Prune Message, then that is subject to the normal PIM error checks, including checksum verification. If any parsing errors occur in a PORT message, it is skipped, and we proceed to any following PORT messages.</p>
<p id="rfc.section.5.p.8">When an unknown type field is encountered, that message MUST be ignored. As specified above, one then proceeds as usual processing further PORT messages. This is important in order to allow new message types to be specified in the future, without breaking existing implementations. However, if only unknown or invalid messages are received for a longer period of time, an implementation MAY alert the operator. E.g., if a message is sent with a wrong length, the receiver is likely to see only unknown/invalid messages thereafter.</p>
<p id="rfc.section.5.p.9">The checksum of the PIM Join/Prune message MUST be calculated exactly as specified in section 4.9 of <a href="#RFC4601">[RFC4601]</a>).  For IPv6, <a href="#RFC4601">[RFC4601]</a> specifies the use of a pseudo-header. For PORT, the exact same pseudo-header MUST be used, but its source and destination address fields MUST be set to 0 when calculating the checksum.</p>
<p id="rfc.section.5.p.10">The TLV type field is 16 bits. The range 65532 - 65535 is for experimental use <a href="#RFC3692">[RFC3692]</a>.</p>
<p id="rfc.section.5.p.11">This document defines two message types.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> PORT Join/Prune Message</h1>
<div id="#rfc.figure.3"></div>
<p>PORT Join/Prune Message</p>
<pre>
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          Type = 1             |        Message Length         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Reserved                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Interface                           |
       |                               ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |    PORT Option Type           |      Option Value Length      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                             Value                             |
       |                               .                               |
       |                               .                               |
       |                               .                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       \                               .                               \
       /                               .                               /
       \                               .                               \
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |    PORT Option Type           |      Option Value Length      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                             Value                             |
       |                               .                               |
       |                               .                               |
       |                               .                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
          </pre>
<p></p>
<p id="rfc.section.5.1.p.1">The PORT Join/Prune Message is used for sending a PIM Join/Prune.</p>
<p></p>

<dl>
<dt>Message Length: </dt>
<dd style="margin-left: 8">Length in bytes for the value part of the Type/Length/Value encoding. If no PORT Options were included, the length would be 12. If n PORT Options with Option Value lengths L1, L2, ..., Ln are included, the message length will be 12 + 4*n + L1 + L2 + ... + Ln.</dd>
<dt>Reserved: </dt>
<dd style="margin-left: 8">Set to zero on transmission and ignored on receipt.</dd>
<dt>Interface ID: </dt>
<dd style="margin-left: 8">This MUST be the Interface ID of the Interface ID Hello option contained in the PIM Hello messages the PIM router is sending to the PIM neighbor.  It indicates to the PIM neighbor what interface to associate the Join/Prune with. The Interface ID allows us to do connection sharing.</dd>
<dt>PORT Options: </dt>
<dd style="margin-left: 8">The message MUST contain exactly one PIM Join/Prune Port Option, either one PIM IPv4 Join/Prune or one PIM IPv6 Join/Prune.  It MUST NOT contain both.  It MAY contain additional options not defined in this document. The behavior when receiving a message containing unknown options depends on the option type.  See <a href="#PO">Section 5.3</a> for option definitions.</dd>
</dl>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#KAmsg" id="KAmsg">PORT Keep-alive Message</a>
</h1>
<div id="#rfc.figure.4"></div>
<p>PORT Keep-alive Message</p>
<pre>
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          Type = 2             |        Message Length         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Reserved                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Holdtime            |       PORT Option Type        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Option Value Length      |            Value              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+              .                +
       |                                              .                |
       |                                              .                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       \                               .                               \
       /                               .                               /
       \                               .                               \
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |    PORT Option Type           |      Option Value Length      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                             Value                             |
       |                               .                               |
       |                               .                               |
       |                               .                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
          </pre>
<p></p>
<p id="rfc.section.5.2.p.1">The PORT Keep-alive Message is used to regularly send PORT messages to verify that a connection is alive. They are used when other PORT messages are not sent at the desired frequency.</p>
<p></p>

<dl>
<dt>Message Length: </dt>
<dd style="margin-left: 8">Length in bytes for the value part of the Type/Length/Value encoding. If no PORT Options were included, the length would be 6. If n PORT Options with Option Value lengths L1, L2, ..., Ln are included, the message length will be 6 + 4*n + L1 + L2 + ... + Ln.</dd>
<dt>Reserved: </dt>
<dd style="margin-left: 8">Set to zero on transmission and ignored on receipt.</dd>
<dt>Holdtime: </dt>
<dd style="margin-left: 8">This specifies a Holdtime in seconds for the connection. A non-zero value means that the connection SHOULD be gracefully shut down if no further PORT messages are received within the specified time. This is measured on the receiving side by measuring the time from one PORT message has been processed until the next has been processed. Note that this MUST be done for any PORT message, not just keep-alive messages. A hold time of 0 disables the keep-alive mechanism.  </dd>
<dt>PORT Options: </dt>
<dd style="margin-left: 8">A keep-alive message MUST NOT contain any of the options defined in this document. It MAY contain other options not defined in this document. The behavior when receiving a message containing unknown options depends on the option type.  See <a href="#PO">Section 5.3</a> for option definitions.</dd>
</dl>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#PO" id="PO">PORT Options</a>
</h1>
<p id="rfc.section.5.3.p.1">Each PORT Option is a TLV. The type is 16 bits.  The PORT Option type space is split in two ranges.  The types in the range 0 - 32767 (the most significant bit is not set) are for Critical Options. The types in the range 32768 - 65535 (the most significant bit is set) are for Non-Critical Options.</p>
<p id="rfc.section.5.3.p.2">The behavior of a router receiving a message with an unknown PORT Option, is determined by whether the option is a critical option. If the message contains an unknown critical option, the entire message must be ignored. If the option is non-critical, only that particular option is ignored, and the message is processed as if the option was not present.</p>
<p id="rfc.section.5.3.p.3">PORT Option types are assigned by IANA, except the ranges 32764 - 32767 and 65532 - 65535 that are for experimental use <a href="#RFC3692">[RFC3692]</a>. The length specifies the length of the value in bytes.  Below are the two options defined in this document.</p>
<h1 id="rfc.section.5.3.1">
<a href="#rfc.section.5.3.1">5.3.1.</a> PIM IPv4 Join/Prune Option</h1>
<div id="#rfc.figure.5"></div>
<p>PIM IPv4 Join/Prune Option Format</p>
<pre>
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      PORT Option Type = 1     |      Option Value Length      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                   PIMv2 Join/Prune Message                    |
       |                               .                               |
       |                               .                               |
       |                               .                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
            </pre>
<p></p>
<p id="rfc.section.5.3.1.p.1">The IPv4 Join/Prune Option is used to carry a PIMv2 Join/Prune message that has all IPv4 encoded addresses in the PIM payload.</p>
<p></p>

<dl>
<dt>Option Value Length: </dt>
<dd style="margin-left: 8">The number of bytes that make up the PIMv2 Join/Prune message.</dd>
<dt>PIMv2 Join/Prune Message: </dt>
<dd style="margin-left: 8">PIMv2 Join/Prune message and payload with no IP header in front of it.</dd>
</dl>
<h1 id="rfc.section.5.3.2">
<a href="#rfc.section.5.3.2">5.3.2.</a> PIM IPv6 Join/Prune Option</h1>
<div id="#rfc.figure.6"></div>
<p>PIM IPv6 Join/Prune Option Format</p>
<pre>
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      PORT Option Type = 2     |      Option Value Length      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                   PIMv2 Join/Prune Message                    |
       |                               .                               |
       |                               .                               |
       |                               .                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
            </pre>
<p></p>
<p id="rfc.section.5.3.2.p.1">The IPv6 Join/Prune Option is used to carry a PIMv2 Join/Prune message that has all IPv6 encoded addresses in the PIM payload.</p>
<p></p>

<dl>
<dt>Option Value Length: </dt>
<dd style="margin-left: 8">The number of bytes that make up the PIMv2 Join/Prune message.</dd>
<dt>PIMv2 Join/Prune Message: </dt>
<dd style="margin-left: 8">PIMv2 Join/Prune message and payload with no IP header in front of it.</dd>
</dl>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#track" id="track">Explicit Tracking</a>
</h1>
<p id="rfc.section.6.p.1">When explicit tracking is used, a router keeps track of join state for individual downstream neighbors on a given interface.  This MUST be done for all PORT joins and prunes. Note that it may also be done for native join/prune messages, if all neighbors on the LAN have set the T bit of the LAN Prune Delay option (see definition in section 4.9.2 of <a href="#RFC4601">[RFC4601]</a>). In the discussion below we will talk about ET (explicit tracking) neighbors, and non-ET neighbors. The set of ET neighbors MUST include the PORT neighbors. The set of non-ET neighbors consists of all the non-PORT neighbors unless all neighbors have set the LAN Prune Delay T bit. Then the ET neighbors set contains all neighbors.</p>
<p id="rfc.section.6.p.2">For some link-types, e.g. point-to-point, tracking neighbors is no different than tracking interfaces. It may also be possible for an implementation to treat different downstream neighbors as being on different logical interfaces, even if they are on the same physical link.  Exactly how this is implemented and for which link types, is left to the implementer.</p>
<p id="rfc.section.6.p.3">For (*,G) and (S,G) state, the router starts forwarding traffic on an interface when a Join is received from a neighbor on such an interface. When a non-ET neighbor sends a Prune, as specified <a href="#RFC4601">[RFC4601]</a>, if no Join is sent to override this Prune before the expiration of the Override Timer, the upstream router concludes that no non-ET neighbor is interested.  If no ET neighbors are interested, the interface can be removed from the oif-list. When an ET neighbor sends a Prune, one removes the join state for that neighbor. If no other ET or non-ET neighbors are interested, the interface can be removed from the oif-list. When a PORT neighbor sends a prune, there can be no Prune Override, since the Prune is not visible to other neighbors.</p>
<p id="rfc.section.6.p.4">For (S,G,rpt) state, the router needs to track Prune state on the shared tree. It needs to know which ET neighbors have sent prunes, and whether any non-ET neighbors have sent prunes.  Normally one would forward a packet from a source S to a group G out on an interface if a (*,G)-join is received, but no (S,G,rpt)-prune. With ET one needs to do this check per ET neighbor. That is, the packet should be forwarded unless all ET neighbors that have sent (*,G)-joins have also sent (S,G,rpt)-prunes, and if a non-ET neighbor has sent a (*,G)-join, whether there also is non-ET (S,G,rpt)-prune state.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Multiple Address-Family Support</h1>
<p id="rfc.section.7.p.1">To allow for efficient use of router resources, one can mux Join/Prune messages of different address families on the same Transport connection.  There are two ways this can be accomplished, one using a common message format over a TCP connection and the other using multiple streams over a single SCTP connection.</p>
<p id="rfc.section.7.p.2">Using the common message format described previously in this specification, using different PORT options, both IPv4 and IPv6 based Join/Prune messages can be encoded within the same Transport connection.  </p>
<p id="rfc.section.7.p.3">When using SCTP multi-streaming, the common message format is still used to convey address family information but an SCTP association is used, on a per-family basis, to send data concurrently for multiple families. When data is sent concurrently, head of line blocking, which can occur when using TCP, is avoided.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Miscellany</h1>
<p id="rfc.section.8.p.1">There are no changes to processing of other PIM messages like PIM Asserts, Grafts, Graft-Acks, Registers, and Register-Stops. This goes for BSR and Auto-RP type messages as well.</p>
<p id="rfc.section.8.p.2">This extension is applicable only to PIM-SM, PIM-SSM and Bidir-PIM. It does not take requirements for PIM-DM into consideration.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Transport Considerations</h1>
<p id="rfc.section.9.p.1">As noted in the introduction, this is an experimental extension to PIM, and using reliable delivery for PIM messages is a new concept. There are several potential transport related concerns. Hopefully experiences from early implementations and deployments will reveal what concerns are relevant and how to resolve them.</p>
<p id="rfc.section.9.p.2">One consideration is keep-alive mechanisms. We have defined an optional Keep-alive mechanism for PORT, see <a href="#conman">Section 4.2</a>. Also SCTP and many TCP implementations provide keep-alive mechanisms that could be used. When to use keep-alive messages and which mechanism is unclear, although we believe the PORT keep-alive allows for better application control.  It is unclear what holdtimes are preferred for the PORT Keep-alives.  For now it is RECOMMENDED that administrators can configure whether to use keep-alives, what holdtimes etc.</p>
<p id="rfc.section.9.p.3">In a stable state it is expected that only occasional small messages are sent over a PORT connection. This depends on how often PIM Join/Prune state changes. Thus, over a long period of time, there may be only small messages that never use the entire TCP congestion window, and the window may become very large. This would then be an issue if there is a state change making PORT send a very large message. It may be good if the TCP stack provides some rate-limiting or burst-limiting. The congestion control mechanism defined in <a href="#RFC3465">[RFC3465]</a> may be of help.</p>
<p id="rfc.section.9.p.4">With PORT, it is possible as discussed in the previous paragraph that only occasional small messages are sent. This may cause problems for the TCP retransmit mechanism. In particular, the TCP Fast Retransmit algorithm may never get triggered. For further discussion of this and a possible solution, see <a href="#RFC3042">[RFC3042]</a>.</p>
<p id="rfc.section.9.p.5">While the above two paragraphs only discuss TCP issues, there may also be similar issues regarding SCTP.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Manageability Considerations</h1>
<p id="rfc.section.10.p.1">This document defines using TCP or SCTP transports between pairs of PIM neighbors. It is recommended that this mechanism is disabled by default. An administrator can then enable PORT TCP and/or SCTP on PIM enabled interfaces. If two neighbors both have PORT SCTP (and if not, if both PORT TCP) they will only use SCTP (alternatively TCP) for PIM Join/Prune messages.  This is the case even when the connection is down (there is no fallback to native Join/Prune messages).  </p>
<p id="rfc.section.10.p.2">When PORT support is enabled, a router sends PIM Hello messages announcing support for TCP and/or SCTP and also Connection IDs.  It should be possible to configure a local Connection ID, and also to see what PORT capabilities and Connection IDs PIM neighbors are announcing. Based on these advertisements, pairs of PIM neighbors will decide whether to try to establish a PORT connection.  There should be a way for an operator to check the current connection state. Statistics on the number of PORT messages sent and received (including number of invalid messages) may also be helpful</p>
<p id="rfc.section.10.p.3">For connection security (see <a href="#consec">Section 4.1</a>), it should be possible to enable a GTSM check to only accept connections (TCP/SCTP packets) when the sender is within a certain number of router hops. Also one should be able to configure the use of TCP-AO.  </p>
<p id="rfc.section.10.p.4">For connection maintenance (see <a href="#conman">Section 4.2</a>), it is recommended to support Keep-Alive messages. It should be configurable whether to send Keep-Alives. In that case, also wheter to use a Holdtime, and what Holdtime to use.  </p>
<p id="rfc.section.10.p.5">There should be some way to alert an operator when PORT connections are going down, or when there is a failure in establishing a PORT connection. Also information like the number of connection failures, and how long the connection has been up or down, is useful.</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> Security Considerations</h1>
<p id="rfc.section.11.p.1">There are several security issues related to the use of TCP or SCTP transports. One can do off-path attacks sending packets with a spoofed source address. Either establishing a connection, or injecting packets into an existing connnection.  This might allow someone to send spoofed join/prune messages, and may also allow someone to reset the connection. Mechanisms that help protect against this are discussed in <a href="#consec">Section 4.1</a>).</p>
<p id="rfc.section.11.p.2">For authentication one may for TCP use TCP-AO <a href="#RFC5925">[RFC5925]</a>, and for SCTP use Authenticated Chunks <a href="#RFC4895">[RFC4895]</a>. Also GTSM <a href="#RFC5082">[RFC5082]</a> can be used to help prevent spoofing.  </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#IANA-Considerations" id="IANA-Considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.12.p.1">This specification makes use of a TCP port number and an SCTP port number for the use of the pim-port service that has been assigned by IANA. It also makes use of IANA PIM Hello Options assignments that should be made permanent.</p>
<h1 id="rfc.section.12.1">
<a href="#rfc.section.12.1">12.1.</a> PORT Port Number</h1>
<p id="rfc.section.12.1.p.1">IANA has already assigned a port number that is used as a destination port for pim-port TCP and SCTP transports.  The assigned number is 8471. References to this document should be added to the Service Name and Transport Protocol Port Number Registry for pim-port.</p>
<h1 id="rfc.section.12.2">
<a href="#rfc.section.12.2">12.2.</a> PORT Hello Options</h1>
<div id="#rfc.figure.7"></div>
<pre>
 Value    Length      Name                    Reference
-------  ----------  -----------------------  ---------------
 27       Variable    PIM-over-TCP-Capable     this document
 28       Variable    PIM-over-SCTP-Capable    this document
          </pre>
<p id="rfc.section.12.2.p.1">In the Protocol Independent Multicast (PIM) Hello Options registry, the following options are needed for PORT.  </p>
<h1 id="rfc.section.12.3">
<a href="#rfc.section.12.3">12.3.</a> PORT Message Type Registry</h1>
<p id="rfc.section.12.3.p.1">A registry for PORT message types is requested. The message type is a 16-bit integer, with values from 0 to 65535.  An RFC is required for assignments in the range 0 - 65531.  This document defines two PORT message types. Type 1, Join/Prune; and Type 2, Keep-alive. The type range 65532 - 65535 is for experimental use <a href="#RFC3692">[RFC3692]</a>.</p>
<div id="#rfc.figure.8"></div>
<pre>
 Type           Name                             Reference
-------------  -------------------------------  ---------------
 0              Reserved                         this document
 1              Join/Prune                       this document
 2              Keep-alive                       this document
 3-65531        Unassigned
 65532-65535    Experimental                     this document
          </pre>
<p id="rfc.section.12.3.p.2">The initial content of the registry should be as follows: </p>
<h1 id="rfc.section.12.4">
<a href="#rfc.section.12.4">12.4.</a> PORT Option Type Registry</h1>
<p id="rfc.section.12.4.p.1">A registry for PORT option types is requested. The option type is a 16-bit integer, with values from 0 to 65535. The type space is split in two ranges, 0 - 32767 for Critical Options and 32768 - 65535 for Non-Critical Options.  Option types are assigned by IANA, except the ranges 32764 - 32767 and 65532 - 65535 that are for experimental use <a href="#RFC3692">[RFC3692]</a>. An RFC is required for the IANA assignments. An RFC defining a new option type must specify whether the option is Critical or Non-Critical in order for IANA to assign a type. This document defines two Critical PORT Option types. Type 1, PIM IPv4 Join/Prune Message; and Type 2, PIM IPv6 Join/Prune Message.</p>
<div id="#rfc.figure.9"></div>
<pre>
 Type           Name                               Reference
-------------  ----------------------------------  ---------------
 0              Reserved                            this document
 1              PIM IPv4 Join/Prune                 this document
 2              PIM IPv6 Join/Prune                 this document
 3-32763        Unassigned Critical Options
 32764-32767    Experimental                        this document
 32768-65531    Unassigned Non-Critical Options
 65532-65535    Experimental                        this document
          </pre>
<p id="rfc.section.12.4.p.2">The initial content of the registry should be as follows: </p>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> Contributors</h1>
<p id="rfc.section.13.p.1">In addition to the persons listed as authors, significant contributions were provided by Apoorva Karan and Arjen Boers.  </p>
<h1 id="rfc.section.14">
<a href="#rfc.section.14">14.</a> Acknowledgments</h1>
<p id="rfc.section.14.p.1">The authors would like to give a special thank you and appreciation to Nidhi Bhaskar for her initial design and early prototype of this idea.</p>
<p id="rfc.section.14.p.2">Appreciation goes to Randall Stewart for his authoritative review and recommendation for using SCTP.</p>
<p id="rfc.section.14.p.3">Thanks also goes to the following for their ideas and commentary review of this specification, Mike McBride, Toerless Eckert, Yiqun Cai, Albert Tian, Suresh Boddapati, Nataraj Batchu, Daniel Voce, John Zwiebel, Yakov Rekhter, Lenny Giuliano, Gorry Fairhurst, Sameer Gulrajani, Thomas Morin, Dimitri Papadimitriou, Bharat Joshi, Rishabh Parekh, Manav Bhatia, Pekka Savola, Tom Petch and Joe Touch.</p>
<p id="rfc.section.14.p.4">A special thank you goes to Eric Rosen for his very detailed review and commentary. Many of his comments are reflected as text in this specification.</p>
<h1 id="rfc.references">
<a href="#rfc.references">15.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">15.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4601">[RFC4601]</b></td>
<td class="top">
<a>Fenner, B.</a>, <a>Handley, M.</a>, <a>Holbrook, H.</a> and <a>I. Kouvelas</a>, "<a href="http://tools.ietf.org/html/rfc4601">Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)</a>", RFC 4601, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC0793">[RFC0793]</b></td>
<td class="top">
<a title="University of Southern California (USC)/Information Sciences Institute">Postel, J.</a>, "<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>", STD 7, RFC 793, September 1981.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4960">[RFC4960]</b></td>
<td class="top">
<a>Stewart, R.</a>, "<a href="http://tools.ietf.org/html/rfc4960">Stream Control Transmission Protocol</a>", RFC 4960, September 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4895">[RFC4895]</b></td>
<td class="top">
<a>Tuexen, M.</a>, <a>Stewart, R.</a>, <a>Lei, P.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc4895">Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)</a>", RFC 4895, August 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5015">[RFC5015]</b></td>
<td class="top">
<a>Handley, M.</a>, <a>Kouvelas, I.</a>, <a>Speakman, T.</a> and <a>L. Vicisano</a>, "<a href="http://tools.ietf.org/html/rfc5015">Bidirectional Protocol Independent Multicast (BIDIR-PIM)</a>", RFC 5015, October 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5082">[RFC5082]</b></td>
<td class="top">
<a>Gill, V.</a>, <a>Heasley, J.</a>, <a>Meyer, D.</a>, <a>Savola, P.</a> and <a>C. Pignataro</a>, "<a href="http://tools.ietf.org/html/rfc5082">The Generalized TTL Security Mechanism (GTSM)</a>", RFC 5082, October 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5925">[RFC5925]</b></td>
<td class="top">
<a>Touch, J.</a>, <a>Mankin, A.</a> and <a>R. Bonica</a>, "<a href="http://tools.ietf.org/html/rfc5925">The TCP Authentication Option</a>", RFC 5925, June 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6395">[RFC6395]</b></td>
<td class="top">
<a>Gulrajani, S.</a> and <a>S. Venaas</a>, "<a href="http://tools.ietf.org/html/rfc6395">An Interface Identifier (ID) Hello Option for PIM</a>", RFC 6395, October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">15.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3042">[RFC3042]</b></td>
<td class="top">
<a>Allman, M.</a>, <a>Balakrishnan, H.</a> and <a>S. Floyd</a>, "<a href="http://tools.ietf.org/html/rfc3042">Enhancing TCP's Loss Recovery Using Limited Transmit</a>", RFC 3042, January 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3465">[RFC3465]</b></td>
<td class="top">
<a>Allman, M.</a>, "<a href="http://tools.ietf.org/html/rfc3465">TCP Congestion Control with Appropriate Byte Counting (ABC)</a>", RFC 3465, February 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3692">[RFC3692]</b></td>
<td class="top">
<a>Narten, T.</a>, "<a href="http://tools.ietf.org/html/rfc3692">Assigning Experimental and Testing Numbers Considered Useful</a>", BCP 82, RFC 3692, January 2004.</td>
</tr>
<tr>
<td class="reference"><b id="AFI">[AFI]</b></td>
<td class="top">
<a>IANA, </a>, "<a>Address Family Numbers</a>", ADDRESS FAMILY NUMBERS http://www.iana.org/assignments/address-family-numbers, February 2007.</td>
</tr>
<tr>
<td class="reference"><b id="HELLO-OPT">[HELLO-OPT]</b></td>
<td class="top">
<a>IANA, </a>, "<a>PIM Hello Options</a>", PIM-HELLO-OPTIONS per RFC4601 http://www.iana.org/assignments/pim-hello-options, March 2007.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dino Farinacci</span> 
	  <span class="n hidden">
		<span class="family-name">Farinacci</span>
	  </span>
	</span>
	<span class="org vcardline">cisco Systems</span>
	<span class="adr">
	  <span>Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dino@cisco.com">dino@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">IJsbrand Wijnands</span> 
	  <span class="n hidden">
		<span class="family-name">Wijnands</span>
	  </span>
	</span>
	<span class="org vcardline">cisco Systems</span>
	<span class="adr">
	  <span>Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ice@cisco.com">ice@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Stig Venaas</span> 
	  <span class="n hidden">
		<span class="family-name">Venaas</span>
	  </span>
	</span>
	<span class="org vcardline">cisco Systems</span>
	<span class="adr">
	  <span>Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:stig@cisco.com">stig@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Maria Napierala</span> 
	  <span class="n hidden">
		<span class="family-name">Napierala</span>
	  </span>
	</span>
	<span class="org vcardline">AT&T Labs</span>
	<span class="adr">
	  <span>200 Laurel Drive</span>

	  <span class="vcardline">
		<span class="locality">Middletown</span>,  
		<span class="region">New Jersey</span> 
		<span class="code">07748></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mnapierala@att.com">mnapierala@att.com</a></span>

  </address>
</div>

</body>
</html>