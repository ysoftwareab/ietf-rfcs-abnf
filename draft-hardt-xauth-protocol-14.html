<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Grant Negotiation and Authorization Protocol</title>
<meta content="Dick Hardt" name="author">
<meta content="
       Client software often desires resources or identity claims that are independent of the client. This protocol allows a user and/or resource owner to delegate resource authorization and/or release of identity claims to a server. Client software can then request access to resources and/or identity claims by calling the server. The server acquires consent and authorization from the user and/or resource owner if required, and then returns to the client software the authorization and identity claims that were approved. This protocol may be extended on many dimensions. 
    " name="description">
<meta content="xml2rfc 2.47.0" name="generator">
<meta content="draft-hardt-xauth-protocol-14" name="ietf.draft">
<link href="/tmp/draft-hardt-xauth-protocol-14-sixq557z.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The Grant Negotiation and Authorization Protocol</td>
<td class="right">August 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hardt</td>
<td class="center">Expires 16 February 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hardt-xauth-protocol-14</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-08-15" class="published">15 August 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-02-16">16 February 2021</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Hardt, <span class="editor">Ed.</span>
</div>
<div class="org">SignIn.Org</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Grant Negotiation and Authorization Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Client software often desires resources or identity claims that are independent of the client. This protocol allows a user and/or resource owner to delegate resource authorization and/or release of identity claims to a server. Client software can then request access to resources and/or identity claims by calling the server. The server acquires consent and authorization from the user and/or resource owner if required, and then returns to the client software the authorization and identity claims that were approved. This protocol may be extended on many dimensions.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 16 February 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-the-grant" class="xref">The Grant</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-protocol-roles" class="xref">Protocol Roles</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-human-interactions" class="xref">Human Interactions</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-trust-model" class="xref">Trust Model</a><a href="#section-toc.1-1.1.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="xref">1.5</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="xref">1.6</a>.  <a href="#name-notational-conventions" class="xref">Notational Conventions</a><a href="#section-toc.1-1.1.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-exemplar-sequences" class="xref">Exemplar Sequences</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-redirect-interaction" class="xref">"redirect" Interaction</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-user_code-interaction" class="xref">"user_code" Interaction</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-independent-ro-authorizatio" class="xref">Independent RO Authorization</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-resource-server-access" class="xref">Resource Server Access</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-gs-apis" class="xref">GS APIs</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-gs-api-table" class="xref">GS API Table</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-create-grant" class="xref">Create Grant</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-verify-grant" class="xref">Verify Grant</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-read-grant" class="xref">Read Grant</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-request-json" class="xref">Request JSON</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-client-object" class="xref">"client" Object</a><a href="#section-toc.1-1.3.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="xref">3.5.2</a>.  <a href="#name-interaction-object" class="xref">"interaction" Object</a><a href="#section-toc.1-1.3.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="xref">3.5.3</a>.  <a href="#name-user-object" class="xref">"user" Object</a><a href="#section-toc.1-1.3.2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a href="#section-3.5.4" class="xref">3.5.4</a>.  <a href="#name-access-object" class="xref">"access" Object</a><a href="#section-toc.1-1.3.2.5.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5.2.5">
                    <p id="section-toc.1-1.3.2.5.2.5.1"><a href="#section-3.5.5" class="xref">3.5.5</a>.  <a href="#name-claims-object" class="xref">"claims" Object</a><a href="#section-toc.1-1.3.2.5.2.5.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-read-access" class="xref">Read Access</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-gs-options" class="xref">GS Options</a><a href="#section-toc.1-1.3.2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-gs-responses" class="xref">GS Responses</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-grant-response" class="xref">Grant Response</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-interaction-response" class="xref">Interaction Response</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-wait-response" class="xref">Wait Response</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-response-json" class="xref">Response JSON</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.  <a href="#name-client-object-2" class="xref">"client" Object</a><a href="#section-toc.1-1.4.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.  <a href="#name-interaction-object-2" class="xref">"interaction" Object</a><a href="#section-toc.1-1.4.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="xref">4.4.3</a>.  <a href="#name-access-object-2" class="xref">"access" Object</a><a href="#section-toc.1-1.4.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="xref">4.4.4</a>.  <a href="#name-access-response-object" class="xref">Access Response Object</a><a href="#section-toc.1-1.4.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4.2.5">
                    <p id="section-toc.1-1.4.2.4.2.5.1"><a href="#section-4.4.5" class="xref">4.4.5</a>.  <a href="#name-claims-object-2" class="xref">"claims" Object</a><a href="#section-toc.1-1.4.2.4.2.5.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4.2.6">
                    <p id="section-toc.1-1.4.2.4.2.6.1"><a href="#section-4.4.6" class="xref">4.4.6</a>.  <a href="#name-warnings-json-array" class="xref">"warnings" JSON Array</a><a href="#section-toc.1-1.4.2.4.2.6.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-access-json" class="xref">Access JSON</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-response-verification" class="xref">Response Verification</a><a href="#section-toc.1-1.4.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-interaction-modes" class="xref">Interaction Modes</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-redirect" class="xref">"redirect"</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-redirect-verification" class="xref">"redirect" verification</a><a href="#section-toc.1-1.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-indirect" class="xref">"indirect"</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-user_code" class="xref">"user_code"</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-rs-access" class="xref">RS Access</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-error-responses" class="xref">Error Responses</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-warnings" class="xref">Warnings</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-extensibility" class="xref">Extensibility</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-rational" class="xref">Rational</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.15.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.15.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-document-history" class="xref">Document History</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-draft-hardt-xauth-protocol-" class="xref">draft-hardt-xauth-protocol-00</a><a href="#section-toc.1-1.16.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-draft-hardt-xauth-protocol-0" class="xref">draft-hardt-xauth-protocol-01</a><a href="#section-toc.1-1.16.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.3">
                <p id="section-toc.1-1.16.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-draft-hardt-xauth-protocol-02" class="xref">draft-hardt-xauth-protocol-02</a><a href="#section-toc.1-1.16.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.4">
                <p id="section-toc.1-1.16.2.4.1"><a href="#section-a.4" class="xref">A.4</a>.  <a href="#name-draft-hardt-xauth-protocol-03" class="xref">draft-hardt-xauth-protocol-03</a><a href="#section-toc.1-1.16.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.5">
                <p id="section-toc.1-1.16.2.5.1"><a href="#section-a.5" class="xref">A.5</a>.  <a href="#name-draft-hardt-xauth-protocol-04" class="xref">draft-hardt-xauth-protocol-04</a><a href="#section-toc.1-1.16.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.6">
                <p id="section-toc.1-1.16.2.6.1"><a href="#section-a.6" class="xref">A.6</a>.  <a href="#name-draft-hardt-xauth-protocol-05" class="xref">draft-hardt-xauth-protocol-05</a><a href="#section-toc.1-1.16.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.7">
                <p id="section-toc.1-1.16.2.7.1"><a href="#section-a.7" class="xref">A.7</a>.  <a href="#name-draft-hardt-xauth-protocol-06" class="xref">draft-hardt-xauth-protocol-06</a><a href="#section-toc.1-1.16.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.8">
                <p id="section-toc.1-1.16.2.8.1"><a href="#section-a.8" class="xref">A.8</a>.  <a href="#name-draft-hardt-xauth-protocol-07" class="xref">draft-hardt-xauth-protocol-07</a><a href="#section-toc.1-1.16.2.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.9">
                <p id="section-toc.1-1.16.2.9.1"><a href="#section-a.9" class="xref">A.9</a>.  <a href="#name-draft-hardt-xauth-protocol-08" class="xref">draft-hardt-xauth-protocol-08</a><a href="#section-toc.1-1.16.2.9.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.10">
                <p id="section-toc.1-1.16.2.10.1"><a href="#section-a.10" class="xref">A.10</a>. <a href="#name-draft-hardt-xauth-protocol-09" class="xref">draft-hardt-xauth-protocol-09</a><a href="#section-toc.1-1.16.2.10.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.11">
                <p id="section-toc.1-1.16.2.11.1"><a href="#section-a.11" class="xref">A.11</a>. <a href="#name-draft-hardt-xauth-protocol-1" class="xref">draft-hardt-xauth-protocol-10</a><a href="#section-toc.1-1.16.2.11.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.12">
                <p id="section-toc.1-1.16.2.12.1"><a href="#section-a.12" class="xref">A.12</a>. <a href="#name-draft-hardt-xauth-protocol-11" class="xref">draft-hardt-xauth-protocol-11</a><a href="#section-toc.1-1.16.2.12.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.13">
                <p id="section-toc.1-1.16.2.13.1"><a href="#section-a.13" class="xref">A.13</a>. <a href="#name-draft-hardt-xauth-protocol-12" class="xref">draft-hardt-xauth-protocol-12</a><a href="#section-toc.1-1.16.2.13.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.14">
                <p id="section-toc.1-1.16.2.14.1"><a href="#section-a.14" class="xref">A.14</a>. <a href="#name-draft-hardt-xauth-protocol-13" class="xref">draft-hardt-xauth-protocol-13</a><a href="#section-toc.1-1.16.2.14.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.16.2.15">
                <p id="section-toc.1-1.16.2.15.1"><a href="#section-a.15" class="xref">A.15</a>. <a href="#name-draft-hardt-xauth-protocol-14" class="xref">draft-hardt-xauth-protocol-14</a><a href="#section-toc.1-1.16.2.15.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-comparison-with-oauth-20-an" class="xref">Comparison with OAuth 2.0 and OpenID Connect</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.18.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><strong>EDITOR NOTE</strong><a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"><em>This document captures a number of concepts that may be adopted by the proposed GNAP working group. Please refer to this document as:</em><a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"><strong>XAuth</strong><a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><em>The use of GNAP in this document is not intended to be a declaration of it being endorsed by the GNAP working group.</em><a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document describes the core Grant Negotiation and Authorization Protocol (GNAP). The protocol supports the widely deployed use cases supported by OAuth 2.0 <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> &amp; <span>[<a href="#RFC6750" class="xref">RFC6750</a>]</span>, OpenID Connect <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> - an extension of OAuth 2.0, as well as other extensions. Related documents include: GNAP - Advanced Features <span>[<a href="#GNAP_Advanced" class="xref">GNAP_Advanced</a>]</span> and JOSE Authentication <span>[<a href="#JOSE_Authentication" class="xref">JOSE_Authentication</a>]</span> that describes the JOSE mechanisms for client authentication.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The technology landscape has changed since OAuth 2.0 was initially drafted. More interactions happen on mobile devices than PCs. Modern browsers now directly support asymetric cryptographic functions. Standards have emerged for signing and encrypting tokens with rich payloads (JOSE) that are widely deployed.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">GNAP simplifies the overall architectural model, takes advantage of today's technology landscape, provides support for all the widely deployed use cases, offers numerous extension points, and addresses many of the security issues in OAuth 2.0 by passing parameters securely between parties rather than via a browser redirection.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">While GNAP is not backwards compatible with OAuth 2.0, it strives to minimize the migration effort.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">The suggested pronunciation of GNAP is "guh-nap".<a href="#section-1-9" class="pilcrow">¶</a></p>
<div id="the-grant">
<section id="section-1.1">
        <h3 id="name-the-grant">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-the-grant" class="section-name selfRef">The Grant</a>
        </h3>
<p id="section-1.1-1">The Grant is at the center of the protocol between a client and a server. A Grant Client requests a Grant from a Grant Server. The Grant Client and Grant Server negotiate the Grant. The Grant Server acquires authorization to grant the Grant to the Grant Client. The Grant Server then returns the Grant to the Grant Client.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The Grant Request may contain information about the User, the Grant Client, the interaction modes supported by the Grant Client, the requested identity claims, and the requested resource access. Extensions may define additional information to be included in the Grant Request.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ProtocolRoles">
<section id="section-1.2">
        <h3 id="name-protocol-roles">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-protocol-roles" class="section-name selfRef">Protocol Roles</a>
        </h3>
<p id="section-1.2-1">There are three roles in GNAP: the Grant Client (GC), the Grant Server (GS), and the Resource Server (RS). Below is how the roles interact:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-1.2-2">
<pre>
    +--------+                               +------------+
    | Grant  | - - - - - - -(1)- - - - - - -&gt;|  Resource  |
    | Client |                               |   Server   |
    |  (GC)  |       +---------------+       |    (RS)    |
    |        |--(2)-&gt;|     Grant     |       |            |
    |        |&lt;-(3)-&gt;|     Server    |- (6) -|            |
    |        |&lt;-(4)--|      (GS)     |       |            |
    |        |       +---------------+       |            |
    |        |                               |            |
    |        |--------------(5)-------------&gt;|            |
    +--------+                               +------------+
</pre><a href="#section-1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-1.2-3">(1) The GC may query the RS to determine what the RS requires from a GS for resource access. This step is not in scope for this document.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">(2) The GC makes a Grant request to the GS (Create Grant <a href="#CreateGrant" class="xref">Section 3.2</a>). How the GC authenticates to the GS is not in scope for this document. One mechanism is <span>[<a href="#JOSE_Authentication" class="xref">JOSE_Authentication</a>]</span>.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">(3) The GC and GS may negotiate the Grant.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">(4) The GS returns a Grant to the GC (Grant Response <a href="#GrantResponse" class="xref">Section 4.1</a>).<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<p id="section-1.2-7">(5) The GC accesses resources at the RS (RS Access <a href="#RSAccess" class="xref">Section 6</a>).<a href="#section-1.2-7" class="pilcrow">¶</a></p>
<p id="section-1.2-8">(6) The RS evaluates access granted by the GS to determine access granted to the GC. This step is not in scope for this document.<a href="#section-1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="human-interactions">
<section id="section-1.3">
        <h3 id="name-human-interactions">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-human-interactions" class="section-name selfRef">Human Interactions</a>
        </h3>
<p id="section-1.3-1">The Grant Client may be interacting with a human end-user (User), and the Grant Client may need to get authorization to release the Grant from the User, or from the owner of the resources at the Resource Server, the Resource Owner (RO)<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">Below is when the human interactions may occur in the protocol:<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-1.3-3">
<pre>
    +--------+                               +------------+
    |  User  |                               |  Resource  |
    |        |                               | Owner (RO) |
    +--------+                               +------------+
        +     +                             +
        +      +                           +
       (A)     (B)                       (C)
        +        +                       +
        +         +                     +
    +--------+     +                   +     +------------+
    | Grant  | - - -+- - - -(1)- - - -+- - -&gt;|  Resource  |
    | Client |       +               +       |   Server   |
    |  (GC)  |       +---------------+       |    (RS)    |
    |        |--(2)-&gt;|     Grant     |       |            |
    |        |&lt;-(3)-&gt;|     Server    |- (6) -|            |
    |        |&lt;-(4)--|      (GS)     |       |            |
    |        |       +---------------+       |            |
    |        |                               |            |
    |        |--------------(5)-------------&gt;|            |
    +--------+                               +------------+

Legend
+ + + indicates an interaction with a human
----- indicates an interaction between protocol roles
</pre><a href="#section-1.3-3" class="pilcrow">¶</a>
</div>
<p id="section-1.3-4">Steps (1) - (6) are the same as <a href="#ProtocolRoles" class="xref">Section 1.2</a>. The addition of the human interactions (A) - (C) are <strong>bolded</strong> below.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<p id="section-1.3-5"><strong>(A) The User is interacting with a GC, and the GC needs resource access and/or identity claims (a Grant)</strong><a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6">(1) The GC may query the RS to determine what the RS requires from a GS for resource access<a href="#section-1.3-6" class="pilcrow">¶</a></p>
<p id="section-1.3-7">(2) The GC makes a Grant request to the GS<a href="#section-1.3-7" class="pilcrow">¶</a></p>
<p id="section-1.3-8">(3) The GC and GS may negotiate the Grant<a href="#section-1.3-8" class="pilcrow">¶</a></p>
<p id="section-1.3-9"><strong>(B) The GS may interact with the User for grant authorization</strong><a href="#section-1.3-9" class="pilcrow">¶</a></p>
<p id="section-1.3-10"><strong>(C) The GS may interact with the RO for grant authorization</strong><a href="#section-1.3-10" class="pilcrow">¶</a></p>
<p id="section-1.3-11">(4) The GS returns a Grant to the GC<a href="#section-1.3-11" class="pilcrow">¶</a></p>
<p id="section-1.3-12">(5) The GC accesses resources at the RS<a href="#section-1.3-12" class="pilcrow">¶</a></p>
<p id="section-1.3-13">(6) The RS evaluates access granted by the GS to determine access granted to the GC<a href="#section-1.3-13" class="pilcrow">¶</a></p>
<p id="section-1.3-14">Alternatively, the Resource Owner could be a legal entity that has a software component that the Grant Server interacts with for Grant authorization. This interaction is not in scope of this document.<a href="#section-1.3-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-model">
<section id="section-1.4">
        <h3 id="name-trust-model">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-trust-model" class="section-name selfRef">Trust Model</a>
        </h3>
<p id="section-1.4-1">In addition to the User and the Resource Owner, there are three other entities that are part of the trust model:<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-2.1">
            <strong>Client Owner</strong> (CO) - the legal entity that owns the Grant Client.<a href="#section-1.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.4-2.2">
            <strong>Grant Server Owner</strong> (GSO) - the legal entity that owns the Grant Server.<a href="#section-1.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.4-2.3">
            <strong>Claims Issuer</strong> (Issuer) - a legal entity that issues identity claims about the User. The Grant Server Owner may be an Issuer, and the Resource Owner may be an Issuer.<a href="#section-1.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.4-3">These three entities do not interact in the protocol, but are trusted by the User and the Resource Owner:<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-1.4-4">
<pre>
  +------------+           +--------------+----------+
  |    User    | &gt;&gt; (A) &gt;&gt; | Grant Server |          |
  |            |           | Owner (GSO)  |          |
  +------------+         &gt; +--------------+          |
        V              /          ^       |  Claims  |
       (B)          (C)          (E)      |  Issuer  |
        V          /              ^       | (Issuer) |
  +------------+ &gt;         +--------------+          |
  |  Client    |           |   Resource   |          |
  | Owner (CO) | &gt;&gt; (D) &gt;&gt; |  Owner (RO)  |          |
  +------------+           +--------------+----------+
</pre><a href="#section-1.4-4" class="pilcrow">¶</a>
</div>
<p id="section-1.4-5">(A) User trusts the GSO to acquire authorization before making a grant to the CO<a href="#section-1.4-5" class="pilcrow">¶</a></p>
<p id="section-1.4-6">(B) User trusts the CO to act in the User's best interest with the Grant the GSO grants to the CO<a href="#section-1.4-6" class="pilcrow">¶</a></p>
<p id="section-1.4-7">(C) CO trusts claims issued by the GSO<a href="#section-1.4-7" class="pilcrow">¶</a></p>
<p id="section-1.4-8">(D) CO trusts claims issued by the RO<a href="#section-1.4-8" class="pilcrow">¶</a></p>
<p id="section-1.4-9">(E) RO trusts the GSO to manage access to the RO resources<a href="#section-1.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.5">
        <h3 id="name-terminology">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.5-1"><strong>Roles</strong><a href="#section-1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-2.1">
            <p id="section-1.5-2.1.1"><strong>Grant Client</strong> (GC)<a href="#section-1.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-2.1.2.1">may want access to resources at a Resource Server<a href="#section-1.5-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.1.2.2">may be interacting with a User and want identity claims about the User<a href="#section-1.5-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.1.2.3">requests the Grant Service to grant resource access and identity claims<a href="#section-1.5-2.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.5-2.2">
            <p id="section-1.5-2.2.1"><strong>Grant Server</strong> (GS)<a href="#section-1.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-2.2.2.1">accepts Grant requests from the GC for resource access and identity claims<a href="#section-1.5-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.2.2.2">negotiates the interaction mode with the GC if interaction is required with the User<a href="#section-1.5-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.2.2.3">acquires authorization from the User before granting identity claims to the GC<a href="#section-1.5-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.2.2.4">acquires authorization from the RO before granting resource access to the GC<a href="#section-1.5-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.2.2.5">grants resource access and identity claims to the GC<a href="#section-1.5-2.2.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.5-2.3">
            <p id="section-1.5-2.3.1"><strong>Resource Server</strong> (RS)<a href="#section-1.5-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-2.3.2.1">has resources that the GC may want to access<a href="#section-1.5-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.3.2.2">expresses what the GC must obtain from the GS for access through documentation or an API. This is not in scope for this document<a href="#section-1.5-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.3.2.3">verifies the GS granted access to the GC, when the GS makes resource access requests<a href="#section-1.5-2.3.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-1.5-3"><strong>Humans</strong><a href="#section-1.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-4.1">
            <p id="section-1.5-4.1.1"><strong>User</strong><a href="#section-1.5-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-4.1.2.1">the person interacting with the Grant Client.<a href="#section-1.5-4.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-4.1.2.2">has delegated access to identity claims about themselves to the Grant Server.<a href="#section-1.5-4.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-4.1.2.3">may authenticate at the GS.<a href="#section-1.5-4.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.5-4.2">
            <p id="section-1.5-4.2.1"><strong>Resource Owner</strong> (RO)<a href="#section-1.5-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-4.2.2.1">the legal entity that owns resources at the Resource Server (RS).<a href="#section-1.5-4.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-4.2.2.2">has delegated resource access management to the GS.<a href="#section-1.5-4.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-4.2.2.3">may be the User, or may be a different entity that the GS interacts with independently.<a href="#section-1.5-4.2.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-1.5-5"><strong>Reused Terms</strong><a href="#section-1.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-6.1">
            <strong>access token</strong> - an access token as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> Section 1.4. An GC uses an access token for resource access at a RS.<a href="#section-1.5-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-6.2">
            <strong>Claim</strong> - a Claim as defined in <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 5. Claims are issued by a Claims Issuer.<a href="#section-1.5-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-6.3">
            <strong>Client ID</strong> - a GS unique identifier for a Registered Client as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> Section 2.2.<a href="#section-1.5-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-6.4">
            <strong>ID Token</strong> - an ID Token as defined in <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 2. ID Tokens are issued by the GS. The GC uses an ID Token to authenticate the User.<a href="#section-1.5-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-6.5">
            <strong>NumericDate</strong> - a NumericDate as defined in <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> Section 2.<a href="#section-1.5-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-6.6">
            <strong>authN</strong> - short for authentication.<a href="#section-1.5-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-6.7">
            <strong>authZ</strong> - short for authorization.<a href="#section-1.5-6.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.5-7"><strong>New Terms</strong><a href="#section-1.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-8.1">
            <strong>GS URI</strong> - the endpoint at the GS the GC calls to create a Grant, and is the unique identifier for the GS.<a href="#section-1.5-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-8.2">
            <strong>Registered Client</strong> - a GC that has registered with the GS and has a Client ID to identify itself, and can prove it possesses a key that is linked to the Client ID. The GS may have different policies for what different Registered Clients can request. A Registered Client MAY be interacting with a User.<a href="#section-1.5-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-8.3">
            <strong>Dynamic Client</strong> - a GC that has not been previously registered with the GS, and each instance will generate it's own asymetric key pair so it can prove it is the same instance of the GC on subsequent requests. The GS MAY return a Dynamic Client a Client Handle for the Dynamic Client to identify itself in subsequent requests. A single-page application with no active server component is an example of a Dynamic Client.<a href="#section-1.5-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-8.4">
            <strong>Client Handle</strong> - a unique identifier at the GS for a Dynamic Client for the Dynamic Client to refer to itself in subsequent requests.<a href="#section-1.5-8.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-8.5">
            <strong>Interaction</strong> - how the GC directs the User to interact with the GS. This document defines the interaction modes: "redirect", "indirect", and "user_code" in <a href="#InteractionModes" class="xref">Section 5</a>.<a href="#section-1.5-8.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-8.6">
            <strong>Grant</strong> - the user identity claims and/or resource access the GS has granted to the Client. The GS MAY invalidate a Grant at any time.<a href="#section-1.5-8.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-8.7">
            <strong>Grant URI</strong>  - the URI that represents the Grant. The Grant URI MUST start with the GS URI.<a href="#section-1.5-8.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-8.8">
            <strong>Access</strong> - the access granted by the RO to the GC and contains an access token. The GS may invalidate an Access at any time.<a href="#section-1.5-8.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-8.9">
            <strong>Access URI</strong> - the URI that represents the Access the GC was granted by the RO. The Access URI MUST start with the GS URI. The Access URI is used to refresh an access token.<a href="#section-1.5-8.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="notational-conventions">
<section id="section-1.6">
        <h3 id="name-notational-conventions">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-1.6-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
specification are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1.6-1" class="pilcrow">¶</a></p>
<p id="section-1.6-2">Certain security-related terms are to be understood in the sense
defined in <span>[<a href="#RFC4949" class="xref">RFC4949</a>]</span>.  These terms include, but are not limited to,
"attack", "authentication", "authorization", "certificate",
"confidentiality", "credential", "encryption", "identity", "sign",
"signature", "trust", "validate", and "verify".<a href="#section-1.6-2" class="pilcrow">¶</a></p>
<p id="section-1.6-3"><em>[Editor: review that the terms listed and used are the same]</em><a href="#section-1.6-3" class="pilcrow">¶</a></p>
<p id="section-1.6-4">Unless otherwise noted, all the protocol parameter names and values
are case sensitive.<a href="#section-1.6-4" class="pilcrow">¶</a></p>
<p id="section-1.6-5">Some protocol parameters are parts of a JSON document, and are referred to in JavaScript notation. For example, <code>foo.bar</code> refers to the "bar" boolean attribute in the "foo" object in the following example JSON document:<a href="#section-1.6-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-1.6-6">
<pre>
{
    "foo" : {
        "bar": true
    }
}
</pre><a href="#section-1.6-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="exemplar-sequences">
<section id="section-2">
      <h2 id="name-exemplar-sequences">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-exemplar-sequences" class="section-name selfRef">Exemplar Sequences</a>
      </h2>
<p id="section-2-1">The following sequences are demonstrative of how GNAP can be used, but are just a few of the possible sequences possible with GNAP.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Before any sequence, the GC needs to be manually or programmatically configured for the GS. See GS Options 
<a href="#GSoptions" class="xref">Section 3.7</a> for details on programmatically acquiring GS metadata.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">In the sequence diagrams:<a href="#section-2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2-4">
<pre>
+ + + indicates an interaction with a person
----- indicates an interaction between protocol roles
</pre><a href="#section-2-4" class="pilcrow">¶</a>
</div>
<div id="redirect-interaction">
<section id="section-2.1">
        <h3 id="name-redirect-interaction">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-redirect-interaction" class="section-name selfRef">"redirect" Interaction</a>
        </h3>
<p id="section-2.1-1">The GC is a web application and wants a Grant from the User containing resource access and identity claims. The User is the RO for the resource:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1-2">
<pre>
+--------+                                  +--------+
| Grant  |                                  | Grant  |
| Client |--(1)--- Create Grant -----------&gt;| Server |
|  (GC)  |                                  |  (GS)  |
|        |&lt;--- Interaction Response ---(2)--|        |         +------+
|        |                                  |        |         | User |
|        |+ +(3)+ + Interaction Transfer + +| + + + +|+ + + + &gt;|      |
|        |                                  |        |         |      |
|        |                                  |        |&lt;+ (4) +&gt;|      |
|        |                                  |        |  authN  |      |
|        |                                  |        |         |      |
|        |                                  |        |&lt;+ (5) +&gt;|      |
|        |                                  |        |  authZ  |      |
|        |&lt;+ + Interaction Transfer + +(6)+ | + + + +|+ + + + +|      |
|        |                                  |        |         |      |
|        |--(7)--- Verify Grant -----------&gt;|        |         +------+
|        |                                  |        |
|        |&lt;--------- Grant Response ---(8)--|        |
|        |                                  |        |
+--------+                                  +--------+
</pre><a href="#section-2.1-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-2.1-3">
          <li id="section-2.1-3.1">
            <strong>Create Grant</strong> The GC creates a Request JSON document <a href="#RequestJSON" class="xref">Section 3.5</a> containing an interaction.redirect object, and the requested identity claims and resource access. The GC then makes a Create Grant request (<a href="#CreateGrant" class="xref">Section 3.2</a>) by sending the JSON with an HTTP POST to the GS URI.<a href="#section-2.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.2">
            <strong>Interaction Response</strong>  The GS determines that interaction with the User is required and sends an Interaction Response (<a href="#InteractionResponse" class="xref">Section 4.2</a>) containing the Grant URI and an interaction.redirect object containing the redirect_uri.<a href="#section-2.1-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.3">
            <strong>Interaction Transfer</strong> The GC redirects the User to the redirect_uri at the GS.<a href="#section-2.1-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.4">
            <strong>User Authentication</strong> The GS authenticates the User.<a href="#section-2.1-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.5">
            <strong>User Authorization</strong> If required, the GS interacts with the User (who may also be the RO) to determine the identity claims and resource access in the Grant Request are to be granted.<a href="#section-2.1-3.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.6">
            <strong>Interaction Transfer</strong> The GS redirects the User to the completion_uri at the GC.<a href="#section-2.1-3.6" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.7">
            <strong>Verify Grant</strong> The GC makes an HTTP PATCH request to the Grant URI passing the verification code (<a href="#VerifyGrant" class="xref">Section 3.3</a>).<a href="#section-2.1-3.7" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.8">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 4.1</a>).<a href="#section-2.1-3.8" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.1-4">The GC can now access the resources at the RS per <a href="#RSA" class="xref">Section 2.4</a>.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="usercode-interaction">
<section id="section-2.2">
        <h3 id="name-user_code-interaction">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-user_code-interaction" class="section-name selfRef">"user_code" Interaction</a>
        </h3>
<p id="section-2.2-1">A GC is on a device that wants a Grant from the User. The User will interact with the GS using a separate device:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-2">
<pre>
+--------+                                  +--------+
| Grant  |                                  | Grant  |
| Client |--(1)--- Create Grant -----------&gt;| Server |
|  (GC)  |                                  |  (GS)  |
|        |&lt;--- Interaction Response ---(2)--|        |         +------+
|        |                                  |        |         | User |
|        |--(3)--- Read Grant -------------&gt;|        |         |      |
|        |                                  |        |&lt;+ (4) +&gt;|      |
|        |                                  |        |  authN  |      |
|        |                                  |        |         |      |
|        |                                  |        |&lt;+ (5) +&gt;|      |
|        |                                  |        |  code   |      |
|        |                                  |        |         |      |
|        |                                  |        |&lt;+ (6) +&gt;|      |
|        |                                  |        |  authZ  |      |
|        |                                  |        |         |      |
|        |&lt;--------- Grant Response ---(7)--|        |         |      |
|        |                                  |        |         |      |
+--------+                                  |        |         |      |
                                            |        |         |      |
+--------+                                  |        |         |      |
| Client |&lt; + + Information URI Redirect + +| + + + +|+ (8) + +|      |
| Server |                                  |        |         |      |
+--------+                                  +--------+         +------+
</pre><a href="#section-2.2-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-2.2-3">
          <li id="section-2.2-3.1">
            <strong>Create Grant</strong> The GC creates a Request JSON document <a href="#RequestJSON" class="xref">Section 3.5</a> containing an interaction.user_code object and makes a Create Grant request (<a href="#CreateGrant" class="xref">Section 3.2</a>) by sending the JSON with an HTTP POST to the GS URI.<a href="#section-2.2-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-3.2">
            <strong>Interaction Response</strong>  The GS determines that interaction with the User is required and sends an Interaction Response (<a href="#InteractionResponse" class="xref">Section 4.2</a>) containing the Grant URI and an interaction.user_code object.<a href="#section-2.2-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-3.3">
            <strong>Read Grant</strong> The GC makes an HTTP GET request to the Grant URI.<a href="#section-2.2-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-3.4">
            <strong>User Authentication</strong> The User loads display_uri in their browser, and the GS authenticates the User.<a href="#section-2.2-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-3.5">
            <strong>User Code</strong> The User enters the code at the GS.<a href="#section-2.2-3.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-3.6">
            <strong>User Authorization</strong> If required, the GS interacts with the User (who may also be the RO) to determine the identity claims and resource access in the Grant Request are to be granted.<a href="#section-2.2-3.6" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-3.7">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 4.1</a>).<a href="#section-2.2-3.7" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-3.8">
            <strong>Information URI Redirect</strong> The GS redirects the User to the information_uri provided by the GC.<a href="#section-2.2-3.8" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.2-4">The GC can now access the resources at the RS per <a href="#RSA" class="xref">Section 2.4</a>.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="independent-ro-authorization">
<section id="section-2.3">
        <h3 id="name-independent-ro-authorizatio">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-independent-ro-authorizatio" class="section-name selfRef">Independent RO Authorization</a>
        </h3>
<p id="section-2.3-1">The GC wants access to resources that require the GS to interact with the RO, who is not interacting with the GC. The authorization from the RO may take some time, so the GS instructs the GC to wait and check back later.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.3-2">
<pre>
+--------+                                  +--------+
| Grant  |                                  | Grant  |
| Client |--(1)--- Create Grant -----------&gt;| Server |
|  (GC)  |                                  |  (GS)  |
|        |&lt;---------- Wait Response ---(2)--|        |         +------+
|  (3)   |                                  |        |         |  RO  |
|  Wait  |                                  |        |&lt;+ (4) +&gt;|      |
|        |                                  |        |  authZ  |      |
|        |--(5)--- Read Grant -------------&gt;|        |         +------+
|        |                                  |        |
|        |&lt;--------- Grant Response --(6)---|        |
|        |                                  |        |
+--------+                                  +--------+
</pre><a href="#section-2.3-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-2.3-3">
          <li id="section-2.3-3.1">
            <strong>Create Grant</strong> The GC creates a Grant Request (<a href="#CreateGrant" class="xref">Section 3.2</a>) and sends it with an HTTP POST to the GS GS URI.<a href="#section-2.3-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-3.2">
            <strong>Wait Response</strong>  The GS sends an Wait Response (<a href="#WaitResponse" class="xref">Section 4.3</a>) containing the Grant URI and the "wait" attribute.<a href="#section-2.3-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-3.3">
            <strong>GC Waits</strong> The GC waits for the time specified in the "wait" attribute.<a href="#section-2.3-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-3.4">
            <strong>RO AuthZ</strong> The GS interacts with the RO to determine which identity claims and/or resource access in the Grant Request are to be granted.<a href="#section-2.3-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-3.5">
            <strong>Read Grant</strong> The GC does an HTTP GET of the Grant URI (<a href="#ReadGrant" class="xref">Section 3.4</a>).<a href="#section-2.3-3.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-3.6">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 4.1</a>).<a href="#section-2.3-3.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.3-4">The GC can now access the resources at the RS per <a href="#RSA" class="xref">Section 2.4</a>.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RSA">
<section id="section-2.4">
        <h3 id="name-resource-server-access">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-resource-server-access" class="section-name selfRef">Resource Server Access</a>
        </h3>
<p id="section-2.4-1">The GC received an Access URI from the GS. The GC acquires an access token, calls the RS, and later the access token expires. The GC then gets a fresh access token.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.4-2">
<pre>
+--------+                             +----------+  +--------+
| Grant  |                             | Resource |  | Grant  |
| Client |--(1)--- Access Resource ---&gt;|  Server  |  | Server |
|  (GC)  |&lt;------- Resource Response --|   (RS)   |  |  (GS)  |
|        |                             |          |  |        |
|        |--(2)--- Access Resource ---&gt;|          |  |        |
|        |&lt;------- Error Response -----|          |  |        |
|        |                             |          |  |        |
|        |                             +----------+  |        |
|        |                                           |        |
|        |--(3)--- Read Access ---------------------&gt;|        |
|        |&lt;------- Access Response ------------------|        |
|        |                                           |        |
+--------+                                           +--------+
</pre><a href="#section-2.4-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-2.4-3">
          <li id="section-2.4-3.1">
            <strong>Resource Request</strong> The GC accesses the RS with the access token per <a href="#RSAccess" class="xref">Section 6</a> and receives a response from the RS.<a href="#section-2.4-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-3.2">
            <strong>Resource Request</strong> The GC attempts to access the RS, but receives an error indicating the access token needs to be refreshed.<a href="#section-2.4-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-3.3">
            <strong>Read Access</strong> The GC makes a Read Access (<a href="#ReadAccess" class="xref">Section 3.6</a>) with an HTTP GET to the Access URI and receives as Response JSON "access" object (<a href="#ResponseAccessObject" class="xref">Section 4.4.4</a>) with a fresh access token.<a href="#section-2.4-3.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="gs-apis">
<section id="section-3">
      <h2 id="name-gs-apis">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-gs-apis" class="section-name selfRef">GS APIs</a>
      </h2>
<p id="section-3-1"><strong>GC Authentication</strong><a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">All GS APIs except for GS Options require the GC to authenticate. Authentication mechanisms include:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">JOSE Authentication <span>[<a href="#JOSE_Authentication" class="xref">JOSE_Authentication</a>]</span><a href="#section-3-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-3.2">[Others TBD]*<a href="#section-3-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<div id="gs-api-table">
<section id="section-3.1">
        <h3 id="name-gs-api-table">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-gs-api-table" class="section-name selfRef">GS API Table</a>
        </h3>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">request</th>
              <th class="text-left" rowspan="1" colspan="1">http method</th>
              <th class="text-left" rowspan="1" colspan="1">uri</th>
              <th class="text-left" rowspan="1" colspan="1">response</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Create Grant</td>
              <td class="text-left" rowspan="1" colspan="1">POST</td>
              <td class="text-left" rowspan="1" colspan="1">GS URI</td>
              <td class="text-left" rowspan="1" colspan="1">Interaction, wait, or Grant</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Verify Grant</td>
              <td class="text-left" rowspan="1" colspan="1">PATCH</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">Grant</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Read Grant</td>
              <td class="text-left" rowspan="1" colspan="1">GET</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">wait, or Grant</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Read Access</td>
              <td class="text-left" rowspan="1" colspan="1">GET</td>
              <td class="text-left" rowspan="1" colspan="1">Access URI</td>
              <td class="text-left" rowspan="1" colspan="1">Access</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">GS Options</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONS</td>
              <td class="text-left" rowspan="1" colspan="1">GS URI</td>
              <td class="text-left" rowspan="1" colspan="1">metadata</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="CreateGrant">
<section id="section-3.2">
        <h3 id="name-create-grant">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-create-grant" class="section-name selfRef">Create Grant</a>
        </h3>
<p id="section-3.2-1">The GC creates a Grant by doing an HTTP POST of a JSON <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span> document to the GS URI. This is a Grant Request.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The JSON document MUST include the following from the Request JSON <a href="#RequestJSON" class="xref">Section 3.5</a>:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">iat<a href="#section-3.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-3.2">nonce<a href="#section-3.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-3.3">uri - MUST be set to the GS URI<a href="#section-3.2-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-3.4">method - MUST be "POST"<a href="#section-3.2-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-3.5">client<a href="#section-3.2-3.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-4">and MAY include the following from Request JSON <a href="#RequestJSON" class="xref">Section 3.5</a><a href="#section-3.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-5.1">user<a href="#section-3.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-5.2">interaction<a href="#section-3.2-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-5.3">access<a href="#section-3.2-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-5.4">claims<a href="#section-3.2-5.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-6">The GS MUST respond with one of Grant Response <a href="#GrantResponse" class="xref">Section 4.1</a>, Interaction Response <a href="#InteractionResponse" class="xref">Section 4.2</a>, Wait Response <a href="#WaitResponse" class="xref">Section 4.3</a>, or one of the following errors:<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-7.1">TBD<a href="#section-3.2-7.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-8">from Error Responses <a href="#ErrorResponses" class="xref">Section 7</a>.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">Following is a non-normative example of a web application GC requesting identity claims about the User and read access to the User's contacts:<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-10">
<pre>
Example 1

{
    "iat"       : 15790460234,
    "uri"       : "https://as.example/endpoint",
    "method"    : "POST,
    "nonce"     : "f6a60810-3d07-41ac-81e7-b958c0dd21e4",
    "client": {
        "display": {
            "name"  : "SPA Display Name",
            "uri"   : "https://spa.example/about"
        }
    },
    "interaction": {
        "redirect": {
            "completion_uri"    : "https://web.example/return"
        },
        "global" : {
            "ui_locals" : "de"
        }
    },
    "access": [ "read_contacts" ],
    "claims": {
        "oidc": {
            "id_token" : {
                "email"          : { "essential" : true },
                "email_verified" : { "essential" : true }
            },
            "userinfo" : {
                "name"           : { "essential" : true },
                "picture"        : null
            }
        }
    }
}
</pre><a href="#section-3.2-10" class="pilcrow">¶</a>
</div>
<p id="section-3.2-11">Following is a non-normative example of a device GC requesting two different access tokens, one request with "oauth_scope", the other with "oauth_rich":<a href="#section-3.2-11" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-12">
<pre>
Example 2

{
    "iat"       : 15790460234,
    "uri"       : "https://as.example/endpoint",
    "method"    : "POST,
    "nonce"     : "5c9360a5-9065-4f7b-a330-5713909e06c6",
    "client": {
        "id"        : "di3872h34dkJW"
    },
    "interaction": {
        "indirect": {
            "information_uri": "https://device.example/c/indirect"
        },
        "user_code": {
            "information_uri": "https://device.example/c/user_code"
         }
    },
    "access": {
        "play_music": [ "play_music" ],
        "read_user_info: [ {
            "type"      : "customer_information",
            "locations" : [ "https://example.com/customers" ],
            "actions"   : [ "read" ],
            "datatypes" : [ "contacts", "photos" ]
        } ]
    }
}
</pre><a href="#section-3.2-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="VerifyGrant">
<section id="section-3.3">
        <h3 id="name-verify-grant">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-verify-grant" class="section-name selfRef">Verify Grant</a>
        </h3>
<p id="section-3.3-1">The GC verifies a Grant by doing an HTTP PATCH of a JSON document to the Grant URI. The GC MUST only verify a Grant once.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The JSON document MUST include the following from the Request JSON <a href="#RequestJSON" class="xref">Section 3.5</a>:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-3.1">iat<a href="#section-3.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-3.2">nonce<a href="#section-3.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-3.3">uri - MUST be set to the Grant URI<a href="#section-3.3-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-3.4">method - MUST be PATCH<a href="#section-3.3-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-3.5">interaction.redirection.verification - MUST be the verification code received per <a href="#RedirectVerification" class="xref">Section 5.1.1</a>.<a href="#section-3.3-3.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-4">Following is a non-normative example:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-5">
<pre>
{
    "iat"     : 15790460235,
    "uri"     : "https://as.example/endpoint/grant/example1",
    "method"  : "PATCH,
    "nonce"   : "9b6afd70-2036-47c9-b953-5dd1fd0c699a",
    "interaction": {
        "redirect": {
            "verification" : "cb4aa22d-2fe1-4321-b87e-bbaa66fbe707"
        }
    }
}
</pre><a href="#section-3.3-5" class="pilcrow">¶</a>
</div>
<p id="section-3.3-6">The GS MUST respond with one of Grant Response <a href="#GrantResponse" class="xref">Section 4.1</a> or one of the following errors:<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-7.1">TBD<a href="#section-3.3-7.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ReadGrant">
<section id="section-3.4">
        <h3 id="name-read-grant">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-read-grant" class="section-name selfRef">Read Grant</a>
        </h3>
<p id="section-3.4-1">The GC reads a Grant by doing an HTTP GET of the corresponding Grant URI. The GC MAY read a Grant until it expires or has been invalidated.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">The GS MUST respond with one of Grant Response <a href="#GrantResponse" class="xref">Section 4.1</a>, Wait Response <a href="#WaitResponse" class="xref">Section 4.3</a>, or one of the following errors:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-3.1">TBD<a href="#section-3.4-3.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="RequestJSON">
<section id="section-3.5">
        <h3 id="name-request-json">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-request-json" class="section-name selfRef">Request JSON</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-3.5-1.1">
            <strong>iat</strong> - the time of the request as a NumericDate.<a href="#section-3.5-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-1.2">
            <strong>nonce</strong> - a unique identifier for this request. Note the Grant Response MUST contain a matching "nonce" attribute value.<a href="#section-3.5-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-1.3">
            <strong>uri</strong> - the URI being invoked<a href="#section-3.5-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-1.4">
            <strong>method</strong> - the HTTP method being used<a href="#section-3.5-1.4" class="pilcrow">¶</a>
</li>
        </ul>
<div id="client-object">
<section id="section-3.5.1">
          <h4 id="name-client-object">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-client-object" class="section-name selfRef">"client" Object</a>
          </h4>
<p id="section-3.5.1-1">The client object MUST only one of the following:<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1-2.1">
              <strong>id</strong> - the Client ID the GS has for a Registered Client.<a href="#section-3.5.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.1-2.2">
              <strong>handle</strong> - the Client Handle the GS previously provided a Dynamic Client<a href="#section-3.5.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.1-2.3">
              <p id="section-3.5.1-2.3.1"><strong>display</strong> - the display object contains the following attributes:<a href="#section-3.5.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1-2.3.2.1">
                  <strong>name</strong> - a string that represents the Dynamic Client<a href="#section-3.5.1-2.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.5.1-2.3.2.2">
                  <strong>uri</strong> - a URI representing the Dynamic Client<a href="#section-3.5.1-2.3.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.5.1-3">The GS will show the the User the display.name and display.uri values when prompting for authorization.<a href="#section-3.5.1-3" class="pilcrow">¶</a></p>
<p id="section-3.5.1-4"><em>[Editor: a max length for the name and URI so a GS can reserve appropriate space?]</em><a href="#section-3.5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interaction-object">
<section id="section-3.5.2">
          <h4 id="name-interaction-object">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-interaction-object" class="section-name selfRef">"interaction" Object</a>
          </h4>
<p id="section-3.5.2-1">The interaction object contains one or more interaction mode objects per <a href="#InteractionModes" class="xref">Section 5</a> representing the interactions the GC is willing to provide the User. In addition to the interaction mode objects, the interaction object may contain the "global" object;<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2-2.1">
              <p id="section-3.5.2-2.1.1"><strong>global</strong> - an optional object containing parameters that are applicable for all interaction modes. Only one attribute is defined in this document:<a href="#section-3.5.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2-2.1.2.1">
                  <strong>ui_locales</strong> - End-User's preferred languages and scripts for the user interface, represented as a space-separated list of <span>[<a href="#RFC5646" class="xref">RFC5646</a>]</span> language tag values, ordered by preference. This attribute is OPTIONAL.<a href="#section-3.5.2-2.1.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.5.2-3"><em>[Editor: ui_locales is taken from OIDC. Why space-separated and not a JSON array?]</em><a href="#section-3.5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RequestUserObject">
<section id="section-3.5.3">
          <h4 id="name-user-object">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-user-object" class="section-name selfRef">"user" Object</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.5.3-1.1">
              <p id="section-3.5.3-1.1.1"><strong>identifiers</strong> - The identifiers MAY be used by the GS to improve the User experience. This object contains one or more of the following identifiers for the User:<a href="#section-3.5.3-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.3-1.1.2.1">
                  <strong>phone_number</strong> - contains a phone number per Section 5 of <span>[<a href="#RFC3966" class="xref">RFC3966</a>]</span>.<a href="#section-3.5.3-1.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.5.3-1.1.2.2">
                  <strong>email</strong> - contains an email address per <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span>.<a href="#section-3.5.3-1.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.5.3-1.1.2.3">
                  <strong>oidc</strong> - is an object containing both the "iss" and "sub" attributes from an OpenID Connect ID Token <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 2.<a href="#section-3.5.3-1.1.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-3.5.3-1.2">
              <p id="section-3.5.3-1.2.1"><strong>claims</strong> - an optional object containing one or more assertions the GC has about the User.<a href="#section-3.5.3-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.3-1.2.2.1">
                  <strong>oidc_id_token</strong> - an OpenID Connect ID Token per <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 2.<a href="#section-3.5.3-1.2.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="AccessObject">
<section id="section-3.5.4">
          <h4 id="name-access-object">
<a href="#section-3.5.4" class="section-number selfRef">3.5.4. </a><a href="#name-access-object" class="section-name selfRef">"access" Object</a>
          </h4>
<p id="section-3.5.4-1">The GC may request a single Access, or multiple. If a single Access, the "access" object contains an array of <span>[<a href="#RAR" class="xref">RAR</a>]</span> objects. If multiple, the "access" object
contains an object where each property name is a unique string created by the GC, and the property value is an array of <span>[<a href="#RAR" class="xref">RAR</a>]</span> objects.<a href="#section-3.5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ClaimsObject">
<section id="section-3.5.5">
          <h4 id="name-claims-object">
<a href="#section-3.5.5" class="section-number selfRef">3.5.5. </a><a href="#name-claims-object" class="section-name selfRef">"claims" Object</a>
          </h4>
<p id="section-3.5.5-1">Includes one or more of the following:<a href="#section-3.5.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.5-2.1">
              <p id="section-3.5.5-2.1.1"><strong>oidc</strong> - an object that contains one or both of the following objects:<a href="#section-3.5.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.5-2.1.2.1">
                  <strong>userinfo</strong> - Claims that will be returned as a JSON object<a href="#section-3.5.5-2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.5.5-2.1.2.2">
                  <strong>id_token</strong> - Claims that will be included in the returned ID Token. If the null value, an ID Token will be returned containing no additional Claims.<a href="#section-3.5.5-2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.5.5-3">The contents of the userinfo and id_token objects are Claims as defined in <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 5.<a href="#section-3.5.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.5-4.1">
              <strong>oidc4ia</strong> - OpenID Connect for Identity Assurance claims request per <span>[<a href="#OIDC4IA" class="xref">OIDC4IA</a>]</span>.<a href="#section-3.5.5-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.5-4.2">
              <strong>vc</strong> - <em>[Editor: define how W3C Verifiable Credentials  can be requested.]</em><span>[<a href="#W3C_VC" class="xref">W3C_VC</a>]</span><a href="#section-3.5.5-4.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="ReadAccess">
<section id="section-3.6">
        <h3 id="name-read-access">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-read-access" class="section-name selfRef">Read Access</a>
        </h3>
<p id="section-3.6-1">The GC acquires and refreshes an Access by doing an HTTP GET to the corresponding Access URI.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">The GS MUST respond with a Access JSON document <a href="#AccessJSON" class="xref">Section 4.5</a>, or one of the following errors:<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-3.1">TBD<a href="#section-3.6-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-4">from Error Responses <a href="#ErrorResponses" class="xref">Section 7</a>.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="GSoptions">
<section id="section-3.7">
        <h3 id="name-gs-options">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-gs-options" class="section-name selfRef">GS Options</a>
        </h3>
<p id="section-3.7-1">The GC can get the metadata for the GS by doing an HTTP OPTIONS of the corresponding GS URI. This is the only API where the GS MAY respond to an unauthenticated request.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">The GS MUST respond with the the following JSON document:<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-3.1">
            <strong>uri</strong> - the GS URI.<a href="#section-3.7-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.7-3.2">
            <strong>client_authentication</strong> - a JSON array of the GC Authentication mechanisms supported by the GS<a href="#section-3.7-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.7-3.3">
            <strong>interactions</strong> - a JSON array of the interaction modes supported by the GS.<a href="#section-3.7-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.7-3.4">
            <p id="section-3.7-3.4.1"><strong>access</strong> - an object containing the access the GC may request from the GS, if any.<a href="#section-3.7-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-3.4.2.1">Details TBD<a href="#section-3.7-3.4.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.7-3.5">
            <p id="section-3.7-3.5.1"><strong>claims</strong> - an object containing the identity claims the GC may request from the GS, if any, and what public keys the claims will be signed with.<a href="#section-3.7-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-3.5.2.1">Details TBD<a href="#section-3.7-3.5.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.7-3.6">
            <strong>algorithms</strong> - a JSON array of the cryptographic algorithms supported by the GS. [details TBD]*<a href="#section-3.7-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.7-3.7">
            <strong>features</strong> - an object containing feature or extension support<a href="#section-3.7-3.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.7-4">or one of the following errors:<a href="#section-3.7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-5.1">TBD<a href="#section-3.7-5.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.7-6">from Error Responses <a href="#ErrorResponses" class="xref">Section 7</a>.<a href="#section-3.7-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gs-responses">
<section id="section-4">
      <h2 id="name-gs-responses">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-gs-responses" class="section-name selfRef">GS Responses</a>
      </h2>
<p id="section-4-1">There are three successful responses to a Grant Request: Grant Response, Interaction Response, or Wait Response.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="GrantResponse">
<section id="section-4.1">
        <h3 id="name-grant-response">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-grant-response" class="section-name selfRef">Grant Response</a>
        </h3>
<p id="section-4.1-1">The Grant Response MUST include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 4.4</a><a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">iat<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-2.2">nonce<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-2.3">uri<a href="#section-4.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-3">and MAY include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 4.4</a><a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">client.handle<a href="#section-4.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-4.2">access<a href="#section-4.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-4.3">claims<a href="#section-4.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-4.4">expires_in<a href="#section-4.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-4.5">warnings<a href="#section-4.1-4.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-5">Example non-normative Grant Response JSON document for Example 1 in <a href="#CreateGrant" class="xref">Section 3.2</a>:<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-6">
<pre>
{
    "iat"           : 15790460234,
    "nonce"         : "f6a60810-3d07-41ac-81e7-b958c0dd21e4",
    "uri"           : "https://as.example/endpoint/grant/example1",
    "expires_in"    : 300
    "access": {
        "mechanism"     : "bearer",
        "token"         : "eyJJ2D6.example.access.token.mZf9p"
        "expires_in"    : 3600,
        "granted"       : [ "read_contacts" ],
    },
    "claims": {
        "oidc": {
            "id_token"      : "eyJhbUzI1N.example.id.token.YRw5DFdbW",
            "userinfo" : {
                "name"      : "John Doe",
                "picture"   : "https://photos.example/p/eyJzdkiO"
            }
        }
    }
}
</pre><a href="#section-4.1-6" class="pilcrow">¶</a>
</div>
<p id="section-4.1-7">Note in this example since no Access URI was returned in the access object, the access token can not be refreshed, and expires in an hour.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">Example non-normative Grant Response JSON document for Example 2 in <a href="#CreateGrant" class="xref">Section 3.2</a>:<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-9">
<pre>
{
    "iat"   : 15790460234,
    "nonce" : "5c9360a5-9065-4f7b-a330-5713909e06c6",
    "uri"   : "https://as.example/endpoint/grant/example2",
    "access": {
        "play_music": { "uri"       : "https://as.example/endpoint/access/example2" },
        "read_user_info: { "uri"    " "https://as.example/endpoint/access/"}
    }
}
</pre><a href="#section-4.1-9" class="pilcrow">¶</a>
</div>
<p id="section-4.1-10">Note in this example the GS only provided the Access URIs. The GC must acquire the Access per <a href="#ReadAccess" class="xref">Section 3.6</a><a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">[Editor: the GC needs to remember if it asked for a single access, or multiple, as there is no crisp algorithm for differentiating between the responses]<a href="#section-4.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="InteractionResponse">
<section id="section-4.2">
        <h3 id="name-interaction-response">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-interaction-response" class="section-name selfRef">Interaction Response</a>
        </h3>
<p id="section-4.2-1">The Interaction Response MUST include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 4.4</a><a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">iat<a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.2">nonce<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.3">uri<a href="#section-4.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.4">interaction<a href="#section-4.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-3">and MAY include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 4.4</a><a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-4.1">user<a href="#section-4.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-4.2">wait<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-4.3">warnings<a href="#section-4.2-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-5">A non-normative example of an Interaction Response follows:<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-6">
<pre>
{
    "iat"       : 15790460234,
    "nonce"     : "0d1998d8-fbfa-4879-b942-85a88bff1f3b",
    "uri"       : "https://as.example/endpoint/grant/example4",
    "interaction" : {
        "redirect" : {
            "redirect_uri"     : "https://as.example/i/example4"
        }
    }
}
</pre><a href="#section-4.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="WaitResponse">
<section id="section-4.3">
        <h3 id="name-wait-response">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-wait-response" class="section-name selfRef">Wait Response</a>
        </h3>
<p id="section-4.3-1">The Wait Response MUST include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 4.4</a><a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">iat<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-2.2">nonce<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-2.3">uri<a href="#section-4.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-2.4">wait<a href="#section-4.3-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-3">and MAY include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 4.4</a><a href="#section-4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-4.1">warnings<a href="#section-4.3-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-5">A non-normative example of Wait Response follows:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-6">
<pre>
{
    "iat"       : 15790460234,
    "nonce"     : "0d1998d8-fbfa-4879-b942-85a88bff1f3b",
    "uri"       : "https://as.example/endpoint/grant/example5",
    "wait"      : 300
}
</pre><a href="#section-4.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ResponseJSON">
<section id="section-4.4">
        <h3 id="name-response-json">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-response-json" class="section-name selfRef">Response JSON</a>
        </h3>
<p id="section-4.4-1">Details of the JSON document:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <strong>iat</strong> - the time of the response as a NumericDate.<a href="#section-4.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.2">
            <strong>nonce</strong> - the nonce that was included in the Request JSON <a href="#RequestJSON" class="xref">Section 3.5</a>.<a href="#section-4.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.3">
            <strong>uri</strong> - the Grant URI.<a href="#section-4.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.4">
            <strong>wait</strong> - a numeric value representing the number of seconds the GC should want before making a Read Grant request to the Grant URI.<a href="#section-4.4-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.5">
            <strong>expires_in</strong> - a numeric value specifying how many seconds until the Grant expires. This attribute is OPTIONAL.<a href="#section-4.4-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<div id="clientObject">
<section id="section-4.4.1">
          <h4 id="name-client-object-2">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-client-object-2" class="section-name selfRef">"client" Object</a>
          </h4>
<p id="section-4.4.1-1">If the GC is a Dynamic Client, the GS may return<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-2.1">
              <strong>handle</strong> the Client Handle<a href="#section-4.4.1-2.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="interactionObject">
<section id="section-4.4.2">
          <h4 id="name-interaction-object-2">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-interaction-object-2" class="section-name selfRef">"interaction" Object</a>
          </h4>
<p id="section-4.4.2-1">If the GS wants the GC to start the interaction, the GS MUST return an interaction object containing one or more interaction mode responses per <a href="#InteractionModes" class="xref">Section 5</a> to one or more of the interaction mode requests provided by the GC.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-object">
<section id="section-4.4.3">
          <h4 id="name-access-object-2">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-access-object-2" class="section-name selfRef">"access" Object</a>
          </h4>
<p id="section-4.4.3-1">If the GC requested a single Access, the "access" object is an access response object <a href="#ResponseAccessObject" class="xref">Section 4.4.4</a>. If the GC requested multiple, the access object contains a property of the same name for each Access requested by the GC, and each property is an access response object <a href="#ResponseAccessObject" class="xref">Section 4.4.4</a>.<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ResponseAccessObject">
<section id="section-4.4.4">
          <h4 id="name-access-response-object">
<a href="#section-4.4.4" class="section-number selfRef">4.4.4. </a><a href="#name-access-response-object" class="section-name selfRef">Access Response Object</a>
          </h4>
<p id="section-4.4.4-1">The access response object contains properties from the Access JSON <a href="#AccessJSON" class="xref">Section 4.5</a>. The access response object MUST contain either the "uri" property from, or MUST contain:<a href="#section-4.4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.4-2.1">mechanism<a href="#section-4.4.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.4-2.2">token<a href="#section-4.4.4-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.4-3">and MAY contain:<a href="#section-4.4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.4-4.1">access<a href="#section-4.4.4-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.4-4.2">expires_in<a href="#section-4.4.4-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.4-4.3">uri<a href="#section-4.4.4-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.4-5">If there is no "uri" property, the access token can not be refreshed. If only the "uri" property is present, the GC MUST acquire the Access per <a href="#ReadAccess" class="xref">Section 3.6</a><a href="#section-4.4.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ResponseClaimsObject">
<section id="section-4.4.5">
          <h4 id="name-claims-object-2">
<a href="#section-4.4.5" class="section-number selfRef">4.4.5. </a><a href="#name-claims-object-2" class="section-name selfRef">"claims" Object</a>
          </h4>
<p id="section-4.4.5-1">The claims object is a response to the Grant Request "claims" object <a href="#ClaimsObject" class="xref">Section 3.5.5</a>.<a href="#section-4.4.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.5-2.1">
              <p id="section-4.4.5-2.1.1"><strong>oidc</strong><a href="#section-4.4.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.5-2.1.2.1">
                  <strong>id_token</strong> - an OpenID Connect ID Token containing the Claims the User consented to be released.<a href="#section-4.4.5-2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.4.5-2.1.2.2">
                  <strong>userinfo</strong> - the Claims the User consented to be released.<a href="#section-4.4.5-2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-4.4.5-2.1.3">
Claims are defined in <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 5.<a href="#section-4.4.5-2.1.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.5-2.2">
              <strong>oidc4ia</strong> - OpenID Connect for Identity Assurance claims response per <span>[<a href="#OIDC4IA" class="xref">OIDC4IA</a>]</span>.<a href="#section-4.4.5-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.5-2.3">
              <p id="section-4.4.5-2.3.1"><strong>vc</strong><a href="#section-4.4.5-2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.4.5-2.3.2">
The verified claims the user consented to be released. <em>[Editor: details TBD]</em><a href="#section-4.4.5-2.3.2" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="WarningsObject">
<section id="section-4.4.6">
          <h4 id="name-warnings-json-array">
<a href="#section-4.4.6" class="section-number selfRef">4.4.6. </a><a href="#name-warnings-json-array" class="section-name selfRef">"warnings" JSON Array</a>
          </h4>
<p id="section-4.4.6-1">Includes zero or more warnings from <a href="#Warnings" class="xref">Section 8</a>,<a href="#section-4.4.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AccessJSON">
<section id="section-4.5">
        <h3 id="name-access-json">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-access-json" class="section-name selfRef">Access JSON</a>
        </h3>
<p id="section-4.5-1">The Access JSON is a Grant Response Access Object <a href="#ResponseAccessObject" class="xref">Section 4.4.4</a> or the response to a Read Access request by the GC <a href="#ReadAccess" class="xref">Section 3.6</a>.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.1">
            <strong>mechanism</strong> - the RS access mechanism. This document defines the "bearer" mechanism as defined in <a href="#RSAccess" class="xref">Section 6</a>. Required.<a href="#section-4.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-2.2">
            <strong>token</strong> - the access token for accessing an RS. Required.<a href="#section-4.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-2.3">
            <strong>expires_in</strong> - an optional numeric value specifying how many seconds until the access token expires.<a href="#section-4.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-2.4">
            <strong>uri</strong> - the Access URI. Used to acquire or refresh Access. Required.<a href="#section-4.5-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-2.5">
            <strong>granted</strong> - an optional array of <span>[<a href="#RAR" class="xref">RAR</a>]</span> objects containing the resource access granted<a href="#section-4.5-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.5-3"><em>[Editor: would an optional expiry for the Access be useful?]</em><a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">The following is a non-normative example of Access JSON:<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.5-5">
<pre>
{
    "mechanism"     : "bearer",
    "token"         : "eyJJ2D6.example.access.token.mZf9p"
    "expires_in"    : 3600,
    "uri"           : "https://as.example/endpoint/access/example2",
    "granted"       : [ "read_calendar write_calendar" ]
}
</pre><a href="#section-4.5-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="response-verification">
<section id="section-4.6">
        <h3 id="name-response-verification">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-response-verification" class="section-name selfRef">Response Verification</a>
        </h3>
<p id="section-4.6-1">On receipt of a response, the GC MUST verify the following:<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.1">TBD<a href="#section-4.6-2.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="InteractionModes">
<section id="section-5">
      <h2 id="name-interaction-modes">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-interaction-modes" class="section-name selfRef">Interaction Modes</a>
      </h2>
<p id="section-5-1">This document defines three interaction modes: "redirect", "indirect", and "user_code". Extensions may define additional interaction modes.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The "global" attribute is reserved in the interaction object for attributes that apply to all interaction modes.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="redirect">
<section id="section-5.1">
        <h3 id="name-redirect">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-redirect" class="section-name selfRef">"redirect"</a>
        </h3>
<p id="section-5.1-1">A Redirect Interaction is characterized by the GC redirecting the User's browser to the GS, the GS interacting with the User, and then GS redirecting the User's browser back to the GC. The GS correlates the Grant Request with the unique redirect_uri, and the GC correlates the Grant Request with the unique completion_uri.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2"><strong>The request "interaction" object contains:</strong><a href="#section-5.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-3.1">
            <strong>completion_uri</strong>  a unique URI at the GC that the GS will return the User to. The URI MUST not contain the "nonce" from the Grant Request, and MUST not be guessable. This attribute is REQUIRED.<a href="#section-5.1-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-4"><strong>The response "interaction" object contains:</strong><a href="#section-5.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-5.1">
            <strong>redirect_uri</strong> a unique URI at the GS that the GC will redirect the User to. The URI MUST not contain the "nonce" from the Grant Request, and MUST not be guessable. This attribute is REQUIRED.<a href="#section-5.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-5.2">
            <strong>verification</strong> a boolean value indicating the GS requires the GC to make a Verify Grant request.(<a href="#VerifyGrant" class="xref">Section 3.3</a>)<a href="#section-5.1-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<div id="RedirectVerification">
<section id="section-5.1.1">
          <h4 id="name-redirect-verification">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-redirect-verification" class="section-name selfRef">"redirect" verification</a>
          </h4>
<p id="section-5.1.1-1">If the GS indicates that Grant Verification is required, the GS MUST add a 'verification' query parameter with a value of a unique verification code to the completion_uri.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">On receiving the verification code in the redirect from the GS, the GC makes a Verify Grant request (<a href="#VerifyGrant" class="xref">Section 3.3</a>) with the verification code.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="indirect">
<section id="section-5.2">
        <h3 id="name-indirect">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-indirect" class="section-name selfRef">"indirect"</a>
        </h3>
<p id="section-5.2-1">An Indirect Interaction is characterized by the GC causing the User's browser to load the indirect_uri at GS, the GS interacting with the User, and then the GS MAY optionally redirect the User's Browser to a information_uri. There is no mechanism for the GS to redirect the User's browser back to the GC.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Examples of how the GC may initiate the interaction are encoding the indirect_uri as a code scannable by the User's mobile device, or launching a system browser from a command line interface (CLI) application.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The "indirect" mode is susceptible to session fixation attacks. See TBD in the Security Considerations for details.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4"><strong>The request "interaction" object contains:</strong><a href="#section-5.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-5.1">
            <strong>information_uri</strong> an OPTIONAL URI that the GS will redirect the User's browser to after GS interaction.<a href="#section-5.2-5.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-6"><strong>The response "interaction" object contains:</strong><a href="#section-5.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-7.1">
            <strong>indirect_uri</strong> the URI the GC will cause to load in the User's browser. The URI SHOULD be short enough to be easily encoded in a scannable code. The URI MUST not contain the "nonce" from the Grant Request, and MUST not be guessable. <em>[Editor: recommend a maximum length?]</em><a href="#section-5.2-7.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="usercode">
<section id="section-5.3">
        <h3 id="name-user_code">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-user_code" class="section-name selfRef">"user_code"</a>
        </h3>
<p id="section-5.3-1">An Indirect Interaction is characterized by the GC displaying a code and a URI for the User to load in a browser and then enter the code.  <em>[Editor: recommend a minimum entropy?]</em><a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2"><strong>The request "interaction" object contains:</strong><a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-3.1">
            <strong>information_uri</strong> an OPTIONAL URI that the GS will redirect the User's browser to after GS interaction.<a href="#section-5.3-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-4"><strong>The response "interaction" object contains:</strong><a href="#section-5.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-5.1">
            <strong>code</strong> the code the GC displays to the User to enter at the display_uri. This attribute is REQUIRED.<a href="#section-5.3-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-5.2">
            <strong>display_uri</strong> the URI the GC displays to the User to load in a browser to enter the code.<a href="#section-5.3-5.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="RSAccess">
<section id="section-6">
      <h2 id="name-rs-access">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-rs-access" class="section-name selfRef">RS Access</a>
      </h2>
<p id="section-6-1">The mechanism the GC MUST use to access an RS is in the Access JSON "mechanism" attribute <a href="#ResponseAccessObject" class="xref">Section 4.4.4</a>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The "bearer" mechanism is defined in Section 2.1 of <span>[<a href="#RFC6750" class="xref">RFC6750</a>]</span><a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The "jose" and "jose+body" mechanisms are defined in <span>[<a href="#JOSE_Authentication" class="xref">JOSE_Authentication</a>]</span><a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">A non-normative "bearer" example of the HTTP request headers follows:<a href="#section-6-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6-5">
<pre>
GET /calendar HTTP/2
Host: calendar.example
Authorization: bearer eyJJ2D6.example.access.token.mZf9pTSpA
</pre><a href="#section-6-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ErrorResponses">
<section id="section-7">
      <h2 id="name-error-responses">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-error-responses" class="section-name selfRef">Error Responses</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-7-1.1">TBD<a href="#section-7-1.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="Warnings">
<section id="section-8">
      <h2 id="name-warnings">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-warnings" class="section-name selfRef">Warnings</a>
      </h2>
<p id="section-8-1">[Editor: Warnings are an optional response that can assist a GC in detecting non-fatal errors, such as ignored objects and properties.]<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">TBD<a href="#section-8-2.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="Extensibility">
<section id="section-9">
      <h2 id="name-extensibility">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-extensibility" class="section-name selfRef">Extensibility</a>
      </h2>
<p id="section-9-1">This standard can be extended in a number of areas:<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">
          <p id="section-9-2.1.1"><strong>GC Authentication Mechanisms</strong><a href="#section-9-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1.2.1">An extension could define other mechanisms for the GC to authenticate to the GS and/or RS such as Mutual TLS or HTTP Signing. Constrained environments could use CBOR <span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span> instead of JSON, and COSE <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span> instead of JOSE, and CoAP <span>[<a href="#RFC8323" class="xref">RFC8323</a>]</span> instead of HTTP/2.<a href="#section-9-2.1.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.2">
          <p id="section-9-2.2.1"><strong>Grant</strong><a href="#section-9-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.2.2.1">An extension can define new objects in the Grant Request and Grant Response JSON that return new URIs.<a href="#section-9-2.2.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.3">
          <p id="section-9-2.3.1"><strong>Top Level</strong><a href="#section-9-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.1">Top level objects SHOULD only be defined to represent functionality other the existing top level objects and attributes.<a href="#section-9-2.3.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.4">
          <p id="section-9-2.4.1"><strong>"client" Object</strong><a href="#section-9-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.4.2.1">Additional information about the GC that the GS would require related to an extension.<a href="#section-9-2.4.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.5">
          <p id="section-9-2.5.1"><strong>"user" Object</strong><a href="#section-9-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.5.2.1">Additional information about the User that the GS would require related to an extension.<a href="#section-9-2.5.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.6">
          <p id="section-9-2.6.1"><strong>"access" Object</strong><a href="#section-9-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.6.2.1">RAR is inherently extensible.<a href="#section-9-2.6.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.7">
          <p id="section-9-2.7.1"><strong>"claims" Object</strong><a href="#section-9-2.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.7.2.1">Additional claim schemas in addition to OpenID Connect claims and Verified Credentials.<a href="#section-9-2.7.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.8">
          <p id="section-9-2.8.1"><strong>interaction modes</strong><a href="#section-9-2.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.8.2.1">Additional types of interactions a GC can start with the User.<a href="#section-9-2.8.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.9">
          <p id="section-9-2.9.1"><strong>Continuous Authentication</strong><a href="#section-9-2.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.9.2.1">An extension could define a mechanism for the GC to regularly provide continuous authentication signals and receive responses.<a href="#section-9-2.9.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-9-3"><em>[Editor: do we specify access token introspection in this document, or leave that to an extension?]</em><a href="#section-9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rational">
<section id="section-10">
      <h2 id="name-rational">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-rational" class="section-name selfRef">Rational</a>
      </h2>
<ol start="1" type="1" class="normal type-1" id="section-10-1">
        <li id="section-10-1.1">
          <p id="section-10-1.1.1"><strong>Why do GCs now always use Asymetric cryptography? Why not keep the client secret?</strong><a href="#section-10-1.1.1" class="pilcrow">¶</a></p>
<p id="section-10-1.1.2">
In the past, asymetric cryptography was relatively computational expensive. Modern browsers now have asymetric cryptographic APIs available, and modern hardware has significantly reduced the computational impact.<a href="#section-10-1.1.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-1.2">
          <p id="section-10-1.2.1"><strong>Why have both Client ID and Client Handle?</strong><a href="#section-10-1.2.1" class="pilcrow">¶</a></p>
<p id="section-10-1.2.2">
While they both refer to a Grant Client in the protocol, the Client ID refers to a pre-registered client,and the Client Handle is specific to an instance of a Dynamic Client. Using separate terms clearly differentiates which identifier is being presented to the GS.<a href="#section-10-1.2.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-1.3">
          <p id="section-10-1.3.1"><strong>Why allow GC and GS to negotiate the user interaction mode?</strong><a href="#section-10-1.3.1" class="pilcrow">¶</a></p>
<p id="section-10-1.3.2">
The GC knows what interaction modes it is capable of, and the GS knows which interaction modes it will permit for a given Grant Request. The GC can then present the intersection to the User to choose which one is preferred. For example, while a device based GC may be willing to do both "indirect" and "user_code", a GS may not enable "indirect" for concern of a session fixation attack. Additional interaction modes will likely become available which allows new modes to be negotiated between GC and GS as each adds additional interaction modes.<a href="#section-10-1.3.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-1.4">
          <p id="section-10-1.4.1"><strong>Why have both identity claims and resource access?</strong><a href="#section-10-1.4.1" class="pilcrow">¶</a></p>
<p id="section-10-1.4.2">
There are use cases for each that are independent: authenticating a user and providing claims vs granting access to a resource. A request for an authorization returns an access token which may have full CRUD capabilities, while a request for a claim returns the claim about the User - with no create, update or delete capabilities. While the UserInfo endpoint in OIDC may be thought of as a resource, separating the concepts and how they are requested keeps each of them simpler in the Editor's opinion. :)<a href="#section-10-1.4.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-1.5">
          <p id="section-10-1.5.1"><strong>Why do some of the JSON objects only have one child, such as the identifiers object in the user object in the Grant Request?</strong><a href="#section-10-1.5.1" class="pilcrow">¶</a></p>
<p id="section-10-1.5.2">
It is difficult to forecast future use cases. Having more resolution may mean the difference between a simple extension, and a convoluted extension. For example, the "global" object in the "interaction" object allows new global parameters to be added without impacting new interaction modes.<a href="#section-10-1.5.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-1.6">
          <p id="section-10-1.6.1"><strong>Why is the "iss" included in the "oidc" identifier object? Would the "sub" not be enough for the GS to identify the User?</strong><a href="#section-10-1.6.1" class="pilcrow">¶</a></p>
<p id="section-10-1.6.2">
This decouples the GS from the OpenID Provider (OP). The GS identifier is the GS URI, which is the endpoint at the GS. The OP issuer identifier will likely not be the same as the GS URI. The GS may also provide claims from multiple OPs.<a href="#section-10-1.6.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-1.7">
          <p id="section-10-1.7.1"><strong>Why is there not a UserInfo endpoint as there is with OpenID Connect?</strong><a href="#section-10-1.7.1" class="pilcrow">¶</a></p>
<p id="section-10-1.7.2">
Since the GC can Read Grant at any time, it get the same functionality as the UserInfo endpoint, without the GC having to manage a separate access token and refresh token. If the GC would like additional claims, it can Update Grant, and the GS will let the GC know if an interaction is required to get any of the additional claims, which the GC can then start.<a href="#section-10-1.7.2" class="pilcrow">¶</a></p>
<p id="section-10-1.7.3"><em>[Editor: is there some other reason to have the UserInfo endpoint?]</em><a href="#section-10-1.7.3" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-1.8">
          <p id="section-10-1.8.1"><strong>Why use URIs for the Grant and Access?</strong><a href="#section-10-1.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-1.8.2.1">Grant URI and Access URI are defined to start with the GS URI, allowing the GC, and GS to determine which GS a Grant or Access belongs to.<a href="#section-10-1.8.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-10-1.8.2.2">URIs also enable a RESTful interface to the GS functionality.<a href="#section-10-1.8.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-10-1.8.2.3">A large scale GS can easily separate out the services that provide functionality as routing of requests can be done at the HTTP layer based on URI and HTTP method. This allows a separation of concerns, independent deployment, and resiliency.<a href="#section-10-1.8.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="section-10-1.9">
          <p id="section-10-1.9.1"><strong>Why use the OPTIONS method on the GS URI? Why not use a .well-known mechanism?</strong><a href="#section-10-1.9.1" class="pilcrow">¶</a></p>
<p id="section-10-1.9.2">
Having the GS URI endpoint respond to the metadata allows the GS to provide GC specific results using the same GC authentication used for other requests to the GS. It also reduces the risk of a mismatch between the advertised metadata, and the actual metadata. A .well-known discovery mechanism may be defined to resolve from a hostname to the GS URI.<a href="#section-10-1.9.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-1.10">
          <p id="section-10-1.10.1"><strong>Why is there a Verify Grant? The GC can protect itself from session fixation without it.</strong><a href="#section-10-1.10.1" class="pilcrow">¶</a></p>
<p id="section-10-1.10.2">
GC implementations may not always follow the best practices. The Verify Grant allows the GS to ensure there is not a session fixation as the instance of the GC making creating the Grant is the one that gets the verification code in the redirect.<a href="#section-10-1.10.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-1.11">
          <p id="section-10-1.11.1">**Why use the <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> claims rather than the <span>[<a href="#IANA_JWT" class="xref">IANA_JWT</a>]</span> list of claims?<a href="#section-10-1.11.1" class="pilcrow">¶</a></p>
<p id="section-10-1.11.2">
The <span>[<a href="#IANA_JWT" class="xref">IANA_JWT</a>]</span> claims include claims that are not identity claims, and <span>[<a href="#IANA_JWT" class="xref">IANA_JWT</a>]</span> references the <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> claims, and <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> 5.1 are only identity claims.<a href="#section-10-1.11.2" class="pilcrow">¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="privacy-considerations">
<section id="section-11">
      <h2 id="name-privacy-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-11-1">TBD<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">TBD<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-13">
      <h2 id="name-acknowledgments">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-13-1">This draft derives many of its concepts from Justin Richer's Transactional Authorization draft <span>[<a href="#TxAuth" class="xref">TxAuth</a>]</span>.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">Additional thanks to Justin Richer and Annabelle Richard Backman for their strong critique of earlier drafts.
[Editor: add in the other contributors from mail list]<a href="#section-13-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-14">
      <h2 id="name-iana-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-14-1">TBD<a href="#section-14-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-15">
      <h2 id="name-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-15.1">
        <h3 id="name-normative-references">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3966">[RFC3966]</dt>
        <dd>
<span class="refAuthor">Schulzrinne, H.</span>, <span class="refTitle">"The tel URI for Telephone Numbers"</span>, <span class="seriesInfo">RFC 3966</span>, <span class="seriesInfo">DOI 10.17487/RFC3966</span>, <time datetime="2004-12" class="refDate">December 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3966">https://www.rfc-editor.org/info/rfc3966</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5322">[RFC5322]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5322">https://www.rfc-editor.org/info/rfc5322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5646">[RFC5646]</dt>
        <dd>
<span class="refAuthor">Phillips, A., Ed.</span><span class="refAuthor"> and M. Davis, Ed.</span>, <span class="refTitle">"Tags for Identifying Languages"</span>, <span class="seriesInfo">BCP 47</span>, <span class="seriesInfo">RFC 5646</span>, <span class="seriesInfo">DOI 10.17487/RFC5646</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5646">https://www.rfc-editor.org/info/rfc5646</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor"> and D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDC">[OIDC]</dt>
        <dd>
<span class="refAuthor">Sakimora, N.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Jones, M.</span><span class="refAuthor">, de Medeiros, B.</span><span class="refAuthor">, and C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0"</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://openiD.net/specs/openiD-connect-core-1_0.html">https://openiD.net/specs/openiD-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDC4IA">[OIDC4IA]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor"> and D. Fett</span>, <span class="refTitle">"OpenID Connect for Identity Assurance 1.0"</span>, <time datetime="2019-10" class="refDate">October 2019</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-4-identity-assurance-1_0.html">https://openid.net/specs/openid-connect-4-identity-assurance-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RAR">[RAR]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor">, Richer, J.</span><span class="refAuthor">, and B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <time datetime="2020-01" class="refDate">January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-rar-00">https://tools.ietf.org/html/draft-ietf-oauth-rar-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C_VC">[W3C_VC]</dt>
        <dd>
<span class="refAuthor">Sporny, M.</span><span class="refAuthor">, Noble, G.</span><span class="refAuthor">, and D. Chadwick</span>, <span class="refTitle">"Verifiable Credentials Data Model 1.0"</span>, <time datetime="2019-11" class="refDate">November 2019</time>, <span>&lt;<a href="https://w3c.github.io/vc-data-model/">https://w3c.github.io/vc-data-model/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JOSE_Authentication">[JOSE_Authentication]</dt>
        <dd>
<span class="refAuthor">Hardt, D.</span>, <span class="refTitle">"JOSE Authentication"</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hardt-gnap-jose">https://tools.ietf.org/html/draft-hardt-gnap-jose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GNAP_Advanced">[GNAP_Advanced]</dt>
      <dd>
<span class="refAuthor">Hardt, D.</span>, <span class="refTitle">"The Grant Negotiation and Authorization Protocol - Advanced Features"</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hardt-gnap-advanced">https://tools.ietf.org/html/draft-hardt-gnap-advanced</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15.2">
        <h3 id="name-informative-references">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC7049">[RFC7049]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8323">[RFC8323]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor">, Lemay, S.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, Hartke, K.</span><span class="refAuthor">, Silverajan, B.</span><span class="refAuthor">, and B. Raymor, Ed.</span>, <span class="refTitle">"CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets"</span>, <span class="seriesInfo">RFC 8323</span>, <span class="seriesInfo">DOI 10.17487/RFC8323</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8323">https://www.rfc-editor.org/info/rfc8323</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="browser_based_apps">[browser_based_apps]</dt>
        <dd>
<span class="refAuthor">Parecki, A.</span><span class="refAuthor"> and D. Waite</span>, <span class="refTitle">"OAuth 2.0 for Browser-Based Apps"</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps-04">https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QR_Code">[QR_Code]</dt>
        <dd>
<span class="refTitle">"ISO/IEC 18004:2015 - Information technology - Automatic identification and data capture techniques - QR Code bar code symbology specification"</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.iso.org/standard/62021.html">https://www.iso.org/standard/62021.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TxAuth">[TxAuth]</dt>
        <dd>
<span class="refAuthor">Richer, J.</span>, <span class="refTitle">"Transactional AuthN"</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-richer-transactional-authz-04">https://tools.ietf.org/html/draft-richer-transactional-authz-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA_JWT">[IANA_JWT]</dt>
      <dd>
<span class="refTitle">"JSON Web Token Claims"</span>, <time datetime="2015-01" class="refDate">January 2015</time>, <span>&lt;<a href="https://www.iana.org/assignments/jwt/jwt.xhtml">https://www.iana.org/assignments/jwt/jwt.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="document-history">
<section id="section-appendix.a">
      <h2 id="name-document-history">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<div id="draft-hardt-xauth-protocol-00">
<section id="section-a.1">
        <h2 id="name-draft-hardt-xauth-protocol-">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-draft-hardt-xauth-protocol-" class="section-name selfRef">draft-hardt-xauth-protocol-00</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.1-1.1">Initial version<a href="#section-a.1-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-01">
<section id="section-a.2">
        <h2 id="name-draft-hardt-xauth-protocol-0">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-draft-hardt-xauth-protocol-0" class="section-name selfRef">draft-hardt-xauth-protocol-01</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.2-1.1">text clean up<a href="#section-a.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.2">added OIDC4IA claims<a href="#section-a.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.3">added "jws" method for accessing a resource.<a href="#section-a.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.4">renamed Initiation Request -&gt; Grant Request<a href="#section-a.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.5">renamed Initiation Response -&gt; Interaction Response<a href="#section-a.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.6">renamed Completion Request -&gt; Authorization Request<a href="#section-a.2-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.7">renamed Completion Response -&gt; Grant Request<a href="#section-a.2-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.8">renamed completion handle -&gt; authorization handle<a href="#section-a.2-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.9">added Authentication Request, Authentication Response, authentication handle<a href="#section-a.2-1.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-02">
<section id="section-a.3">
        <h2 id="name-draft-hardt-xauth-protocol-02">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-draft-hardt-xauth-protocol-02" class="section-name selfRef">draft-hardt-xauth-protocol-02</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.3-1.1">major rewrite<a href="#section-a.3-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.3-1.2">handles are now URIs<a href="#section-a.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.3-1.3">the collection of claims and authorizations are a Grant<a href="#section-a.3-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.3-1.4">an Authorization is its own type<a href="#section-a.3-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.3-1.5">lots of sequences added<a href="#section-a.3-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-03">
<section id="section-a.4">
        <h2 id="name-draft-hardt-xauth-protocol-03">
<a href="#section-a.4" class="section-number selfRef">A.4. </a><a href="#name-draft-hardt-xauth-protocol-03" class="section-name selfRef">draft-hardt-xauth-protocol-03</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.4-1.1">fixed RO definition<a href="#section-a.4-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.4-1.2">improved language in Rationals<a href="#section-a.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.4-1.3">added user code interaction method, and aligned qrcode interaction method<a href="#section-a.4-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.4-1.4">added information_uri for code flows<a href="#section-a.4-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-04">
<section id="section-a.5">
        <h2 id="name-draft-hardt-xauth-protocol-04">
<a href="#section-a.5" class="section-number selfRef">A.5. </a><a href="#name-draft-hardt-xauth-protocol-04" class="section-name selfRef">draft-hardt-xauth-protocol-04</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.5-1.1">renamed interaction uris to have purpose specific names<a href="#section-a.5-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-05">
<section id="section-a.6">
        <h2 id="name-draft-hardt-xauth-protocol-05">
<a href="#section-a.6" class="section-number selfRef">A.6. </a><a href="#name-draft-hardt-xauth-protocol-05" class="section-name selfRef">draft-hardt-xauth-protocol-05</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.6-1.1">separated claims from identifiers in request user object<a href="#section-a.6-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.6-1.2">simplified reciprocal grant flow<a href="#section-a.6-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.6-1.3">reduced interactions to redirect and indirect<a href="#section-a.6-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.6-1.4">simplified interaction parameters<a href="#section-a.6-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.6-1.5">added in language for Client to verify interaction completion<a href="#section-a.6-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.6-1.6">added Verify Grant API and Interaction Nonce<a href="#section-a.6-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.6-1.7">replaced Refresh AuthZ with Read AuthZ. Read and refresh are same operation.<a href="#section-a.6-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-06">
<section id="section-a.7">
        <h2 id="name-draft-hardt-xauth-protocol-06">
<a href="#section-a.7" class="section-number selfRef">A.7. </a><a href="#name-draft-hardt-xauth-protocol-06" class="section-name selfRef">draft-hardt-xauth-protocol-06</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.7-1.1">fixup examples to match specification<a href="#section-a.7-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-07">
<section id="section-a.8">
        <h2 id="name-draft-hardt-xauth-protocol-07">
<a href="#section-a.8" class="section-number selfRef">A.8. </a><a href="#name-draft-hardt-xauth-protocol-07" class="section-name selfRef">draft-hardt-xauth-protocol-07</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.8-1.1">refactored interaction request and response syntax, and enabled interaction mode negotiation<a href="#section-a.8-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.8-1.2">generation of client handle by GS for dynamic clients<a href="#section-a.8-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.8-1.3">renamed title to Grant Negotiation and Authorization Protocol. Preserved draft-hardt-xauth-protocol filename to ease tracking changes.<a href="#section-a.8-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.8-1.4">changed Authorizations to be key / value pairs (aka dictionary) instead of a JSON array<a href="#section-a.8-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-08">
<section id="section-a.9">
        <h2 id="name-draft-hardt-xauth-protocol-08">
<a href="#section-a.9" class="section-number selfRef">A.9. </a><a href="#name-draft-hardt-xauth-protocol-08" class="section-name selfRef">draft-hardt-xauth-protocol-08</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.9-1.1">split document into three documents: core, advanced, and JOSE authentication.<a href="#section-a.9-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.9-1.2">grouped access granted into "access" object in Authorization JSON<a href="#section-a.9-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.9-1.3">added warnings object to the Grant Response JSON<a href="#section-a.9-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-09">
<section id="section-a.10">
        <h2 id="name-draft-hardt-xauth-protocol-09">
<a href="#section-a.10" class="section-number selfRef">A.10. </a><a href="#name-draft-hardt-xauth-protocol-09" class="section-name selfRef">draft-hardt-xauth-protocol-09</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.10-1.1">added editorial note that this document should be referred to as XAuth<a href="#section-a.10-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-10">
<section id="section-a.11">
        <h2 id="name-draft-hardt-xauth-protocol-1">
<a href="#section-a.11" class="section-number selfRef">A.11. </a><a href="#name-draft-hardt-xauth-protocol-1" class="section-name selfRef">draft-hardt-xauth-protocol-10</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.11-1.1">added example of RAR authorization request<a href="#section-a.11-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.11-1.2">fixed typos<a href="#section-a.11-1.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-11">
<section id="section-a.12">
        <h2 id="name-draft-hardt-xauth-protocol-11">
<a href="#section-a.12" class="section-number selfRef">A.12. </a><a href="#name-draft-hardt-xauth-protocol-11" class="section-name selfRef">draft-hardt-xauth-protocol-11</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.12-1.1">renamed authorization_uri to interaction_uri to avoid confusion with AZ URI<a href="#section-a.12-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.12-1.2">
            <p id="section-a.12-1.2.1">made URI names more consistent<a href="#section-a.12-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.12-1.2.2.1">renamed completion_uri to information_uri<a href="#section-a.12-1.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-a.12-1.2.2.2">renamed redirect_uri to completion_uri<a href="#section-a.12-1.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-a.12-1.2.2.3">renamed interaction_uri to redirect_uri<a href="#section-a.12-1.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-a.12-1.2.2.4">renamed short_uri to indirect_uri<a href="#section-a.12-1.2.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-a.12-1.3">editorial fixes<a href="#section-a.12-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.12-1.4">renamed http verb to method<a href="#section-a.12-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.12-1.5">added Verify Grant and verification parameters<a href="#section-a.12-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-12">
<section id="section-a.13">
        <h2 id="name-draft-hardt-xauth-protocol-12">
<a href="#section-a.13" class="section-number selfRef">A.13. </a><a href="#name-draft-hardt-xauth-protocol-12" class="section-name selfRef">draft-hardt-xauth-protocol-12</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.13-1.1">removed authorization object, and made authorizations object polymorphic<a href="#section-a.13-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-13">
<section id="section-a.14">
        <h2 id="name-draft-hardt-xauth-protocol-13">
<a href="#section-a.14" class="section-number selfRef">A.14. </a><a href="#name-draft-hardt-xauth-protocol-13" class="section-name selfRef">draft-hardt-xauth-protocol-13</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.14-1.1">added Q about referencing OIDC claims vs IANA JWT<a href="#section-a.14-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.14-1.2">made all authorizations be a RAR type as it provides the required flexibility, removed "oauth_rar" type<a href="#section-a.14-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.14-1.3">added RO to places where the RO and User are the same<a href="#section-a.14-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-14">
<section id="section-a.15">
        <h2 id="name-draft-hardt-xauth-protocol-14">
<a href="#section-a.15" class="section-number selfRef">A.15. </a><a href="#name-draft-hardt-xauth-protocol-14" class="section-name selfRef">draft-hardt-xauth-protocol-14</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.15-1.1">rewrote introduction<a href="#section-a.15-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.15-1.2">add in claims issuer and grant server owner<a href="#section-a.15-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.15-1.3">abstract protocol<a href="#section-a.15-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.15-1.4">add clarification on different parties<a href="#section-a.15-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.15-1.5">renamed Client to Grant Client<a href="#section-a.15-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.15-1.6">added entity relationship diagram<a href="#section-a.15-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.15-1.7">updated diagrams<a href="#section-a.15-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.15-1.8">added placeholder for Privacy Considerations<a href="#section-a.15-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.15-1.9">renamed Authorization to Access<a href="#section-a.15-1.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="comparison-with-oauth-20-and-openid-connect">
<section id="section-appendix.b">
      <h2 id="name-comparison-with-oauth-20-an">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-comparison-with-oauth-20-an" class="section-name selfRef">Comparison with OAuth 2.0 and OpenID Connect</a>
      </h2>
<p id="section-appendix.b-1"><strong>Changed Features</strong><a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">The major changes between GNAP and OAuth 2.X and OpenID Connect are:<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.b-3.1">The OAuth 2.X client and the OpenID Connect replying party are the Grant Client in GNAP.<a href="#section-appendix.b-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-3.2">The GNAP Grant Server is a superset of the OAuth 2.X authorization server, and the OpenID Connect OP (OpenID Provider).<a href="#section-appendix.b-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-3.3">The GC always uses a private asymetric key to authenticate to the GS. There is no client secret.<a href="#section-appendix.b-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-3.4">The GC initiates the protocol by making a signed request directly to the GS instead of redirecting the User to the GS.<a href="#section-appendix.b-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-3.5">The GC does not pass any parameters in redirecting the User to the GS.<a href="#section-appendix.b-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-3.6">The refresh_token has been replaced with an AZ URI that both represents the authorization, and is the URI for obtaining a fresh access token.<a href="#section-appendix.b-3.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-3.7">The GC can request identity claims to be returned independent of the ID Token.<a href="#section-appendix.b-3.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-3.8">The GS URI is the only static endpoint. All other URIs are dynamically generated. The GC does not need to register it's redirect URIs.<a href="#section-appendix.b-3.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-4">TBD - negotiation<a href="#section-appendix.b-4" class="pilcrow">¶</a></p>
<p id="section-appendix.b-5"><strong>Preserved Features</strong><a href="#section-appendix.b-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.b-6.1">GNAP reuses the scopes, Client IDs, and access tokens of OAuth 2.0.<a href="#section-appendix.b-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-6.2">GNAP reuses the Client IDs, Claims and ID Token of OpenID Connect.<a href="#section-appendix.b-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-6.3">No change is required by the GC or the RS for accessing existing bearer token protected APIs.<a href="#section-appendix.b-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-7"><strong>New Features</strong><a href="#section-appendix.b-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.b-8.1">All GC calls to the GS are authenticated with asymetric cryptography<a href="#section-appendix.b-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-8.2">A Grant represents both the user identity claims and RS access granted to the GC.<a href="#section-appendix.b-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-8.3">Support for scannable code initiated interactions.<a href="#section-appendix.b-8.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-8.4">Highly extensible per <a href="#Extensibility" class="xref">Section 9</a>.<a href="#section-appendix.b-8.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dick Hardt (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">SignIn.Org</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dick.hardt@gmail.com" class="email">dick.hardt@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
