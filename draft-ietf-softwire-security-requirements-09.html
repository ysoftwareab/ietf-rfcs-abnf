<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Softwire Security
    Analysis and Requirements</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Softwire Security
    Analysis and Requirements">
<meta name="keywords" content="IPv6, Tunnel, Softwire, Transition">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">S. Yamamoto</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NICT/KDDI R&amp;D Labs</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">C. Williams</td></tr>
<tr><td class="header">Expires: December 14, 2009</td><td class="header">KDDI R&amp;D Labs</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">F. Parent</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Beon Solutions</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Yokota</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">KDDI R&amp;D Labs</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 12, 2009</td></tr>
</table></td></tr></table>
<h1><br />Softwire Security
    Analysis and Requirements<br />draft-ietf-softwire-security-requirements-09</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 14, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document describes the security guidelines for the softwire
      "Hubs and Spokes" and "Mesh" solutions. Together with the discussion of
      the softwire deployment scenarios, the vulnerability to the security
      attacks is analyzed to provide the security protection mechanism such as
      authentication, integrity and confidentiality to the softwire control
      and data packets.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Abbreviations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Requirements Language<br />
<a href="#hubs_and_spokes">3.</a>&nbsp;
Hubs and Spokes Security Guidelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.</a>&nbsp;
Deployment Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#trust_model">3.2.</a>&nbsp;
Trust Relationship<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
Softwire Security Threat Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.4.</a>&nbsp;
Softwire Security Guidelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.4.1.</a>&nbsp;
Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.4.2.</a>&nbsp;
Softwire Security Protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#guidelines_hs">3.5.</a>&nbsp;
Guidelines for Usage of IPsec in Softwire<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.5.1.</a>&nbsp;
Authentication Issues<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.5.2.</a>&nbsp;
IPsec Pre-Shared Keys for Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.5.3.</a>&nbsp;
Inter-Operability Guidelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.5.4.</a>&nbsp;
IPsec Filtering Details<br />
<a href="#mesh">4.</a>&nbsp;
Mesh Security Guidelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.1.</a>&nbsp;
Deployment Scenario<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.2.</a>&nbsp;
Trust Relationship<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.3.</a>&nbsp;
Softwire Security Threat Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.4.</a>&nbsp;
Applicability of Security Protection Mechanism<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.4.1.</a>&nbsp;
Security Protection Mechanism for Control Plane<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.4.2.</a>&nbsp;
Security Protection Mechanism for Data Plane<br />
<a href="#anchor24">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor25">6.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor26">7.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#anchor29">Appendix&nbsp;A.</a>&nbsp;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">A.1.</a>&nbsp;
IPv6 over IPv4 Softwire with L2TPv2 example for IKE<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">A.2.</a>&nbsp;
IPv4 over IPv6 Softwire with example for IKE<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The Softwire Working Group specifies the standardization of
      discovery, control and encapsulation methods for connecting IPv4
      networks across IPv6 networks and IPv6 networks across IPv4 networks.
      The softwire provides the connectivity to enable global reachability of
      both address families by reusing or extending existing technology. The
      Softwire Working Group is focusing on the two scenarios that emerged
      when discussing the traversal of networks composed of differing address
      families. This document provides the security guidelines for such two
      softwire solution spaces such as "Hubs and Spokes" and "Mesh" scenarios.
      "Hubs and Spokes" and "Mesh" problems are described in <a class='info' href='#RFC4925'>[RFC4925]<span> (</span><span class='info'>Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;Softwire Problem Statement,&rdquo; July&nbsp;2007.</span><span>)</span></a> Section 2 and Section 3, respectively. The
      protocols selected for softwire connectivity require the security
      considerations on more specific deployment scenarios for each solution.
      The scope of this document provides the analysis on the security
      vulnerabilities for the deployment scenarios and specifies the proper
      usage of the security mechanisms applied to the softwire deployment.
</p>
<p>Layer Two Tunneling Protocol (L2TPv2) is selected as phase 1 protocol
      to be deployed in the "Hubs and Spokes" solution space. If L2TPv2 is
      used in the unprotected network, it will be vulnerable to various
      security attacks and MUST be protected by appropriate security protocol
      such as IPsec described in <a class='info' href='#RFC3193'>[RFC3193]<span> (</span><span class='info'>Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;Securing L2TP using IPsec,&rdquo; November&nbsp;2001.</span><span>)</span></a>. The new
      implementation SHOULD use IKEv2 in the key management protocol for IPsec
      because of more reliable protocol and integration of required protocols
      in a single platform. This document provides the implementation guidance
      and proper usage of IPsec as the security protection mechanism by
      considering the security vulnerabilities in "Hubs and Spokes" scenario.
      The document also addresses the cases where the security protocol is not
      necessarily mandated.
</p>
<p>The softwire "Mesh" solution MUST support various levels of security
      mechanism to protect the data packets from an attacker being transmitted
      on a softwire tunnel from the access networks with one address family
      across the transit core operating with different address family <a class='info' href='#RFC4925'>[RFC4925]<span> (</span><span class='info'>Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;Softwire Problem Statement,&rdquo; July&nbsp;2007.</span><span>)</span></a>. The security mechanism for the control plane
      is also required to be protected from control data modification,
      spoofing attack, etc. In the "Mesh" solution, BGP is used for
      distributing softwire routing information in the transit core while the
      security issues for BGP is being discussed in other working groups. This
      document provides the proper usage of the security mechanisms for the
      softwire mesh deployment scenarios.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Abbreviations</h3>

<p>The terminology is based on the softwire problem statement document
        <a class='info' href='#RFC4925'>[RFC4925]<span> (</span><span class='info'>Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;Softwire Problem Statement,&rdquo; July&nbsp;2007.</span><span>)</span></a>.
</p>
<p>AF(i) - Address Family. IPv4 or IPv6. Notation used to indicate
        that prefixes, a node or network only deal with a single IP AF.
</p>
<p>AF(i,j) - Notation used to indicate that a node is dual-stack or
        that a network is composed of dual-stack nodes.
</p>
<p>Address Family Border Router (AFBR) –A dual-stack router that
        interconnects two networks that use either the same or different
        address families. An AFBR forms peering relationships with other
        AFBRs, adjacent core routers and attached CE routers, perform softwire
        discovery and signaling, advertises client ASF(i) reachability
        information and encapsulates/decapsulates customer packets in softwire
        transport headers.
</p>
<p>Customer Edge (CE) - A router located inside AF access island that
        peers with other CE routers within the access island network and with
        one or more upstream AFBRs.
</p>
<p>Customer Premise Equipment (CPE) - An equipment, host or router,
        located at a subscriber’s premises and connected with a carrier’s
        access network.
</p>
<p>Provider Edge (PE) - A router located at the edge of transit core
        network that interfaces with CE in access island.
</p>
<p>Softwire Concentrator (SC) - The node terminating the softwire in
        the service provider network.
</p>
<p>Softwire Initiator (SI) - The node initiating the softwire within
        the customer network.
</p>
<p>Softwire Encapsulation Set (SW-Encap) - A softwire encapsulation
        set contains tunnel header parameters, order of preference of the
        tunnel header types and the expected payload types (e.g. IPv4) carried
        inside the softwire.
</p>
<p>Softwire Next_Hop (SW-NHOP) - This attribute accompanies client AF
        reachability advertisements and is used to reference a softwire on the
        ingress AFBR leading to the specific prefixes. It contains a softwire
        identifier value and a softwire next_hop IP address denoted as &lt;SW
        ID:SW-NHOP address&gt;. Its existence in the presence of client AF
        prefixes (in advertisements or entries in a routing table) infers the
        use of softwire to reach that prefix.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="hubs_and_spokes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Hubs and Spokes Security Guidelines</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Deployment Scenarios</h3>

<p>To provide the security guidelines, the discussion of the possible
        deployment scenario and the trust relationship in the network is
        important.
</p>
<p>The softwire initiator (SI) always resides in the customer network.
        The node, in which the SI resides, can be the CPE access device,
        another dedicated CPE router behind the original CPE access device or
        any kind of host device such as PC, appliance, sensor etc.
</p>
<p>However, the host device may not always have direct access to its
        home carrier network, to which the user has subscribed. For example,
        the SI in the laptop PC can access various access networks such as
        Wi-Fi hot-spots, visited office network. This is the nomadic case,
        which the softwire SHOULD support.
</p>
<p>As the softwire deployment model, the following three cases as
        shown in <a class='info' href='#HS_model'>Figure&nbsp;1<span> (</span><span class='info'>Authentication model for Hubs and Spokes</span><span>)</span></a> should be considered. Case 2
        and 3 are typical for a nomadic node, but are also applicable to a
        stationary node. In order to securely connect legitimate SI and SC
        each other, the authentication process between SI and SC is performed
        normally using AAA servers.
</p><br /><hr class="insert" />
<a name="HS_model"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         visited network            visited network
         access provider            service provider
                +---------------------------------+
                |                                 |
         +......v......+    +.....................|......+
         .             .    .                     v      .
+------+  .  (case 3)   .    .  +------+      +--------+  .
|      |=====================.==|      |      |        |  .
|  SI  |__.________     .    .  |  SC  |&lt;----&gt;|  AAAv  |  .
|      |---------- \    .    .  |      |      |        |  .
+------+  .        \\   .    .  +------+      +--------+  .
         .         \\  .    .                     ^      .
  ^      +..........\\.+    +.....................|......+
  |                  \\                           |
  |          (case 2) \\                          |
  |                    \\                         |
  |                     \\                        |
  |      +............+  \\ +.....................|......+
         .            .   \\.                     v      .
+------+  .            .    \\__+------+      +--------+  .
|      |  . (case 1)   .     ---|      |      |        |  .
|  SI  |=====================.==|  SC  |&lt;----&gt;|  AAAh  |  .
|      |  .            .     .  |      |      |        |  .
+------+  .            .     .  +------+      +--------+  .
         .            .     .                            .
         +............+     +............................+
          home network                home network
         access provider            service provider
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Authentication model for Hubs and Spokes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The AAA server shown in <a class='info' href='#HS_model'>Figure&nbsp;1<span> (</span><span class='info'>Authentication model for Hubs and Spokes</span><span>)</span></a> interacts
        with the SC which acts as an AAA client. The AAA may consists of
        multiple AAA servers and the proxy AAA may be intermediate between the
        SC and the AAA servers. This document refers to the AAA server in the
        home network service provider as the home AAA server (AAAh) and that
        in the visited network service provider as the visited AAA server
        (AAAv).
</p>
<p>The softwire problem statement <a class='info' href='#RFC4925'>[RFC4925]<span> (</span><span class='info'>Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;Softwire Problem Statement,&rdquo; July&nbsp;2007.</span><span>)</span></a>
        states that the softwire solution must be able to be integrated with
        common deployed AAA solution. L2TPv2 used in softwire supports PPP and
        L2TP authentications which can be integrated with common AAA
        servers.
</p>
<p>When the softwire is used in an unprotected network, a stronger
        authentication process is required (e.g., IKEv2). The proper selection
        of the authentication processes is discussed in Section 3.4 with
        respect to the various security threats.
</p>
<p>Case 1: The SI connects to the SC that belongs to the home network
        service provider via the home access provider network operating
        different address family. It is assumed that the home access network
        and the home network providing SC are under the same administrative
        system.
</p>
<p>Note that the IP address of the host device, in which SI resides,
        is static or dynamic depending on the subscribed service. The
        discovery of the SC may be automatic. But in this document, the
        information on the SC, e.g. the DNS name or IP address, is assumed to
        be configured by the user or the provider of the SI in advance.
</p>
<p>Case 2: The SI connects to the SC that belongs to the home network
        service provider network via the visited access network. For the
        nomadic case, the SI/user does not subscribe to the visited access
        provider. For the network access through the public network such as
        WiFi hot-spots, the home network service provider does not have the
        trust relationship with the access network.
</p>
<p>Note that the IP address of the host device, in which SI resides,
        may be changed periodically due to the home network service provider's
        policy.
</p>
<p>Case 3: The SI connects to the SC that belongs to the visited
        network service provider via the visited access network. This is
        typical of nomadic access case. When the SI is mobile, it may roam
        from the home ISP providing the home access network to the visited
        access network, e.g. WiFi hot-spot network provided by the different
        ISP. The SI does not connect to the SC in the home network, for
        example, due to the geographical reason. The SI/user does not
        subscribe to the visited network service provider, but the visited
        network service provider has some roaming agreement with the home
        network service provider.
</p>
<p>Note that the IP address of the host, in which SI resides, is
        provided the visited network service provider's policy.
</p>
<a name="trust_model"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Trust Relationship</h3>

<p>The establishment of the trust relationship between SI and SC is
        different for three cases. The security consideration must be taken
        into account for each case.
</p>
<p>In Case 1, the SC and the home AAA server in the same network
        service provider MUST have a trust relationship and communications
        between them MUST be secured. When the SC authenticates the SI, the SC
        transmits the authentication request message to the home AAA server
        and obtains the accept message together with the Attribute Value Pair
        for the SI authentication. Since the SI in the service provider
        network, the provider can take measures to protect the entities (e.g.,
        SC, AAA servers) against a number of security threats, including the
        communication between them.
</p>
<p>In Case 2, when the SI is mobile, the access to the home network
        service provider through the visited access network provider is
        allowed. The trust relationship between SI and the SC in the home
        network MUST be established. When the visited access network is a
        public network, the various security attacks must be considered.
        Especially for SI to connect to the legitimate SC, the authentication
        from SI to SC MUST be performed together with that from SC to SI.
</p>
<p>In Case3, if the SI roams into a different network service
        provider's administrative domain and the visited AAA server
        communicates with the home AAA server to obtain the information for SI
        authentication. The visited AAA server MUST have a trust relationship
        with the home AAA server and the communication between them MUST be
        secured in order to properly perform the roaming services that have
        been agreed upon under specified conditions.
</p>
<p>Note that the path for the communications between the home AAA
        server and the visited AAA server may consist of several AAA proxies.
        In this case, AAA proxy threat model SHOULD be considered <a class='info' href='#RFC2607'>[RFC2607]<span> (</span><span class='info'>Aboba, B. and J. Vollbrecht, &ldquo;Proxy Chaining and Policy Implementation in Roaming,&rdquo; June&nbsp;1999.</span><span>)</span></a>. A malicious AAA proxy may launch passive or
        active security attacks. The trustworthiness of proxies in AAA proxy
        chains will be weaken when the hop counts of the proxy chain is
        longer. For example, the accounting information exchanged among AAA
        proxies is attractive for an adversary. The communication between a
        home AAA server and a visited AAA server MUST be protected.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Softwire Security Threat Scenarios</h3>

<p>Softwire can be used to connect IPv6 networks across public IPv4
        networks and IPv4 networks across public IPv6 networks. The control
        and data packets used during the softwire session are vulnerable to
        the security attacks.
</p>
<p>A complete threat analysis of softwire requires examination of the
        protocols used for the softwire setup, the encapsulation method used
        to transport the payload, and other protocols used for configuration
        (e.g., router advertisements, DHCP).
</p>
<p>The softwire solution uses a subset of the Layer Two Tunneling
        Protocol (L2TPv2) functionality <a class='info' href='#RFC2661'>[RFC2661]<span> (</span><span class='info'>Townsley, W., Valencia, A., Rubens, A., Pall, G., Zorn, G., and B. Palter, &ldquo;Layer Two Tunneling Protocol &quot;L2TP&quot;,&rdquo; August&nbsp;1999.</span><span>)</span></a>, <a class='info' href='#I-D.ietf-softwire-hs-framework-l2tpv2'>[I&#8209;D.ietf&#8209;softwire&#8209;hs&#8209;framework&#8209;l2tpv2]<span> (</span><span class='info'>Storer, B., Pignataro, C., Santos, M., Stevant, B., and J. Tremblay, &ldquo;Softwire Hub &amp; Spoke Deployment Framework with L2TPv2,&rdquo; March&nbsp;2009.</span><span>)</span></a>. In the
        softwire "Hubs and Spokes" model, L2TPv2 is used in a voluntary tunnel
        model only. The SI acts as a L2TP Access Concentrator (LAC) and PPP
        endpoint. The L2TPv2 tunnel is always initiated from the SI.,
</p>
<p>Generic threat analysis done for L2TP using IPsec <a class='info' href='#RFC3193'>[RFC3193]<span> (</span><span class='info'>Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;Securing L2TP using IPsec,&rdquo; November&nbsp;2001.</span><span>)</span></a> is applicable to softwire "Hubs and Spokes"
        deployment. The threat analysis for other protocols such as MIPv6
        <a class='info' href='#RFC4225'>[RFC4225]<span> (</span><span class='info'>Nikander, P., Arkko, J., Aura, T., Montenegro, G., and E. Nordmark, &ldquo;Mobile IP Version 6 Route Optimization Security Design Background,&rdquo; December&nbsp;2005.</span><span>)</span></a>, PANA <a class='info' href='#RFC4016'>[RFC4016]<span> (</span><span class='info'>Parthasarathy, M., &ldquo;Protocol for Carrying Authentication and Network Access (PANA) Threat Analysis and Security Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a>,
        NSIS <a class='info' href='#RFC4081'>[RFC4081]<span> (</span><span class='info'>Tschofenig, H. and D. Kroeselberg, &ldquo;Security Threats for Next Steps in Signaling (NSIS),&rdquo; June&nbsp;2005.</span><span>)</span></a>, and Routing Protocols <a class='info' href='#RFC4593'>[RFC4593]<span> (</span><span class='info'>Barbir, A., Murphy, S., and Y. Yang, &ldquo;Generic Threats to Routing Protocols,&rdquo; October&nbsp;2006.</span><span>)</span></a> are applicable here as well and should be
        used as references.
</p>
<p>First, the SI resided in the customer network sends
        Start-Control-Connection-Request(SCCRQ) packet to the SC for the
        initiation of the softwire. L2TPv2 offers an optional CHAP-like tunnel
        authentication system during control connection establishment. This
        requires a shared secret between the SI and SC and no key management
        is offered for this L2TPv2.
</p>
<p>When L2TPv2 control connection is established, the SI and SC
        optionally enter authentication phase after completing PPP Link
        Control Protocol (LCP) negotiation. PPP authentication supports one
        way or two way CHAP authentication, and can leverage existing AAA
        infrastructure. PPP authentication does not provide per-packet
        authentication.
</p>
<p>PPP encryption is defined but PPP Encryption Control Protocol (ECP)
        negotiation does not provide for a protected cipher suite negotiation.
        PPP encryption provides a weak security solution [RFC3193]. PPP ECP
        implementation cannot be expected. PPP authentication also does not
        provide the scalable key management.
</p>
<p>Once the L2TPv2 tunnel and PPP configuration are successfully
        established, the SI is connected and can start using the
        connection.
</p>
<p>These steps are vulnerable to man-in-the-middle (MITM), denial of
        service (DoS), and service theft attacks, which are caused as the
        consequence of the following adversary actions.
</p>
<p>Adversary attacks on softwire include: </p>
<ol class="text">
<li>An adversary may try to discover identities and other
            confidential informationby snooping data packets.
</li>
<li>An adversary may try to modify both control and data packets.
            This type of attack involves integrity violations.
</li>
<li>An adversary may try to eavesdrop and collect control messages.
            By replaying these messages, an adversary may successfully hijack
            the L2TP tunnel or the PPP connection inside the tunnel. An
            adversary might mount MITM, DOS, and theft of service attacks.
</li>
<li>An adversary can flood the softwire node with bogus signaling
            messages to cause DoS attacks by terminating L2TP tunnels or PPP
            connections.
</li>
<li>An adversary may attempt to disrupt the softwire negotiation in
            order to weaken or remove confidentiality protection.
</li>
<li>An adversary may wish to disrupt the PPP LCP authentication
            negotiation.
</li>
</ol>

<p>When AAA servers are involved in softwire tunnel establishment, the
        security attacks can be mounted on the communication associated with
        AAA servers. Specifically for the case 3 stated in Section 3.2, an
        adversary may eavesdrop the packets between AAA servers in the home
        and visted network and compromise the authentication data. An
        adversary may also disrupt the communication between the AAA servers,
        causing a service denial. Security of AAA server communications is out
        of scope of this document.
</p>
<p>In environments where the link is shared without the cryptographic
        protection and the weak authentication or one-way authentication is
        used, these security attacks can be mounted on softwire control and
        data packets.
</p>
<p>When there is no prior trust relationship between the SI and SC,
        any node can pretend to be a SC. In this case, an adversary may
        impersonate the SC to intercept traffic (e.g. "rogue" softwire
        concentrator).
</p>
<p>The rogue SC can introduce a denial of service attack by
        blackholing packets from the SI. The rogue SC can also eavesdrop on
        all packets sent from or to the SI. Security threats of a rogue SC are
        similar to a compromised router.
</p>
<p>The deployment of ingress filtering is able to control the
        malicious users' access <a class='info' href='#RFC4213'>[RFC4213]<span> (</span><span class='info'>Nordmark, E. and R. Gilligan, &ldquo;Basic Transition Mechanisms for IPv6 Hosts and Routers,&rdquo; October&nbsp;2005.</span><span>)</span></a>. Without
        specific ingress filtering checks in the decapsulator at the SC, it
        would be possible for an attacker to inject a false packet, leaving
        the system vulnerable to attacks such as DoS. The inner address
        ingress filtering can reject invalid inner source address. Without
        inner address ingress filtering, another kind of attack can happen.
        The malicious users from another ISP could start using its tunneling
        infrastructure to get free inner address connectivity, transforming
        effectively the ISP into an inner address transit provider.
</p>
<p>While the ingress filtering does not provide the complete
        protection in the case an address spoofing has been happened. In order
        to provide better protection against address spoofing, authentication
        with binding between the legitimate address and the authenticated
        identity MUST be implemented. This can be implemented between the SC
        and the SI using IPsec.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Softwire Security Guidelines</h3>

<p>Based on the security threat analysis in Section 3.3 in this
        document, the softwire security protocol MUST support the following
        protections.
</p>
<p></p>
<ol class="text">
<li>Softwire control messages between the SI and SC MUST be
            protected against eavesdropping and spoofing attacks.
</li>
<li>Softwire security protocol MUST be able to protect itself
            against replay attacks.
</li>
<li>Softwire security protocol MUST be able to protect the device
            identifier against the impersonation when it is exchanged between
            the SI and the SC.
</li>
<li>Softwire security protocol MUST be able to securely bind the
            authenticated session to the device identifier of the client, to
            prevent service theft.
</li>
<li>Softwire security protocol MUST be able to protect disconnect
            and revocation messages.
</li>
</ol>

<p>The softwire security protocol requirement is comparable to <a class='info' href='#RFC3193'>[RFC3193]<span> (</span><span class='info'>Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;Securing L2TP using IPsec,&rdquo; November&nbsp;2001.</span><span>)</span></a>.
</p>
<p>For softwire control packets, authentication, integrity and replay
        protection MUST be supported and confidentiality SHOULD be
        supported.
</p>
<p>For softwire data packets, authentication, integrity and replay
        protection SHOULD be supported and confidentiality MAY be
        supported.
</p>
<p>The softwire problem statement <a class='info' href='#RFC4925'>[RFC4925]<span> (</span><span class='info'>Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;Softwire Problem Statement,&rdquo; July&nbsp;2007.</span><span>)</span></a>
        provides some requirements for “Hubs and Spoke" solution that are
        taken into account in defining the security protection mechanisms.
        </p>
<ol class="text">
<li>Control and/or data plane MUST be able to provide full payload
            security when desired.
</li>
<li>Deployed technology MUST be very strongly considered.
</li>
</ol>

<p>This additional security protection must be separable from the
        softwire tunneling mechanism.
</p>
<p>Note that the scope of the security is on the L2TP tunnel between
        the SI and SC. If end-to-end security is required, a security protocol
        SHOULD be used in the payload packets. But this is out of scope of
        this document.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Authentication</h3>

<p>The softwire security protocol MUST support user authentication
          in the control plane, in order to authorize access to the service,
          and provide adequate logging of activity. Although several
          authentication protocols are available, the security threats must be
          considered to choose the protocol.
</p>
<p>For example, the SI/user using Password Authentication Protocol
          (PAP) access to the SC with the cleartext password. In many
          circumstances, this represents a large security risk. The adversary
          may spoof as a legitimate user by using the stolen password.
          Challenge Handshake Authentication Protocol (CHAP) <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a> encrypts a password with “challenge" sent
          from the SC. The theft of password can be mitigated. However, as
          CHAP only supports unidirectional authentication, the risk of a
          man-in-the-middle or rogue SC cannot be avoided. Extensible
          Authentication Protocol-Transport Layer Security (EAP-TLS) <a class='info' href='#RFC5216'>[RFC5216]<span> (</span><span class='info'>Simon, D., Aboba, B., and R. Hurst, &ldquo;The EAP-TLS Authentication Protocol,&rdquo; March&nbsp;2008.</span><span>)</span></a> mandates mutual authentication and avoid
          the rogue SC.
</p>
<p>When the SI established a connection to the SC through a public
          network, the SI may want to a proof of the SC identity. Softwire
          MUST support mutual authentication to allow for such scenario.
</p>
<p>In some circumstances, however, the service provider may decide
          to allow non-authenticated connection <a class='info' href='#I-D.ietf-softwire-hs-framework-l2tpv2'>[I&#8209;D.ietf&#8209;softwire&#8209;hs&#8209;framework&#8209;l2tpv2]<span> (</span><span class='info'>Storer, B., Pignataro, C., Santos, M., Stevant, B., and J. Tremblay, &ldquo;Softwire Hub &amp; Spoke Deployment Framework with L2TPv2,&rdquo; March&nbsp;2009.</span><span>)</span></a>. For example,
          when the customer is already authenticated by some other means, such
          as closed networks, cellular networks at Layer 2, etc., the service
          provider may decide to turn authentication off. If no authentication
          is conducted on any layer, the SC acts as a gateway for anonymous
          connections. Running such a service MUST be configurable by the SC
          administrator and the SC SHOULD take some security measures such as
          ingress filtering and adequate logging of activity. It should be
          noted that anonymous connection service cannot provide the security
          functionalities described in this document (e.g. integrity, replay
          protection and confidentiality).
</p>
<p>L2TPv2 selected as Softwire phase 1 protocol supports PPP
          authentication and L2TPv2 authentication. PPP authentication and
          L2TPv2 have various security threats as stated in Section 3.3. They
          will be used in the limited condition as described in the next
          subsections.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.1"></a><h3>3.4.1.1.&nbsp;
PPP Authentication</h3>

<p>PPP can provide mutual authentication between the SI and SC
            using CHAP [RFC1994] during the connection establishment phase
            (Link Control Protocol, LCP). PPP CHAP authentication can be used
            when the SI and SC are on a trusted, non-public IP network.
</p>
<p>Since CHAP does not provide per-packet authentication,
            integrity, or replay protection, PPP CHAP authentication MUST NOT
            be used for unprotected on a public IP network. If other
            appropriate protected mechanism has been already applied, PPP CHAP
            authentication MAY be used.
</p>
<p>Optionally, other authentication methods such as PAP, MS-CHAP
            EAP MAY be supported.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.2"></a><h3>3.4.1.2.&nbsp;
L2TPv2 Authentication</h3>

<p>L2TPv2 provides an optional CHAP-like tunnel authentication
          during the control connection establishment [RFC2661, 5.1.1]. L2TPv2
          authentication MUST NOT be used for unprotected on a public IP
          network as the same restriction applied to PPP CHAP.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
Softwire Security Protocol</h3>

<p>To meet the above requirements, all softwire security compliant
        implementations MUST implement the following security protocols.
</p>
<p>IPsec ESP <a class='info' href='#RFC4303'>[RFC4303]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a> in transport mode is used
        for securing softwire control and data packets. Internet Key Exchange
        (IKE) protocol<a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> MUST be supported for
        authentication, security association negotiation and key management
        for IPsec. The applicability of different version of IKE is discussed
        in Section 3.5.
</p>
<p>The softwire security protocol MUST support NAT traversal. UDP
        encapsulation of IPsec ESP packets<a class='info' href='#RFC3948'>[RFC3948]<span> (</span><span class='info'>Huttunen, A., Swander, B., Volpe, V., DiBurro, L., and M. Stenberg, &ldquo;UDP Encapsulation of IPsec ESP Packets,&rdquo; January&nbsp;2005.</span><span>)</span></a> and
        negotiation of NAT-traversal in IKE<a class='info' href='#RFC3947'>[RFC3947]<span> (</span><span class='info'>Kivinen, T., Swander, B., Huttunen, A., and V. Volpe, &ldquo;Negotiation of NAT-Traversal in the IKE,&rdquo; January&nbsp;2005.</span><span>)</span></a> MUST
        be supported when IPsec is used.
</p>
<a name="guidelines_hs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Guidelines for Usage of IPsec in Softwire</h3>

<p>When softwire "Hubs and Spokes" solution implemented by L2TPv2 is
        used in untrustworthy network, softwire MUST be protected by
        appropriate security protocol such as IPsec. This section provides
        guidelines for the usage of IPsec in L2TPv2 based softwire.
</p>
<p><a class='info' href='#RFC3193'>[RFC3193]<span> (</span><span class='info'>Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;Securing L2TP using IPsec,&rdquo; November&nbsp;2001.</span><span>)</span></a> discusses how L2TP can use IKE <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a> and IPsec <a class='info' href='#RFC2401'>[RFC2401]<span> (</span><span class='info'>Kent, S. and R. Atkinson, &ldquo;Security Architecture for the Internet Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a> to
        provide tunnel authentication, privacy protection, integrity checking
        and replay protection. Since its publication, the revision to IPsec
        protocols have been published (IKEv2 <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>,
        ESP <a class='info' href='#RFC4303'>[RFC4303]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>, NAT-traversal for IKE <a class='info' href='#RFC3947'>[RFC3947]<span> (</span><span class='info'>Kivinen, T., Swander, B., Huttunen, A., and V. Volpe, &ldquo;Negotiation of NAT-Traversal in the IKE,&rdquo; January&nbsp;2005.</span><span>)</span></a> and ESP<a class='info' href='#RFC3948'>[RFC3948]<span> (</span><span class='info'>Huttunen, A., Swander, B., Volpe, V., DiBurro, L., and M. Stenberg, &ldquo;UDP Encapsulation of IPsec ESP Packets,&rdquo; January&nbsp;2005.</span><span>)</span></a>).
</p>
<p>Given that deployed technology must be very strongly considered
        <a class='info' href='#RFC4925'>[RFC4925]<span> (</span><span class='info'>Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;Softwire Problem Statement,&rdquo; July&nbsp;2007.</span><span>)</span></a> for the 'time-to-market' solution,
        <a class='info' href='#RFC3193'>[RFC3193]<span> (</span><span class='info'>Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;Securing L2TP using IPsec,&rdquo; November&nbsp;2001.</span><span>)</span></a> MUST be supported. However, the new
        implementation SHOULD use IKEv2 <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> for
        IPsec because of the numerous advantages over IKE <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a>. In new deployments, IKEv2 SHOULD be used as
        well.
</p>
<p>Although <a class='info' href='#RFC3193'>[RFC3193]<span> (</span><span class='info'>Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;Securing L2TP using IPsec,&rdquo; November&nbsp;2001.</span><span>)</span></a> can be applied in the
        softwire "Hubs and Spokes" solution, softwire requirements such as
        NAT-traversal, NAT-traversal for IKE <a class='info' href='#RFC3947'>[RFC3947]<span> (</span><span class='info'>Kivinen, T., Swander, B., Huttunen, A., and V. Volpe, &ldquo;Negotiation of NAT-Traversal in the IKE,&rdquo; January&nbsp;2005.</span><span>)</span></a>
        and ESP <a class='info' href='#RFC3948'>[RFC3948]<span> (</span><span class='info'>Huttunen, A., Swander, B., Volpe, V., DiBurro, L., and M. Stenberg, &ldquo;UDP Encapsulation of IPsec ESP Packets,&rdquo; January&nbsp;2005.</span><span>)</span></a> MUST be supported.
</p>
<p>Meanwhile, IKEv2 <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> integrates
        NAT-traversal. IKEv2 also supports EAP authentication with the
        authentication using shared secrets (pre-shared key) or public key
        signature (certificate).
</p>
<p>The selection of pre-shared key and certificate depends on the
        scale of the network for softwire to be deployed as described in
        Section 3.5.2. However, pre-shared key and certificates only support
        the machine authentication. When both machine and user authentications
        are required, for example, in the nomadic case, EAP SHOULD be
        used.
</p>
<p>Together with EAP, IKEv2 <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> supports
        legacy authentication methods that may be useful in environments where
        username and password based authentication is already deployed.
</p>
<p>IKEv2 is more reliable protocol than IKE <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a>in terms of the replay protection capability,
        DoS protection enabled mechanism etc. Therefore, new implementations
        SHOULD use IKEv2 over IKE.
</p>
<p>The following sections will discuss using IPsec to protect L2TPv2
        as applied in the softwire "Hubs and Spokes" model. Unless otherwise
        stated, IKEv2 and the new IPsec architecture <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> is assumed.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.1"></a><h3>3.5.1.&nbsp;
Authentication Issues</h3>

<p>IPsec implementation using IKE only supports machine
        authentication. There is no way to verify a user identity and to
        segregate the tunnel traffic among users in the multi-user machine
        environment. IKEv2 can support user authentication with EAP payload by
        leveraging existing authentication infrastructure and credential
        database. This enables the traffic segregation among users when user
        authentication is used by combining the legacy authentication. The
        user identity asserted within IKEv2 will be verified on a per-packet
        basis.
</p>
<p>If the AAA server is involved in security association establishment
        between the SI and SC, a session key can be derived from the
        authentication between the SI and the AAA server. Successful EAP
        exchanges within IKEv2 runs between the SI and the AAA server create a
        session key and it is securely transferred to the SC from the AAA
        server. The trust relationship between the involved entities follows
        Section 3.2 of this document.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.2"></a><h3>3.5.2.&nbsp;
IPsec Pre-Shared Keys for Authentication</h3>

<p>With IPsec, when the identity asserted in IKE is authenticated, the
        resulting derived keys are used to provide per-packet authentication,
        integrity and replay protection. As a result, the identity verified in
        the IKE is subsequently verified on reception of each packet.
</p>
<p>Authentication using pre-shared keys can be used when the number of
        SI and SC is small. As the number of SI and SC grows, pre-shared keys
        becomes increasingly difficult to manage. A softwire security protocol
        MUST provide a scalable approach to key management. Whenever possible,
        authentication with certificates is preferred.
</p>
<p>When pre-shared keys are used, group pre-shared keys MUST NOT be
        used because of its vulnerability to Man-In-The-Middle attacks
        ([RFC3193], 5.1.4).
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.3"></a><h3>3.5.3.&nbsp;
Inter-Operability Guidelines</h3>

<p>The L2TPv2/IPsec inter-operability concerning tunnel teardown,
          fragmentation and per-packet security checks given in ([RFC3193]
          section 3) must be taken into account.
</p>
<p>Although the L2TP specification allows the responder (SC in
          softwire) to use a new IP address or to change the port number when
          sending the Start-Control-Connection-Request-Reply (SCCRP), a
          softwire concentrator implementation SHOULD NOT do this ([RFC3193]
          section 4).
</p>
<p>However, with some reasons, for example, "load-balancing" between
          SCs, the IP address change is required. To signal an IP address
          change, the SC sends a StopCCN message to the SI using the Result
          and Error Code AVP in L2TPv2 message. A new IKE_SA and CHILD_SA MUST
          be established to the new IP address.
</p>
<p>Since ESP transport mode is used, the UDP header carrying the
          L2TP packet will have an incorrect checksum due to the change of
          parts of the IP header during transit. [RFC3948] section 3.1.2
          defines 3 procedures that can be used to fix the checksum. A
          softwire implementation MUST NOT use the "incremental update of
          checksum" (option 1 described in<a class='info' href='#RFC3948'>[RFC3948]<span> (</span><span class='info'>Huttunen, A., Swander, B., Volpe, V., DiBurro, L., and M. Stenberg, &ldquo;UDP Encapsulation of IPsec ESP Packets,&rdquo; January&nbsp;2005.</span><span>)</span></a>),
          because the IKEv2 does not have the information required (NAT-OA
          payload) to compute that checksum. Since ESP is already providing
          validation on the L2TP packet, a simple approach is to use the "do
          not check" approach (option 3 in <a class='info' href='#RFC3948'>[RFC3948]<span> (</span><span class='info'>Huttunen, A., Swander, B., Volpe, V., DiBurro, L., and M. Stenberg, &ldquo;UDP Encapsulation of IPsec ESP Packets,&rdquo; January&nbsp;2005.</span><span>)</span></a>).
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.4"></a><h3>3.5.4.&nbsp;
IPsec Filtering Details</h3>

<p>If the old IPsec architecture <a class='info' href='#RFC2401'>[RFC2401]<span> (</span><span class='info'>Kent, S. and R. Atkinson, &ldquo;Security Architecture for the Internet Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a> and
          IKE <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a> are used, the security policy
          database (SPD) examples in <a class='info' href='#RFC3193'>[RFC3193]<span> (</span><span class='info'>Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;Securing L2TP using IPsec,&rdquo; November&nbsp;2001.</span><span>)</span></a> appendix A
          can be applied to softwire model. In that case, the initiator is
          always the client (SI), and responder is the SC. IPsec SPD examples
          for IKE <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a> are also given in appendix A
          of this document.
</p>
<p>The revised IPsec architecture <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>
          redefined the SPD entries to provide more flexibility (multiple
          selectors per entry, list of address range, peer authentication
          database (PAD), "populate from packet"(PFP) flag, etc.). The
          Internet Key Exchange (IKE) has also been revised and simplified in
          IKEv2 <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. The following sections
          provides the SPD examples for softwire to use the revised IPsec
          architecture and IKEv2.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.4.1"></a><h3>3.5.4.1.&nbsp;
IPv6 over IPv4 Softwire L2TPv2 example for IKEv2</h3>

<p>If IKEv2 is used as the key management protocol, RFC4301
            provides the guidance of the SPD entries. In IKEv2, we can use PFP
            flag to specify SA and the port number can be selected with
            Traffic Selector with TSr during CREATE_CHILD_SA. The following
            describes PAD entries on the SI and SC, respectively. The PAD
            entries are only example configurations. The PAD entry on the SC
            matches user identities to the L2TP SPD entry. This is done using
            a symbolic name type specified in <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
</p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>SI PAD:
- IF remote_identity = SI_identity
     Then authenticate (shared secret/certificate/)
     and authorize CHILD_SA for remote address SC_address

SC PAD:
- IF remote_identity = user_1
     Then authenticate (shared secret/certificate/EAP)
     and authorize CHILD_SAs for symbolic name "l2tp_spd_entry"</pre></div>
<p>The following describes the SPD entries for the SI and SC,
            respectively. Note that IKEv2 and ESP traffic MUST be allowed
            (bypass). These include IP protocol 50 and UDP port 500 and
            4500.
</p>
<p>The IPv4 packet format of ESP protecting L2TPv2 carrying IPv6
            packet is shown in Table 1 by using the similar Table in <a class='info' href='#RFC4891'>[RFC4891]<span> (</span><span class='info'>Graveman, R., Parthasarathy, M., Savola, P., and H. Tschofenig, &ldquo;Using IPsec to Secure IPv6-in-IPv4 Tunnels,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----------------------------+------------------------------------+
| Components (first to last) |              Contains              |
+----------------------------+------------------------------------+
|         IPv4 header        |   (src = IPv4-SI, dst = IPv4-SC)   |
|         ESP header         |                                    |
|         UDP header         |   (src port=1701, dst port=1701)   |
|         L2TPv2 header      |                                    |
|         PPP header         |                                    |
|         IPv6 header        |                                    |
|         (payload)          |                                    |
|         ESP ICV            |                                    |
+----------------------------+------------------------------------+

 Table 1: Packet Format for L2TPv2 with ESP carrying IPv6 packet.</pre></div>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>SPD for Softwire Initiator:

Softwire Initiator SPD-S
- IF local_address=IPv4-SI
     remote_address=IPv4-SC
     Next Layer Protocol=UDP
     local_port=1701
     remote_port=ANY (PFP=1)
 Then use SA ESP transport mode
 Initiate using IDi = user_1 to address IPv4-SC</pre></div><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>SPD for Softwire Concentrator:

Softwire Concentrator SPD-S
- IF name="l2tp_spd_entry"
     local_address=IPv4-SC
     remote_address=ANY (PFP=1)
     Next Layer Protocol=UDP
     local_port=1701
     remote_port=ANY (PFP=1)
 Then use SA ESP transport mode</pre></div>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.4.2"></a><h3>3.5.4.2.&nbsp;
IPv4 over IPv6 Softwire L2TPv2 example for IKEv2</h3>

<p>The PAD entries for SI and SC are shown as examples. These
            example configurations are similar to those in 3.3.4.1.<a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>
</p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>SI PAD:
- IF remote_identity = SI_identity
     Then authenticate (shared secret/certificate/)
     and authorize CHILD_SA for remote address SC_address

SC PAD:
- IF remote_identity = user_2
     Then authenticate (shared secret/certificate/EAP)
     and authorize CHILD_SAs for symbolic name "l2tp_spd_entry"</pre></div>
<p>The following describes the SPD entries for the SI and SC,
            respectively. In this example, the SI and SC are denoted with IPv6
            addresses IPv6-SI and IPv6-SC, respectively. Note that IKEv2 and
            ESP traffic MUST be allowed (bypass). These include IP protocol 50
            and UDP port 500 and 4500.
</p>
<p>The IPv6 packet format of ESP protecting L2TPv2 carrying IPv4
            packet is shown in Table 2 by using similar one in <a class='info' href='#RFC4891'>[RFC4891]<span> (</span><span class='info'>Graveman, R., Parthasarathy, M., Savola, P., and H. Tschofenig, &ldquo;Using IPsec to Secure IPv6-in-IPv4 Tunnels,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----------------------------+------------------------------------+
| Components (first to last) |              Contains              |
+----------------------------+------------------------------------+
|         IPv6 header        |   (src = IPv6-SI, dst = IPv6-SC)   |
|         ESP header         |                                    |
|         UDP header         |   (src port=1701, dst port=1701)   |
|         L2TPv2 header      |                                    |
|         PPP header         |                                    |
|         IPv4 header        |                                    |
|         (payload)          |                                    |
|         ESP ICV            |                                    |
+----------------------------+------------------------------------+

 Table 2: Packet Format for L2TPv2 with ESP carrying IPv4 packet.</pre></div>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>SPD for Softwire Initiator:

Softwire Initiator SPD-S
- IF local_address=IPv6-SI
     remote_address=IPv6-SC
     Next Layer Protocol=UDP
     local_port=1701
     remote_port=ANY (PFP=1)
 Then use SA ESP transport mode
 Initiate using IDi = user_2 to address IPv6-SC</pre></div>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>SPD for Softwire Concentrator:

Softwire Concentrator SPD-S
- IF name="l2tp_spd_entry"
     local_address=IPv6-SC
     remote_address=ANY (PFP=1)
     Next Layer Protocol=UDP
     local_port=1701
     remote_port=ANY (PFP=1)
 Then use SA ESP transport mode</pre></div>
<a name="mesh"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Mesh Security Guidelines</h3>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Deployment Scenario</h3>

<p>In the softwire “Mesh" solution<a class='info' href='#RFC4925'>[RFC4925]<span> (</span><span class='info'>Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;Softwire Problem Statement,&rdquo; July&nbsp;2007.</span><span>)</span></a>,
        <a class='info' href='#RFC5565'>[RFC5565]<span> (</span><span class='info'>Wu, J., Cui, Y., Metz, C., and E. Rosen, &ldquo;Softwire Mesh Framework,&rdquo; June&nbsp;2009.</span><span>)</span></a>, it is required to establish
        connectivity to access network islands of one address family type
        across a transit core of a differing address family type. To provide
        reachability across the transit core, AFBRs are installed between
        access network island and transit core network. These AFBRs can
        perform as Provider Edge routers (PE) within an autonomous system or
        perform peering across autonomous systems. The AFBRs establish and
        encapsulate softwires in a mesh to the other islands across the
        transit core network. The transit core network consists of one or more
        service providers.
</p>
<p>In the softwire “Mesh" solution, a pair of PE routers (AFBRs) use
        BGP to exchange routing information. AFBR nodes in the transit network
        are Internal BGP speakers and will peer with each other directly or
        via a route reflector to exchange SW-encap sets, perform softwire
        signaling, and advertise AF access island reachability information and
        SW-NHOP information. If such information is advertised within an
        autonomous system, the AFBR node receiving them from other AFBRs does
        not forward them to other AFBR nodes. To exchange the information
        among AFBRs, the full mesh connectivity will be established.
</p>
<p>The connectivity between CE and PE routers includes dedicated
        physical circuits, logical circuits (such as Frame Relay and ATM), and
        shared medium access (such as Ethernet-based access).
</p>
<p>When AFBRs are PE routers located at the edge of the provider core
        networks, this is similar architecture of the L3VPN described in <a class='info' href='#RFC4364'>[RFC4364]<span> (</span><span class='info'>Rosen, E. and Y. Rekhter, &ldquo;BGP/MPLS IP Virtual Private Networks (VPNs),&rdquo; February&nbsp;2006.</span><span>)</span></a>. The connectivity between a CE router in
        access island network and a PE router in transit network is
        established by static way. The access islands are enterprise networks
        accommodated through PE routers in the provider's transit network. In
        this case, the access island networks are administrated by the
        provider's autonomous system.
</p>
<p>The AFBRs may have the multiple connections to the core network,
        and also may have the connections to the multiple client access
        networks. The client access networks may connect each other through
        private networks or through the Internet. When the client access
        networks have their own AS number, a CE router located inside access
        islands forms a private BGP peering with an AFBR. Further, an AFBR may
        need to exchange a full Internet routing information with each network
        to which it connects.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Trust Relationship</h3>

<p>All AFBR nodes in the transit core MUST have a trust relationship
        or an agreement with each other to establish softwires. When the
        transit core consists of a single administrative domain, it is assumed
        that all nodes (e.g. AFBR, PE or Route Reflector, if applicable) are
        trusted with each other.
</p>
<p>If the transit core consists of multiple administrative domains,
        intermediate routers between AFBRs may not be trusted.
</p>
<p>There MUST be a trust relationship between the PE in the transit
        core and the CE in the corresponding island, although the link(s)
        between the PE and the CE may not be protected.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Softwire Security Threat Scenarios</h3>

<p>As the architecture of softwire mesh solution is very similar to
        that of the provider provisioned VPN (PPVPN). The security threats
        considerations on the PPVPN operation are applicable to those in the
        softwire mesh solution <a class='info' href='#RFC4111'>[RFC4111]<span> (</span><span class='info'>Fang, L., &ldquo;Security Framework for Provider-Provisioned Virtual Private Networks (PPVPNs),&rdquo; July&nbsp;2005.</span><span>)</span></a>.
</p>
<p>Examples of attacks to data packets being transmitted on a softwire
        tunnel include:</p>
<ol class="text">
<li>An adversary may try to discover confidential information by
            sniffing softwire packets.
</li>
<li>An adversary may try to modify the contents of softwire
            packets.
</li>
<li>An adversary may try to spoof the softwire packets that do not
            belong the authorized domains and to insert copies of
            once-legitimate packets that have been recorded and replayed.
</li>
<li>An adversary can launch Denial-of-Service (DoS) attack by
            deleting softwire data traffic. DoS attacks of the resource
            exhaustion type can be mounted against the data plane by spoofing
            a large amount of non-authenticated data into the softwire from
            the outside of the softwire tunnel.
</li>
<li>An adversary may try to sniff softwire packets and to examine
            aspects or meta-aspects of them that may be visible even when the
            packets themselves are encrypted. An attacker might gain useful
            information based on the amount and timing of traffic, packet
            sizes, sources and destination addresses, etc.
</li>
</ol>

<p>The security attacks can be mounted on the control plane as well.
        In softwire mesh solution, softwires encapsulation will be set up by
        using BGP. As described in <a class='info' href='#RFC4272'>[RFC4272]<span> (</span><span class='info'>Murphy, S., &ldquo;BGP Security Vulnerabilities Analysis,&rdquo; January&nbsp;2006.</span><span>)</span></a>, BGP is
        vulnerable to various security threats such as confidential violation,
        replay attacks, insertion, deletion and modification of BGP messages,
        main-in-the-middle, and denial-of-service.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Applicability of Security Protection Mechanism</h3>

<p>Given that security is generally a compromise between expense and
        risk, it is also useful to consider the likelihood of different
        attacks. There is at least a perceived difference in the likelihood of
        most types of attacks being successfully mounted in different
        deployment.
</p>
<p>The trust relationship among users in access networks, transit core
        provider, and other parts of networks described in section 4.2 is a
        key element in determining the applicability of security protection
        mechanism for the specific softwire mesh deployment.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.1"></a><h3>4.4.1.&nbsp;
Security Protection Mechanism for Control Plane</h3>

<p>The Softwire Problem Statement <a class='info' href='#RFC4925'>[RFC4925]<span> (</span><span class='info'>Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;Softwire Problem Statement,&rdquo; July&nbsp;2007.</span><span>)</span></a>
        states that the softwire mesh setup mechanism to advertise the
        softwire encapsulation MUST support authentication, but the transit
        core provider may decide to turn it off in some circumstances.
</p>
<p>The BGP authentication mechanism is specified in <a class='info' href='#RFC2385'>[RFC2385]<span> (</span><span class='info'>Heffernan, A., &ldquo;Protection of BGP Sessions via the TCP MD5 Signature Option,&rdquo; August&nbsp;1998.</span><span>)</span></a>. The mechanism defined in <a class='info' href='#RFC2385'>[RFC2385]<span> (</span><span class='info'>Heffernan, A., &ldquo;Protection of BGP Sessions via the TCP MD5 Signature Option,&rdquo; August&nbsp;1998.</span><span>)</span></a> is based on a one-way hash function (MD5) and
        use of a secret key. The key is shared between a pair of peer routers
        and is used to generate 16-byte message authentication code values
        that are not readily computed by an attacker who does not have access
        to the key.
</p>
<p>However the security mechanism for BGP transport (e.g. TCP-MD5) is
        inadequate in some circumstances and also requires operator
        interaction to maintain a respectable level of security. The current
        deployments of TCP-MD5 exhibit some shortcomings with respect of key
        management as described in <a class='info' href='#RFC3562'>[RFC3562]<span> (</span><span class='info'>Leech, M., &ldquo;Key Management Considerations for the TCP MD5 Signature Option,&rdquo; July&nbsp;2003.</span><span>)</span></a>.
</p>
<p>Key management can be especially cumbersome for operators. The
        number of keys required and the maintenance of keys (issue/revoke/
        renew) has had an additive effect as a barrier to deployment. Thus
        automated means of managing keys, to reduce operational burdens, is
        available in BGP security system <a class='info' href='#I-D.ietf-rpsec-bgpsecrec'>[I&#8209;D.ietf&#8209;rpsec&#8209;bgpsecrec]<span> (</span><span class='info'>Christian, B. and T. Tauber, &ldquo;BGP Security Requirements,&rdquo; November&nbsp;2008.</span><span>)</span></a>, <a class='info' href='#RFC4107'>[RFC4107]<span> (</span><span class='info'>Bellovin, S. and R. Housley, &ldquo;Guidelines for Cryptographic Key Management,&rdquo; June&nbsp;2005.</span><span>)</span></a>.
</p>
<p>Use of IPsec counters the message insertion, deletion, and
        modification attacks, as well as man-in-the-middle attacks by
        outsiders. If routing data confidentiality is desired, the use of
        IPsec ESP could provide that service. If eavesdropping attack is
        identified as a threat, ESP can be used to provide confidentiality
        (encryption), integrity and authentication for the BGP session.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.2"></a><h3>4.4.2.&nbsp;
Security Protection Mechanism for Data Plane</h3>

<p>To transport data packets across the transit core, the mesh
        solution defines multiple encapsulations: L2TPv3, IP-in-IP, MPLS
        (LDP-based and RSVP-TE based), and GRE. To securely transport such
        data packet, the softwire MUST support IPsec tunnel.
</p>
<p>IPsec can provide authentication and integrity. The implementation
        MUST support ESP with null encryption <a class='info' href='#RFC4303'>[RFC4303]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>
        or else AH (IP Authentication Header) <a class='info' href='#RFC4302'>[RFC4302]<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
        If some part of the transit core network is not trusted, ESP with
        encryption MAY be applied.
</p>
<p>Since the softwires are created dynamically by BGP, the automated
        key distribution MUST be performed by IKEv2 <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> with either pre-shared key or public key
        management. For the dynamic softwire IPsec tunnel creation, pre-shared
        key will be same in all routers. Namely pre-shared key indicates here
        group key instead of pairwise shared key.
</p>
<p>If security policy requires a stronger key management, the public
        key SHOULD be used. If a public key infrastructure is not available,
        the IPsec Tunnel Authentication sub-TLV specified in <a class='info' href='#RFC5566'>[RFC5566]<span> (</span><span class='info'>Berger, L., White, R., and E. Rosen, &ldquo;BGP IPsec Tunnel Encapsulation Attribute,&rdquo; June&nbsp;2009.</span><span>)</span></a> MUST be used before SA is established.
</p>
<p>If the link(s) between the user's site and the provider's PE is not
        trusted, then encryption MAY be used on the PE-CE link(s).
</p>
<p>Together with the cryptographic security protection, the access
        control technique reduces the exposure to attacks from outside the
        service provider networks (transit networks). The access control
        technique includes packet-by-packet or packet flow-by-packet flow
        access control by means of filters as well as by means of admitting a
        session for a control/signaling/management protocol that is being used
        to implement softwire mesh.
</p>
<p>The access control technique is an important protection against
        security attacks of DoS etc. and a necessary adjunct to cryptographic
        strength in encapsulation. Packets that match the criteria associated
        with a particular filter may be either discarded or given special
        treatment to prevent an attack or to mitigate the effect of a possible
        future attack.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>This document discusses various security threats for the softwire
      control and data packets in “Hubs and Spokes" and “Mesh" time-to-market
      solutions. With these discussions, the softwire security protocol
      implementations are provided referencing to Softwire Problem Statement
      <a class='info' href='#RFC4925'>[RFC4925]<span> (</span><span class='info'>Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;Softwire Problem Statement,&rdquo; July&nbsp;2007.</span><span>)</span></a>, Securing L2TP using IPsec <a class='info' href='#RFC3193'>[RFC3193]<span> (</span><span class='info'>Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;Securing L2TP using IPsec,&rdquo; November&nbsp;2001.</span><span>)</span></a>, Security Framework for PPVPNs <a class='info' href='#RFC4111'>[RFC4111]<span> (</span><span class='info'>Fang, L., &ldquo;Security Framework for Provider-Provisioned Virtual Private Networks (PPVPNs),&rdquo; July&nbsp;2005.</span><span>)</span></a>, and Guidelines for Mandating the Use of IPsec
      <a class='info' href='#RFC5406'>[RFC5406]<span> (</span><span class='info'>Bellovin, S., &ldquo;Guidelines for Specifying the Use of IPsec Version 2,&rdquo; February&nbsp;2009.</span><span>)</span></a>. The guidelines for the security protocol
      employment are also given considering the specific deployment
      context.
</p>
<p>Note that this document discusses the softwire tunnel security
      protection and does not address the end-to-end protection.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document creates no new requirements on IANA namespaces <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgments</h3>

<p>The authors would like to thank Tero Kivinen for reviewing the
      document and Francis Dupont for substantive suggestions. Acknowledgments
      to Jordi Palet Martinez, Shin Miyakawa, Yasuhiro Shirasaki, and Bruno
      Stevant for their feedback.
</p>
<p>We would like also to thank the authors of Softwire Hub &amp; Spoke
      Deployment Framework document for providing the text concerning
      security.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1994">[RFC1994]</a></td>
<td class="author-text"><a href="mailto:wsimpson@GreenDragon.com">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1994">PPP Challenge Handshake Authentication Protocol (CHAP)</a>,&rdquo; RFC&nbsp;1994, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1994.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2385">[RFC2385]</a></td>
<td class="author-text"><a href="mailto:ahh@cisco.com">Heffernan, A.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2385">Protection of BGP Sessions via the TCP MD5 Signature Option</a>,&rdquo; RFC&nbsp;2385, August&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2385.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2385.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2385.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2661">[RFC2661]</a></td>
<td class="author-text"><a href="mailto:townsley@cisco.com">Townsley, W.</a>, <a href="mailto:vandys@cisco.com">Valencia, A.</a>, <a href="mailto:acr@del.com">Rubens, A.</a>, <a href="mailto:gurdeep@microsoft.com">Pall, G.</a>, <a href="mailto:gwz@acm.org">Zorn, G.</a>, and <a href="mailto:palter@zev.net">B. Palter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2661">Layer Two Tunneling Protocol "L2TP"</a>,&rdquo; RFC&nbsp;2661, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2661.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3193">[RFC3193]</a></td>
<td class="author-text">Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;<a href="http://tools.ietf.org/html/rfc3193">Securing L2TP using IPsec</a>,&rdquo; RFC&nbsp;3193, November&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3193.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3947">[RFC3947]</a></td>
<td class="author-text">Kivinen, T., Swander, B., Huttunen, A., and V. Volpe, &ldquo;<a href="http://tools.ietf.org/html/rfc3947">Negotiation of NAT-Traversal in the IKE</a>,&rdquo; RFC&nbsp;3947, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3947.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3948">[RFC3948]</a></td>
<td class="author-text">Huttunen, A., Swander, B., Volpe, V., DiBurro, L., and M. Stenberg, &ldquo;<a href="http://tools.ietf.org/html/rfc3948">UDP Encapsulation of IPsec ESP Packets</a>,&rdquo; RFC&nbsp;3948, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3948.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4107">[RFC4107]</a></td>
<td class="author-text">Bellovin, S. and R. Housley, &ldquo;<a href="http://tools.ietf.org/html/rfc4107">Guidelines for Cryptographic Key Management</a>,&rdquo; BCP&nbsp;107, RFC&nbsp;4107, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4107.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[RFC4301]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4302">[RFC4302]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4302">IP Authentication Header</a>,&rdquo; RFC&nbsp;4302, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4302.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4303">[RFC4303]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4303, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4303.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-rpsec-bgpsecrec">[I-D.ietf-rpsec-bgpsecrec]</a></td>
<td class="author-text">Christian, B. and T. Tauber, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-rpsec-bgpsecrec-10.txt">BGP Security Requirements</a>,&rdquo; draft-ietf-rpsec-bgpsecrec-10 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-rpsec-bgpsecrec-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-softwire-hs-framework-l2tpv2">[I-D.ietf-softwire-hs-framework-l2tpv2]</a></td>
<td class="author-text">Storer, B., Pignataro, C., Santos, M., Stevant, B., and J. Tremblay, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-softwire-hs-framework-l2tpv2-12.txt">Softwire Hub &amp; Spoke Deployment Framework with L2TPv2</a>,&rdquo; draft-ietf-softwire-hs-framework-l2tpv2-12 (work in progress), March&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-softwire-hs-framework-l2tpv2-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2401">[RFC2401]</a></td>
<td class="author-text"><a href="mailto:kent@bbn.com">Kent, S.</a> and <a href="mailto:rja@corp.home.net">R. Atkinson</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2401">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;2401, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2401.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2401.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2401.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2409">[RFC2409]</a></td>
<td class="author-text"><a href="mailto:dharkins@cisco.com">Harkins, D.</a> and <a href="mailto:carrel@ipsec.org">D. Carrel</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2409">The Internet Key Exchange (IKE)</a>,&rdquo; RFC&nbsp;2409, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2409.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2409.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2409.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2607">[RFC2607]</a></td>
<td class="author-text"><a href="mailto:bernarda@microsoft.com">Aboba, B.</a> and <a href="mailto:jrv@merit.edu">J. Vollbrecht</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2607">Proxy Chaining and Policy Implementation in Roaming</a>,&rdquo; RFC&nbsp;2607, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2607.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3562">[RFC3562]</a></td>
<td class="author-text">Leech, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3562">Key Management Considerations for the TCP MD5 Signature Option</a>,&rdquo; RFC&nbsp;3562, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3562.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4016">[RFC4016]</a></td>
<td class="author-text">Parthasarathy, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4016">Protocol for Carrying Authentication and Network Access (PANA) Threat Analysis and Security Requirements</a>,&rdquo; RFC&nbsp;4016, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4016.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4081">[RFC4081]</a></td>
<td class="author-text">Tschofenig, H. and D. Kroeselberg, &ldquo;<a href="http://tools.ietf.org/html/rfc4081">Security Threats for Next Steps in Signaling (NSIS)</a>,&rdquo; RFC&nbsp;4081, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4081.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4111">[RFC4111]</a></td>
<td class="author-text">Fang, L., &ldquo;<a href="http://tools.ietf.org/html/rfc4111">Security Framework for Provider-Provisioned Virtual Private Networks (PPVPNs)</a>,&rdquo; RFC&nbsp;4111, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4111.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4213">[RFC4213]</a></td>
<td class="author-text">Nordmark, E. and R. Gilligan, &ldquo;<a href="http://tools.ietf.org/html/rfc4213">Basic Transition Mechanisms for IPv6 Hosts and Routers</a>,&rdquo; RFC&nbsp;4213, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4213.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4225">[RFC4225]</a></td>
<td class="author-text">Nikander, P., Arkko, J., Aura, T., Montenegro, G., and E. Nordmark, &ldquo;<a href="http://tools.ietf.org/html/rfc4225">Mobile IP Version 6 Route Optimization Security Design Background</a>,&rdquo; RFC&nbsp;4225, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4225.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4272">[RFC4272]</a></td>
<td class="author-text">Murphy, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4272">BGP Security Vulnerabilities Analysis</a>,&rdquo; RFC&nbsp;4272, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4272.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4364">[RFC4364]</a></td>
<td class="author-text">Rosen, E. and Y. Rekhter, &ldquo;<a href="http://tools.ietf.org/html/rfc4364">BGP/MPLS IP Virtual Private Networks (VPNs)</a>,&rdquo; RFC&nbsp;4364, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4364.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4593">[RFC4593]</a></td>
<td class="author-text">Barbir, A., Murphy, S., and Y. Yang, &ldquo;<a href="http://tools.ietf.org/html/rfc4593">Generic Threats to Routing Protocols</a>,&rdquo; RFC&nbsp;4593, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4593.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4891">[RFC4891]</a></td>
<td class="author-text">Graveman, R., Parthasarathy, M., Savola, P., and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc4891">Using IPsec to Secure IPv6-in-IPv4 Tunnels</a>,&rdquo; RFC&nbsp;4891, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4891.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4925">[RFC4925]</a></td>
<td class="author-text">Li, X., Dawkins, S., Ward, D., and A. Durand, &ldquo;<a href="http://tools.ietf.org/html/rfc4925">Softwire Problem Statement</a>,&rdquo; RFC&nbsp;4925, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4925.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5216">[RFC5216]</a></td>
<td class="author-text">Simon, D., Aboba, B., and R. Hurst, &ldquo;<a href="http://tools.ietf.org/html/rfc5216">The EAP-TLS Authentication Protocol</a>,&rdquo; RFC&nbsp;5216, March&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5216.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5406">[RFC5406]</a></td>
<td class="author-text">Bellovin, S., &ldquo;<a href="http://tools.ietf.org/html/rfc5406">Guidelines for Specifying the Use of IPsec Version 2</a>,&rdquo; BCP&nbsp;146, RFC&nbsp;5406, February&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5406.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5565">[RFC5565]</a></td>
<td class="author-text">Wu, J., Cui, Y., Metz, C., and E. Rosen, &ldquo;<a href="http://tools.ietf.org/html/rfc5565">Softwire Mesh Framework</a>,&rdquo; RFC&nbsp;5565, June&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5565.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5566">[RFC5566]</a></td>
<td class="author-text">Berger, L., White, R., and E. Rosen, &ldquo;<a href="http://tools.ietf.org/html/rfc5566">BGP IPsec Tunnel Encapsulation Attribute</a>,&rdquo; RFC&nbsp;5566, June&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5566.txt">TXT</a>).</td></tr>
</table>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
</h3>

<p>If the old IPsec architecture <a class='info' href='#RFC2401'>[RFC2401]<span> (</span><span class='info'>Kent, S. and R. Atkinson, &ldquo;Security Architecture for the Internet Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a> and IKE
      <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a> are used, the SPD examples in <a class='info' href='#RFC3193'>[RFC3193]<span> (</span><span class='info'>Patel, B., Aboba, B., Dixon, W., Zorn, G., and S. Booth, &ldquo;Securing L2TP using IPsec,&rdquo; November&nbsp;2001.</span><span>)</span></a> is applicable to "Hub &amp; Spokes" model. In
      this model, the initiator is always the client (SI) and the responder is
      the SC.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
IPv6 over IPv4 Softwire with L2TPv2 example for IKE</h3>

<p>IPv4 addresses of the softwire initiator and concentrator are
        denoted by IPv4-SI and IPv4-SC, respectively. If NAT traversal is used
        in IKE, UDP source and destination ports are 4500. In this SPD entry,
        IKE refers to UDP port 500. * denotes wildcard and indicates ANY port
        or address.
</p>
<p><br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   Local     Remote     Protocol                  Action
   -----     ------     --------                  ------
   IPV4-SI   IPV4-SC      ESP                     BYPASS
   IPV4-SI   IPV4-SC      IKE                     BYPASS
   IPv4-SI   IPV4-SC      UDP, src 1701, dst 1701 PROTECT(ESP,
                                                  transport)
   IPv4-SC   IPv4-SI      UDP, src   * , dst 1701 PROTECT(ESP,
                                                  transport)

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Softwire initiator SPD&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<p><br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    Remote   Local      Protocol                  Action
    ------   ------     --------                  ------
      *      IPV4-SC      ESP                     BYPASS
      *      IPV4-SC      IKE                     BYPASS
      *      IPV4-SC      UDP, src * , dst 1701   PROTECT(ESP,
                                                  transport)

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Softwire concentrator SPD&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
IPv4 over IPv6 Softwire with example for IKE</h3>

<p>IPv6 addresses of the softwire initiator and concentrator are
        denoted by IPv6-SI and IPv6-SC, respectively. If NAT traversal is used
        in IKE, UDP source and destination ports are 4500. In this SPD entry,
        IKE refers to UDP port 500. * denotes wildcard and indicates ANY port
        or address.
</p>
<p><br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   Local     Remote     Protocol                   Action
   -----     ------     --------                   ------
   IPV6-SI   IPV6-SC      ESP                      BYPASS
   IPV6-SI   IPV6-SC      IKE                      BYPASS
   IPv6-SI   IPV6-SC      UDP, src 1701, dst 1701  PROTECT(ESP,
                                                   transport)
   IPv6-SC   IPv6-SI      UDP, src * , dst 1701    PROTECT(ESP,
                                                   transport)

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Softwire initiator SPD&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<p><br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    Remote   Local      Protocol                   Action
    ------   ------     --------                   ------
      *      IPV6-SC      ESP                      BYPASS
      *      IPV6-SC      IKE                      BYPASS
      *      IPV6-SC      UDP, src * , dst 1701    PROTECT(ESP,
                                                   transport)

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Softwire concentrator SPD&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Shu Yamamoto</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NICT/KDDI R&amp;D Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1-13-16 Hakusan, Bunkyo-ku</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tokyo,   113-0001</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Japan</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+81-3-3868-6913</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:shu@nict.go.jp">shu@nict.go.jp</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Carl Williams</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">KDDI R&amp;D Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Palo Alto, CA  94301</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-650-279-5903</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:carlw@mcsr-labs.org">carlw@mcsr-labs.org</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Florent Parent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beon Solutions</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Quebec, QC  </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Florent.Parent@beon.ca">Florent.Parent@beon.ca</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hidetoshi Yokota</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">KDDI R&amp;D Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2-1-15 Ohara</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fujimino, Saitama  356-8502</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Japan</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+81-49-278-7894</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yokota@kddilabs.jp">yokota@kddilabs.jp</a></td></tr>
</table>
</body></html>
