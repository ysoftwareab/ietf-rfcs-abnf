<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>TWAMP Burst Rate Measurement Features</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Purpose and Scope">
<link href="#rfc.section.3" rel="Chapter" title="3 TWAMP Control Extensions">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Connection Setup with New Features">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Burst Generation: Request-TW-Session Packet Format">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Burst Measurement: Request-TW-Session Packet Format">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Burst Gen and Meas: Accept Session Packet Format">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Burst Gen and Meas: Stopping Test Sessions">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 Additional considerations">
<link href="#rfc.section.4" rel="Chapter" title="4 Burst Generation in TWAMP Test">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Sender Behavior">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Packet Timings">
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 Packet Formats and Contents">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Reflector Behavior">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Session-Reflector Burst Packet Format and Contents">
<link href="#rfc.section.5" rel="Chapter" title="5 Burst Measurement in TWAMP Test">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Sender Behavior">
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 Packet Timings">
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 Packet Formats and Contents">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Reflector Behavior">
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Session-Reflector Burst Measurement Response Packet Format and Contents">
<link href="#rfc.section.6" rel="Chapter" title="6 Special Case of One-packet Bursts">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Registry Specification">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Registry Contents">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This memo describes two rate-measurement features for the core specification of TWAMP - the Two-Way Active Measurement Protocol: an optional capability where the reflector host responds with a controlled burst of test-session packets (instead of a single packet), and an optional test mode that requires the responder to measure a burst of test packets and communicate the results in truncated packet(s). Both features add the ability to control packet size in the tested direction, enabling asymmetrical packet size testing." />
  <meta name="description" content="This memo describes two rate-measurement features for the core specification of TWAMP - the Two-Way Active Measurement Protocol: an optional capability where the reflector host responds with a controlled burst of test-session packets (instead of a single packet), and an optional test mode that requires the responder to measure a burst of test packets and communicate the results in truncated packet(s). Both features add the ability to control packet size in the tested direction, enabling asymmetrical packet size testing." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">A. Morton</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">L. Ciavattone</td>
</tr>
<tr>
<td class="left">Updates: 5357 (if approved)</td>
<td class="right">AT&amp;T Labs</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">June 30, 2011</td>
</tr>
<tr>
<td class="left">Expires: January 01, 2012</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">TWAMP Burst Rate Measurement Features<br />
  <span class="filename">draft-morton-ippm-twamp-rate-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This memo describes two rate-measurement features for the core specification of TWAMP - the Two-Way Active Measurement Protocol: an optional capability where the reflector host responds with a controlled burst of test-session packets (instead of a single packet), and an optional test mode that requires the responder to measure a burst of test packets and communicate the results in truncated packet(s). Both features add the ability to control packet size in the tested direction, enabling asymmetrical packet size testing.</p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 01, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Purpose and Scope</a>
</li>
<li>3.   <a href="#rfc.section.3">TWAMP Control Extensions</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Connection Setup with New Features</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Burst Generation: Request-TW-Session Packet Format</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Burst Measurement: Request-TW-Session Packet Format</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Burst Gen and Meas: Accept Session Packet Format</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Burst Gen and Meas: Stopping Test Sessions</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">Additional considerations</a>
</li>
<li>4.   <a href="#rfc.section.4">Burst Generation in TWAMP Test</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Sender Behavior</a>
</li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">Packet Timings</a>
</li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">Packet Formats and Contents</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Reflector Behavior</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">Session-Reflector Burst Packet Format and Contents</a>
</li>
<li>5.   <a href="#rfc.section.5">Burst Measurement in TWAMP Test</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Sender Behavior</a>
</li>
<li>5.1.1.   <a href="#rfc.section.5.1.1">Packet Timings</a>
</li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">Packet Formats and Contents</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Reflector Behavior</a>
</li>
<li>5.2.1.   <a href="#rfc.section.5.2.1">Session-Reflector Burst Measurement Response Packet Format and Contents</a>
</li>
<li>6.   <a href="#rfc.section.6">Special Case of One-packet Bursts</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">Registry Specification</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">Registry Contents</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgements</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">TWAMP - the Two-Way Active Measurement Protocol <a href="#RFC5357">[RFC5357]</a> is an extension of the One-way Active Measurement Protocol, OWAMP <a href="#RFC4656">[RFC4656]</a>. The TWAMP specification gathered wide review as it was deployed, resulting in recommendations for new features.</p>
<p id="rfc.section.1.p.2">This memo describes two closely-related features for TWAMP. When measuring packet delivery rate to end-systems, unique control and measurement capabilities become useful, especially when the path tested includes asymmetrical link speeds (as are often deployed in consumer Internet access services).</p>
<p id="rfc.section.1.p.3">One feature is the OPTIONAL capability for the responder host to return a controlled burst of test-session packets (instead of a single packet).</p>
<p id="rfc.section.1.p.4">Another is an optional sender packet format that requires the responder to measure a burst of test packets and communicate the results in a single packet.</p>
<p id="rfc.section.1.p.5">Both features add the ability to control packet size in each direction, enabling asymmetrical packet size testing. Although TWAMP <a href="#RFC5357">[RFC5357]</a> recommends padding truncation to achieve symmetrical sizes (to compensate for the Session-Reflector's larger test packet header), these features configure test packet sizes when the test session is requested using the TWAMP-Control protocol.</p>
<p id="rfc.section.1.p.6">We note that [draft-baillargeon-ippm-twamp-value-added-octets-01.txt] addresses a similar measurement problem, but places different requirements on the reflector host and does not include the asymmetrical size aspect.</p>
<p id="rfc.section.1.p.7">This memo is an update to the TWAMP core protocol specified in <a href="#RFC5357">[RFC5357]</a>. Measurement systems are not required to implement the features described in this memo to claim compliance with <a href="#RFC5357">[RFC5357]</a>.</p>
<p id="rfc.section.1.p.8">Throughout this memo, the bits marked MBZ (Must Be Zero) MUST be set to zero by senders and MUST be ignored by receivers. Also, the HMAC (Hashed Message Authentication Code) MUST be calculated as defined in Section 3.2 of <a href="#RFC4656">[RFC4656]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Purpose and Scope</h1>
<p id="rfc.section.2.p.1">The purpose of this memo is to define two OPTIONAL closely-related features for TWAMP <a href="#RFC5357">[RFC5357]</a>. The features enhance the TWAMP responder's capabilities to perform a simple operations on test packets, and the capability to demand asymmetrical size TWAMP-Test packets.</p>
<p id="rfc.section.2.p.2">The scope of the memo is limited to specifications of the following features:</p>
<p><a href="#RFC4656">[RFC4656]</a> for the format of the Server Greeting message), while retaining backward compatibility with the core TWAMP <a href="#RFC5357">[RFC5357]</a> implementations. The two new values correspond to the two features defined in this memo.</p>

<ul>
<li>Burst Generation: the capability of the Session-Reflector to generate a burst of packets for return to the Session-Sender, and the corresponding TWAMP-Control messages to activate the capability between compliant hosts.</li>
<li>Burst Measurement: the capability of the Session-Reflector to measure a burst of packets from the Session-Sender, report the key information (receive timestamps) in the response packet(s), and the corresponding TWAMP-Control messages to activate the capability between compliant hosts.</li>
<li>Asymmetrical Size: the capability to ensure that TWAMP-Test protocol uses a specific packet size in each direction. This feature is combined with the Burst features, and essentially adds a third simple capability when the Burst size = 1.</li>
</ul>

<p>This memo extends the modes of operation through assignment of two new values in the Modes Field (see section 3.1 of</p>
<p id="rfc.section.2.p.4">When the Server and Control-Client have agreed to use the Burst Generation mode during control connection setup, then the Control-Client, the Server, the Session-Sender, and the Session-Reflector MUST all conform to the requirements of that mode, as identified below.</p>
<p id="rfc.section.2.p.5">When the Server and Control-Client have agreed to use the Burst Measurement mode during control connection setup, then the Control-Client, the Server, the Session-Sender, and the Session-Reflector MUST all conform to the requirements of that mode, as identified below.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> TWAMP Control Extensions</h1>
<p id="rfc.section.3.p.1">TWAMP-Control protocol <a href="#RFC5357">[RFC5357]</a> uses the Modes Field to identify and select specific communication capabilities, and this field is a recognized extension mechanism. The following sections describe two such extensions.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Connection Setup with New Features</h1>
<p id="rfc.section.3.1.p.1">TWAMP connection establishment follows the procedure defined in section 3.1 of <a href="#RFC4656">[RFC4656]</a> and section 3.1 of <a href="#RFC5357">[RFC5357]</a>. The new features require two new bit positions (and values). See the IANA section for details on the assigned values and bit positions.</p>
<p id="rfc.section.3.1.p.2">The Server sets one or both of the new bit positions in the Modes Field of the Server Greeting message to indicate its capabilities and willingness to operate in either of these modes if desired.</p>
<p id="rfc.section.3.1.p.3">If the Control-Client intends to operate all test sessions invoked with this control connection using one of the new modes, it MUST set the Mode Field bit corresponding to each function in the Setup Response message. With this and other extensions, the Control-Client MAY set multiple Mode Field bits in the Setup Response message, but these new features are mutually exclusive, and MUST NOT be used together.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Burst Generation: Request-TW-Session Packet Format</h1>
<p id="rfc.section.3.2.p.1">The bits designated for the Burst Generation feature in the Request-TW-Session command are as shown in the packet format below.</p>
<div id="#rfc.figure.1"></div>
<p></p>

<p></p>
<pre> 0                   1                   2                   3 
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      5        |  MBZ  | IPVN  |  Conf-Sender  | Conf-Receiver |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Number of Schedule Slots                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Number of Packets*                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.           ... Many fields (62 octets) not shown ...           .
.                                                               .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Padding Length*  (4 octets)                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Start Time, (8 octets)                   |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Timeout, (8 octets)                     |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Type-P Descriptor                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Octets to be reflected    |  Length of padding to reflect |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       MBZ (2 octets)                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                       HMAC (16 octets)                        |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p>* = re-interpreted field</p>
<p id="rfc.section.3.2.p.3">Two re-interpreted fields appear in the Request-TW-Session command when using Burst Generation mode:</p>
<p></p>

<ol>
<li>Number of Packets: In this mode, re-interpreted as the number of packets that the Session-Reflector MUST generate in each Burst.</li>
<li>Packet Padding Length: In the mode, re-interpreted as the number of octets the Session-Reflector MUST append to the Test packet header of each packet it generates as part of the burst.  The Session-Reflector MUST NOT assume that the Session-Sender will use any packet padding, and MUST be prepared to generate the padding itself.</li>
</ol>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Burst Measurement: Request-TW-Session Packet Format</h1>
<p id="rfc.section.3.3.p.1">The bits designated for the Burst Generation feature in the Request-TW-Session command are as shown in the packet format below.</p>
<div id="#rfc.figure.2"></div>
<p></p>

<p></p>
<pre> 0                   1                   2                   3 
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      5        |  MBZ  | IPVN  |  Conf-Sender  | Conf-Receiver |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Number of Schedule Slots                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Number of Packets*                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.           ... Many fields (62 octets) not shown ...           .
.                                                               .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Padding Length  (4 octets)                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Start Time, (8 octets)                   |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Timeout*, (8 octets)                    |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Type-P Descriptor                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Octets to be reflected    |  Length of padding to reflect |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       MBZ (2 octets)                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                       HMAC (16 octets)                        |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p>* = re-interpreted field</p>
<p id="rfc.section.3.3.p.3">Two re-interpreted fields appear in the Request-TW-Session command when using Burst Measurement mode:</p>
<p></p>

<ol>
<li>Number of Packets: In this mode, re-interpreted as the number of packets that the Session-Reflector MUST expect to measure as part of each Burst.</li>
<li>Timeout: In this mode, re-interpreted as the time to wait for all packets in a burst to arrive, expressed in the existing timestamp format used in TWAMP and OWAMP. In the case of lost packets, the Session-Reflector is commanded to wait through this time-out for packets in a burst to arrive.</li>
</ol>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Burst Gen and Meas: Accept Session Packet Format</h1>
<p id="rfc.section.3.4.p.1">The Accept Session command for the Burst feature is as shown in the packet format below (assuming the Reflect Octets feature is also in use).</p>
<div id="#rfc.figure.3"></div>
<p></p>

<p></p>
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Accept     |      MBZ      |            Port               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|
|                                                               |
|                        SID (16 octets)                        |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Reflected octets        |         Server octets         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       MBZ (8 octets)                          |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                       HMAC (16 octets)                        |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p></p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> Burst Gen and Meas: Stopping Test Sessions</h1>
<p id="rfc.section.3.5.p.1">The Control-Client SHALL stop in-progress test sessions using any standardized methods, including section 3.8 of <a href="#RFC5357">[RFC5357]</a> or the optional capability of <a href="#RFC5938">[RFC5938]</a>.</p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> Additional considerations</h1>
<p id="rfc.section.3.6.p.1">The value of the Modes Field sent by the Server in the Server Greeting message is the bit-wise OR of the mode values that it is willing to support during this session.</p>
<p id="rfc.section.3.6.p.2">We note that Burst Generation and Measurement features are incompatible with each other, and with the Symmetrical Size feature described in <a href="#RFC6038">[RFC6038]</a>, and MUST NOT be used in combination with those features.</p>
<p id="rfc.section.3.6.p.3">With the publication of this memo as an RFC, the last 9 bit positions of the Modes 32-bit Field are used. A Control-Client conforming to this extension of <a href="#RFC5357">[RFC5357]</a> MAY ignore the values in the higher bits of the Modes Field, or it MAY support other features that are communicated in those bit positions.  The other bits are available for future protocol extensions.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Burst Generation in TWAMP Test</h1>
<p id="rfc.section.4.p.1">The TWAMP test protocol is similar to the OWAMP <a href="#RFC4656">[RFC4656]</a> test protocol with the exception that the Session-Reflector transmits test packets to the Session-Sender in response to each test packet it receives. The Burst Generation feature modifies the behavior of TWAMP section 4<a href="#RFC5357">[RFC5357]</a>.  This mode requires the Session-Sender to send a Burst-Initiation packet, and the Session-Reflector generates test session packets according to the configuration agreed using the TWAMP-Control protocol.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Sender Behavior</h1>
<p id="rfc.section.4.1.p.1">This section describes extensions to the behavior of the TWAMP Session-Sender.</p>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> Packet Timings</h1>
<p id="rfc.section.4.1.1.p.1">The Send Schedule is not utilized in TWAMP, and this is unchanged in this memo.</p>
<h1 id="rfc.section.4.1.2">
<a href="#rfc.section.4.1.2">4.1.2.</a> Packet Formats and Contents</h1>
<p id="rfc.section.4.1.2.p.1">The Session-Sender packet format and content follow the same procedure and guidelines as defined in section 4.1.2 of <a href="#RFC4656">[RFC4656]</a> (as indicated in section 4.1.2 of TWAMP <a href="#RFC5357">[RFC5357]</a>).</p>
<p id="rfc.section.4.1.2.p.2">This mode uses the original TWAMP-Test Packet Padding Field (see section 4.1.2 of <a href="#RFC4656">[RFC4656]</a>), or can be used with Reflect Octets feature as shown below for unauthenticated mode:</p>
<div id="#rfc.figure.4"></div>
<p></p>

<p></p>
<pre> 0                   1                   2                   3 
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|                        Sequence Number                        | 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|                          Timestamp                            | 
|                                                               | 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|         Error Estimate        |                               |  
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               + 
|                                                               | 
|                  Packet Padding (to be reflected)             | 
.               (length in octets specified in command)         . 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.                  Additional Packet Padding                    .
.                                                               . 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </pre>
<p>Burst Initiation Packet Format</p>
<p id="rfc.section.4.1.2.p.4">The Sequence Number, Timestamp, and Error Estimate fields are the same as specified in section 4.1.2 of <a href="#RFC4656">[RFC4656]</a> in OWAMP.</p>
<p id="rfc.section.4.1.2.p.5">We note that the format of the Burst Initiation packet has not been changed from the usual Session-Sender test packet format, to simplify adoption.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Reflector Behavior</h1>
<p id="rfc.section.4.2.p.1">The TWAMP Reflector differs significantly from the procedures and guidelines in section 4.2 of <a href="#RFC5357">[RFC5357]</a>. The following new functions MUST be performed:</p>
<p></p>

<ul>
<li>Recognition of the function of the Burst Initiation Packet used in this mode.</li>
<li>Generation of the required burst of test session packets, according to the configuration agreed in Request-TW-Session command, with the agreed number of packets in each burst and size of each packet in the burst.</li>
</ul>
<p></p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> Session-Reflector Burst Packet Format and Contents</h1>
<p id="rfc.section.4.2.1.p.1">The Burst Generation feature retains the usual Reflector packet fields, as shown below. When the Burst Generation mode is selected, the Session-Reflector SHALL use the following TWAMP-Test Packet Format in Unauthenticated mode (shown with Reflect Octets feature activated):</p>
<div id="#rfc.figure.5"></div>
<p></p>

<p></p>
<pre> 0                   1                   2                   3 
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |                       Sequence Number                         | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |                          Timestamp                            | 
 |                                                               | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |         Error Estimate        |           MBZ                 | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |                       Receive Timestamp                       | 
 |                                                               | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |                     Sender Sequence Number                    | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |                       Sender Timestamp                        | 
 |                                                               | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |      Sender Error Estimate    |           MBZ                 | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |  Sender TTL   |         Packet Padding (from Session-Sender)  | 
 +-+-+-+-+-+-+-+-+                                               +
 .                                                               . 
 +                                               +-+-+-+-+-+-+-+-+ 
 |          Packet Padding (from Session-Sender) |               | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               + 
 |                                                               | 
 |                                                               |
 .                  Additional Packet Padding                    . 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  </pre>
<p></p>
<p id="rfc.section.4.2.1.p.3">Section 4.2.1 of <a href="#RFC5357">[RFC5357]</a> describes the above fields as used in TWAMP, with one exception.</p>
<p id="rfc.section.4.2.1.p.4">The Sequence Number field SHALL indicate the sequence number of each packet sent throughout the test session. The Sequence Number SHALL be increased by 1 for each packet. The initial Sequence Number SHALL be 0.</p>
<p id="rfc.section.4.2.1.p.5">When one burst is complete, the Sequence Numbers SHALL continue to increment by 1 in the packets generated in response to the next burst.</p>
<p id="rfc.section.4.2.1.p.6">The total Packet Padding octets SHALL have the length specified in the TWAMP-Control request for the appropriate test session. The Session-Reflector MAY need to generate its own packet padding, if the Burst Request packet does not include this field (or contains insufficient padding).</p>
<p id="rfc.section.4.2.1.p.7">In any case, the Session-Reflector MAY re-use the Sender&#8217;s Packet Padding (since the requirements for padding generation are the same for each) when possible.</p>
<p id="rfc.section.4.2.1.p.8">The Session-Reflector SHALL send a series of TWAMP-Test Packets in response to reception of the Burst Initiation Packet, according to the configuration agreed in the Request-TW-Session command (number of packets and padding), and as immediately as possible. The Session-Reflector SHALL send all packets in a burst as close to back-to-back as possible (recognizing that lower layers may have spacing requirements that take precedence).</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Burst Measurement in TWAMP Test</h1>
<p id="rfc.section.5.p.1">The Burst Measurement feature modifies the behavior of TWAMP section 4<a href="#RFC5357">[RFC5357]</a>. This mode requires the Session-Sender to send a Burst of test packets, and the Session-Reflector measures the burst of packets and reports the results in the Burst Response packet format(s), as described below.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Sender Behavior</h1>
<p id="rfc.section.5.1.p.1">This section describes extensions to the behavior of the TWAMP Session-Sender.</p>
<h1 id="rfc.section.5.1.1">
<a href="#rfc.section.5.1.1">5.1.1.</a> Packet Timings</h1>
<p id="rfc.section.5.1.1.p.1">The Session-Sender SHALL send all packets in a burst as close to back-to-back as possible (recognizing that lower layers may have spacing requirements that take precedence).</p>
<h1 id="rfc.section.5.1.2">
<a href="#rfc.section.5.1.2">5.1.2.</a> Packet Formats and Contents</h1>
<p id="rfc.section.5.1.2.p.1">The Session-Sender packet format and content SHALL comply with that defined in section 4.1.2 of <a href="#RFC4656">[RFC4656]</a> (as indicated in section 4.1.2 of TWAMP <a href="#RFC5357">[RFC5357]</a>).</p>
<p id="rfc.section.5.1.2.p.2">This mode uses the original TWAMP-Test Packet Padding Field (see section 4.1.2 of <a href="#RFC4656">[RFC4656]</a>), or can be used with Reflect Octets feature as shown below for unauthenticated mode:</p>
<div id="#rfc.figure.6"></div>
<p></p>

<p></p>
<pre> 0                   1                   2                   3 
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|                     Burst Sequence Number                     | 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|                          Timestamp                            | 
|                                                               | 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|         Error Estimate        |                               |  
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               + 
|                                                               | 
|                  Packet Padding (to be reflected)             | 
.               (length in octets specified in command)         . 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.                  Additional Packet Padding                    .
.                                                               . 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </pre>
<p>Session-Sender Burst Test Packet Format</p>
<p id="rfc.section.5.1.2.p.4">The Burst Sequence Number field SHALL indicate the number of each burst. The Burst Sequence Number SHALL be increased by 1 for each burst, and remain the same for each packet in a burst. The initial number SHALL be 0.</p>
<p id="rfc.section.5.1.2.p.5">When one burst is complete, the Burst Sequence Number used in the all packets of the next burst SHALL be increased by 1.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Reflector Behavior</h1>
<p id="rfc.section.5.2.p.1">The TWAMP Reflector differs slightly from the procedures and guidelines in section 4.2 of <a href="#RFC5357">[RFC5357]</a>. The following new functions MUST be performed:</p>
<p></p>

<ul>
<li>Recognition of the function of the Session-Sender Burst Test Packet Format used in this mode.</li>
<li>Processing the required bursts of test session packets, according to the configuration agreed in Request-TW-Session command, with the agreed length of the burst in packets and size of each packet in the burst, and the agreed Burst Time-out.</li>
<li>Response with an abbreviated Session-Reflector test packet as described below. For discussion, we will call this the 1-to-1 response.</li>
<li>OR - Response with the new Burst Measurement Response packet described below. For discussion, we will call this the accumulated response.</li>
</ul>

<p>We seek feedback from the IPPM working group on which of these two alternatives is preferable.</p>
<p></p>
<h1 id="rfc.section.5.2.1">
<a href="#rfc.section.5.2.1">5.2.1.</a> Session-Reflector Burst Measurement Response Packet Format and Contents</h1>
<p id="rfc.section.5.2.1.p.1">The Burst Measurement feature specifies a standard Session-Reflector packet to communicate the results, as shown below.  When the Burst measurement mode is selected, the Session-Sender SHALL use the following Burst Measurement Response packet Format in Unauthenticated mode (shown with Reflect Octets feature also in use):</p>
<div id="#rfc.figure.7"></div>
<p></p>

<p></p>
<pre> 0                   1                   2                   3 
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |                        Sequence Number                        | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |                          Timestamp                            | 
 |                                                               | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |         Error Estimate        |           MBZ                 | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-B 
 |                       Receive Timestamp                       | 
 |                                                               | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |                  Sender Burst Sequence Number                 | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |                        Sender Timestamp                       B 
 |                                                               | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |      Sender Error Estimate    |           MBZ                 | 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
 |  Sender TTL   |         Packet Padding (from Session-Sender)  | 
 +-+-+-+-+-+-+-+-+                                               +
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-B</pre>
<p>Session-Reflector Measurement Packet (1-to-1 response)</p>
<p id="rfc.section.5.2.1.p.3">Section 4.2.1 of <a href="#RFC5357">[RFC5357]</a> describes the fields in the 1-to-1 response packet above; they are the same as used in TWAMP. The main difference is that Packet Padding SHALL be truncated on a 16 octet-word boundary, returning the minimum information to the Session-Sender.</p>
<p id="rfc.section.5.2.1.p.4">All Timestamps SHALL be formatted according to the precedent set in section 4.1.2 of <a href="#RFC4656">[RFC4656]</a>, which is to use <a href="#RFC1305">[RFC1305]</a> (and updated version), as follows:</p>
<p id="rfc.section.5.2.1.p.5">"The first 32 bits represent the unsigned integer number of seconds elapsed since 0h on 1 January 1900; the next 32 bits represent the fractional part of a second that has elapsed since then."</p>
<p id="rfc.section.5.2.1.p.6">The Session-Reflector MUST truncate the Sender's Packet Padding, unless the Reflect Octets feature is also active in which case the Session_Reflector MAY re-use the Sender&#8217;s Packet Padding (since the requirements for padding generation are the same for each) to reach a word boundary.</p>
<p id="rfc.section.5.2.1.p.7">The Sender Timestamp field SHALL have the sender's timestamp from each packet received in the burst.</p>
<p id="rfc.section.5.2.1.p.8">In 1-to-1 response mode, the Session-Reflector SHALL send a Session-Reflector Measurement Packet in response to every Session-Sender packet received, and as immediately as possible.</p>
<p id="rfc.section.5.2.1.p.9">========================================================</p>
<p id="rfc.section.5.2.1.p.10">In the accumulated response alternative, the Session-Reflector creates and holds all packet headers described above in a buffer, and sends them all at once in a single Session-Reflector test packet. The length of the burst and the path MTU MUST be coordinated to avoid fragmentation.</p>
<p id="rfc.section.5.2.1.p.11">The first Session-Sender packet to arrive with a previously unseen Burst Sequence Number SHALL be designated as the "First" packet in that burst, and its timestamp is used in processing below.</p>
<p id="rfc.section.5.2.1.p.12">As subsequent packets arrive, Session-Reflector SHALL:</p>
<p></p>

<ul>
<li>Maintain a count of packets with the same Burst Sequence Number (one burst).</li>
<li>Time stamp each packet as it arrives and store the time stamp in a response packet structure with all fields complete, as in the 1-to-1 alternative.</li>
</ul>

<p>When</p>
<p></p>

<ul>
<li>The count of packets with the same Burst Sequence Number equals the agreed Burst Length, OR</li>
<li>The agreed Timeout expires (computed by a the time to the "First" Packet Timestamp), OR</li>
<li>The Burst Sequence Number increases from previous packets (indicating a new Burst is in progress),</li>
</ul>

<p>then the current burst is determined to be complete.</p>
<p id="rfc.section.5.2.1.p.15">When the Burst is complete, the Session-Reflector SHALL terminate the current burst processing as described above and send the Burst Measurement Response Packet to the Session-Sender as immediately as possible.</p>
<p id="rfc.section.5.2.1.p.16">In Accumulated Response, the Burst Measurement Response Packet is a single packet with the concatenation of all previously-generated response packet formats in the information field.</p>
<p></p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Special Case of One-packet Bursts</h1>
<p id="rfc.section.6.p.1">When the Number of Packets field in the Request-TW-Session command equals 1, then the Burst Generation and Measurement modes are reduced to test sessions with controlled, asymmetrical packet sizes. A minimal size packet travels in one direction, and the measured direction uses a packet with all Packet Padding specified in the Request-TW-Session command.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">These extended modes of operation do not appear to permit any new attacks on hosts communicating with core TWAMP <a href="#RFC5357">[RFC5357]</a>.</p>
<p id="rfc.section.7.p.2">The security considerations that apply to any active measurement of live networks are relevant here as well. See <a href="#RFC4656">[RFC4656]</a> and <a href="#RFC5357">[RFC5357]</a>.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.8.p.1">This memo adds two modes to the IANA registry for the TWAMP Modes Field, and describes behavior when the new modes are used. This field is a recognized extension mechanism for TWAMP.</p>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> Registry Specification</h1>
<p id="rfc.section.8.1.p.1">IANA has created a TWAMP-Modes registry (as requested in <a href="#RFC5618">[RFC5618]</a>). TWAMP-Modes are specified in TWAMP Server Greeting messages and Set-up Response messages, as described in section 3.1 of <a href="#RFC5357">[RFC5357]</a>, consistent with section 3.1 of <a href="#RFC4656">[RFC4656]</a>, and extended by this memo.  Modes are indicated by setting bits in the 32-bit Modes field that correspond to values in the Modes registry. For the TWAMP-Modes registry, we expect that new features will be assigned increasing registry values that correspond to single bit positions, unless there is a good reason to do otherwise (more complex encoding than single bit positions may be used in the future, to access the 2^32 value space).</p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> Registry Contents</h1>
<div id="#rfc.figure.8"></div>
<p id="rfc.section.8.2.p.1">TWAMP Modes Registry is recommended to be augmented as follows:</p>

<p></p>
<pre>Value  Description             Semantics Definition
--------------------------------------------------------
xxx    Burst Generation        this memo, section 3.1
       Capability              new bit position (X)
yyy    Burst Measurement       this memo, section 3.1
                               new bit position (Y)

</pre>
<p></p>
<p id="rfc.section.8.2.p.2">&gt;&gt;&gt;IANA: change xxx, yyy, X, Y, and RFC???? to the assigned values</p>
<p id="rfc.section.8.2.p.3">The suggested values are</p>
<p id="rfc.section.8.2.p.4">X=7, xxx=128</p>
<p id="rfc.section.8.2.p.5">Y=8, yyy=256 &lt;&lt;&lt;&lt;</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.9.p.1">The authors thank folks for review and comment.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4656">[RFC4656]</b></td>
<td class="top">
<a>Shalunov, S.</a>, <a>Teitelbaum, B.</a>, <a>Karp, A.</a>, <a>Boote, J.</a> and <a>M. Zekauskas</a>, "<a href="http://tools.ietf.org/html/rfc4656">A One-way Active Measurement Protocol (OWAMP)</a>", RFC 4656, September 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5357">[RFC5357]</b></td>
<td class="top">
<a>Hedayat, K.</a>, <a>Krzanowski, R.</a>, <a>Morton, A.</a>, <a>Yum, K.</a> and <a>J. Babiarz</a>, "<a href="http://tools.ietf.org/html/rfc5357">A Two-Way Active Measurement Protocol (TWAMP)</a>", RFC 5357, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1305">[RFC1305]</b></td>
<td class="top">
<a href="mailto:mills@udel.edu" title="University of Delaware, Electrical Engineering Department">Mills, D.</a>, "<a href="http://tools.ietf.org/html/rfc1305">Network Time Protocol (Version 3) Specification, Implementation</a>", RFC 1305, March 1992.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5618">[RFC5618]</b></td>
<td class="top">
<a>Morton, A.</a> and <a>K. Hedayat</a>, "<a href="http://tools.ietf.org/html/rfc5618">Mixed Security Mode for the Two-Way Active Measurement Protocol (TWAMP)</a>", RFC 5618, August 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5938">[RFC5938]</b></td>
<td class="top">
<a>Morton, A.</a> and <a>M. Chiba</a>, "<a href="http://tools.ietf.org/html/rfc5938">Individual Session Control Feature for the Two-Way Active Measurement Protocol (TWAMP)</a>", RFC 5938, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6038">[RFC6038]</b></td>
<td class="top">
<a>Morton, A.</a> and <a>L. Ciavattone</a>, "<a href="http://tools.ietf.org/html/rfc6038">Two-Way Active Measurement Protocol (TWAMP) Reflect Octets and Symmetrical Size Features</a>", RFC 6038, October 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody></tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Al Morton</span> 
	  <span class="n hidden">
		<span class="family-name">Morton</span>
	  </span>
	</span>
	<span class="org vcardline">AT&T Labs</span>
	<span class="adr">
	  <span>200 Laurel Avenue South</span>

	  <span class="vcardline">
		<span class="locality">Middletown,</span>,  
		<span class="region">NJ</span> 
		<span class="code">07748</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1 732 420 1571</span>

<span class="vcardline">EMail: <a href="mailto:acmorton@att.com">acmorton@att.com</a></span>

<span class="vcardline">URI: <a href="http://home.comcast.net/~acmacm/">http://home.comcast.net/~acmacm/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Len Ciavattone</span> 
	  <span class="n hidden">
		<span class="family-name">Ciavattone</span>
	  </span>
	</span>
	<span class="org vcardline">AT&T Labs</span>
	<span class="adr">
	  <span>200 Laurel Avenue South</span>

	  <span class="vcardline">
		<span class="locality">Middletown,</span>,  
		<span class="region">NJ</span> 
		<span class="code">07748</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1 732 420 1239</span>

<span class="vcardline">EMail: <a href="mailto:lencia@att.com">lencia@att.com</a></span>

  </address>
</div>

</body>
</html>