<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Adapted Multimedia Internet KEYing (AMIKEY): An extension of Multimedia Internet KEYing (MIKEY) Methods for Generic LLN Environments</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Motivation">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 MIKEY Key Management Methods Background">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Adapting MIKEY to General LLNs">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Terminology and Definitions">
<link href="#rfc.section.1.5" rel="Chapter" title="1.5 Document Outline">
<link href="#rfc.section.1.6" rel="Chapter" title="1.6 Section Headings Notation">
<link href="#rfc.section.2" rel="Chapter" title="2 AMIKEY Overview">
<link href="#rfc.section.3" rel="Chapter" title="3 AMIKEY Extension Elements">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 [RFC3830] Pre-shared key">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 [RFC3830] Public-Key Encryption">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 [RFC3830] Diffie-Hellman Key Exchange">
<link href="#rfc.section.4" rel="Chapter" title="4 [RFC3830] Selected Key Management Functions">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 [RFC3830] Key Calculation">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 [RFC3830] Assumptions">
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 [RFC3830] Default PRF Description">
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 [RFC3830] Generating Keys from TGK">
<link href="#rfc.section.4.1.4" rel="Chapter" title="4.1.4 [RFC3830] Generating Keys for MIKEY Messages from an Envelope/Pre-shared Key">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 [RFC3830] Pre-defined Transforms and Timestamp Formats">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 [RFC3830] Hash Functions">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 [RFC3830] Pseudo-Random Number Generator">
<link href="#rfc.section.4.2.3" rel="Chapter" title="4.2.3 [RFC3830] Key Data Transport Encryption">
<link href="#rfc.section.4.2.4" rel="Chapter" title="4.2.4 [RFC3830] MAC Verification Message Function">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 [RFC3830] Certificates, Policies and Authorization">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 [RFC3830] Retrieving the Data SA">
<link href="#rfc.section.5" rel="Chapter" title="5 [RFC3830] Behavior and Message Handling">
<link href="#rfc.section.6" rel="Chapter" title="6 [RFC3830] Payload Encoding">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 [RFC3830] Common Header Payload (HDR)">
<link href="#rfc.section.6.1.1" rel="Chapter" title="6.1.1 [RFC3830] SRTP ID">
<link href="#rfc.section.6.1.2" rel="Chapter" title="6.1.2 The Generic_LLN-ID Map Type">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 [RFC3830] Key Data Transport Payload (KEMAC)">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 [RFC3830] Envelope Data Payload (PKE)">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 [RFC3830] DH Data Payload (DH)">
<link href="#rfc.section.6.5" rel="Chapter" title="6.5 [RFC3830] Signature Payload (SIGN)">
<link href="#rfc.section.6.6" rel="Chapter" title="6.6 [RFC3830] Timestamp Payload (T)">
<link href="#rfc.section.6.7" rel="Chapter" title="6.7 [RFC3830] ID Payload (ID)">
<link href="#rfc.section.6.8" rel="Chapter" title="6.8 [RFC3830] Cert Hash Payload (CHASH)">
<link href="#rfc.section.6.9" rel="Chapter" title="6.9 [RFC3830] Ver msg payload (V)">
<link href="#rfc.section.6.10" rel="Chapter" title="6.10 [RFC3830] Security Policy (SP) Payload">
<link href="#rfc.section.6.10.1" rel="Chapter" title="6.10.1 [RFC3830] SRTP Policy">
<link href="#rfc.section.6.10.2" rel="Chapter" title="6.10.2 AMIKEY Generic_LLN Policy">
<link href="#rfc.section.6.11" rel="Chapter" title="6.11 [RFC3830] RAND Payload (RAND)">
<link href="#rfc.section.6.12" rel="Chapter" title="6.12 [RFC3830] Error Payload (ERR)">
<link href="#rfc.section.6.13" rel="Chapter" title="6.13 [RFC3830] Key Data Sub-Payload">
<link href="#rfc.section.6.14" rel="Chapter" title="6.14 [RFC3830] Key Validity Data">
<link href="#rfc.section.6.15" rel="Chapter" title="6.15 [RFC3830] General Extension Payload">
<link href="#rfc.section.6.16" rel="Chapter" title="6.16 Key Index Payload">
<link href="#rfc.section.6.17" rel="Chapter" title="6.17 Key Activation Time Payload">
<link href="#rfc.section.7" rel="Chapter" title="7 [RFC3830] Transport Protocols">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 [RFC3830] Groups">
<link href="#rfc.section.10" rel="Chapter" title="10 Additional Specification Considerations">
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations">
<link href="#rfc.section.12" rel="Chapter" title="12 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="13 References">
<link href="#rfc.references.1" rel="Chapter" title="13.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="13.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Multimedia Internet Keying (MIKEY) is a key management protocol used for real-time applications. As standardized within RFC3830 it defines four key distribution methods, including pre-shared keys, public-key encryption, and Diffie-Hellman key exchange, with allowances for ready protocol extension. A number of additional methods have been developed and continue to be built from the base protocol (see for example, RFC4442, RFC4563, RFC4650, RFC4738, RFC5410, RFC6043 and RFC6267.  However, in spite of its extensibility and more general applicability, MIKEY and its related extensions have primarily focused on the support of the Secure Real-time Transport Protocol (SRTP)." />
  <meta name="description" content="Multimedia Internet Keying (MIKEY) is a key management protocol used for real-time applications. As standardized within RFC3830 it defines four key distribution methods, including pre-shared keys, public-key encryption, and Diffie-Hellman key exchange, with allowances for ready protocol extension. A number of additional methods have been developed and continue to be built from the base protocol (see for example, RFC4442, RFC4563, RFC4650, RFC4738, RFC5410, RFC6043 and RFC6267.  However, in spite of its extensibility and more general applicability, MIKEY and its related extensions have primarily focused on the support of the Secure Real-time Transport Protocol (SRTP)." />
  <meta name="keywords" content="LLN, ROLL, security, key management" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Networking Working Group</td>
<td class="right">R.K. Alexander</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">T. Tsao</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Cooper Power Systems</td>
</tr>
<tr>
<td class="left">Expires: January 09, 2012</td>
<td class="right">July 08, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Adapted Multimedia Internet KEYing (AMIKEY): An extension of Multimedia Internet KEYing (MIKEY) Methods for Generic LLN Environments<br />
  <span class="filename">draft-alexander-roll-mikey-lln-key-mgmt-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Multimedia Internet Keying (MIKEY) is a key management protocol used for real-time applications. As standardized within RFC3830 it defines four key distribution methods, including pre-shared keys, public-key encryption, and Diffie-Hellman key exchange, with allowances for ready protocol extension. A number of additional methods have been developed and continue to be built from the base protocol (see for example, RFC4442, RFC4563, RFC4650, RFC4738, RFC5410, RFC6043 and RFC6267.  However, in spite of its extensibility and more general applicability, MIKEY and its related extensions have primarily focused on the support of the Secure Real-time Transport Protocol (SRTP).</p>
<p>This document specifies a simple adaptation of the MIKEY specification to allow the base protocol and its various key management mode extensions to be readily applied in more general environments beyond the multimedia SRTP domain. In particular, the document defines a repurposing of the MIKEY multimedia crypto sessions structure and introduces a set of message extensions to the base specification to allow the MIKEY key management methods to be applied within Low-power and Lossy networks (LLNs) and other general constrained-device networks.</p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 09, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Motivation</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">MIKEY Key Management Methods Background</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Adapting MIKEY to General LLNs</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Terminology and Definitions</a>
</li>
<li>1.5.   <a href="#rfc.section.1.5">Document Outline</a>
</li>
<li>1.6.   <a href="#rfc.section.1.6">Section Headings Notation</a>
</li>
<li>2.   <a href="#rfc.section.2">AMIKEY Overview</a>
</li>
<li>3.   <a href="#rfc.section.3">AMIKEY Extension Elements</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">[RFC3830] Pre-shared key</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">[RFC3830] Public-Key Encryption</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">[RFC3830] Diffie-Hellman Key Exchange</a>
</li>
<li>4.   <a href="#rfc.section.4">[RFC3830] Selected Key Management Functions</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">[RFC3830] Key Calculation</a>
</li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">[RFC3830] Assumptions</a>
</li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">[RFC3830] Default PRF Description</a>
</li>
<li>4.1.3.   <a href="#rfc.section.4.1.3">[RFC3830] Generating Keys from TGK</a>
</li>
<li>4.1.4.   <a href="#rfc.section.4.1.4">[RFC3830] Generating Keys for MIKEY Messages from an Envelope/Pre-shared Key</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">[RFC3830] Pre-defined Transforms and Timestamp Formats</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">[RFC3830] Hash Functions</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">[RFC3830] Pseudo-Random Number Generator</a>
</li>
<li>4.2.3.   <a href="#rfc.section.4.2.3">[RFC3830] Key Data Transport Encryption</a>
</li>
<li>4.2.4.   <a href="#rfc.section.4.2.4">[RFC3830] MAC Verification Message Function</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">[RFC3830] Certificates, Policies and Authorization</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">[RFC3830] Retrieving the Data SA</a>
</li>
<li>5.   <a href="#rfc.section.5">[RFC3830] Behavior and Message Handling</a>
</li>
<li>6.   <a href="#rfc.section.6">[RFC3830] Payload Encoding</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">[RFC3830] Common Header Payload (HDR)</a>
</li>
<li>6.1.1.   <a href="#rfc.section.6.1.1">[RFC3830] SRTP ID</a>
</li>
<li>6.1.2.   <a href="#rfc.section.6.1.2">The Generic_LLN-ID Map Type</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">[RFC3830] Key Data Transport Payload (KEMAC)</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">[RFC3830] Envelope Data Payload (PKE)</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">[RFC3830] DH Data Payload (DH)</a>
</li>
<li>6.5.   <a href="#rfc.section.6.5">[RFC3830] Signature Payload (SIGN)</a>
</li>
<li>6.6.   <a href="#rfc.section.6.6">[RFC3830] Timestamp Payload (T)</a>
</li>
<li>6.7.   <a href="#rfc.section.6.7">[RFC3830] ID Payload (ID)</a>
</li>
<li>6.8.   <a href="#rfc.section.6.8">[RFC3830] Cert Hash Payload (CHASH)</a>
</li>
<li>6.9.   <a href="#rfc.section.6.9">[RFC3830] Ver msg payload (V)</a>
</li>
<li>6.10.   <a href="#rfc.section.6.10">[RFC3830] Security Policy (SP) Payload</a>
</li>
<li>6.10.1.   <a href="#rfc.section.6.10.1">[RFC3830] SRTP Policy</a>
</li>
<li>6.10.2.   <a href="#rfc.section.6.10.2">AMIKEY Generic_LLN Policy</a>
</li>
<li>6.11.   <a href="#rfc.section.6.11">[RFC3830] RAND Payload (RAND)</a>
</li>
<li>6.12.   <a href="#rfc.section.6.12">[RFC3830] Error Payload (ERR)</a>
</li>
<li>6.13.   <a href="#rfc.section.6.13">[RFC3830] Key Data Sub-Payload</a>
</li>
<li>6.14.   <a href="#rfc.section.6.14">[RFC3830] Key Validity Data</a>
</li>
<li>6.15.   <a href="#rfc.section.6.15">[RFC3830] General Extension Payload</a>
</li>
<li>6.16.   <a href="#rfc.section.6.16">Key Index Payload</a>
</li>
<li>6.17.   <a href="#rfc.section.6.17">Key Activation Time Payload</a>
</li>
<li>7.   <a href="#rfc.section.7">[RFC3830] Transport Protocols</a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">[RFC3830] Groups</a>
</li>
<li>10.   <a href="#rfc.section.10">Additional Specification Considerations</a>
</li>
<li>11.   <a href="#rfc.section.11">IANA Considerations</a>
</li>
<li>12.   <a href="#rfc.section.12">Acknowledgments</a>
</li>
<li>13.   <a href="#rfc.references">References</a>
</li>
<li>13.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>13.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Any sufficiently large scale network offering security services requires an automated key management mechanism for the exchange of keys and the update of related security credentials <a href="#RFC4107">[RFC4107]</a>. Key management may be needed for individual session exchanges or for the long-term control and update of security parameters from which session keys may be derived. In many Low-power and Lossy networks (LLN) and other constrained-device environments, key management emphasis is often on the management of long-term keys. This may automatically follow network associations based on device pre-configuration or may be based on specified key lifetimes or administrative or event-driven need for key credential changes. This would apply to the case of a network routing protocol like RPL (<a href="#I-D.ietf-roll-rpl">[I-D.ietf-roll-rpl]</a>) that employs security as well as to other secured communications layer protocols.</p>
<p id="rfc.section.1.p.2">Multimedia Internet Keying (MIKEY) is a key management protocol that has been used for real-time applications both for peer-to-peer and group communications. The capabilities of the protocol lend themselves just as readily to the management of long-term keys as to per-session or per association key control. MIKEY <a href="#RFC3830">[RFC3830]</a> defines four key distribution methods including pre-shared keys, public-key encryption, and Diffie-Hellman key exchange. Given its design simplicity, efficiency and flexibility a number of additional modes and extensions have indeed been developed and continue to be built from the base protocol (see for example, <a href="#RFC4442">[RFC4442]</a>, <a href="#RFC4563">[RFC4563]</a>, <a href="#RFC4650">[RFC4650]</a>, <a href="#RFC4738">[RFC4738]</a>, <a href="#RFC5410">[RFC5410]</a>, <a href="#RFC6043">[RFC6043]</a> and <a href="#RFC6267">[RFC6267]</a>). MIKEY and its related RFC extensions have however primarily focused on the support of the SRTP and related Session Initiation Protocol (SIP) call scenarios <a href="#RFC3711">[RFC3711]</a>.</p>
<p id="rfc.section.1.p.3">This document specifies an adaptation of the MIKEY protocol specification to allow the base protocol and its various key management mode extensions to be more generally applied to LLN environments. In particular, the document defines a repurposing of the MIKEY multimedia crypto sessions structure to allow optional support for simultaneous management of multiple protocol or device interface key. The specification also introduces a set of message extensions to the base MIKEY protocol to allow its key management methods to be applied within generic LLN and constrained-device networks.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#motivation" id="motivation">Motivation</a>
</h1>
<p id="rfc.section.1.1.p.1">Key distribution describes the process of delivering cryptographic keys to the required communicating parties. The MIKEY protocol has defined the mechanisms for establishing the security context used by SRTP however the mechanisms for security parameter negotiation and update is just as readily extended to LLN protocols.</p>
<p id="rfc.section.1.1.p.2">The flexibly to employ different key distribution methods according to available network infrastructure and particular operating scenarios together with the compact efficiency of its binary specification makes MIKEY well suited for general LLN use. The wide range of key management support extending from light-weight, low latency half round-trip pre-shared key distribution methods to multi-exchange Diffie-Hellman key agreements protected with digital signatures or pre-shared keys offers great flexibility to meet the needs of diverse LLN application environments.</p>
<p id="rfc.section.1.1.p.3">The option to embed the MIKEY key management messages within an existing network signaling protocol or to be directly transported or UDP or TCP (using port 2269) also increases the ability to apply the methods in more general LLN domains.</p>
<p id="rfc.section.1.1.p.4">MIKEY has met its original stated design goals <a href="#RFC3830">[RFC3830]</a> of end-to-end security, simplicity, efficiency, tunneling (even beyond integration with Session Description Protocol (SDP) <a href="#RFC4566">[RFC4566]</a> or RTCP <a href="#RFC3605">[RFC3605]</a>), and independence of underlying transport. In so doing it offers an excellent base for a generic key management protocol for Low-power Lossy Network (LLN) application. Key management protocols are also difficult to design and validate (see <a href="#RFC4107">[RFC4107]</a> guidelines) providing a further motivation for reliance on an established protocol like MIKEY that has had the benefit of wider operational deployment and evaluation.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> MIKEY Key Management Methods Background</h1>
<p id="rfc.section.1.2.p.1">As noted in <a href="#RFC5197">[RFC5197]</a>, several key distribution methods have been described for MIKEY, including: </p>

<ul>
<li>Symmetric key distribution as defined in <a href="#RFC3830">[RFC3830]</a> (MIKEY-PSK)</li>
<li>Asymmetric key distribution as defined in <a href="#RFC3830">[RFC3830]</a> (MIKEY-RSA)</li>
<li>Diffie-Hellman key agreement protected by digital signatures as defined in <a href="#RFC3830">[RFC3830]</a> (MIKEY-DHSIGN)</li>
<li>Diffie-Hellman key agreement protected by symmetric pre-shared keys as defined in <a href="#RFC4650">[RFC4650]</a> (MIKEY-DHHMAC)</li>
<li>Asymmetric key distribution (based on asymmetric encryption) with in-band certificate provision as defined in <a href="#RFC4738">[RFC4738]</a> (MIKEY-RSA-R)</li>
</ul>
<p id="rfc.section.1.2.p.2">Further extensions to MIKEY comprising algorithm enhancements and new payload definitions have since been defined generally motivated by the specific problems associated with SIP signaling and associated multimedia use case scenarios (see <a href="#RFC5197">[RFC5197]</a>for an earlier assessment). This specification proposes a new extension that is focused on a new domain of application.</p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> Adapting MIKEY to General LLNs</h1>
<p id="rfc.section.1.3.p.1">This document specifies is a set of additional message information elements to the base MIKEY protocol that provide both algorithm and message payload extensions. These additions allow the adapted protocol to be used directly for key transport and security policy specification between communications generic network entities.  Furthermore, through integration within the base MIKEY specification it will allow current and future key methods and extensions to be utilized outside of the current multimedia environment.</p>
<p id="rfc.section.1.3.p.2">The developed protocol adaption includes the specification of alternative default algorithms (in particular AES-based) and configurations that are particular to more constrained communications devices and using MIKEY's general extensibility to define new elements applicable to the LLN environment.</p>
<p id="rfc.section.1.3.p.3">An important element of the protocol extension is the re-use of the MIKEY crypto-session structure to apply to individual device communications protocol layers or interfaces instead of applying to multimedia streams. By maintaining this base protocol structure and re-purposing associated message identifiers, the specification minimizes the protocol changes needed for network adaptation.</p>
<p id="rfc.section.1.3.p.4">As with the original specification the intent is to allow MIKEY messages to be embedded into existing communications signaling protocols or to be independently transported between communicating entities over UDP or TCP transport connections.</p>
<p id="rfc.section.1.3.p.5">Note: While MIKEY and its extensions provide a variety of choices in terms of modes of operation, implementations for a given LLN application domain will be able to simplify node behavior by operating in a single mode. To ensure necessary interoperability within the LLN environment, mandatory methods within the Adapted MIKEY protocol (AMIKEY), akin to those of MIKEY, shall be specified.</p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> Terminology and Definitions</h1>
<p id="rfc.section.1.4.p.1">The following definitions have been taken from <a href="#RFC3830">[RFC3830]</a> with necessary augmentation for AMIKEY as indicated:</p>
<p></p>

<dl>
<dt>(Data) Security Protocol</dt>
<dd style="margin-left: 6">
<br> The security protocol used to protect the actual data traffic. Examples of security protocols are IPsec and SRTP. For generic LLNs, security protocols may include secure versions of protocols such as RPL <a href="#I-D.ietf-roll-rpl">[I-D.ietf-roll-rpl]</a>.</dd>
<dt>Data SA</dt>
<dd style="margin-left: 6">
<br> Data Security Association information for the security protocol, including a TEK and a set of parameters/policies.</dd>
<dt>CS</dt>
<dd style="margin-left: 6">Crypto Session, uni- or bidirectional data stream(s) protected by a single instance of a security protocol.  For AMIKEY the concept of a crypto-session is expanded to allow definition of a particular protocol layer, logical device interface, or other communications association for which key management support is provided.</dd>
<dt>CSB</dt>
<dd style="margin-left: 6">Crypto Session Bundle, collection of one or more Crypto Sessions, which can have common TGKs (see below) and security parameters.</dd>
<dt>CS ID</dt>
<dd style="margin-left: 6">Crypto Session ID, unique identifier for the CS within a CSB. For AMIKEY the CS ID is used to identify a specific protocol layer, logical device interface or other communications association for which AMIKEY is being used to support key management (establishment of re-keying update).</dd>
<dt>CSB ID</dt>
<dd style="margin-left: 6">
<br> Crypto Session Bundle ID, unique identifier for the CSB. For AMIKEY the CSB ID in conjunction with the Timestamp filed is used as a unique key management exchange message reference identifier. This identifier will allow for the acknowledged key management message exchanges where applicable.  The ID plus timestamp will also support the filtering of repeated or redundant AMIKEY messages when key management occurs over an unreliable transport network.</dd>
<dt>TGK</dt>
<dd style="margin-left: 6">TEK Generation Key, a bit-string agreed upon by two or more parties, associated with CSB. From the TGK, Traffic-Encrypting Keys can then be generated without needing further communication.</dd>
<dt>TEK</dt>
<dd style="margin-left: 6">Traffic-Encrypting Key, the key used by the security protocol to protect the CS (this key may be used directly by the security protocol or may be used to derive further keys depending on the security protocol). The TEKs are derived from the CSB's TGK.</dd>
</dl>
<p id="rfc.section.1.4.p.3">The following definitions have been added to the ones from <a href="#RFC3830">[RFC3830]</a> specifically related to supporting AMIKEY:</p>
<p></p>

<dl>
<dt>Key Index</dt>
<dd style="margin-left: 6">
<br>The Key Index (KI) is used as identifier to allow for reference to the key(s) that are associated with a given CS. Where TEKs may be updated over time a TGK can be associated with a KI that is transported as a payload within the AMIKEY message from the Initiator. Any TEK generated from the AMIKEY TGK shall be assigned the key index value associated with the TGK. Within general LLN protocol communications related to a given CS (device layer protocol or interface), to ensure security association synchronization reference can be made to the key index that is being applied for the given protocol security. Following successfully TGK key establishment communicating devices can verify security contexts through reference to maintained KI.</dd>
</dl>
<h1 id="rfc.section.1.5">
<a href="#rfc.section.1.5">1.5.</a> Document Outline</h1>
<p><a href="#overview">Section 2</a> provides a brief general system overview of key management as introduced in MIKEY specification. This section generalizes the context in which the Adapted MIKEY (AMIKEY) protocol extension is applied. It also provides a reference to the common key management operating base of MIKEY and AMIKEY.</p>
<p id="rfc.section.1.5.p.2">Sections <a href="#extension-elem">3</a> to <a href="#mgmt-func">4</a> go into further detail by identifying the specific section and subsection extensions and enhancements needed to support the MIKEY protocol adaptation.  These Sections mirror those of MIKEY <a href="#RFC3830">[RFC3830]</a> and are used to show the necessary commonality and make reference to specific changes would be required for AMIKEY. Reference is made only to the applicable Sections and Subsections of <a href="#RFC3830">[RFC3830]</a> for which special changes are proposed.</p>
<p><a href="#payload">Section 6</a> includes the specific protocol specification elements that are needed to extend MIKEY for the support of the generic LLN key management requirements.</p>
<p id="rfc.section.1.5.p.4">The remaining document sections are place-holders for standard RFC draft sections.</p>
<h1 id="rfc.section.1.6">
<a href="#rfc.section.1.6">1.6.</a> Section Headings Notation</h1>
<p id="rfc.section.1.6.p.1">This document is written as a delta document to <a href="#RFC3830">[RFC3830]</a>. For ease of cross-reference and to maintain consistency with the MIKEY specification document structure, Section heading and Table and Figure numbers are maintained consistent with the <a href="#RFC3830">[RFC3830]</a> usage.</p>
<p id="rfc.section.1.6.p.2">The notation of Section number followed by <a href="#RFC3830">[RFC3830]</a> "x.x. <a href="#RFC3830">[RFC3830]</a>" is used is this document for Sections specifically meant to align with <a href="#RFC3830">[RFC3830]</a>. Section numbers followed by <a href="#RFC3830">[RFC3830]</a> with additional heading text indicates some new element or clarification introduced by this specification. Section numbers followed by <a href="#RFC3830">[RFC3830]</a> without further heading text implies no change to <a href="#RFC3830">[RFC3830]</a> and is used only to align and maintain the current document headings structure.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#overview" id="overview">AMIKEY Overview</a>
</h1>
<p id="rfc.section.2.p.1">This section provides an overview of AMIKEY. Material from MIKEY <a href="#RFC3830">[RFC3830]</a> is also repeated to clearly establish the common context in which MIKEY can be applied to LLN environments with the simple extension to the Adapted MIKEY (AMIKEY) specification.</p>
<p id="rfc.section.2.p.2">The objective of the AMIKEY extension is exactly the same as that of MIKEY - "to produce a data security association (SA) for a security protocol, including a Traffic-Encrypting Key (TEK), which is derived from a TEK Generation Key (TGK), and used as input for the security protocol." In the case of AMIKEY the objective is support generic security protocols and particularly those that may be associated with LLNs.</p>
<p id="rfc.section.2.p.3">AMIKEY uses the specified MIKEY mechanisms and features to "support the possibility of establishing keys and parameters for more than one security protocol (or for several instances of the same security protocol) at the same time." In MIKEY the Crypto Session Bundle (CSB), which derives from the multimedia (multi-stream) context, is used to denote this collection of one or more Crypto Sessions that can have a common TGK and security parameters, but that obtain distinct TEKs from MIKEY.</p>
<p id="rfc.section.2.p.4">In the AMIKEY extension, the concept of CSB is used to provide the option of simultaneously establishing multiple SAs on a given device.  The individual Crypto Session (CS) SAs may be associated with different device layer or device interface security protocols. AMIKEY further uses the flexibility of the MIKEY specification to allow separate security policies to be defined in the SA established for each security protocol.  The distribution mechanisms defined by MIKEY for re-keying and updating of established security associations is hence also directly applied. The ability to establish and maintain multiple SAs through a single key management association provides an important efficiency element in LLN domains.</p>
<p id="rfc.section.2.p.5">As specified in <a href="#RFC3830">[RFC3830]</a>, Section 2.3, the procedure of setting up a CSB and creating a TEK (and Data SA), is done in accordance with <a href="#fig1">Figure 1</a>: </p>

<ol>
<li>A set of security parameters and TGK(s) are agreed upon for the Crypto Session Bundle. This is done by one of many alternative key transport/exchange mechanisms (see <a href="#RFC3830">[RFC3830]</a>, Section 3, as well as subsequent extension RFCs).</li>
<li>The TGK(s) is used to derive (in a cryptographically secure way) a TEK for each Crypto Session or associated security protocol.</li>
<li>The TEK, together with the security protocol parameters, represent the Data SA, which is used as the input to the security protocol(s).</li>
</ol>
<div id="#rfc.figure.1"></div>
<div id="#fig1"></div>
<p></p>
<pre>

        +-----------------+
        |       CSB       |
        |  Key transport  | (see [RFC3830], Section 3)
        |    /exchange    | 
        +-----------------+
                 |      :
                 | TGK  :
                 v      :
           +----------+ : 
   CS ID -&gt;|   TEK    | : Security protocol parameters (policies)
           |derivation| : (see [RFC3830], Section 4)
           +----------+ : 
              TEK |     :
                  v     v
                  Data SA
                    |
                    v
           +-------------------+
           |  Crypto Session   |
           |(Security Protocol)|
           +-------------------+

            </pre>
<p></p>
<p id="rfc.section.2.p.6">For generic LLNs that are the focus of this document, the default algorithms applied in the generation of the TEK for each protocol is defined within this AMIKEY specification. An additional MIKEY message extension is also specified to define the security protocol parameters (policies) for generic LLNs.</p>
<p id="rfc.section.2.p.7">Whereas MIKEY CS IDs are associated with multimedia streams and have no intrinsic designation, in this specification the CS IDs are assigned values (public or private/vendor-specific) that are used to identify security protocols associated with specific device protocol layers or device interfaces.</p>
<p id="rfc.section.2.p.8">As in the base MIKEY specification, the security protocol can either use the TEK directly, or, if supported, derive further session keys from the TEK (e.g., see SRTP <a href="#RFC3711">[RFC3711]</a>). It is however up to the targeted security protocol and the associated security policy to define how the TEK is used.</p>
<p id="rfc.section.2.p.9">MIKEY can be used to update TEKs and the Crypto Sessions in a current Crypto Session Bundle (see <a href="#RFC3830">[RFC3830]</a>, Section 4.5).  This is done by executing the transport/exchange phase once again to obtain a new TGK (and consequently derive new TEKs) or to update some other specific CS parameters.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#extension-elem" id="extension-elem">AMIKEY Extension Elements</a>
</h1>
<p id="rfc.section.3.p.1">The following Section and Subsections detail the proposed additions to the MIKEY specification <a href="#RFC3830">[RFC3830]</a> to support the AMIKEY extension. The Section heading outline of the MIKEY specification is used to indicate the delta changes made by the AMIKEY extension.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> [RFC3830] Pre-shared key</h1>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> [RFC3830] Public-Key Encryption</h1>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> [RFC3830] Diffie-Hellman Key Exchange</h1>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#mgmt-func" id="mgmt-func">[RFC3830] Selected Key Management Functions</a>
</h1>
<p id="rfc.section.4.p.1">For AMIKEY all the key derivation functionality defined in MIKEY shall be based on a new default Pseudo-Random Function (PRF) given by the AES-based, AES-XCBC-PRF-128 algorithm as specified in <a href="#RFC4434">[RFC4434]</a>.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> [RFC3830] Key Calculation</h1>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> [RFC3830] Assumptions</h1>
<p id="rfc.section.4.1.1.p.1">For AMIKEY cs_id is defined so that session represents a protocol layer, logical device interface, or communications association. The cs-id values shall be as defined in this specification (see <a href="#map-type">Section 6.1.2</a>) and may be public or private/vendor-specific.</p>
<h1 id="rfc.section.4.1.2">
<a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#default-prf" id="default-prf">[RFC3830] Default PRF Description</a>
</h1>
<p id="rfc.section.4.1.2.p.1">For AMIKEY the default pseudo random function shall be AES-XCBC-PRF-128 <a href="#RFC4434">[RFC4434]</a>. Note: AES-XCBC-PRF-128 aligns with HMAC-SHA1 and HMAC-MD5 as PRFs.</p>
<h1 id="rfc.section.4.1.3">
<a href="#rfc.section.4.1.3">4.1.3.</a> [RFC3830] Generating Keys from TGK</h1>
<p id="rfc.section.4.1.3.p.1">For AMIKEY the cs-id values shall be as defined in this specification (see <a href="#map-type">Section 6.1.2</a>).</p>
<h1 id="rfc.section.4.1.4">
<a href="#rfc.section.4.1.4">4.1.4.</a> <a href="#gen-key-from-env-pre" id="gen-key-from-env-pre">[RFC3830] Generating Keys for MIKEY Messages from an Envelope/Pre-shared Key</a>
</h1>
<p id="rfc.section.4.1.4.p.1">Change from default PRF to the default AMIKEY PRF given in <a href="#default-prf">Section 4.1.2</a> of this specification.</p>
<p id="rfc.section.4.1.4.p.2">Note: For AMIKEY, the Authentication key constant SHALL be used for generating the single TEK in the case of authenticated encryption algorithms (such as AES-CCM).</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> [RFC3830] Pre-defined Transforms and Timestamp Formats</h1>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> [RFC3830] Hash Functions</h1>
<p id="rfc.section.4.2.1.p.1">For AMIKEY the default hash function shall be AES-XCBC-PRF-128 <a href="#RFC4434">[RFC4434]</a>.</p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> [RFC3830] Pseudo-Random Number Generator</h1>
<p id="rfc.section.4.2.2.p.1">For AMIKEY it shall be MANDATORY to implement the new default AES-XCBC-PRF-128 PRF specified in <a href="#RFC4434">[RFC4434]</a> (See <a href="#default-prf">Section 4.1.2</a> of this specification).</p>
<h1 id="rfc.section.4.2.3">
<a href="#rfc.section.4.2.3">4.2.3.</a> [RFC3830] Key Data Transport Encryption</h1>
<p id="rfc.section.4.2.3.p.1">As in MIKEY the default and mandatory-to-implement key transport encryption shall be AES in Counter mode using a 128-bit key (derived as defined in <a href="#gen-key-from-env-pre">Section 4.1.4</a> above).  The applied Counter shall be the IV defined in <a href="#RFC3830">[RFC3830]</a>, Section 4.2.3.</p>
<h1 id="rfc.section.4.2.4">
<a href="#rfc.section.4.2.4">4.2.4.</a> <a href="#mac-function" id="mac-function">[RFC3830] MAC Verification Message Function</a>
</h1>
<p id="rfc.section.4.2.4.p.1">For AMIKEY AES-CCM-64 shall be the defined default for key message authentication. The Counter used shall be the IV defined in <a href="#RFC3830">[RFC3830]</a>, Section 4.2.3.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> [RFC3830] Certificates, Policies and Authorization</h1>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> [RFC3830] Retrieving the Data SA</h1>
<p id="rfc.section.4.4.p.1">For AMIKEY the retrieval of a Data SA will depend on the security protocol. The support for different security protocols shall be explicitly identified through the use of public CS ID values (see <a href="#map-type">Section 6.1.2</a> of this specification).</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> [RFC3830] Behavior and Message Handling</h1>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#payload" id="payload">[RFC3830] Payload Encoding</a>
</h1>
<p id="rfc.section.6.p.1">The generic LLN security protocol parameters may be transported between peers as part of a key establishment or re-keying exchange.  Based on IANA registration, MIKEY currently only defines two payloads for transporting the security policy information (see Section 6.10 of <a href="#RFC3830">[RFC3830]</a> and [RFC4442]). This section describes the extension of MIKEY to allow the transport of Generic LLN security policy information and associated key(s) as well as applicable PRF used for key derivation.</p>
<p id="rfc.section.6.p.2">This section describes, in detail, the payload for support of the Generic LLN security protocol(s) specified by the Adapted MIKEY protocol. As in RFC3830, for all encoding, network byte order is always used, and the sign ~ indicates a variable length field.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#common-hdr" id="common-hdr">[RFC3830] Common Header Payload (HDR)</a>
</h1>
<p id="rfc.section.6.1.p.1">The Common Header payload MUST always be present as the first payload in each message. The Common Header includes a general description of the exchange message.</p>
<div id="#rfc.figure.2"></div>
<div id="#fig2"></div>
<p></p>
<pre>

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !  version      !  data type    ! next payload  !V! PRF func    !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !                         CSB ID                                !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ! #CS           ! CS ID map type! CS ID map info                ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

	  </pre>
<p></p>
<p></p>

<ul>
<li>version (8 bits): the version number of MIKEY.</li>
<li>version = 0x01 refers to MIKEY as defined and maintained in <a href="#RFC3830">[RFC3830]</a>.</li>
<li>version = 0x0n (to be assigned) shall be used to refer to AMIKEY as defined and maintained in this document.</li>
<li>data type (8 bits): describes the type of message (e.g., public-key transport message, verification message, error message). See latest IANA registered values. No additional values are specified for AMIKEY (TBD).</li>
<li>next payload (8 bits): identifies the payload that is added after this payload. See latest IANA registered values.</li>
</ul>
<p id="rfc.section.6.1.p.3">For AMIKEY a new next payload value is assigned to carry the Key Index parameter (see also <a href="#key-index">Section 6.16</a>).</p>
<div id="#rfc.table.1"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.1.b</caption>
<thead><tr>
<th class="left">Next Payload</th>
<th class="center">Value</th>
<th class="left">Section</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Last payload</td>
<td class="center">0</td>
<td class="left">-</td>
</tr>
<tr>
<td class="left">...</td>
<td class="center"></td>
<td class="left"></td>
</tr>
<tr>
<td class="left">Key Index</td>
<td class="center">n</td>
<td class="left">
<a href="#key-index">Section 6.16</a> as given by the AMIKEY specification (value to be assigned by IANA).</td>
</tr>
<tr>
<td class="left">Key act time</td>
<td class="center">m</td>
<td class="left">
<a href="#key-act-time">Section 6.17</a> as given by the AMIKEY specification (value to be assigned by IANA)</td>
</tr>
</tbody>
</table>
<p></p>
<p></p>

<ul>
<li>V (1 bit): flag to indicate whether a verification message is expected or not (this only has meaning when it is set by the Initiator).</li>
<li>PRF func (7 bits): indicates the PRF function that has been/will be used for key derivation; for AMIKEY a new value, 2, has been specified to indicate the PRF that must be supported for LLNs.</li>
</ul>
<div id="#rfc.table.2"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.1.c</caption>
<thead><tr>
<th class="left">PRF Function</th>
<th class="center">Value</th>
<th class="left">Comments</th>
</tr></thead>
<tbody><tr>
<td class="left">AES-XCBC-PRF-128</td>
<td class="center">2</td>
<td class="left">As specified in <a href="#RFC4434">[RFC4434]</a> and that shall be mandatory for AMIKEY</td>
</tr></tbody>
</table>
<p></p>
<p id="rfc.section.6.1.p.5">(AMIKEY value to be assigned by IANA)</p>
<p></p>

<ul>
<li>CSB ID (32 bits): identifies the CSB (generated as specified in <a href="#RFC3830">[RFC3830]</a>); for AMIKEY this field is used as a message reference identifier to allow for duplicate detection where message exchanges occur over an unreliable transport network.</li>
<li>#CS (8 bits): indicates the number of Crypto Sessions that will be handled within the CBS; for AMIKEY this field indicates the number of protocol layers, logical device interfaces, or other communications associations that are being configured or managed within the current key management message exchange.</li>
<li>CS ID map type (8 bits): specifies the method of uniquely mapping. Crypto Sessions to the security protocol sessions; for AMIKEY a new value, 3, has been specified to indicate the Generic-LLN map type that must be supported for LLNs.</li>
</ul>
<div id="#rfc.table.3"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.1.d</caption>
<thead><tr>
<th class="left">CS ID Map Type</th>
<th class="center">Value</th>
<th class="left">Comments</th>
</tr></thead>
<tbody><tr>
<td class="left">Generic_LLN-ID</td>
<td class="center">3</td>
<td class="left">As specified in this document and as mandatory for AMIKEY</td>
</tr></tbody>
</table>
<p></p>
<p id="rfc.section.6.1.p.7">(AMIKEY value to be assigned by IANA)</p>
<p></p>

<ul><li>CS ID map info (variable length): identifies the crypto session(s) for which the SA should be created. For AMIKEY the GENERIC_LLN map type (defined in <a href="#map-type">Section 6.1.2</a> below) is used to specify the security association for the individual protocol layers, logical device interfaces, or other communications associations for which key management is being provided.</li></ul>
<h1 id="rfc.section.6.1.1">
<a href="#rfc.section.6.1.1">6.1.1.</a> [RFC3830] SRTP ID</h1>
<h1 id="rfc.section.6.1.2">
<a href="#rfc.section.6.1.2">6.1.2.</a> <a href="#map-type" id="map-type">The Generic_LLN-ID Map Type</a>
</h1>
<p id="rfc.section.6.1.2.p.1">For the Generic_LLN map type, the CS ID map info consists of #CS (see <a href="#common-hdr">Section 6.1</a>) number of blocks or segments, where each segment maps policies (and a key) to a specific protocol layer, logical device interface or other communications association security protocol.</p>
<div id="#rfc.figure.3"></div>
<div id="#fig3"></div>
<p></p>
<pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !     CS ID     !       #P      !          Ps (OPTIONAL)        ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

	  </pre>
<p></p>
<p></p>

<ul><li>CS ID (8 bits): specifies the CS ID used to identify a given security protocol; for AMIKEY, when used in conjunction with the Generic-LLN map type, values 0-127 shall be reserved for assignment (by IANA) to specific protocol layer, logical device interface, or other communications association security protocols while values 128-255 shall be Reserved for Private Use.</li></ul>
<p id="rfc.section.6.1.2.p.3">Note: A combination of public and private CS IDs can be specified within a given CSB when combined key management is being applied.</p>
<p id="rfc.section.6.1.2.p.4">The following values are currently specified in this document (for example, with values to be assigned by IANA):</p>
<div id="#rfc.table.4"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.1.e</caption>
<thead><tr>
<th class="left">CS ID</th>
<th class="center">Value</th>
<th class="left">Comments</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Reserved</td>
<td class="center">0</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">Generic PHY Layer</td>
<td class="center">1</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">Generic Link Layer</td>
<td class="center">2</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">Generic Network Layer</td>
<td class="center">3</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">Generic Application Layer</td>
<td class="center">7</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">RPL Protocol</td>
<td class="center">20</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">...</td>
<td class="center"></td>
<td class="left"></td>
</tr>
<tr>
<td class="left">Reserved values</td>
<td class="center">128-255</td>
<td class="left">Reserved for private use</td>
</tr>
</tbody>
</table>
<p></p>
<p></p>

<ul>
<li>#P (8 bits): indicates the number of security policies provided for the crypto session (given by the CS ID) for which key management is being provided. In response messages, #P SHALL always be exactly 1. So if #P = 0 in an initial message, a security profile MUST be provided in the response message. If #P &gt; 0, one of the suggested policies SHOULD be chosen in the response message. If needed, the suggested policies MAY be changed.</li>
<li>Ps (variable length): lists the policies for the crypto session for which key management is being provided. It SHALL contain exactly #P policies, each having the specified Prot type (see <a href="#sp-payload">Section 6.10</a>.</li>
</ul>
<div id="#rfc.figure.4"></div>
<div id="#fig4"></div>
<p></p>
<pre>

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 !  Policy_no_i  !  Policy_no_n  !      ...      ! Policy_no_#P  !
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

	  </pre>
<p></p>
<p></p>

<ul><li>Policy_no_i (8 bits): a policy_no that corresponds to the policy_no of a SP payload. In response messages, the policy_no may refer to a SP payload in the initial message. The policy numbers should be listed in increasing order.</li></ul>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> [RFC3830] Key Data Transport Payload (KEMAC)</h1>
<p id="rfc.section.6.2.p.1">This section shall apply entirely as specified for MIKEY in <a href="#RFC3830">[RFC3830]</a> with the addition of the specific message authentication code algorithms given below for AMIKEY.</p>
<p></p>

<ul><li>MAC alg (8 bits): specifies the authentication algorithm used.</li></ul>
<div id="#rfc.table.5"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.2.b</caption>
<thead><tr>
<th class="left">MAC alg</th>
<th class="center">Value</th>
<th class="left">Comments</th>
<th class="center">Length (bits)</th>
</tr></thead>
<tbody>
<tr>
<td class="left">NULL</td>
<td class="center">0</td>
<td class="left">restricted usage <a href="#RFC3830">[RFC3830]</a>, Section 4.2.4</td>
<td class="center">0</td>
</tr>
<tr>
<td class="left">HMAC-SHA-1-160</td>
<td class="center">1</td>
<td class="left">Mandatory, <a href="#RFC3830">[RFC3830]</a>, Section 4.2.4</td>
<td class="center">160</td>
</tr>
<tr>
<td class="left">HMAC-SHA-256-256</td>
<td class="center">2</td>
<td class="left">Mandatory, <a href="#RFC3830">[RFC3830]</a>, Section 4.2.4</td>
<td class="center">256</td>
</tr>
<tr>
<td class="left">AES-CBC-MAC-32</td>
<td class="center">3</td>
<td class="left">Mandatory for AMIKEY, see <a href="#mac-function">Section 4.2.4</a>
</td>
<td class="center">32</td>
</tr>
<tr>
<td class="left">AES-CBC-MAC-64</td>
<td class="center">4</td>
<td class="left">Mandatory for AMIKEY, see <a href="#mac-function">Section 4.2.4</a>
</td>
<td class="center">64</td>
</tr>
<tr>
<td class="left">AES-CBC-MAC-128</td>
<td class="center">5</td>
<td class="left">Mandatory for AMIKEY, see <a href="#mac-function">Section 4.2.4</a>
</td>
<td class="center">128</td>
</tr>
</tbody>
</table>
<p></p>
<p id="rfc.section.6.2.p.3">(Values for AMIKEY to be assigned by IANA)</p>
<p></p>

<ul><li>MAC (variable length): the message authentication code of the entire message.</li></ul>
<p id="rfc.section.6.2.p.5">For AMIKEY the use of AES-CBC-MAC-n may be applied in conjunction with the AES-CM encryption as given by the Encr alg field. This authenticated encryption shall be applied using an AES-CCM-n implementation.</p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> [RFC3830] Envelope Data Payload (PKE)</h1>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> [RFC3830] DH Data Payload (DH)</h1>
<h1 id="rfc.section.6.5">
<a href="#rfc.section.6.5">6.5.</a> [RFC3830] Signature Payload (SIGN)</h1>
<h1 id="rfc.section.6.6">
<a href="#rfc.section.6.6">6.6.</a> [RFC3830] Timestamp Payload (T)</h1>
<h1 id="rfc.section.6.7">
<a href="#rfc.section.6.7">6.7.</a> [RFC3830] ID Payload (ID)</h1>
<p id="rfc.section.6.7.p.1">For AMIKEY the range of ID types shall be extended to allow for an expanded array of communications protocol entities that may be key management participants.</p>
<div id="#rfc.table.6"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.7.a</caption>
<thead><tr>
<th class="left">ID Type</th>
<th class="center">Value</th>
<th class="left">Comments</th>
</tr></thead>
<tbody>
<tr>
<td class="left">IPv6 Address</td>
<td class="center">4</td>
<td class="left">As specified for AMIKEY</td>
</tr>
<tr>
<td class="left">Other (TBD)</td>
<td class="center">n</td>
<td class="left">As specified for AMIKEY</td>
</tr>
</tbody>
</table>
<p></p>
<h1 id="rfc.section.6.8">
<a href="#rfc.section.6.8">6.8.</a> [RFC3830] Cert Hash Payload (CHASH)</h1>
<h1 id="rfc.section.6.9">
<a href="#rfc.section.6.9">6.9.</a> [RFC3830] Ver msg payload (V)</h1>
<h1 id="rfc.section.6.10">
<a href="#rfc.section.6.10">6.10.</a> <a href="#sp-payload" id="sp-payload">[RFC3830] Security Policy (SP) Payload</a>
</h1>
<p id="rfc.section.6.10.p.1">The Security Policy payload defines a set of policies that apply to a specific security protocol.</p>
<p id="rfc.section.6.10.p.2">For AMIKEY the definition is based on the same security policy payload definition in <a href="#RFC3830">[RFC3830]</a>, Section 6.10, with a new security protocol (Generic-LLN) as defined below.</p>
<div id="#rfc.figure.5"></div>
<p></p>
<pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ! Next payload  ! Policy no     ! Prot type     ! Policy param  ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~ length (cont) ! Policy param                                  ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   </pre>
<p></p>
<p></p>

<ul>
<li>Next payload (8 bits): Identifies the payload that is added after this payload. See Section 6.1 of <a href="#RFC3830">[RFC3830]</a> for more details.</li>
<li>Policy no (8 bits): Each security policy payload must be given a distinct number for the current MIKEY session by the local peer.  This number is used to map a cryptographic session to a specific policy (see also Section 6.1.1 of <a href="#RFC3830">[RFC3830]</a>).</li>
<li>Prot type (8 bits): This value defines the security protocol; For AMIKEY an additional value shall be assigned as given below.</li>
</ul>
<div id="#rfc.table.7"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.10</caption>
<thead><tr>
<th class="left">Prot Type</th>
<th class="center">Value</th>
<th class="center">Comments</th>
</tr></thead>
<tbody><tr>
<td class="left">Generic_LLN</td>
<td class="center">2</td>
<td class="center">(As specified for AMIKEY)</td>
</tr></tbody>
</table>
<p></p>
<p></p>

<ul>
<li>Policy param length (16 bits): This field defines the total length of the policy parameters for the selected security protocol.</li>
<li>Policy param (variable length): This field defines the policy for the specific security protocol. The Policy param part is built up by a set of Type/Length/Value (TLV) payloads. For each security protocol, a set of possible type/value pairs can be negotiated as defined.</li>
</ul>
<div id="#rfc.figure.6"></div>
<div id="#fig7"></div>
<p></p>
<pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ! Type          ! Length        ! Value                         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   </pre>
<p></p>
<p></p>

<ul>
<li>Type (8 bits): Specifies the type of the parameter.</li>
<li>Length (8 bits): Specifies the length of the Value field (in bytes).</li>
<li>Value (variable length): Specifies the value of the parameter.</li>
</ul>
<h1 id="rfc.section.6.10.1">
<a href="#rfc.section.6.10.1">6.10.1.</a> [RFC3830] SRTP Policy</h1>
<h1 id="rfc.section.6.10.2">
<a href="#rfc.section.6.10.2">6.10.2.</a> AMIKEY Generic_LLN Policy</h1>
<p id="rfc.section.6.10.2.p.1">This policy specifies the parameters for the Generic_LLN (G_LLN) protocol for which key management is being provided. The types/values that can be negotiated are defined by the following table for the known, assigned CS ID values. For Vendor-specific, private CS ID values the applicable policy specification for a given crypto session will be left to the communicating parties.</p>
<div id="#rfc.table.8"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.10.2.a</caption>
<thead><tr>
<th class="center">Type</th>
<th class="left">Meaning</th>
<th class="left">Possible Values</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">Encryption algorithm</td>
<td class="left">See below</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">Encryption key length</td>
<td class="left">Depends on cipher used</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">Authentication algorithm</td>
<td class="left">See below</td>
</tr>
<tr>
<td class="center">3</td>
<td class="left">Authentication key length</td>
<td class="left">Depends on MAC used</td>
</tr>
<tr>
<td class="center">4</td>
<td class="left">Generic LLN PRF</td>
<td class="left">See below</td>
</tr>
<tr>
<td class="center">5</td>
<td class="left">Encryption off/on</td>
<td class="left">0 if off, 1 if on</td>
</tr>
</tbody>
</table>
<p></p>
<p id="rfc.section.6.10.2.p.2">For the Encryption algorithm, a one byte length is sufficient.  For AMIKEY the currently defined possible Values are:</p>
<div id="#rfc.table.9"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.10.2.b</caption>
<thead><tr>
<th class="left">G_LLN encr alg</th>
<th class="center">Value</th>
</tr></thead>
<tbody>
<tr>
<td class="left">NULL</td>
<td class="center">0</td>
</tr>
<tr>
<td class="left">AES-CM</td>
<td class="center">1</td>
</tr>
</tbody>
</table>
<p></p>
<p id="rfc.section.6.10.2.p.3">For the Authentication algorithm, a one byte length is sufficient. For AMIKEY the currently defined possible Values are:</p>
<div id="#rfc.table.10"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.10.2.c</caption>
<thead><tr>
<th class="left">G_LLN auth alg</th>
<th class="center">Value</th>
<th class="left">Comments</th>
</tr></thead>
<tbody>
<tr>
<td class="left">NULL</td>
<td class="center">0</td>
<td class="left">Not recommended for operational use</td>
</tr>
<tr>
<td class="left">AES-CBC-MAC-32</td>
<td class="center">1</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">AES-CBC-MAC-64</td>
<td class="center">2</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">AES-CBC-MAC-128</td>
<td class="center">3</td>
<td class="left"></td>
</tr>
</tbody>
</table>
<p></p>
<p id="rfc.section.6.10.2.p.4">Note: Since authentication is mandatory for operational protocol security, where Encryption is set "on" by the Generic_LLN policy, authenticated encryption, AES-CCM-n, with the MAC size given by the selected authentication algorithm shall be applied.</p>
<p id="rfc.section.6.10.2.p.5">For the Generic_LLN pseudo-random function, a one byte length is also sufficient. For AMIKEY the currently defined possible Values are:</p>
<div id="#rfc.table.11"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Table 6.10.2.d</caption>
<thead><tr>
<th class="left">Generic_LLN PRF</th>
<th class="center">Value</th>
</tr></thead>
<tbody><tr>
<td class="left">AES-XCBC-PRF-128</td>
<td class="center">0</td>
</tr></tbody>
</table>
<p></p>
<h1 id="rfc.section.6.11">
<a href="#rfc.section.6.11">6.11.</a> [RFC3830] RAND Payload (RAND)</h1>
<h1 id="rfc.section.6.12">
<a href="#rfc.section.6.12">6.12.</a> [RFC3830] Error Payload (ERR)</h1>
<h1 id="rfc.section.6.13">
<a href="#rfc.section.6.13">6.13.</a> [RFC3830] Key Data Sub-Payload</h1>
<h1 id="rfc.section.6.14">
<a href="#rfc.section.6.14">6.14.</a> [RFC3830] Key Validity Data</h1>
<h1 id="rfc.section.6.15">
<a href="#rfc.section.6.15">6.15.</a> [RFC3830] General Extension Payload</h1>
<h1 id="rfc.section.6.16">
<a href="#rfc.section.6.16">6.16.</a> <a href="#key-index" id="key-index">Key Index Payload</a>
</h1>
<p id="rfc.section.6.16.p.1">For AMIKEY the Key Index payload is used to specify the value of the key index associated with a given TGK.</p>
<div id="#rfc.figure.7"></div>
<div id="#fig8"></div>
<p></p>
<pre>

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !  Next Payload !    KI value   !           Reserved            !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   </pre>
<p></p>
<p></p>

<ul>
<li>Next payload (8 bits): identifies the payload that is added after this payload. See Section 6.1 <a href="#RFC3830">[RFC3830]</a> for values.</li>
<li>KI value (8 bits): indicates the value (from 0-255) of the key index to be assigned to any CS TEK generated from the transported TGK.</li>
</ul>
<h1 id="rfc.section.6.17">
<a href="#rfc.section.6.17">6.17.</a> <a href="#key-act-time" id="key-act-time">Key Activation Time Payload</a>
</h1>
<p id="rfc.section.6.17.p.1">For AMIKEY the Key Activation time payload is used to specify the time at which a new key derived from a communicated TGK shall become active for the associated device protocol or interface. The format of this AMIKEY information element type shall be the same as that of the Timestamp payload (T) <a href="#RFC3830">[RFC3830]</a>.</p>
<div id="#rfc.figure.8"></div>
<div id="#fig9"></div>
<p></p>
<pre>

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !  Next Payload !     TS type   !    TS value                   !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   </pre>
<p></p>
<p></p>

<ul>
<li>Next payload (8 bits): identifies the payload that is added after this payload. See Section 6.1 <a href="#RFC3830">[RFC3830]</a> for values.</li>
<li>TS type (8 bits): indicates the timestamp type use to convey the time at which a new derived TEK shall become active (See Section 6.6 <a href="#RFC3830">[RFC3830]</a>).</li>
<li>TS value (variable length): the timestamp value of the specified TS type (See Section 6.6 <a href="#RFC3830">[RFC3830]</a>). Note: A TS value of 0 shall indicate that the applicable key update takes effect immediately.</li>
</ul>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> [RFC3830] Transport Protocols</h1>
<p id="rfc.section.7.p.1">As in <a href="#RFC3830">[RFC3830]</a>, AMIKEY may be integrated within session establishment or other system signaling protocols or may be directly transported over UDP or TCP. Where AMIKEY messages are integrated into other LLN-related signaling protocols its transport shall be defined as part of those protocols.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.8.p.1">A primary motivation for this RFC is the security that comes from a re-use of the key management methods and framework developed for MIKEY.  The extensive deployment and on-going development provides the benefit of much wider vetting and validation essential to assuring greater security.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> [RFC3830] Groups</h1>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Additional Specification Considerations</h1>
<p id="rfc.section.10.p.1">Work had been previously initiated in developing support for an ECC-based asymmetric key management method (<a href="#I-D.ietf-msec-mikey-ecc">[I-D.ietf-msec-mikey-ecc]</a>, expired). In the context of LLNs application and subject to IPR considerations, related AMIKEY requirements may be developed.</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.11.p.1">This document defines several new name spaces associated with the AMIKEY payloads. This section summarizes the name spaces for which IANA is requested to manage the allocation of values. IANA is requested to record the pre-defined values defined in the given sections for each name space. IANA is also requested to manage the definition of additional values in the future. Unless explicitly stated otherwise, values in the range 0-240 for each name space SHOULD be approved by the process of IETF consensus and values in the range 241-255 are reserved for Private Use, according to <a href="#RFC2434">[RFC2434]</a>.</p>
<p id="rfc.section.11.p.2">The name spaces for the new fields identified in this document are requested to be managed by IANA (in bracket is the reference to the table with the initially registered values): </p>

<ul>
<li>Next payload (6.1.b) <ul>
<li>Key index</li>
<li>Key activation time</li>
</ul>
</li>
<li>Prf func (6.1.c) <ul><li>AES-XCBC-PRF-128</li></ul>
</li>
<li>CS ID map type (6.1.d) <ul><li>Generic_LLN-ID</li></ul>
</li>
<li>MAC alg (6.2.b) <ul>
<li>AES-CBC-MAC-32</li>
<li>AES-CBC-MAC-64</li>
<li>AES-CBC-MAC-128</li>
</ul>
</li>
<li>ID payload (6.7.a) <ul><li>IPv6 Address</li></ul>
</li>
<li>Proto type (6.10) <ul><li>Generic_LLN</li></ul>
</li>
<li>Generic_LLN policy (6.10.2) <ul>
<li>Policy parameters (6.10.2.a)</li>
<li>G_LLN encr alg (6.10.2.b)</li>
<li>G_LLN auth alg (6.10.2.c)</li>
<li>G_LLN prf (6.10.2.d)</li>
</ul>
</li>
</ul>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgments</a>
</h1>
<p id="rfc.section.12.p.1">The authors would like to acknowledge the review and comments from Rene Struik.</p>
<h1 id="rfc.references">
<a href="#rfc.references">13.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">13.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2434">[RFC2434]</b></td>
<td class="top">
<a href="mailto:narten@raleigh.ibm.com" title="IBM Corporation">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no" title="Maxware">H.T. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc2434">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 2434, October 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3830">[RFC3830]</b></td>
<td class="top">
<a>Arkko, J.</a>, <a>Carrara, E.</a>, <a>Lindholm, F.</a>, <a>Naslund, M.</a> and <a>K. Norrman</a>, "<a href="http://tools.ietf.org/html/rfc3830">MIKEY: Multimedia Internet KEYing</a>", RFC 3830, August 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4434">[RFC4434]</b></td>
<td class="top">
<a>Hoffman, P.</a>, "<a href="http://tools.ietf.org/html/rfc4434">The AES-XCBC-PRF-128 Algorithm for the Internet Key Exchange Protocol (IKE)</a>", RFC 4434, February 2006.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">13.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3605">[RFC3605]</b></td>
<td class="top">
<a>Huitema, C.</a>, "<a href="http://tools.ietf.org/html/rfc3605">Real Time Control Protocol (RTCP) attribute in Session Description Protocol (SDP)</a>", RFC 3605, October 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3711">[RFC3711]</b></td>
<td class="top">
<a>Baugher, M.</a>, <a>McGrew, D.</a>, <a>Naslund, M.</a>, <a>Carrara, E.</a> and <a>K. Norrman</a>, "<a href="http://tools.ietf.org/html/rfc3711">The Secure Real-time Transport Protocol (SRTP)</a>", RFC 3711, March 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4107">[RFC4107]</b></td>
<td class="top">
<a>Bellovin, S.</a> and <a>R. Housley</a>, "<a href="http://tools.ietf.org/html/rfc4107">Guidelines for Cryptographic Key Management</a>", BCP 107, RFC 4107, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4442">[RFC4442]</b></td>
<td class="top">
<a>Fries, S.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc4442">Bootstrapping Timed Efficient Stream Loss-Tolerant Authentication (TESLA)</a>", RFC 4442, March 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4563">[RFC4563]</b></td>
<td class="top">
<a>Carrara, E.</a>, <a>Lehtovirta, V.</a> and <a>K. Norrman</a>, "<a href="http://tools.ietf.org/html/rfc4563">The Key ID Information Type for the General Extension Payload in Multimedia Internet KEYing (MIKEY)</a>", RFC 4563, June 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4566">[RFC4566]</b></td>
<td class="top">
<a>Handley, M.</a>, <a>Jacobson, V.</a> and <a>C. Perkins</a>, "<a href="http://tools.ietf.org/html/rfc4566">SDP: Session Description Protocol</a>", RFC 4566, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4650">[RFC4650]</b></td>
<td class="top">
<a>Euchner, M.</a>, "<a href="http://tools.ietf.org/html/rfc4650">HMAC-Authenticated Diffie-Hellman for Multimedia Internet KEYing (MIKEY)</a>", RFC 4650, September 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4738">[RFC4738]</b></td>
<td class="top">
<a>Ignjatic, D.</a>, <a>Dondeti, L.</a>, <a>Audet, F.</a> and <a>P. Lin</a>, "<a href="http://tools.ietf.org/html/rfc4738">MIKEY-RSA-R: An Additional Mode of Key Distribution in Multimedia Internet KEYing (MIKEY)</a>", RFC 4738, November 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5197">[RFC5197]</b></td>
<td class="top">
<a>Fries, S.</a> and <a>D. Ignjatic</a>, "<a href="http://tools.ietf.org/html/rfc5197">On the Applicability of Various Multimedia Internet KEYing (MIKEY) Modes and Extensions</a>", RFC 5197, June 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5410">[RFC5410]</b></td>
<td class="top">
<a>Jerichow, A.</a> and <a>L. Piron</a>, "<a href="http://tools.ietf.org/html/rfc5410">Multimedia Internet KEYing (MIKEY) General Extension Payload for Open Mobile Alliance BCAST 1.0</a>", RFC 5410, January 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6043">[RFC6043]</b></td>
<td class="top">
<a>Mattsson, J.</a> and <a>T. Tian</a>, "<a href="http://tools.ietf.org/html/rfc6043">MIKEY-TICKET: Ticket-Based Modes of Key Distribution in Multimedia Internet KEYing (MIKEY)</a>", RFC 6043, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6267">[RFC6267]</b></td>
<td class="top">
<a>Cakulev, V.</a> and <a>G. Sundaram</a>, "<a href="http://tools.ietf.org/html/rfc6267">MIKEY-IBAKE: Identity-Based Authenticated Key Exchange (IBAKE) Mode of</a>", RFC 6267, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-roll-rpl">[I-D.ietf-roll-rpl]</b></td>
<td class="top">
<a>Winter, T</a>, <a>Thubert, P</a>, <a>Brandt, A</a>, <a>Clausen, T</a>, <a>Hui, J</a>, <a>Kelsey, R</a>, <a>Levis, P</a>, <a>Pister, K</a>, <a>Struik, R</a> and <a>J Vasseur</a>, "<a href="http://tools.ietf.org/html/draft-ietf-roll-rpl-19">RPL: IPv6 Routing Protocol for Low power and Lossy Networks</a>", Internet-Draft draft-ietf-roll-rpl-19, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-msec-mikey-ecc">[I-D.ietf-msec-mikey-ecc]</b></td>
<td class="top">
<a>Milne, A</a>, "<a href="http://tools.ietf.org/html/draft-ietf-msec-mikey-ecc-03">ECC Algorithms for MIKEY</a>", Internet-Draft draft-ietf-msec-mikey-ecc-03, June 2007.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Roger K. Alexander</span> 
	  <span class="n hidden">
		<span class="family-name">Alexander</span>
	  </span>
	</span>
	<span class="org vcardline">Cooper Power Systems</span>
	<span class="adr">
	  <span>20201 Century Blvd. Suite 250</span>

	  <span class="vcardline">
		<span class="locality">Germantown</span>,  
		<span class="region">Maryland</span> 
		<span class="code">20874</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:roger.alexander@cooperindustries.com">roger.alexander@cooperindustries.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tzeta Tsao</span> 
	  <span class="n hidden">
		<span class="family-name">Tsao</span>
	  </span>
	</span>
	<span class="org vcardline">Cooper Power Systems</span>
	<span class="adr">
	  <span>20201 Century Blvd. Suite 250</span>

	  <span class="vcardline">
		<span class="locality">Germantown</span>,  
		<span class="region">Maryland</span> 
		<span class="code">20874</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tzeta.tsao@cooperindustries.com">tzeta.tsao@cooperindustries.com</a></span>

  </address>
</div>

</body>
</html>