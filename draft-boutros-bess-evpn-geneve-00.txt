 



INTERNET-DRAFT                                              Sami Boutros
Intended Status: Standard Track                                   VMware
                                                             Ali Sajassi
                                                           Cisco Systems
                                                              John Drake
                                                        Juniper Networks

Expires: December 21, 2017                                 June 19, 2017


                     EVPN control plane for Geneve
                 draft-boutros-bess-evpn-geneve-00.txt 

Abstract

   This document describes how Ethernet VPN (EVPN) control plane can be
   used with Network Virtualization Overlay over Layer 3 (NVO3) Generic
   Network Virtualization Encapsulation (Geneve) encapsulation in NVO3
   solutions. EVPN control plane can be used by a Network Virtualization
   Endpoints (NVEs) to express as well what Geneve tunnel option TLV(s)
   that they can transmit and/or receive.

Status of this Memo

   This Internet-Draft is submitted to IETF in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as
   Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/1id-abstracts.html

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html


Copyright and License Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors. All rights reserved.
 


Boutros                Expires December 21, 2017                [Page 1]

INTERNET DRAFT       EVPN control plane for Geneve         June 19, 2017


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document. Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Table of Contents

   1  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . .  3
     1.1  Terminology . . . . . . . . . . . . . . . . . . . . . . . .  3
   2. BGP Extensions  . . . . . . . . . . . . . . . . . . . . . . . .  4
     2.1 Geneve Tunnel Option Types sub-TLV . . . . . . . . . . . . .  4
   3. Operation . . . . . . . . . . . . . . . . . . . . . . . . . . .  5
     3.1 Negotiating TLV ordering, Size and total option length . . .  6
   4. Security Considerations . . . . . . . . . . . . . . . . . . . .  6
   5. IANA Considerations . . . . . . . . . . . . . . . . . . . . . .  6
   6.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . .  6
   7 References . . . . . . . . . . . . . . . . . . . . . . . . . . .  6
     7.1 Normative References . . . . . . . . . . . . . . . . . . . .  6
     7.2  Informative References  . . . . . . . . . . . . . . . . . .  7
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . .  7





















 


Boutros                Expires December 21, 2017                [Page 2]

INTERNET DRAFT       EVPN control plane for Geneve         June 19, 2017


1  Introduction

   The Network Virtualization over Layer 3 (NVO3) develop solutions for
   network virtualization within a data center (DC) environment that
   assumes an IP-based underlay. An NVO3 solution provides layer 2
   and/or layer 3 overlay services for virtual networks enabling multi-
   tenancy and workload mobility. The NVO3 working group have been
   working on different dataplane encapsulations. The Generic Network
   Virtualization Encapsulation [GENEVE] have been recently recommended
   to be the proposed standard for network virtualization overlay
   encapsulation.

   This document describes how the EVPN control plane can signals Geneve
   encapsulation type in the BGP Tunnel Encapsulation Extended
   Community. The also document defines how to communicate the Geneve
   tunnel option types in a new BGP Tunnel Encapsulation Attribute sub-
   TLV. The Geneve tunnel options are encapsulated as TLVs after the
   Geneve base header in the Geneve packet as described in [GENEVE].

   The NVO3 encapsulation design team has made a recommendation in [DT-
   ENCAP] for a control plane to negotiate a subset of option TLVs and
   certain TLV ordering, as well can limit the total number of option
   TLVs present in the packet, for example, to allow hardware capable of
   processing fewer options.

   This EVPN control plane extension will allow a Network Virtualization
   Endpoint (NVE) to express what Geneve option TLV types it is capable
   to receive or to send over the Geneve tunnel to its peers.

   In the datapath, a transmitting NVE MUST not encapsulate a packet
   destined to another NVE with any option TLV(s) the receiving NVE is
   not capable of processing.

1.1  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

   Most of the terminology used in this documents comes from [RFC7432]
   and [NVO3-FRWK].

      NVO3: Network Virtualization Overlay over Layer 3

      GENEVE: Generic Network Virtualization Encapsulation.

      NVE: Network Virtualization Endpoint.

 


Boutros                Expires December 21, 2017                [Page 3]

INTERNET DRAFT       EVPN control plane for Geneve         June 19, 2017


      VNI:  Virtual Network Identifier.

      MAC: Media Access Control.

      OAM: Operations, Administration and Maintenance.

      PE: Provide Edge Node.

      CE: Customer Edge device e.g., host or router or switch.

      EVPN: Ethernet VPN.

      EVI: An EVPN instance spanning the Provider Edge (PE) devices
      participating in that EVPN.

      MAC-VRF: A Virtual Routing and Forwarding table for Media Access
      Control (MAC) addresses on a PE.

2. BGP Extensions


   As per [ietf-evpn-overlay] the BGP Encapsulation extended community
   defined in [TUNNEL-ENCAP] and [RFC5512] is included with all EVPN
   routes advertised by an egress NVE. 

   This document specifies a new BGP Tunnel Encapsulation Type for
   Geneve and a new Geneve tunnel option types sub-TLV as described
   below.

2.1 Geneve Tunnel Option Types sub-TLV


   The Geneve tunnel option types is a new BGP Tunnel Encapsulation
   Attribute Sub-TLV.


                      +-----------------------------------+
                      |      Sub-TLV Type (1 Octet)       |
                      +-----------------------------------+
                      |     Sub-TLV Length (1 or 2 Octets)|
                      +-----------------------------------+
                      |     Sub-TLV Value (Variable)      |
                      |                                   |
                      +-----------------------------------+


        Figure 1: Geneve tunnel option types sub-TLV

 


Boutros                Expires December 21, 2017                [Page 4]

INTERNET DRAFT       EVPN control plane for Geneve         June 19, 2017


     The Sub-TLV Type field contains a value in the range from 192-252.
     To be allocated by IANA.

     Sub-TLV value will be the Geneve option TLV types, each type will     
     be encoded as a 24 bit value.


3. Operation

   The following figure shows an example of an NVO3 deployment with
   EVPN.



                                 +--------------+
                                 |              |
                 +---------+     |     WAN      |    +---------+
         +----+  |         |   +----+        +----+  |         |  +----+
         |NVE1|--|         |   |ASBR|        |ASBR|  |         |--|NVE3|
         +----+  |IP Fabric|---| 1  |        |  2 |--|IP Fabric|  +----+
         +----+  |         |   +----+        +----+  |         |  +----+
         |NVE2|--|         |     |              |    |         |--|NVE4|
         +----+  +---------+     +--------------+    +---------+  +----+

         |<------ DC 1 ----->                        <---- DC2  ------>|

                 Figure 2: Data Center Interconnect with ASBR

   iBGP sessions are established between NVE1, NVE2, ASBR1, possibly via
   a BGP route-reflector. Similarly, iBGP sessions are established
   between NVE3, NVE4, ASBR2.

   eBGP sessions are established among ASBR1 and ASBR2.

   All NVEs and ASBRs are enabled for the EVPN SAFI and exchange EVPN
   routes.  For inter-AS option B, the ASBRs re-advertise these routes
   with NEXT_HOP attribute set to their IP addresses as per [RFC4271]. 

   NVE1 sets the BGP Encapsulation extended community defined in all
   EVPN routes advertised. NVE1 sets the BGP Tunnel Encapsulation
   Attribute Tunnel Type to Geneve tunnel encapsulation, and sets the
   Tunnel Encapsulation Attribute Tunnel sub-TLV for the Geneve tunnel
   option types with all the Geneve option types it can transmit and
   receive.

   All other NVE(s) learn what Geneve option types are supported by NVE1
   through the EVPN control plane. In the datapath, NVE2, NVE3 and NVE4
   only encapsulate overlay packets with the Geneve option TLV(s) that
 


Boutros                Expires December 21, 2017                [Page 5]

INTERNET DRAFT       EVPN control plane for Geneve         June 19, 2017


   NVE1 is capable of receiving.  

3.1 Negotiating TLV ordering, Size and total option length

   TBD

4. Security Considerations

   The mechanisms in this document use EVPN control plane as defined in
   [RFC7432]. Security considerations described in [RFC7432] are equally
   applicable.

   This document uses IP-based tunnel technologies to support data plane
   transport. Security considerations described in [RFC7432] and in
   [ietf-evpn-overlay] are equally applicable.

5. IANA Considerations

   IANA is requested to allocate the following:

    BGP Tunnel Encapsulation Attribute   Tunnel Type:

      XX     Geneve Encapsulation

    BGP Tunnel Encapsulation Attribute Sub-TLVs    A Code point from the
   range of 192-252 for Geneve tunnel option types sub-TLV.

6.  Acknowledgements

   The authors wish to thank T. Sridhar, for his input, feedback, and
   helpful suggestions.

7 References

7.1 Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
   Requirement Levels", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March
   1997, <http://www.rfc-editor.org/info/rfc2119>.

   [RFC7432]  Sajassi, A., Ed., Aggarwal, R., Bitar, N., Isaac, A.,
   Uttaro, J., Drake, J., and W. Henderickx, "BGP MPLS-Based Ethernet
   VPN", RFC 7432, DOI 10.17487/RFC7432, February 2015, <http://www.rfc-
   editor.org/info/rfc7432>.

   [RFC4271] Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A Border
   Gateway Protocol 4 (BGP-4)", RFC 4271, January 2006, <http://www.rfc-
   editor.org/info/rfc4271>.
 


Boutros                Expires December 21, 2017                [Page 6]

INTERNET DRAFT       EVPN control plane for Geneve         June 19, 2017


   [RFC5226]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
   IANA Considerations Section in RFCs", BCP 26, RFC 5226, May 2008,
   <http://www.rfc-editor.org/info/rfc5226>.

   [GENEVE] Gross, et al. "Geneve: Generic Network Virtualization
   Encapsulation", draft-ietf-nvo3-geneve-04, work in progress, March,
   2017.

   [DT-ENCAP] Boutros, et al. "NVO3 Encapsulation Considerations",
   draft-ietf-nvo3-encap-00, work in progress, June, 2017. 

7.2  Informative References

   [NVO3-FRWK] Lasserre et al., "Framework for DC Network
   Virtualization", RFC 7365, October 2014.

   [TUNNEL-ENCAP] Rosen et al., "The BGP Tunnel Encapsulation
   Attribute", draft-ietf-idr-tunnel-encaps-03, work in progress, May
   31, 2016.

   [ietf-evpn-overlay] Sajassi-Drake et al., "A Network Virtualization
   Overlay Solution using EVPN", draft-ietf-bess-evpn-overlay-07.txt,
   work in progress, December, 2016




Authors' Addresses


   Sami Boutros
   VMware, Inc.
   Email: sboutros@vmware.com

   Ali Sajassi
   Cisco
   Email: sajassi@cisco.com

   John Drake
   Juniper Networks
   Email: jdrake@juniper.net










Boutros                Expires December 21, 2017                [Page 7]
