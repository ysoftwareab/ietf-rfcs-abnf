Network Working Group                                       Neil Hart 
Internet Draft                                       Mustapha Aissaoui 
Expires: December 2006                                Tiberiu Grigoriu 
                                                         Matthew Bocci 
                                                                Alcatel  
                                   
 
                                      
                 VCCV Extensions for Segmented Pseudo-Wire 

                                      
                 draft-hart-pwe3-segmented-pw-vccv-00.txt 


Status of this Memo 

   By submitting this Internet-Draft, each author represents that       
   any applicable patent or other IPR claims of which he or she is       
   aware have been or will be disclosed, and any of which he or she       
   becomes aware will be disclosed, in accordance with Section 6 of       
   BCP 79. 

 

   This document may only be posted in an Internet-Draft. 

   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups.  Note that 
   other groups may also distribute working documents as Internet-
   Drafts. 

   Internet-Drafts are draft documents valid for a maximum of six months 
   and may be updated, replaced, or obsoleted by other documents at any 
   time.  It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress." 

   The list of current Internet-Drafts can be accessed at 
        http://www.ietf.org/ietf/1id-abstracts.txt 

   The list of Internet-Draft Shadow Directories can be accessed at 
        http://www.ietf.org/shadow.html 

   This Internet-Draft will expire on December 19, 2006. 

Abstract 

   This document describes extensions to Single Hop Virtual Circuit 
   Connectivity Verification (SH-VCCV) procedures for segmented pseudo 
 
 
 
Hart et al.           Expires December 19, 2006               [Page 1] 

Internet-Draft       Segmented Pseudo Wire VCCV              June 2006 
    

   wires to test the end-to-end forwarding datapath and to provide a PW 
   segment trace capability. This is accomplished by changing the 
   adaptation function for the Single Hop VCCV parameter at the 
   switching point between two distinct PW control planes. 

Table of Contents 

    
   1. Terminology.................................................2 
   2. Introduction................................................3 
      2.1. Single Hop VCCV adaptation for end to end verification...4 
         2.1.1. Inband VCCV using Control Word.....................4 
      2.2. Single Hop VCCV adaptation for partial tracing from T-PE.5 
      2.3. VCCV between S-PEs......................................5 
   3. Security Considerations......................................5 
   4. IANA Considerations.........................................5 
   5. Acknowledgments.............................................5 
      5.1. Normative References....................................6 
      5.2. Informative References..................................6 
   Author's Addresses.............................................6 
   Intellectual Property Statement.................................6 
   Disclaimer of Validity.........................................7 
   Copyright Statement............................................7 
   Acknowledgment.................................................7 
    
1. Terminology 

   - PW Terminating Provider Edge (T-PE). A PE where the customer- 
   facing attachment circuits (ACs) are bound to a PW forwarder. A 
   Terminating PE is present in the first and last segments of a MS-PW. 
   This incorporates the functionality of a PE as defined in [RFC3985].  

   - Single-Segment Pseudo Wire (SS-PW). A PW setup directly between two 
   T-PE devices. Each PW in one direction of a SS-PW traverses one PSN 
   tunnel that connects the two T-PEs.  

   - Multi-Segment Pseudo Wire (MS-PW). A static or dynamically 
   configured set of two or more contiguous PW segments that behave and 
   function as a single point-to-point PW. Each end of a MS-PW by 
   definition MUST terminate on a T-PE.  

   - PW Segment. A part of a single-segment or multi-segment PW, which 
   is set up between two PE devices, T-PEs and/or S-PEs.




 
 
Hart et al.           Expires December 19, 2006               [Page 2] 

Internet-Draft       Segmented Pseudo Wire VCCV              June 2006 
    

    - PW Switching Provider Edge (S-PE). A PE capable of switching the 
   control and data planes of the preceding and succeeding PW segments 
   in a MS-PW. The S-PE terminates the PSN tunnels of the preceding and 
   succeeding segments of the MS-PW. 

   - PW switching point for a MS-PW. A PW Switching Point is never the 
   S-PE and the T-PE for the same MS-PW. A PW switching point runs 
   necessary protocols to setup and manage PW segments with other PW 
   switching points and terminating PEs 

2. Introduction 

   Virtual Circuit Connectivity Verification (VCCV) allows network 
   operators to test the forwarding datapath of pseudo wire (PW) 
   services. As pseudo wires are extended to cover multiple segments, it 
   will be important to maintain the facility to verify the forwarding 
   datapath. Figure 1 illustrates a multi-segment pseudo wire providing 
   connectivity from T-PE1 to T-PE2 through the switching point S-PE. By 
   suitable implementation at the S-PEs, VCCV can be simply extended to 
   provide both end to end and single segment connection verification. 

              Native  |<-----------Pseudo Wire----------->|  Native 
              Layer2  |                                   |  Layer2 
             Service  |    |<-PSN1-->|     |<--PSN2->|    |  Service 
              (AC)    V    V         V     V         V    V   (AC) 
                |     +----+         +-----+         +----+     | 
      +----+    |     |    |=========|     |=========|    |     |    +----+ 
      |    |----------|........PW1.........|...PW3........|----------|    | 
      | CE1|    |     |    |         |     |         |    |     |    |CE2 | 
      |    |----------|........PW2.........|...PW4........|----------|    | 
      +----+          |    |=========|     |=========|    |          +----+ 
           ^          +----+         +-----+         +----+          ^ 
           |           T-PE1         S-PE           T-PE2            | 
           |                                                         | 
          |<------------------- Emulated Service -------->|                     
    
                          Figure 1 MS-PW Service 

   In Figure 1 T-PE1 uses the VCCV parameter included in the interface 
   parameter field of the PW ID FEC TLV or the sub-TLV interface 
   parameter of the Generalized PW ID FEC TLV to indicate to the far end 
   T-PE2 what VCCV capabilities T-PE1 supports. This is the same VCCV 
   parameter as would be used if T-PE1 and T-PE2 were connected directly 
   by T-LDP. S-PE2, which is a PW switching point, as part of the 
   adaptation function for interface parameters, processes locally the 
   VCCV parameter then passes it to T-PE2. If there were multiple S-PEs 
   on the path between T-PE1 and T-PE2, each would carry out the same 
 
 
Hart et al.           Expires December 19, 2006               [Page 3] 

Internet-Draft       Segmented Pseudo Wire VCCV              June 2006 
    

   processing, passing along the VCCV parameter. The local processing of 
   the VCCV parameter removes CC Types specified by the originating T-
   PE, except PWE3 Control Word that is passed unchanged. For example, 
   if T-PE1 indicates as supported CC Types both Control Word and Router 
   Alert then the S-PE removes the Router Alert CC Type, leaving Control 
   Word unchanged and then passes the modified VCCV parameter to the 
   next S-PE along the path. 

   The far end T-PE (T-PE2) receives the VCCV parameter indicating the 
   Control Word CC Type only if that is supported by the initial T-PE 
   (T-PE1) and all S-PEs along the PW path. 

   The method proposed in this document is a variant to the one 
   described in [PWE3-MS] which is based on defining a new VCCV sub-TLV 
   in the optional PW switching point TLV. The advantages of the 
   proposed method are that it limits the processing of the VCCV 
   messages only to the S-PE/T-PE node which is the target for the 
   message. All other S-PE nodes in between are not required to inspect 
   the VCCV CW and are only required to decrement the TTL of the PW 
   label. Furthermore, it provides a model of operation consistent with 
   the operation of MPLS LSP Ping and LSP Trace. 

2.1. Single Hop VCCV adaptation for end to end verification  

2.1.1. Inband VCCV using Control Word 

   In Figure 1, if T-PE1, S-PE and T-PE2 support Control Word for VCCV, 
   then as described in section 1 the control plane negotiates the 
   common use of Control Word for VCCV end to end.  

   At the S-PE the data path operations include an outer label pop, 
   inner label swap and new outer label push. Note that there is no 
   requirement for the S-PE to inspect the CW. 

   Thus, the end-to-end connectivity of the multi-segment pseudowire can 
   be verified by: 

   a) setting the PWE Control Word CC Type in the VCCV parameter sent 
      by each T-PE, 

   b) by each S-PE maintaining the Control Word CC Type in the VCCV 
      parameter, and 

   c) inner PW label TTL needs to be set to a large enough value to 
      allow the packet to reach the far end 


 
 
Hart et al.           Expires December 19, 2006               [Page 4] 

Internet-Draft       Segmented Pseudo Wire VCCV              June 2006 
    

   d) by the T-PE sending a VCCV packet that will follow the exact same 
      datapath at each S-PE as that taken by data packets, and that 
      will be diverted to VCCV control processing at the destination T-
      PE. 

2.2. Single Hop VCCV adaptation for partial tracing from T-PE 

   In order to trace part of the multi-segment pseudowire, the TTL of 
   the PW label may be used to force the VCCV message to 'pop out' at an 
   intermediate node. When the TTL expires, the S-PE can determine that 
   the packet is a VCCV packet by checking the control word. If the 
   control word format matches that specified in [VCCV], the packet 
   should be diverted to VCCV processing. 

   In Figure 1, if T-PE1 sends a VCCV message with the TTL of the PW 
   label equal to 1, the TTL will expire at the S-PE. T-PE1 can thus 
   verify the first segment of the pseudo wire.  

   Note that this use of the TTL is subject to the caution expressed in 
   [VCCV]. If a penultimate LSR between S-PEs or between an S-PE and a 
   T-PE manipulates the PW label TTL, the VCCV message may not emerge 
   from the MS-PW at the correct S-PE. It is also a requirement that 
   each S-PE decrement the PW label TTL correctly. 

2.3. VCCV between S-PEs 

   Assuming that all nodes along an MS-PW support the Control Word CC 
   Type, VCCV between S-PEs may be accomplished using the PW label TTL 
   as in section 2.2. In Figure-1, the S-PE may verify the path between 
   it and T-PE2 by sending a VCCV message with the PW label TTL set to 
   1. Given a more complex network with multiple S-PEs, an S-PE may 
   verify the connectivity between it and an S-PE two segments away by 
   sending a VCCV message with the PW label TTL set to 2.  

3. Security Considerations 

   Same as security concerns described in [VCCV]. 

4. IANA Considerations 

   All the values of the CC, CV and channel types are as described in 
   [VCCV].  

5. Acknowledgments 

   The authors would like to thank Vach Kompella, Kendall Harvey and 
   Michael Hua for their valuable comments and suggestions.
 
 
Hart et al.           Expires December 19, 2006               [Page 5] 

Internet-Draft       Segmented Pseudo Wire VCCV              June 2006 
    

   References 

5.1. Normative References 

   [VCCV] Nadeau, T., et al."Pseudo Wire Virtual Circuit Connection 
             Verification (VCCV)", Internet Draft 

   [PWE3-MS] Martini L., ''Segmented Pseudo Wire'', Internet Draft 

5.2. Informative References 

Author's Addresses 

   Neil Hart 
   Alcatel  
   600 March Rd  
   Kanata, ON, Canada. K2K 2E6  
   Email: neil.hart@alcatel.com  
    

   Tiberiu Grigoriu 
   Alcatel  
   600 March Rd  
   Kanata, ON, Canada. K2K 2E6  
   Email: tiberiu.grigoriu@alcatel.com  
    

   Mustapha Aissaoui  
   Alcatel  
   600 March Rd  
   Kanata, ON, Canada. K2K 2E6  
   Email: mustapha.aissaoui@alcatel.com  
    

   Matthew Bocci  
   Alcatel  
   Voyager Place, Shoppenhangers Rd  
   Maidenhead, Berks, UK SL6 2PJ  
   Email: matthew.bocci@alcatel.co.uk 
    

Intellectual Property Statement 

   The IETF takes no position regarding the validity or scope of any 
   Intellectual Property Rights or other rights that might be claimed to 
   pertain to the implementation or use of the technology described in 
 
 
Hart et al.           Expires December 19, 2006               [Page 6] 

Internet-Draft       Segmented Pseudo Wire VCCV              June 2006 
    

   this document or the extent to which any license under such rights 
   might or might not be available; nor does it represent that it has 
   made any independent effort to identify any such rights.  Information 
   on the procedures with respect to rights in RFC documents can be 
   found in BCP 78 and BCP 79. 

   Copies of IPR disclosures made to the IETF Secretariat and any 
   assurances of licenses to be made available, or the result of an 
   attempt made to obtain a general license or permission for the use of 
   such proprietary rights by implementers or users of this 
   specification can be obtained from the IETF on-line IPR repository at 
   http://www.ietf.org/ipr. 

   The IETF invites any interested party to bring to its attention any 
   copyrights, patents or patent applications, or other proprietary 
   rights that may cover technology that may be required to implement 
   this standard.  Please address the information to the IETF at 
   ietf-ipr@ietf.org. 

Disclaimer of Validity 

   This document and the information contained herein are provided on an 
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS 
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET 
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED, 
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE 
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 

Copyright Statement 

   Copyright (C) The Internet Society (2006). 

   This document is subject to the rights, licenses and restrictions 
   contained in BCP 78, and except as set forth therein, the authors 
   retain all their rights. 

Acknowledgment 

   Funding for the RFC Editor function is currently provided by the 
   Internet Society. 

    




 
 
Hart et al.           Expires December 19, 2006               [Page 7] 

