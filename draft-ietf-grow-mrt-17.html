<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>MRT routing information export format</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Specification of Requirements">
<link href="#rfc.section.2" rel="Chapter" title="2 MRT Common Header">
<link href="#rfc.section.3" rel="Chapter" title="3 Extended Timestamp MRT Header">
<link href="#rfc.section.4" rel="Chapter" title="4 MRT Types">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 OSPFv2 Type">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 TABLE_DUMP Type">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 TABLE_DUMP_V2 Type">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 PEER_INDEX_TABLE Subtype">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 AFI/SAFI specific RIB Subtypes">
<link href="#rfc.section.4.3.3" rel="Chapter" title="4.3.3 RIB_GENERIC Subtype">
<link href="#rfc.section.4.3.4" rel="Chapter" title="4.3.4 RIB Entries">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 BGP4MP Type">
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 BGP4MP_STATE_CHANGE Subtype">
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 BGP4MP_MESSAGE Subtype">
<link href="#rfc.section.4.4.3" rel="Chapter" title="4.4.3 BGP4MP_MESSAGE_AS4 Subtype">
<link href="#rfc.section.4.4.4" rel="Chapter" title="4.4.4 BGP4MP_STATE_CHANGE_AS4 Subtype">
<link href="#rfc.section.4.4.5" rel="Chapter" title="4.4.5 BGP4MP_MESSAGE_LOCAL Subtype">
<link href="#rfc.section.4.4.6" rel="Chapter" title="4.4.6 BGP4MP_MESSAGE_AS4_LOCAL Subtype">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 ISIS Type">
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 OSPFv3 Type">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Type Codes">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Subtype Codes">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Defined Type Codes">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Defined BGP, BGP4PLUS, and BGP4PLUS_01 Subtype Codes">
<link href="#rfc.section.5.5" rel="Chapter" title="5.5 Defined TABLE_DUMP Subtype Codes">
<link href="#rfc.section.5.6" rel="Chapter" title="5.6 Defined TABLE_DUMP_V2 Subtype Codes">
<link href="#rfc.section.5.7" rel="Chapter" title="5.7 Defined BGP4MP and BGP4MP_ET Subtype Codes">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A MRT Encoding Examples">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Deprecated MRT Types">
<link href="#rfc.appendix.Appendix%20B.1" rel="Chapter" title="Appendix B.1 Deprecated MRT Informational Types">
<link href="#rfc.appendix.Appendix%20B.1.1" rel="Chapter" title="Appendix B.1.1 NULL Type">
<link href="#rfc.appendix.Appendix%20B.1.2" rel="Chapter" title="Appendix B.1.2 START Type">
<link href="#rfc.appendix.Appendix%20B.1.3" rel="Chapter" title="Appendix B.1.3 DIE Type">
<link href="#rfc.appendix.Appendix%20B.1.4" rel="Chapter" title="Appendix B.1.4 I_AM_DEAD Type">
<link href="#rfc.appendix.Appendix%20B.1.5" rel="Chapter" title="Appendix B.1.5 PEER_DOWN Type">
<link href="#rfc.appendix.Appendix%20B.2" rel="Chapter" title="Appendix B.2 Other Deprecated MRT Types">
<link href="#rfc.appendix.Appendix%20B.2.1" rel="Chapter" title="Appendix B.2.1 BGP Type">
<link href="#rfc.appendix.Appendix%20B.2.1.1" rel="Chapter" title="Appendix B.2.1.1 BGP_NULL Subtype">
<link href="#rfc.appendix.Appendix%20B.2.1.2" rel="Chapter" title="Appendix B.2.1.2 BGP_UPDATE Subtype">
<link href="#rfc.appendix.Appendix%20B.2.1.3" rel="Chapter" title="Appendix B.2.1.3 BGP_PREF_UPDATE Subtype">
<link href="#rfc.appendix.Appendix%20B.2.1.4" rel="Chapter" title="Appendix B.2.1.4 BGP_STATE_CHANGE Subtype">
<link href="#rfc.appendix.Appendix%20B.2.1.5" rel="Chapter" title="Appendix B.2.1.5 BGP_SYNC Subtype">
<link href="#rfc.appendix.Appendix%20B.2.1.6" rel="Chapter" title="Appendix B.2.1.6 BGP_OPEN Subtype">
<link href="#rfc.appendix.Appendix%20B.2.1.7" rel="Chapter" title="Appendix B.2.1.7 BGP_NOTIFY Subtype">
<link href="#rfc.appendix.Appendix%20B.2.1.8" rel="Chapter" title="Appendix B.2.1.8 BGP_KEEPALIVE Subtype">
<link href="#rfc.appendix.Appendix%20B.2.2" rel="Chapter" title="Appendix B.2.2 RIP Type">
<link href="#rfc.appendix.Appendix%20B.2.3" rel="Chapter" title="Appendix B.2.3 IDRP Type">
<link href="#rfc.appendix.Appendix%20B.2.4" rel="Chapter" title="Appendix B.2.4 RIPNG Type">
<link href="#rfc.appendix.Appendix%20B.2.5" rel="Chapter" title="Appendix B.2.5 BGP4PLUS and BGP4PLUS_01 Types">
<link href="#rfc.appendix.Appendix%20B.2.6" rel="Chapter" title="Appendix B.2.6 Deprecated BGP4MP Subtypes">
<link href="#rfc.appendix.Appendix%20B.2.6.1" rel="Chapter" title="Appendix B.2.6.1 BGP4MP_ENTRY Subtype">
<link href="#rfc.appendix.Appendix%20B.2.6.2" rel="Chapter" title="Appendix B.2.6.2 BGP4MP_SNAPSHOT Subtype">
<link href="#rfc.appendix.Appendix%20C" rel="Chapter" title="Appendix C Acknowledgements">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes the MRT format for routing information export.  This format was developed in concert with the Multi-threaded Routing Toolkit (MRT) from whence the format takes it name.  The format can be used to export routing protocol messages, state changes, and routing information base contents." />
  <meta name="description" content="This document describes the MRT format for routing information export.  This format was developed in concert with the Multi-threaded Routing Toolkit (MRT) from whence the format takes it name.  The format can be used to export routing protocol messages, state changes, and routing information base contents." />
  <meta name="keywords" content="MRT" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">L. Blunk</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">M. Karir</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Merit Network</td>
</tr>
<tr>
<td class="left">Expires: February 18, 2012</td>
<td class="right">C. Labovitz</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Deepfield Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">August 17, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">MRT routing information export format<br />
  <span class="filename">draft-ietf-grow-mrt-17.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes the MRT format for routing information export.  This format was developed in concert with the Multi-threaded Routing Toolkit (MRT) from whence the format takes it name.  The format can be used to export routing protocol messages, state changes, and routing information base contents.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on February 18, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Specification of Requirements</a>
</li>
<li>2.   <a href="#rfc.section.2">MRT Common Header</a>
</li>
<li>3.   <a href="#rfc.section.3">Extended Timestamp MRT Header</a>
</li>
<li>4.   <a href="#rfc.section.4">MRT Types</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">OSPFv2 Type</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">TABLE_DUMP Type</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">TABLE_DUMP_V2 Type</a>
</li>
<li>4.3.1.   <a href="#rfc.section.4.3.1">PEER_INDEX_TABLE Subtype</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">AFI/SAFI specific RIB Subtypes</a>
</li>
<li>4.3.3.   <a href="#rfc.section.4.3.3">RIB_GENERIC Subtype</a>
</li>
<li>4.3.4.   <a href="#rfc.section.4.3.4">RIB Entries</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">BGP4MP Type</a>
</li>
<li>4.4.1.   <a href="#rfc.section.4.4.1">BGP4MP_STATE_CHANGE Subtype</a>
</li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">BGP4MP_MESSAGE Subtype</a>
</li>
<li>4.4.3.   <a href="#rfc.section.4.4.3">BGP4MP_MESSAGE_AS4 Subtype</a>
</li>
<li>4.4.4.   <a href="#rfc.section.4.4.4">BGP4MP_STATE_CHANGE_AS4 Subtype</a>
</li>
<li>4.4.5.   <a href="#rfc.section.4.4.5">BGP4MP_MESSAGE_LOCAL Subtype</a>
</li>
<li>4.4.6.   <a href="#rfc.section.4.4.6">BGP4MP_MESSAGE_AS4_LOCAL Subtype</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">ISIS Type</a>
</li>
<li>4.6.   <a href="#rfc.section.4.6">OSPFv3 Type</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Type Codes</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Subtype Codes</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Defined Type Codes</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Defined BGP, BGP4PLUS, and BGP4PLUS_01 Subtype Codes</a>
</li>
<li>5.5.   <a href="#rfc.section.5.5">Defined TABLE_DUMP Subtype Codes</a>
</li>
<li>5.6.   <a href="#rfc.section.5.6">Defined TABLE_DUMP_V2 Subtype Codes</a>
</li>
<li>5.7.   <a href="#rfc.section.5.7">Defined BGP4MP and BGP4MP_ET Subtype Codes</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">MRT Encoding Examples</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Deprecated MRT Types</a>
</li>
<li>Appendix B.1.   <a href="#rfc.appendix.Appendix%20B.1">Deprecated MRT Informational Types</a>
</li>
<li>Appendix B.1.1.   <a href="#rfc.appendix.Appendix%20B.1.1">NULL Type</a>
</li>
<li>Appendix B.1.2.   <a href="#rfc.appendix.Appendix%20B.1.2">START Type</a>
</li>
<li>Appendix B.1.3.   <a href="#rfc.appendix.Appendix%20B.1.3">DIE Type</a>
</li>
<li>Appendix B.1.4.   <a href="#rfc.appendix.Appendix%20B.1.4">I_AM_DEAD Type</a>
</li>
<li>Appendix B.1.5.   <a href="#rfc.appendix.Appendix%20B.1.5">PEER_DOWN Type</a>
</li>
<li>Appendix B.2.   <a href="#rfc.appendix.Appendix%20B.2">Other Deprecated MRT Types</a>
</li>
<li>Appendix B.2.1.   <a href="#rfc.appendix.Appendix%20B.2.1">BGP Type</a>
</li>
<li>Appendix B.2.1.1.   <a href="#rfc.appendix.Appendix%20B.2.1.1">BGP_NULL Subtype</a>
</li>
<li>Appendix B.2.1.2.   <a href="#rfc.appendix.Appendix%20B.2.1.2">BGP_UPDATE Subtype</a>
</li>
<li>Appendix B.2.1.3.   <a href="#rfc.appendix.Appendix%20B.2.1.3">BGP_PREF_UPDATE Subtype</a>
</li>
<li>Appendix B.2.1.4.   <a href="#rfc.appendix.Appendix%20B.2.1.4">BGP_STATE_CHANGE Subtype</a>
</li>
<li>Appendix B.2.1.5.   <a href="#rfc.appendix.Appendix%20B.2.1.5">BGP_SYNC Subtype</a>
</li>
<li>Appendix B.2.1.6.   <a href="#rfc.appendix.Appendix%20B.2.1.6">BGP_OPEN Subtype</a>
</li>
<li>Appendix B.2.1.7.   <a href="#rfc.appendix.Appendix%20B.2.1.7">BGP_NOTIFY Subtype</a>
</li>
<li>Appendix B.2.1.8.   <a href="#rfc.appendix.Appendix%20B.2.1.8">BGP_KEEPALIVE Subtype</a>
</li>
<li>Appendix B.2.2.   <a href="#rfc.appendix.Appendix%20B.2.2">RIP Type</a>
</li>
<li>Appendix B.2.3.   <a href="#rfc.appendix.Appendix%20B.2.3">IDRP Type</a>
</li>
<li>Appendix B.2.4.   <a href="#rfc.appendix.Appendix%20B.2.4">RIPNG Type</a>
</li>
<li>Appendix B.2.5.   <a href="#rfc.appendix.Appendix%20B.2.5">BGP4PLUS and BGP4PLUS_01 Types</a>
</li>
<li>Appendix B.2.6.   <a href="#rfc.appendix.Appendix%20B.2.6">Deprecated BGP4MP Subtypes</a>
</li>
<li>Appendix B.2.6.1.   <a href="#rfc.appendix.Appendix%20B.2.6.1">BGP4MP_ENTRY Subtype</a>
</li>
<li>Appendix B.2.6.2.   <a href="#rfc.appendix.Appendix%20B.2.6.2">BGP4MP_SNAPSHOT Subtype</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.Appendix%20C">Acknowledgements</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Researchers and engineers often wish to analyze network behavior by studying routing protocol transactions and routing information base snapshots.  To this end, the MRT record format was developed to encapsulate, export, and archive this information in a standardized data representation.</p>
<p id="rfc.section.1.p.2">The BGP routing protocol, in particular, has been the subject of extensive study and analysis which has been significantly aided by the availability of the MRT format.  Two examples of large-scale MRT based BGP archival projects include the University of Oregon Route Views Project and the RIPE NCC Routing Information Service (RIS).</p>
<p id="rfc.section.1.p.3">The MRT format was initially defined in the <a href="#MRT%20PROG%20GUIDE">MRT Programmer's Guide</a> <cite title="NONE">[MRT PROG GUIDE]</cite>.  Subsequent extensions were made in the the GNU Zebra software routing suite and the Sprint Advanced Technology Labs Python Routing Toolkit (PyRT).  Further extensions may be introduced at a later date through additional definitions of the MRT Type field and Subtype fields.</p>
<p id="rfc.section.1.p.4">A number of MRT record types listed in the <a href="#MRT%20PROG%20GUIDE">MRT Programmer's Guide</a> <cite title="NONE">[MRT PROG GUIDE]</cite> are not known to have been implemented and, in some cases, were incompletely specified.  Further, several types were employed in early MRT implementations, but saw limited use and were updated by improved versions.  These types are considered to be deprecated and are documented in the <a href="#app-deprecated">Deprecated MRT Types</a> <cite title="NONE">[app-deprecated]</cite> section at the end of this document.  The deprecated types consist of codes 0 through 10 inclusive.   Some of the deprecated types may be of interest to researchers examining historical MRT format archives.  </p>
<p id="rfc.section.1.p.5">Fields which contain multi-octet numeric values are encoded in network octet order from most significant octet to least significant octet.  Fields which contain routing message fields are encoded in the same order as they appear in the packet contents.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Specification of Requirements</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> MRT Common Header</h1>
<p id="rfc.section.2.p.1">All MRT format records have a Common Header which consists of a Timestamp, Type, Subtype, and Length field.  The header is followed by a Message field.  The MRT Common Header is illustrated below.  </p>
<div id="#rfc.figure.1"></div>
<div id="#MRTCommonHeader"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Timestamp                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |             Type              |            Subtype            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                             Length                            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Message... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.2.p.2">Header Field Descriptions: </p>

<ul class="empty">
<li>
<br> Timestamp: <ul class="empty"><li>A 4-octet field whose integer value is the number of seconds, excluding leap seconds, elapsed since midnight proleptic Coordinated Universal Time (UTC).  This representation of time is sometimes called "UNIX time" <a href="#IEEE.P1003.1-1990">POSIX</a> <cite title="NONE">[IEEE.P1003.1-1990]</cite>.  This time format cannot represent time values prior to January 1, 1970.  The latest UTC time value that can be represented by a four-octet integer value is 03:14:07 on January 19, 2038, which is represented by the hexadecimal value 7FFFFFFF.  Implementations which wish to create MRT records after this date will need to provide an alternate EPOCH time base for the Timestamp field.  Mechanisms for indicating this alternate EPOCH are currently outside the scope of this document.</li></ul>
</li>
<li>
<br> Type: <ul class="empty"><li>A 2-octet field that indicates the Type of information contained in the message field.  Types 0 through 4 are informational messages pertaining to the state of an MRT collector, while Types 5 and higher are used to convey routing information.</li></ul>
</li>
<li>
<br> Subtype: <ul class="empty"><li>A 2-octet field that is used to further distinguish message information within a particular record Type.</li></ul>
</li>
<li>
<br> Length: <ul class="empty"><li>A 4-octet message length field.  The length field contains the number of octets within the message.  The length field does not include the length of the MRT Common Header.</li></ul>
</li>
<li>
<br> Message: <ul class="empty"><li>A variable length message.  The contents of this field are context dependent upon the Type and Subtype fields.</li></ul>
</li>
</ul>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Extended Timestamp MRT Header</h1>
<p id="rfc.section.3.p.1">Several MRT format record types support a variant type with an extended timestamp field.  The purpose of this field is to support measurements at sub-second resolutions.  This field, Microsecond Timestamp, contains an unsigned 32BIT offset value in microseconds which is added to the Timestamp field value.  The Timestamp field remains as defined in the MRT Common Header.  The Microsecond Timestamp immediately follows the length field in the MRT Common Header and precedes all other fields in the message.  The Microsecond Timestamp is included in the computation of the length field value.  The Extended Timestamp MRT Header is illustrated below.</p>
<div id="#rfc.figure.2"></div>
<div id="#ExtendedTimestampMRTHeader"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Timestamp                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |             Type              |            Subtype            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                             Length                            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Microsecond Timestamp                    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Message... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> MRT Types</h1>
<p id="rfc.section.4.p.1">The following MRT Types are currently defined for the MRT format.  The MRT Types which contain the "_ET" suffix in their names identify those types which use an Extended Timestamp MRT Header.  The subtype and message fields in these types remain as defined for the MRT Types of the same name without the "_ET" suffix.  </p>
<div id="#rfc.figure.3"></div>
<pre>
    11   OSPFv2
    12   TABLE_DUMP
    13   TABLE_DUMP_V2
    16   BGP4MP
    17   BGP4MP_ET
    32   ISIS
    33   ISIS_ET
    48   OSPFv3
    49   OSPFv3_ET
</pre>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> OSPFv2 Type</h1>
<p id="rfc.section.4.1.p.1">This Type supports the OSPFv2 Protocol as defined in <a href="#RFC2328">RFC 2328</a> <cite title="NONE">[RFC2328]</cite>.  It is used to encode the exchange of OSPF protocol packets.</p>
<p id="rfc.section.4.1.p.2">The format of the MRT Message field for the OSPFv2 Type is as follows:</p>
<div id="#rfc.figure.4"></div>
<div id="#OSPFv2Type"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Remote IP address                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Local IP address                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                  OSPF Message Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.4.1.p.3">The Remote IP address field contains Source <a href="#RFC0791">IPv4</a> <cite title="NONE">[RFC0791]</cite> address from the IP header of the OSPF message.   The Local IP address contains the Destination IPv4 address from the IP header.   The OSPF Message Contents field contains the complete contents of the OSPF packet following the IP header.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> TABLE_DUMP Type</h1>
<p id="rfc.section.4.2.p.1">The TABLE_DUMP Type is used to encode the contents of a BGP Routing Information Base (RIB). Each RIB entry is encoded in a distinct sequential MRT record.  It is RECOMMENDED that new MRT encoding implementations use the TABLE_DUMP_V2 Type (see below) instead of the TABLE_DUMP Type due to limitations in this type.  However, due to the significant volume of historical data encoded with this type, MRT decoding applications MAY wish to support this type.</p>
<p id="rfc.section.4.2.p.2">The Subtype field is used to encode whether the RIB entry contains IPv4 or <a href="#RFC2460">IPv6</a> <cite title="NONE">[RFC2460]</cite> addresses.  There are two possible values for the Subtype as shown below.</p>
<div id="#rfc.figure.5"></div>
<pre>
    1    AFI_IPv4
    2    AFI_IPv6
</pre>
<p id="rfc.section.4.2.p.3">The format of the TABLE_DUMP Type is illustrated below.</p>
<div id="#rfc.figure.6"></div>
<div id="#TABLE_DUMPType"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |           View #              |       Sequence number         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Prefix (variable)                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Prefix Length |    Status     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Originated Time                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Peer IP address (variable)                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |           Peer AS             |       Attribute Length        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                   BGP Attribute... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.4.2.p.4">The View field is normally 0 and is intended for cases where an implementation may have multiple RIB views (such as a route server).  In cases where multiple RIB views are present, an implementation MAY use the the view field to distinguish entries from each view.  The Sequence field is a simple incremental counter for each RIB entry.   A typical RIB dump will exceed the 16-bit bounds of this counter and implementation SHOULD simply wrap back to zero and continue incrementing the counter in such cases.</p>
<p id="rfc.section.4.2.p.5">The Prefix field contains the IP address of a particular RIB entry.  The size of this field is dependent on the value of the Subtype for this record.  The AFI_IPv4 Subtype value specifies an <a href="#IANA-AF">Address Family</a> <cite title="NONE">[IANA-AF]</cite> Identifier (AFI) type of IPv4.  It specifies a prefix field length of 4 octets.  For AFI_IPv6, it is 16 octets in length.  The Prefix Length field indicates the length in bits of the prefix mask for the preceding Prefix field.</p>
<p id="rfc.section.4.2.p.6">The Status octet is unused in the TABLE_DUMP Type and SHOULD be set to 1.</p>
<p id="rfc.section.4.2.p.7">The Originated Time contains the 4-octet time at which this prefix was heard.  The value represents the time in seconds since 1 January 1970 00:00:00 UTC.</p>
<p id="rfc.section.4.2.p.8">The Peer IP field is the IP address of the peer which provided the update for this RIB entry.  As with the Prefix field, the size of this field is dependent on the Subtype.  AFI_IPv4 indicates a 4 octet field and an IPv4 address, while a Subtype of AFI_IPv6 requires a 16 octet field and an IPv6 address.  The Peer AS field contains the 2 octet Autonomous System (AS) number of the peer.</p>
<p id="rfc.section.4.2.p.9">The TABLE_DUMP Type does not permit 4-Byte Peer AS numbers.  Nor does it allow the AFI of the peer IP to differ from the AFI of the Prefix field.  The TABLE_DUMP_V2 Type MUST be used in these situations.</p>
<p id="rfc.section.4.2.p.10">Attribute Length contains the length of Attribute field and is 2-octets.  The BGP Attribute field contains the BGP attribute information for the RIB entry.  The AS_PATH attribute MUST only consist of 2-Byte AS numbers.  The TABLE_DUMP_V2 supports 4-Byte AS numbers in the AS_PATH attribute.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> TABLE_DUMP_V2 Type</h1>
<p id="rfc.section.4.3.p.1">The TABLE_DUMP_V2 Type updates the TABLE_DUMP Type to include 4-Byte Autonomous System Number (ASN) support and full support for BGP Multiprotocol extensions.  It also improves upon the space efficiency of the TABLE_DUMP Type by employing an index table for peers and permitting a single MRT record per Network Layer Reachability Information (NLRI) entry.  The following subtypes are used with the TABLE_DUMP_V2 Type.</p>
<div id="#rfc.figure.7"></div>
<pre>
    1    PEER_INDEX_TABLE 
    2    RIB_IPV4_UNICAST
    3    RIB_IPV4_MULTICAST
    4    RIB_IPV6_UNICAST
    5    RIB_IPV6_MULTICAST
    6    RIB_GENERIC
</pre>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> PEER_INDEX_TABLE Subtype</h1>
<p id="rfc.section.4.3.1.p.1">An initial PEER_INDEX_TABLE MRT record provides the BGP ID of the collector, an OPTIONAL view name, and a list of indexed peers.  Following the PEER_INDEX_TABLE MRT record, a series of MRT records are used to encode RIB table entries.  This series of MRT records use subtypes 2-6 and are separate from the PEER_INDEX_TABLE MRT record itself and include full MRT record headers.  The  RIB entry MRT records MUST immediately follow the PEER_INDEX_TABLE MRT record.</p>
<p id="rfc.section.4.3.1.p.2">The header of the PEER_INDEX_TABLE Subtype is shown below.   The View Name is OPTIONAL and, if not present, the View Name Length MUST be set to 0. The View Name encoding MUST follow the <a href="#RFC3629">UTF-8 transformation format</a> <cite title="NONE">[RFC3629]</cite>.</p>
<div id="#rfc.figure.8"></div>
<div id="#PEER_INDEX_TABLESubtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Collector BGP ID                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       View Name Length        |     View Name (variable)      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          Peer Count           |    Peer Entries (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.4.3.1.p.3">The format of the Peer Entries is shown below.  The PEER_INDEX_TABLE record contains Peer Count number of Peer Entries.</p>
<div id="#rfc.figure.9"></div>
<div id="#PeerEntries"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Peer Type   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer BGP ID                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                   Peer IP address (variable)                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Peer AS (variable)                     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.4.3.1.p.4">The Peer Type, Peer BGP ID, Peer IP, and Peer AS fields are repeated as indicated by the Peer Count field.  The position of the Peer in the PEER_INDEX_TABLE is used as an index in the subsequent TABLE_DUMP_V2 MRT records.  The index number begins with 0.</p>
<p id="rfc.section.4.3.1.p.5">The Peer Type field is a bit field which encodes the type of the AS and IP address as identified by the A and I bits, respectively, below.</p>
<div id="#rfc.figure.10"></div>
<div id="#PeerTypeField"></div>
<pre>
    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   | | | | | | |A|I|
   +-+-+-+-+-+-+-+-+

   Bit 6: Peer AS number size:  0 = 16 bits, 1 = 32 bits
   Bit 7: Peer IP Address family:  0 = IPv4,  1 = IPv6
</pre>
<p id="rfc.section.4.3.1.p.6">The MRT records which follow the PEER_INDEX_TABLE MRT record consist of the subtypes listed below and contain the actual RIB table entries. They include a header which specifies a sequence number, a NLRI field, and a count of the number of RIB entries contained within the record.</p>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> AFI/SAFI specific RIB Subtypes</h1>
<p id="rfc.section.4.3.2.p.1">The AFI/SAFI specific RIB Subtypes consist of the RIB_IPV4_UNICAST, RIB_IPV4_MULTICAST, RIB_IPV6_UNICAST, and RIB_IPV6_MULTICAST Subtypes.  These specific RIB table entries are given their own MRT TABLE_DUMP_V2 subtypes as they are the most common type of RIB table instances and providing specific MRT subtypes for them permits more compact encodings.  These subtypes permit a single MRT record to encode multiple RIB table entries for a single prefix. The Prefix Length and Prefix fields are encoded in the same manner as the BGP NLRI encoding for IPV4 and IPV6 prefixes.  Namely, the Prefix field contains address prefixes followed by enough trailing bits to make the end of the field fall on an octet boundary.  The value of trailing bits is irrelevant.</p>
<div id="#rfc.figure.11"></div>
<div id="#RIBEntryHeader"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Sequence number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Prefix Length |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Prefix (variable)                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    |         Entry Count           |  RIB Entries (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.section.4.3.3">
<a href="#rfc.section.4.3.3">4.3.3.</a> RIB_GENERIC Subtype</h1>
<p id="rfc.section.4.3.3.p.1">The RIB_GENERIC header is shown below.  It is used to cover RIB entries which do not fall under the common case entries defined above.  It consists of an AFI, Subsequent AFI (SAFI) and a single NLRI entry.  The NLRI information is specific to the AFI and SAFI values.  An implementation which does not recognize particular AFI and SAFI values SHOULD discard the remainder of the MRT record.</p>
<div id="#rfc.figure.12"></div>
<div id="#RIB_GENERICEntryHeader"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Sequence number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Address Family Identifier  |Subsequent AFI |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Network Layer Reachability Information (variable)         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    |         Entry Count           |  RIB Entries (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.section.4.3.4">
<a href="#rfc.section.4.3.4">4.3.4.</a> RIB Entries</h1>
<p id="rfc.section.4.3.4.p.1">The RIB Entries are repeated Entry Count times.  These entries share a common format as shown below.  They include a Peer Index from the PEER_INDEX_TABLE MRT record, an originated time for the RIB Entry, and the BGP path attribute length and attributes.  All AS numbers in the AS_PATH attribute MUST be encoded as 4-Byte AS numbers.</p>
<div id="#rfc.figure.13"></div>
<div id="#RIBEntries"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer Index            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    |                         Originated Time                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    |      Attribute Length         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP Attributes... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.4.3.4.p.2">There is one exception to the encoding of BGP attributes for the BGP MP_REACH_NLRI attribute (BGP Type Code 14) <a href="#RFC4760">RFC 4760</a> <cite title="NONE">[RFC4760]</cite>.  Since the AFI, SAFI, and NLRI information is already encoded in the MULTIPROTOCOL header, only the Next Hop Address Length and Next Hop Address fields are included.  The Reserved field is omitted.  The attribute length is also adjusted to reflect only the length of the Next Hop Address Length and Next Hop Address fields.</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> BGP4MP Type</h1>
<p id="rfc.section.4.4.p.1">This Type was initially defined in the Zebra software package for the BGP protocol with multiprotocol extension support as defined by <a href="#RFC4760">RFC 4760</a> <cite title="NONE">[RFC4760]</cite>.  The BGP4MP Type has six Subtypes which are defined as follows:</p>
<div id="#rfc.figure.14"></div>
<pre>
    0    BGP4MP_STATE_CHANGE
    1    BGP4MP_MESSAGE
    4    BGP4MP_MESSAGE_AS4
    5    BGP4MP_STATE_CHANGE_AS4
    6    BGP4MP_MESSAGE_LOCAL
    7    BGP4MP_MESSAGE_AS4_LOCAL
</pre>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<h1 id="rfc.section.4.4.1">
<a href="#rfc.section.4.4.1">4.4.1.</a> BGP4MP_STATE_CHANGE Subtype</h1>
<p id="rfc.section.4.4.1.p.1">This message is used to encode state changes in the BGP finite state machine.  The BGP Finite State Machine (FSM) states are encoded in the Old State and New State fields to indicate the previous and current state.  In some cases, the Peer AS number may be undefined.  In such cases, the value of this field MAY be set to zero.  The format is illustrated below:</p>
<div id="#rfc.figure.15"></div>
<div id="#BGP4MP_STATE_CHANGESubtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |        Local AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Old State          |          New State            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br> The FSM states are defined in <a href="#RFC4271">RFC 4271</a> <cite title="NONE">[RFC4271]</cite>, Section 8.2.2.  Both the old state value and the new state value are encoded as 2-octet numbers.  The state values are defined numerically as follows:</p>
<div id="#rfc.figure.16"></div>
<pre>
    1    Idle     
    2    Connect
    3    Active
    4    OpenSent
    5    OpenConfirm
    6    Established
</pre>
<p id="rfc.section.4.4.1.p.3">The BGP4MP_STATE_CHANGE message also includes interface index and Address Family fields.  The interface index provides the interface number of the peering session.  The index value is OPTIONAL and MAY be zero if unknown or unsupported.  The Address Family indicates what types of addresses are in the the address fields.  At present, the following AFI Types are supported:</p>
<div id="#rfc.figure.17"></div>
<pre>
    1    AFI_IPv4
    2    AFI_IPv6
</pre>
<h1 id="rfc.section.4.4.2">
<a href="#rfc.section.4.4.2">4.4.2.</a> BGP4MP_MESSAGE Subtype</h1>
<p id="rfc.section.4.4.2.p.1">This Subtype is used to encode BGP messages.  It can be used to encode any Type of BGP message.  The entire BGP message is encapsulated in the BGP Message field, including the 16-octet marker, the 2-octet length, and the 1-octet type fields.  The BGP4MP_MESSAGE Subtype does not support 4-Byte AS numbers.  The AS_PATH contained in these messages MUST only consist of 2-Byte AS numbers.  The BGP4MP_MESSAGE_AS4 Subtype updates the BGP4MP_MESSAGE Subtype in order to support 4-Byte AS numbers. The BGP4MP_MESSAGE fields are shown below:</p>
<div id="#rfc.figure.18"></div>
<div id="#BGP4MP_MESSAGESubtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |        Local AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP Message... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.4.4.2.p.2">The interface index provides the interface number of the peering session.  The index value is OPTIONAL and MAY be zero if unknown or unsupported.  The Address Family indicates what types of addresses are in the the subsequent address fields.  At present, the following AFI Types are supported:</p>
<div id="#rfc.figure.19"></div>
<pre>
    1    AFI_IPv4
    2    AFI_IPv6
</pre>
<p id="rfc.section.4.4.2.p.3">The Address Family value only applies to the IP addresses contained in the MRT header.  The BGP4MP_MESSAGE Subtype is otherwise transparent to the contents of the actual message which may contain any valid AFI/SAFI values.  Only one BGP message SHALL be encoded in the BGP4MP_MESSAGE Subtype.</p>
<h1 id="rfc.section.4.4.3">
<a href="#rfc.section.4.4.3">4.4.3.</a> BGP4MP_MESSAGE_AS4 Subtype</h1>
<p id="rfc.section.4.4.3.p.1">This Subtype updates the BGP4MP_MESSAGE Subtype to support 4-Byte AS numbers.  The BGP4MP_MESSAGE_AS4 Subtype is otherwise identical to the BGP4MP_MESSAGE Subtype.  The AS_PATH in these messages MUST only consist of 4-Byte AS numbers.  The BGP4MP_MESSAGE_AS4 fields are shown below:</p>
<div id="#rfc.figure.20"></div>
<div id="#BGP4MP_MESSAGE_AS4Subtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer AS number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Local AS number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP Message... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.section.4.4.4">
<a href="#rfc.section.4.4.4">4.4.4.</a> BGP4MP_STATE_CHANGE_AS4 Subtype</h1>
<p id="rfc.section.4.4.4.p.1">This Subtype updates the BGP4MP_STATE_CHANGE Subtype to support 4-Byte AS numbers.  As with the BGP4MP_STATE_CHANGE Subtype, the BGP FSM states are encoded in the Old State and New State fields to indicate the previous and current state.  Aside from the extension of the peer and local AS fields to 4-Bytes, this subtype is otherwise identical to the BGP4MP_STATE_CHANGE Subtype.  The BGP4MP_STATE_CHANGE_AS4 fields are shown below:</p>
<div id="#rfc.figure.21"></div>
<div id="#BGP4MP_STATE_CHANGE_AS4Subtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer AS number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Local AS number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Old State          |          New State            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.section.4.4.5">
<a href="#rfc.section.4.4.5">4.4.5.</a> BGP4MP_MESSAGE_LOCAL Subtype</h1>
<p id="rfc.section.4.4.5.p.1">Implementations of MRT have largely focused on collecting remotely generated BGP messages in a passive route collector role.  However, for active BGP implementations, it can be useful to archive locally generated BGP messages in addition to remote messages.   This subtype is added to indicated a locally generated BGP message.   The fields remain identical to the BGP4MP_MESSAGE type including the Peer and Local IP and AS fields.   The Local fields continue to refer to the local IP and AS number of the collector which generated the BGP message and the Peer IP and AS fields refer to the recipient of the generated BGP messages.</p>
<h1 id="rfc.section.4.4.6">
<a href="#rfc.section.4.4.6">4.4.6.</a> BGP4MP_MESSAGE_AS4_LOCAL Subtype</h1>
<p id="rfc.section.4.4.6.p.1">As with the BGP4MP_MESSAGE_LOCAL type, this type indicate locally generated messages.  The fields are identical to the BGP4MP_MESSAGE_AS4 message type.  </p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> ISIS Type</h1>
<p id="rfc.section.4.5.p.1">This Type supports the IS-IS routing protocol as defined in <a href="#RFC1195">RFC 1195</a> <cite title="NONE">[RFC1195]</cite>.  There is no Type specific header for the ISIS Type.  The Subtype code for this Type is undefined.  The ISIS PDU directly follows the MRT Common Header fields.</p>
<h1 id="rfc.section.4.6">
<a href="#rfc.section.4.6">4.6.</a> OSPFv3 Type</h1>
<div id="#rfc.figure.22"></div>
<div id="#OSPFv3Type"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                     Remote IP address (variable)              | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                  OSPF Message Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.4.6.p.1">The OSPFv3 Type extends the original OSPFv2 Type to support IPv6 addresses for the OSPFv3 protocol as defined in <a href="#RFC5340">RFC 5340</a> <cite title="NONE">[RFC5340]</cite>.  The format of the MRT Message field for the OSPFv3 Type is as follows: </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> IANA Considerations</h1>
<p id="rfc.section.5.p.1">This section provides guidance to the Internet Assigned Numbers Authority (IANA) regarding registration of values related to the MRT specification, in accordance with BCP 26, <a href="#RFC5226">RFC 5226</a> <cite title="NONE">[RFC5226]</cite>.</p>
<p id="rfc.section.5.p.2">There are two name spaces in MRT that require registration: Type Codes and Subtype Codes.   Type Codes and Subtype Codes are each 16 bits in length.</p>
<p id="rfc.section.5.p.3">MRT is not intended as a general-purpose specification for protocol information export, and allocations should not be made for purposes unrelated to routing protocol information export.</p>
<p id="rfc.section.5.p.4">The following policies are used here with the meanings defined in BCP 26: "Specification Required", "IETF Consensus", "Experimental Use", "First Come First Served".  Assignments consist of a name and the value.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Type Codes</h1>
<p id="rfc.section.5.1.p.1">Type Codes have a range from 0 to 65535, of which 0-64 are reserved.  New Type Codes MUST be allocated starting at 65.  Type Codes 65 - 511 are to be assigned by IETF Review.  Type Codes 512 - 2047 are assigned based on Specification Required. Type Codes 2048 - 64511 are available on a First Come First Served policy.  Type Codes 64512 - 65534 are available for Experimental Use.  The Type Code Value 65535 is reserved.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Subtype Codes</h1>
<p id="rfc.section.5.2.p.1">Subtype Codes have a range from 0 to 65535.  Subtype definitions are specific to a particular Type Code definition.  New Subtype Code definitions must reference an existing Type Code to which the Subtype belongs.  Subtype assignments follow the assignment rules for the Type Codes to which they belong.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Defined Type Codes</h1>
<p id="rfc.section.5.3.p.1">This document defines the following message Type Codes:</p>
<div id="#rfc.figure.23"></div>
<pre>
         Name             Value       Definition
         ----             -----       ----------
         NULL             0           See Section B.1.1
         START            1           See Section B.1.2
         DIE              2           See Section B.1.3
         I_AM_DEAD        3           See Section B.1.4
         PEER_DOWN        4           See Section B.1.5
         BGP              5           See Section B.2.1
         RIP              6           See Section B.2.2
         IDRP             7           See Section B.2.3
         RIPNG            8           See Section B.2.4
         BGP4PLUS         9           See Section B.2.5
         BGP4PLUS_01      10          See Section B.2.5
         OSPFv2           11          See Section 4.1
         TABLE_DUMP       12          See Section 4.2
         TABLE_DUMP_v2    13          See Section 4.3
         BGP4MP           16          See Section 4.4
         BGP4MP_ET        17          See Section 4.4
         ISIS             32          See Section 4.5
         ISIS_ET          33          See Section 4.5
         OSPFv3           48          See Section 4.6
         OSPFv3_ET        49          See Section 4.6
</pre>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> Defined BGP, BGP4PLUS, and BGP4PLUS_01 Subtype Codes</h1>
<p id="rfc.section.5.4.p.1">This document defines the following message Subtype Codes for the BGP, BGP4PLUS, and BGP4PLUS_01 Types:</p>
<div id="#rfc.figure.24"></div>
<pre>
         Name               Value       Definition
         ----               -----       ----------
         BGP_NULL           0           See Section B.2.1
         BGP_UPDATE         1           See Section B.2.1
         BGP_PREF_UPDATE    2           See Section B.2.1
         BGP_STATE_CHANGE   3           See Section B.2.1
         BGP_SYNC           4           See Section B.2.1
         BGP_OPEN           5           See Section B.2.1
         BGP_NOTIFY         6           See Section B.2.1
         BGP_KEEPALIVE      7           See Section B.2.1
</pre>
<h1 id="rfc.section.5.5">
<a href="#rfc.section.5.5">5.5.</a> Defined TABLE_DUMP Subtype Codes</h1>
<p id="rfc.section.5.5.p.1">This document defines the following message Subtype Codes for the TABLE_DUMP Type:</p>
<div id="#rfc.figure.25"></div>
<pre>
         Name                Value       Definition
         ----                -----       ----------
         AFI_IPv4            1           See Section 4.2
         AFI_IPv6            2           See Section 4.2
</pre>
<h1 id="rfc.section.5.6">
<a href="#rfc.section.5.6">5.6.</a> Defined TABLE_DUMP_V2 Subtype Codes</h1>
<p id="rfc.section.5.6.p.1">This document defines the following message Subtype Codes for the TABLE_DUMP_V2 Type:</p>
<div id="#rfc.figure.26"></div>
<pre>
         Name                Value       Definition
         ----                -----       ----------
         PEER_INDEX_TABLE    1           See Section 4.3
         RIB_IPV4_UNICAST    2           See Section 4.3
         RIB_IPV4_MULTICAST  3           See Section 4.3
         RIB_IPV6_UNICAST    4           See Section 4.3
         RIB_IPV6_MULTICAST  5           See Section 4.3
         RIB_GENERIC         6           See Section 4.3
</pre>
<h1 id="rfc.section.5.7">
<a href="#rfc.section.5.7">5.7.</a> Defined BGP4MP and BGP4MP_ET Subtype Codes</h1>
<p id="rfc.section.5.7.p.1">This document defines the following message Subtype Codes for the BGP4MP Type:</p>
<div id="#rfc.figure.27"></div>
<pre>
         Name                     Value       Definition
         ----                     -----       ----------
         BGP4MP_STATE_CHANGE      0           See Section 4.4
         BGP4MP_MESSAGE           1           See Section 4.4
         BGP4MP_ENTRY             2           See Section 4.4
         BGP4MP_SNAPSHOT          3           See Section 4.4
         BGP4MP_MESSAGE_AS4       4           See Section 4.4
         BGP4MP_STATE_CHANGE_AS4  5           See Section 4.4
         BGP4MP_MESSAGE_LOCAL     6           See Section 4.4
         BGP4MP_MESSAGE_AS4_LOCAL 7           See Section 4.4
</pre>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Security Considerations</h1>
<p id="rfc.section.6.p.1">The MRT Format utilizes a structure which can store routing protocol information data.  The fields defined in the MRT specification are of a descriptive nature and provide information that is useful to facilitate the analysis of routing data.  As such, the fields currently defined in the MRT specification do not in themselves create additional security risks, since the fields are not used to induce any particular behavior by the recipient application.</p>
<p id="rfc.section.6.p.2">Some information contained in an MRT data structure might be considered sensitive or private.  For example, a BGP peer that sends a message to an MRT-enabled router might not expect that message to be shared beyond the AS to which it is sent.</p>
<p id="rfc.section.6.p.3">Information that could be considered sensitive include BGP peer IP addresses, BGP Next Hop IP addresses, and BGP Path Attributes.  Such information could be useful to mount attacks against the BGP protocol and routing infrastructure.  <a href="#RFC4272">RFC 4272</a> <cite title="NONE">[RFC4272]</cite> examines a number of weaknesses in the BGP protocol which could potentially be exploited.</p>
<p id="rfc.section.6.p.4">An organization that intends to use the MRT structure to export routing information beyond the domain where it normally accessible (e.g., publishing MRT dumps for use by researchers) should verify with any peers whose information might be included, and possibly remove sensitive fields.</p>
<p id="rfc.section.6.p.5">The proposed geolocation extension to MRT could reveal the location of an MRT router's peers [I- D.ietf-grow-geomrt].</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="IANA-AF">[IANA-AF]</b></td>
<td class="top">
<a>Address Family Numbers</a>", .</td>, "</tr>
<tr>
<td class="reference"><b id="RFC0791">[RFC0791]</b></td>
<td class="top">
<a title="University of Southern California (USC)/Information Sciences Institute">Postel, J.</a>, "<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>", STD 5, RFC 791, September 1981.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1195">[RFC1195]</b></td>
<td class="top">
<a title="Digital Equipment Corporation (DEC)">Callon, R.</a>, "<a href="http://tools.ietf.org/html/rfc1195">Use of OSI IS-IS for routing in TCP/IP and dual environments</a>", RFC 1195, December 1990.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2328">[RFC2328]</b></td>
<td class="top">
<a href="mailto:jmoy@casc.com" title="Ascend Communications, Inc.">Moy, J.</a>, "<a href="http://tools.ietf.org/html/rfc2328">OSPF Version 2</a>", STD 54, RFC 2328, April 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2460">[RFC2460]</b></td>
<td class="top">
<a href="mailto:deering@cisco.com" title="Cisco Systems, Inc.">Deering, S.E.</a> and <a href="mailto:hinden@iprg.nokia.com" title="Nokia">R.M. Hinden</a>, "<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>", RFC 2460, December 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3629">[RFC3629]</b></td>
<td class="top">
<a>Yergeau, F.</a>, "<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>", STD 63, RFC 3629, November 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4271">[RFC4271]</b></td>
<td class="top">
<a>Rekhter, Y.</a>, <a>Li, T.</a> and <a>S. Hares</a>, "<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>", RFC 4271, January 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4760">[RFC4760]</b></td>
<td class="top">
<a>Bates, T.</a>, <a>Chandra, R.</a>, <a>Katz, D.</a> and <a>Y. Rekhter</a>, "<a href="http://tools.ietf.org/html/rfc4760">Multiprotocol Extensions for BGP-4</a>", RFC 4760, January 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5340">[RFC5340]</b></td>
<td class="top">
<a>Coltun, R.</a>, <a>Ferguson, D.</a>, <a>Moy, J.</a> and <a>A. Lindem</a>, "<a href="http://tools.ietf.org/html/rfc5340">OSPF for IPv6</a>", RFC 5340, July 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2080">[RFC2080]</b></td>
<td class="top">
<a href="mailto:gmalkin@Xylogics.COM" title="Xylogics, Inc.">Malkin, G.</a> and <a href="mailto:minnear@ipsilon.com" title="Ipsilon Networks, Inc.">R. Minnear</a>, "<a href="http://tools.ietf.org/html/rfc2080">RIPng for IPv6</a>", RFC 2080, January 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2453">[RFC2453]</b></td>
<td class="top">
<a href="mailto:gmalkin@baynetworks.com" title="Bay Networks">Malkin, G.S.</a>, "<a href="http://tools.ietf.org/html/rfc2453">RIP Version 2</a>", STD 56, RFC 2453, November 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4272">[RFC4272]</b></td>
<td class="top">
<a>Murphy, S.</a>, "<a href="http://tools.ietf.org/html/rfc4272">BGP Security Vulnerabilities Analysis</a>", RFC 4272, January 2006.</td>
</tr>
<tr>
<td class="reference"><b id="MRT PROG GUIDE">[MRT PROG GUIDE]</b></td>
<td class="top">
<a href="mailto:labovit@deepfield.net" title="Deepfield Networks">Labovitz, C</a>, "<a>MRT Programmer's Guide</a>", November 1999.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE.P1003.1-1990">[IEEE.P1003.1-1990]</b></td>
<td class="top">
<a>Institute of Electrical and Electronics Engineers</a>, "<a>P1003.1, Information Technology Portable Operating System Interface (POSIX) Part 1: System Application Program Interface (API) [C Language], 1990.</a>", IEEE Standard P1003.1, .</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#mrt-examples" id="mrt-examples">MRT Encoding Examples</a>
</h1>
<p id="rfc.section.Appendix A.p.1">This appendix, which is not a normative reference, contains MRT encoding examples.</p>
<p id="rfc.section.Appendix A.p.2">The following example shows the encoding for a MRT record type of BGP4MP and subtype BGP4MP_MESSAGE_AS4.  The Peer AS and Local AS numbers are encoded in 4 bytes fields due to the use of the BGP4MP_MESSAGE_AS4 subtype.  The encoded BGP Update is shown in hexadecimal.  The AS numbers in the ASPATH in the BGP Update are encoded as 4 byte values in accord with the MRT BGP4MP_MESSAGE_AS4 subtype.</p>
<div id="#rfc.figure.28"></div>
<div id="#MRTFormatExample1"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Timestamp = 1300475700 epoch sec (2011-03-18 19:15:00)     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          Type = 16            |         Subtype = 4           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Length = 82                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer AS = 64496                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Local AS = 64497                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Interface Index = 0       |     Address Family  = 1       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                Peer IP address = 192.0.2.85                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |               Local IP address = 198.51.100.4                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  BGP Update = 

             ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
             00 3e 02 00 00 00 1f 40 01 01 02 40 02 0e 02 03
             00 00 fb f0 00 00 fb ff 00 00 fb f6 40 03 04 c6
             33 64 55 c0 08 04 fb f0 00 0e 18 cb 00 71
</pre>
<p id="rfc.section.Appendix A.p.3">The contents of the BGP Update Message above are as follows:</p>
<div id="#rfc.figure.29"></div>
<div id="#BGPMessageExample"></div>
<pre>
  ORIGIN: INCOMPLETE
  ASPATH: 64496 64511 64502
  NEXT_HOP: 198.51.100.188
  COMMUNITY: 64496:14
  NLRI: 203.0.113.0/24
</pre>
<p id="rfc.section.Appendix A.p.4">The following example displays the encoding for a MRT record type of TABLE_DUMP_V2 and subtype PEER_INDEX_TABLE.  The table in this example contains 2 entries.</p>
<div id="#rfc.figure.30"></div>
<div id="#MRTFormatExample2"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Timestamp = 1300475700 epoch sec (2011-03-18 19:15:00)     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          Type = 13            |         Subtype = 1           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Length = 34                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |               Collector BGP ID = 198.51.100.4                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     View Name Length = 0      |       Peer Count = 2          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Peer Type = 2  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                   Peer BGP ID  = 198.51.100.5                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                 Peer IP address = 198.51.100.5                |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Peer AS = 65541                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Peer Type = 2  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                   Peer BGP ID  = 192.0.2.33                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                 Peer IP address = 192.0.2.33                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Peer AS = 65542                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.Appendix A.p.5">The following example displays the encoding for a MRT record type of TABLE_DUMP_V2 and subtype RIB_IPV6_UNICAST.  This entry applies to the NLRI prefix of 2001:0DB8::/32.  There is a single entry for this prefix.   The entry applies to the peer identified by index location 15 in a preceding MRT PEER_INDEX_TABLE record.</p>
<div id="#rfc.figure.31"></div>
<div id="#MRTFormatExample3"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Timestamp = 1300475700 epoch sec (2011-03-18 19:15:00)     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          Type = 13            |         Subtype = 4           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Length = 87                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Sequence number = 42                     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Preflen = 32  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                 Prefix  =  2001:0DB8::/32                     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Entry Count = 1            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Peer Index =  15           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Originated Time = 1300475700 epoch sec (2011-03-18 19:15:00)   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Attribute Length  =  68     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   BGP Path Attributes =

           40 01 01 00 50 02 00 0e 02 03 00 00 fb f0 00 00
           fb ff 00 00 fb f6 80 0e 2b 00 02 01 20 20 01 0d
           b8 00 0d 00 ff 00 00 00 00 00 00 01 87 fe 80 00
           00 00 00 00 00 02 12 f2 ff fe 9f 1b 00 00 00 20
           20 01 0d b8
</pre>
<p id="rfc.section.Appendix A.p.6">The contents of the BGP Path Attribute field above are as follows:</p>
<div id="#rfc.figure.32"></div>
<div id="#BGPPathAttributeContents"></div>
<pre>
ORIGIN: IGP
ASPATH: 64496 64511 64502
MP_REACH_NLRI(IPv6 Unicast)
NEXT_HOP: 2001:db8:d:ff::187
NEXT_HOP: fe80::212:f2ff:fe9f:1b00
NLRI: 2001:0DB8::/32
</pre>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> <a href="#app-deprecated" id="app-deprecated">Deprecated MRT Types</a>
</h1>
<p id="rfc.section.Appendix B.p.1">This Appendix lists deprecated MRT types.  These types are documented for informational purposes.</p>
<h1 id="rfc.appendix.Appendix B.1">
<a href="#rfc.appendix.Appendix%20B.1">Appendix B.1.</a> Deprecated MRT Informational Types</h1>
<p id="rfc.section.Appendix B.1.p.1">The initial MRT format defined five Informational Type records.  These records were intended to signal the state of an MRT data collector and do not contain routing information.  These records were intended for use when MRT records were sent over a network to a remote repository store.  However, MRT record repository stores have traditionally resided on the same device as the collector and these Informational Types are not known to be implemented.  Further, transport mechanisms for MRT records are considered to be outside the scope of this document.</p>
<p id="rfc.section.Appendix B.1.p.2">The message field MAY contain an OPTIONAL string for diagnostic purposes. The message string encoding MUST follow the <a href="#RFC3629">UTF-8 transformation format</a> <cite title="NONE">[RFC3629]</cite>.  The Subtype field is unused for these Types and SHOULD be set to 0.</p>
<p id="rfc.section.Appendix B.1.p.3">The MRT Informational Types are defined below:</p>
<div id="#rfc.figure.33"></div>
<pre>
    0    NULL 
    1    START
    2    DIE
    3    I_AM_DEAD
    4    PEER_DOWN
</pre>
<h1 id="rfc.appendix.Appendix B.1.1">
<a href="#rfc.appendix.Appendix%20B.1.1">Appendix B.1.1.</a> NULL Type</h1>
<p id="rfc.section.Appendix B.1.1.p.1">The NULL Type message causes no operation.</p>
<h1 id="rfc.appendix.Appendix B.1.2">
<a href="#rfc.appendix.Appendix%20B.1.2">Appendix B.1.2.</a> START Type</h1>
<p id="rfc.section.Appendix B.1.2.p.1">The START Type indicates a collector is about to begin generating MRT records.</p>
<h1 id="rfc.appendix.Appendix B.1.3">
<a href="#rfc.appendix.Appendix%20B.1.3">Appendix B.1.3.</a> DIE Type</h1>
<p id="rfc.section.Appendix B.1.3.p.1">The DIE Type signals a remote MRT repository it SHOULD stop accepting messages.</p>
<h1 id="rfc.appendix.Appendix B.1.4">
<a href="#rfc.appendix.Appendix%20B.1.4">Appendix B.1.4.</a> I_AM_DEAD Type</h1>
<p id="rfc.section.Appendix B.1.4.p.1">An I_AM_DEAD MRT record indicates that a collector has shut down and has stopped generating MRT records.</p>
<h1 id="rfc.appendix.Appendix B.1.5">
<a href="#rfc.appendix.Appendix%20B.1.5">Appendix B.1.5.</a> PEER_DOWN Type</h1>
<p id="rfc.section.Appendix B.1.5.p.1">The PEER_DOWN message was intended to indicate that a collector had lost association with a BGP peer.  However, the MRT format provides BGP state change message types which duplicate this functionality.</p>
<h1 id="rfc.appendix.Appendix B.2">
<a href="#rfc.appendix.Appendix%20B.2">Appendix B.2.</a> Other Deprecated MRT Types</h1>
<div id="#rfc.figure.34"></div>
<pre>
    5    BGP 
    6    RIP
    7    IDRP
    8    RIPNG
    9    BGP4PLUS
    10   BGP4PLUS_01
</pre>
<h1 id="rfc.appendix.Appendix B.2.1">
<a href="#rfc.appendix.Appendix%20B.2.1">Appendix B.2.1.</a> BGP Type</h1>
<p id="rfc.section.Appendix B.2.1.p.1">The BGP Type indicates the Message field contains BGP routing information.  The BGP routing protocol is defined in <a href="#RFC4271">RFC 4271</a> <cite title="NONE">[RFC4271]</cite>.  The information in the message is dependent on the Subtype value.  The BGP Type and all associated Subtypes below are considered to be deprecated by the BGP4MP Type.</p>
<p id="rfc.section.Appendix B.2.1.p.2">The following BGP Subtypes are defined for the MRT BGP Type.  As with the BGP Type itself, they are all considered to be deprecated.  </p>
<div id="#rfc.figure.35"></div>
<pre>
    0    BGP_NULL
    1    BGP_UPDATE
    2    BGP_PREF_UPDATE
    3    BGP_STATE_CHANGE
    4    BGP_SYNC
    5    BGP_OPEN
    6    BGP_NOTIFY
    7    BGP_KEEPALIVE
</pre>
<h1 id="rfc.appendix.Appendix B.2.1.1">
<a href="#rfc.appendix.Appendix%20B.2.1.1">Appendix B.2.1.1.</a> BGP_NULL Subtype</h1>
<p id="rfc.section.Appendix B.2.1.1.p.1">The BGP_NULL Subtype is a reserved Subtype.</p>
<h1 id="rfc.appendix.Appendix B.2.1.2">
<a href="#rfc.appendix.Appendix%20B.2.1.2">Appendix B.2.1.2.</a> BGP_UPDATE Subtype</h1>
<p id="rfc.section.Appendix B.2.1.2.p.1">The BGP_UPDATE Subtype is used to encode BGP UPDATE messages. The format of the MRT Message field for this Subtype is as follows:</p>
<div id="#rfc.figure.36"></div>
<div id="#BGP_UPDATESubtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer IP address                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Local AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Local IP address                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP UPDATE Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.Appendix B.2.1.2.p.2">The BGP UPDATE Contents include the entire BGP UPDATE message which follows the BGP Message Header.  The BGP Message Header itself is not included.  The Peer AS number and IP address fields contain the AS number and IP address of the remote system which are generating the BGP UPDATE messages.  The Local AS number and IP address fields contain the AS number and IP address of the local collector system which is archiving the messages.  </p>
<h1 id="rfc.appendix.Appendix B.2.1.3">
<a href="#rfc.appendix.Appendix%20B.2.1.3">Appendix B.2.1.3.</a> BGP_PREF_UPDATE Subtype</h1>
<p id="rfc.section.Appendix B.2.1.3.p.1">The BGP_PREF_UPDATE Subtype is not defined.</p>
<h1 id="rfc.appendix.Appendix B.2.1.4">
<a href="#rfc.appendix.Appendix%20B.2.1.4">Appendix B.2.1.4.</a> BGP_STATE_CHANGE Subtype</h1>
<p id="rfc.section.Appendix B.2.1.4.p.1">The BGP_STATE_CHANGE Subtype is used to reflect changes in the BGP finite state machine.  These FSM states are defined in <a href="#RFC4271">RFC 4271</a> <cite title="NONE">[RFC4271]</cite>, Section 8.2.2.  Both the old state value and the new state value are encoded as 2-octet numbers.  The state values are defined numerically as follows:</p>
<div id="#rfc.figure.37"></div>
<pre>
    1    Idle     
    2    Connect
    3    Active
    4    OpenSent
    5    OpenConfirm
    6    Established
</pre>
<p id="rfc.section.Appendix B.2.1.4.p.2">The format of the BGP_STATE_CHANGE Subtype MRT Message field is as follows:</p>
<div id="#rfc.figure.38"></div>
<div id="#BGP_STATE_CHANGESubtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Peer IP address                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Old State          |          New State            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.appendix.Appendix B.2.1.5">
<a href="#rfc.appendix.Appendix%20B.2.1.5">Appendix B.2.1.5.</a> BGP_SYNC Subtype</h1>
<p id="rfc.section.Appendix B.2.1.5.p.1">The BGP_SYNC Subtype was intended to convey a system file name where BGP Table Dump messages MAY be recorded.  The View # was to correspond to the View # provided in the TABLE_DUMP Type records.  There are no known implementations of this subtype and it SHOULD be ignored.  The following format applies to this Subtype:</p>
<div id="#rfc.figure.39"></div>
<div id="#BGP_SYNCSubtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        View #                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            File Name... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.Appendix B.2.1.5.p.2">The File Name is terminated with a NULL (0) character.</p>
<h1 id="rfc.appendix.Appendix B.2.1.6">
<a href="#rfc.appendix.Appendix%20B.2.1.6">Appendix B.2.1.6.</a> BGP_OPEN Subtype</h1>
<p id="rfc.section.Appendix B.2.1.6.p.1">The BGP_OPEN Subtype is used to encode BGP OPEN messages. The format of the MRT Message field for this Subtype is the same as the BGP_UPDATE, however, the last field contains the contents of the BGP OPEN message.  </p>
<h1 id="rfc.appendix.Appendix B.2.1.7">
<a href="#rfc.appendix.Appendix%20B.2.1.7">Appendix B.2.1.7.</a> BGP_NOTIFY Subtype</h1>
<p id="rfc.section.Appendix B.2.1.7.p.1">The BGP_NOTIFY Subtype is used to encode BGP NOTIFICATION messages. The format of the MRT Message field for this Subtype is the same as the BGP_UPDATE, however, the last field contains the contents of the BGP NOTIFICATION message.  </p>
<h1 id="rfc.appendix.Appendix B.2.1.8">
<a href="#rfc.appendix.Appendix%20B.2.1.8">Appendix B.2.1.8.</a> BGP_KEEPALIVE Subtype</h1>
<p id="rfc.section.Appendix B.2.1.8.p.1">The BGP_KEEPALIVE Subtype is used to encode BGP KEEPALIVE messages.  The format of the MRT Message field for this Subtype is the same as the BGP_UPDATE, however, the last field contains no information.</p>
<h1 id="rfc.appendix.Appendix B.2.2">
<a href="#rfc.appendix.Appendix%20B.2.2">Appendix B.2.2.</a> RIP Type</h1>
<p id="rfc.section.Appendix B.2.2.p.1">The RIP Type is used to export RIP protocol packets as defined in <a href="#RFC2453">RFC 2453</a> <cite title="NONE">[RFC2453]</cite>.  The Subtype field is currently reserved for this Type and SHOULD be set to 0.</p>
<p id="rfc.section.Appendix B.2.2.p.2">The format of the MRT Message field for the RIP Type is as follows:</p>
<div id="#rfc.figure.40"></div>
<div id="#RIPType"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer IP address                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Local IP address                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    RIP Message Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.appendix.Appendix B.2.3">
<a href="#rfc.appendix.Appendix%20B.2.3">Appendix B.2.3.</a> IDRP Type</h1>
<p id="rfc.section.Appendix B.2.3.p.1">The IDRP Type was intended to be used to export Inter-Domain-Routing Protocol (IDRP) protocol information as defined in the ISO/IEC 10747 standard.  However, this Type has seen no known use and there are no details on protocol encoding for this Type.</p>
<h1 id="rfc.appendix.Appendix B.2.4">
<a href="#rfc.appendix.Appendix%20B.2.4">Appendix B.2.4.</a> RIPNG Type</h1>
<p id="rfc.section.Appendix B.2.4.p.1">The RIPNG Type is used to export RIPNG protocol packets as defined in <a href="#RFC2080">RFC 2080</a> <cite title="NONE">[RFC2080]</cite>.  The RIPNG protocol updates the RIP protocol to support IPv6.   The Subtype field is currently reserved for this Type and SHOULD be set to 0.</p>
<p id="rfc.section.Appendix B.2.4.p.2">The format of the MRT Message field for the RIPNG Type is as follows:</p>
<div id="#rfc.figure.41"></div>
<div id="#RIPNGType"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    ~                        Peer IPv6 address                      ~
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    ~                        Local IPv6 address                     ~
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                  RIPNG Message Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.appendix.Appendix B.2.5">
<a href="#rfc.appendix.Appendix%20B.2.5">Appendix B.2.5.</a> BGP4PLUS and BGP4PLUS_01 Types</h1>
<p id="rfc.section.Appendix B.2.5.p.1">The BGP4PLUS and BGP4PLUS_01 Types were defined to support IPv6 BGP routing information.  The BGP4PLUS Type was specified based on the initial Internet Draft for Multiprotocol Extensions to BGP-4.  The BGP4PLUS_01 Type was specified to correspond to the -01 revision of this Internet Draft.  The two Types share the same definitions in terms of their MRT format specifications.</p>
<p id="rfc.section.Appendix B.2.5.p.2">The Subtype field definitions are shared with the BGP Type, however, the address fields in the BGP_UPDATE, BGP_OPEN, BGP_NOTIFY, BGP_KEEPALIVE, and BGP_STATE_CHANGE Subtype records are extended to 16 octets for IPv6 addresses.  As with the BGP Type, the BGP4PLUS and BGP4PLUS_01 Types are deprecated as they superseded by the BGP4MP Type.</p>
<h1 id="rfc.appendix.Appendix B.2.6">
<a href="#rfc.appendix.Appendix%20B.2.6">Appendix B.2.6.</a> Deprecated BGP4MP Subtypes</h1>
<p id="rfc.section.Appendix B.2.6.p.1">The following two subtypes of the BGP4MP Type are considered to be deprecated.</p>
<div id="#rfc.figure.42"></div>
<pre>
    2    BGP4MP_ENTRY
    3    BGP4MP_SNAPSHOT
</pre>
<h1 id="rfc.appendix.Appendix B.2.6.1">
<a href="#rfc.appendix.Appendix%20B.2.6.1">Appendix B.2.6.1.</a> BGP4MP_ENTRY Subtype</h1>
<p id="rfc.section.Appendix B.2.6.1.p.1">This Subtype is similar to the TABLE_DUMP Type and is used to record RIB table entries. It was intended to include true multiprotocol support.  However, this Subtype does not support 4-Byte AS numbers and has not been widely implemented.  </p>
<div id="#rfc.figure.43"></div>
<div id="#BGP4MP_ENTRYSubtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |        Local AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              | 
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |           View #              |             Status            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Time last change                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Address Family         |    SAFI       | Next-Hop-Len  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                     Next Hop Address (variable)               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Prefix Length  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                     Address Prefix (variable)                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       Attribute Length        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP Attribute... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.appendix.Appendix B.2.6.2">
<a href="#rfc.appendix.Appendix%20B.2.6.2">Appendix B.2.6.2.</a> BGP4MP_SNAPSHOT Subtype</h1>
<p id="rfc.section.Appendix B.2.6.2.p.1">This Subtype was intended to convey a system file name where BGP4MP_ENTRY records MAY be recorded.  It is similar to the BGP_SYNC Subtype and is deprecated.  </p>
<div id="#rfc.figure.44"></div>
<div id="#BGP4MP_SNAPSHOTSubtype"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        View #                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            File Name... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<h1 id="rfc.appendix.Appendix C">
<a href="#rfc.appendix.Appendix%20C">Appendix C.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.Appendix C.p.1">The initial MRT specification was developed by Craig Labovitz for use in the Multi-thread Routing Toolkit (MRT) project.   The BGP4MP Type was introduced in the Zebra routing software project by Kunihiro Ishiguro.  The BGP4MP_ET, ISIS, and ISIS_ET Types were defined in the Python Routeing Toolkit (PyRT) developed by Richard Mortier while at Sprint Advanced Technology Labs.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Larry Blunk</span> 
	  <span class="n hidden">
		<span class="family-name">Blunk</span>
	  </span>
	</span>
	<span class="org vcardline">Merit Network</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ljb@merit.edu">ljb@merit.edu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Manish Karir</span> 
	  <span class="n hidden">
		<span class="family-name">Karir</span>
	  </span>
	</span>
	<span class="org vcardline">Merit Network</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mkarir@merit.edu">mkarir@merit.edu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Craig Labovitz</span> 
	  <span class="n hidden">
		<span class="family-name">Labovitz</span>
	  </span>
	</span>
	<span class="org vcardline">Deepfield Networks</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:labovit@deepfield.net">labovit@deepfield.net</a></span>

  </address>
</div>

</body>
</html>