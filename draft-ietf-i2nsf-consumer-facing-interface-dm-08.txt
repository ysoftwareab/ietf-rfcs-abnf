



I2NSF Working Group                                             J. Jeong
Internet-Draft                                                  C. Chung
Intended status: Standards Track                 Sungkyunkwan University
Expires: September 12, 2020                                       T. Ahn
                                                           Korea Telecom
                                                                R. Kumar
                                                        Juniper Networks
                                                                S. Hares
                                                                  Huawei
                                                          March 11, 2020


            I2NSF Consumer-Facing Interface YANG Data Model
            draft-ietf-i2nsf-consumer-facing-interface-dm-08

Abstract

   This document describes an information model and a YANG data model
   for the Consumer-Facing Interface between an Interface to Network
   Security Functions (I2NSF) User and Security Controller in an I2NSF
   system in a Network Functions Virtualization (NFV) environment.  The
   information model defines various types of managed objects and the
   relationship among them needed to build the interface.  The
   information model is organized based on the "Event-Condition-Action"
   (ECA) policy model defined by a capability information model for
   I2NSF [i2nsf-capability-im], and the data model is defined for
   enabling different users of a given I2NSF system to define, manage,
   and monitor security policies for specific flows within an
   administrative domain.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 12, 2020.





Jeong, et al.          Expires September 12, 2020               [Page 1]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Requirements Language . . . . . . . . . . . . . . . . . . . .   5
   3.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   5
   4.  Information Model for Policy  . . . . . . . . . . . . . . . .   5
     4.1.  Event Sub-model . . . . . . . . . . . . . . . . . . . . .   7
     4.2.  Condition Sub-model . . . . . . . . . . . . . . . . . . .   8
     4.3.  Action Sub-model  . . . . . . . . . . . . . . . . . . . .   9
   5.  Information Model for Policy Endpoint Groups  . . . . . . . .  10
     5.1.  User Group  . . . . . . . . . . . . . . . . . . . . . . .  10
     5.2.  Device Group  . . . . . . . . . . . . . . . . . . . . . .  11
     5.3.  Location Group  . . . . . . . . . . . . . . . . . . . . .  12
   6.  Information Model for Threat Prevention . . . . . . . . . . .  13
     6.1.  Threat Feed . . . . . . . . . . . . . . . . . . . . . . .  13
     6.2.  Payload Content . . . . . . . . . . . . . . . . . . . . .  14
   7.  Network Configuration Access Control Model (NACM) . . . . . .  15
   8.  YANG Data Model of Consumer-Facing Interface  . . . . . . . .  15
   9.  XML Configuration Examples of High-Level Security Policy
       Rules . . . . . . . . . . . . . . . . . . . . . . . . . . . .  36
     9.1.  Database Registration: Information of Positions and
           Devices       (Endpoint Group)  . . . . . . . . . . . . .  36
     9.2.  Scenario 1: Block SNS Access during Business Hours  . . .  37
     9.3.  Scenario 2: Block Malicious VoIP/VoLTE Packets Coming to
           a Company . . . . . . . . . . . . . . . . . . . . . . . .  39
     9.4.  Scenario 3: Mitigate HTTP and HTTPS Flood Attacks on a
           Company Web Server  . . . . . . . . . . . . . . . . . . .  40
   10. Security Considerations . . . . . . . . . . . . . . . . . . .  42
   11. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  42
   12. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  42
   13. Contributors  . . . . . . . . . . . . . . . . . . . . . . . .  42
   14. References  . . . . . . . . . . . . . . . . . . . . . . . . .  44
     14.1.  Normative References . . . . . . . . . . . . . . . . . .  44



Jeong, et al.          Expires September 12, 2020               [Page 2]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


     14.2.  Informative References . . . . . . . . . . . . . . . . .  45
   Appendix A.  Changes from draft-ietf-i2nsf-consumer-facing-
                interface-dm-07  . . . . . . . . . . . . . . . . . .  47
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  47

1.  Introduction

   In a framework of Interface to Network Security Functions (I2NSF),
   each vendor can register their NSFs using a Developer's Management
   System (DMS).  Assuming that vendors also provide the front-end web
   applications registered with an I2NSF User, the Consumer-Facing
   Interface is required because the web applications developed by each
   vendor need to have a standard interface specifying the data types
   used when the I2NSF User and Security Controller communicate using
   this interface.  Therefore, this document specifies the required
   information, their data types, and encoding schemes so that high-
   level security policies (or configuration information for security
   policies) can be transferred to the Security Controller through the
   Consumer-Facing Interface.  These policies can easily be translated
   by the Security Controller into low-level security policies.  The
   Security Controller delivers the translated policies to Network
   Security Functions (NSFs) according to their respective security
   capabilities for the required securiy enforcement.

   The Consumer-Facing Interface would be built using a set of objects,
   with each object capturing a unique set of information from Security
   Administrator (i.e., I2NSF User [RFC8329]) needed to express a
   Security Policy.  An object may have relationship with various other
   objects to express a complete set of requirements.  An information
   model captures the managed objects and relationship among these
   objects.  The information model proposed in this document is
   structured in accordance with the "Event-Condition-Action" (ECA)
   policy model.

   An NSF Capability model is proposed in [i2nsf-capability-im] as the
   basic model for both the NSF-Facing interface and Consumer-Facing
   Interface security policy model of this document.

   [RFC3444] explains differences between an information and data model.
   This document uses the guidelines in [RFC3444] to define both the
   information and data model for Consumer-Facing Interface.  Figure 1
   shows a high-level abstraction of Consumer-Facing Interface.  A data
   model, which represents an implementation of the information model in
   a specific data representation language, is also defined in this
   document.






Jeong, et al.          Expires September 12, 2020               [Page 3]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


                       +-----------------+    +-----------------+
                       | Consumer-Facing |    | Consumer-Facing |
                       |    Interface    +--->+    Interface    |
                       |Information Model|    |    Data Model   |
                       +--------+--------+    +-----------------+
                                ^
                                |
                                +-------------+------------+
                                |             |            |
                          +-----+----+  +-----+----+  +----+----+
                          |  Policy  |  | Endpoint |  | Threat  |
                          |          |  |  groups  |  |  feed   |
                          +-----+----+  +----------+  +---------+
                                ^
                                |
                         +------+------+
                         |     Rule    |
                         +------+------+
                                ^
                                |
               +----------------+----------------+
               |                |                |
        +------+------+  +------+------+  +------+------+
        |    Event    |  |  Condition  |  |    Action   |
        +-------------+  +-------------+  +-------------+


      Figure 1: Diagram for High-level Abstraction of Consumer-Facing
                                 Interface

   Data models are defined at a lower level of abstraction and provide
   many details.  They provide details about the implementation of a
   protocol's specification, e.g., rules that explain how to map managed
   objects onto lower-level protocol constructs.  Since conceptual
   models can be implemented in different ways, multiple data models can
   be derived from a single information model.

   The efficient and flexible provisioning of network functions by a
   Network Functions Virtualization (NFV) system leads to a rapid
   advance in the network industry.  As practical applications, Network
   Security Functions (NSFs), such as firewall, Intrusion Detection
   System (IDS)/Intrusion Prevention System (IPS), and attack
   mitigation, can also be provided as Virtual Network Functions (VNF)
   in the NFV system.  By the efficient virtualization technology, these
   VNFs might be automatically provisioned and dynamically migrated
   based on real-time security requirements.  This document presents a
   YANG data model to implement security functions based on NFV.




Jeong, et al.          Expires September 12, 2020               [Page 4]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC3444]
   RFC8174 [RFC8174].

3.  Terminology

   This document uses the terminology described in [i2nsf-terminology]
   [client-facing-inf-req].

   This document follows the guidelines of [RFC8407], uses the common
   YANG types defined in [RFC6991], and adopts the Network Management
   Datastore Architecture (NMDA).  The meaning of the symbols in tree
   diagrams is defined in [RFC8340].

4.  Information Model for Policy

   A Policy object represents a mechanism to express a Security Policy
   by Security Administrator (i.e., I2NSF User) using Consumer-Facing
   Interface toward Security Controller; the policy would be enforced on
   an NSF.  Figure 2 shows the YANG tree of the Policy object.  The
   Policy object SHALL have the following information:

      Name:  This field identifies the name of this object.

      Owners:  This field contains the owners of the policy.  For
             example, the owners who created it, and can modify it.
             This field represents multiple groups owning as owners,
             having full CRUD privileges by default.  Note that it is
             assumed that a factory-default owner (e.g., root) is
             defined and preconfigured in Security Controller in order
             to create new policy objects at first.

      Rule:  This field contains a list of rules.  These rules are
             defined for 1) communication between two Endpoint Groups,
             2) for preventing communication with externally or
             internally identified threats, and 3) for implementing
             business requirement such as controlling access to internal
             or external resources for meeting regulatory compliance or
             business objectives.  An organization may restrict certain
             communication between a set of user and applications for
             example.  The threats may be from threat feeds obtained
             from external sources or dynamically identified by using
             specialty devices in the network.  Rule conflict analysis
             should be triggered by the monitoring service to perform an




Jeong, et al.          Expires September 12, 2020               [Page 5]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


             exhaustive detection of anomalies among the configuration
             rules installed into the security functions.

           +--rw i2nsf-cfi-policy* [policy-name]
              +--rw policy-name          string
              |  uses owners-ref
              |  +--rw rules* [rule-name]
              +--rw endpoint-groups
              +--rw threat-prevention


                      Figure 2: Policy YANG Data Tree

   A policy is a container of Rule(s).  In order to express a Rule, a
   Rule must have complete information such as where and when a policy
   needs to be applied.  This is done by defining a set of managed
   objects and relationship among them.  A Policy Rule may be related
   segmentation, threat mitigation or telemetry data collection from an
   NSF in the network, which will be specified as the sub-model of the
   policy model in the subsequent sections.  Figure 3 shows the YANG
   data tree of the Rule object.  The rule object SHALL have the
   following information:

      Name:  This field identifies the name of this object.

      Owners:  This field contains the owners of the rule.  For example,
             the owners who created it, and can modify it.  This field
             represents multiple groups owning as owners, having full
             CRUD privileges by default.

      Event: This field includes the information to determine whether
             the Rule Condition can be evaluated or not.  See details in
             Section 4.1.

      Condition:  This field contains all the checking conditions to
             apply to the objective traffic.  See details in
             Section 4.2.

      Action:  This field identifies the action taken when a rule is
             matched.  There is always an implicit action to drop
             traffic if no rule is matched for a traffic type.  See
             details in Section 4.3.

      IPsec-Method:  This field contains the information about IPsec
             method type.  There are two types such as IPsec-IKE and
             IPsec-IKEless [i2nsf-ipsec].





Jeong, et al.          Expires September 12, 2020               [Page 6]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


           +--rw rules* [rule-name]
              +--rw rule-name                        string
              |  uses owners-ref
              +--rw event
              +--rw (condition)?
              +--rw action
              +--rw ipsec-method


                       Figure 3: Rule YANG Data Tree

   Note that in the case of policy conflicts, the resolution of the
   conflicted policies conforms to the guidelines of "Information Model
   of NSFs Capabilities" [i2nsf-capability-im].

4.1.  Event Sub-model

   The Event Object contains information related to scheduling a Rule.
   The Rule could be activated based on a set time or security event.
   Figure 4 shows the YANG tree of the Event object.  Event object SHALL
   have following information:

      Security-event:  This field identifies for which security event
             the policy is enforced.  The examples of security events
             are: "DDOS", "spyware", "trojan", and "ransomware".

      Enforce-type:  This field identifies whether the event of
             triggering policy enforcement is "Admin" or "Time".

      Admin: This represents the enforcement type based on admin's
             decision.

      Time:  This represents the security rule is enforced based on
             begin-time and end-time information.

      Frequency:  This represents how frequent the rule should be
             enforced.  There are four options: "only-once", "daily",
             "weekly" and "monthly".













Jeong, et al.          Expires September 12, 2020               [Page 7]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


           +--rw event
              +--rw security-event            identityref
              +--rw (enforce-type)?
              |  +--:(admin)
              |  |  +--rw admin?
              |  +--:(time)
              |     +--rw time-information
              |        +--rw begin-time?   date-and-time
              |        +--rw end-time?      date-and-time
              +--rw frequency?                enumeration


                 Figure 4: Event Sub-model YANG Data Tree

4.2.  Condition Sub-model

   This object represents Conditions that Security Administrator wants
   to apply the checking on the traffic in order to determine whether
   the set of actions in the Rule can be executed or not.  The Condition
   Sub-model consists of three different types of containers each
   representing different cases, such as general firewall and DDoS-
   mitigation cases, and a case when the condition is based on the
   payload strings of packets.  Each containers have source and
   destination-target to represent the source and destination for each
   case.  Figure 5 shows the YANG tree of the Condition object.  The
   Condition Sub-model SHALL have following information:

      Case (Firewall-condition):  This field represents the general
             firewall case, where a security admin can set up firewall
             conditions using the information present in this field.
             The source and destination is represented as firewall-
             source and firewall-destination, each referring to the IP-
             address-based groups defined in the endpoint-groups.

      Case (DDoS-condition):  This field represents the condition for
             DDoS mitigation, where a security admin can set up DDoS
             mitigation conditions using the information present in this
             field.  The source and destination is represented as ddos-
             source and ddos-destination, each referring to the device-
             groups defined and registered in the endpoint-groups.

      Case (Custom-condition):  This field contains the payload string
             information.  This information is useful when security rule
             condition is based on the string contents of incoming or
             outgoing packets.  The source and destination is
             represented as custom-source and custom-destination, each
             referring to the payload-groups defined and registered in
             the endpoint-groups.



Jeong, et al.          Expires September 12, 2020               [Page 8]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      Case (Threat-feed-condition):  This field contains the information
             obtained from threat-feeds (e.g., Palo-Alto, or RSA-
             netwitness).  This information is useful when security rule
             condition is based on the existing threat reports gathered
             by other sources.  The source and destination is
             represented as threat-feed-source and threat-feed-
             destination.  For clarity, threat-feed-source/destination
             represent the source/destination of a target security
             threat, not the information source/destination of a threat-
             feed.

           +--rw (condition)?
              +--:(firewall-condition)
              |  +--rw source  -> /../../nacm:group/nacm:user-name
              |  +--rw dest-target* -> /../../nacm:group/nacm:user-name
              +--:(ddos-condition)
              |  +--rw source* -> /../../device-group/name
              |  +--rw dest-target* -> /../../device-group/name
              |  +--rw rate-limit
              +--:(custom-condition)
              |  +--rw source* -> /../../payload-content/name
              |  +--rw dest-target  -> /../../payload-content/name
              +--:(threat-feed-condition)
                 +--rw source* -> /../../threat-feed-list/name
                 +--rw dest-target  -> /../../threat-feed-list/name


               Figure 5: Condition Sub-model YANG Data Tree

4.3.  Action Sub-model

   This object represents actions that Security Admin wants to perform
   based on certain traffic class.  Figure 6 shows the YANG tree of the
   Action object.  The Action object SHALL have following information:

      Primary-action:  This field identifies the action when a rule is
             matched by an NSF.  The action could be one of "PASS",
             "DROP", "ALERT", "RATE-LIMIT", and "MIRROR".

      Secondary-action:  This field identifies the action when a rule is
             matched by an NSF.  The action could be one of "log",
             "syslog", "session-log".









Jeong, et al.          Expires September 12, 2020               [Page 9]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


           +--rw action
              +--rw primary-action      identityref
              +--rw secondary-action?   identityref


                 Figure 6: Action Sub-model YANG Data Tree

5.  Information Model for Policy Endpoint Groups

   The Policy Endpoint Group is a very important part of building User-
   Construct based policies.  A Security Administrator would create and
   use these objects to represent a logical entity in their business
   environment, where a Security Policy is to be applied.  There are
   multiple managed objects that constitute a Policy's Endpoint Group as
   shown in Figure 7.  Figure 8 shows the YANG tree of the Endpoint-
   Groups object.  This section lists these objects and relationship
   among them.

                      +-------------------+
                      |  Endpoint Groups  |
                      +---------+---------+
                                ^
                                |
                 +--------------+----------------+
          1..n   |      1..n    |       1..n     |
           +-----+----+  +------+-----+  +-------+------+
           |User-group|  |Device-group|  |Location-group|
           +----------+  +------------+  +--------------+


                     Figure 7: Endpoint Group Diagram

           +--rw endpoint-groups
              +--rw user-group* [name]
                           ...
              +--rw device-group* [name]
                           ...
              +--rw location-group* [name]
                           ...


                  Figure 8: Endpoint Group YANG Data Tree

5.1.  User Group

   This object represents a User-Group.  Figure 9 shows the YANG tree of
   the User-Group object.  The User-Group object SHALL have the
   following information:



Jeong, et al.          Expires September 12, 2020              [Page 10]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      Name:  This field identifies the name of this object.

      IP-address:  This represents the IPv4 address of a user in the
             user group.

      range-ipv4-address:  This represents the IPv4 address of a user in
             the user gorup.

      range-ipv6-address:  This represents the IPv6 address of a user in
             the user gorup.

        +--rw user-group* [name]
           +--rw name -> /../../nacm:group/nacm:user-name
           +--rw (match-type)?
              +--:(exact-match-ipv4)
              |  +--rw ipv4-address*            inet:ipv4-address
              +--:(exact-match-ipv6)
              |  +--rw ipv6-address*            inet:ipv6-address
              +--:(range-match-ipv4)
              |  +--rw range-ipv4-address*
                                  [start-ipv4-address end-ipv4-address]
              |     +--rw start-ipv4-address    inet:ipv4-address
              |     +--rw end-ipv4-address      inet:ipv4-address
              +--:(range-match-ipv6)
                 +--rw range-ipv6-address*
                                  [start-ipv6-vaddress end-ipv6-address]
                    +--rw start-ipv6-address    inet:ipv6-address
                    +--rw end-ipv6-address      inet:ipv6-address


                    Figure 9: User Group YANG Data Tree

5.2.  Device Group

   This object represents a Device-Group.  Figure 10 shows the YANG tree
   of the Device-group object.  The Device-Group object SHALL have the
   following information:

      Name:  This field identifies the name of this object.

      IP-address:  This represents the IPv4 address of a device in the
             device group.

      range-ipv4-address:  This represents the IPv4 address of a device
             in the device gorup.

      range-ipv6-address:  This represents the IPv6 address of a device
             in the device gorup.



Jeong, et al.          Expires September 12, 2020              [Page 11]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      Protocol:  This represents the communication protocols used by the
             devices.  The protocols are "SSH", "FTP", "SMTP", "HTTP",
             "HTTPS", and etc.

          +--rw device-group* [name]
             +--rw name                         string
             +--rw (match-type)?
             |  +--:(exact-match-ipv4)
             |  |  +--rw ipv4-address*            inet:ipv4-address
             |  +--:(exact-match-ipv6)
             |  |  +--rw ipv6-address*            inet:ipv6-address
             |  +--:(range-match-ipv4)
             |  |  +--rw range-ipv4-address*
                                  [start-ipv4-address end-ipv4-address]
             |  |     +--rw start-ipv4-address    inet:ipv4-address
             |  |     +--rw end-ipv4-address      inet:ipv4-address
             |  +--:(range-match-ipv6)
             |     +--rw range-ipv6-address*
                                  [start-ipv6-vaddress end-ipv6-address]
             |        +--rw start-ipv6-address    inet:ipv6-address
             |        +--rw end-ipv6-address      inet:ipv6-address
             +--rw protocol                       identityref


                  Figure 10: Device Group YANG Data Tree

5.3.  Location Group

   This object represents a location group based on either tag or other
   information.  Figure 11 shows the YANG tree of the Location-Group
   object.  The Location-Group object SHALL have the following
   information:

      Name:  This field identifies the name of this object.

      geo-ip-ipv4:  This field represents the IPv4 Geo-ip of a location.

      geo-ip-ipv6:  This field represents the IPv6 Geo-ip of a location.

      continent:  This field represents the continent where the location
             group member is at.










Jeong, et al.          Expires September 12, 2020              [Page 12]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


           +--rw location-group* [name]
              +--rw name           string
              +--rw geo-ip-ipv4    inet:ipv4-address
              +--rw geo-ip-ipv6    inet:ipv6-address
              +--rw continent?     identityref


                 Figure 11: Location Group YANG Data Tree

6.  Information Model for Threat Prevention

   The threat prevention plays an important part in the overall security
   posture by reducing the attack surfaces.  This information could come
   from various threat feeds (i.e., sources for obtaining the threat
   information).  There are multiple managed objects that constitute
   this category.  This section lists these objects and relationship
   among them.  Figure 13 shows the YANG tree of a Threat-Prevention
   object.

                            +-------------------+
                            | Threat Prevention |
                            +---------+---------+
                                      ^
                                      |
                            +---------+---------+
                    1..n    |         1..n      |
                     +------+------+   +--------+--------+
                     | Threat-feed |   | payload-content |
                     +-------------+   +-----------------+


                   Figure 12: Threat Prevention Diagram

           +--rw threat-prevention
              +--rw threat-feed-list* [name]
                           ...
              +--rw payload-content* [name]
                           ...


                Figure 13: Threat Prevention YANG Data Tree

6.1.  Threat Feed

   This object represents a threat feed which provides signatures of
   malicious activities.  Figure 14 shows the YANG tree of a Threat-
   feed-list.  The Threat-Feed object SHALL have the following
   information:



Jeong, et al.          Expires September 12, 2020              [Page 13]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      name:  This field identifies the name of this object.

      Server-ipv4:  This represents the IPv4 server address of the feed
             provider, it may be external or local servers.

      Server-ipv6:  This represents the IPv6 server address of the feed
             provider, it may be external or local servers.

      description:  This is the description of the threat feed.  The
             descriptions should have clear indication of the security
             attack such as attack type (e.g., APT) and file types used
             (e.g., executable malware).

      Threat-file-types:  This field identifies the information about
             the file types identified and reported by the threat-feed.

      signatures:  This field contains the signatures of malicious
             programs or activities provided by the threat-feed.  The
             examples of signature types are "YARA", "SURICATA", and
             "SNORT".

           +--rw threat-prevention
              +--rw threat-feed-list* [name]
                 +--rw name              identityref
                 +--rw server-ipv4?      inet:ipv4-address
                 +--rw server-ipv6?      inet:ipv6-address
                 +--rw description?      string
                 +--rw threat-file-types*     identityref
                 +--rw signatures*            identityref


                   Figure 14: Threat Feed YANG Data Tree

6.2.  Payload Content

   This object represents a custom list created for the purpose of
   defining exception to threat feeds.  Figure 15 shows the YANG tree of
   a Payload-content list.  The Payload-Content object SHALL have the
   following information:

      Name:  This field identifies the name of this object.  For
             example, the name "backdoor" indicates the payload content
             is related to backdoor attack.

      description:  This represents the description of how the payload
             content is related to a security attack.





Jeong, et al.          Expires September 12, 2020              [Page 14]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      Content:  This contains the payload contents, which are involed in
             a security attack, as strings.

           +--rw payload-content* [name]
              +--rw name                   string
              +--rw description    string
              +--rw content*               string


               Figure 15: Payload Content in YANG Data Tree

7.  Network Configuration Access Control Model (NACM)

   Network Configuration Access Control Model (NACM) provides a high-
   level overview of the access control with the following features
   [RFC8341]:

   o  Independent control of action, data, and notification access is
      provided.

   o  A simple and familiar set of datastore permissions is used.

   o  Support for YANG security tagging allows default security modes to
      automatically exclude sensitive data.

   o  Separate default access modes for read, write, and execute
      permissions are provided.

   o  Access control rules are applied to configurable groups of users.

   The data model for the I2NSF Consumer-Facing Interface provides NACM
   mechanisms and concepts to user-group and owners permissions.  The
   NACM with the above features can be used to set up all the management
   access controls in the I2NSF high-level authorization view, and it
   may have a high impact on the optimization and performance.

8.  YANG Data Model of Consumer-Facing Interface

   The main objective of this data model is to provide both an
   information model and the corresponding YANG data model of I2NSF
   Consumer-Facing Interface.  This interface can be used to deliver
   control and management messages between an I2NSF User and Security
   Controller for the I2NSF User's high-level security policies.

   The semantics of the data model must be aligned with the information
   model of the Consumer-Facing Interface.  The transformation of the
   information model was performed so that this YANG data model can




Jeong, et al.          Expires September 12, 2020              [Page 15]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


   facilitate the efficient delivery of the control or management
   messages.

   This data model is designed to support the I2NSF framework that can
   be extended according to the security needs.  In other words, the
   model design is independent of the content and meaning of specific
   policies as well as the implementation approach.  This document
   suggests a VoIP/VoLTE security service as a use case for policy rule
   generation.

   This section describes a YANG data model for Consumer-Facing
   Interface, based on the information model of Consumer-Facing
   Interface to Security Controller.

<CODE BEGINS> file "ietf-i2nsf-cfi-policy@2020-03-11.yang"

module ietf-i2nsf-cfi-policy {
  yang-version 1.1;
  namespace
    "urn:ietf:params:xml:ns:yang:ietf-i2nsf-cfi-policy";
  prefix
    cfi-policy;

  import ietf-inet-types{
    prefix inet;
    reference "Section 4 of RFC 6991";
  }

  import ietf-netconf-acm {
    prefix nacm;
  }

  organization
    "IETF I2NSF (Interface to Network Security Functions)
     Working Group";

  contact
    "WG Web: <http://tools.ietf.org/wg/i2nsf>
     WG List: <mailto:i2nsf@ietf.org>

     WG Chair: Linda Dunbar
     <mailto:linda.dunbar@futurewei.com>

     WG Chair: Yoav Nir
     <mailto:ynir.ietf@gmail.com>

     Editor: Jaehoon Paul Jeong
     <mailto:pauljeong@skku.edu>



Jeong, et al.          Expires September 12, 2020              [Page 16]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


     Editor: Chaehong Chung
     <mailto:darkhong@skku.edu>";

  description
    "This module is a YANG module for Consumer-Facing Interface.
    Copyright (c) 2020 IETF Trust and the persons
    identified as authors of the code. All rights reserved.
    Redistribution and use in source and binary forms, with or
    without modification, is permitted pursuant to, and subject
    to the license terms contained in, the Simplified BSD License
    set forth in Section 4.c of the IETF Trust's Legal Provisions
    Relating to IETF Documents
    (http://trustee.ietf.org/license-info).
    This version of this YANG module is part of RFC XXXX; see
    the RFC itself for full legal notices.";

  revision "2020-03-11"{
    description "The latest revision";
    reference
      "draft-ietf-consumer-facing-interface-dm-07";
  }

  identity malware-file-type {
    description
      "Base identity for malware file types.";
  }

  identity executable-file {
    base malware-file-type;
    description
      "Identity for executable file types.";
  }

  identity doc-file {
    base malware-file-type;
    description
      "Identity for Microsoft document file types.";
  }

  identity html-app-file {
    base malware-file-type;
    description
      "Identity for html application file types.";
  }

  identity javascript-file {
    base malware-file-type;
    description



Jeong, et al.          Expires September 12, 2020              [Page 17]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      "Identity for Javascript file types.";
  }

  identity pdf-file {
    base malware-file-type;
    description
      "Identity for pdf file types.";
  }

  identity dll-file {
    base malware-file-type;
    description
      "Identity for dll file types.";
  }

  identity msi-file {
    base malware-file-type;
    description
      "Identity for Microsoft installer file types.";
  }

  identity security-event-type {
    description
      "Base identity for security event types.";
  }

  identity ddos {
    description
      "Identity for DDoS event types.";
  }

  identity spyware {
    base malware-file-type;
    description
      "Identity for spyware event types.";
  }

  identity trojan {
    base malware-file-type;
    description
      "Identity for Trojan infection event types.";
  }

  identity ransomware {
    base malware-file-type;
    description
      "Identity for ransomware infection event types.";
  }



Jeong, et al.          Expires September 12, 2020              [Page 18]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


  identity i2nsf-ipsec {
    description
      "Base identity for IPsec method types.";
    reference
      "draft-ietf-i2nsf-sdn-ipsec-flow-protection-07";
  }

  identity ipsec-ike {
    base i2nsf-ipsec;
    description
      "Identity for ipsec-ike.";
    reference
      "draft-ietf-i2nsf-sdn-ipsec-flow-protection-07";
  }

  identity ipsec-ikeless {
    base i2nsf-ipsec;
    description
      "Identity for ipsec-ikeless.";
    reference
      "draft-ietf-i2nsf-sdn-ipsec-flow-protection-07";
  }

  identity continent {
    description
      "Base Identity for continent types.";
  }

  identity africa {
    base continent;
    description
      "Identity for africa.";
  }

  identity asia {
    base continent;
    description
      "Identity for asia.";
  }

  identity europe {
    base continent;
    description
      "Identity for europe.";
  }

  identity north-america {
    base continent;



Jeong, et al.          Expires September 12, 2020              [Page 19]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


    description
      "Identity for north-america.";
  }

  identity south-america {
    base continent;
    description
      "Identity for south-america.";
  }

  identity oceania {
    base continent;
    description
      "Identity for Oceania";
  }

  identity enforce-type {
    description
      "This identity represents the event of
      policy enforcement trigger type.";
  }

  identity admin {
    description
      "The identity for policy enforcement by admin.";
  }

  identity time {
    description
      "The identity for policy enforcement based on time.";
  }

  identity protocol-type {
    description
      "This identity represents the protocol types.";
  }

  identity ftp {
    base protocol-type;
    description
      "The identity for ftp protocol.";
    reference
      "RFC 959: File Transfer Protocol (FTP)";
  }

  identity ssh {
    base protocol-type;
    description



Jeong, et al.          Expires September 12, 2020              [Page 20]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      "The identity for ssh protocol.";
    reference
      "RFC 4250: The Secure Shell (SSH) Protocol";
  }

  identity telnet {
    base protocol-type;
    description
      "The identity for telnet.";
    reference
      "RFC 854: Telnet Protocol";
  }

  identity smtp {
    base protocol-type;
    description
      "The identity for smtp.";
    reference
      "RFC 5321: Simple Mail Transfer Protocol (SMTP)";
  }

  identity sftp {
    base protocol-type;
    description
      "The identity for sftp.";
    reference
      "RFC 913: Simple File Transfer Protocol (SFTP)";
  }

  identity http {
    base protocol-type;
    description
      "The identity for http.";
    reference
      "RFC 2616: Hypertext Transfer Protocol (HTTP)";
  }

  identity https {
    base protocol-type;
    description
      "The identity for https.";
    reference
      "RFC 2818: HTTP over TLS (HTTPS)";
  }

  identity pop3 {
    base protocol-type;
    description



Jeong, et al.          Expires September 12, 2020              [Page 21]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      "The identity for pop3.";
    reference
      "RFC 1081: Post Office Protocol -Version 3 (POP3)";
  }

  identity nat {
    base protocol-type;
    description
      "The identity for nat.";
    reference
      "RFC 1631: The IP Network Address Translator (NAT)";
  }

  identity primary-action {
    description
      "This identity represents the primary actions, such as
      PASS, DROP, ALERT, RATE-LIMIT, and MIRROR.";
  }

  identity pass {
    base primary-action;
    description
      "The identity for pass.";
  }

  identity drop {
    base primary-action;
    description
      "The identity for drop.";
  }

  identity alert {
    base primary-action;
    description
      "The identity for alert.";
  }

  identity rate-limit {
    base primary-action;
    description
      "The identity for rate-limit.";
  }

  identity mirror {
    base primary-action;
    description
      "The identity for mirroring.";
  }



Jeong, et al.          Expires September 12, 2020              [Page 22]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


  identity secondary-action {
    description
      "This field identifies additional actions if a rule is
      matched. This could be one of 'LOG', 'SYSLOG',
      'SESSION-LOG', etc.";
  }

  identity log {
    base secondary-action;
    description
      "The identity for logging.";
  }

  identity syslog {
    base secondary-action;
    description
      "The identity for system logging.";
  }

  identity session-log {
    base secondary-action;
    description
      "The identity for session logging.";
  }

  identity signature-type {
    description
      "This represents the base identity for signature types.";
  }

  identity signature-yara {
    base signature-type;
    description
      "This represents the YARA signatures.";
  }

  identity signature-snort {
    base signature-type;
    description
      "This represents the SNORT signatures.";
  }

  identity signature-suricata {
    base signature-type;
    description
      "This represents the SURICATA signatures.";
  }




Jeong, et al.          Expires September 12, 2020              [Page 23]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


  identity threat-feed-type {
    description
      "This represents the base identity for threat-feed.";
  }

/*
* Typedefs
*/
  typedef date-and-time {
    type string {
      pattern '\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?'
        + '(Z|[\+\-]\d{2}:\d{2})';
    }
        description
         "This is the format of date-and-time.";
    reference
     "RFC 3339: Date and Time on the Internet: Timestamps
      RFC 2579: Textual Conventions for SMIv2
      XSD-TYPES: XML Schema Part 2: Datatypes Second Edition";
  }

/*
 * Groupings
 */

  grouping ipv4-list {
    description
      "Grouping for ipv4 based ip-addresses.";
    leaf-list ipv4 {
      type inet:ipv4-address;
      description
        "This is the entry for the ipv4 ip-addresses.";
    }
  }

  grouping ipv6-list {
    description
      "Grouping for ipv6 based ip-addresses.";
    leaf-list ipv6 {
      type inet:ipv6-address;
      description
        "This is the entry for the ipv6 ip-addresses.";
    }
  }

  grouping ipv4 {
    description
      "Grouping for ipv4 based ip-address.";



Jeong, et al.          Expires September 12, 2020              [Page 24]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


    leaf ipv4 {
      type inet:ipv4-address;
      description
        "This is the entry for the ipv4 ip-address.";
    }
  }

  grouping ipv6 {
    description
      "Grouping for ipv6 based ip-address.";
    leaf ipv6 {
      type inet:ipv6-address;
      description
        "This is the entry for the ipv6 ip-address.";
    }
  }

  grouping ip-address-info {
    description
      "There are two types to configure a security policy
      for IPv4 address, such as exact match and range match.";
    choice match-type {
      description
          "User can choose between 'exact match' and 'range match'.";
      case exact-match-ipv4 {
        uses ipv4;
        description
          "Exact ip-address match for ipv4 type addresses";
      }
      case exact-match-ipv6 {
        uses ipv6;
        description
          "Exact ip-address match for ipv6 type addresses";
      }
      case range-match-ipv4 {
        list range-ipv4-address {
          key "start-ipv4-address end-ipv4-address";
          leaf start-ipv4-address {
            type inet:ipv4-address;
            description
                "Start IPv4 address for a range match.";
          }
          leaf end-ipv4-address {
            type inet:ipv4-address;
            description
                "End IPv4 address for a range match.";
          }
          description



Jeong, et al.          Expires September 12, 2020              [Page 25]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


              "Range match for an IP-address.";
        }
      }
      case range-match-ipv6 {
        list range-ipv6-address {
          key "start-ipv6-address end-ipv6-address";
          leaf start-ipv6-address {
            type inet:ipv6-address;
            description
              "Start IPv6 address for a range match.";
          }
          leaf end-ipv6-address {
            type inet:ipv6-address;
            description
              "End IPv6 address for a range match.";
          }
          description
            "Range match for an IP-address.";
        }
      }
    }
  }

  grouping ipsec-based-method {
    description
      "This represents the ipsec-based method.";
    list ipsec-method {
      key "method";
      description
        "This represents the list of IPsec method types.";
      leaf method {
        type identityref {
          base i2nsf-ipsec;
        }
        description
          "This represents IPsec IKE and IPsec IKEless cases.
          If this is not set, it cannot support IPsec IKE or
          IPsec IKEless.";
        reference
          "draft-ietf-i2nsf-sdn-ipsec-flow-protection-07";
      }
    }
  }

  grouping user-group {
    description
      "The grouping for user-group entities, and
        contains information such as name & ip-address.";



Jeong, et al.          Expires September 12, 2020              [Page 26]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


    leaf name {
      type string;
      description
        "This represents the name of a user.";
    }
    uses ip-address-info;
  }

  grouping device-group {
    description
      "This group represents device group information
      such as ip-address protocol.";
    leaf name {
      type string;
      description
        "This represents the name of a device.";
    }
    uses ip-address-info;
    leaf-list protocol {
      type identityref {
        base protocol-type;
      }
      description
        "This represents the communication protocols of
        devices.
        If this is not set, it cannot support the
        appropriate protocol";
    }
  }

  grouping location-group {
    description
      "This group represents location-group information
      such as geo-ip and continent.";
    leaf name {
      type string;
      description
        "This represents the name of a location.";
    }
    leaf geo-ip-ipv4 {
      type inet:ipv4-address;
      description
        "This represents the IPv4 geo-ip of a location.";
    }
    leaf geo-ip-ipv6 {
      type inet:ipv6-address;
      description
        "This represents the IPv6 geo-ip of a location.";



Jeong, et al.          Expires September 12, 2020              [Page 27]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


    }
    leaf continent {
      type identityref {
        base continent;
      }
      default asia;
      description
          "location-group-based on geo-ip of
          respective continent.";
    }
  }

  grouping threat-feed-info {
    description
      "This is the grouping for the threat-feed-list";
    leaf name {
      type identityref {
        base threat-feed-type;
      }
      description
        "This represents the name of the a threat-feed.";
    }
    leaf server-ipv4 {
      type inet:ipv4-address;
      description
        "The IPv4 ip-address for the threat-feed server.";
    }
    leaf server-ipv6 {
      type inet:ipv6-address;
      description
        "The IPv6 ip-address for the threat-feed server.";
    }
    leaf description {
      type string;
      description
        "This represents the descriptions of a threat-feed.
        The description should include information, such as
        the type, related threat, method, and file type.";
    }
  }

  grouping payload-string {
    description
      "The grouping for payload-string content.
      It contains information such as name and string
      content.";
    leaf description {
      type string;



Jeong, et al.          Expires September 12, 2020              [Page 28]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      description
        "This represents the description of a payload.
        If this is not set, it cannot support the
        description of how the payload content is
        related to a security attack.";
    }
    leaf-list content {
      type string;
      description
        "This represents the string of the payload
        contents. This content leaf-list contains the
        payload of a packet to analyze a threat.
        Due to the types of threats, the type of the
        content is defined as string to accommodate
        any kind of a payload type such as HTTP, HTTPS,
        and SIP.
        If this is not set, it cannot support the
        payload contents involved in a security attack
        as strings";
    }
  }

  grouping owners-ref {
    description
      "This grouping is for owners reference using
      Network Configuration Access Control Model
      (NACM).";
    leaf-list owners {
      type leafref {
        path "/nacm:nacm/nacm:groups/nacm:group/nacm:name";
      }
      description
        "This leaf-list names the owner groups of the
        list instance it sits on. Only the owners listed
        in a NACM group are authorized to get full CRUD
        privileges for the contents.
        If this is not set, it cannot support who has
        the prvilege of the contents";
    }
  }

  list i2nsf-cfi-policy {
    key "policy-name";
    description
      "This is the security policy list. Each policy in
      the list contains a list of security rules, and is
      a policy instance to have complete information
      such as where and when a policy needs to be



Jeong, et al.          Expires September 12, 2020              [Page 29]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


      applied.";
    leaf policy-name {
      type string;
      mandatory true;
      description
        "The name which identifies the policy.";
    }
    uses owners-ref;

    container rules{
      description
        "This container is for rules.";
      nacm:default-deny-write;
      list rule {
                key "rule-name";
        ordered-by user;
        leaf rule-name {
          type string;
          mandatory true;
          description
            "This represents the name for the rule.";
        }
        description
          "There can be a single or multiple number of
          rules.";
        uses owners-ref;

        container event {
          description
            "This represents the event (e.g., a security
            event, for which a security rule is made.)";
          leaf security-event {
            type identityref {
              base security-event-type;
            }
            description
              "This contains the description of security
              events. If this is not set, it cannot
              support which security event is enforced";
          }
          choice enforce-type {
            description
              "There are two different enforcement types;
              admin, and time.
              It cannot be allowed to configure
              admin=='time' or enforce-time=='admin'.";
            case enforce-admin {
              leaf admin {



Jeong, et al.          Expires September 12, 2020              [Page 30]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


                type string;
                description
                  "This represents the enforcement type
                  based on admin's decision.";
              }
            }
            case time {
              container time-information {
                description
                  "The begin-time and end-time information
                  when the security rule should be applied.";
                leaf enforce-time {
                  type date-and-time;
                  description
                    "The enforcement type is time-enforced.";
                }
                leaf begin-time {
                  type date-and-time;
                  description
                    "This is start time for time zone";
                }
                leaf end-time {
                  type date-and-time;
                  description
                    "This is end time for time zone";
                }
              }
            }
          }
          leaf frequency {
            type enumeration {
              enum only-once {
                description
                  "This represents the rule is enforced
                  only once immediately and not
                  repeated.";
              }
              enum daily {
                description
                  "This represents the rule is enforced
                  on a daily basis.";
              }
              enum weekly {
                description
                  "This represents the rule is enforced
                  on a weekly basis.";
              }
              enum monthly {



Jeong, et al.          Expires September 12, 2020              [Page 31]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


                description
                  "This represents the rule is enforced
                  on a monthly basis.";
              }
            }
            default only-once;
            description
              "This represents how frequent the rule
              should be enforced.";
          }
        }

        container condition {
          description
            "The conditions for general security policies.";
          container firewall-condition {
            description
              "The general firewall condition.";
            leaf source {
              type leafref {
                path "/i2nsf-cfi-policy/endpoint-groups/user-group/name";
              }
              description
                "This describes the paths to the source reference.";
            }
            leaf-list dest-target {
              type leafref {
                path "/i2nsf-cfi-policy/endpoint-groups/user-group/name";
              }
            description
              "This describes the paths to the destination
              target reference.";
            }
          }
          container ddos-condition {
            description
              "The condition for DDoS mitigation.";
            leaf-list source {
              type leafref {
                path "/i2nsf-cfi-policy/endpoint-groups/device-group/name";
              }
            description
              "This describes the path to the
              source target references.";
            }
            leaf-list dest-target {
              type leafref {
                path "/i2nsf-cfi-policy/endpoint-groups/device-group/name";



Jeong, et al.          Expires September 12, 2020              [Page 32]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


              }
              description
                "This describes the path to the destination target
                                references.";
            }
            container rate-limit {
              description
                "This describes the rate-limit.";
              leaf packet-threshold-per-second{
                type uint32;
                description
                  "This is a trigger value for the condition.";
              }
            }
          }
          container custom-condition {
            description
              "The condition based on packet contents.";
            leaf-list source {
              type leafref {
                path "/i2nsf-cfi-policy/threat-preventions/payload-content/name";
              }
            description
              "Describes the payload string content condition
              source.";
            }
            leaf dest-target {
              type leafref {
                path "/i2nsf-cfi-policy/threat-preventions/payload-content/name";
              }
            description
              "Describes the payload string content condition destination.";
            }
          }
          container threat-feed-condition {
            description
              "The condition based on the threat-feed information.";
            leaf-list source {
              type leafref {
                path "/i2nsf-cfi-policy/threat-preventions/threat-feed-list/name";
              }
            description
              "Describes the threat-feed condition source.";
            }
            leaf dest-target {
              type leafref {
                path "/i2nsf-cfi-policy/threat-preventions/threat-feed-list/name";
              }



Jeong, et al.          Expires September 12, 2020              [Page 33]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


            description
              "Describes the threat-feed condition destination.";
            }
          }
        }

        container actions {
          description
            "This is the action container.";
          leaf primary-action {
            type identityref {
              base primary-action;
            }
            description
              "This represent the primary actions (e.g.,
              PASS, DROP, ALERT, and MIRROR) to be
              applied a condition.
              If this is not set, it cannot support
              the primary actions.";
          }
          leaf secondary-action {
            type identityref {
              base secondary-action;
            }
            description
              "This represents the secondary actions
              (e.g., log and syslog) to be applied
              if needed.
              If this is not set, it cannot support
              the secondary actions.";
          }
        }

        container ipsec-method {
          description
            "This container represents the IPsec IKE
            and IKEless cases.";
          leaf method {
            type identityref {
              base i2nsf-ipsec;
            }
            description
              "This references the IPsec method types,
              which includes IPsec IKE and IPsec IKEless
              cases.
              If this is not set, it cannot support
              IPsec IKE or IPsec IKEless.";
            reference



Jeong, et al.          Expires September 12, 2020              [Page 34]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


              "draft-ietf-i2nsf-sdn-ipsec-flow-protection-07";
          }
        }
      }
    }

    container endpoint-groups {
      description
        "A logical entity in their business
        environment, where a security policy
        is to be applied.";
      list user-group{
        uses user-group;
                key "name";
        description
          "This represents the user group.";
      }
      list device-group {
        key "name";
        uses device-group;
        description
          "This represents the device group.";
      }
      list location-group{
        key "name";
        uses location-group;
        description
          "This represents the location group.";
      }
    }

    container threat-preventions {
      description
        "this describes the list of threat-prevention.";
      list threat-feed-list {
        key "name";
        description
          "There can be a single or multiple number of
          threat-feeds.";
        uses threat-feed-info;
        leaf-list threat-file-types {
          type identityref {
            base malware-file-type;
          }
          default executable-file;
          description
            "This contains a list of file types needed to
            be scanned for the virus.";



Jeong, et al.          Expires September 12, 2020              [Page 35]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


        }
        leaf-list signatures {
          type identityref {
            base signature-type;
          }
          default signature-suricata;
          description
            "This contains a list of signatures or hash
            of the threats.";
        }
      }
      list payload-content {
        key "name";
        leaf name {
          type string;
          description
            "This represents the name of payload-content.
            It should give an idea of why specific payload
            content is marked as threat. For example, the
            name 'backdoor' indicates the payload content
            is related to backdoor attack.";
        }
        description
          "This represents the payload-string group.";
        uses payload-string;
      }
    }
  }
}
<CODE ENDS>

               Figure 16: YANG for Consumer-Facing Interface

9.  XML Configuration Examples of High-Level Security Policy Rules

   This section shows XML configuration examples of high-level security
   policy rules that are delivered from the I2NSF User to the Security
   Controller over the Consumer-Facing Interface.  The considered use
   cases are: Database registration, time-based firewall for web
   filtering, VoIP/VoLTE security service, and DDoS-attack mitigation.

9.1.  Database Registration: Information of Positions and Devices
      (Endpoint Group)

   If new endpoints are introduced to the network, it is necessary to
   first register their data to the database.  For example, if new
   members are newly introduced in either of three different groups
   (i.e., user-group, device-group, and payload-group), each of them



Jeong, et al.          Expires September 12, 2020              [Page 36]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


   should be registered with information such as ip-addresses or
   protocols used by devices.  Figure 17 shows an example XML
   representation of the registered information for the user-group and
   device-group.

<?xml version="1.0" encoding="UTF-8" ?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cfi-policy">
  <user-group>
    <name>employees</name>
    <range-ipv4-address>
      <start-ipv4-address>221.159.112.1</start-ipv4-address>
      <end-ipv4-address>221.159.112.90</end-ipv4-address>
    </range-ipv4-address>
  </user-group>
  <device-group>
    <name>webservers</name>
    <range-ipv4-address>
      <start-ipv4-address>221.159.112.91</start-ipv4-address>
      <end-ipv4-address>221.159.112.97</end-ipv4-address>
    </range-ipv4-address>
    <protocol>http</protocol>
    <protocol>https</protocol>
  </device-group>
</endpoint-groups>

      Figure 17: Registering User-group and Device-group Information

9.2.  Scenario 1: Block SNS Access during Business Hours

   The first example scenario is to "block SNS access during office
   hours" using a time-based firewall policy.  In this scenario, all
   users registered as "employees" in the user-group list are unable to
   access Social Networking Services (SNS) during the office hours.  The
   XML instance is described below:

















Jeong, et al.          Expires September 12, 2020              [Page 37]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


<?xml version="1.0" encoding="UTF-8" ?>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cfi-policy">
  <policy-name>security_policy_for_blocking_sns</policy-name>
  <rules>
    <rule>
      <rule-name>block_access_to_sns_during_office_hours</rule-name>
      <event>
        <time-information>
          <begin-time>2020-03-11T09:00:00.00Z</begin-time>
          <end-time>2020-03-11T18:00:00.00Z</end-time>
        </time-information>
        <frequency>only-once</frequency>
      </event>
      <conditions>
        <firewall-condition>
          <source>employees</source>
        </firewall-condition>
        <custom-condition>
          <dest-target>sns-websites</dest-target>
        </custom-condition>
      </conditions>
      <actions>
        <primary-action>drop</primary-action>
      </actions>
      <ipsec-method>
        <method>ipsec-ike</method>
      </ipsec-method>
    </rule>
  </rules>
</i2nsf-cfi-policy>

             Figure 18: An XML Example for Time-based Firewall

   Time-based-condition Firewall

   1.  The policy name is "security_policy_for_blocking_sns".

   2.  The rule name is "block_access_to_sns_during_office_hours".

   3.  The Source is "employees".

   4.  The destination target is "sns-websites". "sns-websites" is the
       key which represents the list containing the information, such as
       URL, about sns-websites.

   5.  The action required is to "drop" any attempt to connect to
       websites related to Social networking.




Jeong, et al.          Expires September 12, 2020              [Page 38]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


   6.  The IPsec method type used for nsf traffic steering is set to
       "ipsec-ike".

9.3.  Scenario 2: Block Malicious VoIP/VoLTE Packets Coming to a Company

   The second example scenario is to "block malicious VoIP/VoLTE packets
   coming to a company" using a VoIP policy.  In this scenario, the
   calls comming from from VOIP and/or VOLTE sources with VOLTE IDs that
   are classified as malicious are dropped.  The IP addresses of the
   employees and malicious VOIP IDs should be blocked are stored in the
   database or datastore of the enterprise.  Here and the rest of the
   cases assume that the security administrators or someone responsible
   for the existing and newly generated policies, are not aware of which
   and/or how many NSFs are needed to meet the security requirements.
   Figure 19 represents the XML document generated from YANG discussed
   in previous sections.  Once a high-level seucurity policy is created
   by a security admin, it is delivered by the Consumer-Facing
   Interface, through RESTCONF server, to the security controller.  The
   XML instance is described below:

<?xml version="1.0" encoding="UTF-8" ?>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cfi-policy">
  <policy-name>security_policy_for_blocking_malicious_voip_packets</policy-name>
  <rules>
    <rule>
      <rule-name>Block_malicious_voip_and_volte_packets</rule-name>
      <conditions>
        <custom-condition>
          <source>malicious-id</source>
        </custom-condition>
        <firewall-condition>
          <dest-target>employees</dest-target>
        </firewall-condition>
      </conditions>
      <actions>
        <primary-action>drop</primary-action>
      </actions>
      <ipsec-method>
        <method>ipsec-ikeless</method>
      </ipsec-method>
    </rule>
  </rules>
</i2nsf-cfi-policy>

            Figure 19: An XML Example for VoIP Security Service

   Custom-condition Firewall




Jeong, et al.          Expires September 12, 2020              [Page 39]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


   1.  The policy name is
       "security_policy_for_blocking_malicious_voip_packets".

   2.  The rule name is "Block_malicious_voip_and_volte_packets".

   3.  The Source is "malicious-id".  This can be a single ID or a list
       of IDs, depending on how the ID are stored in the database.  The
       "malicious-id" is the key so that the security admin can read
       every stored malicious VOIP IDs that are named as "malicious-id".

   4.  The destination target is "employees". "employees" is the key
       which represents the list containing information about employees,
       such as IP addresses.

   5.  The action required is "drop" when any incoming packets are from
       "malicious-id".

   6.  The IPsec method used for nsf traffic steering is set to "ipsec-
       ikeless".

9.4.  Scenario 3: Mitigate HTTP and HTTPS Flood Attacks on a Company Web
      Server

   The third example scenario is to "Mitigate HTTP and HTTPS flood
   attacks on a company web server" using a DDoS-attack mitigation
   policy.  Here, the time information is not set because the service
   provided by the network should be maintained at all times.  If the
   packets sent by any sources are more than the set threshold, then the
   admin can set the percentage of the packets to be dropped to safely
   maintain the service.  In this scenario, the source is set as "any"
   to block any sources which send abnormal amount of packets.  The
   destination is set as "web_server01".  Once the rule is set and
   delivered and enforced to the nsfs by the securiy controller, the
   NSFs will monitor the incoming packet amounts and the destination to
   act according to the rule set.  The XML instance is described below:
















Jeong, et al.          Expires September 12, 2020              [Page 40]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


<?xml version="1.0" encoding="UTF-8" ?>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cfi-policy">
  <policy-name>security_policy_for_ddos_attacks</policy-name>
  <rules>
    <rule>
      <rule-name>100_packets_per_second</rule-name>
      <conditions>
        <ddos-condition>
          <dest-target>webservers</dest-target>
          <rate-limit>
            <packet-threshold-per-second>100</packet-threshold-per-second>
          </rate-limit>
        </ddos-condition>
      </conditions>
      <actions>
        <primary-action>drop</primary-action>
      </actions>
      <ipsec-method>
        <method>ipsec-ikeless</method>
      </ipsec-method>
    </rule>
  </rules>
</i2nsf-cfi-policy>

           Figure 20: An XML Example for DDoS-attack Mitigation

   DDoS-condition Firewall

   1.  The policy name is "security_policy_for_ddos_attacks".

   2.  The rule name is "100_packets_per_second".

   3.  The destination target is "webservers". "webservers" is the key
       which represents the list containing information, such as IP
       addresses and ports, about web-servers.

   4.  The rate limit exists to limit the incoming amount of packets per
       second.  In this case the rate limit is "100" packets per second.
       This amount depends on the packet receiving capacity of the
       server devices.

   5.  The Source is all sources which send abnormal amount of packets.

   6.  The action required is to "drop" packet reception is more than
       100 packets per second.

   7.  The IPsec method used for nsf traffic steering is set to "ipsec-
       ike".



Jeong, et al.          Expires September 12, 2020              [Page 41]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


10.  Security Considerations

   The data model for the I2NSF Consumer-Facing Interface is based on
   the I2NSF framework [RFC8329], so the same security considerations
   with the I2NSF framework should be included in this document.  The
   data model needs a secure communication channel to protect the
   Consumer-Facing Interface between the I2NSF User and Security
   Controller.  Also, the data model's management access control is
   based on Network Configuration Access Control Model(NACM) mechanisms
   [RFC8341].

11.  IANA Considerations

   This document requests IANA to register the following URI in the
   "IETF XML Registry" [RFC3688]:

            URI: urn:ietf:params:xml:ns:yang:ietf-i2nsf-cfi-policy
            Registrant Contact: The I2NSF.
            XML: N/A; the requested URI is an XML namespace.


   This document requests IANA to register the following YANG module in
   the "YANG Module Names" registry [RFC7950].

           name: ietf-i2nsf-cfi-policy
           namespace: urn:ietf:params:xml:ns:yang:ietf-i2nsf-cfi-policy
           prefix: cfi-policy
           reference: RFC 7950


12.  Acknowledgments

   This work was supported by Institute of Information & Communications
   Technology Planning & Evaluation (IITP) grant funded by the Korea
   MSIT (Ministry of Science and ICT) (R-20160222-002755, Cloud based
   Security Intelligence Technology Development for the Customized
   Security Service Provisioning).

13.  Contributors

   This document is made by the group effort of I2NSF working group.
   Many people actively contributed to this document, such as Mahdi F.
   Dachmehchi and Daeyoung Hyun.  The authors sincerely appreciate their
   contributions.

   The following are co-authors of this document:

   Hyoungshick Kim



Jeong, et al.          Expires September 12, 2020              [Page 42]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


   Department of Computer Science and Engineering
   Sungkyunkwan University
   2066 Seo-ro Jangan-gu
   Suwon, Gyeonggi-do 16419
   Republic of Korea

   EMail: hyoung@skku.edu


   Eunsoo Kim
   Department of Electronic, Electrical and Computer Engineering
   Sungkyunkwan University
   2066 Seo-ro Jangan-gu
   Suwon, Gyeonggi-do 16419
   Republic of Korea

   EMail: eskim86@skku.edu


   Seungjin Lee
   Department of Electronic, Electrical and Computer Engineering
   Sungkyunkwan University
   2066 Seo-ro Jangan-gu
   Suwon, Gyeonggi-do 16419
   Republic of Korea

   EMail: jine33@skku.edu


   Jinyong Tim Kim
   Department of Electronic, Electrical and Computer Engineering
   Sungkyunkwan University
   2066 Seo-ro Jangan-gu
   Suwon, Gyeonggi-do 16419
   Republic of Korea

   EMail: timkim@skku.edu


   Anil Lohiya
   Juniper Networks
   1133 Innovation Way
   Sunnyvale, CA 94089
   US

   EMail: alohiya@juniper.net





Jeong, et al.          Expires September 12, 2020              [Page 43]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


   Dave Qi
   Bloomberg
   731 Lexington Avenue
   New York, NY 10022
   US

   EMail: DQI@bloomberg.net


   Nabil Bitar
   Nokia
   755 Ravendale Drive
   Mountain View, CA 94043
   US

   EMail: nabil.bitar@nokia.com


   Senad Palislamovic
   Nokia
   755 Ravendale Drive
   Mountain View, CA 94043
   US

   EMail: senad.palislamovic@nokia.com


   Liang Xia
   Huawei
   101 Software Avenue
   Nanjing, Jiangsu 210012
   China

   EMail: Frank.Xialiang@huawei.com


14.  References

14.1.  Normative References

   [RFC3444]  Pras, A. and J. Schoenwaelder, "On the Difference between
              Information Models and Data Models", RFC 3444,
              DOI 10.17487/RFC3444, January 2003,
              <https://www.rfc-editor.org/info/rfc3444>.

   [RFC3688]  Mealling, M., "The IETF XML Registry", BCP 81, RFC 3688,
              DOI 10.17487/RFC3688, January 2004,
              <https://www.rfc-editor.org/info/rfc3688>.



Jeong, et al.          Expires September 12, 2020              [Page 44]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


   [RFC6020]  Bjorklund, M., Ed., "YANG - A Data Modeling Language for
              the Network Configuration Protocol (NETCONF)", RFC 6020,
              DOI 10.17487/RFC6020, October 2010,
              <https://www.rfc-editor.org/info/rfc6020>.

   [RFC6991]  Schoenwaelder, J., Ed., "Common YANG Data Types",
              RFC 6991, DOI 10.17487/RFC6991, July 2013,
              <https://www.rfc-editor.org/info/rfc6991>.

   [RFC7950]  Bjorklund, M., Ed., "The YANG 1.1 Data Modeling Language",
              RFC 7950, DOI 10.17487/RFC7950, August 2016,
              <https://www.rfc-editor.org/info/rfc7950>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8192]  Hares, S., Lopez, D., Zarny, M., Jacquenet, C., Kumar, R.,
              and J. Jeong, "Interface to Network Security Functions
              (I2NSF): Problem Statement and Use Cases", RFC 8192,
              DOI 10.17487/RFC8192, July 2017,
              <https://www.rfc-editor.org/info/rfc8192>.

   [RFC8329]  Lopez, D., Lopez, E., Dunbar, L., Strassner, J., and R.
              Kumar, "Framework for Interface to Network Security
              Functions", RFC 8329, DOI 10.17487/RFC8329, February 2018,
              <https://www.rfc-editor.org/info/rfc8329>.

   [RFC8340]  Bjorklund, M. and L. Berger, Ed., "YANG Tree Diagrams",
              BCP 215, RFC 8340, DOI 10.17487/RFC8340, March 2018,
              <https://www.rfc-editor.org/info/rfc8340>.

   [RFC8341]  Bierman, A. and M. Bjorklund, "Network Configuration
              Access Control Model", STD 91, RFC 8341,
              DOI 10.17487/RFC8341, March 2018,
              <https://www.rfc-editor.org/info/rfc8341>.

   [RFC8407]  Bierman, A., "Guidelines for Authors and Reviewers of
              Documents Containing YANG Data Models", BCP 216, RFC 8407,
              DOI 10.17487/RFC8407, October 2018,
              <https://www.rfc-editor.org/info/rfc8407>.

14.2.  Informative References








Jeong, et al.          Expires September 12, 2020              [Page 45]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


   [client-facing-inf-req]
              Kumar, R., Lohiya, A., Qi, D., Bitar, N., Palislamovic,
              S., and L. Xia, "Requirements for Client-Facing Interface
              to Security Controller", draft-ietf-i2nsf-client-facing-
              interface-req-05 (work in progress), May 2018.

   [i2nsf-capability-im]
              Xia, L., Strassner, J., Basile, C., and D. Lopez,
              "Information Model of NSFs Capabilities", draft-ietf-
              i2nsf-capability-05 (work in progress), April 2019.

   [i2nsf-ipsec]
              Marin-Lopez, R., Lopez-Millan, G., and F. Pereniguez-
              Garcia, "Software-Defined Networking (SDN)-based IPsec
              Flow Protection", draft-ietf-i2nsf-sdn-ipsec-flow-
              protection-07 (work in progress), August 2019.

   [i2nsf-terminology]
              Hares, S., Strassner, J., Lopez, D., Xia, L., and H.
              Birkholz, "Interface to Network Security Functions (I2NSF)
              Terminology", draft-ietf-i2nsf-terminology-08 (work in
              progress), July 2019.





























Jeong, et al.          Expires September 12, 2020              [Page 46]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


Appendix A.  Changes from draft-ietf-i2nsf-consumer-facing-interface-
             dm-07

   The following changes are made from draft-ietf-i2nsf-consumer-facing-
   interface-dm-07:

   o  This version is revised according to the comments from Jan
      Lindblad who reviewed this document as a YANG doctor.

Authors' Addresses

   Jaehoon Paul Jeong
   Department of Computer Science and Engineering
   Sungkyunkwan University
   2066 Seobu-Ro, Jangan-Gu
   Suwon, Gyeonggi-Do  16419
   Republic of Korea

   Phone: +82 31 299 4957
   Fax:   +82 31 290 7996
   EMail: pauljeong@skku.edu
   URI:   http://iotlab.skku.edu/people-jaehoon-jeong.php


   Chaehong Chung
   Department of Electronic, Electrical and Computer Engineering
   Sungkyunkwan University
   2066 Seobu-Ro, Jangan-Gu
   Suwon, Gyeonggi-Do  16419
   Republic of Korea

   Phone: +82 31 299 4957
   EMail: darkhong@skku.edu


   Tae-Jin Ahn
   Korea Telecom
   70 Yuseong-Ro, Yuseong-Gu
   Daejeon  305-811
   Republic of Korea

   Phone: +82 42 870 8409
   EMail: taejin.ahn@kt.com








Jeong, et al.          Expires September 12, 2020              [Page 47]

Internet-Draft  Consumer-Facing Interface YANG Data Model     March 2020


   Rakesh Kumar
   Juniper Networks
   1133 Innovation Way
   Sunnyvale, CA  94089
   USA

   EMail: rkkumar@juniper.net


   Susan Hares
   Huawei
   7453 Hickory Hill
   Saline, MI  48176
   USA

   Phone: +1-734-604-0332
   EMail: shares@ndzh.com


































Jeong, et al.          Expires September 12, 2020              [Page 48]
