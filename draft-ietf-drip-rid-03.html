<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>UAS Remote ID</title>
<meta content="Robert Moskowitz" name="author">
<meta content="Stuart W. Card" name="author">
<meta content="Adam Wiethuechter" name="author">
<meta content="Andrei Gurtov" name="author">
<meta content="
       
 This document describes the use of Hierarchical Host Identity Tags 
 (HHITs) as self-asserting IPv6 addresses and thereby a trustable 
 Identifier for use as the UAS Remote ID.  HHITs include explicit 
 hierarchy to provide Registrar discovery for 3rd-party ID 
 attestation.
 
 
    " name="description">
<meta content="xml2rfc 3.3.0" name="generator">
<meta content="RFC" name="keyword">
<meta content="Request for Comments" name="keyword">
<meta content="I-D" name="keyword">
<meta content="Internet-Draft" name="keyword">
<meta content="RID" name="keyword">
<meta content="draft-ietf-drip-rid-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.3.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.1
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.24.0
    setuptools 40.6.2
    six 1.15.0
-->
<link href="/tmp/draft-ietf-drip-rid-03-um8j8fal.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">UAS Remote ID</td>
<td class="right">October 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Moskowitz, et al.</td>
<td class="center">Expires 30 April 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">DRIP</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7401" class="eref">7401</a>, <a href="https://www.rfc-editor.org/rfc/rfc7343" class="eref">7343</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-10-27" class="published">27 October 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-04-30">30 April 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Moskowitz</div>
<div class="org">HTT Consulting</div>
</div>
<div class="author">
      <div class="author-name">S. Card</div>
<div class="org">AX Enterprize, LLC</div>
</div>
<div class="author">
      <div class="author-name">A. Wiethuechter</div>
<div class="org">AX Enterprize, LLC</div>
</div>
<div class="author">
      <div class="author-name">A. Gurtov</div>
<div class="org">Linköping University</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">UAS Remote ID</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
 This document describes the use of Hierarchical Host Identity Tags 
 (HHITs) as self-asserting IPv6 addresses and thereby a trustable 
 Identifier for use as the UAS Remote ID.  HHITs include explicit 
 hierarchy to provide Registrar discovery for 3rd-party ID 
 attestation.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 30 April 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-nontransferablity-of-hhits" class="xref">Nontransferablity of HHITs</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terms-and-definitions" class="xref">Terms and Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-terminology" class="xref">Requirements Terminology</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-notation" class="xref">Notation</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-definitions" class="xref">Definitions</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-hierarchical-hits-as-remote" class="xref">Hierarchical HITs as Remote ID</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-remote-id-as-one-class-of-h" class="xref">Remote ID as one class of Hierarchical HITs</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-hierarchy-in-orchid-generat" class="xref">Hierarchy in ORCHID Generation</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-hierarchical-hit-registry" class="xref">Hierarchical HIT Registry</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-remote-id-authentication-us" class="xref">Remote ID Authentication using HHITs</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-uas-id-hhit-in-dns" class="xref">UAS ID HHIT in DNS</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-other-utm-uses-of-hhits" class="xref">Other UTM uses of HHITs</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-drip-requirements-addressed" class="xref">DRIP Requirements addressed</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-astm-considerations" class="xref">ASTM Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-hierarchical-hit-trust" class="xref">Hierarchical HIT Trust</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-collision-risks-with-hierar" class="xref">Collision risks with Hierarchical HITs</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-eu-u-space-rid-privacy-cons" class="xref">EU U-Space RID Privacy Considerations</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-the-hierarchical-host-ident" class="xref">The Hierarchical Host Identity Tag (HHIT)</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-hhit-prefix" class="xref">HHIT prefix</a><a href="#section-toc.1-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-hhit-suite-ids" class="xref">HHIT Suite IDs</a><a href="#section-toc.1-1.12.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a href="#section-b.2.1" class="xref">B.2.1</a>.  <a href="#name-8-bit-hit-suite-ids" class="xref">8 bit HIT Suite IDs</a><a href="#section-toc.1-1.12.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-the-hierarchy-id-hid" class="xref">The Hierarchy ID (HID)</a><a href="#section-toc.1-1.12.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.12.2.3.2.1">
                    <p id="section-toc.1-1.12.2.3.2.1.1"><a href="#section-b.3.1" class="xref">B.3.1</a>.  <a href="#name-the-registered-assigning-au" class="xref">The Registered Assigning Authority (RAA)</a><a href="#section-toc.1-1.12.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.12.2.3.2.2">
                    <p id="section-toc.1-1.12.2.3.2.2.1"><a href="#section-b.3.2" class="xref">B.3.2</a>.  <a href="#name-the-hierarchical-hit-domain" class="xref">The Hierarchical HIT Domain Authority (HDA)</a><a href="#section-toc.1-1.12.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.  <a href="#name-orchids-for-hierarchical-hi" class="xref">ORCHIDs for Hierarchical HITs</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-c.1" class="xref">C.1</a>.  <a href="#name-adding-additional-informati" class="xref">Adding additional information to the ORCHID</a><a href="#section-toc.1-1.13.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-c.2" class="xref">C.2</a>.  <a href="#name-orchid-encoding" class="xref">ORCHID Encoding</a><a href="#section-toc.1-1.13.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.2.2.1">
                    <p id="section-toc.1-1.13.2.2.2.1.1"><a href="#section-c.2.1" class="xref">C.2.1</a>.  <a href="#name-encoding-orchids-for-hitv2" class="xref">Encoding ORCHIDs for HITv2</a><a href="#section-toc.1-1.13.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-c.3" class="xref">C.3</a>.  <a href="#name-orchid-decoding" class="xref">ORCHID Decoding</a><a href="#section-toc.1-1.13.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-c.4" class="xref">C.4</a>.  <a href="#name-decoding-orchids-for-hitv2" class="xref">Decoding ORCHIDs for HITv2</a><a href="#section-toc.1-1.13.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.d" class="xref">Appendix D</a>.  <a href="#name-edward-digital-signature-al" class="xref">Edward Digital Signature Algorithm for HITs</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-d.1" class="xref">D.1</a>.  <a href="#name-host_id" class="xref">HOST_ID</a><a href="#section-toc.1-1.14.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-d.2" class="xref">D.2</a>.  <a href="#name-hit_suite_list" class="xref">HIT_SUITE_LIST</a><a href="#section-toc.1-1.14.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.e" class="xref">Appendix E</a>.  <a href="#name-example-hhit-self-claim" class="xref">Example HHIT Self Claim</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-e.1" class="xref">E.1</a>.  <a href="#name-hhit-offline-self-claim" class="xref">HHIT Offline Self Claim</a><a href="#section-toc.1-1.15.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.f" class="xref">Appendix F</a>.  <a href="#name-calculating-collision-proba" class="xref">Calculating Collision Probabilities</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.g" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-appendix.h" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.18.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"> 
 <span>[<a href="#I-D.ietf-drip-reqs" class="xref">drip-requirements</a>]</span> describes a 
 UAS ID as a "unique (ID-4), non-spoofable (ID-5), and identify a 
 registry where the ID is listed (ID-2)"; all within a 20 character 
 Identifier (ID-1).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
 This document describes the use of <span><a href="#HHIT" class="xref">Hierarchical HITs (HHITs)</a> (<a href="#HHIT" class="xref">Appendix B</a>)</span> as self-asserting 
 IPv6 addresses and thereby a trustable Identifier for use as the 
 UAS Remote ID. HHITs include explicit hierarchy to provide 
 Registrar discovery for 3rd-party ID attestation.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"> 
 HITs are statistically unique through the cryptographic hash 
 feature of second-preimage resistance.  The cryptographically-bound 
 addition of the Hierarchy and a HHIT registration process (TBD; 
 e.g. based on Extensible Provisioning Protocol, <span>[<a href="#RFC5730" class="xref">RFC5730</a>]</span>) provide complete, global HHIT uniqueness.  
 This is in contrast to general IDs (e.g. a UUID or device serial 
 number) as the subject in an X.509 certificate.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
 In a multi-CA PKI, a subject can occur in multiple CAs, possibly 
 fraudulently.  CAs within the PKI would need to implement an 
 approach to enforce assurance of uniqueness.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"> 
 Hierarchical HITs are valid, though non-routable, IPv6 addresses.  
 As such, they fit in many ways within various IETF technologies.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="HHIT_Nontransfer">
<section id="section-1.1">
        <h3 id="name-nontransferablity-of-hhits">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-nontransferablity-of-hhits" class="section-name selfRef">Nontransferablity of HHITs</a>
        </h3>
<p id="section-1.1-1">
 HIs and its HHITs SHOULD NOT be transferable between UA or even 
 between replacement electronics for a UA.  The private key for the 
 HI SHOULD be held in a cryptographically secure component.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="terms">
<section id="section-2">
      <h2 id="name-terms-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terms-and-definitions" class="section-name selfRef">Terms and Definitions</a>
      </h2>
<section id="section-2.1">
        <h3 id="name-requirements-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-terminology" class="section-name selfRef">Requirements Terminology</a>
        </h3>
<p id="section-2.1-1">
 The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL 
 NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", 
 "MAY", and "OPTIONAL" in this document are to be interpreted as 
 described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all 
 capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
<div id="notation">
<section id="section-2.2">
        <h3 id="name-notation">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-2.2-1">
          <dt id="section-2.2-1.1">| </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-1.2">
 Signifies concatenation of information - e.g., X | Y is the 
 concatenation of X and Y.<a href="#section-2.2-1.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-2.3">
        <h3 id="name-definitions">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<p id="section-2.3-1">
 See <span>[<a href="#I-D.ietf-drip-reqs" class="xref">drip-requirements</a>]</span> for 
 common DRIP terms.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.3-2">
          <dt id="section-2.3-2.1">cSHAKE (The customizable SHAKE function):</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.2">
 Extends the SHAKE scheme to allow users to customize their 
 use of the function.<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.3">HDA (Hierarchical HIT Domain Authority):</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.4">
 The 16 bit field identifying the HHIT Domain Authority
 under an RAA.<a href="#section-2.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.5">HHIT</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.6">
 Hierarchical Host Identity Tag.  A HIT with extra 
 hierarchical information not found in a standard HIT.<a href="#section-2.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.7">HI</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.8">
 Host Identity.  The public key portion of an asymmetric 
 keypair used in HIP.<a href="#section-2.3-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.9">HID (Hierarchy ID):</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.10">
 The 32 bit field providing the HIT Hierarchy ID.<a href="#section-2.3-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.11">HIP</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.12">
 Host Identity Protocol.  The origin of HI, HIT, and HHIT, 
 required for DRIP. Optional full use of HIP enables 
 additional DRIP functionality.<a href="#section-2.3-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.13">HIT</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.14">
 Host Identity Tag.  A 128 bit handle on the HI.  HITs are 
 valid IPv6 addresses.<a href="#section-2.3-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.15">Keccak (KECCAK Message Authentication Code):</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.16">
 The family of all sponge functions with a KECCAK-f 
 permutation as the underlying function and multi-rate 
 padding as the padding rule.<a href="#section-2.3-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.17">RAA (Registered Assigning Authority):</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.18">
 The 16 bit field identifying the business or organization 
 that manages a registry of HDAs.<a href="#section-2.3-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.19">RVS (Rendezvous Server):</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.20">
 The HIP Rendezvous Server for enabling mobility, as defined 
 in <span>[<a href="#RFC8004" class="xref">RFC8004</a>]</span>.<a href="#section-2.3-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.21">SHAKE (Secure Hash Algorithm KECCAK):</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.22">
 A secure hash that allows for an arbitrary output length.<a href="#section-2.3-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.23">XOF (eXtendable-Output Function):</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.24">
 A function on bit strings (also called messages) in which 
 the output can be extended to any desired length.<a href="#section-2.3-2.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</section>
</div>
<div id="HHIT_RID">
<section id="section-3">
      <h2 id="name-hierarchical-hits-as-remote">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-hierarchical-hits-as-remote" class="section-name selfRef">Hierarchical HITs as Remote ID</a>
      </h2>
<p id="section-3-1">
 Hierarchical HITs are a refinement on the Host Identity Tag (HIT) 
 of <span><a href="#RFC7401" class="xref">HIPv2</a> [<a href="#RFC7401" class="xref">RFC7401</a>]</span>.  HHITs 
 require a new ORCHID mechanism as described in <a href="#ORCHIDs" class="xref">Appendix C</a>.  HHITs for UAS ID also use the 
 new EdDSA/SHAKE128 HIT suite defined in <a href="#EdDSA" class="xref">Appendix D</a> (requirements GEN-2).  This 
 hierarchy, cryptographically embedded within the HHIT, provides the 
 information for finding the UA's HHIT registry (ID-3).<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="IDtypes">
<p id="section-3-2">
 The current ASTM <span>[<a href="#F3411-19" class="xref">F3411-19</a>]</span> 
 specifies three UAS ID types:<a href="#section-3-2" class="pilcrow">¶</a></p>
</div>
<span class="break"></span><dl class="olPercent" id="section-3-3">
 <dt>TYPE-1</dt>
<dd id="section-3-3.1">
 A static, manufacturer assigned, hardware serial number per 
 ANSI/CTA-2063-A "Small Unmanned Aerial System Serial Numbers" 
 <span>[<a href="#CTA2063A" class="xref">CTA2063A</a>]</span>.<a href="#section-3-3.1" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt>TYPE-2</dt>
<dd id="section-3-3.2">
 A CAA assigned (presumably static) ID.<a href="#section-3-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt>TYPE-3</dt>
<dd id="section-3-3.3">
 A UTM system assigned UUID <span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span>, which can but need not be dynamic.<a href="#section-3-3.3" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-4">
 For HHITs to be used effectively as UAS IDs, F3411-19 SHOULD add 
 UAS ID type 4 as HHIT.<a href="#section-3-4" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-remote-id-as-one-class-of-h">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-remote-id-as-one-class-of-h" class="section-name selfRef">Remote ID as one class of Hierarchical HITs</a>
        </h3>
<p id="section-3.1-1"> 
 UAS Remote ID may be one of a number of uses of HHITs.  As such 
 these follow-on uses need to be considered in allocating the RAAs 
 <a href="#RAA" class="xref">Appendix B.3.1</a> or HHIT prefix assignments 
 <a href="#IANA" class="xref">Section 8</a>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-hierarchy-in-orchid-generat">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-hierarchy-in-orchid-generat" class="section-name selfRef">Hierarchy in ORCHID Generation</a>
        </h3>
<p id="section-3.2-1"> 
 ORCHIDS, as defined in <span>[<a href="#RFC7343" class="xref">RFC7343</a>]</span>, 
 do not cryptographically bind the IPv6 prefix nor the Orchid 
 Generation Algorithm (OGA) ID (the HIT Suite ID) to the hash of the 
 HI.  The justification then was attacks against these fields are 
 DoS attacks against protocols using them.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2"> 
 HHITs, as defined in <a href="#ORCHIDs" class="xref">Appendix C</a>, cryptographically bind all content in the 
 ORCHID through the hashing function.  Thus a recipient of a HHIT 
 that has the underlying HI can directly act on all content in the 
 HHIT. This is especially important to using the hierarchy to find 
 the HHIT Registry.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-3.3">
        <h3 id="name-hierarchical-hit-registry">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-hierarchical-hit-registry" class="section-name selfRef">Hierarchical HIT Registry</a>
        </h3>
<p id="section-3.3-1"> 
 HHITs are registered to Hierarchical HIT Domain Authorities (HDAs). 
 A registration process (TBD) ensures UAS ID global uniqueness 
 (ID-4). It also provides the mechanism to create UAS Public/Private 
 data associated with the HHIT UAS ID (REG-1 and REG-2).<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2"> 
 The 2 levels of hierarchy within the HHIT allows for CAAs to have 
 their own Registered Assigning Authority (RAA) for their National 
 Air Space (NAS).  Within the RAA, the CAAs can delegate HDAs as 
 needed. There may be other RAAs allowed to operate within a given 
 NAS; this is a policy decision by the CAA.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
</section>
<div id="RID_Auth">
<section id="section-3.4">
        <h3 id="name-remote-id-authentication-us">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-remote-id-authentication-us" class="section-name selfRef">Remote ID Authentication using HHITs</a>
        </h3>
<p id="section-3.4-1"> 
 The EdDSA25519 Host Identity (HI) [<a href="#EdDSA" class="xref">Appendix D</a>] underlying the HHIT can be used in an 84 byte 
 self proof claim as shown in <a href="#Self_Claim" class="xref">Appendix E</a> to provide proof of Remote ID ownership 
 (requirements GEN-1).  An Internet lookup service like DNS can 
 provide the HI and registration proof (requirements GEN-3).<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">
 Similarly the 200 byte offline self claim shown in <a href="#Offline_Self_Claim" class="xref">Appendix E.1</a> provide the same 
 proofs without Internet access and with a small cache that contains 
 the HDA's HI/HHIT and HDA meta-data.  These self claims are carried 
 in the ASTM Authentication Message (Msg Type 0x2).<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3"> 
 Hashes of previously sent ASTM messages can be placed in a signed 
 "Manifest" Authentication Message (requirements GEN-2).  This can 
 be either a standalone Authentication Message, or an enhanced self 
 claim Authentication Message.  Alternatively the ASTM Message Pack 
 (Msg Type 0xF) can provide this feature, but only over Bluetooth 5 
 or WiFi NAN broadcasts.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="HHIT_DNS">
<section id="section-4">
      <h2 id="name-uas-id-hhit-in-dns">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-uas-id-hhit-in-dns" class="section-name selfRef">UAS ID HHIT in DNS</a>
      </h2>
<p id="section-4-1">
 There are 2 approaches for storing and retrieving the HHIT from 
 DNS.  These are:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
 As FQDNs in the .aero TLD.<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">
 Reverse DNS lookups as IPv6 addresses per <span>[<a href="#RFC8005" class="xref">RFC8005</a>]</span>.<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">
 The HHIT can be used to construct an FQDN that points to the USS 
 that has the Public/Private information for the UA (REG-1 and 
 REG-2).  For example the USS for the  HHIT could be found via the 
 following.  Assume that the RAA is 100 and the HDA is 50.  The PTR 
 record is constructed as:<a href="#section-4-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-4">
<pre>

    100.50.hhit.uas.aero   IN PTR      foo.uss.aero.

</pre><a href="#section-4-4" class="pilcrow">¶</a>
</div>
<p id="section-4-5">
 The individual HHITs are potentially too numerous (e.g. 60 - 600M) 
 and dynamic to actually store in a signed, DNS zone.  Rather the 
 USS would provide the HHIT detail response.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">
 The HHIT reverse lookup can be a standard IPv6 reverse look up, or 
 it can leverage off the HHIT structure.  Assume that the RAA is 10 
 and the HDA is 20 and the HHIT is:<a href="#section-4-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-7">
<pre>

    2001:14:28:14:a3ad:1952:ad0:a69e

</pre><a href="#section-4-7" class="pilcrow">¶</a>
</div>
<p id="section-4-8">
 An HHIT reverse lookup would be to is:<a href="#section-4-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-9">
<pre>

    a69e.ad0.1952.a3ad.14.28.14.2001.20.10.hhit.arpa.

</pre><a href="#section-4-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="Other_HHIT">
<section id="section-5">
      <h2 id="name-other-utm-uses-of-hhits">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-other-utm-uses-of-hhits" class="section-name selfRef">Other UTM uses of HHITs</a>
      </h2>
<p id="section-5-1">
 HHITs can be used extensively within the UTM architecture beyond 
 UA ID (and USS in UA ID registration and authentication).  This 
 includes a GCS HHIT ID.  It could use this if it is the source of 
 Network Remote ID for securing the transport and for secure C2 
 transport <span>[<a href="#I-D.moskowitz-drip-secure-nrid-c2" class="xref">drip-secure-nrid-c2</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
 Observers SHOULD have HHITs to facilitate UAS information retrieval 
 (e.g., for authorization to private UAS data).  They could also use 
 their HHIT for establishing a HIP connection with the UA Pilot for 
 direct communications per authorization.  Further, they can be used by FINDER 
 observers, <span>[<a href="#I-D.moskowitz-drip-crowd-sourced-rid" class="xref">crowd-sourced-rid</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Reqs">
<section id="section-6">
      <h2 id="name-drip-requirements-addressed">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-drip-requirements-addressed" class="section-name selfRef">DRIP Requirements addressed</a>
      </h2>
<p id="section-6-1">
 This document provides solutions to GEN 1 - 3, ID 1 - 5, and REG 1 
 - 2.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ASTM">
<section id="section-7">
      <h2 id="name-astm-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-astm-considerations" class="section-name selfRef">ASTM Considerations</a>
      </h2>
<p id="section-7-1">
   ASTM will need to make the following changes to the "UA 
   ID" in the Basic Message (Msg Type 0x0):<a href="#section-7-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-7-2">
        <dt id="section-7-2.1">Type 4:</dt>
        <dd style="margin-left: 1.5em" id="section-7-2.2">
 This document UA ID of Hierarchical HITs (see <a href="#HHIT_RID" class="xref">Section 3</a>).<a href="#section-7-2.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">
   IANA will need to make the following changes to the "Host 
   Identity Protocol (HIP) Parameters" registries:<a href="#section-8-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8-2">
        <dt id="section-8-2.1">Host ID:</dt>
        <dd style="margin-left: 1.5em" id="section-8-2.2">
 This document defines the new EdDSA Host ID (see <a href="#host_id" class="xref">Appendix D.1</a>).<a href="#section-8-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-8-2.3">HIT Suite ID:</dt>
        <dd style="margin-left: 1.5em" id="section-8-2.4">
 This document defines the new HIT Suite of EdDSA/cSHAKE 
 (see <a href="#hit_suite_list" class="xref">Appendix D.2</a>).<a href="#section-8-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-8-2.5">HIT Suite ID:</dt>
        <dd style="margin-left: 1.5em" id="section-8-2.6">
 This document defines two new HDA domain HIT Suites
 (see <a href="#Eight_bit_OGA" class="xref">Appendix B.2.1</a>).<a href="#section-8-2.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-8-3">
 Because HHIT format is not compatible with <span>[<a href="#RFC7343" class="xref">RFC7343</a>]</span>, IANA is requested to allocated a new 
 28-bit prefix out of the IANA IPv6 Special Purpose Address Block, 
 namely 2001:0000::/23, as per <span>[<a href="#RFC6890" class="xref">RFC6890</a>]</span>.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">
 A 64 bit hash space presents a real risk of second pre-image 
 attacks <a href="#Collision" class="xref">Section 9.2</a>.  The HHIT 
 Registry services effectively block attempts to "take over" a HHIT. 
 It does not stop a rogue attempting to impersonate a known HHIT. 
 This attack can be mitigated by the receiver of the HHIT using DNS 
 to find the HI for the HHIT.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">
 Another mitigation of HHIT hijacking is if the HI owner (UA) 
 supplies an object containing the HHIT and signed by the HI private 
 key of the HDA such as <a href="#Offline_Self_Claim" class="xref">Appendix E.1</a> as shown in <a href="#RID_Auth" class="xref">Section 3.4</a>.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">
 The two risks with hierarchical HITs are the use of an invalid HID 
 and forced HIT collisions.  The use of a DNS zone (e.g. 
 "hhit.arpa.") is a strong protection against invalid HIDs.  
 Querying an HDA's RVS for a HIT under the HDA protects against 
 talking to unregistered clients.  The Registry service has direct 
 protection against forced or accidental HIT hash collisions.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">
 Cryptographically Generated Addresses (CGAs) provide a unique 
 assurance of uniqueness.  This is two-fold.  The address (in this 
 case the UAS ID) is a hash of a public key and a Registry hierarchy 
 naming.  Collision resistance (more important that it implied 
 second-preimage resistance) makes it statistically challenging to 
 attacks.  A registration process (TBD) within the HDA provides a 
 level of assured uniqueness unattainable without mirroring this 
 approach.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">
 The second aspect of assured uniqueness is the digital signing 
 process of the HHIT by the HI private key and the further signing 
 of the HI public key by the Registry's key.  This completes the 
 ownership process.  The observer at this point does not know WHAT 
 owns the HHIT, but is assured, other than the risk of theft of the 
 HI private key, that this UAS ID is owned by something and is 
 properly registered.<a href="#section-9-5" class="pilcrow">¶</a></p>
<div id="HHIT_trust">
<section id="section-9.1">
        <h3 id="name-hierarchical-hit-trust">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-hierarchical-hit-trust" class="section-name selfRef">Hierarchical HIT Trust</a>
        </h3>
<p id="section-9.1-1">
 The HHIT UAS RID in the ASTM Basic Message (Msg Type 0x0, the 
 actual Remote ID message) does not provide any assertion of trust. 
 The best that might be done within this Basic Message is 4 bytes 
 truncated from a HI signing of the HHIT (the UA ID field is 20 
 bytes and a HHIT is 16).  This is not trustable.  Minimally, it 
 takes 84 bytes, <a href="#Self_Claim" class="xref">Appendix E</a>, to 
 prove ownership of a HHIT.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">
 The ASTM Authentication Messages (Msg Type 0x2) as shown in <a href="#RID_Auth" class="xref">Section 3.4</a> can provide practical actual 
 ownership proofs.  These claims include timestamps to defend 
 against replay attacks.  But in themselves, they do not prove which 
 UA actually sent the message. They could have been sent by a dog 
 running down the street with a Broadcast Remote ID device strapped 
 to its back.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">
 Proof of UA transmission comes when the Authentication Message 
 includes proofs for the ASTM Location/Vector Message (Msg Type 0x1) 
 and the observer can see the UA or that information is validated by 
 ground multilateration <span>[<a href="#I-D.moskowitz-drip-crowd-sourced-rid" class="xref">crowd-sourced-rid</a>]</span>. 
 Only then does an observer gain full trust in the HHIT Remote ID.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">
 HHIT Remote IDs obtained via the Network Remote ID path provides a 
 different approach to trust.  Here the UAS SHOULD be securely 
 communicating to the USS (see <span>[<a href="#I-D.moskowitz-drip-secure-nrid-c2" class="xref">drip-secure-nrid-c2</a>]</span>), 
 thus asserting HHIT RID trust.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Collision">
<section id="section-9.2">
        <h3 id="name-collision-risks-with-hierar">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-collision-risks-with-hierar" class="section-name selfRef">Collision risks with Hierarchical HITs</a>
        </h3>
<p id="section-9.2-1">
 The 64 bit hash size does have an increased risk of collisions over 
 the 96 bit hash size used for the other HIT Suites.  There is a 
 0.01% probability of a collision in a population of 66 million. The 
 probability goes up to 1% for a population of 663 million.  See 
 <a href="#Coll_Prob" class="xref">Appendix F</a> for the collision 
 probability formula.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">
 However, this risk of collision is within a single "Additional 
 Information" value, i.e. a RAA/HDA domain. The UAS/USS registration 
 process should include registering the HHIT and MUST reject a 
 collision, forcing the UAS to generate a new HI and thus HHIT and 
 reapplying to the registration process.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="F3411-19">[F3411-19]</dt>
        <dd>
<span class="refAuthor">ASTM International</span>, <span class="refTitle">"Standard Specification for Remote ID and Tracking"</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="http://www.astm.org/cgi-bin/resolver.cgi?F3411">http://www.astm.org/cgi-bin/resolver.cgi?F3411</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-185">[NIST.SP.800-185]</dt>
        <dd>
<span class="refAuthor">Kelsey, J.</span><span class="refAuthor">, Change, S.</span><span class="refAuthor">, and R. Perlner</span>, <span class="refTitle">"SHA-3 derived functions: cSHAKE, KMAC, TupleHash and ParallelHash"</span>, <span class="seriesInfo">National Institute of Standards and Technology report</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-185</span>, <time datetime="2016-12" class="refDate">December 2016</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.sp.800-185">https://doi.org/10.6028/nist.sp.800-185</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6890">[RFC6890]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Vegoda, L.</span><span class="refAuthor">, Bonica, R., Ed.</span><span class="refAuthor">, and B. Haberman</span>, <span class="refTitle">"Special-Purpose IP Address Registries"</span>, <span class="seriesInfo">BCP 153</span>, <span class="seriesInfo">RFC 6890</span>, <span class="seriesInfo">DOI 10.17487/RFC6890</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6890">https://www.rfc-editor.org/info/rfc6890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span><span class="refAuthor"> and I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="corus">[corus]</dt>
        <dd>
<span class="refAuthor">CORUS</span>, <span class="refTitle">"U-space Concept of Operations"</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://www.sesarju.eu/node/3411">https://www.sesarju.eu/node/3411</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.moskowitz-drip-crowd-sourced-rid">[crowd-sourced-rid]</dt>
        <dd>
<span class="refAuthor">Moskowitz, R.</span><span class="refAuthor">, Card, S.</span><span class="refAuthor">, Wiethuechter, A.</span><span class="refAuthor">, Zhao, S.</span><span class="refAuthor">, and H. Birkholz</span>, <span class="refTitle">"Crowd Sourced Remote ID"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-moskowitz-drip-crowd-sourced-rid-04</span>, <time datetime="2020-05-20" class="refDate">20 May 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-moskowitz-drip-crowd-sourced-rid-04">https://tools.ietf.org/html/draft-moskowitz-drip-crowd-sourced-rid-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CTA2063A">[CTA2063A]</dt>
        <dd>
<span class="refAuthor">ANSI</span>, <span class="refTitle">"Small Unmanned Aerial Systems Serial Numbers"</span>, <time datetime="2019-09" class="refDate">September 2019</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-drip-reqs">[drip-requirements]</dt>
        <dd>
<span class="refAuthor">Card, S.</span><span class="refAuthor">, Wiethuechter, A.</span><span class="refAuthor">, Moskowitz, R.</span><span class="refAuthor">, and A. Gurtov</span>, <span class="refTitle">"Drone Remote Identification Protocol (DRIP) Requirements"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-drip-reqs-04</span>, <time datetime="2020-08-25" class="refDate">25 August 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-drip-reqs-04">https://tools.ietf.org/html/draft-ietf-drip-reqs-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.moskowitz-drip-secure-nrid-c2">[drip-secure-nrid-c2]</dt>
        <dd>
<span class="refAuthor">Moskowitz, R.</span><span class="refAuthor">, Card, S.</span><span class="refAuthor">, Wiethuechter, A.</span><span class="refAuthor">, and A. Gurtov</span>, <span class="refTitle">"Secure UAS Network RID and C2 Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-moskowitz-drip-secure-nrid-c2-01</span>, <time datetime="2020-09-27" class="refDate">27 September 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-moskowitz-drip-secure-nrid-c2-01">https://tools.ietf.org/html/draft-moskowitz-drip-secure-nrid-c2-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Keccak">[Keccak]</dt>
        <dd>
<span class="refAuthor">Bertoni, G.</span><span class="refAuthor">, Daemen, J.</span><span class="refAuthor">, Peeters, M.</span><span class="refAuthor">, Van Assche, G.</span><span class="refAuthor">, and R. Van Keer</span>, <span class="refTitle">"The Keccak Function"</span>, <span>&lt;<a href="https://keccak.team/index.html">https://keccak.team/index.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4122">[RFC4122]</dt>
        <dd>
<span class="refAuthor">Leach, P.</span><span class="refAuthor">, Mealling, M.</span><span class="refAuthor">, and R. Salz</span>, <span class="refTitle">"A Universally Unique IDentifier (UUID) URN Namespace"</span>, <span class="seriesInfo">RFC 4122</span>, <span class="seriesInfo">DOI 10.17487/RFC4122</span>, <time datetime="2005-07" class="refDate">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4122">https://www.rfc-editor.org/info/rfc4122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5730">[RFC5730]</dt>
        <dd>
<span class="refAuthor">Hollenbeck, S.</span>, <span class="refTitle">"Extensible Provisioning Protocol (EPP)"</span>, <span class="seriesInfo">STD 69</span>, <span class="seriesInfo">RFC 5730</span>, <span class="seriesInfo">DOI 10.17487/RFC5730</span>, <time datetime="2009-08" class="refDate">August 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5730">https://www.rfc-editor.org/info/rfc5730</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7343">[RFC7343]</dt>
        <dd>
<span class="refAuthor">Laganier, J.</span><span class="refAuthor"> and F. Dupont</span>, <span class="refTitle">"An IPv6 Prefix for Overlay Routable Cryptographic Hash Identifiers Version 2 (ORCHIDv2)"</span>, <span class="seriesInfo">RFC 7343</span>, <span class="seriesInfo">DOI 10.17487/RFC7343</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7343">https://www.rfc-editor.org/info/rfc7343</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7401">[RFC7401]</dt>
        <dd>
<span class="refAuthor">Moskowitz, R., Ed.</span><span class="refAuthor">, Heer, T.</span><span class="refAuthor">, Jokela, P.</span><span class="refAuthor">, and T. Henderson</span>, <span class="refTitle">"Host Identity Protocol Version 2 (HIPv2)"</span>, <span class="seriesInfo">RFC 7401</span>, <span class="seriesInfo">DOI 10.17487/RFC7401</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7401">https://www.rfc-editor.org/info/rfc7401</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8004">[RFC8004]</dt>
        <dd>
<span class="refAuthor">Laganier, J.</span><span class="refAuthor"> and L. Eggert</span>, <span class="refTitle">"Host Identity Protocol (HIP) Rendezvous Extension"</span>, <span class="seriesInfo">RFC 8004</span>, <span class="seriesInfo">DOI 10.17487/RFC8004</span>, <time datetime="2016-10" class="refDate">October 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8004">https://www.rfc-editor.org/info/rfc8004</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8005">[RFC8005]</dt>
      <dd>
<span class="refAuthor">Laganier, J.</span>, <span class="refTitle">"Host Identity Protocol (HIP) Domain Name System (DNS) Extension"</span>, <span class="seriesInfo">RFC 8005</span>, <span class="seriesInfo">DOI 10.17487/RFC8005</span>, <time datetime="2016-10" class="refDate">October 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8005">https://www.rfc-editor.org/info/rfc8005</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Uspace">
<section id="section-appendix.a">
      <h2 id="name-eu-u-space-rid-privacy-cons">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-eu-u-space-rid-privacy-cons" class="section-name selfRef">EU U-Space RID Privacy Considerations</a>
      </h2>
<p id="section-appendix.a-1">
 EU is defining a future of airspace management known as U-space 
 within the Single European Sky ATM Research (SESAR) undertaking. 
 Concept of Operation for EuRopean UTM Systems (CORUS) project 
 proposed low-level <span><a href="#corus" class="xref">Concept of 
 Operations</a> [<a href="#corus" class="xref">corus</a>]</span> for UAS in EU. It introduces strong requirements 
 for UAS privacy based on European GDPR regulations.  It suggests 
 that UAs are identified with agnostic IDs, with no information 
 about UA type, the operators or flight trajectory.  Only authorized 
 persons should be able to query the details of the flight with a 
 record of access.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">
 Due to the high privacy requirements, a casual observer can only 
 query U-space if it is aware of a UA seen in a certain area. A 
 general observer can use a public U-space portal to query UA 
 details based on the UA transmitted "Remote identification" signal.  
 Direct remote identification (DRID) is based on a signal 
 transmitted by the UA directly.  Network remote identification 
 (NRID) is only possible for UAs being tracked by U-Space and is 
 based on the matching the current UA position to one of the tracks.<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
<p id="section-appendix.a-3">
 The project lists "E-Identification" and "E-Registrations" services 
 as to be developed.  These services can follow the privacy 
 mechanism proposed in this document.  If an "agnostic ID" above 
 refers to a completely random identifier, it creates a problem with 
 identity resolution and detection of misuse.  On the other hand, a 
 classical HIT has a flat structure which makes its resolution 
 difficult.  The Hierarchical HITs provide a balanced solution by 
 associating a registry with the UA identifier. This is not likely 
 to cause a major conflict with U-space privacy requirements, as the 
 registries are typically few at a country level (e.g. civil 
 personal, military, law enforcement, or commercial).<a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="HHIT">
<section id="section-appendix.b">
      <h2 id="name-the-hierarchical-host-ident">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-the-hierarchical-host-ident" class="section-name selfRef">The Hierarchical Host Identity Tag (HHIT)</a>
      </h2>
<p id="section-appendix.b-1">
 The Hierarchical HIT (HHIT) is a small but important enhancement 
 over the flat HIT space.  By adding two levels of hierarchical 
 administration control, the HHIT provides for device 
 registration/ownership, thereby enhancing the trust framework for 
 HITs.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">
 HHITs represent the HI in only a 64 bit hash and uses the other 32 
 bits to create a hierarchical administration organization for HIT 
 domains.  Hierarchical HIT construction is defined in <a href="#ORCHIDs" class="xref">Appendix C</a>. The input values for the 
 Encoding rules are in <a href="#HCGA" class="xref">Appendix C.1</a>.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<p id="section-appendix.b-3">
 A HHIT is built from the following fields:<a href="#section-appendix.b-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.b-4.1">
 IANA prefix (max 28 bit)<a href="#section-appendix.b-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-4.2">
 32 bit Hierarchy ID (HID)<a href="#section-appendix.b-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-4.3">
 4 (or 8) bit HIT Suite ID<a href="#section-appendix.b-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-4.4">
 ORCHID hash (96 - prefix length - Suite ID length bits, e.g. 64)
 See <a href="#ORCHIDs" class="xref">Appendix C</a><a href="#section-appendix.b-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<div id="Prefix">
<section id="section-b.1">
        <h2 id="name-hhit-prefix">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-hhit-prefix" class="section-name selfRef">HHIT prefix</a>
        </h2>
<p id="section-b.1-1">
 A unique IANA IPv6 prefix, no larger than 28 bit, for HHITs is 
 recommended.  It clearly separates the flat-space HIT processing 
 from HHIT processing per <a href="#ORCHIDs" class="xref">Appendix C</a>.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<p id="section-b.1-2">
 Without a unique prefix, the first 4 bits of the RRA would be 
 interpreted as the HIT Suite ID per <span><a href="#RFC7401" class="xref">HIPv2</a> [<a href="#RFC7401" class="xref">RFC7401</a>]</span>.<a href="#section-b.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="HHIT_Suite">
<section id="section-b.2">
        <h2 id="name-hhit-suite-ids">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-hhit-suite-ids" class="section-name selfRef">HHIT Suite IDs</a>
        </h2>
<p id="section-b.2-1">
 The HIT Suite IDs specifies the HI and hash algorithms.  Any HIT 
 Suite ID can be used for HHITs. The 8 bit format is supported (only 
 when the first 4 bits are ZERO), but this reduces the ORCHID hash 
 length.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
<div id="Eight_bit_OGA">
<section id="section-b.2.1">
          <h3 id="name-8-bit-hit-suite-ids">
<a href="#section-b.2.1" class="section-number selfRef">B.2.1. </a><a href="#name-8-bit-hit-suite-ids" class="section-name selfRef">8 bit HIT Suite IDs</a>
          </h3>
<p id="section-b.2.1-1">
 Support for 8 bit HIT Suite IDs is allowed in Sec 5.2.10, <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span>, but not specified in how 
 ORCHIDs are generated with these longer OGAs.  <a href="#ORCHIDs" class="xref">Appendix C</a> provides the algorithmic 
 flexiblity, allowing for HDA custom HIT Suite IDs as follows:<a href="#section-b.2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.1-2">
<pre>

     HIT Suite       Four-bit ID    Eight-bit encoding
     HDA Assigned 1            NA             0x0E
     HDA Assigned 2            NA             0x0F

</pre><a href="#section-b.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-b.2.1-3">
 This feature may be used for large-scale experimenting with post 
 quantum computing hashes or similar domain specific needs.  Note 
 that currently there is no support for domain specific HI 
 algorithms.<a href="#section-b.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="HID">
<section id="section-b.3">
        <h2 id="name-the-hierarchy-id-hid">
<a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-the-hierarchy-id-hid" class="section-name selfRef">The Hierarchy ID (HID)</a>
        </h2>
<p id="section-b.3-1">
 The Hierarchy ID (HID) provides the structure to organize HITs into
 administrative domains.  HIDs are further divided into 2 fields:<a href="#section-b.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.3-2.1">
 16 bit Registered Assigning Authority (RAA)<a href="#section-b.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-b.3-2.2">
 16 bit Hierarchical HIT Domain Authority (HDA)<a href="#section-b.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<div id="RAA">
<section id="section-b.3.1">
          <h3 id="name-the-registered-assigning-au">
<a href="#section-b.3.1" class="section-number selfRef">B.3.1. </a><a href="#name-the-registered-assigning-au" class="section-name selfRef">The Registered Assigning Authority (RAA)</a>
          </h3>
<p id="section-b.3.1-1">
 An RAA is a business or organization that manages a registry of 
 HDAs.  For example, the Federal Aviation Authority (FAA) could be 
 an RAA.<a href="#section-b.3.1-1" class="pilcrow">¶</a></p>
<p id="section-b.3.1-2">
 The RAA is a 16 bit field (65,536 RAAs) assigned by a numbers 
 management organization, perhaps ICANN's IANA service.  An RAA must 
 provide a set of services to allocate HDAs to organizations. It 
 must have a public policy on what is necessary to obtain an HDA. 
 The RAA need not maintain any HIP related services. It must 
 maintain a DNS zone minimally for discovering HID RVS servers.<a href="#section-b.3.1-2" class="pilcrow">¶</a></p>
<p id="section-b.3.1-3">
 As HHITs may be used in many different domains, RAA should be 
 allocated in blocks with consideration on the likely size of a 
 particular usage.  Alternatively, different Prefixes can be used to 
 separate different domains of use of HHTs.<a href="#section-b.3.1-3" class="pilcrow">¶</a></p>
<p id="section-b.3.1-4">
 This DNS zone may be a PTR for its RAA.  It may be a zone in a HHIT 
 specific DNS zone.  Assume that the RAA is 100.  The PTR record 
 could be constructed:<a href="#section-b.3.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.3.1-5">
<pre>

100.hhit.arpa   IN PTR      raa.bar.com.

</pre><a href="#section-b.3.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="HDA">
<section id="section-b.3.2">
          <h3 id="name-the-hierarchical-hit-domain">
<a href="#section-b.3.2" class="section-number selfRef">B.3.2. </a><a href="#name-the-hierarchical-hit-domain" class="section-name selfRef">The Hierarchical HIT Domain Authority (HDA)</a>
          </h3>
<p id="section-b.3.2-1">
 An HDA may be an ISP or any third party that takes on the business 
 to provide RVS and other needed services for HIP enabled devices.<a href="#section-b.3.2-1" class="pilcrow">¶</a></p>
<p id="section-b.3.2-2">
 The HDA is an 16 bit field (65,536 HDAs per RAA) assigned by an 
 RAA.  An HDA should maintain a set of RVS servers that its client 
 HIP-enabled customers use.  How this is done and scales to the 
 potentially millions of customers is outside the scope of this 
 document.  This service should be discoverable through the DNS zone 
 maintained by the HDA's RAA.<a href="#section-b.3.2-2" class="pilcrow">¶</a></p>
<p id="section-b.3.2-3">
 An RAA may assign a block of values to an individual organization.  
 This is completely up to the individual RAA's published policy for 
 delegation.<a href="#section-b.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ORCHIDs">
<section id="section-appendix.c">
      <h2 id="name-orchids-for-hierarchical-hi">
<a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-orchids-for-hierarchical-hi" class="section-name selfRef">ORCHIDs for Hierarchical HITs</a>
      </h2>
<p id="section-appendix.c-1"> 
 This section improves on <span><a href="#RFC7343" class="xref">ORCHIDv2</a> [<a href="#RFC7343" class="xref">RFC7343</a>]</span> with three enhancements:<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.c-2.1">
 Optional Info field between the Prefix and OGA ID.<a href="#section-appendix.c-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.2">
 Increased flexibility on the length of each component in the 
 ORCHID construction, provided the resulting ORCHID is 128 
 bits.<a href="#section-appendix.c-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.3">
 Use of cSHAKE, <span><a href="#NIST.SP.800-185" class="xref">NIST SP 800-185</a> [<a href="#NIST.SP.800-185" class="xref">NIST.SP.800-185</a>]</span>, for the hashing 
 function.<a href="#section-appendix.c-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.c-3"> 
 The <span>[<a href="#Keccak" class="xref">Keccak</a>]</span> based 
 cSHAKE XOF hash function is a variable output length hash function.  
 As such it does not use the truncation operation that other hashes 
 need.  The invocation of cSHAKE specifies the desired number of 
 bits in the hash output.  Further, cSHAKE has a parameter 'S' as a 
 customization bit string.  This parameter will be used for 
 including the ORCHID Context Identifier in a standard fashion.<a href="#section-appendix.c-3" class="pilcrow">¶</a></p>
<p id="section-appendix.c-4">
 This ORCHID construction includes the fields in the ORCHID in the 
 hash to protect them against substitution attacks.  It also provides 
 for inclusion of additional information, in particular the 
 hierarchical bits of the Hierarchical HIT, in the ORCHID 
 generation.  This should be viewed as an addendum to <span><a href="#RFC7343" class="xref">ORCHIDv2</a> [<a href="#RFC7343" class="xref">RFC7343</a>]</span>, as it can 
 produce ORCHIDv2 output.<a href="#section-appendix.c-4" class="pilcrow">¶</a></p>
<div id="HCGA">
<section id="section-c.1">
        <h2 id="name-adding-additional-informati">
<a href="#section-c.1" class="section-number selfRef">C.1. </a><a href="#name-adding-additional-informati" class="section-name selfRef">Adding additional information to the ORCHID</a>
        </h2>
<p id="section-c.1-1">
 ORCHIDv2 <span>[<a href="#RFC7343" class="xref">RFC7343</a>]</span> is currently 
 defined as consisting of three components:<a href="#section-c.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.1-2">
<pre>

ORCHID     :=  Prefix | OGA ID | Encode_96( Hash )

where:

Prefix          : A constant 28-bit-long bitstring value
                  (IANA IPv6 assigned).

OGA ID          : A 4-bit long identifier for the Hash_function
                  in use within the specific usage context.  When
                  used for HIT generation this is the HIT Suite ID.

Encode_96( )    : An extraction function in which output is obtained
                  by extracting the middle 96-bit-long bitstring
                  from the argument bitstring.


</pre><a href="#section-c.1-2" class="pilcrow">¶</a>
</div>
<p id="section-c.1-3">
 This addendum will be constructed as follows:<a href="#section-c.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.1-4">
<pre>

ORCHID     :=  Prefix (p) | Info (n) | OGA ID (o) | Hash (m)

where:

Prefix (p)      : An IANA IPv6 assigned prefix (max 28-bit-long).

Info (n)        : n bits of information that define a use of the
                  ORCHID.  n can be zero, that is no additional
                  information.

OGA ID (o)      : A 4 or 8 bit long identifier for the Hash_function
                  in use within the specific usage context.  When
                  used for HIT generation this is the HIT Suite ID.

Hash (m)        : An extraction function in which output is m bits.

p + n + o + m = 128 bits


</pre><a href="#section-c.1-4" class="pilcrow">¶</a>
</div>
<p id="section-c.1-5">
 With a 28 bit IPv6 Prefix, the remaining 100 bits can be divided in 
 any manner between the additional information, OGA ID, and the hash 
 output.  Care must be taken in determining the size of the hash 
 portion, taking into account risks like pre-image attacks. Thus 64 
 bits as used in Hierarchical HITs may be as small as is acceptable.<a href="#section-c.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Encode">
<section id="section-c.2">
        <h2 id="name-orchid-encoding">
<a href="#section-c.2" class="section-number selfRef">C.2. </a><a href="#name-orchid-encoding" class="section-name selfRef">ORCHID Encoding</a>
        </h2>
<p id="section-c.2-1">
 This addendum adds a different encoding process to that currently 
 used in ORCHIDv2.  The input to the hash function explicitly 
 includes all the header content plus the Context ID.  The header 
 content consists of the Prefix, the Additional Information, and OGA 
 ID (HIT Suite ID). Secondly, the length of the resulting hash is 
 set by sum of the length of the ORCHID header fields.  For example, 
 a 28 bit Prefix with 32 bits for the HID and 4 bits for the OGA ID 
 leaves 64 bits for the hash length.<a href="#section-c.2-1" class="pilcrow">¶</a></p>
<p id="section-c.2-2">
 To achieve the variable length output in a consistent manner, the 
 cSHAKE hash is used.  For this purpose, cSHAKE128 is appropriate.  
 The the cSHAKE function call for this addendum is:<a href="#section-c.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.2-3">
<pre>

    cSHAKE128(Input, L, "", Context ID)

    Input      :=  Prefix | Additional Information | OGA ID | HOST_ID
    L          :=  Length in bits of hash portion of ORCHID
    Context ID :=  0x00B5 A69C 795D F5D5 F008 7F56 843F 2C40

</pre><a href="#section-c.2-3" class="pilcrow">¶</a>
</div>
<p id="section-c.2-4">
 For full Suite ID support (those that use fixed length hashes like 
 SHA256), the following hashing can be used (Note: this does NOT 
 produce output Identical to ORCHIDv2 for Prefix of /28 and 
 Additional Information of ZERO length):<a href="#section-c.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.2-5">
<pre>

    Hash[L](Context ID | Input)

    Input      :=  Prefix | Additional Information | OGA ID | HOST_ID
    L          :=  Length in bits of hash portion of ORCHID
    Context ID :=  0x00B5 A69C 795D F5D5 F008 7F56 843F 2C40

    Hash[L]    :=  An extraction function in which output is obtained
                   by extracting the middle L-bit-long bitstring
                   from the argument bitstring.

</pre><a href="#section-c.2-5" class="pilcrow">¶</a>
</div>
<p id="section-c.2-6">
 Hierarchical HIT uses the same context as all other HIPv2 HIT 
 Suites as they are clearly separated by the distinct HIT Suite ID.<a href="#section-c.2-6" class="pilcrow">¶</a></p>
<div id="HITv2_Encode">
<section id="section-c.2.1">
          <h3 id="name-encoding-orchids-for-hitv2">
<a href="#section-c.2.1" class="section-number selfRef">C.2.1. </a><a href="#name-encoding-orchids-for-hitv2" class="section-name selfRef">Encoding ORCHIDs for HITv2</a>
          </h3>
<p id="section-c.2.1-1">
 This section is included to provide backwards compatibility for <span><a href="#RFC7343" class="xref">ORCHIDv2</a> [<a href="#RFC7343" class="xref">RFC7343</a>]</span> as used for <span><a href="#RFC7401" class="xref">HITv2</a> [<a href="#RFC7401" class="xref">RFC7401</a>]</span>.<a href="#section-c.2.1-1" class="pilcrow">¶</a></p>
<p id="section-c.2.1-2">
 For HITv2s, the Prefix MUST be 2001:20::/28. Info is length ZERO 
 (not included), and OGA ID is length 4.  Thus the HI Hash is length 
 96.  Further the Prefix and OGA ID are NOT included in the hash 
 calculation. Thus the following ORCHID calculations for fixed 
 output length hashes are used:<a href="#section-c.2.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.2.1-3">
<pre>

    Hash[L](Context ID | Input)

    Input      :=  HOST_ID
    L          :=  96
    Context ID :=  0xF0EF F02F BFF4 3D0F E793 0C3C 6E61 74EA

    Hash[L]    :=  An extraction function in which output is obtained
                   by extracting the middle L-bit-long bitstring
                   from the argument bitstring.

</pre><a href="#section-c.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-c.2.1-4">
 For variable output length  hashes use:<a href="#section-c.2.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.2.1-5">
<pre>

    Hash[L](Context ID | Input)

    Input      :=  HOST_ID
    L          :=  96
    Context ID :=  0xF0EF F02F BFF4 3D0F E793 0C3C 6E61 74EA

    Hash[L]    :=  The L bit output from the hash function

</pre><a href="#section-c.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-c.2.1-6">
 Then the ORCHID is constructed as follows:<a href="#section-c.2.1-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.2.1-7">
<pre>

    Prefix | OGA ID | Hash Output

</pre><a href="#section-c.2.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Decode">
<section id="section-c.3">
        <h2 id="name-orchid-decoding">
<a href="#section-c.3" class="section-number selfRef">C.3. </a><a href="#name-orchid-decoding" class="section-name selfRef">ORCHID Decoding</a>
        </h2>
<p id="section-c.3-1">
 With this addendum, the decoding of an ORCHID is determined by the 
 Prefix and OGA ID (HIT Suite ID).  ORCHIDv2 <span>[<a href="#RFC7343" class="xref">RFC7343</a>]</span> decoding is selected when the Prefix is: 
 2001:20::/28.<a href="#section-c.3-1" class="pilcrow">¶</a></p>
<p id="section-c.3-2">
 For Hierarchical HITs, the decoding is determined by the presence 
 of the HHIT Prefix as specified in the HHIT document.<a href="#section-c.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="HITv2_Decode">
<section id="section-c.4">
        <h2 id="name-decoding-orchids-for-hitv2">
<a href="#section-c.4" class="section-number selfRef">C.4. </a><a href="#name-decoding-orchids-for-hitv2" class="section-name selfRef">Decoding ORCHIDs for HITv2</a>
        </h2>
<p id="section-c.4-1">
 This section is included to provide backwards compatibility for <span><a href="#RFC7343" class="xref">ORCHIDv2</a> [<a href="#RFC7343" class="xref">RFC7343</a>]</span> as used for <span><a href="#RFC7401" class="xref">HITv2</a> [<a href="#RFC7401" class="xref">RFC7401</a>]</span>.<a href="#section-c.4-1" class="pilcrow">¶</a></p>
<p id="section-c.4-2">
 HITv2s are identified by a Prefix of 2001:20::/28. The next 4 bits 
 are the OGA ID. is length 4.  The remaining 96 bits are the HI Hash.<a href="#section-c.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="EdDSA">
<section id="section-appendix.d">
      <h2 id="name-edward-digital-signature-al">
<a href="#section-appendix.d" class="section-number selfRef">Appendix D. </a><a href="#name-edward-digital-signature-al" class="section-name selfRef">Edward Digital Signature Algorithm for HITs</a>
      </h2>
<p id="section-appendix.d-1">
 Edwards-Curve Digital Signature Algorithm (EdDSA) <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> are specified here for 
 use as Host Identities (HIs) per <span><a href="#RFC7401" class="xref">HIPv2</a> [<a href="#RFC7401" class="xref">RFC7401</a>]</span>.  Further the HIT_SUITE_LIST is 
 specified as used in <span>[<a href="#RFC7343" class="xref">RFC7343</a>]</span>.<a href="#section-appendix.d-1" class="pilcrow">¶</a></p>
<p id="section-appendix.d-2">
 See <a href="#HHIT_Suite" class="xref">Appendix B.2</a> for use of the HIT 
 Suite for this document.<a href="#section-appendix.d-2" class="pilcrow">¶</a></p>
<div id="host_id">
<section id="section-d.1">
        <h2 id="name-host_id">
<a href="#section-d.1" class="section-number selfRef">D.1. </a><a href="#name-host_id" class="section-name selfRef">HOST_ID</a>
        </h2>
<p id="section-d.1-1">
 The HOST_ID parameter specifies the public key algorithm, and for 
 elliptic curves, a name.  The HOST_ID parameter is defined in 
 Section 5.2.19 of <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span>.<a href="#section-d.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-d.1-2">
<pre>

     Algorithm
     profiles         Values

     EdDSA            13 [RFC8032]       (RECOMMENDED)

</pre><a href="#section-d.1-2" class="pilcrow">¶</a>
</div>
<p id="section-d.1-3">
 For hosts that implement EdDSA as the algorithm, the following ECC 
 curves are available:<a href="#section-d.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-d.1-4">
<pre>

     Algorithm    Curve            Values

     EdDSA        RESERVED         0
     EdDSA        EdDSA25519       1 [RFC8032]
     EdDSA        EdDSA25519ph     2 [RFC8032]
     EdDSA        EdDSA448         3 [RFC8032]
     EdDSA        EdDSA448ph       4 [RFC8032]

</pre><a href="#section-d.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="hit_suite_list">
<section id="section-d.2">
        <h2 id="name-hit_suite_list">
<a href="#section-d.2" class="section-number selfRef">D.2. </a><a href="#name-hit_suite_list" class="section-name selfRef">HIT_SUITE_LIST</a>
        </h2>
<p id="section-d.2-1">
 The HIT_SUITE_LIST parameter contains a list of the supported HIT 
 suite IDs of the Responder. Based on the HIT_SUITE_LIST, the 
 Initiator can determine which source HIT Suite IDs are supported by 
 the Responder. The HIT_SUITE_LIST parameter is defined in Section 
 5.2.10 of <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span>.<a href="#section-d.2-1" class="pilcrow">¶</a></p>
<p id="section-d.2-2">
 The following HIT Suite ID is defined, and the relationship between 
 the four-bit ID value used in the OGA ID field and the eight-bit 
 encoding within the HIT_SUITE_LIST ID field is clarified:<a href="#section-d.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-d.2-3">
<pre>

     HIT Suite       Four-bit ID    Eight-bit encoding
     RESERVED            0             0x00
     EdDSA/cSHAKE128     5             0x50           (RECOMMENDED)

</pre><a href="#section-d.2-3" class="pilcrow">¶</a>
</div>
<p id="section-d.2-4">
 The following table provides more detail on the above HIT Suite 
 combinations.  The input for each generation algorithm is the 
 encoding of the HI as defined in this Appendix.<a href="#section-d.2-4" class="pilcrow">¶</a></p>
<p id="section-d.2-5">
 The output of cSHAKE128 is variable per the needs of a specific 
 ORCHID construction.  It is at most 96 bits long and is directly 
 used in the ORCHID (without truncation).<a href="#section-d.2-5" class="pilcrow">¶</a></p>
<span id="name-hit-suites"></span><div id="table_hit_suites">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-hit-suites" class="selfRef">HIT Suites</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Hash function</th>
              <th class="text-left" rowspan="1" colspan="1">HMAC</th>
              <th class="text-left" rowspan="1" colspan="1">Signature algorithm family</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">cSHAKE128</td>
              <td class="text-left" rowspan="1" colspan="1">KMAC128</td>
              <td class="text-left" rowspan="1" colspan="1">EdDSA</td>
              <td class="text-left" rowspan="1" colspan="1">EdDSA HI hashed with cSHAKE128, output is variable</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="Self_Claim">
<section id="section-appendix.e">
      <h2 id="name-example-hhit-self-claim">
<a href="#section-appendix.e" class="section-number selfRef">Appendix E. </a><a href="#name-example-hhit-self-claim" class="section-name selfRef">Example HHIT Self Claim</a>
      </h2>
<p id="section-appendix.e-1">
 This section shows example uses of HHIT RID to prove 
 trustworthiness of the RID.  These are examples only and other 
 documents will provide fully specified claims.  Care has been taken 
 in the example design to minimize the risk of replay attacks.<a href="#section-appendix.e-1" class="pilcrow">¶</a></p>
<p id="section-appendix.e-2">
 Ownership of a HHIT can be proved in 84 bytes via the following 
 HHIT Self Claim:<a href="#section-appendix.e-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-3.1">
 4 byte Signing Timestamp<a href="#section-appendix.e-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.e-3.2">
 16 byte HHIT<a href="#section-appendix.e-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.e-3.3">
 64 byte Signature (EdDSA25519 signature)<a href="#section-appendix.e-3.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.e-4">
 The Timestamp MAY be the standard UNIX time at the time of signing. 
 A protocol specific timestamp may be used to avoid programming 
 complexities.  For example, <span>[<a href="#F3411-19" class="xref">F3411-19</a>]</span> uses a 00:00:00 01/01/2019 offset.<a href="#section-appendix.e-4" class="pilcrow">¶</a></p>
<p id="section-appendix.e-5">
 To minimize the risk of replay, the UA SHOULD create a new 
 Self Claim, with a new timestamp, at least once a minute.  The UA 
 MAY precompute these claims and transmit during the appropriate 1 
 minute window.  1 minute is chosen as a balance between claim 
 compute time against risk.  A shorter window of use lessens the 
 risk of replay.<a href="#section-appendix.e-5" class="pilcrow">¶</a></p>
<p id="section-appendix.e-6">
 The signature is over the 20 byte Timestamp + HHIT.<a href="#section-appendix.e-6" class="pilcrow">¶</a></p>
<p id="section-appendix.e-7">
 The receiver of such a claim would need access to the underlying 
 public key (HI) to validate the signature.  This may be obtained 
 via a DNS query using the HHIT.  A larger (116 bytes) Self Claim 
 could include the EdDSA25519 HI.<a href="#section-appendix.e-7" class="pilcrow">¶</a></p>
<div id="Offline_Self_Claim">
<section id="section-e.1">
        <h2 id="name-hhit-offline-self-claim">
<a href="#section-e.1" class="section-number selfRef">E.1. </a><a href="#name-hhit-offline-self-claim" class="section-name selfRef">HHIT Offline Self Claim</a>
        </h2>
<p id="section-e.1-1">
 Ownership of a HHIT can be proved in 200 bytes without Internet 
 access and a small cache via the following HHIT Offline Self Claim:<a href="#section-e.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-e.1-2.1">
 16 byte UA HHIT<a href="#section-e.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-e.1-2.2">
 32 byte UA EdDSA25519 HI<a href="#section-e.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-e.1-2.3">
 4 byte HDA Signing Expiry Timestamp<a href="#section-e.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-e.1-2.4">
 16 byte HDA HHIT<a href="#section-e.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-e.1-2.5">
 64 byte HDA Signature (EdDSA25519 signature)<a href="#section-e.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-e.1-2.6">
 4 byte UA Signing Timestamp<a href="#section-e.1-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-e.1-2.7">
 64 byte UA Signature (EdDSA25519 signature)<a href="#section-e.1-2.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-e.1-3">
 The Timestamps MAY be the standard UNIX time at the time of 
 signing. A protocol specific timestamp may be used to avoid 
 programming complexities.  For example, <span>[<a href="#F3411-19" class="xref">F3411-19</a>]</span> uses a 00:00:00 01/01/2019 offset.<a href="#section-e.1-3" class="pilcrow">¶</a></p>
<p id="section-e.1-4">
 The HDA signature is over the 68 byte UA HHIT + UA HI + HDA Expiry 
 Timestamp + HDA HHIT. During the UA Registration process, the UA 
 would provide a Self Claim to the HDA.  The HDA would construct its 
 claim of registry with an Expiry Timestamp, its own HHIT, and its 
 signature, returning a 132 byte HDA Registry Claim to the UA.  The 
 UA would use this much the same way as its HHIT only in the Self 
 Claim above, creating a 200 byte Offline Self Claim.<a href="#section-e.1-4" class="pilcrow">¶</a></p>
<p id="section-e.1-5">
 The receiver of such a claim would need a cache of RAA ID, HDA ID, 
 HDA HHIT, and HDA HI (min 80 bytes per RAA/HDA).<a href="#section-e.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Coll_Prob">
<section id="section-appendix.f">
      <h2 id="name-calculating-collision-proba">
<a href="#section-appendix.f" class="section-number selfRef">Appendix F. </a><a href="#name-calculating-collision-proba" class="section-name selfRef">Calculating Collision Probabilities</a>
      </h2>
<p id="section-appendix.f-1">
 The accepted formula for calculating the probability of a collision 
 is:<a href="#section-appendix.f-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.f-2">
<pre>


    p = 1 - e^{-k^2/(2n)}


    P   Collision Probability
    n   Total possible population
    k   Actual population


</pre><a href="#section-appendix.f-2" class="pilcrow">¶</a>
</div>
<p id="section-appendix.f-3">
 The following table provides the approximate population size for a 
 collision for a given total population.<a href="#section-appendix.f-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.f-4">
<pre>

                       Deployed Population
     Total            With Collision Risk of
     Population         .01%            1%

     2^96                 4T           42T
     2^72                 1B           10B
     2^68               250M          2.5B
     2^64                66M          663M
     2^60                16M          160M

</pre><a href="#section-appendix.f-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<section id="section-appendix.g">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-appendix.g-1">
 Dr. Gurtov is an adviser on Cybersecurity to the Swedish Civil Aviation Administration.<a href="#section-appendix.g-1" class="pilcrow">¶</a></p>
<p id="section-appendix.g-2">
 Quynh Dang of NIST gave considerable guidance on using Keccak and 
 the NIST supporting documents.  Joan Deamen of the Keccak team was 
 especially helpful in many aspects of using Keccak.<a href="#section-appendix.g-2" class="pilcrow">¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.h">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Robert Moskowitz</span></div>
<div dir="auto" class="left"><span class="org">HTT Consulting</span></div>
<div dir="auto" class="left">
<span class="locality">Oak Park</span>, <span class="region">MI</span> <span class="postal-code">48237</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rgm@labs.htt-consult.com" class="email">rgm@labs.htt-consult.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stuart W. Card</span></div>
<div dir="auto" class="left"><span class="org">AX Enterprize, LLC</span></div>
<div dir="auto" class="left"><span class="street-address">4947 Commercial Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Yorkville</span>, <span class="region">NY</span> <span class="postal-code">13495</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stu.card@axenterprize.com" class="email">stu.card@axenterprize.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Adam Wiethuechter</span></div>
<div dir="auto" class="left"><span class="org">AX Enterprize, LLC</span></div>
<div dir="auto" class="left"><span class="street-address">4947 Commercial Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Yorkville</span>, <span class="region">NY</span> <span class="postal-code">13495</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:adam.wiethuechter@axenterprize.com" class="email">adam.wiethuechter@axenterprize.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andrei Gurtov</span></div>
<div dir="auto" class="left"><span class="org">Linköping University</span></div>
<div dir="auto" class="left"><span class="street-address">IDA</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">58183</span> <span class="locality">Linköping</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gurtov@acm.org" class="email">gurtov@acm.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
