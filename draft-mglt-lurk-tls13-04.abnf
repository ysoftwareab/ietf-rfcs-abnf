server_random = ServerHello.random
client_random = ClientHello.random
Ephemeral = provided
Ephemeral = provided
tag=last_exchange        -------->
freshness = sha256
ephemeral_method = secret_generated
handshake = handshake (x25519)
certificate = finger_print
secret_request = h_s, h_c, a_s, and a_c
sig_algo = ed25519
                                         InitCertVerifyResponse
                                           ephemeral
ephemeral_method = secret_generated
group = x25519,
key_exchange = public_key
signature = sig
tag=last_exchange        -------->
freshness = sha256
ephemeral_method = secret_provided
group = x25519
shared_secret = shared_secret
handshake = handshake
certificate = finger_print
secret_request = h_s, h_c, a_s, and a_c
sig_algo = ed25519
                                         InitCertVerifyResponse
                                           ephemeral
ephemeral_method = secret_provided
signature = sig
secret_request = h_c, h_s
handshake = ClientHello ... ServerHello
ephemeral = dhe_secret
handshake=client Finished  -------->
                                            NewTicketResponse
                                              session_id
                                              cookie
                                 <---------   tickets
handshake=client Finished
secret_request=binder_key
handshake=""
secret_request=binder_key
handshake=ClientHello
secret_request = h_c, h_s, a_c, a_s
handshake = ServerHello ... EncryptedExtensions
ephemeral = dhe_secret          -------->
                                            HandshakeAndAppResponse
                                              session_id
                                              secret_response
                                                keys
                                      <---------

secret_request=e_s
handshake=ClientHello
handshake = EncryptedExtensions ...
                   later of server Finished/EndOfEarlyData
handshake=CertificateRequest
app_n=N
                                            PostHandshakeResponse
                                              session_id
                                 <---------   certificate_verify

