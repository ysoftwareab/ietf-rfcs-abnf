<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Multiple Loss Ratio Search for Packet Throughput (MLRsearch)</title>
<meta content="Maciek Konstantynowicz" name="author">
<meta content="Vratko Polak" name="author">
<meta content="
       TODO: Update after all sections are ready. 
       This document proposes changes to  , specifically to packet
throughput search methodology, by defining a new search algorithm
referred to as Multiple Loss Ratio search (MLRsearch for short). Instead
of relying on binary search with pre-set starting offered load, it
proposes a novel approach discovering the starting point in the initial
phase, and then searching for packet throughput based on defined packet
loss ratio (PLR) input criteria and defined final trial duration time.
One of the key design principles behind MLRsearch is minimizing the
total test duration and searching for multiple packet throughput rates
(each with a corresponding PLR) concurrently, instead of doing it
sequentially. 
       The main motivation behind MLRsearch is the new set of challenges and
requirements posed by NFV (Network Function Virtualization),
specifically software based implementations of NFV data planes. Using
  in the experience of the authors yields often not repetitive
and not replicable end results due to a large number of factors that are
out of scope for this draft. MLRsearch aims to address this challenge
in a simple way of getting the same result sooner, so more repetitions
can be done to describe the replicability. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-bmwg-mlrsearch-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-bmwg-mlrsearch-02-333fbf4h.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Multiple Loss Ratio Search</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Konstantynowicz &amp; Polak</td>
<td class="center">Expires 8 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Benchmarking Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-bmwg-mlrsearch-02</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-07" class="published">7 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-08">8 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Konstantynowicz, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">V. Polak</div>
<div class="org">Cisco Systems</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Multiple Loss Ratio Search for Packet Throughput (MLRsearch)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">TODO: Update after all sections are ready.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document proposes changes to <span>[<a href="#RFC2544" class="xref">RFC2544</a>]</span>, specifically to packet
throughput search methodology, by defining a new search algorithm
referred to as Multiple Loss Ratio search (MLRsearch for short). Instead
of relying on binary search with pre-set starting offered load, it
proposes a novel approach discovering the starting point in the initial
phase, and then searching for packet throughput based on defined packet
loss ratio (PLR) input criteria and defined final trial duration time.
One of the key design principles behind MLRsearch is minimizing the
total test duration and searching for multiple packet throughput rates
(each with a corresponding PLR) concurrently, instead of doing it
sequentially.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">The main motivation behind MLRsearch is the new set of challenges and
requirements posed by NFV (Network Function Virtualization),
specifically software based implementations of NFV data planes. Using
<span>[<a href="#RFC2544" class="xref">RFC2544</a>]</span> in the experience of the authors yields often not repetitive
and not replicable end results due to a large number of factors that are
out of scope for this draft. MLRsearch aims to address this challenge
in a simple way of getting the same result sooner, so more repetitions
can be done to describe the replicability.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-7">
<a href="#name-status-of-this-memo-7" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-7">
<a href="#name-copyright-notice-7" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-7">
<a href="#name-table-of-contents-7" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-terminology-2" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-intentions-of-this-document" class="xref">Intentions of this document</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-rfc2544" class="xref">RFC2544</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-throughput-search" class="xref">Throughput search</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-problems" class="xref">Problems</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-repeatability-and-comparabi" class="xref">Repeatability and Comparability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-non-zero-target-loss-ratios" class="xref">Non-Zero Target Loss Ratios</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-solution-ideas" class="xref">Solution ideas</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-short-duration-trials" class="xref">Short duration trials</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-frmol-as-reasonable-start" class="xref">FRMOL as reasonable start</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-non-zero-loss-ratios" class="xref">Non-zero loss ratios</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-concurrent-ratio-search" class="xref">Concurrent ratio search</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-load-selection-heuristics-a" class="xref">Load selection heuristics and shortcuts</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-non-compliance-with-rfc2544" class="xref">Non-compliance with RFC2544</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-additional-requirements" class="xref">Additional Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-todo-search-stop-criteria" class="xref">TODO: Search Stop Criteria</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-reliability-of-test-equipme" class="xref">Reliability of Test Equipment</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="xref">7.2.1</a>.  <a href="#name-very-late-frames" class="xref">Very late frames</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-mlrsearch-background" class="xref">MLRsearch Background</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-mlrsearch-overview" class="xref">MLRsearch Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-sample-implementation" class="xref">Sample Implementation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-input-parameters" class="xref">Input Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-initial-phase" class="xref">Initial Phase</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-non-initial-phases" class="xref">Non-Initial Phases</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-fdio-csit-implementation" class="xref">FD.io CSIT Implementation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-additional-details" class="xref">Additional details</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#section-11.1.1" class="xref">11.1.1</a>.  <a href="#name-fdio-csit-input-parameters" class="xref">FD.io CSIT Input Parameters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-example-mlrsearch-run" class="xref">Example MLRsearch Run</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-iana-considerations-6" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-security-considerations-7" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-acknowledgements-5" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-references-5" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-normative-references-7" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-informative-references-5" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses-5" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="terminology">
<section id="section-1">
      <h2 id="name-terminology-2">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-terminology-2" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-1-1">TODO: Update after most other sections are updated.<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">TODO: The current text uses Throughput for the zero loss ratio load.
Is the capital T needed/useful?<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.2">DUT and SUT: see the definitions in https://gerrit.fd.io/r/c/csit/+/35545<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.3">Traffic Generator (TG) and Traffic Analyzer (TA): see
https://datatracker.ietf.org/doc/html/rfc6894#section-4
TODO: Maybe there is an earlier RFC?<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.4">Overall search time: the time it takes to find all required loads within
their precision goals, starting from zero trials measured at given
DUT configuration and traffic profile.<a href="#section-1-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.5">TODO: traffic profile?<a href="#section-1-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.6">Intended load: https://datatracker.ietf.org/doc/html/rfc2285#section-3.5.1<a href="#section-1-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.7">Offered load: https://datatracker.ietf.org/doc/html/rfc2285#section-3.5.2<a href="#section-1-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.8">Maximum offered load (MOL): see
https://datatracker.ietf.org/doc/html/rfc2285#section-3.5.3<a href="#section-1-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.9">Forwarding rate at maximum offered load (FRMOL)
https://datatracker.ietf.org/doc/html/rfc2285#section-3.6.2<a href="#section-1-2.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.10">Trial Loss Count: the number of frames transmitted
minus the number of frames received. Negative count is possible,
e.g. when SUT duplicates some frames.<a href="#section-1-2.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.11">Trial Loss Ratio: ratio of frames received relative to frames
transmitted over the trial duration.
For bi-directional throughput tests, the aggregate ratio is calculated,
based on the aggregate number of frames transmitted and received.
If the trial loss count is negative, its absolute value MUST be used
to keep compliance with RFC2544.<a href="#section-1-2.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.12">Safe load: any value, such that trial measurement at this (or lower)
intended load is correcrly handled by both TG and TA, regardless of SUT behavior.
Frequently, it is not known what the safe load is.<a href="#section-1-2.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.13">Max load (TODO rename?): Maximal intended load to be used during search.
Benchmarking team decides which value is low enough
to guarantee values reported by TG and TA are reliable.
It has to be a safe load, but it can be lower than a safe load estimate
for added safety.
See the subsection on unreliable test equipment below.
This value MUST NOT be higher than MOL, which itself MUST NOT
be higher than Maximum Frame Rate
https://datatracker.ietf.org/doc/html/rfc2544#section-20<a href="#section-1-2.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.14">Min load: Minimal intended load to be used during search.
Benchmarking team decides which value is high enough
to guarantee the trial measurement results are valid.
E.g. considerable overall search time can be saved by declaring SUT
faulty if min load trial shows too high loss rate.
Zero frames per second is a valid min load value<a href="#section-1-2.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.15">Effective loss ratio: a corrected value of trial loss ratio
chosen to avoid difficulties if SUT exhibits decreasing loss ratio
with increasing load. It is the maximum of trial loss ratios
measured at the same duration on all loads smaller than (and including)
the current one.<a href="#section-1-2.15" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.16">Target loss ratio: a loss ratio value acting as an input for the search.
The search is finding tight enough lower and upper bounds in intended load,
so that the measurement at the lower bound has smaller or equal
trial loss ratio, and upper bound has strictly larger trial loss ratio.
For the tightest upper bound, the effective loss ratio is the same as
trial loss ratio at that upper bound load.
For the tightest lower bound, the effective loss ratio can be higher
than the trial loss ratio at that lower bound, but still not larger
than the target loss ratio.<a href="#section-1-2.16" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.17">TODO: Search algorithm.<a href="#section-1-2.17" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.18">TODO: Precision goal.<a href="#section-1-2.18" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.19">TODO: Define a "benchmarking group".<a href="#section-1-2.19" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.20">TODO: Upper and lower bound.<a href="#section-1-2.20" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.21">TODO: Valid and invalid bound?<a href="#section-1-2.21" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.22">TODO: Interval and interval width?<a href="#section-1-2.22" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-3">TODO: Mention NIC/PCI bandwidth/pps limits can be lower than bandwidth of medium.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intentions-of-this-document">
<section id="section-2">
      <h2 id="name-intentions-of-this-document">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-intentions-of-this-document" class="section-name selfRef">Intentions of this document</a>
      </h2>
<p id="section-2-1">The intention of this document is to provide recommendations for:
* optimizing search for multiple target loss ratios at once,
* speeding up the overall search time,
* improve search results repeatability and comparability.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">No part of RFC2544 is intended to be obsoleted by this document.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc2544">
<section id="section-3">
      <h2 id="name-rfc2544">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-rfc2544" class="section-name selfRef">RFC2544</a>
      </h2>
<div id="throughput-search">
<section id="section-3.1">
        <h3 id="name-throughput-search">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-throughput-search" class="section-name selfRef">Throughput search</a>
        </h3>
<p id="section-3.1-1">It is useful to restate the key requirements of RFC2544
using the new terminology (see section Terminology).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The following sections of RFC2544 are of interest for this document.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">https://datatracker.ietf.org/doc/html/rfc2544#section-20
Mentions the max load SHOULD not be larget than the theoretical
maximum rate for the frame size on the media.<a href="#section-3.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.2">https://datatracker.ietf.org/doc/html/rfc2544#section-23
Lists the actions to be done for each trial measurement,
it also mentions loss rate as an example of trial measurement results.
This document uses loss count instead, as that is the quantity
that is easier for the current test equipment to measure,
e.g. it is not affected by the real traffic duration.
TODO: Time uncertainty again.<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.3">https://datatracker.ietf.org/doc/html/rfc2544#section-24
Mentions "full length trials" leading to the Throughput found,
as opposed to shorter trial durations, allowed in an attempt
to "minimize the length of search procedure".
This document talks about "final trial duration" and aims to
"optimize overal search time".<a href="#section-3.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.4">https://datatracker.ietf.org/doc/html/rfc2544#section-26.1
with https://www.rfc-editor.org/errata/eid422
finaly states requirements for the search procedure.
It boils down to "increase intended load upon zero trial loss
and decrease intended load upon non-zero trial loss".<a href="#section-3.1-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-4">No additional constraints are placed on the load selection,
and there is no mention of an exit condition, e.g. when there is enough
trial measurements to proclaim the largest load with zero trial loss
(and final trial duration) to be the Throughput found.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="problems">
<section id="section-4">
      <h2 id="name-problems">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-problems" class="section-name selfRef">Problems</a>
      </h2>
<div id="repeatability-and-comparability">
<section id="section-4.1">
        <h3 id="name-repeatability-and-comparabi">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-repeatability-and-comparabi" class="section-name selfRef">Repeatability and Comparability</a>
        </h3>
<p id="section-4.1-1">RFC2544 does not suggest to repeat Throughput search,

and from just one Throughput value, it cannot be determined
how repeatable that value is (how likely it is for a repeated Throughput search
to end up with a value less then the precision goal away from the first value).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Depending on SUT behavior, different benchmark groups
can report significantly different Througput values,
even when using identical SUT and test equipment,
just because of minor differences in their search algorithm
(e.g. different max load value).<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">While repeatability can be addressed by repeating the search several times,
the differences in the comparability scenario may be systematic,
e.g. seeming like a bias in one or both benchmark groups.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">MLRsearch algorithm does not really help with the repeatability problem.
This document RECOMMENDS to repeat a selection of "important" tests
ten times, so users can ascertain the repeatability of the results.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">TODO: How to report? Average and standard deviation?<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">Following MLRsearch algorithm leaves less freedom for the benchmark groups
to encounter the comparability problem,
alghough more research is needed to determine the effect
of MLRsearch's tweakable parameters.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-zero-target-loss-ratios">
<section id="section-4.2">
        <h3 id="name-non-zero-target-loss-ratios">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-non-zero-target-loss-ratios" class="section-name selfRef">Non-Zero Target Loss Ratios</a>
        </h3>
<p id="section-4.2-1">https://datatracker.ietf.org/doc/html/rfc1242#section-3.17
defines Throughput as:
    The maximum rate at which none of the offered frames
    are dropped by the device.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">and then it says:
    Since even the loss of one frame in a
    data stream can cause significant delays while
    waiting for the higher level protocols to time out,
    it is useful to know the actual maximum data
    rate that the device can support.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">New "software DUTs" (traffic forwarding programs running on
commercial-off-the-shelf compute server hardware) frequently exhibit quite
low repeatability of Throughput results per above definition.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">This is due to, in general, throughput rates of software DUTs (programs)
being sensitive to server resource allocation by OS during runtime,
as well as any interrupts or blocking of software threads involved
in packet processing.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">To deal with this, this document recommends discovery of multiple throughput rates of interest for software DUTs that run on general purpose COTS servers (with x86, AArch64 Instruction Set Architectures):
* throughput rate with target of zero packet loss ratio.
* at least one throughput rate with target of non-zero packet loss ratio.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">In our experience, the higher the target loss ratio is,
the better is the repeatability of the corresponding load found.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">TODO: Define a good name for a load corresponding to a specific non-zero
target loss ration, while keeping Throughput for the load corresponding
to zero target loss ratio.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">This document RECOMMENDS the benchmark groups to search for corresponding loads
to at least one non-zero target loss ratio.
This document does not suggest any particular non-zero target loss ratio value
to search the corresponding load for.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="solution-ideas">
<section id="section-5">
      <h2 id="name-solution-ideas">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-solution-ideas" class="section-name selfRef">Solution ideas</a>
      </h2>
<p id="section-5-1">This document gives several independent ideas on how to lower the (average)
overall search time, while remaining unconditionally compliant with RFC2544
(and adding some of extensions).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">This document also specifies one particular way to combine all the ideas
into a single search algorithm class (single logic with few tweakable parameters).<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Little to no research has been done into the question of which combination
of ideas achieves the best compromise with respect to overal search time,
high repeatability and high comparability.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">TODO: How important it is to discuss particular implementation choices,
especially when motivated by non-deterministic SUT behavior?<a href="#section-5-4" class="pilcrow">¶</a></p>
<div id="short-duration-trials">
<section id="section-5.1">
        <h3 id="name-short-duration-trials">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-short-duration-trials" class="section-name selfRef">Short duration trials</a>
        </h3>
<p id="section-5.1-1">https://datatracker.ietf.org/doc/html/rfc2544#section-24
already mentions the possibity of using shorter duration
for trials that are not part of "final determination".<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Obviously, the upper and lower bound from a smaller duration trial
can be used as the initial upper and lower bound for the final determination.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">MLRsearch makes it clear a re-measurement is always needed
(new trial measurement with the same load but longer duration).
It also specifes what to do if the longer trial is no longer a valid bound
(TODO define?), e.g. start an external search.
Additionaly one halving can be saved during the shorter duration search.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frmol-as-reasonable-start">
<section id="section-5.2">
        <h3 id="name-frmol-as-reasonable-start">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-frmol-as-reasonable-start" class="section-name selfRef">FRMOL as reasonable start</a>
        </h3>
<p id="section-5.2-1">TODO expand: Overal search ends with "final determination" search,
preceded by "shorter duration search" preceded by "bound initialization",
where the bounds can be considerably different from min and max load.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">For SUTs with high repeatability, the FRMOL is usually a good approximation
of Throughput. But for less repeatable SUTs, forwarding rate (TODO define)
is frequently a bad approximation to Throughput, therefore halving
and other robust-to-worst-case approaches have to be used.
Still, forwarding rate at FRMOL load can be a good initial bound.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-zero-loss-ratios">
<section id="section-5.3">
        <h3 id="name-non-zero-loss-ratios">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-non-zero-loss-ratios" class="section-name selfRef">Non-zero loss ratios</a>
        </h3>
<p id="section-5.3-1">See the "Popularity of non-zero target loss ratios" section above.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">TODO: Define "trial measurement result classification criteria",
or keep reusing long phrases without definitions?<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">A search for a load corresponding to a non-zero target loss rate
is very similar to a search for Throughput,
just the criterion when to increase or decrease the intended load
for the next trial measurement uses the comparison of trial loss ratio
to the target loss ratio (instead of comparing loss count to zero)
Any search algorithm that works for Throughput can be easily used also for
non-zero target loss rates, perhaps with small modifications
in places where the measured forwarding rate is used.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">Note that it is possible to search for multiple loss ratio goals if needed.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="concurrent-ratio-search">
<section id="section-5.4">
        <h3 id="name-concurrent-ratio-search">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-concurrent-ratio-search" class="section-name selfRef">Concurrent ratio search</a>
        </h3>
<p id="section-5.4-1">A single trial measurement result can act as an upper bound for a lower
target loss ratio, and as a lower bound for a higher target loss ratio
at the same time. This is an example of how
it can be advantageous to search for all loss ratio goals "at once",
or at least "reuse" trial measurement result done so far.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">Even when a search algorithm is fully deterministic in load selection
while focusing on a single loss ratio and trial duration,
the choice of iteration order between target loss ratios and trial durations
can affect the obtained results in subtle ways.
MLRsearch offers one particular ordering.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="load-selection-heuristics-and-shortcuts">
<section id="section-5.5">
        <h3 id="name-load-selection-heuristics-a">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-load-selection-heuristics-a" class="section-name selfRef">Load selection heuristics and shortcuts</a>
        </h3>
<p id="section-5.5-1">Aside of the two heuristics already mentioned (FRMOL based initial bounds
and saving one halving when increasing trial duration),
there are other tricks that can save some overall search time
at the cost of keeping the difference between final lower and upper bound
intentionally large (but still within the precision goal).<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">TODO: Refer implementation subsections on:
* Uneven splits.
* Rounding the interval width up.
* Using old invalid bounds for interval width guessing.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">The impact on overall duration is probably small,
and the effect on result distribution maybe even smaller.
TODO: Is the two-liner above useful at all?<a href="#section-5.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="non-compliance-with-rfc2544">
<section id="section-6">
      <h2 id="name-non-compliance-with-rfc2544">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-non-compliance-with-rfc2544" class="section-name selfRef">Non-compliance with RFC2544</a>
      </h2>
<p id="section-6-1">It is possible to achieve even faster search times by abandoning
some requirements and suggestions of RFC2544,
mainly by reducing the wait times at start and end of trial.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Such results are therefore no longer compliant with RFC2544
(or at least not unconditionally),
but they may still be useful for internal usage, or for comparing
results of different DUTs achieved with an identical non-compliant algorithm.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">TODO: Refer to the subsection with CSIT customizations.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="additional-requirements">
<section id="section-7">
      <h2 id="name-additional-requirements">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-additional-requirements" class="section-name selfRef">Additional Requirements</a>
      </h2>
<p id="section-7-1">RFC2544 can be understood as having a number of implicit requirements.
They are made explicit in this section
(as requirements for this document, not for RFC2544).<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Recommendations on how to properly address the implicit requirements
are out of scope of this document.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="todo-search-stop-criteria">
<section id="section-7.1">
        <h3 id="name-todo-search-stop-criteria">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-todo-search-stop-criteria" class="section-name selfRef">TODO: Search Stop Criteria</a>
        </h3>
<p id="section-7.1-1">TODO: Mention the timeout parameter?<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reliability-of-test-equipment">
<section id="section-7.2">
        <h3 id="name-reliability-of-test-equipme">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-reliability-of-test-equipme" class="section-name selfRef">Reliability of Test Equipment</a>
        </h3>
<p id="section-7.2-1">Both TG and TA MUST be able to handle correctly
every intended load used during the search.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">On TG side, the difference between Intended Load and Offered Load
MUST be small.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">TODO: How small? Difference of one packet may not be measurable
due to time uncertainties.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">TODO expand: time uncertainty.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">To ensure that, max load (see Terminology) has to be set to low enough value.
Benchmark groups MAY list the max load value used,
especially if the Throughput value is equal (or close) to the max load.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">Solutions (even problem formulations) for the following open problems
are outside of the scope of this document:
* Detecting when the test equipment operates above its safe load.
* Finding a large but safe load value.
* Correcting any result affected by max load value not being a safe load.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<div id="very-late-frames">
<section id="section-7.2.1">
          <h4 id="name-very-late-frames">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-very-late-frames" class="section-name selfRef">Very late frames</a>
          </h4>
<p id="section-7.2.1-1">RFC2544 requires quite conservative time delays
see https://datatracker.ietf.org/doc/html/rfc2544#section-23
to prevent frames buffered in one trial measurement
to be counted as received in a subsequent trial measurement.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">However, for some SUTs it may still be possible to buffer enough frames,
so they are still sending them (perhaps in bursts)
when the next trial measurement starts.
Sometimes, this can be detected as a negative trial loss count, e.g. TA receiving
more frames than TG has sent during this trial measurement. Frame duplication
is another way of causing the negative trial loss count.<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.2.1-3">https://datatracker.ietf.org/doc/html/rfc2544#section-10
recommends to use sequence numbers in frame payloads,
but generating and verifying them requires test equipment resources,
which may be not plenty enough to suport at high loads.
(Using low enough max load would work, but frequently that would be
smaller than SUT's sctual Throughput.)<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.2.1-4">RFC2544 does not offer any solution to the negative loss problem,
except implicitly treating negative trial loss counts
the same way as positive trial loss counts.<a href="#section-7.2.1-4" class="pilcrow">¶</a></p>
<p id="section-7.2.1-5">This document also does not offer any practical solution.<a href="#section-7.2.1-5" class="pilcrow">¶</a></p>
<p id="section-7.2.1-6">Instead, this document SUGGESTS the search algorithm to take any precaution
necessary to avoid very late frames.<a href="#section-7.2.1-6" class="pilcrow">¶</a></p>
<p id="section-7.2.1-7">This document also REQUIRES any detected duplicate frames to be counted
as additional lost frames.
This document also REQUIRES, any negative trial loss ratio
to be treated as positive trial loss ratio of the same absolute value.<a href="#section-7.2.1-7" class="pilcrow">¶</a></p>
<p id="section-7.2.1-8">!!! Nothing below is up-to-date with draft v02. !!!<a href="#section-7.2.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="mlrsearch-background">
<section id="section-8">
      <h2 id="name-mlrsearch-background">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-mlrsearch-background" class="section-name selfRef">MLRsearch Background</a>
      </h2>
<p id="section-8-1">TODO: Old section, probably obsoleted by preceding section(s).<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Multiple Loss Ratio search (MLRsearch) is a packet throughput search
algorithm suitable for deterministic systems (as opposed to
probabilistic systems). MLRsearch discovers multiple packet throughput
rates in a single search, each rate is associated with a distinct
Packet Loss Ratio (PLR) criterion.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">For cases when multiple rates need to be found, this property makes
MLRsearch more efficient in terms of time execution, compared to
traditional throughput search algorithms that discover a single packet
rate per defined search criteria (e.g. a binary search specified by
<span>[<a href="#RFC2544" class="xref">RFC2544</a>]</span>). MLRsearch reduces execution time even further by relying on
shorter trial durations of intermediate steps, with only the final
measurements conducted at the specified final trial duration. This
results in the shorter overall search execution time when compared to a
traditional binary search, while guaranteeing the same results for
deterministic systems.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">In practice, two rates with distinct PLRs are commonly used for packet
throughput measurements of NFV systems: Non Drop Rate (NDR) with PLR=0
and Partial Drop Rate (PDR) with PLR&gt;0. The rest of this document
describes MLRsearch with NDR and PDR pair as an example.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">Similarly to other throughput search approaches like binary search,
MLRsearch is effective for SUTs/DUTs with PLR curve that is
non-decreasing with growing offered load. It may not be as
effective for SUTs/DUTs with abnormal PLR curves, although
it will always converge to some value.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">MLRsearch relies on traffic generator to qualify the received packet
stream as error-free, and invalidate the results if any disqualifying
errors are present e.g. out-of-sequence frames.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">MLRsearch can be applied to both uni-directional and bi-directional
throughput tests.<a href="#section-8-7" class="pilcrow">¶</a></p>
<p id="section-8-8">For bi-directional tests, MLRsearch rates and ratios are aggregates of
both directions, based on the following assumptions:<a href="#section-8-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-9.1">Traffic transmitted by traffic generator and received by SUT/DUT
has the same packet rate in each direction,
in other words the offered load is symmetric.<a href="#section-8-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-9.2">SUT/DUT packet processing capacity is the same in both directions,
resulting in the same packet loss under load.<a href="#section-8-9.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-10">MLRsearch can be applied even without those assumptions,
but in that case the aggregate loss ratio is less useful as a metric.<a href="#section-8-10" class="pilcrow">¶</a></p>
<p id="section-8-11">MLRsearch can be used for network transactions consisting of more than
just one packet, or anything else that has intended load as input
and loss ratio as output (duration as input is optional).
This text uses mostly packet-centric language.<a href="#section-8-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mlrsearch-overview">
<section id="section-9">
      <h2 id="name-mlrsearch-overview">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-mlrsearch-overview" class="section-name selfRef">MLRsearch Overview</a>
      </h2>
<p id="section-9-1">The main properties of MLRsearch:<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">
          <p id="section-9-2.1.1">MLRsearch is a duration aware multi-phase multi-rate search algorithm:<a href="#section-9-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1.2.1">Initial Phase determines promising starting interval for the search.<a href="#section-9-2.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9-2.1.2.2">Intermediate Phases progress towards defined final search criteria.<a href="#section-9-2.1.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9-2.1.2.3">Final Phase executes measurements according to the final search
criteria.<a href="#section-9-2.1.2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9-2.1.2.4">
              <p id="section-9-2.1.2.4.1">Final search criteria are defined by following inputs:<a href="#section-9-2.1.2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1.2.4.2.1">Target PLRs (e.g. 0.0 and 0.005 when searching for NDR and PDR).<a href="#section-9-2.1.2.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-9-2.1.2.4.2.2">Final trial duration.<a href="#section-9-2.1.2.4.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-9-2.1.2.4.2.3">Measurement resolution.<a href="#section-9-2.1.2.4.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.2">
          <p id="section-9-2.2.1">Initial Phase:<a href="#section-9-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.2.2.1">Measure MRR over initial trial duration.<a href="#section-9-2.2.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9-2.2.2.2">Measured MRR is used as an input to the first intermediate phase.<a href="#section-9-2.2.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.3">
          <p id="section-9-2.3.1">Multiple Intermediate Phases:<a href="#section-9-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.1">
              <p id="section-9-2.3.2.1.1">Trial duration:<a href="#section-9-2.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.1.2.1">Start with initial trial duration in the first intermediate phase.<a href="#section-9-2.3.2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-9-2.3.2.1.2.2">Converge geometrically towards the final trial duration.<a href="#section-9-2.3.2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-9-2.3.2.2">
              <p id="section-9-2.3.2.2.1">Track all previous trial measurement results:<a href="#section-9-2.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.2.2.1">Duration, offered load and loss ratio are tracked.<a href="#section-9-2.3.2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-9-2.3.2.2.2.2">
                  <p id="section-9-2.3.2.2.2.2.1">Effective loss ratios are tracked.<a href="#section-9-2.3.2.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.2.2.2.2.1">While in practice, real loss ratios can decrease with increasing load,
effective loss ratios never decrease. This is achieved by sorting
results by load, and using the effective loss ratio of the previous load
if the current loss ratio is smaller than that.<a href="#section-9-2.3.2.2.2.2.2.1" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-9-2.3.2.2.2.3">
                  <p id="section-9-2.3.2.2.2.3.1">The algorithm queries the results to find best lower and upper bounds.<a href="#section-9-2.3.2.2.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.2.2.3.2.1">Effective loss ratios are always used.<a href="#section-9-2.3.2.2.2.3.2.1" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-9-2.3.2.2.2.4">The phase ends if all target loss ratios have tight enough bounds.<a href="#section-9-2.3.2.2.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-9-2.3.2.3">
              <p id="section-9-2.3.2.3.1">Search:<a href="#section-9-2.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.3.2.1">Iterate over target loss ratios in increasing order.<a href="#section-9-2.3.2.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-9-2.3.2.3.2.2">If both upper and lower bound are in measurement results for this duration,
apply bisect until the bounds are tight enough,
and continue with next loss ratio.<a href="#section-9-2.3.2.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-9-2.3.2.3.2.3">If a bound is missing for this duration, but there exists a bound
from the previous duration (compatible with the other bound
at this duration), re-measure at the current duration.<a href="#section-9-2.3.2.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-9-2.3.2.3.2.4">If a bound in one direction (upper or lower) is missing for this duration,
and the previous duration does not have a compatible bound,
compute the current "interval size" from the second tightest bound
in the other direction (lower or upper respectively)
for the current duration, and choose next offered load for external search.<a href="#section-9-2.3.2.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-9-2.3.2.3.2.5">The logic guarantees that a measurement is never repeated with both
duration and offered load being the same.<a href="#section-9-2.3.2.3.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-9-2.3.2.3.2.6">The logic guarantees that measurements for higher target loss ratio
iterations (still within the same phase duration) do not affect validity
and tightness of bounds for previous target loss ratio iterations
(at the same duration).<a href="#section-9-2.3.2.3.2.6" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-9-2.3.2.4">
              <p id="section-9-2.3.2.4.1">Use of internal and external searches:<a href="#section-9-2.3.2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.4.2.1">
                  <p id="section-9-2.3.2.4.2.1.1">External search:<a href="#section-9-2.3.2.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.4.2.1.2.1">It is a variant of "exponential search".<a href="#section-9-2.3.2.4.2.1.2.1" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-9-2.3.2.4.2.1.2.2">The "interval size" is multiplied by a configurable constant
(powers of two work well with the subsequent internal search).<a href="#section-9-2.3.2.4.2.1.2.2" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-9-2.3.2.4.2.2">
                  <p id="section-9-2.3.2.4.2.2.1">Internal search:<a href="#section-9-2.3.2.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.4.2.2.2.1">A variant of binary search that measures at offered load between
the previously found bounds.<a href="#section-9-2.3.2.4.2.2.2.1" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-9-2.3.2.4.2.2.2.2">
                      <p id="section-9-2.3.2.4.2.2.2.2.1">The interval does not need to be split into exact halves,
if other split can get to the target width goal faster.<a href="#section-9-2.3.2.4.2.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.3.2.4.2.2.2.2.2.1">The idea is to avoid returning interval narrower than the current
width goal. See sample implementation details, below.<a href="#section-9-2.3.2.4.2.2.2.2.2.1" class="pilcrow">¶</a>
</li>
                      </ul>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.4">
          <p id="section-9-2.4.1">Final Phase:<a href="#section-9-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.4.2.1">Executed with the final test trial duration, and the final width
goal that determines resolution of the overall search.<a href="#section-9-2.4.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-9-2.5">Intermediate Phases together with the Final Phase are called
Non-Initial Phases.<a href="#section-9-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-2.6">
          <p id="section-9-2.6.1">The returned bounds stay within prescribed min_rate and max_rate.<a href="#section-9-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.6.2.1">
              <p id="section-9-2.6.2.1.1">When returning min_rate or max_rate, the returned bounds may be invalid.<a href="#section-9-2.6.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.6.2.1.2.1">E.g. upper bound at max_rate may come from a measurement
with loss ratio still not higher than the target loss ratio.<a href="#section-9-2.6.2.1.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</li>
      </ul>
<p id="section-9-3">The main benefits of MLRsearch vs. binary search include:<a href="#section-9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-4.1">In general, MLRsearch is likely to execute more trials overall, but
likely less trials at a set final trial duration.<a href="#section-9-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-4.2">In well behaving cases, e.g. when results do not depend on trial
duration, it greatly reduces (&gt;50%) the overall duration compared to a
single PDR (or NDR) binary search over duration, while finding
multiple drop rates.<a href="#section-9-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-4.3">In all cases MLRsearch yields the same or similar results to binary
search.<a href="#section-9-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-4.4">Note: both binary search and MLRsearch are susceptible to reporting
non-repeatable results across multiple runs for very bad behaving
cases.<a href="#section-9-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-9-5">Caveats:<a href="#section-9-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-6.1">
          <p id="section-9-6.1.1">Worst case MLRsearch can take longer than a binary search, e.g. in case of
drastic changes in behaviour for trials at varying durations.<a href="#section-9-6.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-6.1.2.1">Re-measurement at higher duration can trigger a long external search.
That never happens in binary search, which uses the final duration
from the start.<a href="#section-9-6.1.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
</section>
</div>
<div id="sample-implementation">
<section id="section-10">
      <h2 id="name-sample-implementation">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-sample-implementation" class="section-name selfRef">Sample Implementation</a>
      </h2>
<p id="section-10-1">Following is a brief description of a sample MLRsearch implementation,
which is a simplified version of the existing implementation.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="input-parameters">
<section id="section-10.1">
        <h3 id="name-input-parameters">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-input-parameters" class="section-name selfRef">Input Parameters</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-10.1-1">
<li id="section-10.1-1.1">
            <strong>max_rate</strong> - Maximum Transmit Rate (MTR) of packets to
be used by external traffic generator implementing MLRsearch,
limited by the actual Ethernet link(s) rate, NIC model or traffic
generator capabilities.<a href="#section-10.1-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-10.1-1.2">
            <strong>min_rate</strong> - minimum packet transmit rate to be used for
measurements. MLRsearch fails if lower transmit rate needs to be
used to meet search criteria.<a href="#section-10.1-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-10.1-1.3">
            <strong>final_trial_duration</strong> - required trial duration for final rate
measurements.<a href="#section-10.1-1.3" class="pilcrow">¶</a>
</li>
          <li id="section-10.1-1.4">
            <strong>initial_trial_duration</strong> - trial duration for initial MLRsearch phase.<a href="#section-10.1-1.4" class="pilcrow">¶</a>
</li>
          <li id="section-10.1-1.5">
            <strong>final_relative_width</strong> - required measurement resolution expressed as
(lower_bound, upper_bound) interval width relative to upper_bound.<a href="#section-10.1-1.5" class="pilcrow">¶</a>
</li>
          <li id="section-10.1-1.6">
            <strong>packet_loss_ratios</strong> - list of maximum acceptable PLR search criteria.<a href="#section-10.1-1.6" class="pilcrow">¶</a>
</li>
          <li id="section-10.1-1.7">
            <strong>number_of_intermediate_phases</strong> - number of phases between the initial
phase and the final phase. Impacts the overall MLRsearch duration.
Less phases are required for well behaving cases, more phases
may be needed to reduce the overall search duration for worse behaving cases.<a href="#section-10.1-1.7" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="initial-phase">
<section id="section-10.2">
        <h3 id="name-initial-phase">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-initial-phase" class="section-name selfRef">Initial Phase</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-10.2-1">
<li id="section-10.2-1.1">
            <p id="section-10.2-1.1.1">First trial measures at configured maximum transmit rate (MTR) and
discovers maximum receive rate (MRR).<a href="#section-10.2-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-1.1.2.1">IN: trial_duration = initial_trial_duration.<a href="#section-10.2-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.1.2.2">IN: offered_transmit_rate = maximum_transmit_rate.<a href="#section-10.2-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.1.2.3">DO: single trial.<a href="#section-10.2-1.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.1.2.4">OUT: measured loss ratio.<a href="#section-10.2-1.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.1.2.5">OUT: MRR = measured receive rate.
Received rate is computed as intended load multiplied by pass ratio
(which is one minus loss ratio). This is useful when loss ratio is computed
from a different metric than intended load. For example, intended load
can be in transactions (multiple packets each), but loss ratio is computed
on level of packets, not transactions.<a href="#section-10.2-1.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.1.2.6">Example: If MTR is 10 transactions per second, and each transaction has
10 packets, and receive rate is 90 packets per second, then loss rate
is 10%, and MRR is computed to be 9 transactions per second.<a href="#section-10.2-1.1.2.6" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-10.2-1.1.3">
If MRR is too close to MTR, MRR is set below MTR so that interval width
is equal to the width goal of the first intermediate phase.
If MRR is less than min_rate, min_rate is used.<a href="#section-10.2-1.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-10.2-1.2">
            <p id="section-10.2-1.2.1">Second trial measures at MRR and discovers MRR2.<a href="#section-10.2-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-1.2.2.1">IN: trial_duration = initial_trial_duration.<a href="#section-10.2-1.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.2.2.2">IN: offered_transmit_rate = MRR.<a href="#section-10.2-1.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.2.2.3">DO: single trial.<a href="#section-10.2-1.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.2.2.4">OUT: measured loss ratio.<a href="#section-10.2-1.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.2.2.5">OUT: MRR2 = measured receive rate.
If MRR2 is less than min_rate, min_rate is used.
If loss ratio is less or equal to the smallest target loss ratio,
MRR2 is set to a value above MRR, so that interval width is equal
to the width goal of the first intermediate phase.
MRR2 could end up being equal to MTR (for example if both measurements so far
had zero loss), which was already measured, step 3 is skipped in that case.<a href="#section-10.2-1.2.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-10.2-1.3">
            <p id="section-10.2-1.3.1">Third trial measures at MRR2.<a href="#section-10.2-1.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-1.3.2.1">IN: trial_duration = initial_trial_duration.<a href="#section-10.2-1.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.3.2.2">IN: offered_transmit_rate = MRR2.<a href="#section-10.2-1.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.3.2.3">DO: single trial.<a href="#section-10.2-1.3.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.3.2.4">OUT: measured loss ratio.<a href="#section-10.2-1.3.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-1.3.2.5">OUT: MRR3 = measured receive rate.
If MRR3 is less than min_rate, min_rate is used.
If step 3 is not skipped, the first trial measurement is forgotten.
This is done because in practice (if MRR2 is above MRR), external search
from MRR and MRR2 is likely to lead to a faster intermediate phase
than a bisect between MRR2 and MTR.<a href="#section-10.2-1.3.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ol>
</section>
</div>
<div id="non-initial-phases">
<section id="section-10.3">
        <h3 id="name-non-initial-phases">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-non-initial-phases" class="section-name selfRef">Non-Initial Phases</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1">
<li id="section-10.3-1.1">
            <p id="section-10.3-1.1.1">Main phase loop:<a href="#section-10.3-1.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.1.2">
<li id="section-10.3-1.1.2.1">IN: trial_duration for the current phase. Set to
initial_trial_duration for the first intermediate phase; to
final_trial_duration for the final phase; or to the element of
interpolating geometric sequence for other intermediate phases.
For example with two intermediate phases, trial_duration of the
second intermediate phase is the geometric average of
initial_trial_duration and final_trial_duration.<a href="#section-10.3-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-10.3-1.1.2.2">IN: relative_width_goal for the current phase. Set to
final_relative_width for the final phase; doubled for each
preceding phase. For example with two intermediate phases, the
first intermediate phase uses quadruple of final_relative_width
and the second intermediate phase uses double of
final_relative_width.<a href="#section-10.3-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-10.3-1.1.2.3">IN: Measurement results from the previous phase (previous duration).<a href="#section-10.3-1.1.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-10.3-1.1.2.4">
                <p id="section-10.3-1.1.2.4.1">Internal target ratio loop:<a href="#section-10.3-1.1.2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.1.2.4.2">
<li id="section-10.3-1.1.2.4.2.1">IN: Target loss ratio for this iteration of ratio loop.<a href="#section-10.3-1.1.2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.1.2.4.2.2">IN: Measurement results from all previous ratio loop iterations
of current phase (current duration).<a href="#section-10.3-1.1.2.4.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.1.2.4.2.3">
                    <p id="section-10.3-1.1.2.4.2.3.1">DO: According to the procedure described in point 2:<a href="#section-10.3-1.1.2.4.2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.1.2.4.2.3.2">
<li id="section-10.3-1.1.2.4.2.3.2.1">either exit the phase (by jumping to 1.5),<a href="#section-10.3-1.1.2.4.2.3.2.1" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.1.2.4.2.3.2.2">or exit loop iteration (by continuing with next target loss ratio,
jumping to 1.4.1),<a href="#section-10.3-1.1.2.4.2.3.2.2" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.1.2.4.2.3.2.3">or calculate new transmit rate to measure with.<a href="#section-10.3-1.1.2.4.2.3.2.3" class="pilcrow">¶</a>
</li>
                    </ol>
</li>
                  <li id="section-10.3-1.1.2.4.2.4">DO: Perform the trial measurement at the new transmit rate and
current trial duration, compute its loss ratio.<a href="#section-10.3-1.1.2.4.2.4" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.1.2.4.2.5">DO: Add the result and go to next iteration (1.4.1),
including the added trial result in 1.4.2.<a href="#section-10.3-1.1.2.4.2.5" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-10.3-1.1.2.5">OUT: Measurement results from this phase.<a href="#section-10.3-1.1.2.5" class="pilcrow">¶</a>
</li>
              <li id="section-10.3-1.1.2.6">
                <p id="section-10.3-1.1.2.6.1">OUT: In the final phase, bounds for each target loss ratio
are extracted and returned.<a href="#section-10.3-1.1.2.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.1.2.6.2">
<li id="section-10.3-1.1.2.6.2.1">If a valid bound does not exist, use min_rate or max_rate.<a href="#section-10.3-1.1.2.6.2.1" class="pilcrow">¶</a>
</li>
                </ol>
</li>
            </ol>
</li>
          <li id="section-10.3-1.2">
            <p id="section-10.3-1.2.1">New transmit rate (or exit) calculation (for point 1.4.3):<a href="#section-10.3-1.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2">
<li id="section-10.3-1.2.2.1">
                <p id="section-10.3-1.2.2.1.1">If the previous duration has the best upper and lower bound,
select the middle point as the new transmit rate.<a href="#section-10.3-1.2.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.1.2">
<li id="section-10.3-1.2.2.1.2.1">See 2.5.3. below for the exact splitting logic.<a href="#section-10.3-1.2.2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.2.2.1.2.2">This can be a no-op if interval is narrow enough already,
in that case continue with 2.2.<a href="#section-10.3-1.2.2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.2.2.1.2.3">
                    <p id="section-10.3-1.2.2.1.2.3.1">Discussion, assuming the middle point is selected and measured:<a href="#section-10.3-1.2.2.1.2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.1.2.3.2">
<li id="section-10.3-1.2.2.1.2.3.2.1">Regardless of loss rate measured, the result becomes
either best upper or best lower bound at current duration.<a href="#section-10.3-1.2.2.1.2.3.2.1" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.1.2.3.2.2">So this condition is satisfied at most once per iteration.<a href="#section-10.3-1.2.2.1.2.3.2.2" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.1.2.3.2.3">
                        <p id="section-10.3-1.2.2.1.2.3.2.3.1">This also explains why previous phase has double width goal:<a href="#section-10.3-1.2.2.1.2.3.2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.1.2.3.2.3.2">
<li id="section-10.3-1.2.2.1.2.3.2.3.2.1">We avoid one more bisection at previous phase.<a href="#section-10.3-1.2.2.1.2.3.2.3.2.1" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.1.2.3.2.3.2.2">At most one bound (per iteration) is re-measured
with current duration.<a href="#section-10.3-1.2.2.1.2.3.2.3.2.2" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.1.2.3.2.3.2.3">Each re-measurement can trigger an external search.<a href="#section-10.3-1.2.2.1.2.3.2.3.2.3" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.1.2.3.2.3.2.4">Such surprising external searches are the main hurdle
in achieving low overall search durations.<a href="#section-10.3-1.2.2.1.2.3.2.3.2.4" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.1.2.3.2.3.2.5">Even without 1.1, there is at most one external search
per phase and target loss ratio.<a href="#section-10.3-1.2.2.1.2.3.2.3.2.5" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.1.2.3.2.3.2.6">But without 1.1 there can be two re-measurements,
each coming with a risk of triggering external search.<a href="#section-10.3-1.2.2.1.2.3.2.3.2.6" class="pilcrow">¶</a>
</li>
                        </ol>
</li>
                    </ol>
</li>
                </ol>
</li>
              <li id="section-10.3-1.2.2.2">If the previous duration has one bound best, select its transmit rate.
In deterministic case this is the last measurement needed this iteration.<a href="#section-10.3-1.2.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-10.3-1.2.2.3">
                <p id="section-10.3-1.2.2.3.1">If only upper bound exists in current duration results:<a href="#section-10.3-1.2.2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.3.2">
<li id="section-10.3-1.2.2.3.2.1">This can only happen for the smallest target loss ratio.<a href="#section-10.3-1.2.2.3.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.2.2.3.2.2">If the upper bound was measured at min_rate,
exit the whole phase early (not investigating other target loss ratios).<a href="#section-10.3-1.2.2.3.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.2.2.3.2.3">
                    <p id="section-10.3-1.2.2.3.2.3.1">Select new transmit rate using external search:<a href="#section-10.3-1.2.2.3.2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.3.2.3.2">
<li id="section-10.3-1.2.2.3.2.3.2.1">
                        <p id="section-10.3-1.2.2.3.2.3.2.1.1">For computing previous interval size, use:<a href="#section-10.3-1.2.2.3.2.3.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.3.2.3.2.1.2">
<li id="section-10.3-1.2.2.3.2.3.2.1.2.1">second tightest bound at current duration,<a href="#section-10.3-1.2.2.3.2.3.2.1.2.1" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.3.2.3.2.1.2.2">or tightest bound of previous duration,
if compatible and giving a more narrow interval,<a href="#section-10.3-1.2.2.3.2.3.2.1.2.2" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.3.2.3.2.1.2.3">or target interval width if none of the above is available.<a href="#section-10.3-1.2.2.3.2.3.2.1.2.3" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.3.2.3.2.1.2.4">In any case increase to target interval width if smaller.<a href="#section-10.3-1.2.2.3.2.3.2.1.2.4" class="pilcrow">¶</a>
</li>
                        </ol>
</li>
                      <li id="section-10.3-1.2.2.3.2.3.2.2">Quadruple the interval width.<a href="#section-10.3-1.2.2.3.2.3.2.2" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.3.2.3.2.3">Use min_rate if the new transmit rate is lower.<a href="#section-10.3-1.2.2.3.2.3.2.3" class="pilcrow">¶</a>
</li>
                    </ol>
</li>
                </ol>
</li>
              <li id="section-10.3-1.2.2.4">
                <p id="section-10.3-1.2.2.4.1">If only lower bound exists in current duration results:<a href="#section-10.3-1.2.2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.4.2">
<li id="section-10.3-1.2.2.4.2.1">If the lower bound was measured at max_rate,
exit this iteration (continue with next lowest target loss ratio).<a href="#section-10.3-1.2.2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.2.2.4.2.2">
                    <p id="section-10.3-1.2.2.4.2.2.1">Select new transmit rate using external search:<a href="#section-10.3-1.2.2.4.2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.4.2.2.2">
<li id="section-10.3-1.2.2.4.2.2.2.1">
                        <p id="section-10.3-1.2.2.4.2.2.2.1.1">For computing previous interval size, use:<a href="#section-10.3-1.2.2.4.2.2.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.4.2.2.2.1.2">
<li id="section-10.3-1.2.2.4.2.2.2.1.2.1">second tightest bound at current duration,<a href="#section-10.3-1.2.2.4.2.2.2.1.2.1" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.4.2.2.2.1.2.2">or tightest bound of previous duration,
if compatible and giving a more narrow interval,<a href="#section-10.3-1.2.2.4.2.2.2.1.2.2" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.4.2.2.2.1.2.3">or target interval width if none of the above is available.<a href="#section-10.3-1.2.2.4.2.2.2.1.2.3" class="pilcrow">¶</a>
</li>
                          <li id="section-10.3-1.2.2.4.2.2.2.1.2.4">In any case increase to target interval width if smaller.<a href="#section-10.3-1.2.2.4.2.2.2.1.2.4" class="pilcrow">¶</a>
</li>
                        </ol>
</li>
                      <li id="section-10.3-1.2.2.4.2.2.2.2">Quadruple the interval width.<a href="#section-10.3-1.2.2.4.2.2.2.2" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.4.2.2.2.3">Use max_rate if the new transmit rate is higher.<a href="#section-10.3-1.2.2.4.2.2.2.3" class="pilcrow">¶</a>
</li>
                    </ol>
</li>
                </ol>
</li>
              <li id="section-10.3-1.2.2.5">
                <p id="section-10.3-1.2.2.5.1">The only remaining option is both bounds in current duration results.<a href="#section-10.3-1.2.2.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.5.2">
<li id="section-10.3-1.2.2.5.2.1">
                    <p id="section-10.3-1.2.2.5.2.1.1">This can happen in two ways, depending on how the lower bound
was chosen.<a href="#section-10.3-1.2.2.5.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.5.2.1.2">
<li id="section-10.3-1.2.2.5.2.1.2.1">It could have been selected for the current loss ratio,
e.g. in re-measurement (2.2) or in initial bisect (2.1).<a href="#section-10.3-1.2.2.5.2.1.2.1" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.5.2.1.2.2">It could have been found as an upper bound for the previous smaller
target loss ratio, in which case it might be too low.<a href="#section-10.3-1.2.2.5.2.1.2.2" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.5.2.1.2.3">The algorithm does not track which one is the case,
as the decision logic works well regardless.<a href="#section-10.3-1.2.2.5.2.1.2.3" class="pilcrow">¶</a>
</li>
                    </ol>
</li>
                  <li id="section-10.3-1.2.2.5.2.2">Compute "extending down" candidate transmit rate exactly as in 2.3.<a href="#section-10.3-1.2.2.5.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.2.2.5.2.3">
                    <p id="section-10.3-1.2.2.5.2.3.1">Compute "bisecting" candidate transmit rate:<a href="#section-10.3-1.2.2.5.2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-1.2.2.5.2.3.2">
<li id="section-10.3-1.2.2.5.2.3.2.1">Compute the current interval width from the two bounds.<a href="#section-10.3-1.2.2.5.2.3.2.1" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.5.2.3.2.2">Express the width as a (float) multiple of the target width goal
for this phase.<a href="#section-10.3-1.2.2.5.2.3.2.2" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.5.2.3.2.3">If the multiple is not higher than one, it means the width goal
is met. Exit this iteration and continue with next higher
target loss ratio.<a href="#section-10.3-1.2.2.5.2.3.2.3" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.5.2.3.2.4">If the multiple is two or less, use half of that
for new width if the lower subinterval.<a href="#section-10.3-1.2.2.5.2.3.2.4" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.5.2.3.2.5">Round the multiple up to nearest even integer.<a href="#section-10.3-1.2.2.5.2.3.2.5" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.5.2.3.2.6">Use half of that for new width if the lower subinterval.<a href="#section-10.3-1.2.2.5.2.3.2.6" class="pilcrow">¶</a>
</li>
                      <li id="section-10.3-1.2.2.5.2.3.2.7">Example: If lower bound is 2.0 and upper bound is 5.0, and width
goal is 1.0, the new candidate transmit rate will be 4.0.
This can save a measurement when 4.0 has small loss.
Selecting the average (3.5) would never save a measurement,
giving more narrow bounds instead.<a href="#section-10.3-1.2.2.5.2.3.2.7" class="pilcrow">¶</a>
</li>
                    </ol>
</li>
                  <li id="section-10.3-1.2.2.5.2.4">If either candidate computation want to exit the iteration,
do as bisecting candidate computation says.<a href="#section-10.3-1.2.2.5.2.4" class="pilcrow">¶</a>
</li>
                  <li id="section-10.3-1.2.2.5.2.5">The remaining case is both candidates wanting to measure at some rate.
Use the higher rate. This prefers external search down narrow enough
interval, competing with perfectly sized lower bisect subinterval.<a href="#section-10.3-1.2.2.5.2.5" class="pilcrow">¶</a>
</li>
                </ol>
</li>
            </ol>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="fdio-csit-implementation">
<section id="section-11">
      <h2 id="name-fdio-csit-implementation">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-fdio-csit-implementation" class="section-name selfRef">FD.io CSIT Implementation</a>
      </h2>
<p id="section-11-1">The only known working implementation of MLRsearch is in
the open-source code running in Linux Foundation
FD.io CSIT project <span>[<a href="#FDio-CSIT-MLRsearch" class="xref">FDio-CSIT-MLRsearch</a>]</span> as part of
a Continuous Integration / Continuous Development (CI/CD) framework.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">MLRsearch is also available as a Python package in <span>[<a href="#PyPI-MLRsearch" class="xref">PyPI-MLRsearch</a>]</span>.<a href="#section-11-2" class="pilcrow">¶</a></p>
<div id="additional-details">
<section id="section-11.1">
        <h3 id="name-additional-details">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-additional-details" class="section-name selfRef">Additional details</a>
        </h3>
<p id="section-11.1-1">This document so far has been describing a simplified version of
MLRsearch algorithm. The full algorithm as implemented in CSIT contains
additional logic, which makes some of the details (but not general
ideas) above incorrect. Here is a short description of the additional
logic as a list of principles, explaining their main differences from
(or additions to) the simplified description, but without detailing
their mutual interaction.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.1-2">
<li id="section-11.1-2.1">
            <p id="section-11.1-2.1.1">Logarithmic transmit rate.<a href="#section-11.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.1.2.1">In order to better fit the relative width goal, the interval
doubling and halving is done differently.<a href="#section-11.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-11.1-2.1.2.2">For example, the middle of 2 and 8 is 4, not 5.<a href="#section-11.1-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-11.1-2.2">
            <p id="section-11.1-2.2.1">Timeout for bad cases.<a href="#section-11.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.2.2.1">The worst case for MLRsearch is when each phase converges to
intervals way different than the results of the previous phase.<a href="#section-11.1-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-11.1-2.2.2.2">Rather than suffer total search time several times larger than pure
binary search, the implemented tests fail themselves when the
search takes too long (given by argument <em>timeout</em>).<a href="#section-11.1-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-11.1-2.3">
            <p id="section-11.1-2.3.1">Intended count.<a href="#section-11.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.3.2.1">
                <p id="section-11.1-2.3.2.1.1">The number of packets to send during the trial should be equal to
the intended load multiplied by the duration.<a href="#section-11.1-2.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.3.2.1.2.1">
                    <p id="section-11.1-2.3.2.1.2.1.1">Also multiplied by a coefficient, if loss ratio is calculated
from a different metric.<a href="#section-11.1-2.3.2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.3.2.1.2.1.2.1">Example: If a successful transaction uses 10 packets,
load is given in transactions per second, but loss ratio is calculated
from packets, so the coefficient to get intended count of packets
is 10.<a href="#section-11.1-2.3.2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="normal" id="section-11.1-2.3.2.2">
                <p id="section-11.1-2.3.2.2.1">But in practice that does not work.<a href="#section-11.1-2.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.3.2.2.2.1">It could result in a fractional number of packets,<a href="#section-11.1-2.3.2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-11.1-2.3.2.2.2.2">so it has to be rounded in a way traffic generator chooses,<a href="#section-11.1-2.3.2.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-11.1-2.3.2.2.2.3">which may depend on the number of traffic flows
and traffic generator worker threads.<a href="#section-11.1-2.3.2.2.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
          <li id="section-11.1-2.4">Attempted count. As the real number of intended packets is not known exactly,
the computation uses the number of packets traffic generator reports as sent.
Unless overridden by the next point.<a href="#section-11.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-11.1-2.5">
            <p id="section-11.1-2.5.1">Duration stretching.<a href="#section-11.1-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.5.2.1">In some cases, traffic generator may get overloaded,
causing it to take significantly longer (than duration) to send all packets.<a href="#section-11.1-2.5.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-11.1-2.5.2.2">
                <p id="section-11.1-2.5.2.2.1">The implementation uses an explicit stop,<a href="#section-11.1-2.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.5.2.2.2.1">causing lower attempted count in those cases.<a href="#section-11.1-2.5.2.2.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-11.1-2.5.2.3">
                <p id="section-11.1-2.5.2.3.1">The implementation tolerates some small difference between
attempted count and intended count.<a href="#section-11.1-2.5.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.5.2.3.2.1">10 microseconds worth of traffic is sufficient for our tests.<a href="#section-11.1-2.5.2.3.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-11.1-2.5.2.4">
                <p id="section-11.1-2.5.2.4.1">If the difference is higher, the unsent packets are counted as lost.<a href="#section-11.1-2.5.2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.5.2.4.2.1">This forces the search to avoid the regions of high duration stretching.<a href="#section-11.1-2.5.2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-11.1-2.5.2.4.2.2">The final bounds describe the performance of not just SUT,
but of the whole system, including the traffic generator.<a href="#section-11.1-2.5.2.4.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
          <li id="section-11.1-2.6">
            <p id="section-11.1-2.6.1">Excess packets.<a href="#section-11.1-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.6.2.1">In some test (e.g. using TCP flows) Traffic generator reacts to packet loss
by retransmission. Usually, such packet loss is already affecting loss ratio.
If a test also wants to treat retransmissions due to heavily delayed packets
also as a failure, this is once again visible as a mismatch between
the intended count and the attempted count.<a href="#section-11.1-2.6.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-11.1-2.6.2.2">The CSIT implementation simply looks at absolute value of the difference,
so it offers the same small tolerance before it starts marking a "loss".<a href="#section-11.1-2.6.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-11.1-2.7">For result processing, we use lower bounds and ignore upper bounds.<a href="#section-11.1-2.7" class="pilcrow">¶</a>
</li>
        </ol>
<div id="fdio-csit-input-parameters">
<section id="section-11.1.1">
          <h4 id="name-fdio-csit-input-parameters">
<a href="#section-11.1.1" class="section-number selfRef">11.1.1. </a><a href="#name-fdio-csit-input-parameters" class="section-name selfRef">FD.io CSIT Input Parameters</a>
          </h4>
<ol start="1" type="1" class="normal type-1" id="section-11.1.1-1">
<li id="section-11.1.1-1.1">
              <strong>max_rate</strong> - Typical values: 2 * 14.88 Mpps for 64B
10GE link rate, 2 * 18.75 Mpps for 64B 40GE NIC (specific model).<a href="#section-11.1.1-1.1" class="pilcrow">¶</a>
</li>
            <li id="section-11.1.1-1.2">
              <strong>min_rate</strong> - Value: 2 * 9001 pps (we reserve 9000 pps
for latency measurements).<a href="#section-11.1.1-1.2" class="pilcrow">¶</a>
</li>
            <li id="section-11.1.1-1.3">
              <strong>final_trial_duration</strong> - Value: 30.0 seconds.<a href="#section-11.1.1-1.3" class="pilcrow">¶</a>
</li>
            <li id="section-11.1.1-1.4">
              <strong>initial_trial_duration</strong> - Value: 1.0 second.<a href="#section-11.1.1-1.4" class="pilcrow">¶</a>
</li>
            <li id="section-11.1.1-1.5">
              <strong>final_relative_width</strong> - Value: 0.005 (0.5%).<a href="#section-11.1.1-1.5" class="pilcrow">¶</a>
</li>
            <li id="section-11.1.1-1.6">
              <strong>packet_loss_ratios</strong> - Value: 0.0, 0.005 (0.0% for NDR, 0.5% for PDR).<a href="#section-11.1.1-1.6" class="pilcrow">¶</a>
</li>
            <li id="section-11.1.1-1.7">
              <strong>number_of_intermediate_phases</strong> - Value: 2.
The value has been chosen based on limited experimentation to date.
More experimentation needed to arrive to clearer guidelines.<a href="#section-11.1.1-1.7" class="pilcrow">¶</a>
</li>
            <li id="section-11.1.1-1.8">
              <strong>timeout</strong> - Limit for the overall search duration (for one search).
If MLRsearch oversteps this limit, it immediately declares the test failed,
to avoid wasting even more time on a misbehaving SUT.
Value: 600.0 (seconds).<a href="#section-11.1.1-1.8" class="pilcrow">¶</a>
</li>
            <li id="section-11.1.1-1.9">
              <strong>expansion_coefficient</strong> - Width multiplier for external search.
Value: 4.0 (interval width is quadroupled).
Value of 2.0 is best for well-behaved SUTs, but value of 4.0 has been found
to decrease overall search time for worse-behaved SUT configurations,
contributing more to the overall set of different SUT configurations tested.<a href="#section-11.1.1-1.9" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="example-mlrsearch-run">
<section id="section-11.2">
        <h3 id="name-example-mlrsearch-run">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-example-mlrsearch-run" class="section-name selfRef">Example MLRsearch Run</a>
        </h3>
<p id="section-11.2-1">The following list describes a search from a real test run in CSIT
(using the default input values as above).<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-2.1">Initial phase, trial duration 1.0 second.<a href="#section-11.2-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.2-3">Measurement 1, intended load 18750000.0 pps (MTR),
measured loss ratio 0.7089514628479618 (valid upper bound for both NDR and PDR).<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<p id="section-11.2-4">Measurement 2, intended load 5457160.071600716 pps (MRR),
measured loss ratio 0.018650817320118702 (new tightest upper bounds).<a href="#section-11.2-4" class="pilcrow">¶</a></p>
<p id="section-11.2-5">Measurement 3, intended load 5348832.933500009 pps (slightly less than MRR2
in preparation for first intermediate phase target interval width),
measured loss ratio 0.00964383362905351 (new tightest upper bounds).<a href="#section-11.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-6.1">First intermediate phase starts, trial duration still 1.0 seconds.<a href="#section-11.2-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.2-7">Measurement 4, intended load 4936605.579021453 pps (no lower bound,
performing external search downwards, for NDR),
measured loss ratio 0.0 (valid lower bound for both NDR and PDR).<a href="#section-11.2-7" class="pilcrow">¶</a></p>
<p id="section-11.2-8">Measurement 5, intended load 5138587.208637197 pps (bisecting for NDR),
measured loss ratio 0.0 (new tightest lower bounds).<a href="#section-11.2-8" class="pilcrow">¶</a></p>
<p id="section-11.2-9">Measurement 6, intended load 5242656.244044665 pps (bisecting),
measured loss ratio 0.013523745379347257 (new tightest upper bounds).<a href="#section-11.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-10.1">Both intervals are narrow enough.<a href="#section-11.2-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.2-10.2">Second intermediate phase starts, trial duration 5.477225575051661 seconds.<a href="#section-11.2-10.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.2-11">Measurement 7, intended load 5190360.904111567 pps (initial bisect for NDR),
measured loss ratio 0.0023533920869969953 (NDR upper bound, PDR lower bound).<a href="#section-11.2-11" class="pilcrow">¶</a></p>
<p id="section-11.2-12">Measurement 8, intended load 5138587.208637197 pps (re-measuring NDR lower bound),
measured loss ratio 1.2080222912800403e-06 (new tightest NDR upper bound).<a href="#section-11.2-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-13.1">The two intervals have separate bounds from now on.<a href="#section-11.2-13.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.2-14">Measurement 9, intended load 4936605.381062318 pps (external NDR search down),
measured loss ratio 0.0 (new valid NDR lower bound).<a href="#section-11.2-14" class="pilcrow">¶</a></p>
<p id="section-11.2-15">Measurement 10, intended load 5036583.888432355 pps (NDR bisect),
measured loss ratio 0.0 (new tightest NDR lower bound).<a href="#section-11.2-15" class="pilcrow">¶</a></p>
<p id="section-11.2-16">Measurement 11, intended load 5087329.903232804 pps (NDR bisect),
measured loss ratio 0.0 (new tightest NDR lower bound).<a href="#section-11.2-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-17.1">NDR interval is narrow enough, PDR interval not ready yet.<a href="#section-11.2-17.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.2-18">Measurement 12, intended load 5242656.244044665 pps (re-measuring PDR upper bound),
measured loss ratio 0.0101174866190136 (still valid PDR upper bound).<a href="#section-11.2-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-19.1">Also PDR interval is narrow enough, with valid bounds for this duration.<a href="#section-11.2-19.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.2-19.2">Final phase starts, trial duration 30.0 seconds.<a href="#section-11.2-19.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.2-20">Measurement 13, intended load 5112894.3238511775 pps (initial bisect for NDR),
measured loss ratio 0.0 (new tightest NDR lower bound).<a href="#section-11.2-20" class="pilcrow">¶</a></p>
<p id="section-11.2-21">Measurement 14, intended load 5138587.208637197 (re-measuring NDR upper bound),
measured loss ratio 2.030389804256833e-06 (still valid PDR upper bound).<a href="#section-11.2-21" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-22.1">NDR interval is narrow enough, PDR interval not yet.<a href="#section-11.2-22.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.2-23">Measurement 15, intended load 5216443.04126728 pps (initial bisect for PDR),
measured loss ratio 0.005620871287975237 (new tightest PDR upper bound).<a href="#section-11.2-23" class="pilcrow">¶</a></p>
<p id="section-11.2-24">Measurement 16, intended load 5190360.904111567 (re-measuring PDR lower bound),
measured loss ratio 0.0027629971184465604 (still valid PDR lower bound).<a href="#section-11.2-24" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-25.1">PDR interval is also narrow enough.<a href="#section-11.2-25.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.2-25.2">Returning bounds:<a href="#section-11.2-25.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.2-25.3">NDR_LOWER = 5112894.3238511775 pps; NDR_UPPER = 5138587.208637197 pps;<a href="#section-11.2-25.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.2-25.4">PDR_LOWER = 5190360.904111567 pps; PDR_UPPER = 5216443.04126728 pps.<a href="#section-11.2-25.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations-6">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations-6" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-12-1">No requests of IANA.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-13">
      <h2 id="name-security-considerations-7">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-security-considerations-7" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-13-1">Benchmarking activities as described in this memo are limited to
technology characterization of a DUT/SUT using controlled stimuli in a
laboratory environment, with dedicated address space and the constraints
specified in the sections above.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">The benchmarking network topology will be an independent test setup and
MUST NOT be connected to devices that may forward the test traffic into
a production network or misroute traffic to the test management network.<a href="#section-13-2" class="pilcrow">¶</a></p>
<p id="section-13-3">Further, benchmarking is performed on a "black-box" basis, relying
solely on measurements observable external to the DUT/SUT.<a href="#section-13-3" class="pilcrow">¶</a></p>
<p id="section-13-4">Special capabilities SHOULD NOT exist in the DUT/SUT specifically for
benchmarking purposes. Any implications for network security arising
from the DUT/SUT SHOULD be identical in the lab and in production
networks.<a href="#section-13-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-14">
      <h2 id="name-acknowledgements-5">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-acknowledgements-5" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-14-1">Many thanks to Alec Hothan of OPNFV NFVbench project for thorough
review and numerous useful comments and suggestions.<a href="#section-14-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-15">
      <h2 id="name-references-5">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references-5" class="section-name selfRef">References</a>
      </h2>
<section id="section-15.1">
        <h3 id="name-normative-references-7">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references-7" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2544">[RFC2544]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span> and <span class="refAuthor">J. McQuaid</span>, <span class="refTitle">"Benchmarking Methodology for Network Interconnect Devices"</span>, <span class="seriesInfo">RFC 2544</span>, <span class="seriesInfo">DOI 10.17487/RFC2544</span>, <time datetime="1999-03" class="refDate">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2544">https://www.rfc-editor.org/info/rfc2544</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15.2">
        <h3 id="name-informative-references-5">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references-5" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="FDio-CSIT-MLRsearch">[FDio-CSIT-MLRsearch]</dt>
        <dd>
<span class="refTitle">"FD.io CSIT Test Methodology - MLRsearch"</span>, <time datetime="2021-11" class="refDate">November 2021</time>, <span>&lt;<a href="https://s3-docs.fd.io/csit/rls2110/report/introduction/methodology_data_plane_throughput/methodology_data_plane_throughput.html#mlrsearch-tests">https://s3-docs.fd.io/csit/rls2110/report/introduction/methodology_data_plane_throughput/methodology_data_plane_throughput.html#mlrsearch-tests</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PyPI-MLRsearch">[PyPI-MLRsearch]</dt>
      <dd>
<span class="refTitle">"MLRsearch 0.4.0, Python Package Index"</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://pypi.org/project/MLRsearch/0.4.0/">https://pypi.org/project/MLRsearch/0.4.0/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses-5">
<a href="#name-authors-addresses-5" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Maciek Konstantynowicz (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mkonstan@cisco.com" class="email">mkonstan@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vratko Polak</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vrpolak@cisco.com" class="email">vrpolak@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
