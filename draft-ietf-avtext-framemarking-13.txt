



Network Working Group                                          M. Zanaty
Internet-Draft                                                 E. Berger
Intended status: Experimental                              S. Nandakumar
Expires: 15 May 2022                                       Cisco Systems
                                                           November 2021


                   Frame Marking RTP Header Extension
                   draft-ietf-avtext-framemarking-13

Abstract

   This document describes a Frame Marking RTP header extension used to
   convey information about video frames that is critical for error
   recovery and packet forwarding in RTP middleboxes or network nodes.
   It is most useful when media is encrypted, and essential when the
   middlebox or node has no access to the media decryption keys.  It is
   also useful for codec-agnostic processing of encrypted or unencrypted
   media, while it also supports extensions for codec-specific
   information.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 5 May 2022.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components



Zanaty, et al.             Expires 15 May 2022                  [Page 1]

Internet-Draft                Frame Marking                November 2021


   extracted from this document must include Simplified BSD License text
   as described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Key Words for Normative Requirements  . . . . . . . . . . . .   4
   3.  Frame Marking RTP Header Extension  . . . . . . . . . . . . .   4
     3.1.  Long Extension for Scalable Streams . . . . . . . . . . .   5
     3.2.  Short Extension for Non-Scalable Streams  . . . . . . . .   7
     3.3.  Layer ID Mappings for Scalable Streams  . . . . . . . . .   7
       3.3.1.  VP9 LID Mapping . . . . . . . . . . . . . . . . . . .   7
       3.3.2.  H265 LID Mapping  . . . . . . . . . . . . . . . . . .   8
       3.3.3.  H264-SVC LID Mapping  . . . . . . . . . . . . . . . .   9
       3.3.4.  H264 (AVC) LID Mapping  . . . . . . . . . . . . . . .   9
       3.3.5.  VP8 LID Mapping . . . . . . . . . . . . . . . . . . .  10
       3.3.6.  Future Codec LID Mapping  . . . . . . . . . . . . . .  11
     3.4.  Signaling Information . . . . . . . . . . . . . . . . . .  11
     3.5.  Usage Considerations  . . . . . . . . . . . . . . . . . .  11
       3.5.1.  Relation to Layer Refresh Request (LRR) . . . . . . .  12
       3.5.2.  Scalability Structures  . . . . . . . . . . . . . . .  12
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .  12
   5.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  12
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  12
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  13
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .  13
     7.2.  Informative References  . . . . . . . . . . . . . . . . .  13
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  14

1.  Introduction

   Many widely deployed RTP [RFC3550] topologies [RFC7667] used in
   modern voice and video conferencing systems include a centralized
   component that acts as an RTP switch.  It receives voice and video
   streams from each participant, which may be encrypted using SRTP
   [RFC3711], or extensions that provide participants with private media
   [RFC8871] via end-to-end encryption where the switch has no access to
   media decryption keys.  The goal is to provide a set of streams back
   to the participants which enable them to render the right media
   content.  In a simple video configuration, for example, the goal will
   be that each participant sees and hears just the active speaker.  In
   that case, the goal of the switch is to receive the voice and video
   streams from each participant, determine the active speaker based on
   energy in the voice packets, possibly using the client-to-mixer audio
   level RTP header extension [RFC6464], and select the corresponding
   video stream for transmission to participants; see Figure 1.




Zanaty, et al.             Expires 15 May 2022                  [Page 2]

Internet-Draft                Frame Marking                November 2021


   In this document, an "RTP switch" is used as a common short term for
   the terms "switching RTP mixer", "source projecting middlebox",
   "source forwarding unit/middlebox" and "video switching MCU" as
   discussed in [RFC7667].

            +---+      +------------+      +---+
            | A |<---->|            |<---->| B |
            +---+      |            |      +---+
                       |   RTP      |
            +---+      |  Switch    |      +---+
            | C |<---->|            |<---->| D |
            +---+      +------------+      +---+


                            Figure 1: RTP switch

   In order to properly support switching of video streams, the RTP
   switch typically needs some critical information about video frames
   in order to start and stop forwarding streams.

   *  Because of inter-frame dependencies, it should ideally switch
      video streams at a point where the first frame from the new
      speaker can be decoded by recipients without prior frames, e.g
      switch on an intra-frame.
   *  In many cases, the switch may need to drop frames in order to
      realize congestion control techniques, and needs to know which
      frames can be dropped with minimal impact to video quality.
   *  For scalable streams with dependent layers, the switch may need to
      selectively forward specific layers to specific recipients due to
      recipient bandwidth or decoder limits.
   *  Furthermore, it is highly desirable to do this in a payload
      format-agnostic way which is not specific to each different video
      codec.  Most modern video codecs share common concepts around
      frame types and other critical information to make this codec-
      agnostic handling possible.
   *  It is also desirable to be able to do this for SRTP without
      requiring the video switch to decrypt the packets.  SRTP will
      encrypt the RTP payload format contents and consequently this data
      is not usable for the switching function without decryption, which
      may not even be possible in the case of end-to-end encryption of
      private media [RFC8871].

   By providing meta-information about the RTP streams outside the
   encrypted media payload, an RTP switch can do codec-agnostic
   selective forwarding without decrypting the payload.  This document
   specifies the necessary meta-information in an RTP header extension.





Zanaty, et al.             Expires 15 May 2022                  [Page 3]

Internet-Draft                Frame Marking                November 2021


2.  Key Words for Normative Requirements

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [RFC2119].

3.  Frame Marking RTP Header Extension

   This specification uses RTP header extensions as defined in
   [RFC8285].  A subset of meta-information from the video stream is
   provided as an RTP header extension to allow an RTP switch to do
   generic selective forwarding of video streams encoded with
   potentially different video codecs.

   The Frame Marking RTP header extension is encoded using the one-byte
   header or two-byte header as described in [RFC8285].  The one-byte
   header format is used for examples in this memo.  The two-byte header
   format is used when other two-byte header extensions are present in
   the same RTP packet, since mixing one-byte and two-byte extensions is
   not possible in the same RTP packet.

   This extension is only specified for Source (not Redundancy) RTP
   Streams [RFC7656] that carry video payloads.  It is not specified for
   audio payloads, nor is it specified for Redundancy RTP Streams.  The
   (separate) specifications for Redundancy RTP Streams often include
   provisions for recovering any header extensions that were part of the
   original source packet.  Such provisions SHALL be followed to recover
   the Frame Marking RTP header extension of the original source packet.
   Source packet frame markings may be useful when generating Redundancy
   RTP Streams; for example, the I and D bits can be used to generate
   extra or no redundancy, respectively, and redundancy schemes with
   source blocks can align source block boundaries with Independent
   frame boundaries as marked by the I bit.

   A frame, in the context of this specification, is the set of RTP
   packets with the same RTP timestamp from a specific RTP
   synchronization source (SSRC).  A frame within a layer is the set of
   RTP packets with the same RTP timestamp, SSRC, Temporal ID (TID), and
   Layer ID (LID).











Zanaty, et al.             Expires 15 May 2022                  [Page 4]

Internet-Draft                Frame Marking                November 2021


3.1.  Long Extension for Scalable Streams

   The following RTP header extension is RECOMMENDED for scalable
   streams.  It MAY also be used for non-scalable streams, in which case
   TID, LID and TL0PICIDX MUST be 0 or omitted.  The ID is assigned per
   [RFC8285], and the length is encoded as L=2 which indicates 3 octets
   of data when nothing is omitted, or L=1 for 2 octets when TL0PICIDX
   is omitted, or L=0 for 1 octet when both LID and TL0PICIDX are
   omitted.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  ID=? |  L=2  |S|E|I|D|B| TID |   LID         |    TL0PICIDX  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              or
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  ID=? |  L=1  |S|E|I|D|B| TID |   LID         | (TL0PICIDX omitted)
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              or
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  ID=? |  L=0  |S|E|I|D|B| TID | (LID and TL0PICIDX omitted)
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The following information are extracted from the media payload and
   sent in the Frame Marking RTP header extension.

   *  S: Start of Frame (1 bit) - MUST be 1 in the first packet in a
      frame within a layer; otherwise MUST be 0.
   *  E: End of Frame (1 bit) - MUST be 1 in the last packet in a frame
      within a layer; otherwise MUST be 0.  Note that the RTP header
      marker bit MAY be used to infer the last packet of the highest
      enhancement layer, in payload formats with such semantics.
   *  I: Independent Frame (1 bit) - MUST be 1 for a frame within a
      layer that can be decoded independent of temporally prior frames,
      e.g. intra-frame, VPX keyframe, H.264 IDR [RFC6184], H.265
      IDR/CRA/BLA/RAP [RFC7798]; otherwise MUST be 0.  Note that this
      bit only signals temporal independence, so it can be 1 in spatial
      or quality enhancement layers that depend on temporally co-located
      layers but not temporally prior frames.
   *  D: Discardable Frame (1 bit) - MUST be 1 for a frame within a
      layer the sender knows can be discarded, and still provide a
      decodable media stream; otherwise MUST be 0.
   *  B: Base Layer Sync (1 bit) - When TID is not 0, this MUST be 1 if
      the sender knows this frame within a layer only depends on the
      base temporal layer; otherwise MUST be 0.  When TID is 0 or if no
      scalability is used, this MUST be 0.




Zanaty, et al.             Expires 15 May 2022                  [Page 5]

Internet-Draft                Frame Marking                November 2021


   *  TID: Temporal ID (3 bits) - Identifies the temporal layer/sub-
      layer encoded, starting with 0 for the base layer, and increasing
      with higher temporal fidelity.  If no scalability is used, this
      MUST be 0.  It is implicitly 0 in the short extension format.
   *  LID: Layer ID (8 bits) - Identifies the spatial and quality layer
      encoded, starting with 0 for the base layer, and increasing with
      higher fidelity.  If no scalability is used, this MUST be 0 or
      omitted to reduce length.  When omitted, TL0PICIDX MUST also be
      omitted.  It is implicitly 0 in the short extension format or when
      omitted in the long extension format.
   *  TL0PICIDX: Temporal Layer 0 Picture Index (8 bits) - When TID is 0
      and LID is 0, this is a cyclic counter labeling base layer frames.
      When TID is not 0 or LID is not 0, this indicates a dependency on
      the given index, such that this frame within this layer depends on
      the frame with this label in the layer with TID 0 and LID 0.  If
      no scalability is used, or the cyclic counter is unknown, this
      MUST be omitted to reduce length.  Note that 0 is a valid index
      value for TL0PICIDX.

   The layer information contained in TID and LID convey useful aspects
   of the layer structure that can be utilized in selective forwarding.

   Without further information about the layer structure, these TID/LID
   identifiers can only be used for relative priority of layers and
   implicit dependencies between layers.  They convey a layer hierarchy
   with TID=0 and LID=0 identifying the base layer.  Higher values of
   TID identify higher temporal layers with higher frame rates.  Higher
   values of LID identify higher spatial and/or quality layers with
   higher resolutions and/or bitrates.  Implicit dependencies between
   layers assume that a layer with a given TID/LID MAY depend on
   layer(s) with the same or lower TID/LID, but MUST NOT depend on
   layer(s) with higher TID/LID.

   With further information, for example, possible future RTCP SDES
   items that convey full layer structure information, it may be
   possible to map these TIDs and LIDs to specific absolute frame rates,
   resolutions and bitrates, as well as explicit dependencies between
   layers.  Such additional layer information may be useful for
   forwarding decisions in the RTP switch, but is beyond the scope of
   this memo.  The relative layer information is still useful for many
   selective forwarding decisions even without such additional layer
   information.









Zanaty, et al.             Expires 15 May 2022                  [Page 6]

Internet-Draft                Frame Marking                November 2021


3.2.  Short Extension for Non-Scalable Streams

   The following RTP header extension is RECOMMENDED for non-scalable
   streams.  It is identical to the shortest form of the extension for
   scalable streams, except the last four bits (B and TID) are replaced
   with zeros.  It MAY also be used for scalable streams if the sender
   has limited or no information about stream scalability.  The ID is
   assigned per [RFC8285], and the length is encoded as L=0 which
   indicates 1 octet of data.

    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  ID=? |  L=0  |S|E|I|D|0 0 0 0|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The following information are extracted from the media payload and
   sent in the Frame Marking RTP header extension.

   *  S: Start of Frame (1 bit) - MUST be 1 in the first packet in a
      frame; otherwise MUST be 0.
   *  E: End of Frame (1 bit) - MUST be 1 in the last packet in a frame;
      otherwise MUST be 0.  SHOULD match the RTP header marker bit in
      payload formats with such semantics for marking end of frame.
   *  I: Independent Frame (1 bit) - MUST be 1 for frames that can be
      decoded independent of temporally prior frames, e.g. intra-frame,
      VPX keyframe, H.264 IDR [RFC6184], H.265 IDR/CRA/BLA/IRAP
      [RFC7798]; otherwise MUST be 0.
   *  D: Discardable Frame (1 bit) - MUST be 1 for frames the sender
      knows can be discarded, and still provide a decodable media
      stream; otherwise MUST be 0.
   *  The remaining (4 bits) - are reserved/fixed values and not used
      for non-scalable streams; they MUST be set to 0 upon transmission
      and ignored upon reception.

3.3.  Layer ID Mappings for Scalable Streams

   This section maps the specific Layer ID information contained in
   specific scalable codecs to the generic LID and TID fields.

   Note that non-scalable streams have no Layer ID information and thus
   no mappings.

3.3.1.  VP9 LID Mapping

   The following shows the VP9 [I-D.ietf-payload-vp9] Spatial Layer ID
   (SID, 3 bits) and Temporal Layer ID (TID, 3 bits) from the VP9
   payload descriptor mapped to the generic LID and TID fields.



Zanaty, et al.             Expires 15 May 2022                  [Page 7]

Internet-Draft                Frame Marking                November 2021


   The S bit MUST match the B bit in the VP9 payload descriptor.

   The E bit MUST match the E bit in the VP9 payload descriptor.

   The I bit MUST match the inverse of the P bit in the VP9 payload
   descriptor.

   The D bit MUST be 1 if the refresh_frame_flags in the VP9 payload
   uncompressed header are all 0, otherwise it MUST be 0.

   The B bit MUST be 0 if TID is 0; otherwise, if TID is not 0, it MUST
   match the U bit in the VP9 payload descriptor.  Note: When using
   temporally nested scalability structures as recommended in
   Section 3.5.2, the B bit and VP9 U bit will always be 1 if TID is not
   0, since it is always possible to switch up to a higher temporal
   layer in such nested structures.

   TID and TL0PICIDX MUST match the correspondingly named fields in the
   VP9 payload descriptor.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  ID=? |  L=2  |S|E|I|D|B| TID |0|0|0|0|0| SID |    TL0PICIDX  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

3.3.2.  H265 LID Mapping

   The following shows the H265 [RFC7798] LayerID (6 bits) and TID (3
   bits) from the NAL unit header mapped to the generic LID and TID
   fields.

   The S and E bits MUST match the correspondingly named bits in
   PACI:PHES:TSCI payload structures.

   The I bit MUST be 1 when the NAL unit type is 16-23 (inclusive) or
   32-34 (inclusive), or an aggregation packet or fragmentation unit
   encapsulating any of these types, otherwise it MUST be 0.  These
   ranges cover intra (IRAP) frames as well as critical parameter sets
   (VPS, SPS, PPS).

   The D bit MUST be 1 when the NAL unit type is 0, 2, 4, 6, 8, 10, 12,
   14, or 38, or an aggregation packet or fragmentation unit
   encapsulating only these types, otherwise it MUST be 0.  These ranges
   cover non-reference frames as well as filler data.






Zanaty, et al.             Expires 15 May 2022                  [Page 8]

Internet-Draft                Frame Marking                November 2021


   The B bit can not be determined reliably from simple inspection of
   payload headers, and therefore is determined by implementation-
   specific means.  For example, internal codec interfaces may provide
   information to set this reliably.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  ID=? |  L=2  |S|E|I|D|B| TID |0|0|  LayerID  |    TL0PICIDX  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

3.3.3.  H264-SVC LID Mapping

   The following shows H264-SVC [RFC6190] Layer encoding information (3
   bits for spatial/dependency layer, 4 bits for quality layer and 3
   bits for temporal layer) mapped to the generic LID and TID fields.

   The S, E, I and D bits MUST match the correspondingly named bits in
   PACSI payload structures.

   The I bit MUST be 1 when the NAL unit type is 5, 7, 8, 13, or 15, or
   an aggregation packet or fragmentation unit encapsulating any of
   these types, otherwise it MUST be 0.  These ranges cover intra (IDR)
   frames as well as critical parameter sets (SPS/PPS variants).

   The D bit MUST be 1 when the NAL unit header NRI field is 0, or an
   aggregation packet or fragmentation unit encapsulating only NAL units
   with NRI=0, otherwise it MUST be 0.  The NRI=0 condition signals non-
   reference frames.

   The B bit can not be determined reliably from simple inspection of
   payload headers, and therefore is determined by implementation-
   specific means.  For example, internal codec interfaces may provide
   information to set this reliably.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  ID=? |  L=2  |S|E|I|D|B| TID |0| DID |  QID  |    TL0PICIDX  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

3.3.4.  H264 (AVC) LID Mapping

   The following shows the header extension for H264 (AVC) [RFC6184]
   that contains only temporal layer information.






Zanaty, et al.             Expires 15 May 2022                  [Page 9]

Internet-Draft                Frame Marking                November 2021


   The S bit MUST be 1 when the timestamp in the RTP header differs from
   the timestamp in the prior RTP sequence number from the same SSRC,
   otherwise it MUST be 0.

   The E bit MUST match the M bit in the RTP header.

   The I bit MUST be 1 when the NAL unit type is 5, 7, or 8, or an
   aggregation packet or fragmentation unit encapsulating any of these
   types, otherwise it MUST be 0.  These ranges cover intra (IDR) frames
   as well as critical parameter sets (SPS/PPS).

   The D bit MUST be 1 when the NAL unit header NRI field is 0, or an
   aggregation packet or fragmentation unit encapsulating only NAL units
   with NRI=0, otherwise it MUST be 0.  The NRI=0 condition signals non-
   reference frames.

   The B bit can not be determined reliably from simple inspection of
   payload headers, and therefore is determined by implementation-
   specific means.  For example, internal codec interfaces may provide
   information to set this reliably.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  ID=? |  L=2  |S|E|I|D|B| TID |0|0|0|0|0|0|0|0|    TL0PICIDX  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

3.3.5.  VP8 LID Mapping

   The following shows the header extension for VP8 [RFC7741] that
   contains only temporal layer information.

   The S bit MUST match the correspondingly named bit in the VP8 payload
   descriptor when PID=0, otherwise it MUST be 0.

   The E bit MUST match the M bit in the RTP header.

   The I bit MUST match the inverse of the P bit in the VP8 payload
   header.

   The D bit MUST match the N bit in the VP8 payload descriptor.

   The B bit MUST match the Y bit in the VP8 payload descriptor.  Note:
   When using temporally nested scalability structures as recommended in
   Section 3.5.2, the B bit and VP8 Y bit will always be 1 if TID is not
   0, since it is always possible to switch up to a higher temporal
   layer in such nested structures.




Zanaty, et al.             Expires 15 May 2022                 [Page 10]

Internet-Draft                Frame Marking                November 2021


   TID and TL0PICIDX MUST match the correspondingly named fields in the
   VP8 payload descriptor.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  ID=? |  L=2  |S|E|I|D|B| TID |0|0|0|0|0|0|0|0|    TL0PICIDX  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

3.3.6.  Future Codec LID Mapping

   The RTP payload format specification for future video codecs SHOULD
   include a section describing the LID mapping and TID mapping for the
   codec.

3.4.  Signaling Information

   The URI for declaring this header extension in an extmap attribute is
   "urn:ietf:params:rtp-hdrext:framemarking".  It does not contain any
   extension attributes.

   An example attribute line in SDP:

      a=extmap:3 urn:ietf:params:rtp-hdrext:framemarking

3.5.  Usage Considerations

   The header extension values MUST represent what is already in the RTP
   payload.

   When an RTP switch needs to discard a received video frame due to
   congestion control considerations, it is RECOMMENDED that it
   preferably drop frames marked with the D (Discardable) bit set, or
   the highest values of TID and LID, which indicate the highest
   temporal and spatial/quality enhancement layers, since those
   typically have fewer dependenices on them than lower layers.

   When an RTP switch wants to forward a new video stream to a receiver,
   it is RECOMMENDED to select the new video stream from the first
   switching point with the I (Independent) bit set in all spatial
   layers and forward the same.  An RTP switch can request a media
   source to generate a switching point by sending Full Intra Request
   (RTCP FIR) as defined in [RFC5104], for example.








Zanaty, et al.             Expires 15 May 2022                 [Page 11]

Internet-Draft                Frame Marking                November 2021


3.5.1.  Relation to Layer Refresh Request (LRR)

   Receivers can use the Layer Refresh Request (LRR)
   [I-D.ietf-avtext-lrr] RTCP feedback message to upgrade to a higher
   layer in scalable encodings.  The TID/LID values and formats used in
   LRR messages MUST correspond to the same values and formats specified
   in Section 3.1.

   Because frame marking can only be used with temporally-nested
   streams, temporal-layer LRR refreshes are unnecessary for frame-
   marked streams.  Other refreshes can be detected based on the I bit
   being set for the specific spatial layers.

3.5.2.  Scalability Structures

   The LID and TID information is most useful for fixed scalability
   structures, such as nested hierarchical temporal layering structures,
   where each temporal layer only references lower temporal layers or
   the base temporal layer.  The LID and TID information is less useful,
   or even not useful at all, for complex, irregular scalability
   structures that do not conform to common, fixed patterns of inter-
   layer dependencies and referencing structures.  Therefore it is
   RECOMMENDED to use LID and TID information for RTP switch forwarding
   decisions only in the case of temporally nested scalability
   structures, and it is NOT RECOMMENDED for other (more complex or
   irregular) scalability structures.

4.  Security Considerations

   In the Secure Real-Time Transport Protocol (SRTP) [RFC3711], RTP
   header extensions are authenticated but usually not encrypted.  When
   header extensions are used some of the payload type information are
   exposed and visible to middle boxes.  The encrypted media data is not
   exposed, so this is not seen as a high risk exposure.

5.  Acknowledgements

   Many thanks to Bernard Aboba, Jonathan Lennox, Stephan Wenger, Dale
   Worley, and Magnus Westerlund for their inputs.

6.  IANA Considerations

   This document defines a new extension URI to the RTP Compact
   HeaderExtensions sub-registry of the Real-Time Transport Protocol
   (RTP) Parameters registry, according to the following data:






Zanaty, et al.             Expires 15 May 2022                 [Page 12]

Internet-Draft                Frame Marking                November 2021


   Extension URI: urn:ietf:params:rtp-hdrext:framemarkinginfo
   Description: Frame marking information for video streams Contact:
   mzanaty@cisco.com Reference: RFC XXXX

   Note to RFC Editor: please replace RFC XXXX with the number of this
   RFC.

7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8285]  Singer, D., Desineni, H., and R. Even, Ed., "A General
              Mechanism for RTP Header Extensions", RFC 8285,
              DOI 10.17487/RFC8285, October 2017,
              <https://www.rfc-editor.org/info/rfc8285>.

   [RFC6184]  Wang, Y.-K., Even, R., Kristensen, T., and R. Jesup, "RTP
              Payload Format for H.264 Video", RFC 6184,
              DOI 10.17487/RFC6184, May 2011,
              <https://www.rfc-editor.org/info/rfc6184>.

   [RFC6190]  Wenger, S., Wang, Y.-K., Schierl, T., and A.
              Eleftheriadis, "RTP Payload Format for Scalable Video
              Coding", RFC 6190, DOI 10.17487/RFC6190, May 2011,
              <https://www.rfc-editor.org/info/rfc6190>.

   [RFC7741]  Westin, P., Lundin, H., Glover, M., Uberti, J., and F.
              Galligan, "RTP Payload Format for VP8 Video", RFC 7741,
              DOI 10.17487/RFC7741, March 2016,
              <https://www.rfc-editor.org/info/rfc7741>.

   [RFC7798]  Wang, Y.-K., Sanchez, Y., Schierl, T., Wenger, S., and M.
              M. Hannuksela, "RTP Payload Format for High Efficiency
              Video Coding (HEVC)", RFC 7798, DOI 10.17487/RFC7798,
              March 2016, <https://www.rfc-editor.org/info/rfc7798>.

7.2.  Informative References

   [RFC7656]  Lennox, J., Gross, K., Nandakumar, S., Salgueiro, G., and
              B. Burman, Ed., "A Taxonomy of Semantics and Mechanisms
              for Real-Time Transport Protocol (RTP) Sources", RFC 7656,
              DOI 10.17487/RFC7656, November 2015,
              <https://www.rfc-editor.org/info/rfc7656>.



Zanaty, et al.             Expires 15 May 2022                 [Page 13]

Internet-Draft                Frame Marking                November 2021


   [RFC7667]  Westerlund, M. and S. Wenger, "RTP Topologies", RFC 7667,
              DOI 10.17487/RFC7667, November 2015,
              <https://www.rfc-editor.org/info/rfc7667>.

   [RFC6464]  Lennox, J., Ed., Ivov, E., and E. Marocco, "A Real-time
              Transport Protocol (RTP) Header Extension for Client-to-
              Mixer Audio Level Indication", RFC 6464,
              DOI 10.17487/RFC6464, December 2011,
              <https://www.rfc-editor.org/info/rfc6464>.

   [RFC3550]  Schulzrinne, H., Casner, S., Frederick, R., and V.
              Jacobson, "RTP: A Transport Protocol for Real-Time
              Applications", STD 64, RFC 3550, DOI 10.17487/RFC3550,
              July 2003, <https://www.rfc-editor.org/info/rfc3550>.

   [RFC3711]  Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K.
              Norrman, "The Secure Real-time Transport Protocol (SRTP)",
              RFC 3711, DOI 10.17487/RFC3711, March 2004,
              <https://www.rfc-editor.org/info/rfc3711>.

   [RFC5104]  Wenger, S., Chandra, U., Westerlund, M., and B. Burman,
              "Codec Control Messages in the RTP Audio-Visual Profile
              with Feedback (AVPF)", RFC 5104, DOI 10.17487/RFC5104,
              February 2008, <https://www.rfc-editor.org/info/rfc5104>.

   [RFC8871]  Jones, P., Benham, D., and C. Groves, "A Solution
              Framework for Private Media in Privacy-Enhanced RTP
              Conferencing (PERC)", RFC 8871, DOI 10.17487/RFC8871,
              January 2021, <https://www.rfc-editor.org/info/rfc8871>.

   [I-D.ietf-avtext-lrr]
              Lennox, J., Hong, D., Uberti, J., Holmer, S., and M.
              Flodman, "The Layer Refresh Request (LRR) RTCP Feedback
              Message", Work in Progress, Internet-Draft, draft-ietf-
              avtext-lrr-07, 2 July 2017,
              <https://www.ietf.org/archive/id/draft-ietf-avtext-lrr-
              07.txt>.

   [I-D.ietf-payload-vp9]
              Uberti, J., Holmer, S., Flodman, M., Hong, D., and J.
              Lennox, "RTP Payload Format for VP9 Video", Work in
              Progress, Internet-Draft, draft-ietf-payload-vp9-16, 10
              June 2021, <https://www.ietf.org/internet-drafts/draft-
              ietf-payload-vp9-16.txt>.

Authors' Addresses





Zanaty, et al.             Expires 15 May 2022                 [Page 14]

Internet-Draft                Frame Marking                November 2021


   Mo Zanaty
   Cisco Systems
   170 West Tasman Drive
   San Jose, CA 95134
   United States of America

   Email: mzanaty@cisco.com


   Espen Berger
   Cisco Systems

   Email: espeberg@cisco.com


   Suhas Nandakumar
   Cisco Systems
   170 West Tasman Drive
   San Jose, CA 95134
   United States of America

   Email: snandaku@cisco.com





























Zanaty, et al.             Expires 15 May 2022                 [Page 15]
